{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport URI from 'urijs';\nimport { safeStringify } from './safeStringify';\n\nconst MAX_URL_LENGTH = 8000;\n\nexport function getURIDirectory(formData, endpointType) {var _context;if (endpointType === void 0) {endpointType = 'base';}\n  // Building the directory part of the URI\n  let directory = '/explore/';\n  if (_includesInstanceProperty(_context = ['json', 'csv', 'query', 'results', 'samples']).call(_context, endpointType)) {\n    directory = '/superset/explore_json/';\n  }\n\n  return directory;\n}\n\nexport function getExploreLongUrl(\nformData,\nendpointType,\nallowOverflow,\nextraSearch)\n{if (allowOverflow === void 0) {allowOverflow = true;}if (extraSearch === void 0) {extraSearch = {};}\n  if (!formData.datasource) {\n    return null;\n  }\n\n  const uri = new URI('/');\n  const directory = getURIDirectory(formData, endpointType);\n  const search = uri.search(true);\n  Object.keys(extraSearch).forEach((key) => {\n    search[key] = extraSearch[key];\n  });\n  search.form_data = safeStringify(formData);\n  if (endpointType === 'standalone') {\n    search.standalone = 'true';\n  }\n  const url = uri.directory(directory).search(search).toString();\n  if (!allowOverflow && url.length > MAX_URL_LENGTH) {\n    const minimalFormData = {\n      datasource: formData.datasource,\n      viz_type: formData.viz_type };\n\n\n    return getExploreLongUrl(minimalFormData, endpointType, false, {\n      URL_IS_TOO_LONG_TO_SHARE: null });\n\n  }\n\n  return url;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(MAX_URL_LENGTH, \"MAX_URL_LENGTH\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.js\");reactHotLoader.register(getURIDirectory, \"getURIDirectory\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.js\");reactHotLoader.register(getExploreLongUrl, \"getExploreLongUrl\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["URI","safeStringify","MAX_URL_LENGTH","getURIDirectory","formData","endpointType","directory","getExploreLongUrl","allowOverflow","extraSearch","datasource","uri","search","Object","keys","forEach","key","form_data","standalone","url","toString","length","minimalFormData","viz_type","URL_IS_TOO_LONG_TO_SHARE"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport URI from 'urijs';\nimport { safeStringify } from './safeStringify';\n\nconst MAX_URL_LENGTH = 8000;\n\nexport function getURIDirectory(formData, endpointType = 'base') {\n  // Building the directory part of the URI\n  let directory = '/explore/';\n  if (['json', 'csv', 'query', 'results', 'samples'].includes(endpointType)) {\n    directory = '/superset/explore_json/';\n  }\n\n  return directory;\n}\n\nexport function getExploreLongUrl(\n  formData,\n  endpointType,\n  allowOverflow = true,\n  extraSearch = {},\n) {\n  if (!formData.datasource) {\n    return null;\n  }\n\n  const uri = new URI('/');\n  const directory = getURIDirectory(formData, endpointType);\n  const search = uri.search(true);\n  Object.keys(extraSearch).forEach(key => {\n    search[key] = extraSearch[key];\n  });\n  search.form_data = safeStringify(formData);\n  if (endpointType === 'standalone') {\n    search.standalone = 'true';\n  }\n  const url = uri.directory(directory).search(search).toString();\n  if (!allowOverflow && url.length > MAX_URL_LENGTH) {\n    const minimalFormData = {\n      datasource: formData.datasource,\n      viz_type: formData.viz_type,\n    };\n\n    return getExploreLongUrl(minimalFormData, endpointType, false, {\n      URL_IS_TOO_LONG_TO_SHARE: null,\n    });\n  }\n\n  return url;\n}\n"],"mappings":"wYAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,GAAP,MAAgB,OAAhB;AACA,SAASC,aAAT,QAA8B,iBAA9B;;AAEA,MAAMC,cAAc,GAAG,IAAvB;;AAEA,OAAO,SAASC,eAAT,CAAyBC,QAAzB,EAAmCC,YAAnC,EAA0D,kBAAvBA,YAAuB,cAAvBA,YAAuB,GAAR,MAAQ;EAC/D;EACA,IAAIC,SAAS,GAAG,WAAhB;EACA,IAAI,sCAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,SAAzB,EAAoC,SAApC,kBAAwDD,YAAxD,CAAJ,EAA2E;IACzEC,SAAS,GAAG,yBAAZ;EACD;;EAED,OAAOA,SAAP;AACD;;AAED,OAAO,SAASC,iBAAT;AACLH,QADK;AAELC,YAFK;AAGLG,aAHK;AAILC,WAJK;AAKL,KAFAD,aAEA,cAFAA,aAEA,GAFgB,IAEhB,MADAC,WACA,cADAA,WACA,GADc,EACd;EACA,IAAI,CAACL,QAAQ,CAACM,UAAd,EAA0B;IACxB,OAAO,IAAP;EACD;;EAED,MAAMC,GAAG,GAAG,IAAIX,GAAJ,CAAQ,GAAR,CAAZ;EACA,MAAMM,SAAS,GAAGH,eAAe,CAACC,QAAD,EAAWC,YAAX,CAAjC;EACA,MAAMO,MAAM,GAAGD,GAAG,CAACC,MAAJ,CAAW,IAAX,CAAf;EACAC,MAAM,CAACC,IAAP,CAAYL,WAAZ,EAAyBM,OAAzB,CAAiC,CAAAC,GAAG,KAAI;IACtCJ,MAAM,CAACI,GAAD,CAAN,GAAcP,WAAW,CAACO,GAAD,CAAzB;EACD,CAFD;EAGAJ,MAAM,CAACK,SAAP,GAAmBhB,aAAa,CAACG,QAAD,CAAhC;EACA,IAAIC,YAAY,KAAK,YAArB,EAAmC;IACjCO,MAAM,CAACM,UAAP,GAAoB,MAApB;EACD;EACD,MAAMC,GAAG,GAAGR,GAAG,CAACL,SAAJ,CAAcA,SAAd,EAAyBM,MAAzB,CAAgCA,MAAhC,EAAwCQ,QAAxC,EAAZ;EACA,IAAI,CAACZ,aAAD,IAAkBW,GAAG,CAACE,MAAJ,GAAanB,cAAnC,EAAmD;IACjD,MAAMoB,eAAe,GAAG;MACtBZ,UAAU,EAAEN,QAAQ,CAACM,UADC;MAEtBa,QAAQ,EAAEnB,QAAQ,CAACmB,QAFG,EAAxB;;;IAKA,OAAOhB,iBAAiB,CAACe,eAAD,EAAkBjB,YAAlB,EAAgC,KAAhC,EAAuC;MAC7DmB,wBAAwB,EAAE,IADmC,EAAvC,CAAxB;;EAGD;;EAED,OAAOL,GAAP;AACD,C,iLA7CKjB,c,wKAEUC,e,yKAUAI,iB"},"metadata":{},"sourceType":"module"}