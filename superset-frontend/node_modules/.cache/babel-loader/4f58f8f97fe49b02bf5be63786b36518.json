{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport DrillDetailPane from './DrillDetailPane';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst ModalFooter = (_ref) => {let { exploreChart, closeModal } = _ref;return ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(Button, { buttonStyle: \"secondary\", buttonSize: \"small\", onClick: exploreChart },\n  t('Edit chart')),\n\n  ___EmotionJSX(Button, { buttonStyle: \"primary\", buttonSize: \"small\", onClick: closeModal },\n  t('Close')));};\n\n\nexport default function DrillDetailModal(_ref2) {let { chartId, formData, initialFilters, showModal, onHideModal } = _ref2;\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector((state) => state.sliceEntities.slices[chartId]);\n  const exploreUrl = useMemo(() => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`, [chartId, dashboardPageId]);\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n  return ___EmotionJSX(Modal, { show: showModal, onHide: onHideModal != null ? onHideModal : () => null, css: css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `, title: t('Drill to detail: %s', chartName), footer: ___EmotionJSX(ModalFooter, { exploreChart: exploreChart }), responsive: true, resizable: true, resizableConfig: {\n      minHeight: theme.gridUnit * 128,\n      minWidth: theme.gridUnit * 128,\n      defaultSize: {\n        width: 'auto',\n        height: '75vh' } },\n\n    draggable: true, destroyOnClose: true, maskClosable: false },\n  ___EmotionJSX(DrillDetailPane, { formData: formData, initialFilters: initialFilters }));\n\n}","map":{"version":3,"mappings":"AAAA;;;;;;;;;;;;;;;;;;AAmBA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,UAA7B,EAAyCC,OAAzC,QAAwD,OAAxD;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAEEC,GAFF,EAIEC,CAJF,EAKEC,QALF,QAMO,mBANP;AAOA,OAAOC,KAAP,MAAkB,sBAAlB;AACA,OAAOC,MAAP,MAAmB,uBAAnB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,sBAAT,QAAuC,wCAAvC;AAEA,OAAOC,eAAP,MAA4B,mBAA5B,C;AAOA,MAAMC,WAAW,GAAG,eAAC,EAAEC,YAAF,EAAgBC,UAAhB,EAAD,eAClB;EACE,cAAC,MAAD,IAAQ,WAAW,EAAC,WAApB,EAAgC,UAAU,EAAC,OAA3C,EAAmD,OAAO,EAAED,YAA5D;EACGR,CAAC,CAAC,YAAD,CADJ,CADF;;EAIE,cAAC,MAAD,IACE,WAAW,EAAC,SADd,EAEE,UAAU,EAAC,OAFb,EAGE,OAAO,EAAES,UAHX;EAMGT,CAAC,CAAC,OAAD,CANJ,CAJF,CADkB,EAApB;;;AAwBA,eAAc,SAAUU,gBAAV,QAMU,KANiB,EACvCC,OADuC,EAEvCC,QAFuC,EAGvCC,cAHuC,EAIvCC,SAJuC,EAKvCC,WALuC,EAMjB;EACtB,MAAMC,KAAK,GAAGf,QAAQ,EAAtB;EACA,MAAMgB,OAAO,GAAGnB,UAAU,EAA1B;EACA,MAAMoB,eAAe,GAAGtB,UAAU,CAACS,sBAAD,CAAlC;EACA,MAAM,EAAEc,UAAU,EAAEC,SAAd,KAA4BhB,WAAW,CAC3C,CAACiB,KAAD,KACEA,KAAK,CAACC,aAAN,CAAoBC,MAApB,CAA2BZ,OAA3B,CAFyC,CAA7C;EAKA,MAAMa,UAAU,GAAG3B,OAAO,CACxB,MAAM,+BAA+BqB,eAAe,aAAaP,OAAO,EADhD,EAExB,CAACA,OAAD,EAAUO,eAAV,CAFwB,CAA1B;EAKA,MAAMV,YAAY,GAAGb,WAAW,CAAC,MAAK;IACpCsB,OAAO,CAACQ,IAAR,CAAaD,UAAb;EACD,CAF+B,EAE7B,CAACA,UAAD,EAAaP,OAAb,CAF6B,CAAhC;EAIA,OACE,cAAC,KAAD,IACE,IAAI,EAAEH,SADR,EAEE,MAAM,EAAEC,WAAF,WAAEA,WAAF,GAAkB,MAAM,IAFhC,EAGE,GAAG,EAAEhB,GAAG;;;;;OAHV,EASE,KAAK,EAAEC,CAAC,CAAC,qBAAD,EAAwBoB,SAAxB,CATV,EAUE,MAAM,EAAE,cAAC,WAAD,IAAa,YAAY,EAAEZ,YAA3B,GAVV,EAWE,UAAU,MAXZ,EAYE,SAAS,MAZX,EAaE,eAAe,EAAE;MACfkB,SAAS,EAAEV,KAAK,CAACW,QAAN,GAAiB,GADb;MAEfC,QAAQ,EAAEZ,KAAK,CAACW,QAAN,GAAiB,GAFZ;MAGfE,WAAW,EAAE;QACXC,KAAK,EAAE,MADI;QAEXC,MAAM,EAAE,MAFG,EAHE,EAbnB;;IAqBE,SAAS,MArBX,EAsBE,cAAc,MAtBhB,EAuBE,YAAY,EAAE,KAvBhB;EAyBE,cAAC,eAAD,IAAiB,QAAQ,EAAEnB,QAA3B,EAAqC,cAAc,EAAEC,cAArD,GAzBF,CADF;;AA6BD","names":["React","useCallback","useContext","useMemo","useHistory","css","t","useTheme","Modal","Button","useSelector","DashboardPageIdContext","DrillDetailPane","ModalFooter","exploreChart","closeModal","DrillDetailModal","chartId","formData","initialFilters","showModal","onHideModal","theme","history","dashboardPageId","slice_name","chartName","state","sliceEntities","slices","exploreUrl","push","minHeight","gridUnit","minWidth","defaultSize","width","height"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/src/components/Chart/DrillDetail/DrillDetailModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { Slice } from 'src/types/Chart';\nimport DrillDetailPane from './DrillDetailPane';\n\ninterface ModalFooterProps {\n  exploreChart: () => void;\n  closeModal?: () => void;\n}\n\nconst ModalFooter = ({ exploreChart, closeModal }: ModalFooterProps) => (\n  <>\n    <Button buttonStyle=\"secondary\" buttonSize=\"small\" onClick={exploreChart}>\n      {t('Edit chart')}\n    </Button>\n    <Button\n      buttonStyle=\"primary\"\n      buttonSize=\"small\"\n      onClick={closeModal}\n      data-test=\"close-drilltodetail-modal\"\n    >\n      {t('Close')}\n    </Button>\n  </>\n);\n\ninterface DrillDetailModalProps {\n  chartId: number;\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n  showModal: boolean;\n  onHideModal: () => void;\n}\n\nexport default function DrillDetailModal({\n  chartId,\n  formData,\n  initialFilters,\n  showModal,\n  onHideModal,\n}: DrillDetailModalProps) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector(\n    (state: { sliceEntities: { slices: Record<number, Slice> } }) =>\n      state.sliceEntities.slices[chartId],\n  );\n\n  const exploreUrl = useMemo(\n    () => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`,\n    [chartId, dashboardPageId],\n  );\n\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n\n  return (\n    <Modal\n      show={showModal}\n      onHide={onHideModal ?? (() => null)}\n      css={css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `}\n      title={t('Drill to detail: %s', chartName)}\n      footer={<ModalFooter exploreChart={exploreChart} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '75vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <DrillDetailPane formData={formData} initialFilters={initialFilters} />\n    </Modal>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}