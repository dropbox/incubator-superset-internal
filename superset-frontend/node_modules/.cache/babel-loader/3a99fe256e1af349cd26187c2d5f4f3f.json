{"ast":null,"code":"import _cloneDeep from \"lodash/cloneDeep\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsArray, hasGenericChartAxes, t } from '@superset-ui/core';\n\nimport { ControlSubSectionHeader, getStandardizedControls, sections, sharedControls } from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\nimport { EchartsTimeseriesSeriesType } from '../Timeseries/types';\nimport { legendSection, richTooltipSection } from '../controls';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst { area, logAxis, markerEnabled, markerSize, minorSplitLine, opacity, orderDesc, rowLimit, seriesType, showValues, stack, truncateYAxis, yAxisBounds, zoomable, xAxisLabelRotation, yAxisIndex } = DEFAULT_FORM_DATA;\nfunction createQuerySection(label, controlSuffix) {\n  return {\n    label,\n    expanded: true,\n    controlSetRows: [\n    [\n    {\n      name: `metrics${controlSuffix}`,\n      config: sharedControls.metrics }],\n\n\n    [\n    {\n      name: `groupby${controlSuffix}`,\n      config: sharedControls.groupby }],\n\n\n    [\n    {\n      name: `adhoc_filters${controlSuffix}`,\n      config: sharedControls.adhoc_filters }],\n\n\n    [\n    {\n      name: `limit${controlSuffix}`,\n      config: sharedControls.limit }],\n\n\n    [\n    {\n      name: `timeseries_limit_metric${controlSuffix}`,\n      config: sharedControls.timeseries_limit_metric }],\n\n\n    [\n    {\n      name: `order_desc${controlSuffix}`,\n      config: {\n        type: 'CheckboxControl',\n        label: t('Sort Descending'),\n        default: orderDesc,\n        description: t('Whether to sort descending or ascending') } }],\n\n\n\n    [\n    {\n      name: `row_limit${controlSuffix}`,\n      config: {\n        ...sharedControls.row_limit,\n        default: rowLimit } }],\n\n\n\n    [\n    {\n      name: `truncate_metric${controlSuffix}`,\n      config: {\n        ...sharedControls.truncate_metric,\n        default: sharedControls.truncate_metric.default } }]] };\n\n\n\n\n\n}\nfunction createCustomizeSection(label, controlSuffix) {\n  return [\n  [___EmotionJSX(ControlSubSectionHeader, null, label)],\n  [\n  {\n    name: `seriesType${controlSuffix}`,\n    config: {\n      type: 'SelectControl',\n      label: t('Series type'),\n      renderTrigger: true,\n      default: seriesType,\n      choices: [\n      [EchartsTimeseriesSeriesType.Line, t('Line')],\n      [EchartsTimeseriesSeriesType.Scatter, t('Scatter')],\n      [EchartsTimeseriesSeriesType.Smooth, t('Smooth Line')],\n      [EchartsTimeseriesSeriesType.Bar, t('Bar')],\n      [EchartsTimeseriesSeriesType.Start, t('Step - start')],\n      [EchartsTimeseriesSeriesType.Middle, t('Step - middle')],\n      [EchartsTimeseriesSeriesType.End, t('Step - end')]],\n\n      description: t('Series chart type (line, bar etc)') } }],\n\n\n\n  [\n  {\n    name: `stack${controlSuffix}`,\n    config: {\n      type: 'CheckboxControl',\n      label: t('Stack series'),\n      renderTrigger: true,\n      default: stack,\n      description: t('Stack series on top of each other') } }],\n\n\n\n  [\n  {\n    name: `area${controlSuffix}`,\n    config: {\n      type: 'CheckboxControl',\n      label: t('Area chart'),\n      renderTrigger: true,\n      default: area,\n      description: t('Draw area under curves. Only applicable for line types.') } }],\n\n\n\n  [\n  {\n    name: `show_value${controlSuffix}`,\n    config: {\n      type: 'CheckboxControl',\n      label: t('Show Values'),\n      renderTrigger: true,\n      default: showValues,\n      description: t('Whether to display the numerical values within the cells') } }],\n\n\n\n  [\n  {\n    name: `opacity${controlSuffix}`,\n    config: {\n      type: 'SliderControl',\n      label: t('Opacity'),\n      renderTrigger: true,\n      min: 0,\n      max: 1,\n      step: 0.1,\n      default: opacity,\n      description: t('Opacity of area chart.') } }],\n\n\n\n  [\n  {\n    name: `markerEnabled${controlSuffix}`,\n    config: {\n      type: 'CheckboxControl',\n      label: t('Marker'),\n      renderTrigger: true,\n      default: markerEnabled,\n      description: t('Draw a marker on data points. Only applicable for line types.') } }],\n\n\n\n  [\n  {\n    name: `markerSize${controlSuffix}`,\n    config: {\n      type: 'SliderControl',\n      label: t('Marker size'),\n      renderTrigger: true,\n      min: 0,\n      max: 100,\n      default: markerSize,\n      description: t('Size of marker. Also applies to forecast observations.') } }],\n\n\n\n  [\n  {\n    name: `yAxisIndex${controlSuffix}`,\n    config: {\n      type: 'SelectControl',\n      label: t('Y Axis'),\n      choices: [\n      [0, t('Primary')],\n      [1, t('Secondary')]],\n\n      default: yAxisIndex,\n      clearable: false,\n      renderTrigger: true,\n      description: t('Primary or secondary y-axis') } }]];\n\n\n\n\n}\nfunction createAdvancedAnalyticsSection(label, controlSuffix) {\n  const aaWithSuffix = _cloneDeep(sections.advancedAnalyticsControls);\n  aaWithSuffix.label = label;\n  if (!controlSuffix) {\n    return aaWithSuffix;\n  }\n  aaWithSuffix.controlSetRows.forEach((row) => row.forEach((control) => {\n    if (control != null && control.name) {\n      // eslint-disable-next-line no-param-reassign\n      control.name = `${control.name}${controlSuffix}`;\n    }\n  }));\n  return aaWithSuffix;\n}\nconst config = {\n  controlPanelSections: [\n  sections.genericTime,\n  hasGenericChartAxes ?\n  {\n    label: t('Shared query fields'),\n    expanded: true,\n    controlSetRows: [['x_axis'], ['time_grain_sqla']] } :\n\n  null,\n  createQuerySection(t('Query A'), ''),\n  createAdvancedAnalyticsSection(t('Advanced analytics Query A'), ''),\n  createQuerySection(t('Query B'), '_b'),\n  createAdvancedAnalyticsSection(t('Advanced analytics Query B'), '_b'),\n  sections.annotationsAndLayersControls,\n  sections.titleControls,\n  {\n    label: t('Chart Options'),\n    expanded: true,\n    controlSetRows: [\n    ['color_scheme'],\n    ...createCustomizeSection(t('Query A'), ''),\n    ...createCustomizeSection(t('Query B'), 'B'),\n    [\n    {\n      name: 'zoomable',\n      config: {\n        type: 'CheckboxControl',\n        label: t('Data Zoom'),\n        default: zoomable,\n        renderTrigger: true,\n        description: t('Enable data zooming controls') } }],\n\n\n\n    ...legendSection,\n    [___EmotionJSX(ControlSubSectionHeader, null, t('X Axis'))],\n    ['x_axis_time_format'],\n    [\n    {\n      name: 'xAxisLabelRotation',\n      config: {\n        type: 'SelectControl',\n        freeForm: true,\n        clearable: false,\n        label: t('Rotate x axis label'),\n        choices: [\n        [0, '0°'],\n        [45, '45°']],\n\n        default: xAxisLabelRotation,\n        renderTrigger: true,\n        description: t('Input field supports custom rotation. e.g. 30 for 30°') } }],\n\n\n\n    ...richTooltipSection,\n    // eslint-disable-next-line react/jsx-key\n    [___EmotionJSX(ControlSubSectionHeader, null, t('Y Axis'))],\n    [\n    {\n      name: 'minorSplitLine',\n      config: {\n        type: 'CheckboxControl',\n        label: t('Minor Split Line'),\n        renderTrigger: true,\n        default: minorSplitLine,\n        description: t('Draw split lines for minor y-axis ticks') } }],\n\n\n\n    [\n    {\n      name: 'truncateYAxis',\n      config: {\n        type: 'CheckboxControl',\n        label: t('Truncate Y Axis'),\n        default: truncateYAxis,\n        renderTrigger: true,\n        description: t('Truncate Y Axis. Can be overridden by specifying a min or max bound.') } }],\n\n\n\n    [\n    {\n      name: 'y_axis_bounds',\n      config: {\n        type: 'BoundsControl',\n        label: t('Primary y-axis Bounds'),\n        renderTrigger: true,\n        default: yAxisBounds,\n        description: t('Bounds for the primary Y-axis. When left empty, the bounds are ' +\n        'dynamically defined based on the min/max of the data. Note that ' +\n        \"this feature will only expand the axis range. It won't \" +\n        \"narrow the data's extent.\") } }],\n\n\n\n    [\n    {\n      name: `y_axis_format`,\n      config: {\n        ...sharedControls.y_axis_format,\n        label: t('Primary y-axis format') } }],\n\n\n\n    [\n    {\n      name: 'logAxis',\n      config: {\n        type: 'CheckboxControl',\n        label: t('Logarithmic y-axis'),\n        renderTrigger: true,\n        default: logAxis,\n        description: t('Logarithmic scale on primary y-axis') } }],\n\n\n\n    [\n    {\n      name: 'y_axis_bounds_secondary',\n      config: {\n        type: 'BoundsControl',\n        label: t('Secondary y-axis Bounds'),\n        renderTrigger: true,\n        default: yAxisBounds,\n        description: t(`Bounds for the secondary Y-axis. Only works when Independent Y-axis\n                bounds are enabled. When left empty, the bounds are dynamically defined\n                based on the min/max of the data. Note that this feature will only expand\n                the axis range. It won't narrow the data's extent.`) } }],\n\n\n\n    [\n    {\n      name: `y_axis_format_secondary`,\n      config: {\n        ...sharedControls.y_axis_format,\n        label: t('Secondary y-axis format') } }],\n\n\n\n    [\n    {\n      name: 'yAxisTitleSecondary',\n      config: {\n        type: 'TextControl',\n        label: t('Secondary y-axis title'),\n        renderTrigger: true,\n        default: '',\n        description: t('Logarithmic y-axis') } }],\n\n\n\n    [\n    {\n      name: 'logAxisSecondary',\n      config: {\n        type: 'CheckboxControl',\n        label: t('Logarithmic y-axis'),\n        renderTrigger: true,\n        default: logAxis,\n        description: t('Logarithmic scale on secondary y-axis') } }]] }],\n\n\n\n\n\n\n  formDataOverrides: (formData) => {\n    const groupby = getStandardizedControls().controls.columns.filter((col) => {var _context;return !_includesInstanceProperty(_context = ensureIsArray(formData.groupby_b)).call(_context, col);});\n    getStandardizedControls().controls.columns =\n    getStandardizedControls().controls.columns.filter((col) => !_includesInstanceProperty(groupby).call(groupby, col));\n    const metrics = getStandardizedControls().controls.metrics.filter((metric) => {var _context2;return !_includesInstanceProperty(_context2 = ensureIsArray(formData.metrics_b)).call(_context2, metric);});\n    getStandardizedControls().controls.metrics =\n    getStandardizedControls().controls.metrics.filter((col) => !_includesInstanceProperty(metrics).call(metrics, col));\n    return {\n      ...formData,\n      metrics,\n      groupby };\n\n  } };\n\nexport default config;","map":{"version":3,"mappings":"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","names":["React","ensureIsArray","hasGenericChartAxes","t","ControlSubSectionHeader","getStandardizedControls","sections","sharedControls","DEFAULT_FORM_DATA","EchartsTimeseriesSeriesType","legendSection","richTooltipSection","area","logAxis","markerEnabled","markerSize","minorSplitLine","opacity","orderDesc","rowLimit","seriesType","showValues","stack","truncateYAxis","yAxisBounds","zoomable","xAxisLabelRotation","yAxisIndex","createQuerySection","label","controlSuffix","expanded","controlSetRows","name","config","metrics","groupby","adhoc_filters","limit","timeseries_limit_metric","type","default","description","row_limit","truncate_metric","createCustomizeSection","renderTrigger","choices","Line","Scatter","Smooth","Bar","Start","Middle","End","min","max","step","clearable","createAdvancedAnalyticsSection","aaWithSuffix","advancedAnalyticsControls","forEach","row","control","controlPanelSections","genericTime","annotationsAndLayersControls","titleControls","freeForm","y_axis_format","formDataOverrides","controls","columns","filter","formData","groupby_b","col","metrics_b","metric"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/plugins/plugin-chart-echarts/src/MixedTimeseries/controlPanel.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsArray, hasGenericChartAxes, t } from '@superset-ui/core';\nimport { cloneDeep } from 'lodash';\nimport {\n  ControlPanelConfig,\n  ControlPanelSectionConfig,\n  ControlSetRow,\n  ControlSubSectionHeader,\n  CustomControlItem,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { DEFAULT_FORM_DATA } from './types';\nimport { EchartsTimeseriesSeriesType } from '../Timeseries/types';\nimport { legendSection, richTooltipSection } from '../controls';\n\nconst {\n  area,\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  opacity,\n  orderDesc,\n  rowLimit,\n  seriesType,\n  showValues,\n  stack,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n  xAxisLabelRotation,\n  yAxisIndex,\n} = DEFAULT_FORM_DATA;\n\nfunction createQuerySection(\n  label: string,\n  controlSuffix: string,\n): ControlPanelSectionConfig {\n  return {\n    label,\n    expanded: true,\n    controlSetRows: [\n      [\n        {\n          name: `metrics${controlSuffix}`,\n          config: sharedControls.metrics,\n        },\n      ],\n      [\n        {\n          name: `groupby${controlSuffix}`,\n          config: sharedControls.groupby,\n        },\n      ],\n      [\n        {\n          name: `adhoc_filters${controlSuffix}`,\n          config: sharedControls.adhoc_filters,\n        },\n      ],\n      [\n        {\n          name: `limit${controlSuffix}`,\n          config: sharedControls.limit,\n        },\n      ],\n      [\n        {\n          name: `timeseries_limit_metric${controlSuffix}`,\n          config: sharedControls.timeseries_limit_metric,\n        },\n      ],\n      [\n        {\n          name: `order_desc${controlSuffix}`,\n          config: {\n            type: 'CheckboxControl',\n            label: t('Sort Descending'),\n            default: orderDesc,\n            description: t('Whether to sort descending or ascending'),\n          },\n        },\n      ],\n      [\n        {\n          name: `row_limit${controlSuffix}`,\n          config: {\n            ...sharedControls.row_limit,\n            default: rowLimit,\n          },\n        },\n      ],\n      [\n        {\n          name: `truncate_metric${controlSuffix}`,\n          config: {\n            ...sharedControls.truncate_metric,\n            default: sharedControls.truncate_metric.default,\n          },\n        },\n      ],\n    ],\n  };\n}\n\nfunction createCustomizeSection(\n  label: string,\n  controlSuffix: string,\n): ControlSetRow[] {\n  return [\n    [<ControlSubSectionHeader>{label}</ControlSubSectionHeader>],\n    [\n      {\n        name: `seriesType${controlSuffix}`,\n        config: {\n          type: 'SelectControl',\n          label: t('Series type'),\n          renderTrigger: true,\n          default: seriesType,\n          choices: [\n            [EchartsTimeseriesSeriesType.Line, t('Line')],\n            [EchartsTimeseriesSeriesType.Scatter, t('Scatter')],\n            [EchartsTimeseriesSeriesType.Smooth, t('Smooth Line')],\n            [EchartsTimeseriesSeriesType.Bar, t('Bar')],\n            [EchartsTimeseriesSeriesType.Start, t('Step - start')],\n            [EchartsTimeseriesSeriesType.Middle, t('Step - middle')],\n            [EchartsTimeseriesSeriesType.End, t('Step - end')],\n          ],\n          description: t('Series chart type (line, bar etc)'),\n        },\n      },\n    ],\n    [\n      {\n        name: `stack${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Stack series'),\n          renderTrigger: true,\n          default: stack,\n          description: t('Stack series on top of each other'),\n        },\n      },\n    ],\n    [\n      {\n        name: `area${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Area chart'),\n          renderTrigger: true,\n          default: area,\n          description: t(\n            'Draw area under curves. Only applicable for line types.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `show_value${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Show Values'),\n          renderTrigger: true,\n          default: showValues,\n          description: t(\n            'Whether to display the numerical values within the cells',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `opacity${controlSuffix}`,\n        config: {\n          type: 'SliderControl',\n          label: t('Opacity'),\n          renderTrigger: true,\n          min: 0,\n          max: 1,\n          step: 0.1,\n          default: opacity,\n          description: t('Opacity of area chart.'),\n        },\n      },\n    ],\n    [\n      {\n        name: `markerEnabled${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Marker'),\n          renderTrigger: true,\n          default: markerEnabled,\n          description: t(\n            'Draw a marker on data points. Only applicable for line types.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `markerSize${controlSuffix}`,\n        config: {\n          type: 'SliderControl',\n          label: t('Marker size'),\n          renderTrigger: true,\n          min: 0,\n          max: 100,\n          default: markerSize,\n          description: t(\n            'Size of marker. Also applies to forecast observations.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `yAxisIndex${controlSuffix}`,\n        config: {\n          type: 'SelectControl',\n          label: t('Y Axis'),\n          choices: [\n            [0, t('Primary')],\n            [1, t('Secondary')],\n          ],\n          default: yAxisIndex,\n          clearable: false,\n          renderTrigger: true,\n          description: t('Primary or secondary y-axis'),\n        },\n      },\n    ],\n  ];\n}\n\nfunction createAdvancedAnalyticsSection(\n  label: string,\n  controlSuffix: string,\n): ControlPanelSectionConfig {\n  const aaWithSuffix = cloneDeep(sections.advancedAnalyticsControls);\n  aaWithSuffix.label = label;\n  if (!controlSuffix) {\n    return aaWithSuffix;\n  }\n  aaWithSuffix.controlSetRows.forEach(row =>\n    row.forEach((control: CustomControlItem) => {\n      if (control?.name) {\n        // eslint-disable-next-line no-param-reassign\n        control.name = `${control.name}${controlSuffix}`;\n      }\n    }),\n  );\n  return aaWithSuffix;\n}\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.genericTime,\n    hasGenericChartAxes\n      ? {\n          label: t('Shared query fields'),\n          expanded: true,\n          controlSetRows: [['x_axis'], ['time_grain_sqla']],\n        }\n      : null,\n    createQuerySection(t('Query A'), ''),\n    createAdvancedAnalyticsSection(t('Advanced analytics Query A'), ''),\n    createQuerySection(t('Query B'), '_b'),\n    createAdvancedAnalyticsSection(t('Advanced analytics Query B'), '_b'),\n    sections.annotationsAndLayersControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ...createCustomizeSection(t('Query A'), ''),\n        ...createCustomizeSection(t('Query B'), 'B'),\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        ['x_axis_time_format'],\n        [\n          {\n            name: 'xAxisLabelRotation',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              clearable: false,\n              label: t('Rotate x axis label'),\n              choices: [\n                [0, '0°'],\n                [45, '45°'],\n              ],\n              default: xAxisLabelRotation,\n              renderTrigger: true,\n              description: t(\n                'Input field supports custom rotation. e.g. 30 for 30°',\n              ),\n            },\n          },\n        ],\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Primary y-axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the primary Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: `y_axis_format`,\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Primary y-axis format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic scale on primary y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds_secondary',\n            config: {\n              type: 'BoundsControl',\n              label: t('Secondary y-axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                `Bounds for the secondary Y-axis. Only works when Independent Y-axis\n                bounds are enabled. When left empty, the bounds are dynamically defined\n                based on the min/max of the data. Note that this feature will only expand\n                the axis range. It won't narrow the data's extent.`,\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: `y_axis_format_secondary`,\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Secondary y-axis format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'yAxisTitleSecondary',\n            config: {\n              type: 'TextControl',\n              label: t('Secondary y-axis title'),\n              renderTrigger: true,\n              default: '',\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'logAxisSecondary',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic scale on secondary y-axis'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => {\n    const groupby = getStandardizedControls().controls.columns.filter(\n      col => !ensureIsArray(formData.groupby_b).includes(col),\n    );\n    getStandardizedControls().controls.columns =\n      getStandardizedControls().controls.columns.filter(\n        col => !groupby.includes(col),\n      );\n\n    const metrics = getStandardizedControls().controls.metrics.filter(\n      metric => !ensureIsArray(formData.metrics_b).includes(metric),\n    );\n    getStandardizedControls().controls.metrics =\n      getStandardizedControls().controls.metrics.filter(\n        col => !metrics.includes(col),\n      );\n\n    return {\n      ...formData,\n      metrics,\n      groupby,\n    };\n  },\n};\n\nexport default config;\n"]},"metadata":{},"sourceType":"module"}