{"ast":null,"code":"/* eslint-disable react/no-array-index-key */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PathLayer } from 'deck.gl';\nimport React from 'react';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { createDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nfunction setTooltipContent(o) {\n  return (\n    o.object.extraProps &&\n    ___EmotionJSX(\"div\", { className: \"deckgl-tooltip\" },\n    Object.keys(o.object.extraProps).map((prop, index) =>\n    ___EmotionJSX(TooltipRow, {\n      key: `prop-${index}`,\n      label: `${prop}: `,\n      value: `${o.object.extraProps[prop]}` }))));\n\n\n\n\n\n}\n\nexport function getLayer(formData, payload, onAddFilter, setTooltip) {\n  const fd = formData;\n  const c = fd.color_picker;\n  const fixedColor = [c.r, c.g, c.b, 255 * c.a];\n  let data = payload.data.features.map((feature) => ({\n    ...feature,\n    path: feature.path,\n    width: fd.line_width,\n    color: fixedColor }));\n\n\n  if (fd.js_data_mutator) {\n    const jsFnMutator = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutator(data);\n  }\n\n  return new PathLayer({\n    id: `path-layer-${fd.slice_id}`,\n    getColor: (d) => d.color,\n    getPath: (d) => d.path,\n    getWidth: (d) => d.width,\n    data,\n    rounded: true,\n    widthScale: 1,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent) });\n\n}\n\nfunction getPoints(data) {\n  let points = [];\n  data.forEach((d) => {\n    points = points.concat(d.path);\n  });\n\n  return points;\n}\n\nexport default createDeckGLComponent(getLayer, getPoints);","map":{"version":3,"names":["PathLayer","React","commonLayerProps","sandboxedEval","createDeckGLComponent","TooltipRow","setTooltipContent","o","object","extraProps","Object","keys","map","prop","index","getLayer","formData","payload","onAddFilter","setTooltip","fd","c","color_picker","fixedColor","r","g","b","a","data","features","feature","path","width","line_width","color","js_data_mutator","jsFnMutator","id","slice_id","getColor","d","getPath","getWidth","rounded","widthScale","getPoints","points","forEach","concat"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Path/Path.jsx"],"sourcesContent":["/* eslint-disable react/no-array-index-key */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PathLayer } from 'deck.gl';\nimport React from 'react';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { createDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\n\nfunction setTooltipContent(o) {\n  return (\n    o.object.extraProps && (\n      <div className=\"deckgl-tooltip\">\n        {Object.keys(o.object.extraProps).map((prop, index) => (\n          <TooltipRow\n            key={`prop-${index}`}\n            label={`${prop}: `}\n            value={`${o.object.extraProps[prop]}`}\n          />\n        ))}\n      </div>\n    )\n  );\n}\n\nexport function getLayer(formData, payload, onAddFilter, setTooltip) {\n  const fd = formData;\n  const c = fd.color_picker;\n  const fixedColor = [c.r, c.g, c.b, 255 * c.a];\n  let data = payload.data.features.map(feature => ({\n    ...feature,\n    path: feature.path,\n    width: fd.line_width,\n    color: fixedColor,\n  }));\n\n  if (fd.js_data_mutator) {\n    const jsFnMutator = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutator(data);\n  }\n\n  return new PathLayer({\n    id: `path-layer-${fd.slice_id}`,\n    getColor: d => d.color,\n    getPath: d => d.path,\n    getWidth: d => d.width,\n    data,\n    rounded: true,\n    widthScale: 1,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent),\n  });\n}\n\nfunction getPoints(data) {\n  let points = [];\n  data.forEach(d => {\n    points = points.concat(d.path);\n  });\n\n  return points;\n}\n\nexport default createDeckGLComponent(getLayer, getPoints);\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,SAA1B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,gBAAT,QAAiC,WAAjC;AACA,OAAOC,aAAP,MAA0B,qBAA1B;AACA,SAASC,qBAAT,QAAsC,eAAtC;AACA,OAAOC,UAAP,MAAuB,kBAAvB,C;;AAEA,SAASC,iBAAT,CAA2BC,CAA3B,EAA8B;EAC5B;IACEA,CAAC,CAACC,MAAF,CAASC,UAAT;IACE,uBAAK,SAAS,EAAC,gBAAf;IACGC,MAAM,CAACC,IAAP,CAAYJ,CAAC,CAACC,MAAF,CAASC,UAArB,EAAiCG,GAAjC,CAAqC,CAACC,IAAD,EAAOC,KAAP;IACpC,cAAC,UAAD;MACE,GAAG,EAAG,QAAOA,KAAM,EADrB;MAEE,KAAK,EAAG,GAAED,IAAK,IAFjB;MAGE,KAAK,EAAG,GAAEN,CAAC,CAACC,MAAF,CAASC,UAAT,CAAoBI,IAApB,CAA0B,EAHtC,GADD,CADH,CAFJ;;;;;;AAaD;;AAED,OAAO,SAASE,QAAT,CAAkBC,QAAlB,EAA4BC,OAA5B,EAAqCC,WAArC,EAAkDC,UAAlD,EAA8D;EACnE,MAAMC,EAAE,GAAGJ,QAAX;EACA,MAAMK,CAAC,GAAGD,EAAE,CAACE,YAAb;EACA,MAAMC,UAAU,GAAG,CAACF,CAAC,CAACG,CAAH,EAAMH,CAAC,CAACI,CAAR,EAAWJ,CAAC,CAACK,CAAb,EAAgB,MAAML,CAAC,CAACM,CAAxB,CAAnB;EACA,IAAIC,IAAI,GAAGX,OAAO,CAACW,IAAR,CAAaC,QAAb,CAAsBjB,GAAtB,CAA0B,CAAAkB,OAAO,MAAK;IAC/C,GAAGA,OAD4C;IAE/CC,IAAI,EAAED,OAAO,CAACC,IAFiC;IAG/CC,KAAK,EAAEZ,EAAE,CAACa,UAHqC;IAI/CC,KAAK,EAAEX,UAJwC,EAAL,CAAjC,CAAX;;;EAOA,IAAIH,EAAE,CAACe,eAAP,EAAwB;IACtB,MAAMC,WAAW,GAAGjC,aAAa,CAACiB,EAAE,CAACe,eAAJ,CAAjC;IACAP,IAAI,GAAGQ,WAAW,CAACR,IAAD,CAAlB;EACD;;EAED,OAAO,IAAI5B,SAAJ,CAAc;IACnBqC,EAAE,EAAG,cAAajB,EAAE,CAACkB,QAAS,EADX;IAEnBC,QAAQ,EAAE,CAAAC,CAAC,KAAIA,CAAC,CAACN,KAFE;IAGnBO,OAAO,EAAE,CAAAD,CAAC,KAAIA,CAAC,CAACT,IAHG;IAInBW,QAAQ,EAAE,CAAAF,CAAC,KAAIA,CAAC,CAACR,KAJE;IAKnBJ,IALmB;IAMnBe,OAAO,EAAE,IANU;IAOnBC,UAAU,EAAE,CAPO;IAQnB,GAAG1C,gBAAgB,CAACkB,EAAD,EAAKD,UAAL,EAAiBb,iBAAjB,CARA,EAAd,CAAP;;AAUD;;AAED,SAASuC,SAAT,CAAmBjB,IAAnB,EAAyB;EACvB,IAAIkB,MAAM,GAAG,EAAb;EACAlB,IAAI,CAACmB,OAAL,CAAa,CAAAP,CAAC,KAAI;IAChBM,MAAM,GAAGA,MAAM,CAACE,MAAP,CAAcR,CAAC,CAACT,IAAhB,CAAT;EACD,CAFD;;EAIA,OAAOe,MAAP;AACD;;AAED,eAAe1C,qBAAqB,CAACW,QAAD,EAAW8B,SAAX,CAApC"},"metadata":{},"sourceType":"module"}