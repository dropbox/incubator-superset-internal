{"ast":null,"code":"import { css as _css } from \"@emotion/react\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo, useState, useEffect } from 'react';\nimport { css, GenericDataType, getTimeFormatter, safeHtmlSpan, styled, t, TimeFormats, useTheme } from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport debounce from 'lodash/debounce';\nimport { Space } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport { BOOL_FALSE_DISPLAY, BOOL_TRUE_DISPLAY, NULL_DISPLAY, SLOW_DEBOUNCE } from 'src/constants';\nimport { Radio } from 'src/components/Radio';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport Popover from 'src/components/Popover';\nimport { prepareCopyToClipboardTabularData } from 'src/utils/common';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport RowCountLabel from 'src/explore/components/RowCountLabel';\nimport { getTimeColumns, setTimeColumns } from './utils';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nexport const CellNull = styled('span')`\n  color: ${(_ref) => {let { theme } = _ref;return theme.colors.grayscale.light1;}};\n`;\nexport const CopyButton = styled(Button)`\n  font-size: ${(_ref2) => {let { theme } = _ref2;return theme.typography.sizes.s;}}px;\n\n  // needed to override button's first-of-type margin: 0\n  && {\n    margin: 0 ${(_ref3) => {let { theme } = _ref3;return theme.gridUnit * 2;}}px;\n  }\n\n  i {\n    padding: 0 ${(_ref4) => {let { theme } = _ref4;return theme.gridUnit;}}px;\n  }\n`;\nexport const CopyToClipboardButton = (_ref5) => {let { data, columns } = _ref5;\n  const theme = useTheme();\n  return ___EmotionJSX(CopyToClipboard, { text: data && columns ? prepareCopyToClipboardTabularData(data, columns) : '', wrapped: false, copyNode: ___EmotionJSX(Icons.CopyOutlined, { iconColor: theme.colors.grayscale.base, iconSize: \"l\", \"aria-label\": t('Copy'), role: \"button\", css: css`\n            &.anticon > * {\n              line-height: 0;\n            }\n          ` }) });\n};\nexport const FilterInput = (_ref6) => {let { onChangeHandler } = _ref6;\n  const theme = useTheme();\n  const debouncedChangeHandler = debounce(onChangeHandler, SLOW_DEBOUNCE);\n  return ___EmotionJSX(Input, { prefix: ___EmotionJSX(Icons.Search, { iconColor: theme.colors.grayscale.base }), placeholder: t('Search'), onChange: (event) => {\n      const filterText = event.target.value;\n      debouncedChangeHandler(filterText);\n    }, css: css`\n        width: 200px;\n        margin-right: ${theme.gridUnit * 2}px;\n      ` });\n};\nexport const RowCount = (_ref7) => {var _data$length;let { data, loading } = _ref7;return ___EmotionJSX(RowCountLabel, { rowcount: (_data$length = data == null ? void 0 : data.length) != null ? _data$length : 0, loading: loading });};\nvar FormatPickerValue;\n(function (FormatPickerValue) {\n  FormatPickerValue[\"Formatted\"] = \"formatted\";\n  FormatPickerValue[\"Original\"] = \"original\";\n})(FormatPickerValue || (FormatPickerValue = {}));\nconst FormatPicker = (_ref8) => {let { onChange, value } = _ref8;return ___EmotionJSX(Radio.Group, { value: value, onChange: onChange },\n  ___EmotionJSX(Space, { direction: \"vertical\" },\n  ___EmotionJSX(Radio, { value: FormatPickerValue.Formatted }, t('Formatted date')),\n  ___EmotionJSX(Radio, { value: FormatPickerValue.Original }, t('Original value'))));};\n\n\nconst FormatPickerContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  padding: ${(_ref9) => {let { theme } = _ref9;return `${theme.gridUnit * 4}px`;}};\n`;\nconst FormatPickerLabel = styled.span`\n  font-size: ${(_ref10) => {let { theme } = _ref10;return theme.typography.sizes.s;}}px;\n  color: ${(_ref11) => {let { theme } = _ref11;return theme.colors.grayscale.base;}};\n  margin-bottom: ${(_ref12) => {let { theme } = _ref12;return theme.gridUnit * 2;}}px;\n  text-transform: uppercase;\n`;\nconst DataTableTemporalHeaderCell = (_ref13) => {let { columnName, onTimeColumnChange, datasourceId, isOriginalTimeColumn } = _ref13;\n  const theme = useTheme();\n  const onChange = (e) => {\n    onTimeColumnChange(columnName, e.target.value);\n  };\n  const overlayContent = useMemo(() => datasourceId ? // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n  ___EmotionJSX(FormatPickerContainer, { onClick: (e) => e.stopPropagation() },\n\n  ___EmotionJSX(Global, { styles: css`\n              .column-formatting-popover .ant-popover-inner-content {\n                padding: 0;\n              }\n            ` }),\n  ___EmotionJSX(FormatPickerLabel, null, t('Column Formatting')),\n  ___EmotionJSX(FormatPicker, { onChange: onChange, value: isOriginalTimeColumn ?\n    FormatPickerValue.Original :\n    FormatPickerValue.Formatted })) :\n  null, [datasourceId, isOriginalTimeColumn]);\n  return datasourceId ? ___EmotionJSX(\"span\", null,\n  ___EmotionJSX(Popover, { overlayClassName: \"column-formatting-popover\", trigger: \"click\", content: overlayContent, placement: \"bottomLeft\", arrowPointAtCenter: true },\n  ___EmotionJSX(Icons.SettingOutlined, { iconSize: \"m\", iconColor: theme.colors.grayscale.light1, css: /*#__PURE__*/_css({ marginRight: `${theme.gridUnit}px` }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:DataTableTemporalHeaderCell;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96aGFvcnVpL3NyYy9pbmN1YmF0b3Itc3VwZXJzZXQtaW50ZXJuYWwvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9EYXRhVGFibGVDb250cm9sL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUErR3NGIiwiZmlsZSI6Ii9Vc2Vycy96aGFvcnVpL3NyYy9pbmN1YmF0b3Itc3VwZXJzZXQtaW50ZXJuYWwvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9EYXRhVGFibGVDb250cm9sL2luZGV4LnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VNZW1vLCB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgY3NzLCBHZW5lcmljRGF0YVR5cGUsIGdldFRpbWVGb3JtYXR0ZXIsIHNhZmVIdG1sU3Bhbiwgc3R5bGVkLCB0LCBUaW1lRm9ybWF0cywgdXNlVGhlbWUsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgR2xvYmFsIH0gZnJvbSAnQGVtb3Rpb24vcmVhY3QnO1xuaW1wb3J0IGRlYm91bmNlIGZyb20gJ2xvZGFzaC9kZWJvdW5jZSc7XG5pbXBvcnQgeyBTcGFjZSB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvSW5wdXQnO1xuaW1wb3J0IHsgQk9PTF9GQUxTRV9ESVNQTEFZLCBCT09MX1RSVUVfRElTUExBWSwgTlVMTF9ESVNQTEFZLCBTTE9XX0RFQk9VTkNFLCB9IGZyb20gJ3NyYy9jb25zdGFudHMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFBvcG92ZXIgZnJvbSAnc3JjL2NvbXBvbmVudHMvUG9wb3Zlcic7XG5pbXBvcnQgeyBwcmVwYXJlQ29weVRvQ2xpcGJvYXJkVGFidWxhckRhdGEgfSBmcm9tICdzcmMvdXRpbHMvY29tbW9uJztcbmltcG9ydCBDb3B5VG9DbGlwYm9hcmQgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ29weVRvQ2xpcGJvYXJkJztcbmltcG9ydCBSb3dDb3VudExhYmVsIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvUm93Q291bnRMYWJlbCc7XG5pbXBvcnQgeyBnZXRUaW1lQ29sdW1ucywgc2V0VGltZUNvbHVtbnMgfSBmcm9tICcuL3V0aWxzJztcbmV4cG9ydCBjb25zdCBDZWxsTnVsbCA9IHN0eWxlZCgnc3BhbicpIGBcbiAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuYDtcbmV4cG9ydCBjb25zdCBDb3B5QnV0dG9uID0gc3R5bGVkKEJ1dHRvbikgYFxuICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zfXB4O1xuXG4gIC8vIG5lZWRlZCB0byBvdmVycmlkZSBidXR0b24ncyBmaXJzdC1vZi10eXBlIG1hcmdpbjogMFxuICAmJiB7XG4gICAgbWFyZ2luOiAwICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB9XG5cbiAgaSB7XG4gICAgcGFkZGluZzogMCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuZXhwb3J0IGNvbnN0IENvcHlUb0NsaXBib2FyZEJ1dHRvbiA9ICh7IGRhdGEsIGNvbHVtbnMsIH0pID0+IHtcbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKCk7XG4gICAgcmV0dXJuICg8Q29weVRvQ2xpcGJvYXJkIHRleHQ9e2RhdGEgJiYgY29sdW1ucyA/IHByZXBhcmVDb3B5VG9DbGlwYm9hcmRUYWJ1bGFyRGF0YShkYXRhLCBjb2x1bW5zKSA6ICcnfSB3cmFwcGVkPXtmYWxzZX0gY29weU5vZGU9ezxJY29ucy5Db3B5T3V0bGluZWQgaWNvbkNvbG9yPXt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9IGljb25TaXplPVwibFwiIGFyaWEtbGFiZWw9e3QoJ0NvcHknKX0gcm9sZT1cImJ1dHRvblwiIGNzcz17Y3NzIGBcbiAgICAgICAgICAgICYuYW50aWNvbiA+ICoge1xuICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgfS8+fS8+KTtcbn07XG5leHBvcnQgY29uc3QgRmlsdGVySW5wdXQgPSAoeyBvbkNoYW5nZUhhbmRsZXIsIH0pID0+IHtcbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKCk7XG4gICAgY29uc3QgZGVib3VuY2VkQ2hhbmdlSGFuZGxlciA9IGRlYm91bmNlKG9uQ2hhbmdlSGFuZGxlciwgU0xPV19ERUJPVU5DRSk7XG4gICAgcmV0dXJuICg8SW5wdXQgcHJlZml4PXs8SWNvbnMuU2VhcmNoIGljb25Db2xvcj17dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfS8+fSBwbGFjZWhvbGRlcj17dCgnU2VhcmNoJyl9IG9uQ2hhbmdlPXsoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlclRleHQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICBkZWJvdW5jZWRDaGFuZ2VIYW5kbGVyKGZpbHRlclRleHQpO1xuICAgICAgICB9fSBjc3M9e2NzcyBgXG4gICAgICAgIHdpZHRoOiAyMDBweDtcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiAke3RoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgICAgIGB9Lz4pO1xufTtcbmV4cG9ydCBjb25zdCBSb3dDb3VudCA9ICh7IGRhdGEsIGxvYWRpbmcsIH0pID0+IDxSb3dDb3VudExhYmVsIHJvd2NvdW50PXtkYXRhPy5sZW5ndGggPz8gMH0gbG9hZGluZz17bG9hZGluZ30vPjtcbnZhciBGb3JtYXRQaWNrZXJWYWx1ZTtcbihmdW5jdGlvbiAoRm9ybWF0UGlja2VyVmFsdWUpIHtcbiAgICBGb3JtYXRQaWNrZXJWYWx1ZVtcIkZvcm1hdHRlZFwiXSA9IFwiZm9ybWF0dGVkXCI7XG4gICAgRm9ybWF0UGlja2VyVmFsdWVbXCJPcmlnaW5hbFwiXSA9IFwib3JpZ2luYWxcIjtcbn0pKEZvcm1hdFBpY2tlclZhbHVlIHx8IChGb3JtYXRQaWNrZXJWYWx1ZSA9IHt9KSk7XG5jb25zdCBGb3JtYXRQaWNrZXIgPSAoeyBvbkNoYW5nZSwgdmFsdWUsIH0pID0+ICg8UmFkaW8uR3JvdXAgdmFsdWU9e3ZhbHVlfSBvbkNoYW5nZT17b25DaGFuZ2V9PlxuICAgIDxTcGFjZSBkaXJlY3Rpb249XCJ2ZXJ0aWNhbFwiPlxuICAgICAgPFJhZGlvIHZhbHVlPXtGb3JtYXRQaWNrZXJWYWx1ZS5Gb3JtYXR0ZWR9Pnt0KCdGb3JtYXR0ZWQgZGF0ZScpfTwvUmFkaW8+XG4gICAgICA8UmFkaW8gdmFsdWU9e0Zvcm1hdFBpY2tlclZhbHVlLk9yaWdpbmFsfT57dCgnT3JpZ2luYWwgdmFsdWUnKX08L1JhZGlvPlxuICAgIDwvU3BhY2U+XG4gIDwvUmFkaW8uR3JvdXA+KTtcbmNvbnN0IEZvcm1hdFBpY2tlckNvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXG4gIHBhZGRpbmc6ICR7KHsgdGhlbWUgfSkgPT4gYCR7dGhlbWUuZ3JpZFVuaXQgKiA0fXB4YH07XG5gO1xuY29uc3QgRm9ybWF0UGlja2VyTGFiZWwgPSBzdHlsZWQuc3BhbiBgXG4gIGZvbnQtc2l6ZTogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LnNpemVzLnN9cHg7XG4gIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG4gIG1hcmdpbi1ib3R0b206ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuYDtcbmNvbnN0IERhdGFUYWJsZVRlbXBvcmFsSGVhZGVyQ2VsbCA9ICh7IGNvbHVtbk5hbWUsIG9uVGltZUNvbHVtbkNoYW5nZSwgZGF0YXNvdXJjZUlkLCBpc09yaWdpbmFsVGltZUNvbHVtbiwgfSkgPT4ge1xuICAgIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKTtcbiAgICBjb25zdCBvbkNoYW5nZSA9IChlKSA9PiB7XG4gICAgICAgIG9uVGltZUNvbHVtbkNoYW5nZShjb2x1bW5OYW1lLCBlLnRhcmdldC52YWx1ZSk7XG4gICAgfTtcbiAgICBjb25zdCBvdmVybGF5Q29udGVudCA9IHVzZU1lbW8oKCkgPT4gZGF0YXNvdXJjZUlkID8gKCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUganN4LWExMXkvbm8tc3RhdGljLWVsZW1lbnQtaW50ZXJhY3Rpb25zXG4gICAgPEZvcm1hdFBpY2tlckNvbnRhaW5lciBvbkNsaWNrPXtlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCl9PlxuICAgICAgICAgIHsvKiBoYWNrIHRvIGRpc2FibGUgY2xpY2sgcHJvcGFnYXRpb24gZnJvbSBwb3BvdmVyIGNvbnRlbnQgdG8gdGFibGUgaGVhZGVyLCB3aGljaCB0cmlnZ2VycyBzb3J0aW5nIGNvbHVtbiAqL31cbiAgICAgICAgICA8R2xvYmFsIHN0eWxlcz17Y3NzIGBcbiAgICAgICAgICAgICAgLmNvbHVtbi1mb3JtYXR0aW5nLXBvcG92ZXIgLmFudC1wb3BvdmVyLWlubmVyLWNvbnRlbnQge1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGB9Lz5cbiAgICAgICAgICA8Rm9ybWF0UGlja2VyTGFiZWw+e3QoJ0NvbHVtbiBGb3JtYXR0aW5nJyl9PC9Gb3JtYXRQaWNrZXJMYWJlbD5cbiAgICAgICAgICA8Rm9ybWF0UGlja2VyIG9uQ2hhbmdlPXtvbkNoYW5nZX0gdmFsdWU9e2lzT3JpZ2luYWxUaW1lQ29sdW1uXG4gICAgICAgICAgICA/IEZvcm1hdFBpY2tlclZhbHVlLk9yaWdpbmFsXG4gICAgICAgICAgICA6IEZvcm1hdFBpY2tlclZhbHVlLkZvcm1hdHRlZH0vPlxuICAgICAgICA8L0Zvcm1hdFBpY2tlckNvbnRhaW5lcj4pIDogbnVsbCwgW2RhdGFzb3VyY2VJZCwgaXNPcmlnaW5hbFRpbWVDb2x1bW5dKTtcbiAgICByZXR1cm4gZGF0YXNvdXJjZUlkID8gKDxzcGFuPlxuICAgICAgPFBvcG92ZXIgb3ZlcmxheUNsYXNzTmFtZT1cImNvbHVtbi1mb3JtYXR0aW5nLXBvcG92ZXJcIiB0cmlnZ2VyPVwiY2xpY2tcIiBjb250ZW50PXtvdmVybGF5Q29udGVudH0gcGxhY2VtZW50PVwiYm90dG9tTGVmdFwiIGFycm93UG9pbnRBdENlbnRlcj5cbiAgICAgICAgPEljb25zLlNldHRpbmdPdXRsaW5lZCBpY29uU2l6ZT1cIm1cIiBpY29uQ29sb3I9e3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQxfSBjc3M9e3sgbWFyZ2luUmlnaHQ6IGAke3RoZW1lLmdyaWRVbml0fXB4YCB9fSBvbkNsaWNrPXtlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCl9Lz5cbiAgICAgIDwvUG9wb3Zlcj5cbiAgICAgIHtjb2x1bW5OYW1lfVxuICAgIDwvc3Bhbj4pIDogKDxzcGFuPntjb2x1bW5OYW1lfTwvc3Bhbj4pO1xufTtcbmV4cG9ydCBjb25zdCB1c2VGaWx0ZXJlZFRhYmxlRGF0YSA9IChmaWx0ZXJUZXh0LCBkYXRhKSA9PiB7XG4gICAgY29uc3Qgcm93c0FzU3RyaW5ncyA9IHVzZU1lbW8oKCkgPT4gZGF0YT8ubWFwKChyb3cpID0+IE9iamVjdC52YWx1ZXMocm93KS5tYXAodmFsdWUgPT4gdmFsdWUgPyB2YWx1ZS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkgOiB0KCdOL0EnKSkpID8/IFtdLCBbZGF0YV0pO1xuICAgIHJldHVybiB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgaWYgKCFkYXRhPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoKF8sIGluZGV4KSA9PiByb3dzQXNTdHJpbmdzW2luZGV4XS5zb21lKHZhbHVlID0+IHZhbHVlPy5pbmNsdWRlcyhmaWx0ZXJUZXh0LnRvTG93ZXJDYXNlKCkpKSk7XG4gICAgfSwgW2RhdGEsIGZpbHRlclRleHQsIHJvd3NBc1N0cmluZ3NdKTtcbn07XG5jb25zdCB0aW1lRm9ybWF0dGVyID0gZ2V0VGltZUZvcm1hdHRlcihUaW1lRm9ybWF0cy5EQVRBQkFTRV9EQVRFVElNRSk7XG5leHBvcnQgY29uc3QgdXNlVGFibGVDb2x1bW5zID0gKGNvbG5hbWVzLCBjb2x0eXBlcywgZGF0YSwgZGF0YXNvdXJjZUlkLCBpc1Zpc2libGUsIG1vcmVDb25maWdzLCBhbGxvd0hUTUwpID0+IHtcbiAgICBjb25zdCBbb3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1ucywgc2V0T3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1uc10gPSB1c2VTdGF0ZShnZXRUaW1lQ29sdW1ucyhkYXRhc291cmNlSWQpKTtcbiAgICBjb25zdCBvblRpbWVDb2x1bW5DaGFuZ2UgPSAoY29sdW1uTmFtZSwgY29sdW1uVHlwZSkgPT4ge1xuICAgICAgICBpZiAoIWRhdGFzb3VyY2VJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW5UeXBlID09PSBGb3JtYXRQaWNrZXJWYWx1ZS5PcmlnaW5hbCAmJlxuICAgICAgICAgICAgIW9yaWdpbmFsRm9ybWF0dGVkVGltZUNvbHVtbnMuaW5jbHVkZXMoY29sdW1uTmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbHMgPSBnZXRUaW1lQ29sdW1ucyhkYXRhc291cmNlSWQpO1xuICAgICAgICAgICAgY29scy5wdXNoKGNvbHVtbk5hbWUpO1xuICAgICAgICAgICAgc2V0VGltZUNvbHVtbnMoZGF0YXNvdXJjZUlkLCBjb2xzKTtcbiAgICAgICAgICAgIHNldE9yaWdpbmFsRm9ybWF0dGVkVGltZUNvbHVtbnMoY29scyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sdW1uVHlwZSA9PT0gRm9ybWF0UGlja2VyVmFsdWUuRm9ybWF0dGVkICYmXG4gICAgICAgICAgICBvcmlnaW5hbEZvcm1hdHRlZFRpbWVDb2x1bW5zLmluY2x1ZGVzKGNvbHVtbk5hbWUpKSB7XG4gICAgICAgICAgICBjb25zdCBjb2xzID0gZ2V0VGltZUNvbHVtbnMoZGF0YXNvdXJjZUlkKTtcbiAgICAgICAgICAgIGNvbHMuc3BsaWNlKGNvbHMuaW5kZXhPZihjb2x1bW5OYW1lKSwgMSk7XG4gICAgICAgICAgICBzZXRUaW1lQ29sdW1ucyhkYXRhc291cmNlSWQsIGNvbHMpO1xuICAgICAgICAgICAgc2V0T3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1ucyhjb2xzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKGlzVmlzaWJsZSkge1xuICAgICAgICAgICAgc2V0T3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1ucyhnZXRUaW1lQ29sdW1ucyhkYXRhc291cmNlSWQpKTtcbiAgICAgICAgfVxuICAgIH0sIFtkYXRhc291cmNlSWQsIGlzVmlzaWJsZV0pO1xuICAgIHJldHVybiB1c2VNZW1vKCgpID0+IGNvbG5hbWVzICYmIGRhdGE/Lmxlbmd0aFxuICAgICAgICA/IGNvbG5hbWVzXG4gICAgICAgICAgICAuZmlsdGVyKChjb2x1bW4pID0+IE9iamVjdC5rZXlzKGRhdGFbMF0pLmluY2x1ZGVzKGNvbHVtbikpXG4gICAgICAgICAgICAubWFwKChrZXksIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2xUeXBlID0gY29sdHlwZXM/LltpbmRleF07XG4gICAgICAgICAgICBjb25zdCBmaXJzdFZhbHVlID0gZGF0YVswXVtrZXldO1xuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1uSW5kZXggPSBjb2xUeXBlID09PSBHZW5lcmljRGF0YVR5cGUuVEVNUE9SQUxcbiAgICAgICAgICAgICAgICA/IG9yaWdpbmFsRm9ybWF0dGVkVGltZUNvbHVtbnMuaW5kZXhPZihrZXkpXG4gICAgICAgICAgICAgICAgOiAtMTtcbiAgICAgICAgICAgIGNvbnN0IGlzT3JpZ2luYWxUaW1lQ29sdW1uID0gb3JpZ2luYWxGb3JtYXR0ZWRUaW1lQ29sdW1ucy5pbmNsdWRlcyhrZXkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAvLyByZWFjdC10YWJsZSByZXF1aXJlcyBhIG5vbi1lbXB0eSBpZCwgdGhlcmVmb3JlIHdlIGludHJvZHVjZSBhIGZhbGxiYWNrIHZhbHVlIGluIGNhc2UgdGhlIGtleSBpcyBlbXB0eVxuICAgICAgICAgICAgICAgIGlkOiBrZXkgfHwgaW5kZXgsXG4gICAgICAgICAgICAgICAgYWNjZXNzb3I6IHJvdyA9PiByb3dba2V5XSxcbiAgICAgICAgICAgICAgICBIZWFkZXI6IGNvbFR5cGUgPT09IEdlbmVyaWNEYXRhVHlwZS5URU1QT1JBTCAmJlxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgZmlyc3RWYWx1ZSAhPT0gJ3N0cmluZycgPyAoPERhdGFUYWJsZVRlbXBvcmFsSGVhZGVyQ2VsbCBjb2x1bW5OYW1lPXtrZXl9IGRhdGFzb3VyY2VJZD17ZGF0YXNvdXJjZUlkfSBvblRpbWVDb2x1bW5DaGFuZ2U9e29uVGltZUNvbHVtbkNoYW5nZX0gaXNPcmlnaW5hbFRpbWVDb2x1bW49e2lzT3JpZ2luYWxUaW1lQ29sdW1ufS8+KSA6IChrZXkpLFxuICAgICAgICAgICAgICAgIENlbGw6ICh7IHZhbHVlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQk9PTF9UUlVFX0RJU1BMQVk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJPT0xfRkFMU0VfRElTUExBWTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiA8Q2VsbE51bGw+e05VTExfRElTUExBWX08L0NlbGxOdWxsPjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sVHlwZSA9PT0gR2VuZXJpY0RhdGFUeXBlLlRFTVBPUkFMICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEZvcm1hdHRlZFRpbWVDb2x1bW5JbmRleCA9PT0gLTEgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aW1lRm9ybWF0dGVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiBhbGxvd0hUTUwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzYWZlSHRtbFNwYW4odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLi4ubW9yZUNvbmZpZ3M/LltrZXldLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXSwgW1xuICAgICAgICBjb2xuYW1lcyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgY29sdHlwZXMsXG4gICAgICAgIGRhdGFzb3VyY2VJZCxcbiAgICAgICAgbW9yZUNvbmZpZ3MsXG4gICAgICAgIG9yaWdpbmFsRm9ybWF0dGVkVGltZUNvbHVtbnMsXG4gICAgXSk7XG59O1xuIl19 */\"), onClick: (e) => e.stopPropagation() })),\n\n  columnName) :\n  ___EmotionJSX(\"span\", null, columnName);\n};\nexport const useFilteredTableData = (filterText, data) => {\n  const rowsAsStrings = useMemo(() => {var _data$map;return (_data$map = data == null ? void 0 : data.map((row) => Object.values(row).map((value) => value ? value.toString().toLowerCase() : t('N/A')))) != null ? _data$map : [];}, [data]);\n  return useMemo(() => {\n    if (!(data != null && data.length)) {\n      return [];\n    }\n    return data.filter((_, index) => rowsAsStrings[index].some((value) => value == null ? void 0 : _includesInstanceProperty(value).call(value, filterText.toLowerCase())));\n  }, [data, filterText, rowsAsStrings]);\n};\nconst timeFormatter = getTimeFormatter(TimeFormats.DATABASE_DATETIME);\nexport const useTableColumns = (colnames, coltypes, data, datasourceId, isVisible, moreConfigs, allowHTML) => {\n  const [originalFormattedTimeColumns, setOriginalFormattedTimeColumns] = useState(getTimeColumns(datasourceId));\n  const onTimeColumnChange = (columnName, columnType) => {\n    if (!datasourceId) {\n      return;\n    }\n    if (columnType === FormatPickerValue.Original &&\n    !_includesInstanceProperty(originalFormattedTimeColumns).call(originalFormattedTimeColumns, columnName)) {\n      const cols = getTimeColumns(datasourceId);\n      cols.push(columnName);\n      setTimeColumns(datasourceId, cols);\n      setOriginalFormattedTimeColumns(cols);\n    } else\n    if (columnType === FormatPickerValue.Formatted &&\n    _includesInstanceProperty(originalFormattedTimeColumns).call(originalFormattedTimeColumns, columnName)) {\n      const cols = getTimeColumns(datasourceId);\n      cols.splice(cols.indexOf(columnName), 1);\n      setTimeColumns(datasourceId, cols);\n      setOriginalFormattedTimeColumns(cols);\n    }\n  };\n  useEffect(() => {\n    if (isVisible) {\n      setOriginalFormattedTimeColumns(getTimeColumns(datasourceId));\n    }\n  }, [datasourceId, isVisible]);\n  return useMemo(() => colnames && data != null && data.length ?\n  colnames.\n  filter((column) => {var _context;return _includesInstanceProperty(_context = Object.keys(data[0])).call(_context, column);}).\n  map((key, index) => {\n    const colType = coltypes == null ? void 0 : coltypes[index];\n    const firstValue = data[0][key];\n    const originalFormattedTimeColumnIndex = colType === GenericDataType.TEMPORAL ?\n    originalFormattedTimeColumns.indexOf(key) :\n    -1;\n    const isOriginalTimeColumn = _includesInstanceProperty(originalFormattedTimeColumns).call(originalFormattedTimeColumns, key);\n    return {\n      // react-table requires a non-empty id, therefore we introduce a fallback value in case the key is empty\n      id: key || index,\n      accessor: (row) => row[key],\n      Header: colType === GenericDataType.TEMPORAL &&\n      typeof firstValue !== 'string' ? ___EmotionJSX(DataTableTemporalHeaderCell, { columnName: key, datasourceId: datasourceId, onTimeColumnChange: onTimeColumnChange, isOriginalTimeColumn: isOriginalTimeColumn }) : key,\n      Cell: (_ref14) => {let { value } = _ref14;\n        if (value === true) {\n          return BOOL_TRUE_DISPLAY;\n        }\n        if (value === false) {\n          return BOOL_FALSE_DISPLAY;\n        }\n        if (value === null) {\n          return ___EmotionJSX(CellNull, null, NULL_DISPLAY);\n        }\n        if (colType === GenericDataType.TEMPORAL &&\n        originalFormattedTimeColumnIndex === -1 &&\n        typeof value === 'number') {\n          return timeFormatter(value);\n        }\n        if (typeof value === 'string' && allowHTML) {\n          return safeHtmlSpan(value);\n        }\n        return String(value);\n      },\n      ...(moreConfigs == null ? void 0 : moreConfigs[key]) };\n\n  }) :\n  [], [\n  colnames,\n  data,\n  coltypes,\n  datasourceId,\n  moreConfigs,\n  originalFormattedTimeColumns]);\n\n};","map":{"version":3,"mappings":"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","names":["React","useMemo","useState","useEffect","css","GenericDataType","getTimeFormatter","safeHtmlSpan","styled","t","TimeFormats","useTheme","Global","debounce","Space","Input","BOOL_FALSE_DISPLAY","BOOL_TRUE_DISPLAY","NULL_DISPLAY","SLOW_DEBOUNCE","Radio","Icons","Button","Popover","prepareCopyToClipboardTabularData","CopyToClipboard","RowCountLabel","getTimeColumns","setTimeColumns","CellNull","theme","colors","grayscale","light1","CopyButton","typography","sizes","s","gridUnit","CopyToClipboardButton","data","columns","base","FilterInput","onChangeHandler","debouncedChangeHandler","event","filterText","target","value","RowCount","loading","length","FormatPickerValue","FormatPicker","onChange","Formatted","Original","FormatPickerContainer","div","FormatPickerLabel","span","DataTableTemporalHeaderCell","columnName","onTimeColumnChange","datasourceId","isOriginalTimeColumn","e","overlayContent","stopPropagation","marginRight","useFilteredTableData","rowsAsStrings","map","row","Object","values","toString","toLowerCase","filter","_","index","some","timeFormatter","DATABASE_DATETIME","useTableColumns","colnames","coltypes","isVisible","moreConfigs","allowHTML","originalFormattedTimeColumns","setOriginalFormattedTimeColumns","columnType","cols","push","splice","indexOf","column","keys","key","colType","firstValue","originalFormattedTimeColumnIndex","TEMPORAL","id","accessor","Header","Cell","String"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/src/explore/components/DataTableControl/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo, useState, useEffect } from 'react';\nimport {\n  css,\n  GenericDataType,\n  getTimeFormatter,\n  safeHtmlSpan,\n  styled,\n  t,\n  TimeFormats,\n  useTheme,\n} from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport { Column } from 'react-table';\nimport debounce from 'lodash/debounce';\nimport { Space } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport {\n  BOOL_FALSE_DISPLAY,\n  BOOL_TRUE_DISPLAY,\n  NULL_DISPLAY,\n  SLOW_DEBOUNCE,\n} from 'src/constants';\nimport { Radio } from 'src/components/Radio';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport Popover from 'src/components/Popover';\nimport { prepareCopyToClipboardTabularData } from 'src/utils/common';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport RowCountLabel from 'src/explore/components/RowCountLabel';\nimport { getTimeColumns, setTimeColumns } from './utils';\n\nexport const CellNull = styled('span')`\n  color: ${({ theme }) => theme.colors.grayscale.light1};\n`;\n\nexport const CopyButton = styled(Button)`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n\n  // needed to override button's first-of-type margin: 0\n  && {\n    margin: 0 ${({ theme }) => theme.gridUnit * 2}px;\n  }\n\n  i {\n    padding: 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nexport const CopyToClipboardButton = ({\n  data,\n  columns,\n}: {\n  data?: Record<string, any>;\n  columns?: string[];\n}) => {\n  const theme = useTheme();\n  return (\n    <CopyToClipboard\n      text={\n        data && columns ? prepareCopyToClipboardTabularData(data, columns) : ''\n      }\n      wrapped={false}\n      copyNode={\n        <Icons.CopyOutlined\n          iconColor={theme.colors.grayscale.base}\n          iconSize=\"l\"\n          aria-label={t('Copy')}\n          role=\"button\"\n          css={css`\n            &.anticon > * {\n              line-height: 0;\n            }\n          `}\n        />\n      }\n    />\n  );\n};\n\nexport const FilterInput = ({\n  onChangeHandler,\n}: {\n  onChangeHandler(filterText: string): void;\n}) => {\n  const theme = useTheme();\n  const debouncedChangeHandler = debounce(onChangeHandler, SLOW_DEBOUNCE);\n  return (\n    <Input\n      prefix={<Icons.Search iconColor={theme.colors.grayscale.base} />}\n      placeholder={t('Search')}\n      onChange={(event: any) => {\n        const filterText = event.target.value;\n        debouncedChangeHandler(filterText);\n      }}\n      css={css`\n        width: 200px;\n        margin-right: ${theme.gridUnit * 2}px;\n      `}\n    />\n  );\n};\n\nexport const RowCount = ({\n  data,\n  loading,\n}: {\n  data?: Record<string, any>[];\n  loading: boolean;\n}) => <RowCountLabel rowcount={data?.length ?? 0} loading={loading} />;\n\nenum FormatPickerValue {\n  Formatted = 'formatted',\n  Original = 'original',\n}\n\nconst FormatPicker = ({\n  onChange,\n  value,\n}: {\n  onChange: any;\n  value: FormatPickerValue;\n}) => (\n  <Radio.Group value={value} onChange={onChange}>\n    <Space direction=\"vertical\">\n      <Radio value={FormatPickerValue.Formatted}>{t('Formatted date')}</Radio>\n      <Radio value={FormatPickerValue.Original}>{t('Original value')}</Radio>\n    </Space>\n  </Radio.Group>\n);\n\nconst FormatPickerContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  padding: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst FormatPickerLabel = styled.span`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  color: ${({ theme }) => theme.colors.grayscale.base};\n  margin-bottom: ${({ theme }) => theme.gridUnit * 2}px;\n  text-transform: uppercase;\n`;\n\nconst DataTableTemporalHeaderCell = ({\n  columnName,\n  onTimeColumnChange,\n  datasourceId,\n  isOriginalTimeColumn,\n}: {\n  columnName: string;\n  onTimeColumnChange: (\n    columnName: string,\n    columnType: FormatPickerValue,\n  ) => void;\n  datasourceId?: string;\n  isOriginalTimeColumn: boolean;\n}) => {\n  const theme = useTheme();\n\n  const onChange = (e: any) => {\n    onTimeColumnChange(columnName, e.target.value);\n  };\n\n  const overlayContent = useMemo(\n    () =>\n      datasourceId ? ( // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n        <FormatPickerContainer onClick={e => e.stopPropagation()}>\n          {/* hack to disable click propagation from popover content to table header, which triggers sorting column */}\n          <Global\n            styles={css`\n              .column-formatting-popover .ant-popover-inner-content {\n                padding: 0;\n              }\n            `}\n          />\n          <FormatPickerLabel>{t('Column Formatting')}</FormatPickerLabel>\n          <FormatPicker\n            onChange={onChange}\n            value={\n              isOriginalTimeColumn\n                ? FormatPickerValue.Original\n                : FormatPickerValue.Formatted\n            }\n          />\n        </FormatPickerContainer>\n      ) : null,\n    [datasourceId, isOriginalTimeColumn],\n  );\n\n  return datasourceId ? (\n    <span>\n      <Popover\n        overlayClassName=\"column-formatting-popover\"\n        trigger=\"click\"\n        content={overlayContent}\n        placement=\"bottomLeft\"\n        arrowPointAtCenter\n      >\n        <Icons.SettingOutlined\n          iconSize=\"m\"\n          iconColor={theme.colors.grayscale.light1}\n          css={{ marginRight: `${theme.gridUnit}px` }}\n          onClick={e => e.stopPropagation()}\n        />\n      </Popover>\n      {columnName}\n    </span>\n  ) : (\n    <span>{columnName}</span>\n  );\n};\n\nexport const useFilteredTableData = (\n  filterText: string,\n  data?: Record<string, any>[],\n) => {\n  const rowsAsStrings = useMemo(\n    () =>\n      data?.map((row: Record<string, any>) =>\n        Object.values(row).map(value =>\n          value ? value.toString().toLowerCase() : t('N/A'),\n        ),\n      ) ?? [],\n    [data],\n  );\n\n  return useMemo(() => {\n    if (!data?.length) {\n      return [];\n    }\n    return data.filter((_, index: number) =>\n      rowsAsStrings[index].some(value =>\n        value?.includes(filterText.toLowerCase()),\n      ),\n    );\n  }, [data, filterText, rowsAsStrings]);\n};\n\nconst timeFormatter = getTimeFormatter(TimeFormats.DATABASE_DATETIME);\n\nexport const useTableColumns = (\n  colnames?: string[],\n  coltypes?: GenericDataType[],\n  data?: Record<string, any>[],\n  datasourceId?: string,\n  isVisible?: boolean,\n  moreConfigs?: { [key: string]: Partial<Column> },\n  allowHTML?: boolean,\n) => {\n  const [originalFormattedTimeColumns, setOriginalFormattedTimeColumns] =\n    useState<string[]>(getTimeColumns(datasourceId));\n\n  const onTimeColumnChange = (\n    columnName: string,\n    columnType: FormatPickerValue,\n  ) => {\n    if (!datasourceId) {\n      return;\n    }\n    if (\n      columnType === FormatPickerValue.Original &&\n      !originalFormattedTimeColumns.includes(columnName)\n    ) {\n      const cols = getTimeColumns(datasourceId);\n      cols.push(columnName);\n      setTimeColumns(datasourceId, cols);\n      setOriginalFormattedTimeColumns(cols);\n    } else if (\n      columnType === FormatPickerValue.Formatted &&\n      originalFormattedTimeColumns.includes(columnName)\n    ) {\n      const cols = getTimeColumns(datasourceId);\n      cols.splice(cols.indexOf(columnName), 1);\n      setTimeColumns(datasourceId, cols);\n      setOriginalFormattedTimeColumns(cols);\n    }\n  };\n\n  useEffect(() => {\n    if (isVisible) {\n      setOriginalFormattedTimeColumns(getTimeColumns(datasourceId));\n    }\n  }, [datasourceId, isVisible]);\n\n  return useMemo(\n    () =>\n      colnames && data?.length\n        ? colnames\n            .filter((column: string) => Object.keys(data[0]).includes(column))\n            .map((key, index) => {\n              const colType = coltypes?.[index];\n              const firstValue = data[0][key];\n              const originalFormattedTimeColumnIndex =\n                colType === GenericDataType.TEMPORAL\n                  ? originalFormattedTimeColumns.indexOf(key)\n                  : -1;\n              const isOriginalTimeColumn =\n                originalFormattedTimeColumns.includes(key);\n              return {\n                // react-table requires a non-empty id, therefore we introduce a fallback value in case the key is empty\n                id: key || index,\n                accessor: row => row[key],\n                Header:\n                  colType === GenericDataType.TEMPORAL &&\n                  typeof firstValue !== 'string' ? (\n                    <DataTableTemporalHeaderCell\n                      columnName={key}\n                      datasourceId={datasourceId}\n                      onTimeColumnChange={onTimeColumnChange}\n                      isOriginalTimeColumn={isOriginalTimeColumn}\n                    />\n                  ) : (\n                    key\n                  ),\n                Cell: ({ value }) => {\n                  if (value === true) {\n                    return BOOL_TRUE_DISPLAY;\n                  }\n                  if (value === false) {\n                    return BOOL_FALSE_DISPLAY;\n                  }\n                  if (value === null) {\n                    return <CellNull>{NULL_DISPLAY}</CellNull>;\n                  }\n                  if (\n                    colType === GenericDataType.TEMPORAL &&\n                    originalFormattedTimeColumnIndex === -1 &&\n                    typeof value === 'number'\n                  ) {\n                    return timeFormatter(value);\n                  }\n                  if (typeof value === 'string' && allowHTML) {\n                    return safeHtmlSpan(value);\n                  }\n                  return String(value);\n                },\n                ...moreConfigs?.[key],\n              } as Column;\n            })\n        : [],\n    [\n      colnames,\n      data,\n      coltypes,\n      datasourceId,\n      moreConfigs,\n      originalFormattedTimeColumns,\n    ],\n  );\n};\n"]},"metadata":{},"sourceType":"module"}