{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";import { css as _css } from \"@emotion/react\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport AntdSelect from 'antd/lib/select';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nexport const { Option } = AntdSelect;\n/**\n * AntD select with creatable options.\n */\nexport default function Select(_ref) {let { creatable, onSearch, dropdownMatchSelectWidth = false, minWidth = '100%', showSearch: showSearch_ = true, onChange, options, children, value, ...props } = _ref;\n  const [searchValue, setSearchValue] = useState();\n  // force show search if creatable\n  const showSearch = showSearch_ || creatable;\n  const handleSearch = showSearch ?\n  (input) => {\n    if (creatable) {\n      setSearchValue(input);\n    }\n    if (onSearch) {\n      onSearch(input);\n    }\n  } :\n  undefined;\n  const optionsHasSearchValue = options == null ? void 0 : options.some((_ref2) => {let [val] = _ref2;return val === searchValue;});\n  const optionsHasValue = options == null ? void 0 : options.some((_ref3) => {let [val] = _ref3;return val === value;});\n  const handleChange = showSearch ?\n  (val, opt) => {\n    // reset input value once selected\n    setSearchValue('');\n    if (onChange) {\n      onChange(val, opt);\n    }\n  } :\n  onChange;\n  return ___EmotionJSX(AntdSelect, _extends({ dropdownMatchSelectWidth: dropdownMatchSelectWidth, showSearch: showSearch, onSearch: handleSearch, onChange: handleChange, value: value }, props, { css: /*#__PURE__*/_css({\n      minWidth }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:Select;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96aGFvcnVpL3NyYy9pbmN1YmF0b3Itc3VwZXJzZXQtaW50ZXJuYWwvc3VwZXJzZXQtZnJvbnRlbmQvcGFja2FnZXMvc3VwZXJzZXQtdWktY2hhcnQtY29udHJvbHMvc3JjL2NvbXBvbmVudHMvU2VsZWN0LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpRDZLIiwiZmlsZSI6Ii9Vc2Vycy96aGFvcnVpL3NyYy9pbmN1YmF0b3Itc3VwZXJzZXQtaW50ZXJuYWwvc3VwZXJzZXQtZnJvbnRlbmQvcGFja2FnZXMvc3VwZXJzZXQtdWktY2hhcnQtY29udHJvbHMvc3JjL2NvbXBvbmVudHMvU2VsZWN0LnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBBbnRkU2VsZWN0IGZyb20gJ2FudGQvbGliL3NlbGVjdCc7XG5leHBvcnQgY29uc3QgeyBPcHRpb24gfSA9IEFudGRTZWxlY3Q7XG4vKipcbiAqIEFudEQgc2VsZWN0IHdpdGggY3JlYXRhYmxlIG9wdGlvbnMuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFNlbGVjdCh7IGNyZWF0YWJsZSwgb25TZWFyY2gsIGRyb3Bkb3duTWF0Y2hTZWxlY3RXaWR0aCA9IGZhbHNlLCBtaW5XaWR0aCA9ICcxMDAlJywgc2hvd1NlYXJjaDogc2hvd1NlYXJjaF8gPSB0cnVlLCBvbkNoYW5nZSwgb3B0aW9ucywgY2hpbGRyZW4sIHZhbHVlLCAuLi5wcm9wcyB9KSB7XG4gICAgY29uc3QgW3NlYXJjaFZhbHVlLCBzZXRTZWFyY2hWYWx1ZV0gPSB1c2VTdGF0ZSgpO1xuICAgIC8vIGZvcmNlIHNob3cgc2VhcmNoIGlmIGNyZWF0YWJsZVxuICAgIGNvbnN0IHNob3dTZWFyY2ggPSBzaG93U2VhcmNoXyB8fCBjcmVhdGFibGU7XG4gICAgY29uc3QgaGFuZGxlU2VhcmNoID0gc2hvd1NlYXJjaFxuICAgICAgICA/IChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNyZWF0YWJsZSkge1xuICAgICAgICAgICAgICAgIHNldFNlYXJjaFZhbHVlKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvblNlYXJjaCkge1xuICAgICAgICAgICAgICAgIG9uU2VhcmNoKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICBjb25zdCBvcHRpb25zSGFzU2VhcmNoVmFsdWUgPSBvcHRpb25zPy5zb21lKChbdmFsXSkgPT4gdmFsID09PSBzZWFyY2hWYWx1ZSk7XG4gICAgY29uc3Qgb3B0aW9uc0hhc1ZhbHVlID0gb3B0aW9ucz8uc29tZSgoW3ZhbF0pID0+IHZhbCA9PT0gdmFsdWUpO1xuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9IHNob3dTZWFyY2hcbiAgICAgICAgPyAodmFsLCBvcHQpID0+IHtcbiAgICAgICAgICAgIC8vIHJlc2V0IGlucHV0IHZhbHVlIG9uY2Ugc2VsZWN0ZWRcbiAgICAgICAgICAgIHNldFNlYXJjaFZhbHVlKCcnKTtcbiAgICAgICAgICAgIGlmIChvbkNoYW5nZSkge1xuICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHZhbCwgb3B0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICA6IG9uQ2hhbmdlO1xuICAgIHJldHVybiAoPEFudGRTZWxlY3QgZHJvcGRvd25NYXRjaFNlbGVjdFdpZHRoPXtkcm9wZG93bk1hdGNoU2VsZWN0V2lkdGh9IHNob3dTZWFyY2g9e3Nob3dTZWFyY2h9IG9uU2VhcmNoPXtoYW5kbGVTZWFyY2h9IG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9IHZhbHVlPXt2YWx1ZX0gey4uLnByb3BzfSBjc3M9e3tcbiAgICAgICAgICAgIG1pbldpZHRoLFxuICAgICAgICB9fT5cbiAgICAgIHtvcHRpb25zPy5tYXAoKFt2YWwsIGxhYmVsXSkgPT4gKDxPcHRpb24gdmFsdWU9e3ZhbH0+e2xhYmVsfTwvT3B0aW9uPikpfVxuICAgICAge2NoaWxkcmVufVxuICAgICAge3ZhbHVlICYmICFvcHRpb25zSGFzVmFsdWUgJiYgKDxPcHRpb24ga2V5PXt2YWx1ZX0gdmFsdWU9e3ZhbHVlfT5cbiAgICAgICAgICB7dmFsdWV9XG4gICAgICAgIDwvT3B0aW9uPil9XG4gICAgICB7c2VhcmNoVmFsdWUgJiYgIW9wdGlvbnNIYXNTZWFyY2hWYWx1ZSAmJiAoPE9wdGlvbiBrZXk9e3NlYXJjaFZhbHVlfSB2YWx1ZT17c2VhcmNoVmFsdWV9PlxuICAgICAgICAgIHsvKiBVbmZvcnR1bmF0ZWx5IEFudEQgc2VsZWN0IGRvZXMgbm90IHN1cHBvcnQgZGlzcGxheWluZyBkaWZmZXJlbnRcbiAgICAgICAgICAgIGxhYmVsIGZvciBvcHRpb24gdnMgc2VsZWN0IHZhbHVlLCBzbyB3ZSBjYW4ndCB1c2VcbiAgICAgICAgICAgIGB0KCdDcmVhdGUgXCIlc1wiJywgc2VhcmNoVmFsdWUpYCBoZXJlICovfVxuICAgICAgICAgIHtzZWFyY2hWYWx1ZX1cbiAgICAgICAgPC9PcHRpb24+KX1cbiAgICA8L0FudGRTZWxlY3Q+KTtcbn1cblNlbGVjdC5PcHRpb24gPSBPcHRpb247XG4iXX0= */\") }),\n\n  options == null ? void 0 : options.map((_ref4) => {let [val, label] = _ref4;return ___EmotionJSX(Option, { value: val }, label);}),\n  children,\n  value && !optionsHasValue && ___EmotionJSX(Option, { key: value, value: value },\n  value),\n\n  searchValue && !optionsHasSearchValue && ___EmotionJSX(Option, { key: searchValue, value: searchValue },\n\n\n\n  searchValue));\n\n\n}\nSelect.Option = Option;","map":{"version":3,"mappings":"4GAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,KAAP,IAAgBC,QAAhB,QAA2C,OAA3C;AACA,OAAOC,UAAP,MAA2D,iBAA3D,C;AAEA,OAAO,MAAM,EAAEC,MAAF,KAAkBD,UAAxB;AAUP;;;AAGA,eAAc,SAAUE,MAAV,OAWI,KAXyC,EACzDC,SADyD,EAEzDC,QAFyD,EAGzDC,wBAAwB,GAAG,KAH8B,EAIzDC,QAAQ,GAAG,MAJ8C,EAKzDC,UAAU,EAAEC,WAAW,GAAG,IAL+B,EAMzDC,QANyD,EAOzDC,OAPyD,EAQzDC,QARyD,EASzDC,KATyD,EAUzD,GAAGC,KAVsD,EAWzC;EAChB,MAAM,CAACC,WAAD,EAAcC,cAAd,IAAgChB,QAAQ,EAA9C;EACA;EACA,MAAMQ,UAAU,GAAGC,WAAW,IAAIL,SAAlC;EACA,MAAMa,YAAY,GAAGT,UAAU;EAC3B,CAACU,KAAD,KAAkB;IAChB,IAAId,SAAJ,EAAe;MACbY,cAAc,CAACE,KAAD,CAAd;IACD;IACD,IAAIb,QAAJ,EAAc;MACZA,QAAQ,CAACa,KAAD,CAAR;IACD;EACF,CAR0B;EAS3BC,SATJ;EAWA,MAAMC,qBAAqB,GAAGT,OAAH,oBAAGA,OAAO,CAAEU,IAAT,CAAc,gBAAC,CAACC,GAAD,CAAD,gBAAWA,GAAG,KAAKP,WAAnB,EAAd,CAA9B;EACA,MAAMQ,eAAe,GAAGZ,OAAH,oBAAGA,OAAO,CAAEU,IAAT,CAAc,gBAAC,CAACC,GAAD,CAAD,gBAAWA,GAAG,KAAKT,KAAnB,EAAd,CAAxB;EAEA,MAAMW,YAAY,GAAgChB,UAAU;EACxD,CAACc,GAAD,EAAMG,GAAN,KAAa;IACX;IACAT,cAAc,CAAC,EAAD,CAAd;IACA,IAAIN,QAAJ,EAAc;MACZA,QAAQ,CAACY,GAAD,EAAMG,GAAN,CAAR;IACD;EACF,CAPuD;EAQxDf,QARJ;EAUA,OACE,cAAC,UAAD,aACE,wBAAwB,EAAEJ,wBAD5B,EAEE,UAAU,EAAEE,UAFd,EAGE,QAAQ,EAAES,YAHZ,EAIE,QAAQ,EAAEO,YAJZ,EAKE,KAAK,EAAEX,KALT,IAMMC,KANN,IAOE,GAAG,oBAAE;MACHP,QADG,EAAF,ozIAPL;;EAWGI,OAXH,oBAWGA,OAAO,CAAEe,GAAT,CAAa,gBAAC,CAACJ,GAAD,EAAMK,KAAN,CAAD,gBACZ,cAAC,MAAD,IAAQ,KAAK,EAAEL,GAAf,IAAqBK,KAArB,CADY,EAAb,CAXH;EAcGf,QAdH;EAeGC,KAAK,IAAI,CAACU,eAAV,IACC,cAAC,MAAD,IAAQ,GAAG,EAAEV,KAAb,EAAoB,KAAK,EAAEA,KAA3B;EACGA,KADH,CAhBJ;;EAoBGE,WAAW,IAAI,CAACK,qBAAhB,IACC,cAAC,MAAD,IAAQ,GAAG,EAAEL,WAAb,EAA0B,KAAK,EAAEA,WAAjC;;;;EAIGA,WAJH,CArBJ,CADF;;;AA+BD;AAEDZ,MAAM,CAACD,MAAP,GAAgBA,MAAhB","names":["React","useState","AntdSelect","Option","Select","creatable","onSearch","dropdownMatchSelectWidth","minWidth","showSearch","showSearch_","onChange","options","children","value","props","searchValue","setSearchValue","handleSearch","input","undefined","optionsHasSearchValue","some","val","optionsHasValue","handleChange","opt","map","label"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/packages/superset-ui-chart-controls/src/components/Select.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, ReactNode } from 'react';\nimport AntdSelect, { SelectProps as AntdSelectProps } from 'antd/lib/select';\n\nexport const { Option }: any = AntdSelect;\n\nexport type SelectOption<VT = string> = [VT, ReactNode];\n\nexport type SelectProps<VT> = Omit<AntdSelectProps<VT>, 'options'> & {\n  creatable?: boolean;\n  minWidth?: string | number;\n  options?: SelectOption<VT>[];\n};\n\n/**\n * AntD select with creatable options.\n */\nexport default function Select<VT extends string | number>({\n  creatable,\n  onSearch,\n  dropdownMatchSelectWidth = false,\n  minWidth = '100%',\n  showSearch: showSearch_ = true,\n  onChange,\n  options,\n  children,\n  value,\n  ...props\n}: SelectProps<VT>) {\n  const [searchValue, setSearchValue] = useState<string>();\n  // force show search if creatable\n  const showSearch = showSearch_ || creatable;\n  const handleSearch = showSearch\n    ? (input: string) => {\n        if (creatable) {\n          setSearchValue(input);\n        }\n        if (onSearch) {\n          onSearch(input);\n        }\n      }\n    : undefined;\n\n  const optionsHasSearchValue = options?.some(([val]) => val === searchValue);\n  const optionsHasValue = options?.some(([val]) => val === value);\n\n  const handleChange: SelectProps<VT>['onChange'] = showSearch\n    ? (val, opt) => {\n        // reset input value once selected\n        setSearchValue('');\n        if (onChange) {\n          onChange(val, opt);\n        }\n      }\n    : onChange;\n\n  return (\n    <AntdSelect<VT>\n      dropdownMatchSelectWidth={dropdownMatchSelectWidth}\n      showSearch={showSearch}\n      onSearch={handleSearch}\n      onChange={handleChange}\n      value={value}\n      {...props}\n      css={{\n        minWidth,\n      }}\n    >\n      {options?.map(([val, label]) => (\n        <Option value={val}>{label}</Option>\n      ))}\n      {children}\n      {value && !optionsHasValue && (\n        <Option key={value} value={value}>\n          {value}\n        </Option>\n      )}\n      {searchValue && !optionsHasSearchValue && (\n        <Option key={searchValue} value={searchValue}>\n          {/* Unfortunately AntD select does not support displaying different\n          label for option vs select value, so we can't use\n          `t('Create \"%s\"', searchValue)` here */}\n          {searchValue}\n        </Option>\n      )}\n    </AntdSelect>\n  );\n}\n\nSelect.Option = Option;\n"]},"metadata":{},"sourceType":"module"}