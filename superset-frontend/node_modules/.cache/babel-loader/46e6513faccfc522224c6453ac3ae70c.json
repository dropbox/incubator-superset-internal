{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useRef } from 'react';\nimport { isDefined } from '@superset-ui/core';\nexport const useMemoCompare = (next, compare) => {\n  const previousRef = useRef();\n  const previous = previousRef.current;\n  const isEqual = compare(previous, next);\n  useEffect(() => {\n    if (!isEqual) {\n      previousRef.current = next;\n    }\n  });\n  if (!isDefined(previous)) {\n    return next;\n  }\n  return isEqual ? previous : next;\n};","map":{"version":3,"mappings":"AAAA;;;;;;;;;;;;;;;;;;AAmBA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SAASC,SAAT,QAA0B,mBAA1B;AAEA,OAAO,MAAMC,cAAc,GAAG,CAC5BC,IAD4B,EAE5BC,OAF4B,KAG1B;EACF,MAAMC,WAAW,GAAGL,MAAM,EAA1B;EACA,MAAMM,QAAQ,GAAGD,WAAW,CAACE,OAA7B;EACA,MAAMC,OAAO,GAAGJ,OAAO,CAACE,QAAD,EAAWH,IAAX,CAAvB;EACAJ,SAAS,CAAC,MAAK;IACb,IAAI,CAACS,OAAL,EAAc;MACZH,WAAW,CAACE,OAAZ,GAAsBJ,IAAtB;IACD;EACF,CAJQ,CAAT;EAKA,IAAI,CAACF,SAAS,CAACK,QAAD,CAAd,EAA0B;IACxB,OAAOH,IAAP;EACD;EACD,OAAOK,OAAO,GAAGF,QAAH,GAAcH,IAA5B;AACD,CAhBM","names":["useEffect","useRef","isDefined","useMemoCompare","next","compare","previousRef","previous","current","isEqual"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/src/hooks/useMemoCompare.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { useEffect, useRef } from 'react';\nimport { isDefined } from '@superset-ui/core';\n\nexport const useMemoCompare = <T>(\n  next: T,\n  compare: (prev: T | undefined, next: T) => boolean,\n) => {\n  const previousRef = useRef<T>();\n  const previous = previousRef.current;\n  const isEqual = compare(previous, next);\n  useEffect(() => {\n    if (!isEqual) {\n      previousRef.current = next;\n    }\n  });\n  if (!isDefined(previous)) {\n    return next;\n  }\n  return isEqual ? previous : next;\n};\n"]},"metadata":{},"sourceType":"module"}