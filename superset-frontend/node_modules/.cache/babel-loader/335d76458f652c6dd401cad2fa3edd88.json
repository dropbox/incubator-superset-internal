{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FeatureFlag, styled, SupersetClient, t } from '@superset-ui/core';\nimport React, { useState, useMemo, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\nimport rison from 'rison';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport { createFetchRelated, createErrorHandler, handleDashboardDelete } from 'src/views/CRUD/utils';\nimport { useListViewResource, useFavoriteStatus } from 'src/views/CRUD/hooks';\nimport ConfirmStatusChange from 'src/components/ConfirmStatusChange';\nimport { TagsList } from 'src/components/Tags';\nimport handleResourceExport from 'src/utils/export';\nimport Loading from 'src/components/Loading';\nimport SubMenu from 'src/features/home/SubMenu';\nimport ListView, { FilterOperator } from 'src/components/ListView';\nimport { dangerouslyGetItemDoNotUse } from 'src/utils/localStorageHelpers';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport FacePile from 'src/components/FacePile';\nimport Icons from 'src/components/Icons';\nimport DeleteModal from 'src/components/DeleteModal';\nimport FaveStar from 'src/components/FaveStar';\nimport PropertiesModal from 'src/dashboard/components/PropertiesModal';\nimport { Tooltip } from 'src/components/Tooltip';\nimport ImportModelsModal from 'src/components/ImportModal/index';\nimport CertifiedBadge from 'src/components/CertifiedBadge';\nimport { loadTags } from 'src/components/Tags/utils';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport DashboardCard from 'src/features/dashboards/DashboardCard';\nimport { DashboardStatus } from 'src/features/dashboards/types';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst PAGE_SIZE = 25;\nconst PASSWORDS_NEEDED_MESSAGE = t('The passwords for the databases below are needed in order to ' +\n'import them together with the dashboards. Please note that the ' +\n'\"Secure Extra\" and \"Certificate\" sections of ' +\n'the database configuration are not present in export files, and ' +\n'should be added manually after the import if they are needed.');\nconst CONFIRM_OVERWRITE_MESSAGE = t('You are importing one or more dashboards that already exist. ' +\n'Overwriting might cause you to lose some of your work. Are you ' +\n'sure you want to overwrite?');\nconst Actions = styled.div`\n  color: ${(_ref) => {let { theme } = _ref;return theme.colors.grayscale.base;}};\n`;\nconst bootstrapData = getBootstrapData();\nfunction DashboardList(props) {var _bootstrapData$common, _bootstrapData$common2;\n  const { addDangerToast, addSuccessToast, user: { userId } } = props;\n  const { state: { loading, resourceCount: dashboardCount, resourceCollection: dashboards, bulkSelectEnabled }, setResourceCollection: setDashboards, hasPerm, fetchData, toggleBulkSelect, refreshData } = useListViewResource('dashboard', t('dashboard'), addDangerToast);\n  const dashboardIds = useMemo(() => dashboards.map((d) => d.id), [dashboards]);\n  const [saveFavoriteStatus, favoriteStatus] = useFavoriteStatus('dashboard', dashboardIds, addDangerToast);\n  const [dashboardToEdit, setDashboardToEdit] = useState(null);\n  const [dashboardToDelete, setDashboardToDelete] = useState(null);\n  const [importingDashboard, showImportModal] = useState(false);\n  const [passwordFields, setPasswordFields] = useState([]);\n  const [preparingExport, setPreparingExport] = useState(false);\n  const enableBroadUserAccess = bootstrapData == null ? void 0 : (_bootstrapData$common = bootstrapData.common) == null ? void 0 : (_bootstrapData$common2 = _bootstrapData$common.conf) == null ? void 0 : _bootstrapData$common2.ENABLE_BROAD_ACTIVITY_ACCESS;\n  const [sshTunnelPasswordFields, setSSHTunnelPasswordFields] = useState([]);\n  const [sshTunnelPrivateKeyFields, setSSHTunnelPrivateKeyFields] = useState([]);\n  const [sshTunnelPrivateKeyPasswordFields, setSSHTunnelPrivateKeyPasswordFields] = useState([]);\n  const openDashboardImportModal = () => {\n    showImportModal(true);\n  };\n  const closeDashboardImportModal = () => {\n    showImportModal(false);\n  };\n  const handleDashboardImport = () => {\n    showImportModal(false);\n    refreshData();\n    addSuccessToast(t('Dashboard imported'));\n  };\n  // TODO: Fix usage of localStorage keying on the user id\n  const userKey = dangerouslyGetItemDoNotUse(userId == null ? void 0 : userId.toString(), null);\n  const canCreate = hasPerm('can_write');\n  const canEdit = hasPerm('can_write');\n  const canDelete = hasPerm('can_write');\n  const canExport = hasPerm('can_export') && isFeatureEnabled(FeatureFlag.VERSIONED_EXPORT);\n  const initialSort = [{ id: 'changed_on_delta_humanized', desc: true }];\n  function openDashboardEditModal(dashboard) {\n    setDashboardToEdit(dashboard);\n  }\n  function handleDashboardEdit(edits) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${edits.id}` }).\n    then((_ref2) => {let { json = {} } = _ref2;\n      setDashboards(dashboards.map((dashboard) => {var _json$result;\n        if (dashboard.id === (json == null ? void 0 : (_json$result = json.result) == null ? void 0 : _json$result.id)) {\n          const { changed_by_name, changed_by_url, changed_by, dashboard_title = '', slug = '', json_metadata = '', changed_on_delta_humanized, url = '', certified_by = '', certification_details = '', owners, tags } = json.result;\n          return {\n            ...dashboard,\n            changed_by_name,\n            changed_by_url,\n            changed_by,\n            dashboard_title,\n            slug,\n            json_metadata,\n            changed_on_delta_humanized,\n            url,\n            certified_by,\n            certification_details,\n            owners,\n            tags };\n\n        }\n        return dashboard;\n      }));\n    }, createErrorHandler((errMsg) => addDangerToast(t('An error occurred while fetching dashboards: %s', errMsg))));\n  }\n  const handleBulkDashboardExport = (dashboardsToExport) => {\n    const ids = dashboardsToExport.map((_ref3) => {let { id } = _ref3;return id;});\n    handleResourceExport('dashboard', ids, () => {\n      setPreparingExport(false);\n    });\n    setPreparingExport(true);\n  };\n  function handleBulkDashboardDelete(dashboardsToDelete) {\n    return SupersetClient.delete({\n      endpoint: `/api/v1/dashboard/?q=${rison.encode(dashboardsToDelete.map((_ref4) => {let { id } = _ref4;return id;}))}` }).\n    then((_ref5) => {let { json = {} } = _ref5;\n      refreshData();\n      addSuccessToast(json.message);\n    }, createErrorHandler((errMsg) => addDangerToast(t('There was an issue deleting the selected dashboards: ', errMsg))));\n  }\n  const columns = useMemo(() => [\n  {\n    Cell: (_ref6) => {let { row: { original: { id } } } = _ref6;return userId && ___EmotionJSX(FaveStar, { itemId: id, saveFaveStar: saveFavoriteStatus, isStarred: favoriteStatus[id] });},\n    Header: '',\n    id: 'id',\n    disableSortBy: true,\n    size: 'xs',\n    hidden: !userId },\n\n  {\n    Cell: (_ref7) => {let { row: { original: { url, dashboard_title: dashboardTitle, certified_by: certifiedBy, certification_details: certificationDetails } } } = _ref7;return ___EmotionJSX(Link, { to: url },\n      certifiedBy && ___EmotionJSX(React.Fragment, null,\n      ___EmotionJSX(CertifiedBadge, { certifiedBy: certifiedBy, details: certificationDetails }), ' '),\n\n      dashboardTitle);},\n\n    Header: t('Title'),\n    accessor: 'dashboard_title' },\n\n  {\n    Cell: (_ref8) => {let { row: { original: { changed_by_name: changedByName, changed_by_url: changedByUrl } } } = _ref8;return enableBroadUserAccess ? ___EmotionJSX(\"a\", { href: changedByUrl }, changedByName) : ___EmotionJSX(React.Fragment, null, changedByName);},\n    Header: t('Modified by'),\n    accessor: 'changed_by.first_name',\n    size: 'xl' },\n\n  {\n    Cell: (_ref9) => {let { row: { original: { status } } } = _ref9;return status === DashboardStatus.PUBLISHED ? t('Published') : t('Draft');},\n    Header: t('Status'),\n    accessor: 'published',\n    size: 'xl' },\n\n  {\n    Cell: (_ref10) => {let { row: { original: { changed_on_delta_humanized: changedOn } } } = _ref10;return ___EmotionJSX(\"span\", { className: \"no-wrap\" }, changedOn);},\n    Header: t('Modified'),\n    accessor: 'changed_on_delta_humanized',\n    size: 'xl' },\n\n  {\n    Cell: (_ref11) => {let { row: { original: { created_by: createdBy } } } = _ref11;return createdBy ? `${createdBy.first_name} ${createdBy.last_name}` : '';},\n    Header: t('Created by'),\n    accessor: 'created_by',\n    disableSortBy: true,\n    size: 'xl' },\n\n  {\n    Cell: (_ref12) => {let { row: { original: { owners = [] } } } = _ref12;return ___EmotionJSX(FacePile, { users: owners });},\n    Header: t('Owners'),\n    accessor: 'owners',\n    disableSortBy: true,\n    size: 'xl' },\n\n  {\n    Cell: (_ref13) => {let { row: { original: { tags = [] } } } = _ref13;return (\n        // Only show custom type tags\n        ___EmotionJSX(TagsList, { tags: tags.filter((tag) => tag.type === 'TagTypes.custom' || tag.type === 1), maxTags: 3 }));},\n    Header: t('Tags'),\n    accessor: 'tags',\n    disableSortBy: true,\n    hidden: !isFeatureEnabled(FeatureFlag.TAGGING_SYSTEM) },\n\n  {\n    Cell: (_ref14) => {let { row: { original } } = _ref14;\n      const handleDelete = () => handleDashboardDelete(original, refreshData, addSuccessToast, addDangerToast);\n      const handleEdit = () => openDashboardEditModal(original);\n      const handleExport = () => handleBulkDashboardExport([original]);\n      return ___EmotionJSX(Actions, { className: \"actions\" },\n      canDelete && ___EmotionJSX(ConfirmStatusChange, { title: t('Please confirm'), description: ___EmotionJSX(React.Fragment, null,\n        t('Are you sure you want to delete'), ' ',\n        ___EmotionJSX(\"b\", null, original.dashboard_title), \"?\"),\n        onConfirm: handleDelete },\n      (confirmDelete) => ___EmotionJSX(Tooltip, { id: \"delete-action-tooltip\", title: t('Delete'), placement: \"bottom\" },\n      ___EmotionJSX(\"span\", { role: \"button\", tabIndex: 0, className: \"action-button\", onClick: confirmDelete },\n      ___EmotionJSX(Icons.Trash, null)))),\n\n\n\n      canExport && ___EmotionJSX(Tooltip, { id: \"export-action-tooltip\", title: t('Export'), placement: \"bottom\" },\n      ___EmotionJSX(\"span\", { role: \"button\", tabIndex: 0, className: \"action-button\", onClick: handleExport },\n      ___EmotionJSX(Icons.Share, null))),\n\n\n      canEdit && ___EmotionJSX(Tooltip, { id: \"edit-action-tooltip\", title: t('Edit'), placement: \"bottom\" },\n      ___EmotionJSX(\"span\", { role: \"button\", tabIndex: 0, className: \"action-button\", onClick: handleEdit },\n      ___EmotionJSX(Icons.EditAlt, null))));\n\n\n\n    },\n    Header: t('Actions'),\n    id: 'actions',\n    hidden: !canEdit && !canDelete && !canExport,\n    disableSortBy: true }],\n\n  [\n  userId,\n  canEdit,\n  canDelete,\n  canExport,\n  saveFavoriteStatus,\n  favoriteStatus,\n  refreshData,\n  addSuccessToast,\n  addDangerToast]);\n\n  const favoritesFilter = useMemo(() => ({\n    Header: t('Favorite'),\n    key: 'favorite',\n    id: 'id',\n    urlDisplay: 'favorite',\n    input: 'select',\n    operator: FilterOperator.dashboardIsFav,\n    unfilteredLabel: t('Any'),\n    selects: [\n    { label: t('Yes'), value: true },\n    { label: t('No'), value: false }] }),\n\n  []);\n  const filters = useMemo(() => {\n    const filters_list = [\n    {\n      Header: t('Search'),\n      key: 'search',\n      id: 'dashboard_title',\n      input: 'search',\n      operator: FilterOperator.titleOrSlug },\n\n    {\n      Header: t('Owner'),\n      key: 'owner',\n      id: 'owners',\n      input: 'select',\n      operator: FilterOperator.relationManyMany,\n      unfilteredLabel: t('All'),\n      fetchSelects: createFetchRelated('dashboard', 'owners', createErrorHandler((errMsg) => addDangerToast(t('An error occurred while fetching dashboard owner values: %s', errMsg))), props.user),\n      paginate: true },\n\n    {\n      Header: t('Created by'),\n      key: 'created_by',\n      id: 'created_by',\n      input: 'select',\n      operator: FilterOperator.relationOneMany,\n      unfilteredLabel: t('All'),\n      fetchSelects: createFetchRelated('dashboard', 'created_by', createErrorHandler((errMsg) => addDangerToast(t('An error occurred while fetching dashboard created by values: %s', errMsg))), props.user),\n      paginate: true },\n\n    {\n      Header: t('Status'),\n      key: 'published',\n      id: 'published',\n      input: 'select',\n      operator: FilterOperator.equals,\n      unfilteredLabel: t('Any'),\n      selects: [\n      { label: t('Published'), value: true },\n      { label: t('Draft'), value: false }] },\n\n\n    ...(userId ? [favoritesFilter] : []),\n    {\n      Header: t('Certified'),\n      key: 'certified',\n      id: 'id',\n      urlDisplay: 'certified',\n      input: 'select',\n      operator: FilterOperator.dashboardIsCertified,\n      unfilteredLabel: t('Any'),\n      selects: [\n      { label: t('Yes'), value: true },\n      { label: t('No'), value: false }] }];\n\n\n\n    if (isFeatureEnabled(FeatureFlag.TAGGING_SYSTEM)) {\n      filters_list.push({\n        Header: t('Tags'),\n        key: 'tags',\n        id: 'tags',\n        input: 'select',\n        operator: FilterOperator.dashboardTags,\n        unfilteredLabel: t('All'),\n        fetchSelects: loadTags });\n\n    }\n    return filters_list;\n  }, [addDangerToast, favoritesFilter, props.user]);\n  const sortTypes = [\n  {\n    desc: false,\n    id: 'dashboard_title',\n    label: t('Alphabetical'),\n    value: 'alphabetical' },\n\n  {\n    desc: true,\n    id: 'changed_on_delta_humanized',\n    label: t('Recently modified'),\n    value: 'recently_modified' },\n\n  {\n    desc: false,\n    id: 'changed_on_delta_humanized',\n    label: t('Least recently modified'),\n    value: 'least_recently_modified' }];\n\n\n  const renderCard = useCallback((dashboard) => ___EmotionJSX(DashboardCard, { dashboard: dashboard, hasPerm: hasPerm, bulkSelectEnabled: bulkSelectEnabled, showThumbnails: userKey ?\n    userKey.thumbnails :\n    isFeatureEnabled(FeatureFlag.THUMBNAILS), userId: userId, loading: loading, openDashboardEditModal: openDashboardEditModal, saveFavoriteStatus: saveFavoriteStatus, favoriteStatus: favoriteStatus[dashboard.id], handleBulkDashboardExport: handleBulkDashboardExport, onDelete: (dashboard) => setDashboardToDelete(dashboard) }), [\n  bulkSelectEnabled,\n  favoriteStatus,\n  hasPerm,\n  loading,\n  userId,\n  saveFavoriteStatus,\n  userKey]);\n\n  const subMenuButtons = [];\n  if (canDelete || canExport) {\n    subMenuButtons.push({\n      name: t('Bulk select'),\n      buttonStyle: 'secondary',\n      'data-test': 'bulk-select',\n      onClick: toggleBulkSelect });\n\n  }\n  if (canCreate) {\n    subMenuButtons.push({\n      name: ___EmotionJSX(React.Fragment, null,\n      ___EmotionJSX(\"i\", { className: \"fa fa-plus\" }), \" \", t('Dashboard')),\n\n      buttonStyle: 'primary',\n      onClick: () => {\n        window.location.assign('/dashboard/new');\n      } });\n\n    if (isFeatureEnabled(FeatureFlag.VERSIONED_EXPORT)) {\n      subMenuButtons.push({\n        name: ___EmotionJSX(Tooltip, { id: \"import-tooltip\", title: t('Import dashboards'), placement: \"bottomRight\" },\n        ___EmotionJSX(Icons.Import, null)),\n\n        buttonStyle: 'link',\n        onClick: openDashboardImportModal });\n\n    }\n  }\n  return ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(SubMenu, { name: t('Dashboards'), buttons: subMenuButtons }),\n  ___EmotionJSX(ConfirmStatusChange, { title: t('Please confirm'), description: t('Are you sure you want to delete the selected dashboards?'), onConfirm: handleBulkDashboardDelete },\n  (confirmDelete) => {\n    const bulkActions = [];\n    if (canDelete) {\n      bulkActions.push({\n        key: 'delete',\n        name: t('Delete'),\n        type: 'danger',\n        onSelect: confirmDelete });\n\n    }\n    if (canExport) {\n      bulkActions.push({\n        key: 'export',\n        name: t('Export'),\n        type: 'primary',\n        onSelect: handleBulkDashboardExport });\n\n    }\n    return ___EmotionJSX(React.Fragment, null,\n    dashboardToEdit && ___EmotionJSX(PropertiesModal, { dashboardId: dashboardToEdit.id, show: true, onHide: () => setDashboardToEdit(null), onSubmit: handleDashboardEdit }),\n    dashboardToDelete && ___EmotionJSX(DeleteModal, { description: ___EmotionJSX(React.Fragment, null,\n      t('Are you sure you want to delete'), ' ',\n      ___EmotionJSX(\"b\", null, dashboardToDelete.dashboard_title), \"?\"),\n      onConfirm: () => {\n        handleDashboardDelete(dashboardToDelete, refreshData, addSuccessToast, addDangerToast, undefined, userId);\n        setDashboardToDelete(null);\n      }, onHide: () => setDashboardToDelete(null), open: !!dashboardToDelete, title: t('Please confirm') }),\n    ___EmotionJSX(ListView, { bulkActions: bulkActions, bulkSelectEnabled: bulkSelectEnabled, cardSortSelectOptions: sortTypes, className: \"dashboard-list-view\", columns: columns, count: dashboardCount, data: dashboards, disableBulkSelect: toggleBulkSelect, fetchData: fetchData, filters: filters, initialSort: initialSort, loading: loading, pageSize: PAGE_SIZE, showThumbnails: userKey ?\n      userKey.thumbnails :\n      isFeatureEnabled(FeatureFlag.THUMBNAILS), renderCard: renderCard, defaultViewMode: isFeatureEnabled(FeatureFlag.LISTVIEWS_DEFAULT_CARD_VIEW) ?\n      'card' :\n      'table' }));\n\n  }),\n\n\n  ___EmotionJSX(ImportModelsModal, { resourceName: \"dashboard\", resourceLabel: t('dashboard'), passwordsNeededMessage: PASSWORDS_NEEDED_MESSAGE, confirmOverwriteMessage: CONFIRM_OVERWRITE_MESSAGE, addDangerToast: addDangerToast, addSuccessToast: addSuccessToast, onModelImport: handleDashboardImport, show: importingDashboard, onHide: closeDashboardImportModal, passwordFields: passwordFields, setPasswordFields: setPasswordFields, sshTunnelPasswordFields: sshTunnelPasswordFields, setSSHTunnelPasswordFields: setSSHTunnelPasswordFields, sshTunnelPrivateKeyFields: sshTunnelPrivateKeyFields, setSSHTunnelPrivateKeyFields: setSSHTunnelPrivateKeyFields, sshTunnelPrivateKeyPasswordFields: sshTunnelPrivateKeyPasswordFields, setSSHTunnelPrivateKeyPasswordFields: setSSHTunnelPrivateKeyPasswordFields }),\n\n  preparingExport && ___EmotionJSX(Loading, null));\n\n}\nexport default withToasts(DashboardList);","map":{"version":3,"mappings":"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","names":["FeatureFlag","styled","SupersetClient","t","React","useState","useMemo","useCallback","Link","rison","isFeatureEnabled","createFetchRelated","createErrorHandler","handleDashboardDelete","useListViewResource","useFavoriteStatus","ConfirmStatusChange","TagsList","handleResourceExport","Loading","SubMenu","ListView","FilterOperator","dangerouslyGetItemDoNotUse","withToasts","FacePile","Icons","DeleteModal","FaveStar","PropertiesModal","Tooltip","ImportModelsModal","CertifiedBadge","loadTags","getBootstrapData","DashboardCard","DashboardStatus","PAGE_SIZE","PASSWORDS_NEEDED_MESSAGE","CONFIRM_OVERWRITE_MESSAGE","Actions","div","theme","colors","grayscale","base","bootstrapData","DashboardList","props","addDangerToast","addSuccessToast","user","userId","state","loading","resourceCount","dashboardCount","resourceCollection","dashboards","bulkSelectEnabled","setResourceCollection","setDashboards","hasPerm","fetchData","toggleBulkSelect","refreshData","dashboardIds","map","d","id","saveFavoriteStatus","favoriteStatus","dashboardToEdit","setDashboardToEdit","dashboardToDelete","setDashboardToDelete","importingDashboard","showImportModal","passwordFields","setPasswordFields","preparingExport","setPreparingExport","enableBroadUserAccess","common","conf","ENABLE_BROAD_ACTIVITY_ACCESS","sshTunnelPasswordFields","setSSHTunnelPasswordFields","sshTunnelPrivateKeyFields","setSSHTunnelPrivateKeyFields","sshTunnelPrivateKeyPasswordFields","setSSHTunnelPrivateKeyPasswordFields","openDashboardImportModal","closeDashboardImportModal","handleDashboardImport","userKey","toString","canCreate","canEdit","canDelete","canExport","VERSIONED_EXPORT","initialSort","desc","openDashboardEditModal","dashboard","handleDashboardEdit","edits","get","endpoint","then","json","result","changed_by_name","changed_by_url","changed_by","dashboard_title","slug","json_metadata","changed_on_delta_humanized","url","certified_by","certification_details","owners","tags","errMsg","handleBulkDashboardExport","dashboardsToExport","ids","handleBulkDashboardDelete","dashboardsToDelete","delete","encode","message","columns","Cell","row","original","Header","disableSortBy","size","hidden","dashboardTitle","certifiedBy","certificationDetails","accessor","changedByName","changedByUrl","status","PUBLISHED","changedOn","created_by","createdBy","first_name","last_name","filter","tag","type","TAGGING_SYSTEM","handleDelete","handleEdit","handleExport","confirmDelete","favoritesFilter","key","urlDisplay","input","operator","dashboardIsFav","unfilteredLabel","selects","label","value","filters","filters_list","titleOrSlug","relationManyMany","fetchSelects","paginate","relationOneMany","equals","dashboardIsCertified","push","dashboardTags","sortTypes","renderCard","thumbnails","THUMBNAILS","subMenuButtons","name","buttonStyle","onClick","window","location","assign","bulkActions","onSelect","undefined","LISTVIEWS_DEFAULT_CARD_VIEW"],"sourceRoot":"","sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/pages/DashboardList/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FeatureFlag, styled, SupersetClient, t } from '@superset-ui/core';\nimport React, { useState, useMemo, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\nimport rison from 'rison';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport {\n  createFetchRelated,\n  createErrorHandler,\n  handleDashboardDelete,\n} from 'src/views/CRUD/utils';\nimport { useListViewResource, useFavoriteStatus } from 'src/views/CRUD/hooks';\nimport ConfirmStatusChange from 'src/components/ConfirmStatusChange';\nimport { TagsList } from 'src/components/Tags';\nimport handleResourceExport from 'src/utils/export';\nimport Loading from 'src/components/Loading';\nimport SubMenu, { SubMenuProps } from 'src/features/home/SubMenu';\nimport ListView, {\n  ListViewProps,\n  Filter,\n  Filters,\n  FilterOperator,\n} from 'src/components/ListView';\nimport { dangerouslyGetItemDoNotUse } from 'src/utils/localStorageHelpers';\nimport Owner from 'src/types/Owner';\nimport Tag from 'src/types/TagType';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport FacePile from 'src/components/FacePile';\nimport Icons from 'src/components/Icons';\nimport DeleteModal from 'src/components/DeleteModal';\nimport FaveStar from 'src/components/FaveStar';\nimport PropertiesModal from 'src/dashboard/components/PropertiesModal';\nimport { Tooltip } from 'src/components/Tooltip';\nimport ImportModelsModal from 'src/components/ImportModal/index';\n\nimport Dashboard from 'src/dashboard/containers/Dashboard';\nimport { Dashboard as CRUDDashboard } from 'src/views/CRUD/types';\nimport CertifiedBadge from 'src/components/CertifiedBadge';\nimport { loadTags } from 'src/components/Tags/utils';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport DashboardCard from 'src/features/dashboards/DashboardCard';\nimport { DashboardStatus } from 'src/features/dashboards/types';\n\nconst PAGE_SIZE = 25;\nconst PASSWORDS_NEEDED_MESSAGE = t(\n  'The passwords for the databases below are needed in order to ' +\n    'import them together with the dashboards. Please note that the ' +\n    '\"Secure Extra\" and \"Certificate\" sections of ' +\n    'the database configuration are not present in export files, and ' +\n    'should be added manually after the import if they are needed.',\n);\nconst CONFIRM_OVERWRITE_MESSAGE = t(\n  'You are importing one or more dashboards that already exist. ' +\n    'Overwriting might cause you to lose some of your work. Are you ' +\n    'sure you want to overwrite?',\n);\n\ninterface DashboardListProps {\n  addDangerToast: (msg: string) => void;\n  addSuccessToast: (msg: string) => void;\n  user: {\n    userId: string | number;\n    firstName: string;\n    lastName: string;\n  };\n}\n\ninterface Dashboard {\n  changed_by_name: string;\n  changed_by_url: string;\n  changed_on_delta_humanized: string;\n  changed_by: string;\n  dashboard_title: string;\n  id: number;\n  published: boolean;\n  url: string;\n  thumbnail_url: string;\n  owners: Owner[];\n  tags: Tag[];\n  created_by: object;\n}\n\nconst Actions = styled.div`\n  color: ${({ theme }) => theme.colors.grayscale.base};\n`;\n\nconst bootstrapData = getBootstrapData();\n\nfunction DashboardList(props: DashboardListProps) {\n  const {\n    addDangerToast,\n    addSuccessToast,\n    user: { userId },\n  } = props;\n\n  const {\n    state: {\n      loading,\n      resourceCount: dashboardCount,\n      resourceCollection: dashboards,\n      bulkSelectEnabled,\n    },\n    setResourceCollection: setDashboards,\n    hasPerm,\n    fetchData,\n    toggleBulkSelect,\n    refreshData,\n  } = useListViewResource<Dashboard>(\n    'dashboard',\n    t('dashboard'),\n    addDangerToast,\n  );\n  const dashboardIds = useMemo(() => dashboards.map(d => d.id), [dashboards]);\n  const [saveFavoriteStatus, favoriteStatus] = useFavoriteStatus(\n    'dashboard',\n    dashboardIds,\n    addDangerToast,\n  );\n\n  const [dashboardToEdit, setDashboardToEdit] = useState<Dashboard | null>(\n    null,\n  );\n  const [dashboardToDelete, setDashboardToDelete] =\n    useState<CRUDDashboard | null>(null);\n\n  const [importingDashboard, showImportModal] = useState<boolean>(false);\n  const [passwordFields, setPasswordFields] = useState<string[]>([]);\n  const [preparingExport, setPreparingExport] = useState<boolean>(false);\n  const enableBroadUserAccess =\n    bootstrapData?.common?.conf?.ENABLE_BROAD_ACTIVITY_ACCESS;\n  const [sshTunnelPasswordFields, setSSHTunnelPasswordFields] = useState<\n    string[]\n  >([]);\n  const [sshTunnelPrivateKeyFields, setSSHTunnelPrivateKeyFields] = useState<\n    string[]\n  >([]);\n  const [\n    sshTunnelPrivateKeyPasswordFields,\n    setSSHTunnelPrivateKeyPasswordFields,\n  ] = useState<string[]>([]);\n\n  const openDashboardImportModal = () => {\n    showImportModal(true);\n  };\n\n  const closeDashboardImportModal = () => {\n    showImportModal(false);\n  };\n\n  const handleDashboardImport = () => {\n    showImportModal(false);\n    refreshData();\n    addSuccessToast(t('Dashboard imported'));\n  };\n\n  // TODO: Fix usage of localStorage keying on the user id\n  const userKey = dangerouslyGetItemDoNotUse(userId?.toString(), null);\n\n  const canCreate = hasPerm('can_write');\n  const canEdit = hasPerm('can_write');\n  const canDelete = hasPerm('can_write');\n  const canExport =\n    hasPerm('can_export') && isFeatureEnabled(FeatureFlag.VERSIONED_EXPORT);\n\n  const initialSort = [{ id: 'changed_on_delta_humanized', desc: true }];\n\n  function openDashboardEditModal(dashboard: Dashboard) {\n    setDashboardToEdit(dashboard);\n  }\n\n  function handleDashboardEdit(edits: Dashboard) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${edits.id}`,\n    }).then(\n      ({ json = {} }) => {\n        setDashboards(\n          dashboards.map(dashboard => {\n            if (dashboard.id === json?.result?.id) {\n              const {\n                changed_by_name,\n                changed_by_url,\n                changed_by,\n                dashboard_title = '',\n                slug = '',\n                json_metadata = '',\n                changed_on_delta_humanized,\n                url = '',\n                certified_by = '',\n                certification_details = '',\n                owners,\n                tags,\n              } = json.result;\n              return {\n                ...dashboard,\n                changed_by_name,\n                changed_by_url,\n                changed_by,\n                dashboard_title,\n                slug,\n                json_metadata,\n                changed_on_delta_humanized,\n                url,\n                certified_by,\n                certification_details,\n                owners,\n                tags,\n              };\n            }\n            return dashboard;\n          }),\n        );\n      },\n      createErrorHandler(errMsg =>\n        addDangerToast(\n          t('An error occurred while fetching dashboards: %s', errMsg),\n        ),\n      ),\n    );\n  }\n\n  const handleBulkDashboardExport = (dashboardsToExport: Dashboard[]) => {\n    const ids = dashboardsToExport.map(({ id }) => id);\n    handleResourceExport('dashboard', ids, () => {\n      setPreparingExport(false);\n    });\n    setPreparingExport(true);\n  };\n\n  function handleBulkDashboardDelete(dashboardsToDelete: Dashboard[]) {\n    return SupersetClient.delete({\n      endpoint: `/api/v1/dashboard/?q=${rison.encode(\n        dashboardsToDelete.map(({ id }) => id),\n      )}`,\n    }).then(\n      ({ json = {} }) => {\n        refreshData();\n        addSuccessToast(json.message);\n      },\n      createErrorHandler(errMsg =>\n        addDangerToast(\n          t('There was an issue deleting the selected dashboards: ', errMsg),\n        ),\n      ),\n    );\n  }\n\n  const columns = useMemo(\n    () => [\n      {\n        Cell: ({\n          row: {\n            original: { id },\n          },\n        }: any) =>\n          userId && (\n            <FaveStar\n              itemId={id}\n              saveFaveStar={saveFavoriteStatus}\n              isStarred={favoriteStatus[id]}\n            />\n          ),\n        Header: '',\n        id: 'id',\n        disableSortBy: true,\n        size: 'xs',\n        hidden: !userId,\n      },\n      {\n        Cell: ({\n          row: {\n            original: {\n              url,\n              dashboard_title: dashboardTitle,\n              certified_by: certifiedBy,\n              certification_details: certificationDetails,\n            },\n          },\n        }: any) => (\n          <Link to={url}>\n            {certifiedBy && (\n              <>\n                <CertifiedBadge\n                  certifiedBy={certifiedBy}\n                  details={certificationDetails}\n                />{' '}\n              </>\n            )}\n            {dashboardTitle}\n          </Link>\n        ),\n        Header: t('Title'),\n        accessor: 'dashboard_title',\n      },\n\n      {\n        Cell: ({\n          row: {\n            original: {\n              changed_by_name: changedByName,\n              changed_by_url: changedByUrl,\n            },\n          },\n        }: any) =>\n          enableBroadUserAccess ? (\n            <a href={changedByUrl}>{changedByName}</a>\n          ) : (\n            <>{changedByName}</>\n          ),\n        Header: t('Modified by'),\n        accessor: 'changed_by.first_name',\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { status },\n          },\n        }: any) =>\n          status === DashboardStatus.PUBLISHED ? t('Published') : t('Draft'),\n        Header: t('Status'),\n        accessor: 'published',\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { changed_on_delta_humanized: changedOn },\n          },\n        }: any) => <span className=\"no-wrap\">{changedOn}</span>,\n        Header: t('Modified'),\n        accessor: 'changed_on_delta_humanized',\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { created_by: createdBy },\n          },\n        }: any) =>\n          createdBy ? `${createdBy.first_name} ${createdBy.last_name}` : '',\n        Header: t('Created by'),\n        accessor: 'created_by',\n        disableSortBy: true,\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { owners = [] },\n          },\n        }: any) => <FacePile users={owners} />,\n        Header: t('Owners'),\n        accessor: 'owners',\n        disableSortBy: true,\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { tags = [] },\n          },\n        }: {\n          row: {\n            original: {\n              tags: Tag[];\n            };\n          };\n        }) => (\n          // Only show custom type tags\n          <TagsList\n            tags={tags.filter(\n              (tag: Tag) => tag.type === 'TagTypes.custom' || tag.type === 1,\n            )}\n            maxTags={3}\n          />\n        ),\n        Header: t('Tags'),\n        accessor: 'tags',\n        disableSortBy: true,\n        hidden: !isFeatureEnabled(FeatureFlag.TAGGING_SYSTEM),\n      },\n      {\n        Cell: ({ row: { original } }: any) => {\n          const handleDelete = () =>\n            handleDashboardDelete(\n              original,\n              refreshData,\n              addSuccessToast,\n              addDangerToast,\n            );\n          const handleEdit = () => openDashboardEditModal(original);\n          const handleExport = () => handleBulkDashboardExport([original]);\n\n          return (\n            <Actions className=\"actions\">\n              {canDelete && (\n                <ConfirmStatusChange\n                  title={t('Please confirm')}\n                  description={\n                    <>\n                      {t('Are you sure you want to delete')}{' '}\n                      <b>{original.dashboard_title}</b>?\n                    </>\n                  }\n                  onConfirm={handleDelete}\n                >\n                  {confirmDelete => (\n                    <Tooltip\n                      id=\"delete-action-tooltip\"\n                      title={t('Delete')}\n                      placement=\"bottom\"\n                    >\n                      <span\n                        role=\"button\"\n                        tabIndex={0}\n                        className=\"action-button\"\n                        onClick={confirmDelete}\n                      >\n                        <Icons.Trash data-test=\"dashboard-list-trash-icon\" />\n                      </span>\n                    </Tooltip>\n                  )}\n                </ConfirmStatusChange>\n              )}\n              {canExport && (\n                <Tooltip\n                  id=\"export-action-tooltip\"\n                  title={t('Export')}\n                  placement=\"bottom\"\n                >\n                  <span\n                    role=\"button\"\n                    tabIndex={0}\n                    className=\"action-button\"\n                    onClick={handleExport}\n                  >\n                    <Icons.Share />\n                  </span>\n                </Tooltip>\n              )}\n              {canEdit && (\n                <Tooltip\n                  id=\"edit-action-tooltip\"\n                  title={t('Edit')}\n                  placement=\"bottom\"\n                >\n                  <span\n                    role=\"button\"\n                    tabIndex={0}\n                    className=\"action-button\"\n                    onClick={handleEdit}\n                  >\n                    <Icons.EditAlt data-test=\"edit-alt\" />\n                  </span>\n                </Tooltip>\n              )}\n            </Actions>\n          );\n        },\n        Header: t('Actions'),\n        id: 'actions',\n        hidden: !canEdit && !canDelete && !canExport,\n        disableSortBy: true,\n      },\n    ],\n    [\n      userId,\n      canEdit,\n      canDelete,\n      canExport,\n      saveFavoriteStatus,\n      favoriteStatus,\n      refreshData,\n      addSuccessToast,\n      addDangerToast,\n    ],\n  );\n\n  const favoritesFilter: Filter = useMemo(\n    () => ({\n      Header: t('Favorite'),\n      key: 'favorite',\n      id: 'id',\n      urlDisplay: 'favorite',\n      input: 'select',\n      operator: FilterOperator.dashboardIsFav,\n      unfilteredLabel: t('Any'),\n      selects: [\n        { label: t('Yes'), value: true },\n        { label: t('No'), value: false },\n      ],\n    }),\n    [],\n  );\n\n  const filters: Filters = useMemo(() => {\n    const filters_list = [\n      {\n        Header: t('Search'),\n        key: 'search',\n        id: 'dashboard_title',\n        input: 'search',\n        operator: FilterOperator.titleOrSlug,\n      },\n      {\n        Header: t('Owner'),\n        key: 'owner',\n        id: 'owners',\n        input: 'select',\n        operator: FilterOperator.relationManyMany,\n        unfilteredLabel: t('All'),\n        fetchSelects: createFetchRelated(\n          'dashboard',\n          'owners',\n          createErrorHandler(errMsg =>\n            addDangerToast(\n              t(\n                'An error occurred while fetching dashboard owner values: %s',\n                errMsg,\n              ),\n            ),\n          ),\n          props.user,\n        ),\n        paginate: true,\n      },\n      {\n        Header: t('Created by'),\n        key: 'created_by',\n        id: 'created_by',\n        input: 'select',\n        operator: FilterOperator.relationOneMany,\n        unfilteredLabel: t('All'),\n        fetchSelects: createFetchRelated(\n          'dashboard',\n          'created_by',\n          createErrorHandler(errMsg =>\n            addDangerToast(\n              t(\n                'An error occurred while fetching dashboard created by values: %s',\n                errMsg,\n              ),\n            ),\n          ),\n          props.user,\n        ),\n        paginate: true,\n      },\n      {\n        Header: t('Status'),\n        key: 'published',\n        id: 'published',\n        input: 'select',\n        operator: FilterOperator.equals,\n        unfilteredLabel: t('Any'),\n        selects: [\n          { label: t('Published'), value: true },\n          { label: t('Draft'), value: false },\n        ],\n      },\n      ...(userId ? [favoritesFilter] : []),\n      {\n        Header: t('Certified'),\n        key: 'certified',\n        id: 'id',\n        urlDisplay: 'certified',\n        input: 'select',\n        operator: FilterOperator.dashboardIsCertified,\n        unfilteredLabel: t('Any'),\n        selects: [\n          { label: t('Yes'), value: true },\n          { label: t('No'), value: false },\n        ],\n      },\n    ] as Filters;\n    if (isFeatureEnabled(FeatureFlag.TAGGING_SYSTEM)) {\n      filters_list.push({\n        Header: t('Tags'),\n        key: 'tags',\n        id: 'tags',\n        input: 'select',\n        operator: FilterOperator.dashboardTags,\n        unfilteredLabel: t('All'),\n        fetchSelects: loadTags,\n      });\n    }\n    return filters_list;\n  }, [addDangerToast, favoritesFilter, props.user]);\n\n  const sortTypes = [\n    {\n      desc: false,\n      id: 'dashboard_title',\n      label: t('Alphabetical'),\n      value: 'alphabetical',\n    },\n    {\n      desc: true,\n      id: 'changed_on_delta_humanized',\n      label: t('Recently modified'),\n      value: 'recently_modified',\n    },\n    {\n      desc: false,\n      id: 'changed_on_delta_humanized',\n      label: t('Least recently modified'),\n      value: 'least_recently_modified',\n    },\n  ];\n\n  const renderCard = useCallback(\n    (dashboard: Dashboard) => (\n      <DashboardCard\n        dashboard={dashboard}\n        hasPerm={hasPerm}\n        bulkSelectEnabled={bulkSelectEnabled}\n        showThumbnails={\n          userKey\n            ? userKey.thumbnails\n            : isFeatureEnabled(FeatureFlag.THUMBNAILS)\n        }\n        userId={userId}\n        loading={loading}\n        openDashboardEditModal={openDashboardEditModal}\n        saveFavoriteStatus={saveFavoriteStatus}\n        favoriteStatus={favoriteStatus[dashboard.id]}\n        handleBulkDashboardExport={handleBulkDashboardExport}\n        onDelete={dashboard => setDashboardToDelete(dashboard)}\n      />\n    ),\n    [\n      bulkSelectEnabled,\n      favoriteStatus,\n      hasPerm,\n      loading,\n      userId,\n      saveFavoriteStatus,\n      userKey,\n    ],\n  );\n\n  const subMenuButtons: SubMenuProps['buttons'] = [];\n  if (canDelete || canExport) {\n    subMenuButtons.push({\n      name: t('Bulk select'),\n      buttonStyle: 'secondary',\n      'data-test': 'bulk-select',\n      onClick: toggleBulkSelect,\n    });\n  }\n  if (canCreate) {\n    subMenuButtons.push({\n      name: (\n        <>\n          <i className=\"fa fa-plus\" /> {t('Dashboard')}\n        </>\n      ),\n      buttonStyle: 'primary',\n      onClick: () => {\n        window.location.assign('/dashboard/new');\n      },\n    });\n\n    if (isFeatureEnabled(FeatureFlag.VERSIONED_EXPORT)) {\n      subMenuButtons.push({\n        name: (\n          <Tooltip\n            id=\"import-tooltip\"\n            title={t('Import dashboards')}\n            placement=\"bottomRight\"\n          >\n            <Icons.Import data-test=\"import-button\" />\n          </Tooltip>\n        ),\n        buttonStyle: 'link',\n        onClick: openDashboardImportModal,\n      });\n    }\n  }\n  return (\n    <>\n      <SubMenu name={t('Dashboards')} buttons={subMenuButtons} />\n      <ConfirmStatusChange\n        title={t('Please confirm')}\n        description={t(\n          'Are you sure you want to delete the selected dashboards?',\n        )}\n        onConfirm={handleBulkDashboardDelete}\n      >\n        {confirmDelete => {\n          const bulkActions: ListViewProps['bulkActions'] = [];\n          if (canDelete) {\n            bulkActions.push({\n              key: 'delete',\n              name: t('Delete'),\n              type: 'danger',\n              onSelect: confirmDelete,\n            });\n          }\n          if (canExport) {\n            bulkActions.push({\n              key: 'export',\n              name: t('Export'),\n              type: 'primary',\n              onSelect: handleBulkDashboardExport,\n            });\n          }\n          return (\n            <>\n              {dashboardToEdit && (\n                <PropertiesModal\n                  dashboardId={dashboardToEdit.id}\n                  show\n                  onHide={() => setDashboardToEdit(null)}\n                  onSubmit={handleDashboardEdit}\n                />\n              )}\n              {dashboardToDelete && (\n                <DeleteModal\n                  description={\n                    <>\n                      {t('Are you sure you want to delete')}{' '}\n                      <b>{dashboardToDelete.dashboard_title}</b>?\n                    </>\n                  }\n                  onConfirm={() => {\n                    handleDashboardDelete(\n                      dashboardToDelete,\n                      refreshData,\n                      addSuccessToast,\n                      addDangerToast,\n                      undefined,\n                      userId,\n                    );\n                    setDashboardToDelete(null);\n                  }}\n                  onHide={() => setDashboardToDelete(null)}\n                  open={!!dashboardToDelete}\n                  title={t('Please confirm')}\n                />\n              )}\n              <ListView<Dashboard>\n                bulkActions={bulkActions}\n                bulkSelectEnabled={bulkSelectEnabled}\n                cardSortSelectOptions={sortTypes}\n                className=\"dashboard-list-view\"\n                columns={columns}\n                count={dashboardCount}\n                data={dashboards}\n                disableBulkSelect={toggleBulkSelect}\n                fetchData={fetchData}\n                filters={filters}\n                initialSort={initialSort}\n                loading={loading}\n                pageSize={PAGE_SIZE}\n                showThumbnails={\n                  userKey\n                    ? userKey.thumbnails\n                    : isFeatureEnabled(FeatureFlag.THUMBNAILS)\n                }\n                renderCard={renderCard}\n                defaultViewMode={\n                  isFeatureEnabled(FeatureFlag.LISTVIEWS_DEFAULT_CARD_VIEW)\n                    ? 'card'\n                    : 'table'\n                }\n              />\n            </>\n          );\n        }}\n      </ConfirmStatusChange>\n\n      <ImportModelsModal\n        resourceName=\"dashboard\"\n        resourceLabel={t('dashboard')}\n        passwordsNeededMessage={PASSWORDS_NEEDED_MESSAGE}\n        confirmOverwriteMessage={CONFIRM_OVERWRITE_MESSAGE}\n        addDangerToast={addDangerToast}\n        addSuccessToast={addSuccessToast}\n        onModelImport={handleDashboardImport}\n        show={importingDashboard}\n        onHide={closeDashboardImportModal}\n        passwordFields={passwordFields}\n        setPasswordFields={setPasswordFields}\n        sshTunnelPasswordFields={sshTunnelPasswordFields}\n        setSSHTunnelPasswordFields={setSSHTunnelPasswordFields}\n        sshTunnelPrivateKeyFields={sshTunnelPrivateKeyFields}\n        setSSHTunnelPrivateKeyFields={setSSHTunnelPrivateKeyFields}\n        sshTunnelPrivateKeyPasswordFields={sshTunnelPrivateKeyPasswordFields}\n        setSSHTunnelPrivateKeyPasswordFields={\n          setSSHTunnelPrivateKeyPasswordFields\n        }\n      />\n\n      {preparingExport && <Loading />}\n    </>\n  );\n}\n\nexport default withToasts(DashboardList);\n"]},"metadata":{},"sourceType":"module"}