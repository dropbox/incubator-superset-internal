{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ScatterplotLayer } from 'deck.gl';\nimport React from 'react';\nimport { getMetricLabel, t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport { createCategoricalDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\nimport { unitToRadius } from '../../utils/geo';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nfunction getPoints(data) {\n  return data.map((d) => d.position);\n}\n\nfunction setTooltipContent(formData, verboseMap) {\n  return (o) => {var _formData$point_radiu;\n    const label =\n    (verboseMap == null ? void 0 : verboseMap[formData.point_radius_fixed.value]) ||\n    getMetricLabel((_formData$point_radiu = formData.point_radius_fixed) == null ? void 0 : _formData$point_radiu.value);\n    return (\n      ___EmotionJSX(\"div\", { className: \"deckgl-tooltip\" },\n      ___EmotionJSX(TooltipRow\n      // eslint-disable-next-line prefer-template\n      , { label: t('Longitude and Latitude') + ': ',\n        value: `${o.object.position[0]}, ${o.object.position[1]}` }),\n\n      o.object.cat_color &&\n      ___EmotionJSX(TooltipRow\n      // eslint-disable-next-line prefer-template\n      , { label: t('Category') + ': ',\n        value: `${o.object.cat_color}` }),\n\n\n      o.object.metric &&\n      ___EmotionJSX(TooltipRow, { label: `${label}: `, value: `${o.object.metric}` })));\n\n\n\n  };\n}\n\nexport function getLayer(\nformData,\npayload,\nonAddFilter,\nsetTooltip,\ndatasource)\n{\n  const fd = formData;\n  const dataWithRadius = payload.data.features.map((d) => {\n    let radius = unitToRadius(fd.point_unit, d.radius) || 10;\n    if (fd.multiplier) {\n      radius *= fd.multiplier;\n    }\n    if (d.color) {\n      return { ...d, radius };\n    }\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const color = [c.r, c.g, c.b, c.a * 255];\n\n    return { ...d, radius, color };\n  });\n\n  return new ScatterplotLayer({\n    id: `scatter-layer-${fd.slice_id}`,\n    data: dataWithRadius,\n    fp64: true,\n    getFillColor: (d) => d.color,\n    getRadius: (d) => d.radius,\n    radiusMinPixels: fd.min_radius || null,\n    radiusMaxPixels: fd.max_radius || null,\n    stroked: false,\n    ...commonLayerProps(\n    fd,\n    setTooltip,\n    setTooltipContent(fd, datasource == null ? void 0 : datasource.verboseMap)) });\n\n\n}const _default =\n\ncreateCategoricalDeckGLComponent(getLayer, getPoints);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getPoints, \"getPoints\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx\");reactHotLoader.register(setTooltipContent, \"setTooltipContent\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx\");reactHotLoader.register(getLayer, \"getLayer\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx\");reactHotLoader.register(_default, \"default\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["ScatterplotLayer","React","getMetricLabel","t","commonLayerProps","createCategoricalDeckGLComponent","TooltipRow","unitToRadius","getPoints","data","map","d","position","setTooltipContent","formData","verboseMap","o","label","point_radius_fixed","value","object","cat_color","metric","getLayer","payload","onAddFilter","setTooltip","datasource","fd","dataWithRadius","features","radius","point_unit","multiplier","color","c","color_picker","r","g","b","a","id","slice_id","fp64","getFillColor","getRadius","radiusMinPixels","min_radius","radiusMaxPixels","max_radius","stroked"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ScatterplotLayer } from 'deck.gl';\nimport React from 'react';\nimport { getMetricLabel, t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport { createCategoricalDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\nimport { unitToRadius } from '../../utils/geo';\n\nfunction getPoints(data) {\n  return data.map(d => d.position);\n}\n\nfunction setTooltipContent(formData, verboseMap) {\n  return o => {\n    const label =\n      verboseMap?.[formData.point_radius_fixed.value] ||\n      getMetricLabel(formData.point_radius_fixed?.value);\n    return (\n      <div className=\"deckgl-tooltip\">\n        <TooltipRow\n          // eslint-disable-next-line prefer-template\n          label={t('Longitude and Latitude') + ': '}\n          value={`${o.object.position[0]}, ${o.object.position[1]}`}\n        />\n        {o.object.cat_color && (\n          <TooltipRow\n            // eslint-disable-next-line prefer-template\n            label={t('Category') + ': '}\n            value={`${o.object.cat_color}`}\n          />\n        )}\n        {o.object.metric && (\n          <TooltipRow label={`${label}: `} value={`${o.object.metric}`} />\n        )}\n      </div>\n    );\n  };\n}\n\nexport function getLayer(\n  formData,\n  payload,\n  onAddFilter,\n  setTooltip,\n  datasource,\n) {\n  const fd = formData;\n  const dataWithRadius = payload.data.features.map(d => {\n    let radius = unitToRadius(fd.point_unit, d.radius) || 10;\n    if (fd.multiplier) {\n      radius *= fd.multiplier;\n    }\n    if (d.color) {\n      return { ...d, radius };\n    }\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const color = [c.r, c.g, c.b, c.a * 255];\n\n    return { ...d, radius, color };\n  });\n\n  return new ScatterplotLayer({\n    id: `scatter-layer-${fd.slice_id}`,\n    data: dataWithRadius,\n    fp64: true,\n    getFillColor: d => d.color,\n    getRadius: d => d.radius,\n    radiusMinPixels: fd.min_radius || null,\n    radiusMaxPixels: fd.max_radius || null,\n    stroked: false,\n    ...commonLayerProps(\n      fd,\n      setTooltip,\n      setTooltipContent(fd, datasource?.verboseMap),\n    ),\n  });\n}\n\nexport default createCategoricalDeckGLComponent(getLayer, getPoints);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}