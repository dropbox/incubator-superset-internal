{"ast":null,"code":"import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\"; /* eslint-disable react/sort-prop-types */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-param-reassign: [2, {\"props\": false}] */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { hierarchy } from 'd3-hierarchy';\nimport {\ngetNumberFormatter,\ngetTimeFormatter,\nCategoricalColorNamespace } from\n'@superset-ui/core';\n\n// Compute dx, dy, x, y for each node and\n// return an array of nodes in breadth-first order\nfunction init(root) {\n  const flat = [];\n  const dy = 1 / (root.height + 1);\n  let prev = null;\n  root.each((n) => {\n    n.y = dy * n.depth;\n    n.dy = dy;\n    if (n.parent) {\n      n.x = prev.depth === n.parent.depth ? 0 : prev.x + prev.dx;\n      n.dx = n.weight / n.parent.sum * n.parent.dx;\n    } else {\n      n.x = 0;\n      n.dx = 1;\n    }\n    prev = n;\n    flat.push(n);\n  });\n\n  return flat;\n}\n\n// Declare PropTypes for recursive data structures\n// https://github.com/facebook/react/issues/5676\n/* eslint-disable-next-line  no-undef */\nconst lazyFunction = (f) => () => f().apply(this, arguments);\nconst leafType = PropTypes.shape({\n  name: PropTypes.string,\n  val: PropTypes.number.isRequired });\n\nconst parentShape = {\n  name: PropTypes.string,\n  val: PropTypes.number.isRequired,\n  children: PropTypes.arrayOf(\n  PropTypes.oneOfType([\n  PropTypes.shape(lazyFunction(() => parentShape)),\n  leafType])) };\n\n\n\nconst nodeType = PropTypes.oneOfType([PropTypes.shape(parentShape), leafType]);\n\nconst propTypes = {\n  data: PropTypes.arrayOf(nodeType), // array of rootNode\n  width: PropTypes.number,\n  height: PropTypes.number,\n  colorScheme: PropTypes.string,\n  dateTimeFormat: PropTypes.string,\n  equalDateSize: PropTypes.bool,\n  levels: PropTypes.arrayOf(PropTypes.string),\n  metrics: PropTypes.arrayOf(\n  PropTypes.oneOfType([PropTypes.string, PropTypes.object])),\n\n  numberFormat: PropTypes.string,\n  partitionLimit: PropTypes.number,\n  partitionThreshold: PropTypes.number,\n  timeSeriesOption: PropTypes.string,\n  useLogScale: PropTypes.bool,\n  useRichTooltip: PropTypes.bool };\n\n\nfunction getAncestors(d) {\n  const ancestors = [d];\n  let node = d;\n  while (node.parent) {\n    ancestors.push(node.parent);\n    node = node.parent;\n  }\n\n  return ancestors;\n}\n\n// This vis is based on\n// http://mbostock.github.io/d3/talk/20111018/partition.html\nfunction Icicle(element, props) {var _context;\n  const {\n    width,\n    height,\n    data,\n    colorScheme,\n    dateTimeFormat,\n    equalDateSize,\n    levels,\n    useLogScale = false,\n    metrics = [],\n    numberFormat,\n    partitionLimit,\n    partitionThreshold,\n    useRichTooltip,\n    timeSeriesOption = 'not_time',\n    sliceId } =\n  props;\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-partition', true);\n\n  // Chart options\n  const chartType = timeSeriesOption;\n  const hasTime = _includesInstanceProperty(_context = ['adv_anal', 'time_series']).call(_context, chartType);\n  const format = getNumberFormatter(numberFormat);\n  const timeFormat = getTimeFormatter(dateTimeFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  div.selectAll('*').remove();\n  const tooltip = div.append('div').classed('partition-tooltip', true);\n\n  function hasDateNode(n) {\n    return _includesInstanceProperty(metrics).call(metrics, n.data.name) && hasTime;\n  }\n\n  function getCategory(depth) {\n    if (!depth) {\n      return 'Metric';\n    }\n    if (hasTime && depth === 1) {\n      return 'Date';\n    }\n\n    return levels[depth - (hasTime ? 2 : 1)];\n  }\n\n  function drawVis(i, dat) {\n    const datum = dat[i];\n    const w = width;\n    const h = height / data.length;\n    const x = d3.scale.linear().range([0, w]);\n    const y = d3.scale.linear().range([0, h]);\n\n    const viz = div.\n    append('div').\n    attr('class', 'chart').\n    style('width', `${w}px`).\n    style('height', `${h}px`).\n    append('svg:svg').\n    attr('width', w).\n    attr('height', h);\n\n    // Add padding between multiple visualizations\n    if (i !== data.length - 1 && data.length > 1) {\n      viz.style('padding-bottom', '3px');\n    }\n    if (i !== 0 && data.length > 1) {\n      viz.style('padding-top', '3px');\n    }\n\n    const root = hierarchy(datum);\n\n    // node.name is the metric/group name\n    // node.disp is the display value\n    // node.value determines sorting order\n    // node.weight determines partition height\n    // node.sum is the sum of children weights\n    root.eachAfter((n) => {\n      n.disp = n.data.val;\n      n.value = n.disp < 0 ? -n.disp : n.disp;\n      n.weight = n.value;\n      n.name = n.data.name;\n      // If the parent is a metric and we still have\n      // the time column, perform a date-time format\n      if (n.parent && hasDateNode(n.parent)) {\n        // Format timestamp values\n        n.weight = equalDateSize ? 1 : n.value;\n        n.value = n.name;\n        n.name = timeFormat(n.name);\n      }\n      if (useLogScale) n.weight = Math.log(n.weight + 1);\n      n.disp =\n      n.disp && !Number.isNaN(n.disp) && Number.isFinite(n.disp) ?\n      format(n.disp) :\n      '';\n    });\n    // Perform sort by weight\n    root.sort((a, b) => {\n      const v = b.value - a.value;\n      if (v === 0) {\n        return b.name > a.name ? 1 : -1;\n      }\n\n      return v;\n    });\n\n    // Prune data based on partition limit and threshold\n    // both are applied at the same time\n    if (partitionThreshold && partitionThreshold >= 0) {\n      // Compute weight sums as we go\n      root.each((n) => {\n        n.sum = n.children ?\n        n.children.reduce((a, v) => a + v.weight, 0) || 1 :\n        1;\n        if (n.children) {\n          // Dates are not ordered by weight\n          if (hasDateNode(n)) {\n            if (equalDateSize) {\n              return;\n            }\n            const removeIndices = [];\n            // Keep at least one child\n            for (let j = 1; j < n.children.length; j += 1) {\n              if (n.children[j].weight / n.sum < partitionThreshold) {\n                removeIndices.push(j);\n              }\n            }\n            for (let j = removeIndices.length - 1; j >= 0; j -= 1) {\n              n.children.splice(removeIndices[j], 1);\n            }\n          } else {\n            // Find first child that falls below the threshold\n            let j;\n            for (j = 1; j < n.children.length; j += 1) {\n              if (n.children[j].weight / n.sum < partitionThreshold) {\n                break;\n              }\n            }\n            n.children = n.children.slice(0, j);\n          }\n        }\n      });\n    }\n    if (partitionLimit && partitionLimit >= 0) {\n      root.each((n) => {\n        if (n.children && n.children.length > partitionLimit) {\n          if (!hasDateNode(n)) {\n            n.children = n.children.slice(0, partitionLimit);\n          }\n        }\n      });\n    }\n    // Compute final weight sums\n    root.eachAfter((n) => {\n      n.sum = n.children ?\n      n.children.reduce((a, v) => a + v.weight, 0) || 1 :\n      1;\n    });\n\n    function positionAndPopulate(tip, d) {\n      let t = '<table>';\n      if (useRichTooltip) {\n        const nodes = getAncestors(d);\n        nodes.reverse().forEach((n) => {\n          t += '<tbody>';\n          t +=\n          '<tr>' +\n          '<td>' +\n          '<div ' +\n          `style='border: 2px solid transparent;` +\n          `background-color: ${n.color};'` +\n          '></div>' +\n          '</td>' +\n          `<td>${getCategory(n.depth)}</td>` +\n          `<td>${n.name}</td>` +\n          `<td>${n.disp}</td>` +\n          '</tr>';\n        });\n      } else {\n        t +=\n        '<thead><tr><td colspan=\"3\">' +\n        `<strong>${getCategory(d.depth)}</strong>` +\n        '</td></tr></thead><tbody>';\n        t +=\n        '<tr>' +\n        '<td>' +\n        `<div style='border: thin solid grey; background-color: ${d.color};'` +\n        '></div>' +\n        '</td>' +\n        `<td>${d.name}</td>` +\n        `<td>${d.disp}</td>` +\n        '</tr>';\n      }\n      t += '</tbody></table>';\n      const [tipX, tipY] = d3.mouse(element);\n      tip.\n      html(t).\n      style('left', `${tipX + 15}px`).\n      style('top', `${tipY}px`);\n    }\n\n    const nodes = init(root);\n\n    let zoomX = w / root.dx;\n    let zoomY = h / 1;\n\n    // Keep text centered in its division\n    function transform(d) {\n      return `translate(8,${d.dx * zoomY / 2})`;\n    }\n\n    const g = viz.\n    selectAll('g').\n    data(nodes).\n    enter().\n    append('svg:g').\n    attr('transform', (d) => `translate(${x(d.y)},${y(d.x)})`).\n    on('mouseover', (d) => {\n      tooltip.interrupt().transition().duration(100).style('opacity', 0.9);\n      positionAndPopulate(tooltip, d);\n    }).\n    on('mousemove', (d) => {\n      positionAndPopulate(tooltip, d);\n    }).\n    on('mouseout', () => {\n      tooltip.interrupt().transition().duration(250).style('opacity', 0);\n    });\n\n    // When clicking a subdivision, the vis will zoom in to it\n    function click(d) {\n      if (!d.children) {\n        if (d.parent) {\n          // Clicking on the rightmost level should zoom in\n          return click(d.parent);\n        }\n\n        return false;\n      }\n      zoomX = (d.y ? w - 40 : w) / (1 - d.y);\n      zoomY = h / d.dx;\n      x.domain([d.y, 1]).range([d.y ? 40 : 0, w]);\n      y.domain([d.x, d.x + d.dx]);\n\n      const t = g.\n      transition().\n      duration(d3.event.altKey ? 7500 : 750).\n      attr('transform', (nd) => `translate(${x(nd.y)},${y(nd.x)})`);\n\n      t.select('rect').\n      attr('width', d.dy * zoomX).\n      attr('height', (nd) => nd.dx * zoomY);\n\n      t.select('text').\n      attr('transform', transform).\n      style('opacity', (nd) => nd.dx * zoomY > 12 ? 1 : 0);\n\n      d3.event.stopPropagation();\n\n      return true;\n    }\n\n    g.on('click', click);\n\n    g.append('svg:rect').\n    attr('width', root.dy * zoomX).\n    attr('height', (d) => d.dx * zoomY);\n\n    g.append('svg:text').\n    attr('transform', transform).\n    attr('dy', '0.35em').\n    style('opacity', (d) => d.dx * zoomY > 12 ? 1 : 0).\n    text((d) => {\n      if (!d.disp) {\n        return d.name;\n      }\n\n      return `${d.name}: ${d.disp}`;\n    });\n\n    // Apply color scheme\n    g.selectAll('rect').style('fill', (d) => {\n      d.color = colorFn(d.name, sliceId);\n\n      return d.color;\n    });\n  }\n\n  for (let i = 0; i < data.length; i += 1) {\n    drawVis(i, data);\n  }\n}\n\nIcicle.displayName = 'Icicle';\nIcicle.propTypes = propTypes;\n\nexport default Icicle;","map":{"version":3,"names":["d3","PropTypes","hierarchy","getNumberFormatter","getTimeFormatter","CategoricalColorNamespace","init","root","flat","dy","height","prev","each","n","y","depth","parent","x","dx","weight","sum","push","lazyFunction","f","apply","arguments","leafType","shape","name","string","val","number","isRequired","parentShape","children","arrayOf","oneOfType","nodeType","propTypes","data","width","colorScheme","dateTimeFormat","equalDateSize","bool","levels","metrics","object","numberFormat","partitionLimit","partitionThreshold","timeSeriesOption","useLogScale","useRichTooltip","getAncestors","d","ancestors","node","Icicle","element","props","sliceId","div","select","classed","chartType","hasTime","format","timeFormat","colorFn","getScale","selectAll","remove","tooltip","append","hasDateNode","getCategory","drawVis","i","dat","datum","w","h","length","scale","linear","range","viz","attr","style","eachAfter","disp","value","Math","log","Number","isNaN","isFinite","sort","a","b","v","reduce","removeIndices","j","splice","slice","positionAndPopulate","tip","t","nodes","reverse","forEach","color","tipX","tipY","mouse","html","zoomX","zoomY","transform","g","enter","on","interrupt","transition","duration","click","domain","event","altKey","nd","stopPropagation","text","displayName"],"sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/plugins/legacy-plugin-chart-partition/src/Partition.js"],"sourcesContent":["/* eslint-disable react/sort-prop-types */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-param-reassign: [2, {\"props\": false}] */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { hierarchy } from 'd3-hierarchy';\nimport {\n  getNumberFormatter,\n  getTimeFormatter,\n  CategoricalColorNamespace,\n} from '@superset-ui/core';\n\n// Compute dx, dy, x, y for each node and\n// return an array of nodes in breadth-first order\nfunction init(root) {\n  const flat = [];\n  const dy = 1 / (root.height + 1);\n  let prev = null;\n  root.each(n => {\n    n.y = dy * n.depth;\n    n.dy = dy;\n    if (n.parent) {\n      n.x = prev.depth === n.parent.depth ? 0 : prev.x + prev.dx;\n      n.dx = (n.weight / n.parent.sum) * n.parent.dx;\n    } else {\n      n.x = 0;\n      n.dx = 1;\n    }\n    prev = n;\n    flat.push(n);\n  });\n\n  return flat;\n}\n\n// Declare PropTypes for recursive data structures\n// https://github.com/facebook/react/issues/5676\n/* eslint-disable-next-line  no-undef */\nconst lazyFunction = f => () => f().apply(this, arguments);\nconst leafType = PropTypes.shape({\n  name: PropTypes.string,\n  val: PropTypes.number.isRequired,\n});\nconst parentShape = {\n  name: PropTypes.string,\n  val: PropTypes.number.isRequired,\n  children: PropTypes.arrayOf(\n    PropTypes.oneOfType([\n      PropTypes.shape(lazyFunction(() => parentShape)),\n      leafType,\n    ]),\n  ),\n};\nconst nodeType = PropTypes.oneOfType([PropTypes.shape(parentShape), leafType]);\n\nconst propTypes = {\n  data: PropTypes.arrayOf(nodeType), // array of rootNode\n  width: PropTypes.number,\n  height: PropTypes.number,\n  colorScheme: PropTypes.string,\n  dateTimeFormat: PropTypes.string,\n  equalDateSize: PropTypes.bool,\n  levels: PropTypes.arrayOf(PropTypes.string),\n  metrics: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  ),\n  numberFormat: PropTypes.string,\n  partitionLimit: PropTypes.number,\n  partitionThreshold: PropTypes.number,\n  timeSeriesOption: PropTypes.string,\n  useLogScale: PropTypes.bool,\n  useRichTooltip: PropTypes.bool,\n};\n\nfunction getAncestors(d) {\n  const ancestors = [d];\n  let node = d;\n  while (node.parent) {\n    ancestors.push(node.parent);\n    node = node.parent;\n  }\n\n  return ancestors;\n}\n\n// This vis is based on\n// http://mbostock.github.io/d3/talk/20111018/partition.html\nfunction Icicle(element, props) {\n  const {\n    width,\n    height,\n    data,\n    colorScheme,\n    dateTimeFormat,\n    equalDateSize,\n    levels,\n    useLogScale = false,\n    metrics = [],\n    numberFormat,\n    partitionLimit,\n    partitionThreshold,\n    useRichTooltip,\n    timeSeriesOption = 'not_time',\n    sliceId,\n  } = props;\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-partition', true);\n\n  // Chart options\n  const chartType = timeSeriesOption;\n  const hasTime = ['adv_anal', 'time_series'].includes(chartType);\n  const format = getNumberFormatter(numberFormat);\n  const timeFormat = getTimeFormatter(dateTimeFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  div.selectAll('*').remove();\n  const tooltip = div.append('div').classed('partition-tooltip', true);\n\n  function hasDateNode(n) {\n    return metrics.includes(n.data.name) && hasTime;\n  }\n\n  function getCategory(depth) {\n    if (!depth) {\n      return 'Metric';\n    }\n    if (hasTime && depth === 1) {\n      return 'Date';\n    }\n\n    return levels[depth - (hasTime ? 2 : 1)];\n  }\n\n  function drawVis(i, dat) {\n    const datum = dat[i];\n    const w = width;\n    const h = height / data.length;\n    const x = d3.scale.linear().range([0, w]);\n    const y = d3.scale.linear().range([0, h]);\n\n    const viz = div\n      .append('div')\n      .attr('class', 'chart')\n      .style('width', `${w}px`)\n      .style('height', `${h}px`)\n      .append('svg:svg')\n      .attr('width', w)\n      .attr('height', h);\n\n    // Add padding between multiple visualizations\n    if (i !== data.length - 1 && data.length > 1) {\n      viz.style('padding-bottom', '3px');\n    }\n    if (i !== 0 && data.length > 1) {\n      viz.style('padding-top', '3px');\n    }\n\n    const root = hierarchy(datum);\n\n    // node.name is the metric/group name\n    // node.disp is the display value\n    // node.value determines sorting order\n    // node.weight determines partition height\n    // node.sum is the sum of children weights\n    root.eachAfter(n => {\n      n.disp = n.data.val;\n      n.value = n.disp < 0 ? -n.disp : n.disp;\n      n.weight = n.value;\n      n.name = n.data.name;\n      // If the parent is a metric and we still have\n      // the time column, perform a date-time format\n      if (n.parent && hasDateNode(n.parent)) {\n        // Format timestamp values\n        n.weight = equalDateSize ? 1 : n.value;\n        n.value = n.name;\n        n.name = timeFormat(n.name);\n      }\n      if (useLogScale) n.weight = Math.log(n.weight + 1);\n      n.disp =\n        n.disp && !Number.isNaN(n.disp) && Number.isFinite(n.disp)\n          ? format(n.disp)\n          : '';\n    });\n    // Perform sort by weight\n    root.sort((a, b) => {\n      const v = b.value - a.value;\n      if (v === 0) {\n        return b.name > a.name ? 1 : -1;\n      }\n\n      return v;\n    });\n\n    // Prune data based on partition limit and threshold\n    // both are applied at the same time\n    if (partitionThreshold && partitionThreshold >= 0) {\n      // Compute weight sums as we go\n      root.each(n => {\n        n.sum = n.children\n          ? n.children.reduce((a, v) => a + v.weight, 0) || 1\n          : 1;\n        if (n.children) {\n          // Dates are not ordered by weight\n          if (hasDateNode(n)) {\n            if (equalDateSize) {\n              return;\n            }\n            const removeIndices = [];\n            // Keep at least one child\n            for (let j = 1; j < n.children.length; j += 1) {\n              if (n.children[j].weight / n.sum < partitionThreshold) {\n                removeIndices.push(j);\n              }\n            }\n            for (let j = removeIndices.length - 1; j >= 0; j -= 1) {\n              n.children.splice(removeIndices[j], 1);\n            }\n          } else {\n            // Find first child that falls below the threshold\n            let j;\n            for (j = 1; j < n.children.length; j += 1) {\n              if (n.children[j].weight / n.sum < partitionThreshold) {\n                break;\n              }\n            }\n            n.children = n.children.slice(0, j);\n          }\n        }\n      });\n    }\n    if (partitionLimit && partitionLimit >= 0) {\n      root.each(n => {\n        if (n.children && n.children.length > partitionLimit) {\n          if (!hasDateNode(n)) {\n            n.children = n.children.slice(0, partitionLimit);\n          }\n        }\n      });\n    }\n    // Compute final weight sums\n    root.eachAfter(n => {\n      n.sum = n.children\n        ? n.children.reduce((a, v) => a + v.weight, 0) || 1\n        : 1;\n    });\n\n    function positionAndPopulate(tip, d) {\n      let t = '<table>';\n      if (useRichTooltip) {\n        const nodes = getAncestors(d);\n        nodes.reverse().forEach(n => {\n          t += '<tbody>';\n          t +=\n            '<tr>' +\n            '<td>' +\n            '<div ' +\n            `style='border: 2px solid transparent;` +\n            `background-color: ${n.color};'` +\n            '></div>' +\n            '</td>' +\n            `<td>${getCategory(n.depth)}</td>` +\n            `<td>${n.name}</td>` +\n            `<td>${n.disp}</td>` +\n            '</tr>';\n        });\n      } else {\n        t +=\n          '<thead><tr><td colspan=\"3\">' +\n          `<strong>${getCategory(d.depth)}</strong>` +\n          '</td></tr></thead><tbody>';\n        t +=\n          '<tr>' +\n          '<td>' +\n          `<div style='border: thin solid grey; background-color: ${d.color};'` +\n          '></div>' +\n          '</td>' +\n          `<td>${d.name}</td>` +\n          `<td>${d.disp}</td>` +\n          '</tr>';\n      }\n      t += '</tbody></table>';\n      const [tipX, tipY] = d3.mouse(element);\n      tip\n        .html(t)\n        .style('left', `${tipX + 15}px`)\n        .style('top', `${tipY}px`);\n    }\n\n    const nodes = init(root);\n\n    let zoomX = w / root.dx;\n    let zoomY = h / 1;\n\n    // Keep text centered in its division\n    function transform(d) {\n      return `translate(8,${(d.dx * zoomY) / 2})`;\n    }\n\n    const g = viz\n      .selectAll('g')\n      .data(nodes)\n      .enter()\n      .append('svg:g')\n      .attr('transform', d => `translate(${x(d.y)},${y(d.x)})`)\n      .on('mouseover', d => {\n        tooltip.interrupt().transition().duration(100).style('opacity', 0.9);\n        positionAndPopulate(tooltip, d);\n      })\n      .on('mousemove', d => {\n        positionAndPopulate(tooltip, d);\n      })\n      .on('mouseout', () => {\n        tooltip.interrupt().transition().duration(250).style('opacity', 0);\n      });\n\n    // When clicking a subdivision, the vis will zoom in to it\n    function click(d) {\n      if (!d.children) {\n        if (d.parent) {\n          // Clicking on the rightmost level should zoom in\n          return click(d.parent);\n        }\n\n        return false;\n      }\n      zoomX = (d.y ? w - 40 : w) / (1 - d.y);\n      zoomY = h / d.dx;\n      x.domain([d.y, 1]).range([d.y ? 40 : 0, w]);\n      y.domain([d.x, d.x + d.dx]);\n\n      const t = g\n        .transition()\n        .duration(d3.event.altKey ? 7500 : 750)\n        .attr('transform', nd => `translate(${x(nd.y)},${y(nd.x)})`);\n\n      t.select('rect')\n        .attr('width', d.dy * zoomX)\n        .attr('height', nd => nd.dx * zoomY);\n\n      t.select('text')\n        .attr('transform', transform)\n        .style('opacity', nd => (nd.dx * zoomY > 12 ? 1 : 0));\n\n      d3.event.stopPropagation();\n\n      return true;\n    }\n\n    g.on('click', click);\n\n    g.append('svg:rect')\n      .attr('width', root.dy * zoomX)\n      .attr('height', d => d.dx * zoomY);\n\n    g.append('svg:text')\n      .attr('transform', transform)\n      .attr('dy', '0.35em')\n      .style('opacity', d => (d.dx * zoomY > 12 ? 1 : 0))\n      .text(d => {\n        if (!d.disp) {\n          return d.name;\n        }\n\n        return `${d.name}: ${d.disp}`;\n      });\n\n    // Apply color scheme\n    g.selectAll('rect').style('fill', d => {\n      d.color = colorFn(d.name, sliceId);\n\n      return d.color;\n    });\n  }\n\n  for (let i = 0; i < data.length; i += 1) {\n    drawVis(i, data);\n  }\n}\n\nIcicle.displayName = 'Icicle';\nIcicle.propTypes = propTypes;\n\nexport default Icicle;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}