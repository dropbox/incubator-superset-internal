{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport throttle from 'lodash/throttle';\nimport { POPOVER_INITIAL_HEIGHT, POPOVER_INITIAL_WIDTH } from 'src/explore/constants';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst RESIZE_THROTTLE_MS = 50;\nexport default function useResizeButton(minWidth, minHeight) {\n  const [width, setWidth] = useState(POPOVER_INITIAL_WIDTH);\n  const [height, setHeight] = useState(POPOVER_INITIAL_HEIGHT);\n  const [clientX, setClientX] = useState(0);\n  const [clientY, setClientY] = useState(0);\n  const [dragStartX, setDragStartX] = useState(0);\n  const [dragStartY, setDragStartY] = useState(0);\n  const [dragStartWidth, setDragStartWidth] = useState(width);\n  const [dragStartHeight, setDragStartHeight] = useState(height);\n  const [isDragging, setIsDragging] = useState(false);\n  const onMouseMove = useCallback((ev) => {\n    ev.preventDefault();\n    setClientX(ev.clientX);\n    setClientY(ev.clientY);\n  }, []);\n  const onMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n  const onDragDown = useCallback((ev) => {\n    setDragStartX(ev.clientX);\n    setDragStartY(ev.clientY);\n    setIsDragging(true);\n  }, []);\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', onMouseMove);\n    } else\n    {\n      setDragStartWidth(width);\n      setDragStartHeight(height);\n      document.removeEventListener('mousemove', onMouseMove);\n    }\n  }, [onMouseMove, isDragging]);\n  const handleResize = useCallback(throttle((_ref) => {let { dragStartX, dragStartY, dragStartWidth, dragStartHeight, clientX, clientY, minWidth, minHeight } = _ref;\n    setWidth(Math.max(dragStartWidth + (clientX - dragStartX), minWidth));\n    setHeight(Math.max(dragStartHeight + (clientY - dragStartY), minHeight));\n  }, RESIZE_THROTTLE_MS), [setHeight, setWidth]);\n  useEffect(() => {\n    if (isDragging) {\n      handleResize({\n        dragStartX,\n        dragStartY,\n        dragStartWidth,\n        dragStartHeight,\n        clientX,\n        clientY,\n        minWidth,\n        minHeight });\n\n    }\n  }, [\n  isDragging,\n  clientX,\n  clientY,\n  dragStartWidth,\n  dragStartHeight,\n  dragStartX,\n  dragStartY]);\n\n  useEffect(() => {\n    document.addEventListener('mouseup', onMouseUp);\n    return () => document.removeEventListener('mouseup', onMouseUp);\n  }, [onMouseUp]);\n  return [\n  ___EmotionJSX(\"i\", { role: \"button\", \"aria-label\": \"Resize\", tabIndex: 0, onMouseDown: onDragDown, className: \"fa fa-expand edit-popover-resize text-muted\" }),\n  width,\n  height];\n\n}","map":{"version":3,"mappings":"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","names":["React","useCallback","useEffect","useState","throttle","POPOVER_INITIAL_HEIGHT","POPOVER_INITIAL_WIDTH","RESIZE_THROTTLE_MS","useResizeButton","minWidth","minHeight","width","setWidth","height","setHeight","clientX","setClientX","clientY","setClientY","dragStartX","setDragStartX","dragStartY","setDragStartY","dragStartWidth","setDragStartWidth","dragStartHeight","setDragStartHeight","isDragging","setIsDragging","onMouseMove","ev","preventDefault","onMouseUp","onDragDown","document","addEventListener","removeEventListener","handleResize","Math","max"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/src/explore/components/controls/DndColumnSelectControl/useResizeButton.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport throttle from 'lodash/throttle';\nimport {\n  POPOVER_INITIAL_HEIGHT,\n  POPOVER_INITIAL_WIDTH,\n} from 'src/explore/constants';\n\nconst RESIZE_THROTTLE_MS = 50;\n\nexport default function useResizeButton(\n  minWidth: number,\n  minHeight: number,\n): [JSX.Element, number, number] {\n  const [width, setWidth] = useState(POPOVER_INITIAL_WIDTH);\n  const [height, setHeight] = useState(POPOVER_INITIAL_HEIGHT);\n  const [clientX, setClientX] = useState(0);\n  const [clientY, setClientY] = useState(0);\n  const [dragStartX, setDragStartX] = useState(0);\n  const [dragStartY, setDragStartY] = useState(0);\n  const [dragStartWidth, setDragStartWidth] = useState(width);\n  const [dragStartHeight, setDragStartHeight] = useState(height);\n  const [isDragging, setIsDragging] = useState(false);\n\n  const onMouseMove = useCallback((ev: MouseEvent): void => {\n    ev.preventDefault();\n    setClientX(ev.clientX);\n    setClientY(ev.clientY);\n  }, []);\n\n  const onMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  const onDragDown = useCallback((ev: React.MouseEvent): void => {\n    setDragStartX(ev.clientX);\n    setDragStartY(ev.clientY);\n    setIsDragging(true);\n  }, []);\n\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', onMouseMove);\n    } else {\n      setDragStartWidth(width);\n      setDragStartHeight(height);\n      document.removeEventListener('mousemove', onMouseMove);\n    }\n  }, [onMouseMove, isDragging]);\n\n  const handleResize = useCallback(\n    throttle(\n      ({\n        dragStartX,\n        dragStartY,\n        dragStartWidth,\n        dragStartHeight,\n        clientX,\n        clientY,\n        minWidth,\n        minHeight,\n      }: {\n        dragStartX: number;\n        dragStartY: number;\n        dragStartWidth: number;\n        dragStartHeight: number;\n        clientX: number;\n        clientY: number;\n        minWidth: number;\n        minHeight: number;\n      }): void => {\n        setWidth(Math.max(dragStartWidth + (clientX - dragStartX), minWidth));\n        setHeight(\n          Math.max(dragStartHeight + (clientY - dragStartY), minHeight),\n        );\n      },\n      RESIZE_THROTTLE_MS,\n    ),\n    [setHeight, setWidth],\n  );\n\n  useEffect(() => {\n    if (isDragging) {\n      handleResize({\n        dragStartX,\n        dragStartY,\n        dragStartWidth,\n        dragStartHeight,\n        clientX,\n        clientY,\n        minWidth,\n        minHeight,\n      });\n    }\n  }, [\n    isDragging,\n    clientX,\n    clientY,\n    dragStartWidth,\n    dragStartHeight,\n    dragStartX,\n    dragStartY,\n  ]);\n\n  useEffect(() => {\n    document.addEventListener('mouseup', onMouseUp);\n    return () => document.removeEventListener('mouseup', onMouseUp);\n  }, [onMouseUp]);\n\n  return [\n    <i\n      role=\"button\"\n      aria-label=\"Resize\"\n      tabIndex={0}\n      onMouseDown={onDragDown}\n      className=\"fa fa-expand edit-popover-resize text-muted\"\n    />,\n    width,\n    height,\n  ];\n}\n"]},"metadata":{},"sourceType":"module"}