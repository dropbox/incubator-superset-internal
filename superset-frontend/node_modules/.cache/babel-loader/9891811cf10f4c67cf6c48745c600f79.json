{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-underscore-dangle */\nexport default function extractTimegrain(formData) {\n  const { time_grain_sqla, extra_filters, extra_form_data } = formData;\n  if (extra_form_data != null && extra_form_data.time_grain_sqla) {\n    return extra_form_data.time_grain_sqla;\n  }\n  const extra_grain = (extra_filters || []).filter((filter) => filter.col === '__time_grain');\n  if (extra_grain.length) {\n    return extra_grain[0].val;\n  }\n  return time_grain_sqla;\n}","map":{"version":3,"mappings":"AAAA;;;;;;;;;;;;;;;;;;AAkBA;AAKA,eAAc,SAAUA,gBAAV,CACZC,QADY,EACW;EAEvB,MAAM,EAAEC,eAAF,EAAmBC,aAAnB,EAAkCC,eAAlC,KAAsDH,QAA5D;EACA,IAAIG,eAAJ,YAAIA,eAAe,CAAEF,eAArB,EAAsC;IACpC,OAAOE,eAAe,CAACF,eAAvB;EACD;EACD,MAAMG,WAAW,GAAG,CAACF,aAAa,IAAI,EAAlB,EAAsBG,MAAtB,CAClB,OAAM,KAAIA,MAAM,CAACC,GAAP,KAAe,cADP,CAApB;EAGA,IAAIF,WAAW,CAACG,MAAhB,EAAwB;IACtB,OAAOH,WAAW,CAAC,CAAD,CAAX,CAAeI,GAAtB;EACD;EACD,OAAOP,eAAP;AACD","names":["extractTimegrain","formData","time_grain_sqla","extra_filters","extra_form_data","extra_grain","filter","col","length","val"],"sourceRoot":"","sources":["/Users/zhaorui/src/incubator-superset-internal/superset-frontend/packages/superset-ui-core/src/query/extractTimegrain.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-underscore-dangle */\n\nimport { QueryFormData } from '@superset-ui/core';\nimport { TimeGranularity } from '../time-format';\n\nexport default function extractTimegrain(\n  formData: QueryFormData,\n): TimeGranularity | undefined {\n  const { time_grain_sqla, extra_filters, extra_form_data } = formData;\n  if (extra_form_data?.time_grain_sqla) {\n    return extra_form_data.time_grain_sqla;\n  }\n  const extra_grain = (extra_filters || []).filter(\n    filter => filter.col === '__time_grain',\n  );\n  if (extra_grain.length) {\n    return extra_grain[0].val as TimeGranularity;\n  }\n  return time_grain_sqla;\n}\n"]},"metadata":{},"sourceType":"module"}