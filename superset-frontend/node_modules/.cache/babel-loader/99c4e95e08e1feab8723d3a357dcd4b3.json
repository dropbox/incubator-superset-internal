{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { css, isDefined, styled, t, useTheme } from '@superset-ui/core';\nimport { Select } from 'src/components';\nimport { noOp } from 'src/utils/common';\nimport ScopingTree from 'src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/ScopingTree';\nimport { isCrossFilterScopeGlobal } from 'src/dashboard/types';\nimport { CHART_TYPE } from 'src/dashboard/util/componentTypes';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\nimport Alert from 'src/components/Alert';\nimport { NEW_CHART_SCOPING_ID } from './constants';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst InfoText = styled.div`\n  ${(_ref) => {let { theme } = _ref;return css`\n    font-size: ${theme.typography.sizes.s}px;\n    color: ${theme.colors.grayscale.base};\n    margin-bottom: ${theme.gridUnit * 7}px;\n  `;}}\n`;\nconst ChartSelect = (_ref2) => {let { value, onSelectChange, chartConfigs } = _ref2;\n  const theme = useTheme();\n  const layout = useSelector((state) => state.dashboardLayout.present);\n  const options = useMemo(() => {\n    const chartLayoutItems = Object.values(layout).filter((item) => item.type === CHART_TYPE);\n    return Object.values(chartConfigs).\n    filter((chartConfig) => isCrossFilterScopeGlobal(chartConfig.crossFilters.scope) ||\n    chartConfig.id === value && value !== NEW_CHART_SCOPING_ID).\n    map((chartConfig) => {\n      const chartLayoutItem = chartLayoutItems.find((item) => item.meta.chartId === Number(chartConfig.id));\n      return {\n        value: Number(chartConfig.id),\n        label: (chartLayoutItem == null ? void 0 : chartLayoutItem.meta.sliceNameOverride) || (\n        chartLayoutItem == null ? void 0 : chartLayoutItem.meta.sliceName) ||\n        '' };\n\n    });\n  }, [chartConfigs, layout, value]);\n  return ___EmotionJSX(\"div\", { css: css`\n        margin-bottom: ${theme.gridUnit * 6}px;\n      ` },\n  ___EmotionJSX(\"div\", { css: css`\n          display: flex;\n          align-items: center;\n          margin-bottom: ${theme.gridUnit}px;\n        ` },\n  ___EmotionJSX(InfoText, { css: css`\n            color: ${theme.colors.grayscale.dark1};\n            margin-right: ${theme.gridUnit}px;\n            margin-bottom: 0;\n          ` }, `${t('Chart')} *`),\n  ___EmotionJSX(Tooltip, { title: t('Tooltip'), placement: \"top\" },\n  ___EmotionJSX(Icons.InfoCircleOutlined, { iconSize: \"xs\", iconColor: theme.colors.grayscale.base, css: css`\n              & > span {\n                line-height: 0;\n              }\n            ` }))),\n\n\n  ___EmotionJSX(Select, { \"data-test\": \"select-chart\", ariaLabel: t('Select chart'), options: options, value: value && value === NEW_CHART_SCOPING_ID ? undefined : value, onChange: (value) => {\n      onSelectChange(Number(value));\n    } }));\n\n};__signature__(ChartSelect, \"useTheme{theme}\\nuseSelector{layout}\\nuseMemo{options}\", () => [useTheme, useSelector]);\nexport const ScopingTreePanel = (_ref3) => {let { onScopeUpdate, currentScope, chartId, onSelectChange, chartConfigs } = _ref3;\n  const theme = useTheme();\n  const isCrossFiltersEnabled = useSelector((_ref4) => {let { dashboardInfo } = _ref4;return dashboardInfo.crossFiltersEnabled;});\n  return ___EmotionJSX(\"div\", { \"data-test\": \"scoping-tree-panel\", css: css`\n        flex: 1;\n      ` },\n  !isCrossFiltersEnabled && ___EmotionJSX(Alert, { message: ___EmotionJSX(\"span\", { css: css`\n                font-weight: ${theme.typography.weights.bold};\n              ` },\n    t('Cross-filtering is not enabled in this dashboard')),\n    type: \"info\", closable: false, css: css`\n            margin-bottom: ${theme.gridUnit * 6}px;\n          ` }),\n  isDefined(chartId) && ___EmotionJSX(ChartSelect, { value: chartId, onSelectChange: onSelectChange, chartConfigs: chartConfigs }),\n  ___EmotionJSX(InfoText, null,\n  isDefined(chartId) ?\n  t(`Select the charts to which you want to apply cross-filters when interacting with this chart. You can select \"All charts\" to apply filters to all charts that use the same dataset or contain the same column name in the dashboard.`) :\n  t(`Select the charts to which you want to apply cross-filters in this dashboard. Deselecting a chart will exclude it from being filtered when applying cross-filters from any chart on the dashboard. You can select \"All charts\" to apply cross-filters to all charts that use the same dataset or contain the same column name in the dashboard.`)),\n\n  ___EmotionJSX(ScopingTree, { updateFormValues: onScopeUpdate, initialScope: currentScope, forceUpdate: noOp, chartId: chartId, title: t('All charts') }));\n\n};__signature__(ScopingTreePanel, \"useTheme{theme}\\nuseSelector{isCrossFiltersEnabled}\", () => [useTheme, useSelector]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(InfoText, \"InfoText\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingTreePanel.tsx\");reactHotLoader.register(ChartSelect, \"ChartSelect\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingTreePanel.tsx\");reactHotLoader.register(ScopingTreePanel, \"ScopingTreePanel\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingTreePanel.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"mappings":"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","names":["React","useMemo","useSelector","css","isDefined","styled","t","useTheme","Select","noOp","ScopingTree","isCrossFilterScopeGlobal","CHART_TYPE","Icons","Tooltip","Alert","NEW_CHART_SCOPING_ID","InfoText","div","theme","typography","sizes","s","colors","grayscale","base","gridUnit","ChartSelect","value","onSelectChange","chartConfigs","layout","state","dashboardLayout","present","options","chartLayoutItems","Object","values","filter","item","type","chartConfig","crossFilters","scope","id","map","chartLayoutItem","find","meta","chartId","Number","label","sliceNameOverride","sliceName","dark1","undefined","ScopingTreePanel","onScopeUpdate","currentScope","isCrossFiltersEnabled","dashboardInfo","crossFiltersEnabled","weights","bold"],"sourceRoot":"","sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingTreePanel.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  css,\n  isDefined,\n  NativeFilterScope,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { Select } from 'src/components';\nimport { noOp } from 'src/utils/common';\nimport ScopingTree from 'src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/ScopingTree';\nimport {\n  ChartConfiguration,\n  DashboardLayout,\n  isCrossFilterScopeGlobal,\n  RootState,\n} from 'src/dashboard/types';\nimport { CHART_TYPE } from 'src/dashboard/util/componentTypes';\nimport { SelectOptionsType } from 'src/components/Select/types';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\nimport Alert from 'src/components/Alert';\nimport { NEW_CHART_SCOPING_ID } from './constants';\n\ninterface ScopingTreePanelProps {\n  chartId: number | undefined;\n  currentScope: NativeFilterScope;\n  onScopeUpdate: ({ scope }: { scope: NativeFilterScope }) => void;\n  onSelectChange: (chartId: number) => void;\n  chartConfigs: ChartConfiguration;\n}\n\nconst InfoText = styled.div`\n  ${({ theme }) => css`\n    font-size: ${theme.typography.sizes.s}px;\n    color: ${theme.colors.grayscale.base};\n    margin-bottom: ${theme.gridUnit * 7}px;\n  `}\n`;\n\nconst ChartSelect = ({\n  value,\n  onSelectChange,\n  chartConfigs,\n}: {\n  value: number | undefined;\n  onSelectChange: (chartId: number) => void;\n  chartConfigs: ChartConfiguration;\n}) => {\n  const theme = useTheme();\n  const layout = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const options: SelectOptionsType = useMemo(() => {\n    const chartLayoutItems = Object.values(layout).filter(\n      item => item.type === CHART_TYPE,\n    );\n    return Object.values(chartConfigs)\n      .filter(\n        chartConfig =>\n          isCrossFilterScopeGlobal(chartConfig.crossFilters.scope) ||\n          (chartConfig.id === value && value !== NEW_CHART_SCOPING_ID),\n      )\n      .map(chartConfig => {\n        const chartLayoutItem = chartLayoutItems.find(\n          item => item.meta.chartId === Number(chartConfig.id),\n        );\n        return {\n          value: Number(chartConfig.id),\n          label:\n            chartLayoutItem?.meta.sliceNameOverride ||\n            chartLayoutItem?.meta.sliceName ||\n            '',\n        };\n      });\n  }, [chartConfigs, layout, value]);\n\n  return (\n    <div\n      css={css`\n        margin-bottom: ${theme.gridUnit * 6}px;\n      `}\n    >\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n          margin-bottom: ${theme.gridUnit}px;\n        `}\n      >\n        <InfoText\n          css={css`\n            color: ${theme.colors.grayscale.dark1};\n            margin-right: ${theme.gridUnit}px;\n            margin-bottom: 0;\n          `}\n        >{`${t('Chart')} *`}</InfoText>\n        <Tooltip title={t('Tooltip')} placement=\"top\">\n          <Icons.InfoCircleOutlined\n            iconSize=\"xs\"\n            iconColor={theme.colors.grayscale.base}\n            css={css`\n              & > span {\n                line-height: 0;\n              }\n            `}\n          />\n        </Tooltip>\n      </div>\n      <Select\n        data-test=\"select-chart\"\n        ariaLabel={t('Select chart')}\n        options={options}\n        value={value && value === NEW_CHART_SCOPING_ID ? undefined : value}\n        onChange={value => {\n          onSelectChange(Number(value));\n        }}\n      />\n    </div>\n  );\n};\n\nexport const ScopingTreePanel = ({\n  onScopeUpdate,\n  currentScope,\n  chartId,\n  onSelectChange,\n  chartConfigs,\n}: ScopingTreePanelProps) => {\n  const theme = useTheme();\n  const isCrossFiltersEnabled = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.crossFiltersEnabled,\n  );\n  return (\n    <div\n      data-test=\"scoping-tree-panel\"\n      css={css`\n        flex: 1;\n      `}\n    >\n      {!isCrossFiltersEnabled && (\n        <Alert\n          message={\n            <span\n              css={css`\n                font-weight: ${theme.typography.weights.bold};\n              `}\n            >\n              {t('Cross-filtering is not enabled in this dashboard')}\n            </span>\n          }\n          type=\"info\"\n          closable={false}\n          css={css`\n            margin-bottom: ${theme.gridUnit * 6}px;\n          `}\n        />\n      )}\n      {isDefined(chartId) && (\n        <ChartSelect\n          value={chartId}\n          onSelectChange={onSelectChange}\n          chartConfigs={chartConfigs}\n        />\n      )}\n      <InfoText>\n        {isDefined(chartId)\n          ? t(\n              `Select the charts to which you want to apply cross-filters when interacting with this chart. You can select \"All charts\" to apply filters to all charts that use the same dataset or contain the same column name in the dashboard.`,\n            )\n          : t(\n              `Select the charts to which you want to apply cross-filters in this dashboard. Deselecting a chart will exclude it from being filtered when applying cross-filters from any chart on the dashboard. You can select \"All charts\" to apply cross-filters to all charts that use the same dataset or contain the same column name in the dashboard.`,\n            )}\n      </InfoText>\n      <ScopingTree\n        updateFormValues={onScopeUpdate}\n        initialScope={currentScope}\n        forceUpdate={noOp}\n        chartId={chartId}\n        title={t('All charts')}\n      />\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}