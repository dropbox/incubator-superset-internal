{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${(_ref) => {let { theme } = _ref;return theme.gridUnit;}}px;\n  }\n`;\n\nconst EmbedCodeContent = (_ref2) => {let { formData, addDangerToast } = _ref2;\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback((e) => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData).\n    then((url) => {\n      setUrl(url);\n      setErrorMessage('');\n    }).\n    catch(() => {\n      setErrorMessage(t('Error'));\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>');\n\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    ___EmotionJSX(\"div\", { id: \"embed-code-popover\", \"data-test\": \"embed-code-popover\" },\n    ___EmotionJSX(\"div\", {\n      css: css`\n          display: flex;\n          flex-direction: column;\n        ` },\n\n    ___EmotionJSX(CopyToClipboard, {\n      shouldShowText: false,\n      text: html,\n      copyNode:\n      ___EmotionJSX(CopyButtonEmbedCode, { buttonSize: \"xsmall\" },\n      ___EmotionJSX(\"i\", { className: \"fa fa-clipboard\" })) }),\n\n\n\n    ___EmotionJSX(TextArea, {\n      \"data-test\": \"embed-code-textarea\",\n      name: \"embedCode\",\n      disabled: !html,\n      value: text,\n      rows: \"4\",\n      readOnly: true,\n      css: (theme) => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          ` })),\n\n\n    ___EmotionJSX(\"div\", {\n      css: (theme) => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        ` },\n\n    ___EmotionJSX(\"div\", null,\n    ___EmotionJSX(\"label\", { htmlFor: \"embed-height\" }, t('Chart height')),\n    ___EmotionJSX(Input, {\n      type: \"text\",\n      defaultValue: height,\n      name: \"height\",\n      onChange: handleInputChange })),\n\n\n    ___EmotionJSX(\"div\", null,\n    ___EmotionJSX(\"label\", { htmlFor: \"embed-width\" }, t('Chart width')),\n    ___EmotionJSX(Input, {\n      type: \"text\",\n      defaultValue: width,\n      name: \"width\",\n      onChange: handleInputChange,\n      id: \"embed-width\" })))));\n\n\n\n\n\n};__signature__(EmbedCodeContent, \"useState{[height, setHeight]('400')}\\nuseState{[width, setWidth]('600')}\\nuseState{[url, setUrl]('')}\\nuseState{[errorMessage, setErrorMessage]('')}\\nuseCallback{handleInputChange}\\nuseCallback{updateUrl}\\nuseEffect{}\\nuseMemo{html}\");const _default =\n\nEmbedCodeContent;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(CopyButtonEmbedCode, \"CopyButtonEmbedCode\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");reactHotLoader.register(EmbedCodeContent, \"EmbedCodeContent\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");reactHotLoader.register(_default, \"default\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","css","styled","t","Input","TextArea","CopyToClipboard","URL_PARAMS","getChartPermalink","CopyButton","CopyButtonEmbedCode","theme","gridUnit","EmbedCodeContent","formData","addDangerToast","height","setHeight","width","setWidth","url","setUrl","errorMessage","setErrorMessage","handleInputChange","e","value","name","currentTarget","updateUrl","then","catch","html","srcLink","standalone","text","typography","sizes","s","colors","secondary","light5"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/explore/components/EmbedCodeContent.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback(e => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData)\n      .then(url => {\n        setUrl(url);\n        setErrorMessage('');\n      })\n      .catch(() => {\n        setErrorMessage(t('Error'));\n        addDangerToast(t('Sorry, something went wrong. Try again later.'));\n      });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>'\n    );\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    <div id=\"embed-code-popover\" data-test=\"embed-code-popover\">\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n        `}\n      >\n        <CopyToClipboard\n          shouldShowText={false}\n          text={html}\n          copyNode={\n            <CopyButtonEmbedCode buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonEmbedCode>\n          }\n        />\n        <TextArea\n          data-test=\"embed-code-textarea\"\n          name=\"embedCode\"\n          disabled={!html}\n          value={text}\n          rows=\"4\"\n          readOnly\n          css={theme => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          `}\n        />\n      </div>\n      <div\n        css={theme => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `}\n      >\n        <div>\n          <label htmlFor=\"embed-height\">{t('Chart height')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={height}\n            name=\"height\"\n            onChange={handleInputChange}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"embed-width\">{t('Chart width')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={width}\n            name=\"width\"\n            onChange={handleInputChange}\n            id=\"embed-width\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmbedCodeContent;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}