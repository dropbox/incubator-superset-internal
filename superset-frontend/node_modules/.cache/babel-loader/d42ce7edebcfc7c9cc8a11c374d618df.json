{"ast":null,"code":"import { css as _css } from \"@emotion/react\";import _isEmpty from \"lodash/isEmpty\";var _bootstrapData$common, _bootstrapData$common2, _bootstrapData$common3, _bootstrapData$common4;(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable jsx-a11y/anchor-is-valid */\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, {\nuseState,\nuseEffect,\nuseMemo,\nuseRef,\nuseCallback } from\n'react';\nimport useEffectEvent from 'src/hooks/useEffectEvent';\nimport { CSSTransition } from 'react-transition-group';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport Split from 'react-split';\nimport { css, FeatureFlag, styled, t, useTheme } from '@superset-ui/core';\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\nimport Modal from 'src/components/Modal';\nimport Mousetrap from 'mousetrap';\nimport Button from 'src/components/Button';\nimport Timer from 'src/components/Timer';\nimport ResizableSidebar from 'src/components/ResizableSidebar';\nimport { AntdDropdown, AntdSwitch } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport { Menu } from 'src/components/Menu';\nimport Icons from 'src/components/Icons';\nimport { detectOS } from 'src/utils/common';\nimport {\naddNewQueryEditor,\nCtasEnum,\nestimateQueryCost,\npersistEditorHeight,\npostStopQuery,\nqueryEditorSetAutorun,\nqueryEditorSetSql,\nqueryEditorSetAndSaveSql,\nqueryEditorSetTemplateParams,\nrunQueryFromSqlEditor,\nsaveQuery,\naddSavedQueryToTabState,\nscheduleQuery,\nsetActiveSouthPaneTab,\nupdateSavedQuery,\nvalidateQuery } from\n'src/SqlLab/actions/sqlLab';\nimport {\nSTATE_TYPE_MAP,\nSQL_EDITOR_GUTTER_HEIGHT,\nSQL_EDITOR_GUTTER_MARGIN,\nSQL_TOOLBAR_HEIGHT,\nSQL_EDITOR_LEFTBAR_WIDTH,\nSQL_EDITOR_PADDING,\nINITIAL_NORTH_PERCENT,\nINITIAL_SOUTH_PERCENT,\nSET_QUERY_EDITOR_SQL_DEBOUNCE_MS,\nVALIDATION_DEBOUNCE_MS,\nWINDOW_RESIZE_THROTTLE_MS } from\n'src/SqlLab/constants';\nimport {\ngetItem,\nLocalStorageKeys,\nsetItem } from\n'src/utils/localStorageHelpers';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport getBootstrapData from 'src/utils/getBootstrapData';\n\nimport TemplateParamsEditor from '../TemplateParamsEditor';\nimport SouthPane from '../SouthPane';\nimport SaveQuery from '../SaveQuery';\nimport ScheduleQueryButton from '../ScheduleQueryButton';\nimport EstimateQueryCostButton from '../EstimateQueryCostButton';\nimport ShareSqlLabQuery from '../ShareSqlLabQuery';\nimport SqlEditorLeftBar from '../SqlEditorLeftBar';\nimport AceEditorWrapper from '../AceEditorWrapper';\nimport RunQueryActionButton from '../RunQueryActionButton';\nimport QueryLimitSelect from '../QueryLimitSelect';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nconst bootstrapData = getBootstrapData();\nconst validatorMap =\n(bootstrapData == null ? void 0 : (_bootstrapData$common = bootstrapData.common) == null ? void 0 : (_bootstrapData$common2 = _bootstrapData$common.conf) == null ? void 0 : _bootstrapData$common2.SQL_VALIDATORS_BY_ENGINE) || {};\nconst scheduledQueriesConf = bootstrapData == null ? void 0 : (_bootstrapData$common3 = bootstrapData.common) == null ? void 0 : (_bootstrapData$common4 = _bootstrapData$common3.conf) == null ? void 0 : _bootstrapData$common4.SCHEDULED_QUERIES;\n\nconst StyledToolbar = styled.div`\n  padding: ${(_ref) => {let { theme } = _ref;return theme.gridUnit * 2;}}px;\n  background: ${(_ref2) => {let { theme } = _ref2;return theme.colors.grayscale.light5;}};\n  display: flex;\n  justify-content: space-between;\n  border: 1px solid ${(_ref3) => {let { theme } = _ref3;return theme.colors.grayscale.light2;}};\n  border-top: 0;\n\n  form {\n    margin-block-end: 0;\n  }\n\n  .leftItems,\n  .rightItems {\n    display: flex;\n    align-items: center;\n    & > span {\n      margin-right: ${(_ref4) => {let { theme } = _ref4;return theme.gridUnit * 2;}}px;\n      display: inline-block;\n\n      &:last-child {\n        margin-right: 0;\n      }\n    }\n  }\n\n  .limitDropdown {\n    white-space: nowrap;\n  }\n`;\n\nconst StyledSidebar = styled.div`\n  flex: 0 0 ${(_ref5) => {let { width } = _ref5;return width;}}px;\n  width: ${(_ref6) => {let { width } = _ref6;return width;}}px;\n  padding: ${(_ref7) => {let { theme, hide } = _ref7;return hide ? 0 : theme.gridUnit * 2.5;}}px;\n  border-right: 1px solid\n    ${(_ref8) => {let { theme, hide } = _ref8;return (\n    hide ? 'transparent' : theme.colors.grayscale.light2);}};\n`;\n\nconst StyledSqlEditor = styled.div`\n  ${(_ref9) => {let { theme } = _ref9;return css`\n    display: flex;\n    flex-direction: row;\n    height: 100%;\n\n    .schemaPane {\n      transition: transform ${theme.transitionTiming}s ease-in-out;\n    }\n\n    .queryPane {\n      flex: 1 1 auto;\n      padding: ${theme.gridUnit * 2}px;\n      overflow-y: auto;\n      overflow-x: scroll;\n    }\n\n    .schemaPane-enter-done,\n    .schemaPane-exit {\n      transform: translateX(0);\n      z-index: 7;\n    }\n\n    .schemaPane-exit-active {\n      transform: translateX(-120%);\n    }\n\n    .schemaPane-enter-active {\n      transform: translateX(0);\n      max-width: ${theme.gridUnit * 75}px;\n    }\n\n    .schemaPane-enter,\n    .schemaPane-exit-done {\n      max-width: 0;\n      transform: translateX(-120%);\n      overflow: hidden;\n    }\n\n    .schemaPane-exit-done + .queryPane {\n      margin-left: 0;\n    }\n\n    .gutter {\n      border-top: 1px solid ${theme.colors.grayscale.light2};\n      border-bottom: 1px solid ${theme.colors.grayscale.light2};\n      width: 3%;\n      margin: ${SQL_EDITOR_GUTTER_MARGIN}px 47%;\n    }\n\n    .gutter.gutter-vertical {\n      cursor: row-resize;\n    }\n  `;}}\n`;\n\nconst propTypes = {\n  tables: PropTypes.array.isRequired,\n  queryEditor: PropTypes.object.isRequired,\n  defaultQueryLimit: PropTypes.number.isRequired,\n  maxRow: PropTypes.number.isRequired,\n  displayLimit: PropTypes.number.isRequired,\n  saveQueryWarning: PropTypes.string,\n  scheduleQueryWarning: PropTypes.string };var _ref13 = process.env.NODE_ENV === \"production\" ? { name: \"1eoy87d\", styles: \"display:flex;justify-content:space-between\" } : { name: \"1egglng-renderDropdown\", styles: \"display:flex;justify-content:space-between;label:renderDropdown;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9ib2dkYW5reXJ5bGl1ay9jb2RlL29wZW5zb3VyY2Uvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL1NxbExhYi9jb21wb25lbnRzL1NxbEVkaXRvci9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBeWdCbUIiLCJmaWxlIjoiL1VzZXJzL2JvZ2Rhbmt5cnlsaXVrL2NvZGUvb3BlbnNvdXJjZS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvU3FsTGFiL2NvbXBvbmVudHMvU3FsRWRpdG9yL2luZGV4LmpzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qIGVzbGludC1kaXNhYmxlIGpzeC1hMTF5L2FuY2hvci1pcy12YWxpZCAqL1xuLyogZXNsaW50LWRpc2FibGUganN4LWExMXkvbm8tc3RhdGljLWVsZW1lbnQtaW50ZXJhY3Rpb25zICovXG5pbXBvcnQgUmVhY3QsIHtcbiAgdXNlU3RhdGUsXG4gIHVzZUVmZmVjdCxcbiAgdXNlTWVtbyxcbiAgdXNlUmVmLFxuICB1c2VDYWxsYmFjayxcbn0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHVzZUVmZmVjdEV2ZW50IGZyb20gJ3NyYy9ob29rcy91c2VFZmZlY3RFdmVudCc7XG5pbXBvcnQgeyBDU1NUcmFuc2l0aW9uIH0gZnJvbSAncmVhY3QtdHJhbnNpdGlvbi1ncm91cCc7XG5pbXBvcnQgeyBzaGFsbG93RXF1YWwsIHVzZURpc3BhdGNoLCB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgU3BsaXQgZnJvbSAncmVhY3Qtc3BsaXQnO1xuaW1wb3J0IHsgY3NzLCBGZWF0dXJlRmxhZywgc3R5bGVkLCB0LCB1c2VUaGVtZSB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnO1xuaW1wb3J0IHRocm90dGxlIGZyb20gJ2xvZGFzaC90aHJvdHRsZSc7XG5pbXBvcnQgTW9kYWwgZnJvbSAnc3JjL2NvbXBvbmVudHMvTW9kYWwnO1xuaW1wb3J0IE1vdXNldHJhcCBmcm9tICdtb3VzZXRyYXAnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFRpbWVyIGZyb20gJ3NyYy9jb21wb25lbnRzL1RpbWVyJztcbmltcG9ydCBSZXNpemFibGVTaWRlYmFyIGZyb20gJ3NyYy9jb21wb25lbnRzL1Jlc2l6YWJsZVNpZGViYXInO1xuaW1wb3J0IHsgQW50ZERyb3Bkb3duLCBBbnRkU3dpdGNoIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdzcmMvY29tcG9uZW50cy9JbnB1dCc7XG5pbXBvcnQgeyBNZW51IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVudSc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IHsgZGV0ZWN0T1MgfSBmcm9tICdzcmMvdXRpbHMvY29tbW9uJztcbmltcG9ydCB7XG4gIGFkZE5ld1F1ZXJ5RWRpdG9yLFxuICBDdGFzRW51bSxcbiAgZXN0aW1hdGVRdWVyeUNvc3QsXG4gIHBlcnNpc3RFZGl0b3JIZWlnaHQsXG4gIHBvc3RTdG9wUXVlcnksXG4gIHF1ZXJ5RWRpdG9yU2V0QXV0b3J1bixcbiAgcXVlcnlFZGl0b3JTZXRTcWwsXG4gIHF1ZXJ5RWRpdG9yU2V0QW5kU2F2ZVNxbCxcbiAgcXVlcnlFZGl0b3JTZXRUZW1wbGF0ZVBhcmFtcyxcbiAgcnVuUXVlcnlGcm9tU3FsRWRpdG9yLFxuICBzYXZlUXVlcnksXG4gIGFkZFNhdmVkUXVlcnlUb1RhYlN0YXRlLFxuICBzY2hlZHVsZVF1ZXJ5LFxuICBzZXRBY3RpdmVTb3V0aFBhbmVUYWIsXG4gIHVwZGF0ZVNhdmVkUXVlcnksXG4gIHZhbGlkYXRlUXVlcnksXG59IGZyb20gJ3NyYy9TcWxMYWIvYWN0aW9ucy9zcWxMYWInO1xuaW1wb3J0IHtcbiAgU1RBVEVfVFlQRV9NQVAsXG4gIFNRTF9FRElUT1JfR1VUVEVSX0hFSUdIVCxcbiAgU1FMX0VESVRPUl9HVVRURVJfTUFSR0lOLFxuICBTUUxfVE9PTEJBUl9IRUlHSFQsXG4gIFNRTF9FRElUT1JfTEVGVEJBUl9XSURUSCxcbiAgU1FMX0VESVRPUl9QQURESU5HLFxuICBJTklUSUFMX05PUlRIX1BFUkNFTlQsXG4gIElOSVRJQUxfU09VVEhfUEVSQ0VOVCxcbiAgU0VUX1FVRVJZX0VESVRPUl9TUUxfREVCT1VOQ0VfTVMsXG4gIFZBTElEQVRJT05fREVCT1VOQ0VfTVMsXG4gIFdJTkRPV19SRVNJWkVfVEhST1RUTEVfTVMsXG59IGZyb20gJ3NyYy9TcWxMYWIvY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIGdldEl0ZW0sXG4gIExvY2FsU3RvcmFnZUtleXMsXG4gIHNldEl0ZW0sXG59IGZyb20gJ3NyYy91dGlscy9sb2NhbFN0b3JhZ2VIZWxwZXJzJztcbmltcG9ydCB7IGlzRmVhdHVyZUVuYWJsZWQgfSBmcm9tICdzcmMvZmVhdHVyZUZsYWdzJztcbmltcG9ydCB7IEVtcHR5U3RhdGVCaWcgfSBmcm9tICdzcmMvY29tcG9uZW50cy9FbXB0eVN0YXRlJztcbmltcG9ydCBnZXRCb290c3RyYXBEYXRhIGZyb20gJ3NyYy91dGlscy9nZXRCb290c3RyYXBEYXRhJztcbmltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFRlbXBsYXRlUGFyYW1zRWRpdG9yIGZyb20gJy4uL1RlbXBsYXRlUGFyYW1zRWRpdG9yJztcbmltcG9ydCBTb3V0aFBhbmUgZnJvbSAnLi4vU291dGhQYW5lJztcbmltcG9ydCBTYXZlUXVlcnkgZnJvbSAnLi4vU2F2ZVF1ZXJ5JztcbmltcG9ydCBTY2hlZHVsZVF1ZXJ5QnV0dG9uIGZyb20gJy4uL1NjaGVkdWxlUXVlcnlCdXR0b24nO1xuaW1wb3J0IEVzdGltYXRlUXVlcnlDb3N0QnV0dG9uIGZyb20gJy4uL0VzdGltYXRlUXVlcnlDb3N0QnV0dG9uJztcbmltcG9ydCBTaGFyZVNxbExhYlF1ZXJ5IGZyb20gJy4uL1NoYXJlU3FsTGFiUXVlcnknO1xuaW1wb3J0IFNxbEVkaXRvckxlZnRCYXIgZnJvbSAnLi4vU3FsRWRpdG9yTGVmdEJhcic7XG5pbXBvcnQgQWNlRWRpdG9yV3JhcHBlciBmcm9tICcuLi9BY2VFZGl0b3JXcmFwcGVyJztcbmltcG9ydCBSdW5RdWVyeUFjdGlvbkJ1dHRvbiBmcm9tICcuLi9SdW5RdWVyeUFjdGlvbkJ1dHRvbic7XG5pbXBvcnQgUXVlcnlMaW1pdFNlbGVjdCBmcm9tICcuLi9RdWVyeUxpbWl0U2VsZWN0JztcblxuY29uc3QgYm9vdHN0cmFwRGF0YSA9IGdldEJvb3RzdHJhcERhdGEoKTtcbmNvbnN0IHZhbGlkYXRvck1hcCA9XG4gIGJvb3RzdHJhcERhdGE/LmNvbW1vbj8uY29uZj8uU1FMX1ZBTElEQVRPUlNfQllfRU5HSU5FIHx8IHt9O1xuY29uc3Qgc2NoZWR1bGVkUXVlcmllc0NvbmYgPSBib290c3RyYXBEYXRhPy5jb21tb24/LmNvbmY/LlNDSEVEVUxFRF9RVUVSSUVTO1xuXG5jb25zdCBTdHlsZWRUb29sYmFyID0gc3R5bGVkLmRpdmBcbiAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gIGJhY2tncm91bmQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDV9O1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGJvcmRlcjogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDJ9O1xuICBib3JkZXItdG9wOiAwO1xuXG4gIGZvcm0ge1xuICAgIG1hcmdpbi1ibG9jay1lbmQ6IDA7XG4gIH1cblxuICAubGVmdEl0ZW1zLFxuICAucmlnaHRJdGVtcyB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICYgPiBzcGFuIHtcbiAgICAgIG1hcmdpbi1yaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG5cbiAgICAgICY6bGFzdC1jaGlsZCB7XG4gICAgICAgIG1hcmdpbi1yaWdodDogMDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAubGltaXREcm9wZG93biB7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkU2lkZWJhciA9IHN0eWxlZC5kaXZgXG4gIGZsZXg6IDAgMCAkeyh7IHdpZHRoIH0pID0+IHdpZHRofXB4O1xuICB3aWR0aDogJHsoeyB3aWR0aCB9KSA9PiB3aWR0aH1weDtcbiAgcGFkZGluZzogJHsoeyB0aGVtZSwgaGlkZSB9KSA9PiAoaGlkZSA/IDAgOiB0aGVtZS5ncmlkVW5pdCAqIDIuNSl9cHg7XG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkXG4gICAgJHsoeyB0aGVtZSwgaGlkZSB9KSA9PlxuICAgICAgaGlkZSA/ICd0cmFuc3BhcmVudCcgOiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG5gO1xuXG5jb25zdCBTdHlsZWRTcWxFZGl0b3IgPSBzdHlsZWQuZGl2YFxuICAkeyh7IHRoZW1lIH0pID0+IGNzc2BcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgaGVpZ2h0OiAxMDAlO1xuXG4gICAgLnNjaGVtYVBhbmUge1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtICR7dGhlbWUudHJhbnNpdGlvblRpbWluZ31zIGVhc2UtaW4tb3V0O1xuICAgIH1cblxuICAgIC5xdWVyeVBhbmUge1xuICAgICAgZmxleDogMSAxIGF1dG87XG4gICAgICBwYWRkaW5nOiAke3RoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICBvdmVyZmxvdy14OiBzY3JvbGw7XG4gICAgfVxuXG4gICAgLnNjaGVtYVBhbmUtZW50ZXItZG9uZSxcbiAgICAuc2NoZW1hUGFuZS1leGl0IHtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTtcbiAgICAgIHotaW5kZXg6IDc7XG4gICAgfVxuXG4gICAgLnNjaGVtYVBhbmUtZXhpdC1hY3RpdmUge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMjAlKTtcbiAgICB9XG5cbiAgICAuc2NoZW1hUGFuZS1lbnRlci1hY3RpdmUge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApO1xuICAgICAgbWF4LXdpZHRoOiAke3RoZW1lLmdyaWRVbml0ICogNzV9cHg7XG4gICAgfVxuXG4gICAgLnNjaGVtYVBhbmUtZW50ZXIsXG4gICAgLnNjaGVtYVBhbmUtZXhpdC1kb25lIHtcbiAgICAgIG1heC13aWR0aDogMDtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMTIwJSk7XG4gICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIH1cblxuICAgIC5zY2hlbWFQYW5lLWV4aXQtZG9uZSArIC5xdWVyeVBhbmUge1xuICAgICAgbWFyZ2luLWxlZnQ6IDA7XG4gICAgfVxuXG4gICAgLmd1dHRlciB7XG4gICAgICBib3JkZXItdG9wOiAxcHggc29saWQgJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICB3aWR0aDogMyU7XG4gICAgICBtYXJnaW46ICR7U1FMX0VESVRPUl9HVVRURVJfTUFSR0lOfXB4IDQ3JTtcbiAgICB9XG5cbiAgICAuZ3V0dGVyLmd1dHRlci12ZXJ0aWNhbCB7XG4gICAgICBjdXJzb3I6IHJvdy1yZXNpemU7XG4gICAgfVxuICBgfVxuYDtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICB0YWJsZXM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBxdWVyeUVkaXRvcjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBkZWZhdWx0UXVlcnlMaW1pdDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICBtYXhSb3c6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgZGlzcGxheUxpbWl0OiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gIHNhdmVRdWVyeVdhcm5pbmc6IFByb3BUeXBlcy5zdHJpbmcsXG4gIHNjaGVkdWxlUXVlcnlXYXJuaW5nOiBQcm9wVHlwZXMuc3RyaW5nLFxufTtcblxuY29uc3QgU3FsRWRpdG9yID0gKHtcbiAgdGFibGVzLFxuICBxdWVyeUVkaXRvcixcbiAgZGVmYXVsdFF1ZXJ5TGltaXQsXG4gIG1heFJvdyxcbiAgZGlzcGxheUxpbWl0LFxuICBzYXZlUXVlcnlXYXJuaW5nLFxuICBzY2hlZHVsZVF1ZXJ5V2FybmluZyA9IG51bGwsXG59KSA9PiB7XG4gIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKTtcbiAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xuXG4gIGNvbnN0IHsgZGF0YWJhc2UsIGxhdGVzdFF1ZXJ5LCBoaWRlTGVmdEJhciB9ID0gdXNlU2VsZWN0b3IoXG4gICAgKHsgc3FsTGFiOiB7IHVuc2F2ZWRRdWVyeUVkaXRvciwgZGF0YWJhc2VzLCBxdWVyaWVzIH0gfSkgPT4ge1xuICAgICAgbGV0IHsgZGJJZCwgbGF0ZXN0UXVlcnlJZCwgaGlkZUxlZnRCYXIgfSA9IHF1ZXJ5RWRpdG9yO1xuICAgICAgaWYgKHVuc2F2ZWRRdWVyeUVkaXRvci5pZCA9PT0gcXVlcnlFZGl0b3IuaWQpIHtcbiAgICAgICAgZGJJZCA9IHVuc2F2ZWRRdWVyeUVkaXRvci5kYklkIHx8IGRiSWQ7XG4gICAgICAgIGxhdGVzdFF1ZXJ5SWQgPSB1bnNhdmVkUXVlcnlFZGl0b3IubGF0ZXN0UXVlcnlJZCB8fCBsYXRlc3RRdWVyeUlkO1xuICAgICAgICBoaWRlTGVmdEJhciA9IHVuc2F2ZWRRdWVyeUVkaXRvci5oaWRlTGVmdEJhciB8fCBoaWRlTGVmdEJhcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGFiYXNlOiBkYXRhYmFzZXNbZGJJZF0sXG4gICAgICAgIGxhdGVzdFF1ZXJ5OiBxdWVyaWVzW2xhdGVzdFF1ZXJ5SWRdLFxuICAgICAgICBoaWRlTGVmdEJhcixcbiAgICAgIH07XG4gICAgfSxcbiAgICBzaGFsbG93RXF1YWwsXG4gICk7XG5cbiAgY29uc3QgW2hlaWdodCwgc2V0SGVpZ2h0XSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbYXV0b3J1biwgc2V0QXV0b3J1bl0gPSB1c2VTdGF0ZShxdWVyeUVkaXRvci5hdXRvcnVuKTtcbiAgY29uc3QgW2N0YXMsIHNldEN0YXNdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbbm9ydGhQZXJjZW50LCBzZXROb3J0aFBlcmNlbnRdID0gdXNlU3RhdGUoXG4gICAgcXVlcnlFZGl0b3Iubm9ydGhQZXJjZW50IHx8IElOSVRJQUxfTk9SVEhfUEVSQ0VOVCxcbiAgKTtcbiAgY29uc3QgW3NvdXRoUGVyY2VudCwgc2V0U291dGhQZXJjZW50XSA9IHVzZVN0YXRlKFxuICAgIHF1ZXJ5RWRpdG9yLnNvdXRoUGVyY2VudCB8fCBJTklUSUFMX1NPVVRIX1BFUkNFTlQsXG4gICk7XG4gIGNvbnN0IFthdXRvY29tcGxldGVFbmFibGVkLCBzZXRBdXRvY29tcGxldGVFbmFibGVkXSA9IHVzZVN0YXRlKFxuICAgIGdldEl0ZW0oTG9jYWxTdG9yYWdlS2V5cy5zcWxsYWJfX2lzX2F1dG9jb21wbGV0ZV9lbmFibGVkLCB0cnVlKSxcbiAgKTtcbiAgY29uc3QgW3Nob3dDcmVhdGVBc01vZGFsLCBzZXRTaG93Q3JlYXRlQXNNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtjcmVhdGVBcywgc2V0Q3JlYXRlQXNdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbc2hvd0VtcHR5U3RhdGUsIHNldFNob3dFbXB0eVN0YXRlXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBzcWxFZGl0b3JSZWYgPSB1c2VSZWYobnVsbCk7XG4gIGNvbnN0IG5vcnRoUGFuZVJlZiA9IHVzZVJlZihudWxsKTtcblxuICBjb25zdCBzdGFydFF1ZXJ5ID0gdXNlQ2FsbGJhY2soXG4gICAgKGN0YXNBcmcgPSBmYWxzZSwgY3Rhc19tZXRob2QgPSBDdGFzRW51bS5UQUJMRSkgPT4ge1xuICAgICAgaWYgKCFkYXRhYmFzZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGRpc3BhdGNoKFxuICAgICAgICBydW5RdWVyeUZyb21TcWxFZGl0b3IoXG4gICAgICAgICAgZGF0YWJhc2UsXG4gICAgICAgICAgcXVlcnlFZGl0b3IsXG4gICAgICAgICAgZGVmYXVsdFF1ZXJ5TGltaXQsXG4gICAgICAgICAgY3Rhc0FyZyA/IGN0YXMgOiAnJyxcbiAgICAgICAgICBjdGFzQXJnLFxuICAgICAgICAgIGN0YXNfbWV0aG9kLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIGRpc3BhdGNoKHNldEFjdGl2ZVNvdXRoUGFuZVRhYignUmVzdWx0cycpKTtcbiAgICB9LFxuICAgIFtjdGFzLCBkYXRhYmFzZSwgZGVmYXVsdFF1ZXJ5TGltaXQsIGRpc3BhdGNoLCBxdWVyeUVkaXRvcl0sXG4gICk7XG5cbiAgY29uc3Qgc3RvcFF1ZXJ5ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChsYXRlc3RRdWVyeSAmJiBbJ3J1bm5pbmcnLCAncGVuZGluZyddLmluZGV4T2YobGF0ZXN0UXVlcnkuc3RhdGUpID49IDApIHtcbiAgICAgIGRpc3BhdGNoKHBvc3RTdG9wUXVlcnkobGF0ZXN0UXVlcnkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LCBbZGlzcGF0Y2gsIGxhdGVzdFF1ZXJ5XSk7XG5cbiAgY29uc3QgcnVuUXVlcnkgPSAoKSA9PiB7XG4gICAgaWYgKGRhdGFiYXNlKSB7XG4gICAgICBzdGFydFF1ZXJ5KCk7XG4gICAgfVxuICB9O1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGF1dG9ydW4pIHtcbiAgICAgIHNldEF1dG9ydW4oZmFsc2UpO1xuICAgICAgZGlzcGF0Y2gocXVlcnlFZGl0b3JTZXRBdXRvcnVuKHF1ZXJ5RWRpdG9yLCBmYWxzZSkpO1xuICAgICAgc3RhcnRRdWVyeSgpO1xuICAgIH1cbiAgfSwgW2F1dG9ydW4sIGRpc3BhdGNoLCBxdWVyeUVkaXRvciwgc3RhcnRRdWVyeV0pO1xuXG4gIC8vIE9uZSBsYXllciBvZiBhYnN0cmFjdGlvbiBmb3IgZWFzeSBzcHlpbmcgaW4gdW5pdCB0ZXN0c1xuICBjb25zdCBnZXRTcWxFZGl0b3JIZWlnaHQgPSAoKSA9PlxuICAgIHNxbEVkaXRvclJlZi5jdXJyZW50XG4gICAgICA/IHNxbEVkaXRvclJlZi5jdXJyZW50LmNsaWVudEhlaWdodCAtIFNRTF9FRElUT1JfUEFERElORyAqIDJcbiAgICAgIDogMDtcblxuICBjb25zdCBnZXRIb3RrZXlDb25maWcgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgLy8gR2V0IHRoZSB1c2VyJ3MgT1NcbiAgICBjb25zdCB1c2VyT1MgPSBkZXRlY3RPUygpO1xuICAgIGNvbnN0IGJhc2UgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdydW5RdWVyeTEnLFxuICAgICAgICBrZXk6ICdjdHJsK3InLFxuICAgICAgICBkZXNjcjogdCgnUnVuIHF1ZXJ5JyksXG4gICAgICAgIGZ1bmM6ICgpID0+IHtcbiAgICAgICAgICBpZiAocXVlcnlFZGl0b3Iuc3FsLnRyaW0oKSAhPT0gJycpIHtcbiAgICAgICAgICAgIHN0YXJ0UXVlcnkoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAncnVuUXVlcnkyJyxcbiAgICAgICAga2V5OiAnY3RybCtlbnRlcicsXG4gICAgICAgIGRlc2NyOiB0KCdSdW4gcXVlcnknKSxcbiAgICAgICAgZnVuYzogKCkgPT4ge1xuICAgICAgICAgIGlmIChxdWVyeUVkaXRvci5zcWwudHJpbSgpICE9PSAnJykge1xuICAgICAgICAgICAgc3RhcnRRdWVyeSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICduZXdUYWInLFxuICAgICAgICBrZXk6IHVzZXJPUyA9PT0gJ1dpbmRvd3MnID8gJ2N0cmwrcScgOiAnY3RybCt0JyxcbiAgICAgICAgZGVzY3I6IHQoJ05ldyB0YWInKSxcbiAgICAgICAgZnVuYzogKCkgPT4ge1xuICAgICAgICAgIGRpc3BhdGNoKGFkZE5ld1F1ZXJ5RWRpdG9yKCkpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ3N0b3BRdWVyeScsXG4gICAgICAgIGtleTogdXNlck9TID09PSAnTWFjT1MnID8gJ2N0cmwreCcgOiAnY3RybCtlJyxcbiAgICAgICAgZGVzY3I6IHQoJ1N0b3AgcXVlcnknKSxcbiAgICAgICAgZnVuYzogc3RvcFF1ZXJ5LFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgaWYgKHVzZXJPUyA9PT0gJ01hY09TJykge1xuICAgICAgYmFzZS5wdXNoKHtcbiAgICAgICAgbmFtZTogJ3ByZXZpb3VzTGluZScsXG4gICAgICAgIGtleTogJ2N0cmwrcCcsXG4gICAgICAgIGRlc2NyOiB0KCdQcmV2aW91cyBMaW5lJyksXG4gICAgICAgIGZ1bmM6IGVkaXRvciA9PiB7XG4gICAgICAgICAgZWRpdG9yLm5hdmlnYXRlVXAoMSk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZTtcbiAgfSwgW2Rpc3BhdGNoLCBxdWVyeUVkaXRvci5zcWwsIHN0YXJ0UXVlcnksIHN0b3BRdWVyeV0pO1xuXG4gIGNvbnN0IG9uQmVmb3JlVW5sb2FkID0gdXNlRWZmZWN0RXZlbnQoZXZlbnQgPT4ge1xuICAgIGlmIChcbiAgICAgIGRhdGFiYXNlPy5leHRyYV9qc29uPy5jYW5jZWxfcXVlcnlfb25fd2luZG93c191bmxvYWQgJiZcbiAgICAgIGxhdGVzdFF1ZXJ5Py5zdGF0ZSA9PT0gJ3J1bm5pbmcnXG4gICAgKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc3RvcFF1ZXJ5KCk7XG4gICAgfVxuICB9KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFdlIG5lZWQgdG8gbWVhc3VyZSB0aGUgaGVpZ2h0IG9mIHRoZSBzcWwgZWRpdG9yIHBvc3QgcmVuZGVyIHRvIGZpZ3VyZSB0aGUgaGVpZ2h0IG9mXG4gICAgLy8gdGhlIHNvdXRoIHBhbmUgc28gaXQgZ2V0cyByZW5kZXJlZCBwcm9wZXJseVxuICAgIHNldEhlaWdodChnZXRTcWxFZGl0b3JIZWlnaHQoKSk7XG4gICAgY29uc3QgaGFuZGxlV2luZG93UmVzaXplV2l0aFRocm90dGxlID0gdGhyb3R0bGUoXG4gICAgICAoKSA9PiBzZXRIZWlnaHQoZ2V0U3FsRWRpdG9ySGVpZ2h0KCkpLFxuICAgICAgV0lORE9XX1JFU0laRV9USFJPVFRMRV9NUyxcbiAgICApO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGhhbmRsZVdpbmRvd1Jlc2l6ZVdpdGhUaHJvdHRsZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIG9uQmVmb3JlVW5sb2FkKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplV2l0aFRocm90dGxlKTtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBvbkJlZm9yZVVubG9hZCk7XG4gICAgfTtcbiAgICAvLyBUT0RPOiBSZW1vdmUgdXNlRWZmZWN0RXZlbnQgZGVwcyBvbmNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9wdWxsLzI1ODgxIGlzIHJlbGVhc2VkXG4gIH0sIFtvbkJlZm9yZVVubG9hZF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFkYXRhYmFzZSB8fCBpc0VtcHR5KGRhdGFiYXNlKSkge1xuICAgICAgc2V0U2hvd0VtcHR5U3RhdGUodHJ1ZSk7XG4gICAgfVxuICB9LCBbZGF0YWJhc2VdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIHNldHVwIGhvdGtleXNcbiAgICBNb3VzZXRyYXAucmVzZXQoKTtcbiAgICBjb25zdCBob3RrZXlzID0gZ2V0SG90a2V5Q29uZmlnKCk7XG4gICAgaG90a2V5cy5mb3JFYWNoKGtleUNvbmZpZyA9PiB7XG4gICAgICBNb3VzZXRyYXAuYmluZChba2V5Q29uZmlnLmtleV0sIGtleUNvbmZpZy5mdW5jKTtcbiAgICB9KTtcbiAgfSwgW2dldEhvdGtleUNvbmZpZywgbGF0ZXN0UXVlcnldKTtcblxuICBjb25zdCBvblJlc2l6ZVN0YXJ0ID0gKCkgPT4ge1xuICAgIC8vIFNldCB0aGUgaGVpZ2h0cyBvbiB0aGUgYWNlIGVkaXRvciBhbmQgdGhlIGFjZSBjb250ZW50IGFyZWEgYWZ0ZXIgZHJhZyBzdGFydHNcbiAgICAvLyB0byBzbW9vdGggb3V0IHRoZSB2aXN1YWwgdHJhbnNpdGlvbiB0byB0aGUgbmV3IGhlaWdodHMgd2hlbiBkcmFnIGVuZHNcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhY2VfY29udGVudCcpWzBdLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcbiAgfTtcblxuICBjb25zdCBvblJlc2l6ZUVuZCA9IChbbm9ydGhQZXJjZW50LCBzb3V0aFBlcmNlbnRdKSA9PiB7XG4gICAgc2V0Tm9ydGhQZXJjZW50KG5vcnRoUGVyY2VudCk7XG4gICAgc2V0U291dGhQZXJjZW50KHNvdXRoUGVyY2VudCk7XG5cbiAgICBpZiAobm9ydGhQYW5lUmVmLmN1cnJlbnQ/LmNsaWVudEhlaWdodCkge1xuICAgICAgZGlzcGF0Y2gocGVyc2lzdEVkaXRvckhlaWdodChxdWVyeUVkaXRvciwgbm9ydGhQZXJjZW50LCBzb3V0aFBlcmNlbnQpKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2V0UXVlcnlFZGl0b3JBbmRTYXZlU3FsID0gdXNlQ2FsbGJhY2soXG4gICAgc3FsID0+IHtcbiAgICAgIGRpc3BhdGNoKHF1ZXJ5RWRpdG9yU2V0QW5kU2F2ZVNxbChxdWVyeUVkaXRvciwgc3FsKSk7XG4gICAgfSxcbiAgICBbZGlzcGF0Y2gsIHF1ZXJ5RWRpdG9yXSxcbiAgKTtcblxuICBjb25zdCBzZXRRdWVyeUVkaXRvckFuZFNhdmVTcWxXaXRoRGVib3VuY2UgPSB1c2VNZW1vKFxuICAgICgpID0+IGRlYm91bmNlKHNldFF1ZXJ5RWRpdG9yQW5kU2F2ZVNxbCwgU0VUX1FVRVJZX0VESVRPUl9TUUxfREVCT1VOQ0VfTVMpLFxuICAgIFtzZXRRdWVyeUVkaXRvckFuZFNhdmVTcWxdLFxuICApO1xuXG4gIGNvbnN0IGNhblZhbGlkYXRlUXVlcnkgPSAoKSA9PiB7XG4gICAgLy8gQ2hlY2sgd2hldGhlciBvciBub3Qgd2UgY2FuIHZhbGlkYXRlIHRoZSBjdXJyZW50IHF1ZXJ5IGJhc2VkIG9uIHdoZXRoZXJcbiAgICAvLyBvciBub3QgdGhlIGJhY2tlbmQgaGFzIGEgdmFsaWRhdG9yIGNvbmZpZ3VyZWQgZm9yIGl0LlxuICAgIGlmIChkYXRhYmFzZSkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRvck1hcC5oYXNPd25Qcm9wZXJ0eShkYXRhYmFzZS5iYWNrZW5kKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IHJlcXVlc3RWYWxpZGF0aW9uID0gdXNlQ2FsbGJhY2soXG4gICAgc3FsID0+IHtcbiAgICAgIGlmIChkYXRhYmFzZSkge1xuICAgICAgICBkaXNwYXRjaCh2YWxpZGF0ZVF1ZXJ5KHF1ZXJ5RWRpdG9yLCBzcWwpKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtkYXRhYmFzZSwgZGlzcGF0Y2gsIHF1ZXJ5RWRpdG9yXSxcbiAgKTtcblxuICBjb25zdCByZXF1ZXN0VmFsaWRhdGlvbldpdGhEZWJvdW5jZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZGVib3VuY2UocmVxdWVzdFZhbGlkYXRpb24sIFZBTElEQVRJT05fREVCT1VOQ0VfTVMpLFxuICAgIFtyZXF1ZXN0VmFsaWRhdGlvbl0sXG4gICk7XG5cbiAgY29uc3Qgb25TcWxDaGFuZ2VkID0gc3FsID0+IHtcbiAgICBkaXNwYXRjaChxdWVyeUVkaXRvclNldFNxbChxdWVyeUVkaXRvciwgc3FsKSk7XG4gICAgc2V0UXVlcnlFZGl0b3JBbmRTYXZlU3FsV2l0aERlYm91bmNlKHNxbCk7XG4gICAgLy8gUmVxdWVzdCBzZXJ2ZXItc2lkZSB2YWxpZGF0aW9uIG9mIHRoZSBxdWVyeSB0ZXh0XG4gICAgaWYgKGNhblZhbGlkYXRlUXVlcnkoKSkge1xuICAgICAgLy8gTkIuIHJlcXVlc3RWYWxpZGF0aW9uIGlzIGRlYm91bmNlZFxuICAgICAgcmVxdWVzdFZhbGlkYXRpb25XaXRoRGVib3VuY2Uoc3FsKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBoZWlnaHRzIGZvciB0aGUgYWNlIGVkaXRvciBhbmQgdGhlIHNvdXRoIHBhbmUgYXMgYW4gb2JqZWN0XG4gIC8vIGdpdmVuIHRoZSBoZWlnaHQgb2YgdGhlIHNxbCBlZGl0b3IsIG5vcnRoIHBhbmUgcGVyY2VudCBhbmQgc291dGggcGFuZSBwZXJjZW50LlxuICBjb25zdCBnZXRBY2VFZGl0b3JBbmRTb3V0aFBhbmVIZWlnaHRzID0gKFxuICAgIGhlaWdodCxcbiAgICBub3J0aFBlcmNlbnQsXG4gICAgc291dGhQZXJjZW50LFxuICApID0+ICh7XG4gICAgYWNlRWRpdG9ySGVpZ2h0OlxuICAgICAgKGhlaWdodCAqIG5vcnRoUGVyY2VudCkgLyAodGhlbWUuZ3JpZFVuaXQgKiAyNSkgLVxuICAgICAgKFNRTF9FRElUT1JfR1VUVEVSX0hFSUdIVCAvIDIgKyBTUUxfRURJVE9SX0dVVFRFUl9NQVJHSU4pIC1cbiAgICAgIFNRTF9UT09MQkFSX0hFSUdIVCxcbiAgICBzb3V0aFBhbmVIZWlnaHQ6XG4gICAgICAoaGVpZ2h0ICogc291dGhQZXJjZW50KSAvICh0aGVtZS5ncmlkVW5pdCAqIDI1KSAtXG4gICAgICAoU1FMX0VESVRPUl9HVVRURVJfSEVJR0hUIC8gMiArIFNRTF9FRElUT1JfR1VUVEVSX01BUkdJTiksXG4gIH0pO1xuXG4gIGNvbnN0IGdldFF1ZXJ5Q29zdEVzdGltYXRlID0gKCkgPT4ge1xuICAgIGlmIChkYXRhYmFzZSkge1xuICAgICAgZGlzcGF0Y2goZXN0aW1hdGVRdWVyeUNvc3QocXVlcnlFZGl0b3IpKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlVG9nZ2xlQXV0b2NvbXBsZXRlRW5hYmxlZCA9ICgpID0+IHtcbiAgICBzZXRJdGVtKFxuICAgICAgTG9jYWxTdG9yYWdlS2V5cy5zcWxsYWJfX2lzX2F1dG9jb21wbGV0ZV9lbmFibGVkLFxuICAgICAgIWF1dG9jb21wbGV0ZUVuYWJsZWQsXG4gICAgKTtcbiAgICBzZXRBdXRvY29tcGxldGVFbmFibGVkKCFhdXRvY29tcGxldGVFbmFibGVkKTtcbiAgfTtcblxuICBjb25zdCBlbGVtZW50U3R5bGUgPSAoZGltZW5zaW9uLCBlbGVtZW50U2l6ZSwgZ3V0dGVyU2l6ZSkgPT4gKHtcbiAgICBbZGltZW5zaW9uXTogYGNhbGMoJHtlbGVtZW50U2l6ZX0lIC0gJHtcbiAgICAgIGd1dHRlclNpemUgKyBTUUxfRURJVE9SX0dVVFRFUl9NQVJHSU5cbiAgICB9cHgpYCxcbiAgfSk7XG5cbiAgY29uc3QgY3JlYXRlVGFibGVBcyA9ICgpID0+IHtcbiAgICBzdGFydFF1ZXJ5KHRydWUsIEN0YXNFbnVtLlRBQkxFKTtcbiAgICBzZXRTaG93Q3JlYXRlQXNNb2RhbChmYWxzZSk7XG4gICAgc2V0Q3RhcygnJyk7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlVmlld0FzID0gKCkgPT4ge1xuICAgIHN0YXJ0UXVlcnkodHJ1ZSwgQ3Rhc0VudW0uVklFVyk7XG4gICAgc2V0U2hvd0NyZWF0ZUFzTW9kYWwoZmFsc2UpO1xuICAgIHNldEN0YXMoJycpO1xuICB9O1xuXG4gIGNvbnN0IGN0YXNDaGFuZ2VkID0gZXZlbnQgPT4ge1xuICAgIHNldEN0YXMoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgfTtcblxuICBjb25zdCByZW5kZXJEcm9wZG93biA9ICgpID0+IHtcbiAgICBjb25zdCBxZSA9IHF1ZXJ5RWRpdG9yO1xuICAgIGNvbnN0IHN1Y2Nlc3NmdWwgPSBsYXRlc3RRdWVyeT8uc3RhdGUgPT09ICdzdWNjZXNzJztcbiAgICBjb25zdCBzY2hlZHVsZVRvb2xUaXAgPSBzdWNjZXNzZnVsXG4gICAgICA/IHQoJ1NjaGVkdWxlIHRoZSBxdWVyeSBwZXJpb2RpY2FsbHknKVxuICAgICAgOiB0KCdZb3UgbXVzdCBydW4gdGhlIHF1ZXJ5IHN1Y2Nlc3NmdWxseSBmaXJzdCcpO1xuICAgIHJldHVybiAoXG4gICAgICA8TWVudSBjc3M9e3sgd2lkdGg6IHRoZW1lLmdyaWRVbml0ICogNDQgfX0+XG4gICAgICAgIDxNZW51Lkl0ZW0gY3NzPXt7IGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdzcGFjZS1iZXR3ZWVuJyB9fT5cbiAgICAgICAgICB7JyAnfVxuICAgICAgICAgIDxzcGFuPnt0KCdBdXRvY29tcGxldGUnKX08L3NwYW4+eycgJ31cbiAgICAgICAgICA8QW50ZFN3aXRjaFxuICAgICAgICAgICAgY2hlY2tlZD17YXV0b2NvbXBsZXRlRW5hYmxlZH1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVUb2dnbGVBdXRvY29tcGxldGVFbmFibGVkfVxuICAgICAgICAgICAgbmFtZT1cImF1dG9jb21wbGV0ZS1zd2l0Y2hcIlxuICAgICAgICAgIC8+eycgJ31cbiAgICAgICAgPC9NZW51Lkl0ZW0+XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVOQUJMRV9URU1QTEFURV9QUk9DRVNTSU5HKSAmJiAoXG4gICAgICAgICAgPE1lbnUuSXRlbT5cbiAgICAgICAgICAgIDxUZW1wbGF0ZVBhcmFtc0VkaXRvclxuICAgICAgICAgICAgICBsYW5ndWFnZT1cImpzb25cIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17cGFyYW1zID0+IHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaChxdWVyeUVkaXRvclNldFRlbXBsYXRlUGFyYW1zKHFlLCBwYXJhbXMpKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cWUuaWR9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvTWVudS5JdGVtPlxuICAgICAgICApfVxuICAgICAgICB7IWlzRW1wdHkoc2NoZWR1bGVkUXVlcmllc0NvbmYpICYmIChcbiAgICAgICAgICA8TWVudS5JdGVtPlxuICAgICAgICAgICAgPFNjaGVkdWxlUXVlcnlCdXR0b25cbiAgICAgICAgICAgICAgZGVmYXVsdExhYmVsPXtxZS5uYW1lfVxuICAgICAgICAgICAgICBzcWw9e3FlLnNxbH1cbiAgICAgICAgICAgICAgb25TY2hlZHVsZT17cXVlcnkgPT4gZGlzcGF0Y2goc2NoZWR1bGVRdWVyeShxdWVyeSkpfVxuICAgICAgICAgICAgICBzY2hlbWE9e3FlLnNjaGVtYX1cbiAgICAgICAgICAgICAgZGJJZD17cWUuZGJJZH1cbiAgICAgICAgICAgICAgc2NoZWR1bGVRdWVyeVdhcm5pbmc9e3NjaGVkdWxlUXVlcnlXYXJuaW5nfVxuICAgICAgICAgICAgICB0b29sdGlwPXtzY2hlZHVsZVRvb2xUaXB9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshc3VjY2Vzc2Z1bH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9NZW51Lkl0ZW0+XG4gICAgICAgICl9XG4gICAgICA8L01lbnU+XG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBvblNhdmVRdWVyeSA9IGFzeW5jIChxdWVyeSwgY2xpZW50SWQpID0+IHtcbiAgICBjb25zdCBzYXZlZFF1ZXJ5ID0gYXdhaXQgZGlzcGF0Y2goc2F2ZVF1ZXJ5KHF1ZXJ5LCBjbGllbnRJZCkpO1xuICAgIGRpc3BhdGNoKGFkZFNhdmVkUXVlcnlUb1RhYlN0YXRlKHF1ZXJ5RWRpdG9yLCBzYXZlZFF1ZXJ5KSk7XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyRWRpdG9yQm90dG9tQmFyID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgYWxsb3dfY3RhczogYWxsb3dDVEFTLCBhbGxvd19jdmFzOiBhbGxvd0NWQVMgfSA9IGRhdGFiYXNlIHx8IHt9O1xuXG4gICAgY29uc3Qgc2hvd01lbnUgPSBhbGxvd0NUQVMgfHwgYWxsb3dDVkFTO1xuICAgIGNvbnN0IHJ1bk1lbnVCdG4gPSAoXG4gICAgICA8TWVudT5cbiAgICAgICAge2FsbG93Q1RBUyAmJiAoXG4gICAgICAgICAgPE1lbnUuSXRlbVxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICBzZXRTaG93Q3JlYXRlQXNNb2RhbCh0cnVlKTtcbiAgICAgICAgICAgICAgc2V0Q3JlYXRlQXMoQ3Rhc0VudW0uVEFCTEUpO1xuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIGtleT1cIjFcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt0KCdDUkVBVEUgVEFCTEUgQVMnKX1cbiAgICAgICAgICA8L01lbnUuSXRlbT5cbiAgICAgICAgKX1cbiAgICAgICAge2FsbG93Q1ZBUyAmJiAoXG4gICAgICAgICAgPE1lbnUuSXRlbVxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICBzZXRTaG93Q3JlYXRlQXNNb2RhbCh0cnVlKTtcbiAgICAgICAgICAgICAgc2V0Q3JlYXRlQXMoQ3Rhc0VudW0uVklFVyk7XG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAga2V5PVwiMlwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3QoJ0NSRUFURSBWSUVXIEFTJyl9XG4gICAgICAgICAgPC9NZW51Lkl0ZW0+XG4gICAgICAgICl9XG4gICAgICA8L01lbnU+XG4gICAgKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkVG9vbGJhciBjbGFzc05hbWU9XCJzcWwtdG9vbGJhclwiIGlkPVwianMtc3FsLXRvb2xiYXJcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWZ0SXRlbXNcIj5cbiAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgIDxSdW5RdWVyeUFjdGlvbkJ1dHRvblxuICAgICAgICAgICAgICBhbGxvd0FzeW5jPXtkYXRhYmFzZSA/IGRhdGFiYXNlLmFsbG93X3J1bl9hc3luYyA6IGZhbHNlfVxuICAgICAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH1cbiAgICAgICAgICAgICAgcXVlcnlTdGF0ZT17bGF0ZXN0UXVlcnk/LnN0YXRlfVxuICAgICAgICAgICAgICBydW5RdWVyeT17cnVuUXVlcnl9XG4gICAgICAgICAgICAgIHN0b3BRdWVyeT17c3RvcFF1ZXJ5fVxuICAgICAgICAgICAgICBvdmVybGF5Q3JlYXRlQXNNZW51PXtzaG93TWVudSA/IHJ1bk1lbnVCdG4gOiBudWxsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRVNUSU1BVEVfUVVFUllfQ09TVCkgJiZcbiAgICAgICAgICAgIGRhdGFiYXNlPy5hbGxvd3NfY29zdF9lc3RpbWF0ZSAmJiAoXG4gICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgIDxFc3RpbWF0ZVF1ZXJ5Q29zdEJ1dHRvblxuICAgICAgICAgICAgICAgICAgZ2V0RXN0aW1hdGU9e2dldFF1ZXJ5Q29zdEVzdGltYXRlfVxuICAgICAgICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgICAgICAgICB0b29sdGlwPXt0KCdFc3RpbWF0ZSB0aGUgY29zdCBiZWZvcmUgcnVubmluZyBhIHF1ZXJ5Jyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgIDxRdWVyeUxpbWl0U2VsZWN0XG4gICAgICAgICAgICAgIHF1ZXJ5RWRpdG9ySWQ9e3F1ZXJ5RWRpdG9yLmlkfVxuICAgICAgICAgICAgICBtYXhSb3c9e21heFJvd31cbiAgICAgICAgICAgICAgZGVmYXVsdFF1ZXJ5TGltaXQ9e2RlZmF1bHRRdWVyeUxpbWl0fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAge2xhdGVzdFF1ZXJ5ICYmIChcbiAgICAgICAgICAgIDxUaW1lclxuICAgICAgICAgICAgICBzdGFydFRpbWU9e2xhdGVzdFF1ZXJ5LnN0YXJ0RHR0bX1cbiAgICAgICAgICAgICAgZW5kVGltZT17bGF0ZXN0UXVlcnkuZW5kRHR0bX1cbiAgICAgICAgICAgICAgc3RhdGU9e1NUQVRFX1RZUEVfTUFQW2xhdGVzdFF1ZXJ5LnN0YXRlXX1cbiAgICAgICAgICAgICAgaXNSdW5uaW5nPXtsYXRlc3RRdWVyeS5zdGF0ZSA9PT0gJ3J1bm5pbmcnfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyaWdodEl0ZW1zXCI+XG4gICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICA8U2F2ZVF1ZXJ5XG4gICAgICAgICAgICAgIHF1ZXJ5RWRpdG9ySWQ9e3F1ZXJ5RWRpdG9yLmlkfVxuICAgICAgICAgICAgICBjb2x1bW5zPXtsYXRlc3RRdWVyeT8ucmVzdWx0cz8uY29sdW1ucyB8fCBbXX1cbiAgICAgICAgICAgICAgb25TYXZlPXtvblNhdmVRdWVyeX1cbiAgICAgICAgICAgICAgb25VcGRhdGU9eyhxdWVyeSwgcmVtb3RlSWQsIGlkKSA9PlxuICAgICAgICAgICAgICAgIGRpc3BhdGNoKHVwZGF0ZVNhdmVkUXVlcnkocXVlcnksIHJlbW90ZUlkLCBpZCkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2F2ZVF1ZXJ5V2FybmluZz17c2F2ZVF1ZXJ5V2FybmluZ31cbiAgICAgICAgICAgICAgZGF0YWJhc2U9e2RhdGFiYXNlfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICA8U2hhcmVTcWxMYWJRdWVyeSBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH0gLz5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPEFudGREcm9wZG93biBvdmVybGF5PXtyZW5kZXJEcm9wZG93bigpfSB0cmlnZ2VyPVwiY2xpY2tcIj5cbiAgICAgICAgICAgIDxJY29ucy5Nb3JlSG9yaXogaWNvbkNvbG9yPXt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9IC8+XG4gICAgICAgICAgPC9BbnRkRHJvcGRvd24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9TdHlsZWRUb29sYmFyPlxuICAgICk7XG4gIH07XG5cbiAgY29uc3QgcXVlcnlQYW5lID0gKCkgPT4ge1xuICAgIGNvbnN0IGhvdGtleXMgPSBnZXRIb3RrZXlDb25maWcoKTtcbiAgICBjb25zdCB7IGFjZUVkaXRvckhlaWdodCwgc291dGhQYW5lSGVpZ2h0IH0gPVxuICAgICAgZ2V0QWNlRWRpdG9yQW5kU291dGhQYW5lSGVpZ2h0cyhoZWlnaHQsIG5vcnRoUGVyY2VudCwgc291dGhQZXJjZW50KTtcbiAgICByZXR1cm4gKFxuICAgICAgPFNwbGl0XG4gICAgICAgIGV4cGFuZFRvTWluXG4gICAgICAgIGNsYXNzTmFtZT1cInF1ZXJ5UGFuZVwiXG4gICAgICAgIHNpemVzPXtbbm9ydGhQZXJjZW50LCBzb3V0aFBlcmNlbnRdfVxuICAgICAgICBlbGVtZW50U3R5bGU9e2VsZW1lbnRTdHlsZX1cbiAgICAgICAgbWluU2l6ZT17MjAwfVxuICAgICAgICBkaXJlY3Rpb249XCJ2ZXJ0aWNhbFwiXG4gICAgICAgIGd1dHRlclNpemU9e1NRTF9FRElUT1JfR1VUVEVSX0hFSUdIVH1cbiAgICAgICAgb25EcmFnU3RhcnQ9e29uUmVzaXplU3RhcnR9XG4gICAgICAgIG9uRHJhZ0VuZD17b25SZXNpemVFbmR9XG4gICAgICA+XG4gICAgICAgIDxkaXYgcmVmPXtub3J0aFBhbmVSZWZ9IGNsYXNzTmFtZT1cIm5vcnRoLXBhbmVcIj5cbiAgICAgICAgICA8QWNlRWRpdG9yV3JhcHBlclxuICAgICAgICAgICAgYXV0b2NvbXBsZXRlPXthdXRvY29tcGxldGVFbmFibGVkfVxuICAgICAgICAgICAgb25CbHVyPXtzZXRRdWVyeUVkaXRvckFuZFNhdmVTcWx9XG4gICAgICAgICAgICBvbkNoYW5nZT17b25TcWxDaGFuZ2VkfVxuICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgICBkYXRhYmFzZT17ZGF0YWJhc2V9XG4gICAgICAgICAgICBleHRlbmRlZFRhYmxlcz17dGFibGVzfVxuICAgICAgICAgICAgaGVpZ2h0PXtgJHthY2VFZGl0b3JIZWlnaHR9cHhgfVxuICAgICAgICAgICAgaG90a2V5cz17aG90a2V5c31cbiAgICAgICAgICAvPlxuICAgICAgICAgIHtyZW5kZXJFZGl0b3JCb3R0b21CYXIoaG90a2V5cyl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8U291dGhQYW5lXG4gICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgbGF0ZXN0UXVlcnlJZD17bGF0ZXN0UXVlcnk/LmlkfVxuICAgICAgICAgIGhlaWdodD17c291dGhQYW5lSGVpZ2h0fVxuICAgICAgICAgIGRpc3BsYXlMaW1pdD17ZGlzcGxheUxpbWl0fVxuICAgICAgICAgIGRlZmF1bHRRdWVyeUxpbWl0PXtkZWZhdWx0UXVlcnlMaW1pdH1cbiAgICAgICAgLz5cbiAgICAgIDwvU3BsaXQ+XG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVWaWV3TW9kYWxUaXRsZSA9XG4gICAgY3JlYXRlQXMgPT09IEN0YXNFbnVtLlZJRVcgPyAnQ1JFQVRFIFZJRVcgQVMnIDogJ0NSRUFURSBUQUJMRSBBUyc7XG5cbiAgY29uc3QgY3JlYXRlTW9kYWxQbGFjZUhvbGRlciA9XG4gICAgY3JlYXRlQXMgPT09IEN0YXNFbnVtLlZJRVdcbiAgICAgID8gdCgnU3BlY2lmeSBuYW1lIHRvIENSRUFURSBWSUVXIEFTIHNjaGVtYSBpbjogcHVibGljJylcbiAgICAgIDogdCgnU3BlY2lmeSBuYW1lIHRvIENSRUFURSBUQUJMRSBBUyBzY2hlbWEgaW46IHB1YmxpYycpO1xuXG4gIGNvbnN0IGxlZnRCYXJTdGF0ZUNsYXNzID0gaGlkZUxlZnRCYXJcbiAgICA/ICdzY2hlbWFQYW5lLWV4aXQtZG9uZSdcbiAgICA6ICdzY2hlbWFQYW5lLWVudGVyLWRvbmUnO1xuICByZXR1cm4gKFxuICAgIDxTdHlsZWRTcWxFZGl0b3IgcmVmPXtzcWxFZGl0b3JSZWZ9IGNsYXNzTmFtZT1cIlNxbEVkaXRvclwiPlxuICAgICAgPENTU1RyYW5zaXRpb24gY2xhc3NOYW1lcz1cInNjaGVtYVBhbmVcIiBpbj17IWhpZGVMZWZ0QmFyfSB0aW1lb3V0PXszMDB9PlxuICAgICAgICA8UmVzaXphYmxlU2lkZWJhclxuICAgICAgICAgIGlkPXtgc3FsbGFiOiR7cXVlcnlFZGl0b3IuaWR9YH1cbiAgICAgICAgICBtaW5XaWR0aD17U1FMX0VESVRPUl9MRUZUQkFSX1dJRFRIfVxuICAgICAgICAgIGluaXRpYWxXaWR0aD17U1FMX0VESVRPUl9MRUZUQkFSX1dJRFRIfVxuICAgICAgICAgIGVuYWJsZT17IWhpZGVMZWZ0QmFyfVxuICAgICAgICA+XG4gICAgICAgICAge2FkanVzdGVkV2lkdGggPT4gKFxuICAgICAgICAgICAgPFN0eWxlZFNpZGViYXJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgc2NoZW1hUGFuZSAke2xlZnRCYXJTdGF0ZUNsYXNzfWB9XG4gICAgICAgICAgICAgIHdpZHRoPXthZGp1c3RlZFdpZHRofVxuICAgICAgICAgICAgICBoaWRlPXtoaWRlTGVmdEJhcn1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFNxbEVkaXRvckxlZnRCYXJcbiAgICAgICAgICAgICAgICBkYXRhYmFzZT17ZGF0YWJhc2V9XG4gICAgICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgICAgICAgdGFibGVzPXt0YWJsZXN9XG4gICAgICAgICAgICAgICAgc2V0RW1wdHlTdGF0ZT17Ym9vbCA9PiBzZXRTaG93RW1wdHlTdGF0ZShib29sKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3R5bGVkU2lkZWJhcj5cbiAgICAgICAgICApfVxuICAgICAgICA8L1Jlc2l6YWJsZVNpZGViYXI+XG4gICAgICA8L0NTU1RyYW5zaXRpb24+XG4gICAgICB7c2hvd0VtcHR5U3RhdGUgPyAoXG4gICAgICAgIDxFbXB0eVN0YXRlQmlnXG4gICAgICAgICAgaW1hZ2U9XCJ2ZWN0b3Iuc3ZnXCJcbiAgICAgICAgICB0aXRsZT17dCgnU2VsZWN0IGEgZGF0YWJhc2UgdG8gd3JpdGUgYSBxdWVyeScpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0Nob29zZSBvbmUgb2YgdGhlIGF2YWlsYWJsZSBkYXRhYmFzZXMgZnJvbSB0aGUgcGFuZWwgb24gdGhlIGxlZnQuJyxcbiAgICAgICAgICApfVxuICAgICAgICAvPlxuICAgICAgKSA6IChcbiAgICAgICAgcXVlcnlQYW5lKClcbiAgICAgICl9XG4gICAgICA8TW9kYWxcbiAgICAgICAgdmlzaWJsZT17c2hvd0NyZWF0ZUFzTW9kYWx9XG4gICAgICAgIHRpdGxlPXt0KGNyZWF0ZVZpZXdNb2RhbFRpdGxlKX1cbiAgICAgICAgb25IaWRlPXsoKSA9PiBzZXRTaG93Q3JlYXRlQXNNb2RhbChmYWxzZSl9XG4gICAgICAgIGZvb3Rlcj17XG4gICAgICAgICAgPD5cbiAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17KCkgPT4gc2V0U2hvd0NyZWF0ZUFzTW9kYWwoZmFsc2UpfT5cbiAgICAgICAgICAgICAge3QoJ0NhbmNlbCcpfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICB7Y3JlYXRlQXMgPT09IEN0YXNFbnVtLlRBQkxFICYmIChcbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2N0YXMubGVuZ3RoID09PSAwfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2NyZWF0ZVRhYmxlQXN9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7dCgnQ3JlYXRlJyl9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtjcmVhdGVBcyA9PT0gQ3Rhc0VudW0uVklFVyAmJiAoXG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInByaW1hcnlcIlxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXtjdGFzLmxlbmd0aCA9PT0gMH1cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtjcmVhdGVWaWV3QXN9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7dCgnQ3JlYXRlJyl9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8Lz5cbiAgICAgICAgfVxuICAgICAgPlxuICAgICAgICA8c3Bhbj57dCgnTmFtZScpfTwvc3Bhbj5cbiAgICAgICAgPElucHV0IHBsYWNlaG9sZGVyPXtjcmVhdGVNb2RhbFBsYWNlSG9sZGVyfSBvbkNoYW5nZT17Y3Rhc0NoYW5nZWR9IC8+XG4gICAgICA8L01vZGFsPlxuICAgIDwvU3R5bGVkU3FsRWRpdG9yPlxuICApO1xufTtcblxuU3FsRWRpdG9yLnByb3BUeXBlcyA9IHByb3BUeXBlcztcblxuZXhwb3J0IGRlZmF1bHQgU3FsRWRpdG9yO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\n\nconst SqlEditor = (_ref10) =>\n\n\n\n\n\n\n\n{let { tables, queryEditor, defaultQueryLimit, maxRow, displayLimit, saveQueryWarning, scheduleQueryWarning = null } = _ref10;\n  const theme = useTheme();\n  const dispatch = useDispatch();\n\n  const { database, latestQuery, hideLeftBar } = useSelector(\n  (_ref11) => {let { sqlLab: { unsavedQueryEditor, databases, queries } } = _ref11;\n    let { dbId, latestQueryId, hideLeftBar } = queryEditor;\n    if (unsavedQueryEditor.id === queryEditor.id) {\n      dbId = unsavedQueryEditor.dbId || dbId;\n      latestQueryId = unsavedQueryEditor.latestQueryId || latestQueryId;\n      hideLeftBar = unsavedQueryEditor.hideLeftBar || hideLeftBar;\n    }\n    return {\n      database: databases[dbId],\n      latestQuery: queries[latestQueryId],\n      hideLeftBar };\n\n  },\n  shallowEqual);\n\n\n  const [height, setHeight] = useState(0);\n  const [autorun, setAutorun] = useState(queryEditor.autorun);\n  const [ctas, setCtas] = useState('');\n  const [northPercent, setNorthPercent] = useState(\n  queryEditor.northPercent || INITIAL_NORTH_PERCENT);\n\n  const [southPercent, setSouthPercent] = useState(\n  queryEditor.southPercent || INITIAL_SOUTH_PERCENT);\n\n  const [autocompleteEnabled, setAutocompleteEnabled] = useState(\n  getItem(LocalStorageKeys.sqllab__is_autocomplete_enabled, true));\n\n  const [showCreateAsModal, setShowCreateAsModal] = useState(false);\n  const [createAs, setCreateAs] = useState('');\n  const [showEmptyState, setShowEmptyState] = useState(false);\n\n  const sqlEditorRef = useRef(null);\n  const northPaneRef = useRef(null);\n\n  const startQuery = useCallback(\n  function (ctasArg, ctas_method) {if (ctasArg === void 0) {ctasArg = false;}if (ctas_method === void 0) {ctas_method = CtasEnum.TABLE;}\n    if (!database) {\n      return;\n    }\n\n    dispatch(\n    runQueryFromSqlEditor(\n    database,\n    queryEditor,\n    defaultQueryLimit,\n    ctasArg ? ctas : '',\n    ctasArg,\n    ctas_method));\n\n\n    dispatch(setActiveSouthPaneTab('Results'));\n  },\n  [ctas, database, defaultQueryLimit, dispatch, queryEditor]);\n\n\n  const stopQuery = useCallback(() => {\n    if (latestQuery && ['running', 'pending'].indexOf(latestQuery.state) >= 0) {\n      dispatch(postStopQuery(latestQuery));\n    }\n    return false;\n  }, [dispatch, latestQuery]);\n\n  const runQuery = () => {\n    if (database) {\n      startQuery();\n    }\n  };\n\n  useEffect(() => {\n    if (autorun) {\n      setAutorun(false);\n      dispatch(queryEditorSetAutorun(queryEditor, false));\n      startQuery();\n    }\n  }, [autorun, dispatch, queryEditor, startQuery]);\n\n  // One layer of abstraction for easy spying in unit tests\n  const getSqlEditorHeight = () =>\n  sqlEditorRef.current ?\n  sqlEditorRef.current.clientHeight - SQL_EDITOR_PADDING * 2 :\n  0;\n\n  const getHotkeyConfig = useCallback(() => {\n    // Get the user's OS\n    const userOS = detectOS();\n    const base = [\n    {\n      name: 'runQuery1',\n      key: 'ctrl+r',\n      descr: t('Run query'),\n      func: () => {\n        if (queryEditor.sql.trim() !== '') {\n          startQuery();\n        }\n      } },\n\n    {\n      name: 'runQuery2',\n      key: 'ctrl+enter',\n      descr: t('Run query'),\n      func: () => {\n        if (queryEditor.sql.trim() !== '') {\n          startQuery();\n        }\n      } },\n\n    {\n      name: 'newTab',\n      key: userOS === 'Windows' ? 'ctrl+q' : 'ctrl+t',\n      descr: t('New tab'),\n      func: () => {\n        dispatch(addNewQueryEditor());\n      } },\n\n    {\n      name: 'stopQuery',\n      key: userOS === 'MacOS' ? 'ctrl+x' : 'ctrl+e',\n      descr: t('Stop query'),\n      func: stopQuery }];\n\n\n\n    if (userOS === 'MacOS') {\n      base.push({\n        name: 'previousLine',\n        key: 'ctrl+p',\n        descr: t('Previous Line'),\n        func: (editor) => {\n          editor.navigateUp(1);\n        } });\n\n    }\n\n    return base;\n  }, [dispatch, queryEditor.sql, startQuery, stopQuery]);\n\n  const onBeforeUnload = useEffectEvent((event) => {var _database$extra_json;\n    if (\n    database != null && (_database$extra_json = database.extra_json) != null && _database$extra_json.cancel_query_on_windows_unload &&\n    (latestQuery == null ? void 0 : latestQuery.state) === 'running')\n    {\n      event.preventDefault();\n      stopQuery();\n    }\n  });\n\n  useEffect(() => {\n    // We need to measure the height of the sql editor post render to figure the height of\n    // the south pane so it gets rendered properly\n    setHeight(getSqlEditorHeight());\n    const handleWindowResizeWithThrottle = throttle(\n    () => setHeight(getSqlEditorHeight()),\n    WINDOW_RESIZE_THROTTLE_MS);\n\n\n    window.addEventListener('resize', handleWindowResizeWithThrottle);\n    window.addEventListener('beforeunload', onBeforeUnload);\n\n    return () => {\n      window.removeEventListener('resize', handleWindowResizeWithThrottle);\n      window.removeEventListener('beforeunload', onBeforeUnload);\n    };\n    // TODO: Remove useEffectEvent deps once https://github.com/facebook/react/pull/25881 is released\n  }, [onBeforeUnload]);\n\n  useEffect(() => {\n    if (!database || _isEmpty(database)) {\n      setShowEmptyState(true);\n    }\n  }, [database]);\n\n  useEffect(() => {\n    // setup hotkeys\n    Mousetrap.reset();\n    const hotkeys = getHotkeyConfig();\n    hotkeys.forEach((keyConfig) => {\n      Mousetrap.bind([keyConfig.key], keyConfig.func);\n    });\n  }, [getHotkeyConfig, latestQuery]);\n\n  const onResizeStart = () => {\n    // Set the heights on the ace editor and the ace content area after drag starts\n    // to smooth out the visual transition to the new heights when drag ends\n    document.getElementsByClassName('ace_content')[0].style.height = '100%';\n  };\n\n  const onResizeEnd = (_ref12) => {var _northPaneRef$current;let [northPercent, southPercent] = _ref12;\n    setNorthPercent(northPercent);\n    setSouthPercent(southPercent);\n\n    if ((_northPaneRef$current = northPaneRef.current) != null && _northPaneRef$current.clientHeight) {\n      dispatch(persistEditorHeight(queryEditor, northPercent, southPercent));\n    }\n  };\n\n  const setQueryEditorAndSaveSql = useCallback(\n  (sql) => {\n    dispatch(queryEditorSetAndSaveSql(queryEditor, sql));\n  },\n  [dispatch, queryEditor]);\n\n\n  const setQueryEditorAndSaveSqlWithDebounce = useMemo(\n  () => debounce(setQueryEditorAndSaveSql, SET_QUERY_EDITOR_SQL_DEBOUNCE_MS),\n  [setQueryEditorAndSaveSql]);\n\n\n  const canValidateQuery = () => {\n    // Check whether or not we can validate the current query based on whether\n    // or not the backend has a validator configured for it.\n    if (database) {\n      return validatorMap.hasOwnProperty(database.backend);\n    }\n    return false;\n  };\n\n  const requestValidation = useCallback(\n  (sql) => {\n    if (database) {\n      dispatch(validateQuery(queryEditor, sql));\n    }\n  },\n  [database, dispatch, queryEditor]);\n\n\n  const requestValidationWithDebounce = useMemo(\n  () => debounce(requestValidation, VALIDATION_DEBOUNCE_MS),\n  [requestValidation]);\n\n\n  const onSqlChanged = (sql) => {\n    dispatch(queryEditorSetSql(queryEditor, sql));\n    setQueryEditorAndSaveSqlWithDebounce(sql);\n    // Request server-side validation of the query text\n    if (canValidateQuery()) {\n      // NB. requestValidation is debounced\n      requestValidationWithDebounce(sql);\n    }\n  };\n\n  // Return the heights for the ace editor and the south pane as an object\n  // given the height of the sql editor, north pane percent and south pane percent.\n  const getAceEditorAndSouthPaneHeights = (\n  height,\n  northPercent,\n  southPercent) => (\n  {\n    aceEditorHeight:\n    height * northPercent / (theme.gridUnit * 25) - (\n    SQL_EDITOR_GUTTER_HEIGHT / 2 + SQL_EDITOR_GUTTER_MARGIN) -\n    SQL_TOOLBAR_HEIGHT,\n    southPaneHeight:\n    height * southPercent / (theme.gridUnit * 25) - (\n    SQL_EDITOR_GUTTER_HEIGHT / 2 + SQL_EDITOR_GUTTER_MARGIN) });\n\n\n  const getQueryCostEstimate = () => {\n    if (database) {\n      dispatch(estimateQueryCost(queryEditor));\n    }\n  };\n\n  const handleToggleAutocompleteEnabled = () => {\n    setItem(\n    LocalStorageKeys.sqllab__is_autocomplete_enabled,\n    !autocompleteEnabled);\n\n    setAutocompleteEnabled(!autocompleteEnabled);\n  };\n\n  const elementStyle = (dimension, elementSize, gutterSize) => ({\n    [dimension]: `calc(${elementSize}% - ${\n    gutterSize + SQL_EDITOR_GUTTER_MARGIN\n    }px)` });\n\n\n  const createTableAs = () => {\n    startQuery(true, CtasEnum.TABLE);\n    setShowCreateAsModal(false);\n    setCtas('');\n  };\n\n  const createViewAs = () => {\n    startQuery(true, CtasEnum.VIEW);\n    setShowCreateAsModal(false);\n    setCtas('');\n  };\n\n  const ctasChanged = (event) => {\n    setCtas(event.target.value);\n  };\n\n  const renderDropdown = () => {\n    const qe = queryEditor;\n    const successful = (latestQuery == null ? void 0 : latestQuery.state) === 'success';\n    const scheduleToolTip = successful ?\n    t('Schedule the query periodically') :\n    t('You must run the query successfully first');\n    return (\n      ___EmotionJSX(Menu, { css: /*#__PURE__*/_css({ width: theme.gridUnit * 44 }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:renderDropdown;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9ib2dkYW5reXJ5bGl1ay9jb2RlL29wZW5zb3VyY2Uvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL1NxbExhYi9jb21wb25lbnRzL1NxbEVkaXRvci9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd2dCWSIsImZpbGUiOiIvVXNlcnMvYm9nZGFua3lyeWxpdWsvY29kZS9vcGVuc291cmNlL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9TcWxMYWIvY29tcG9uZW50cy9TcWxFZGl0b3IvaW5kZXguanN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyogZXNsaW50LWRpc2FibGUganN4LWExMXkvYW5jaG9yLWlzLXZhbGlkICovXG4vKiBlc2xpbnQtZGlzYWJsZSBqc3gtYTExeS9uby1zdGF0aWMtZWxlbWVudC1pbnRlcmFjdGlvbnMgKi9cbmltcG9ydCBSZWFjdCwge1xuICB1c2VTdGF0ZSxcbiAgdXNlRWZmZWN0LFxuICB1c2VNZW1vLFxuICB1c2VSZWYsXG4gIHVzZUNhbGxiYWNrLFxufSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdXNlRWZmZWN0RXZlbnQgZnJvbSAnc3JjL2hvb2tzL3VzZUVmZmVjdEV2ZW50JztcbmltcG9ydCB7IENTU1RyYW5zaXRpb24gfSBmcm9tICdyZWFjdC10cmFuc2l0aW9uLWdyb3VwJztcbmltcG9ydCB7IHNoYWxsb3dFcXVhbCwgdXNlRGlzcGF0Y2gsIHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBTcGxpdCBmcm9tICdyZWFjdC1zcGxpdCc7XG5pbXBvcnQgeyBjc3MsIEZlYXR1cmVGbGFnLCBzdHlsZWQsIHQsIHVzZVRoZW1lIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IGRlYm91bmNlIGZyb20gJ2xvZGFzaC9kZWJvdW5jZSc7XG5pbXBvcnQgdGhyb3R0bGUgZnJvbSAnbG9kYXNoL3Rocm90dGxlJztcbmltcG9ydCBNb2RhbCBmcm9tICdzcmMvY29tcG9uZW50cy9Nb2RhbCc7XG5pbXBvcnQgTW91c2V0cmFwIGZyb20gJ21vdXNldHJhcCc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0J1dHRvbic7XG5pbXBvcnQgVGltZXIgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGltZXInO1xuaW1wb3J0IFJlc2l6YWJsZVNpZGViYXIgZnJvbSAnc3JjL2NvbXBvbmVudHMvUmVzaXphYmxlU2lkZWJhcic7XG5pbXBvcnQgeyBBbnRkRHJvcGRvd24sIEFudGRTd2l0Y2ggfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0lucHV0JztcbmltcG9ydCB7IE1lbnUgfSBmcm9tICdzcmMvY29tcG9uZW50cy9NZW51JztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgeyBkZXRlY3RPUyB9IGZyb20gJ3NyYy91dGlscy9jb21tb24nO1xuaW1wb3J0IHtcbiAgYWRkTmV3UXVlcnlFZGl0b3IsXG4gIEN0YXNFbnVtLFxuICBlc3RpbWF0ZVF1ZXJ5Q29zdCxcbiAgcGVyc2lzdEVkaXRvckhlaWdodCxcbiAgcG9zdFN0b3BRdWVyeSxcbiAgcXVlcnlFZGl0b3JTZXRBdXRvcnVuLFxuICBxdWVyeUVkaXRvclNldFNxbCxcbiAgcXVlcnlFZGl0b3JTZXRBbmRTYXZlU3FsLFxuICBxdWVyeUVkaXRvclNldFRlbXBsYXRlUGFyYW1zLFxuICBydW5RdWVyeUZyb21TcWxFZGl0b3IsXG4gIHNhdmVRdWVyeSxcbiAgYWRkU2F2ZWRRdWVyeVRvVGFiU3RhdGUsXG4gIHNjaGVkdWxlUXVlcnksXG4gIHNldEFjdGl2ZVNvdXRoUGFuZVRhYixcbiAgdXBkYXRlU2F2ZWRRdWVyeSxcbiAgdmFsaWRhdGVRdWVyeSxcbn0gZnJvbSAnc3JjL1NxbExhYi9hY3Rpb25zL3NxbExhYic7XG5pbXBvcnQge1xuICBTVEFURV9UWVBFX01BUCxcbiAgU1FMX0VESVRPUl9HVVRURVJfSEVJR0hULFxuICBTUUxfRURJVE9SX0dVVFRFUl9NQVJHSU4sXG4gIFNRTF9UT09MQkFSX0hFSUdIVCxcbiAgU1FMX0VESVRPUl9MRUZUQkFSX1dJRFRILFxuICBTUUxfRURJVE9SX1BBRERJTkcsXG4gIElOSVRJQUxfTk9SVEhfUEVSQ0VOVCxcbiAgSU5JVElBTF9TT1VUSF9QRVJDRU5ULFxuICBTRVRfUVVFUllfRURJVE9SX1NRTF9ERUJPVU5DRV9NUyxcbiAgVkFMSURBVElPTl9ERUJPVU5DRV9NUyxcbiAgV0lORE9XX1JFU0laRV9USFJPVFRMRV9NUyxcbn0gZnJvbSAnc3JjL1NxbExhYi9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgZ2V0SXRlbSxcbiAgTG9jYWxTdG9yYWdlS2V5cyxcbiAgc2V0SXRlbSxcbn0gZnJvbSAnc3JjL3V0aWxzL2xvY2FsU3RvcmFnZUhlbHBlcnMnO1xuaW1wb3J0IHsgaXNGZWF0dXJlRW5hYmxlZCB9IGZyb20gJ3NyYy9mZWF0dXJlRmxhZ3MnO1xuaW1wb3J0IHsgRW1wdHlTdGF0ZUJpZyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0VtcHR5U3RhdGUnO1xuaW1wb3J0IGdldEJvb3RzdHJhcERhdGEgZnJvbSAnc3JjL3V0aWxzL2dldEJvb3RzdHJhcERhdGEnO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgVGVtcGxhdGVQYXJhbXNFZGl0b3IgZnJvbSAnLi4vVGVtcGxhdGVQYXJhbXNFZGl0b3InO1xuaW1wb3J0IFNvdXRoUGFuZSBmcm9tICcuLi9Tb3V0aFBhbmUnO1xuaW1wb3J0IFNhdmVRdWVyeSBmcm9tICcuLi9TYXZlUXVlcnknO1xuaW1wb3J0IFNjaGVkdWxlUXVlcnlCdXR0b24gZnJvbSAnLi4vU2NoZWR1bGVRdWVyeUJ1dHRvbic7XG5pbXBvcnQgRXN0aW1hdGVRdWVyeUNvc3RCdXR0b24gZnJvbSAnLi4vRXN0aW1hdGVRdWVyeUNvc3RCdXR0b24nO1xuaW1wb3J0IFNoYXJlU3FsTGFiUXVlcnkgZnJvbSAnLi4vU2hhcmVTcWxMYWJRdWVyeSc7XG5pbXBvcnQgU3FsRWRpdG9yTGVmdEJhciBmcm9tICcuLi9TcWxFZGl0b3JMZWZ0QmFyJztcbmltcG9ydCBBY2VFZGl0b3JXcmFwcGVyIGZyb20gJy4uL0FjZUVkaXRvcldyYXBwZXInO1xuaW1wb3J0IFJ1blF1ZXJ5QWN0aW9uQnV0dG9uIGZyb20gJy4uL1J1blF1ZXJ5QWN0aW9uQnV0dG9uJztcbmltcG9ydCBRdWVyeUxpbWl0U2VsZWN0IGZyb20gJy4uL1F1ZXJ5TGltaXRTZWxlY3QnO1xuXG5jb25zdCBib290c3RyYXBEYXRhID0gZ2V0Qm9vdHN0cmFwRGF0YSgpO1xuY29uc3QgdmFsaWRhdG9yTWFwID1cbiAgYm9vdHN0cmFwRGF0YT8uY29tbW9uPy5jb25mPy5TUUxfVkFMSURBVE9SU19CWV9FTkdJTkUgfHwge307XG5jb25zdCBzY2hlZHVsZWRRdWVyaWVzQ29uZiA9IGJvb3RzdHJhcERhdGE/LmNvbW1vbj8uY29uZj8uU0NIRURVTEVEX1FVRVJJRVM7XG5cbmNvbnN0IFN0eWxlZFRvb2xiYXIgPSBzdHlsZWQuZGl2YFxuICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgYmFja2dyb3VuZDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0NX07XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYm9yZGVyOiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gIGJvcmRlci10b3A6IDA7XG5cbiAgZm9ybSB7XG4gICAgbWFyZ2luLWJsb2NrLWVuZDogMDtcbiAgfVxuXG4gIC5sZWZ0SXRlbXMsXG4gIC5yaWdodEl0ZW1zIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgJiA+IHNwYW4ge1xuICAgICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcblxuICAgICAgJjpsYXN0LWNoaWxkIHtcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC5saW1pdERyb3Bkb3duIHtcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRTaWRlYmFyID0gc3R5bGVkLmRpdmBcbiAgZmxleDogMCAwICR7KHsgd2lkdGggfSkgPT4gd2lkdGh9cHg7XG4gIHdpZHRoOiAkeyh7IHdpZHRoIH0pID0+IHdpZHRofXB4O1xuICBwYWRkaW5nOiAkeyh7IHRoZW1lLCBoaWRlIH0pID0+IChoaWRlID8gMCA6IHRoZW1lLmdyaWRVbml0ICogMi41KX1weDtcbiAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWRcbiAgICAkeyh7IHRoZW1lLCBoaWRlIH0pID0+XG4gICAgICBoaWRlID8gJ3RyYW5zcGFyZW50JyA6IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbmA7XG5cbmNvbnN0IFN0eWxlZFNxbEVkaXRvciA9IHN0eWxlZC5kaXZgXG4gICR7KHsgdGhlbWUgfSkgPT4gY3NzYFxuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBoZWlnaHQ6IDEwMCU7XG5cbiAgICAuc2NoZW1hUGFuZSB7XG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gJHt0aGVtZS50cmFuc2l0aW9uVGltaW5nfXMgZWFzZS1pbi1vdXQ7XG4gICAgfVxuXG4gICAgLnF1ZXJ5UGFuZSB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcbiAgICAgIHBhZGRpbmc6ICR7dGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgIG92ZXJmbG93LXg6IHNjcm9sbDtcbiAgICB9XG5cbiAgICAuc2NoZW1hUGFuZS1lbnRlci1kb25lLFxuICAgIC5zY2hlbWFQYW5lLWV4aXQge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApO1xuICAgICAgei1pbmRleDogNztcbiAgICB9XG5cbiAgICAuc2NoZW1hUGFuZS1leGl0LWFjdGl2ZSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTEyMCUpO1xuICAgIH1cblxuICAgIC5zY2hlbWFQYW5lLWVudGVyLWFjdGl2ZSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7XG4gICAgICBtYXgtd2lkdGg6ICR7dGhlbWUuZ3JpZFVuaXQgKiA3NX1weDtcbiAgICB9XG5cbiAgICAuc2NoZW1hUGFuZS1lbnRlcixcbiAgICAuc2NoZW1hUGFuZS1leGl0LWRvbmUge1xuICAgICAgbWF4LXdpZHRoOiAwO1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMjAlKTtcbiAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgfVxuXG4gICAgLnNjaGVtYVBhbmUtZXhpdC1kb25lICsgLnF1ZXJ5UGFuZSB7XG4gICAgICBtYXJnaW4tbGVmdDogMDtcbiAgICB9XG5cbiAgICAuZ3V0dGVyIHtcbiAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIHdpZHRoOiAzJTtcbiAgICAgIG1hcmdpbjogJHtTUUxfRURJVE9SX0dVVFRFUl9NQVJHSU59cHggNDclO1xuICAgIH1cblxuICAgIC5ndXR0ZXIuZ3V0dGVyLXZlcnRpY2FsIHtcbiAgICAgIGN1cnNvcjogcm93LXJlc2l6ZTtcbiAgICB9XG4gIGB9XG5gO1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIHRhYmxlczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIHF1ZXJ5RWRpdG9yOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIGRlZmF1bHRRdWVyeUxpbWl0OiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gIG1heFJvdzogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICBkaXNwbGF5TGltaXQ6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgc2F2ZVF1ZXJ5V2FybmluZzogUHJvcFR5cGVzLnN0cmluZyxcbiAgc2NoZWR1bGVRdWVyeVdhcm5pbmc6IFByb3BUeXBlcy5zdHJpbmcsXG59O1xuXG5jb25zdCBTcWxFZGl0b3IgPSAoe1xuICB0YWJsZXMsXG4gIHF1ZXJ5RWRpdG9yLFxuICBkZWZhdWx0UXVlcnlMaW1pdCxcbiAgbWF4Um93LFxuICBkaXNwbGF5TGltaXQsXG4gIHNhdmVRdWVyeVdhcm5pbmcsXG4gIHNjaGVkdWxlUXVlcnlXYXJuaW5nID0gbnVsbCxcbn0pID0+IHtcbiAgY29uc3QgdGhlbWUgPSB1c2VUaGVtZSgpO1xuICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKCk7XG5cbiAgY29uc3QgeyBkYXRhYmFzZSwgbGF0ZXN0UXVlcnksIGhpZGVMZWZ0QmFyIH0gPSB1c2VTZWxlY3RvcihcbiAgICAoeyBzcWxMYWI6IHsgdW5zYXZlZFF1ZXJ5RWRpdG9yLCBkYXRhYmFzZXMsIHF1ZXJpZXMgfSB9KSA9PiB7XG4gICAgICBsZXQgeyBkYklkLCBsYXRlc3RRdWVyeUlkLCBoaWRlTGVmdEJhciB9ID0gcXVlcnlFZGl0b3I7XG4gICAgICBpZiAodW5zYXZlZFF1ZXJ5RWRpdG9yLmlkID09PSBxdWVyeUVkaXRvci5pZCkge1xuICAgICAgICBkYklkID0gdW5zYXZlZFF1ZXJ5RWRpdG9yLmRiSWQgfHwgZGJJZDtcbiAgICAgICAgbGF0ZXN0UXVlcnlJZCA9IHVuc2F2ZWRRdWVyeUVkaXRvci5sYXRlc3RRdWVyeUlkIHx8IGxhdGVzdFF1ZXJ5SWQ7XG4gICAgICAgIGhpZGVMZWZ0QmFyID0gdW5zYXZlZFF1ZXJ5RWRpdG9yLmhpZGVMZWZ0QmFyIHx8IGhpZGVMZWZ0QmFyO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YWJhc2U6IGRhdGFiYXNlc1tkYklkXSxcbiAgICAgICAgbGF0ZXN0UXVlcnk6IHF1ZXJpZXNbbGF0ZXN0UXVlcnlJZF0sXG4gICAgICAgIGhpZGVMZWZ0QmFyLFxuICAgICAgfTtcbiAgICB9LFxuICAgIHNoYWxsb3dFcXVhbCxcbiAgKTtcblxuICBjb25zdCBbaGVpZ2h0LCBzZXRIZWlnaHRdID0gdXNlU3RhdGUoMCk7XG4gIGNvbnN0IFthdXRvcnVuLCBzZXRBdXRvcnVuXSA9IHVzZVN0YXRlKHF1ZXJ5RWRpdG9yLmF1dG9ydW4pO1xuICBjb25zdCBbY3Rhcywgc2V0Q3Rhc10gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtub3J0aFBlcmNlbnQsIHNldE5vcnRoUGVyY2VudF0gPSB1c2VTdGF0ZShcbiAgICBxdWVyeUVkaXRvci5ub3J0aFBlcmNlbnQgfHwgSU5JVElBTF9OT1JUSF9QRVJDRU5ULFxuICApO1xuICBjb25zdCBbc291dGhQZXJjZW50LCBzZXRTb3V0aFBlcmNlbnRdID0gdXNlU3RhdGUoXG4gICAgcXVlcnlFZGl0b3Iuc291dGhQZXJjZW50IHx8IElOSVRJQUxfU09VVEhfUEVSQ0VOVCxcbiAgKTtcbiAgY29uc3QgW2F1dG9jb21wbGV0ZUVuYWJsZWQsIHNldEF1dG9jb21wbGV0ZUVuYWJsZWRdID0gdXNlU3RhdGUoXG4gICAgZ2V0SXRlbShMb2NhbFN0b3JhZ2VLZXlzLnNxbGxhYl9faXNfYXV0b2NvbXBsZXRlX2VuYWJsZWQsIHRydWUpLFxuICApO1xuICBjb25zdCBbc2hvd0NyZWF0ZUFzTW9kYWwsIHNldFNob3dDcmVhdGVBc01vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NyZWF0ZUFzLCBzZXRDcmVhdGVBc10gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtzaG93RW1wdHlTdGF0ZSwgc2V0U2hvd0VtcHR5U3RhdGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIGNvbnN0IHNxbEVkaXRvclJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3Qgbm9ydGhQYW5lUmVmID0gdXNlUmVmKG51bGwpO1xuXG4gIGNvbnN0IHN0YXJ0UXVlcnkgPSB1c2VDYWxsYmFjayhcbiAgICAoY3Rhc0FyZyA9IGZhbHNlLCBjdGFzX21ldGhvZCA9IEN0YXNFbnVtLlRBQkxFKSA9PiB7XG4gICAgICBpZiAoIWRhdGFiYXNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZGlzcGF0Y2goXG4gICAgICAgIHJ1blF1ZXJ5RnJvbVNxbEVkaXRvcihcbiAgICAgICAgICBkYXRhYmFzZSxcbiAgICAgICAgICBxdWVyeUVkaXRvcixcbiAgICAgICAgICBkZWZhdWx0UXVlcnlMaW1pdCxcbiAgICAgICAgICBjdGFzQXJnID8gY3RhcyA6ICcnLFxuICAgICAgICAgIGN0YXNBcmcsXG4gICAgICAgICAgY3Rhc19tZXRob2QsXG4gICAgICAgICksXG4gICAgICApO1xuICAgICAgZGlzcGF0Y2goc2V0QWN0aXZlU291dGhQYW5lVGFiKCdSZXN1bHRzJykpO1xuICAgIH0sXG4gICAgW2N0YXMsIGRhdGFiYXNlLCBkZWZhdWx0UXVlcnlMaW1pdCwgZGlzcGF0Y2gsIHF1ZXJ5RWRpdG9yXSxcbiAgKTtcblxuICBjb25zdCBzdG9wUXVlcnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKGxhdGVzdFF1ZXJ5ICYmIFsncnVubmluZycsICdwZW5kaW5nJ10uaW5kZXhPZihsYXRlc3RRdWVyeS5zdGF0ZSkgPj0gMCkge1xuICAgICAgZGlzcGF0Y2gocG9zdFN0b3BRdWVyeShsYXRlc3RRdWVyeSkpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sIFtkaXNwYXRjaCwgbGF0ZXN0UXVlcnldKTtcblxuICBjb25zdCBydW5RdWVyeSA9ICgpID0+IHtcbiAgICBpZiAoZGF0YWJhc2UpIHtcbiAgICAgIHN0YXJ0UXVlcnkoKTtcbiAgICB9XG4gIH07XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoYXV0b3J1bikge1xuICAgICAgc2V0QXV0b3J1bihmYWxzZSk7XG4gICAgICBkaXNwYXRjaChxdWVyeUVkaXRvclNldEF1dG9ydW4ocXVlcnlFZGl0b3IsIGZhbHNlKSk7XG4gICAgICBzdGFydFF1ZXJ5KCk7XG4gICAgfVxuICB9LCBbYXV0b3J1biwgZGlzcGF0Y2gsIHF1ZXJ5RWRpdG9yLCBzdGFydFF1ZXJ5XSk7XG5cbiAgLy8gT25lIGxheWVyIG9mIGFic3RyYWN0aW9uIGZvciBlYXN5IHNweWluZyBpbiB1bml0IHRlc3RzXG4gIGNvbnN0IGdldFNxbEVkaXRvckhlaWdodCA9ICgpID0+XG4gICAgc3FsRWRpdG9yUmVmLmN1cnJlbnRcbiAgICAgID8gc3FsRWRpdG9yUmVmLmN1cnJlbnQuY2xpZW50SGVpZ2h0IC0gU1FMX0VESVRPUl9QQURESU5HICogMlxuICAgICAgOiAwO1xuXG4gIGNvbnN0IGdldEhvdGtleUNvbmZpZyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAvLyBHZXQgdGhlIHVzZXIncyBPU1xuICAgIGNvbnN0IHVzZXJPUyA9IGRldGVjdE9TKCk7XG4gICAgY29uc3QgYmFzZSA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ3J1blF1ZXJ5MScsXG4gICAgICAgIGtleTogJ2N0cmwrcicsXG4gICAgICAgIGRlc2NyOiB0KCdSdW4gcXVlcnknKSxcbiAgICAgICAgZnVuYzogKCkgPT4ge1xuICAgICAgICAgIGlmIChxdWVyeUVkaXRvci5zcWwudHJpbSgpICE9PSAnJykge1xuICAgICAgICAgICAgc3RhcnRRdWVyeSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdydW5RdWVyeTInLFxuICAgICAgICBrZXk6ICdjdHJsK2VudGVyJyxcbiAgICAgICAgZGVzY3I6IHQoJ1J1biBxdWVyeScpLFxuICAgICAgICBmdW5jOiAoKSA9PiB7XG4gICAgICAgICAgaWYgKHF1ZXJ5RWRpdG9yLnNxbC50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgICBzdGFydFF1ZXJ5KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ25ld1RhYicsXG4gICAgICAgIGtleTogdXNlck9TID09PSAnV2luZG93cycgPyAnY3RybCtxJyA6ICdjdHJsK3QnLFxuICAgICAgICBkZXNjcjogdCgnTmV3IHRhYicpLFxuICAgICAgICBmdW5jOiAoKSA9PiB7XG4gICAgICAgICAgZGlzcGF0Y2goYWRkTmV3UXVlcnlFZGl0b3IoKSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnc3RvcFF1ZXJ5JyxcbiAgICAgICAga2V5OiB1c2VyT1MgPT09ICdNYWNPUycgPyAnY3RybCt4JyA6ICdjdHJsK2UnLFxuICAgICAgICBkZXNjcjogdCgnU3RvcCBxdWVyeScpLFxuICAgICAgICBmdW5jOiBzdG9wUXVlcnksXG4gICAgICB9LFxuICAgIF07XG5cbiAgICBpZiAodXNlck9TID09PSAnTWFjT1MnKSB7XG4gICAgICBiYXNlLnB1c2goe1xuICAgICAgICBuYW1lOiAncHJldmlvdXNMaW5lJyxcbiAgICAgICAga2V5OiAnY3RybCtwJyxcbiAgICAgICAgZGVzY3I6IHQoJ1ByZXZpb3VzIExpbmUnKSxcbiAgICAgICAgZnVuYzogZWRpdG9yID0+IHtcbiAgICAgICAgICBlZGl0b3IubmF2aWdhdGVVcCgxKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBiYXNlO1xuICB9LCBbZGlzcGF0Y2gsIHF1ZXJ5RWRpdG9yLnNxbCwgc3RhcnRRdWVyeSwgc3RvcFF1ZXJ5XSk7XG5cbiAgY29uc3Qgb25CZWZvcmVVbmxvYWQgPSB1c2VFZmZlY3RFdmVudChldmVudCA9PiB7XG4gICAgaWYgKFxuICAgICAgZGF0YWJhc2U/LmV4dHJhX2pzb24/LmNhbmNlbF9xdWVyeV9vbl93aW5kb3dzX3VubG9hZCAmJlxuICAgICAgbGF0ZXN0UXVlcnk/LnN0YXRlID09PSAncnVubmluZydcbiAgICApIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzdG9wUXVlcnkoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gV2UgbmVlZCB0byBtZWFzdXJlIHRoZSBoZWlnaHQgb2YgdGhlIHNxbCBlZGl0b3IgcG9zdCByZW5kZXIgdG8gZmlndXJlIHRoZSBoZWlnaHQgb2ZcbiAgICAvLyB0aGUgc291dGggcGFuZSBzbyBpdCBnZXRzIHJlbmRlcmVkIHByb3Blcmx5XG4gICAgc2V0SGVpZ2h0KGdldFNxbEVkaXRvckhlaWdodCgpKTtcbiAgICBjb25zdCBoYW5kbGVXaW5kb3dSZXNpemVXaXRoVGhyb3R0bGUgPSB0aHJvdHRsZShcbiAgICAgICgpID0+IHNldEhlaWdodChnZXRTcWxFZGl0b3JIZWlnaHQoKSksXG4gICAgICBXSU5ET1dfUkVTSVpFX1RIUk9UVExFX01TLFxuICAgICk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplV2l0aFRocm90dGxlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgb25CZWZvcmVVbmxvYWQpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBoYW5kbGVXaW5kb3dSZXNpemVXaXRoVGhyb3R0bGUpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIG9uQmVmb3JlVW5sb2FkKTtcbiAgICB9O1xuICAgIC8vIFRPRE86IFJlbW92ZSB1c2VFZmZlY3RFdmVudCBkZXBzIG9uY2UgaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3B1bGwvMjU4ODEgaXMgcmVsZWFzZWRcbiAgfSwgW29uQmVmb3JlVW5sb2FkXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWRhdGFiYXNlIHx8IGlzRW1wdHkoZGF0YWJhc2UpKSB7XG4gICAgICBzZXRTaG93RW1wdHlTdGF0ZSh0cnVlKTtcbiAgICB9XG4gIH0sIFtkYXRhYmFzZV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gc2V0dXAgaG90a2V5c1xuICAgIE1vdXNldHJhcC5yZXNldCgpO1xuICAgIGNvbnN0IGhvdGtleXMgPSBnZXRIb3RrZXlDb25maWcoKTtcbiAgICBob3RrZXlzLmZvckVhY2goa2V5Q29uZmlnID0+IHtcbiAgICAgIE1vdXNldHJhcC5iaW5kKFtrZXlDb25maWcua2V5XSwga2V5Q29uZmlnLmZ1bmMpO1xuICAgIH0pO1xuICB9LCBbZ2V0SG90a2V5Q29uZmlnLCBsYXRlc3RRdWVyeV0pO1xuXG4gIGNvbnN0IG9uUmVzaXplU3RhcnQgPSAoKSA9PiB7XG4gICAgLy8gU2V0IHRoZSBoZWlnaHRzIG9uIHRoZSBhY2UgZWRpdG9yIGFuZCB0aGUgYWNlIGNvbnRlbnQgYXJlYSBhZnRlciBkcmFnIHN0YXJ0c1xuICAgIC8vIHRvIHNtb290aCBvdXQgdGhlIHZpc3VhbCB0cmFuc2l0aW9uIHRvIHRoZSBuZXcgaGVpZ2h0cyB3aGVuIGRyYWcgZW5kc1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FjZV9jb250ZW50JylbMF0uc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuICB9O1xuXG4gIGNvbnN0IG9uUmVzaXplRW5kID0gKFtub3J0aFBlcmNlbnQsIHNvdXRoUGVyY2VudF0pID0+IHtcbiAgICBzZXROb3J0aFBlcmNlbnQobm9ydGhQZXJjZW50KTtcbiAgICBzZXRTb3V0aFBlcmNlbnQoc291dGhQZXJjZW50KTtcblxuICAgIGlmIChub3J0aFBhbmVSZWYuY3VycmVudD8uY2xpZW50SGVpZ2h0KSB7XG4gICAgICBkaXNwYXRjaChwZXJzaXN0RWRpdG9ySGVpZ2h0KHF1ZXJ5RWRpdG9yLCBub3J0aFBlcmNlbnQsIHNvdXRoUGVyY2VudCkpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzZXRRdWVyeUVkaXRvckFuZFNhdmVTcWwgPSB1c2VDYWxsYmFjayhcbiAgICBzcWwgPT4ge1xuICAgICAgZGlzcGF0Y2gocXVlcnlFZGl0b3JTZXRBbmRTYXZlU3FsKHF1ZXJ5RWRpdG9yLCBzcWwpKTtcbiAgICB9LFxuICAgIFtkaXNwYXRjaCwgcXVlcnlFZGl0b3JdLFxuICApO1xuXG4gIGNvbnN0IHNldFF1ZXJ5RWRpdG9yQW5kU2F2ZVNxbFdpdGhEZWJvdW5jZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZGVib3VuY2Uoc2V0UXVlcnlFZGl0b3JBbmRTYXZlU3FsLCBTRVRfUVVFUllfRURJVE9SX1NRTF9ERUJPVU5DRV9NUyksXG4gICAgW3NldFF1ZXJ5RWRpdG9yQW5kU2F2ZVNxbF0sXG4gICk7XG5cbiAgY29uc3QgY2FuVmFsaWRhdGVRdWVyeSA9ICgpID0+IHtcbiAgICAvLyBDaGVjayB3aGV0aGVyIG9yIG5vdCB3ZSBjYW4gdmFsaWRhdGUgdGhlIGN1cnJlbnQgcXVlcnkgYmFzZWQgb24gd2hldGhlclxuICAgIC8vIG9yIG5vdCB0aGUgYmFja2VuZCBoYXMgYSB2YWxpZGF0b3IgY29uZmlndXJlZCBmb3IgaXQuXG4gICAgaWYgKGRhdGFiYXNlKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdG9yTWFwLmhhc093blByb3BlcnR5KGRhdGFiYXNlLmJhY2tlbmQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgcmVxdWVzdFZhbGlkYXRpb24gPSB1c2VDYWxsYmFjayhcbiAgICBzcWwgPT4ge1xuICAgICAgaWYgKGRhdGFiYXNlKSB7XG4gICAgICAgIGRpc3BhdGNoKHZhbGlkYXRlUXVlcnkocXVlcnlFZGl0b3IsIHNxbCkpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2RhdGFiYXNlLCBkaXNwYXRjaCwgcXVlcnlFZGl0b3JdLFxuICApO1xuXG4gIGNvbnN0IHJlcXVlc3RWYWxpZGF0aW9uV2l0aERlYm91bmNlID0gdXNlTWVtbyhcbiAgICAoKSA9PiBkZWJvdW5jZShyZXF1ZXN0VmFsaWRhdGlvbiwgVkFMSURBVElPTl9ERUJPVU5DRV9NUyksXG4gICAgW3JlcXVlc3RWYWxpZGF0aW9uXSxcbiAgKTtcblxuICBjb25zdCBvblNxbENoYW5nZWQgPSBzcWwgPT4ge1xuICAgIGRpc3BhdGNoKHF1ZXJ5RWRpdG9yU2V0U3FsKHF1ZXJ5RWRpdG9yLCBzcWwpKTtcbiAgICBzZXRRdWVyeUVkaXRvckFuZFNhdmVTcWxXaXRoRGVib3VuY2Uoc3FsKTtcbiAgICAvLyBSZXF1ZXN0IHNlcnZlci1zaWRlIHZhbGlkYXRpb24gb2YgdGhlIHF1ZXJ5IHRleHRcbiAgICBpZiAoY2FuVmFsaWRhdGVRdWVyeSgpKSB7XG4gICAgICAvLyBOQi4gcmVxdWVzdFZhbGlkYXRpb24gaXMgZGVib3VuY2VkXG4gICAgICByZXF1ZXN0VmFsaWRhdGlvbldpdGhEZWJvdW5jZShzcWwpO1xuICAgIH1cbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIGhlaWdodHMgZm9yIHRoZSBhY2UgZWRpdG9yIGFuZCB0aGUgc291dGggcGFuZSBhcyBhbiBvYmplY3RcbiAgLy8gZ2l2ZW4gdGhlIGhlaWdodCBvZiB0aGUgc3FsIGVkaXRvciwgbm9ydGggcGFuZSBwZXJjZW50IGFuZCBzb3V0aCBwYW5lIHBlcmNlbnQuXG4gIGNvbnN0IGdldEFjZUVkaXRvckFuZFNvdXRoUGFuZUhlaWdodHMgPSAoXG4gICAgaGVpZ2h0LFxuICAgIG5vcnRoUGVyY2VudCxcbiAgICBzb3V0aFBlcmNlbnQsXG4gICkgPT4gKHtcbiAgICBhY2VFZGl0b3JIZWlnaHQ6XG4gICAgICAoaGVpZ2h0ICogbm9ydGhQZXJjZW50KSAvICh0aGVtZS5ncmlkVW5pdCAqIDI1KSAtXG4gICAgICAoU1FMX0VESVRPUl9HVVRURVJfSEVJR0hUIC8gMiArIFNRTF9FRElUT1JfR1VUVEVSX01BUkdJTikgLVxuICAgICAgU1FMX1RPT0xCQVJfSEVJR0hULFxuICAgIHNvdXRoUGFuZUhlaWdodDpcbiAgICAgIChoZWlnaHQgKiBzb3V0aFBlcmNlbnQpIC8gKHRoZW1lLmdyaWRVbml0ICogMjUpIC1cbiAgICAgIChTUUxfRURJVE9SX0dVVFRFUl9IRUlHSFQgLyAyICsgU1FMX0VESVRPUl9HVVRURVJfTUFSR0lOKSxcbiAgfSk7XG5cbiAgY29uc3QgZ2V0UXVlcnlDb3N0RXN0aW1hdGUgPSAoKSA9PiB7XG4gICAgaWYgKGRhdGFiYXNlKSB7XG4gICAgICBkaXNwYXRjaChlc3RpbWF0ZVF1ZXJ5Q29zdChxdWVyeUVkaXRvcikpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVUb2dnbGVBdXRvY29tcGxldGVFbmFibGVkID0gKCkgPT4ge1xuICAgIHNldEl0ZW0oXG4gICAgICBMb2NhbFN0b3JhZ2VLZXlzLnNxbGxhYl9faXNfYXV0b2NvbXBsZXRlX2VuYWJsZWQsXG4gICAgICAhYXV0b2NvbXBsZXRlRW5hYmxlZCxcbiAgICApO1xuICAgIHNldEF1dG9jb21wbGV0ZUVuYWJsZWQoIWF1dG9jb21wbGV0ZUVuYWJsZWQpO1xuICB9O1xuXG4gIGNvbnN0IGVsZW1lbnRTdHlsZSA9IChkaW1lbnNpb24sIGVsZW1lbnRTaXplLCBndXR0ZXJTaXplKSA9PiAoe1xuICAgIFtkaW1lbnNpb25dOiBgY2FsYygke2VsZW1lbnRTaXplfSUgLSAke1xuICAgICAgZ3V0dGVyU2l6ZSArIFNRTF9FRElUT1JfR1VUVEVSX01BUkdJTlxuICAgIH1weClgLFxuICB9KTtcblxuICBjb25zdCBjcmVhdGVUYWJsZUFzID0gKCkgPT4ge1xuICAgIHN0YXJ0UXVlcnkodHJ1ZSwgQ3Rhc0VudW0uVEFCTEUpO1xuICAgIHNldFNob3dDcmVhdGVBc01vZGFsKGZhbHNlKTtcbiAgICBzZXRDdGFzKCcnKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVWaWV3QXMgPSAoKSA9PiB7XG4gICAgc3RhcnRRdWVyeSh0cnVlLCBDdGFzRW51bS5WSUVXKTtcbiAgICBzZXRTaG93Q3JlYXRlQXNNb2RhbChmYWxzZSk7XG4gICAgc2V0Q3RhcygnJyk7XG4gIH07XG5cbiAgY29uc3QgY3Rhc0NoYW5nZWQgPSBldmVudCA9PiB7XG4gICAgc2V0Q3RhcyhldmVudC50YXJnZXQudmFsdWUpO1xuICB9O1xuXG4gIGNvbnN0IHJlbmRlckRyb3Bkb3duID0gKCkgPT4ge1xuICAgIGNvbnN0IHFlID0gcXVlcnlFZGl0b3I7XG4gICAgY29uc3Qgc3VjY2Vzc2Z1bCA9IGxhdGVzdFF1ZXJ5Py5zdGF0ZSA9PT0gJ3N1Y2Nlc3MnO1xuICAgIGNvbnN0IHNjaGVkdWxlVG9vbFRpcCA9IHN1Y2Nlc3NmdWxcbiAgICAgID8gdCgnU2NoZWR1bGUgdGhlIHF1ZXJ5IHBlcmlvZGljYWxseScpXG4gICAgICA6IHQoJ1lvdSBtdXN0IHJ1biB0aGUgcXVlcnkgc3VjY2Vzc2Z1bGx5IGZpcnN0Jyk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNZW51IGNzcz17eyB3aWR0aDogdGhlbWUuZ3JpZFVuaXQgKiA0NCB9fT5cbiAgICAgICAgPE1lbnUuSXRlbSBjc3M9e3sgZGlzcGxheTogJ2ZsZXgnLCBqdXN0aWZ5Q29udGVudDogJ3NwYWNlLWJldHdlZW4nIH19PlxuICAgICAgICAgIHsnICd9XG4gICAgICAgICAgPHNwYW4+e3QoJ0F1dG9jb21wbGV0ZScpfTwvc3Bhbj57JyAnfVxuICAgICAgICAgIDxBbnRkU3dpdGNoXG4gICAgICAgICAgICBjaGVja2VkPXthdXRvY29tcGxldGVFbmFibGVkfVxuICAgICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZVRvZ2dsZUF1dG9jb21wbGV0ZUVuYWJsZWR9XG4gICAgICAgICAgICBuYW1lPVwiYXV0b2NvbXBsZXRlLXN3aXRjaFwiXG4gICAgICAgICAgLz57JyAnfVxuICAgICAgICA8L01lbnUuSXRlbT5cbiAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRU5BQkxFX1RFTVBMQVRFX1BST0NFU1NJTkcpICYmIChcbiAgICAgICAgICA8TWVudS5JdGVtPlxuICAgICAgICAgICAgPFRlbXBsYXRlUGFyYW1zRWRpdG9yXG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtwYXJhbXMgPT4ge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoKHF1ZXJ5RWRpdG9yU2V0VGVtcGxhdGVQYXJhbXMocWUsIHBhcmFtcykpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxZS5pZH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9NZW51Lkl0ZW0+XG4gICAgICAgICl9XG4gICAgICAgIHshaXNFbXB0eShzY2hlZHVsZWRRdWVyaWVzQ29uZikgJiYgKFxuICAgICAgICAgIDxNZW51Lkl0ZW0+XG4gICAgICAgICAgICA8U2NoZWR1bGVRdWVyeUJ1dHRvblxuICAgICAgICAgICAgICBkZWZhdWx0TGFiZWw9e3FlLm5hbWV9XG4gICAgICAgICAgICAgIHNxbD17cWUuc3FsfVxuICAgICAgICAgICAgICBvblNjaGVkdWxlPXtxdWVyeSA9PiBkaXNwYXRjaChzY2hlZHVsZVF1ZXJ5KHF1ZXJ5KSl9XG4gICAgICAgICAgICAgIHNjaGVtYT17cWUuc2NoZW1hfVxuICAgICAgICAgICAgICBkYklkPXtxZS5kYklkfVxuICAgICAgICAgICAgICBzY2hlZHVsZVF1ZXJ5V2FybmluZz17c2NoZWR1bGVRdWVyeVdhcm5pbmd9XG4gICAgICAgICAgICAgIHRvb2x0aXA9e3NjaGVkdWxlVG9vbFRpcH1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFzdWNjZXNzZnVsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L01lbnUuSXRlbT5cbiAgICAgICAgKX1cbiAgICAgIDwvTWVudT5cbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IG9uU2F2ZVF1ZXJ5ID0gYXN5bmMgKHF1ZXJ5LCBjbGllbnRJZCkgPT4ge1xuICAgIGNvbnN0IHNhdmVkUXVlcnkgPSBhd2FpdCBkaXNwYXRjaChzYXZlUXVlcnkocXVlcnksIGNsaWVudElkKSk7XG4gICAgZGlzcGF0Y2goYWRkU2F2ZWRRdWVyeVRvVGFiU3RhdGUocXVlcnlFZGl0b3IsIHNhdmVkUXVlcnkpKTtcbiAgfTtcblxuICBjb25zdCByZW5kZXJFZGl0b3JCb3R0b21CYXIgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBhbGxvd19jdGFzOiBhbGxvd0NUQVMsIGFsbG93X2N2YXM6IGFsbG93Q1ZBUyB9ID0gZGF0YWJhc2UgfHwge307XG5cbiAgICBjb25zdCBzaG93TWVudSA9IGFsbG93Q1RBUyB8fCBhbGxvd0NWQVM7XG4gICAgY29uc3QgcnVuTWVudUJ0biA9IChcbiAgICAgIDxNZW51PlxuICAgICAgICB7YWxsb3dDVEFTICYmIChcbiAgICAgICAgICA8TWVudS5JdGVtXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgIHNldFNob3dDcmVhdGVBc01vZGFsKHRydWUpO1xuICAgICAgICAgICAgICBzZXRDcmVhdGVBcyhDdGFzRW51bS5UQUJMRSk7XG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAga2V5PVwiMVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3QoJ0NSRUFURSBUQUJMRSBBUycpfVxuICAgICAgICAgIDwvTWVudS5JdGVtPlxuICAgICAgICApfVxuICAgICAgICB7YWxsb3dDVkFTICYmIChcbiAgICAgICAgICA8TWVudS5JdGVtXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgIHNldFNob3dDcmVhdGVBc01vZGFsKHRydWUpO1xuICAgICAgICAgICAgICBzZXRDcmVhdGVBcyhDdGFzRW51bS5WSUVXKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBrZXk9XCIyXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICB7dCgnQ1JFQVRFIFZJRVcgQVMnKX1cbiAgICAgICAgICA8L01lbnUuSXRlbT5cbiAgICAgICAgKX1cbiAgICAgIDwvTWVudT5cbiAgICApO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxTdHlsZWRUb29sYmFyIGNsYXNzTmFtZT1cInNxbC10b29sYmFyXCIgaWQ9XCJqcy1zcWwtdG9vbGJhclwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxlZnRJdGVtc1wiPlxuICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgPFJ1blF1ZXJ5QWN0aW9uQnV0dG9uXG4gICAgICAgICAgICAgIGFsbG93QXN5bmM9e2RhdGFiYXNlID8gZGF0YWJhc2UuYWxsb3dfcnVuX2FzeW5jIDogZmFsc2V9XG4gICAgICAgICAgICAgIHF1ZXJ5RWRpdG9ySWQ9e3F1ZXJ5RWRpdG9yLmlkfVxuICAgICAgICAgICAgICBxdWVyeVN0YXRlPXtsYXRlc3RRdWVyeT8uc3RhdGV9XG4gICAgICAgICAgICAgIHJ1blF1ZXJ5PXtydW5RdWVyeX1cbiAgICAgICAgICAgICAgc3RvcFF1ZXJ5PXtzdG9wUXVlcnl9XG4gICAgICAgICAgICAgIG92ZXJsYXlDcmVhdGVBc01lbnU9e3Nob3dNZW51ID8gcnVuTWVudUJ0biA6IG51bGx9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FU1RJTUFURV9RVUVSWV9DT1NUKSAmJlxuICAgICAgICAgICAgZGF0YWJhc2U/LmFsbG93c19jb3N0X2VzdGltYXRlICYmIChcbiAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgPEVzdGltYXRlUXVlcnlDb3N0QnV0dG9uXG4gICAgICAgICAgICAgICAgICBnZXRFc3RpbWF0ZT17Z2V0UXVlcnlDb3N0RXN0aW1hdGV9XG4gICAgICAgICAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH1cbiAgICAgICAgICAgICAgICAgIHRvb2x0aXA9e3QoJ0VzdGltYXRlIHRoZSBjb3N0IGJlZm9yZSBydW5uaW5nIGEgcXVlcnknKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgPFF1ZXJ5TGltaXRTZWxlY3RcbiAgICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgICAgIG1heFJvdz17bWF4Um93fVxuICAgICAgICAgICAgICBkZWZhdWx0UXVlcnlMaW1pdD17ZGVmYXVsdFF1ZXJ5TGltaXR9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7bGF0ZXN0UXVlcnkgJiYgKFxuICAgICAgICAgICAgPFRpbWVyXG4gICAgICAgICAgICAgIHN0YXJ0VGltZT17bGF0ZXN0UXVlcnkuc3RhcnREdHRtfVxuICAgICAgICAgICAgICBlbmRUaW1lPXtsYXRlc3RRdWVyeS5lbmREdHRtfVxuICAgICAgICAgICAgICBzdGF0ZT17U1RBVEVfVFlQRV9NQVBbbGF0ZXN0UXVlcnkuc3RhdGVdfVxuICAgICAgICAgICAgICBpc1J1bm5pbmc9e2xhdGVzdFF1ZXJ5LnN0YXRlID09PSAncnVubmluZyd9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJpZ2h0SXRlbXNcIj5cbiAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgIDxTYXZlUXVlcnlcbiAgICAgICAgICAgICAgcXVlcnlFZGl0b3JJZD17cXVlcnlFZGl0b3IuaWR9XG4gICAgICAgICAgICAgIGNvbHVtbnM9e2xhdGVzdFF1ZXJ5Py5yZXN1bHRzPy5jb2x1bW5zIHx8IFtdfVxuICAgICAgICAgICAgICBvblNhdmU9e29uU2F2ZVF1ZXJ5fVxuICAgICAgICAgICAgICBvblVwZGF0ZT17KHF1ZXJ5LCByZW1vdGVJZCwgaWQpID0+XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2godXBkYXRlU2F2ZWRRdWVyeShxdWVyeSwgcmVtb3RlSWQsIGlkKSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzYXZlUXVlcnlXYXJuaW5nPXtzYXZlUXVlcnlXYXJuaW5nfVxuICAgICAgICAgICAgICBkYXRhYmFzZT17ZGF0YWJhc2V9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgIDxTaGFyZVNxbExhYlF1ZXJ5IHF1ZXJ5RWRpdG9ySWQ9e3F1ZXJ5RWRpdG9yLmlkfSAvPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8QW50ZERyb3Bkb3duIG92ZXJsYXk9e3JlbmRlckRyb3Bkb3duKCl9IHRyaWdnZXI9XCJjbGlja1wiPlxuICAgICAgICAgICAgPEljb25zLk1vcmVIb3JpeiBpY29uQ29sb3I9e3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX0gLz5cbiAgICAgICAgICA8L0FudGREcm9wZG93bj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L1N0eWxlZFRvb2xiYXI+XG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBxdWVyeVBhbmUgPSAoKSA9PiB7XG4gICAgY29uc3QgaG90a2V5cyA9IGdldEhvdGtleUNvbmZpZygpO1xuICAgIGNvbnN0IHsgYWNlRWRpdG9ySGVpZ2h0LCBzb3V0aFBhbmVIZWlnaHQgfSA9XG4gICAgICBnZXRBY2VFZGl0b3JBbmRTb3V0aFBhbmVIZWlnaHRzKGhlaWdodCwgbm9ydGhQZXJjZW50LCBzb3V0aFBlcmNlbnQpO1xuICAgIHJldHVybiAoXG4gICAgICA8U3BsaXRcbiAgICAgICAgZXhwYW5kVG9NaW5cbiAgICAgICAgY2xhc3NOYW1lPVwicXVlcnlQYW5lXCJcbiAgICAgICAgc2l6ZXM9e1tub3J0aFBlcmNlbnQsIHNvdXRoUGVyY2VudF19XG4gICAgICAgIGVsZW1lbnRTdHlsZT17ZWxlbWVudFN0eWxlfVxuICAgICAgICBtaW5TaXplPXsyMDB9XG4gICAgICAgIGRpcmVjdGlvbj1cInZlcnRpY2FsXCJcbiAgICAgICAgZ3V0dGVyU2l6ZT17U1FMX0VESVRPUl9HVVRURVJfSEVJR0hUfVxuICAgICAgICBvbkRyYWdTdGFydD17b25SZXNpemVTdGFydH1cbiAgICAgICAgb25EcmFnRW5kPXtvblJlc2l6ZUVuZH1cbiAgICAgID5cbiAgICAgICAgPGRpdiByZWY9e25vcnRoUGFuZVJlZn0gY2xhc3NOYW1lPVwibm9ydGgtcGFuZVwiPlxuICAgICAgICAgIDxBY2VFZGl0b3JXcmFwcGVyXG4gICAgICAgICAgICBhdXRvY29tcGxldGU9e2F1dG9jb21wbGV0ZUVuYWJsZWR9XG4gICAgICAgICAgICBvbkJsdXI9e3NldFF1ZXJ5RWRpdG9yQW5kU2F2ZVNxbH1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXtvblNxbENoYW5nZWR9XG4gICAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH1cbiAgICAgICAgICAgIGRhdGFiYXNlPXtkYXRhYmFzZX1cbiAgICAgICAgICAgIGV4dGVuZGVkVGFibGVzPXt0YWJsZXN9XG4gICAgICAgICAgICBoZWlnaHQ9e2Ake2FjZUVkaXRvckhlaWdodH1weGB9XG4gICAgICAgICAgICBob3RrZXlzPXtob3RrZXlzfVxuICAgICAgICAgIC8+XG4gICAgICAgICAge3JlbmRlckVkaXRvckJvdHRvbUJhcihob3RrZXlzKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxTb3V0aFBhbmVcbiAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH1cbiAgICAgICAgICBsYXRlc3RRdWVyeUlkPXtsYXRlc3RRdWVyeT8uaWR9XG4gICAgICAgICAgaGVpZ2h0PXtzb3V0aFBhbmVIZWlnaHR9XG4gICAgICAgICAgZGlzcGxheUxpbWl0PXtkaXNwbGF5TGltaXR9XG4gICAgICAgICAgZGVmYXVsdFF1ZXJ5TGltaXQ9e2RlZmF1bHRRdWVyeUxpbWl0fVxuICAgICAgICAvPlxuICAgICAgPC9TcGxpdD5cbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZVZpZXdNb2RhbFRpdGxlID1cbiAgICBjcmVhdGVBcyA9PT0gQ3Rhc0VudW0uVklFVyA/ICdDUkVBVEUgVklFVyBBUycgOiAnQ1JFQVRFIFRBQkxFIEFTJztcblxuICBjb25zdCBjcmVhdGVNb2RhbFBsYWNlSG9sZGVyID1cbiAgICBjcmVhdGVBcyA9PT0gQ3Rhc0VudW0uVklFV1xuICAgICAgPyB0KCdTcGVjaWZ5IG5hbWUgdG8gQ1JFQVRFIFZJRVcgQVMgc2NoZW1hIGluOiBwdWJsaWMnKVxuICAgICAgOiB0KCdTcGVjaWZ5IG5hbWUgdG8gQ1JFQVRFIFRBQkxFIEFTIHNjaGVtYSBpbjogcHVibGljJyk7XG5cbiAgY29uc3QgbGVmdEJhclN0YXRlQ2xhc3MgPSBoaWRlTGVmdEJhclxuICAgID8gJ3NjaGVtYVBhbmUtZXhpdC1kb25lJ1xuICAgIDogJ3NjaGVtYVBhbmUtZW50ZXItZG9uZSc7XG4gIHJldHVybiAoXG4gICAgPFN0eWxlZFNxbEVkaXRvciByZWY9e3NxbEVkaXRvclJlZn0gY2xhc3NOYW1lPVwiU3FsRWRpdG9yXCI+XG4gICAgICA8Q1NTVHJhbnNpdGlvbiBjbGFzc05hbWVzPVwic2NoZW1hUGFuZVwiIGluPXshaGlkZUxlZnRCYXJ9IHRpbWVvdXQ9ezMwMH0+XG4gICAgICAgIDxSZXNpemFibGVTaWRlYmFyXG4gICAgICAgICAgaWQ9e2BzcWxsYWI6JHtxdWVyeUVkaXRvci5pZH1gfVxuICAgICAgICAgIG1pbldpZHRoPXtTUUxfRURJVE9SX0xFRlRCQVJfV0lEVEh9XG4gICAgICAgICAgaW5pdGlhbFdpZHRoPXtTUUxfRURJVE9SX0xFRlRCQVJfV0lEVEh9XG4gICAgICAgICAgZW5hYmxlPXshaGlkZUxlZnRCYXJ9XG4gICAgICAgID5cbiAgICAgICAgICB7YWRqdXN0ZWRXaWR0aCA9PiAoXG4gICAgICAgICAgICA8U3R5bGVkU2lkZWJhclxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2BzY2hlbWFQYW5lICR7bGVmdEJhclN0YXRlQ2xhc3N9YH1cbiAgICAgICAgICAgICAgd2lkdGg9e2FkanVzdGVkV2lkdGh9XG4gICAgICAgICAgICAgIGhpZGU9e2hpZGVMZWZ0QmFyfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8U3FsRWRpdG9yTGVmdEJhclxuICAgICAgICAgICAgICAgIGRhdGFiYXNlPXtkYXRhYmFzZX1cbiAgICAgICAgICAgICAgICBxdWVyeUVkaXRvcklkPXtxdWVyeUVkaXRvci5pZH1cbiAgICAgICAgICAgICAgICB0YWJsZXM9e3RhYmxlc31cbiAgICAgICAgICAgICAgICBzZXRFbXB0eVN0YXRlPXtib29sID0+IHNldFNob3dFbXB0eVN0YXRlKGJvb2wpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9TdHlsZWRTaWRlYmFyPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvUmVzaXphYmxlU2lkZWJhcj5cbiAgICAgIDwvQ1NTVHJhbnNpdGlvbj5cbiAgICAgIHtzaG93RW1wdHlTdGF0ZSA/IChcbiAgICAgICAgPEVtcHR5U3RhdGVCaWdcbiAgICAgICAgICBpbWFnZT1cInZlY3Rvci5zdmdcIlxuICAgICAgICAgIHRpdGxlPXt0KCdTZWxlY3QgYSBkYXRhYmFzZSB0byB3cml0ZSBhIHF1ZXJ5Jyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnQ2hvb3NlIG9uZSBvZiB0aGUgYXZhaWxhYmxlIGRhdGFiYXNlcyBmcm9tIHRoZSBwYW5lbCBvbiB0aGUgbGVmdC4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICApIDogKFxuICAgICAgICBxdWVyeVBhbmUoKVxuICAgICAgKX1cbiAgICAgIDxNb2RhbFxuICAgICAgICB2aXNpYmxlPXtzaG93Q3JlYXRlQXNNb2RhbH1cbiAgICAgICAgdGl0bGU9e3QoY3JlYXRlVmlld01vZGFsVGl0bGUpfVxuICAgICAgICBvbkhpZGU9eygpID0+IHNldFNob3dDcmVhdGVBc01vZGFsKGZhbHNlKX1cbiAgICAgICAgZm9vdGVyPXtcbiAgICAgICAgICA8PlxuICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRTaG93Q3JlYXRlQXNNb2RhbChmYWxzZSl9PlxuICAgICAgICAgICAgICB7dCgnQ2FuY2VsJyl9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIHtjcmVhdGVBcyA9PT0gQ3Rhc0VudW0uVEFCTEUgJiYgKFxuICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgYnV0dG9uU3R5bGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17Y3Rhcy5sZW5ndGggPT09IDB9XG4gICAgICAgICAgICAgICAgb25DbGljaz17Y3JlYXRlVGFibGVBc31cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt0KCdDcmVhdGUnKX1cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge2NyZWF0ZUFzID09PSBDdGFzRW51bS5WSUVXICYmIChcbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2N0YXMubGVuZ3RoID09PSAwfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2NyZWF0ZVZpZXdBc31cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt0KCdDcmVhdGUnKX1cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvPlxuICAgICAgICB9XG4gICAgICA+XG4gICAgICAgIDxzcGFuPnt0KCdOYW1lJyl9PC9zcGFuPlxuICAgICAgICA8SW5wdXQgcGxhY2Vob2xkZXI9e2NyZWF0ZU1vZGFsUGxhY2VIb2xkZXJ9IG9uQ2hhbmdlPXtjdGFzQ2hhbmdlZH0gLz5cbiAgICAgIDwvTW9kYWw+XG4gICAgPC9TdHlsZWRTcWxFZGl0b3I+XG4gICk7XG59O1xuXG5TcWxFZGl0b3IucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuXG5leHBvcnQgZGVmYXVsdCBTcWxFZGl0b3I7XG4iXX0= */\") },\n      ___EmotionJSX(Menu.Item, { css: _ref13 },\n      ' ',\n      ___EmotionJSX(\"span\", null, t('Autocomplete')), ' ',\n      ___EmotionJSX(AntdSwitch, {\n        checked: autocompleteEnabled,\n        onChange: handleToggleAutocompleteEnabled,\n        name: \"autocomplete-switch\" }),\n      ' '),\n\n      isFeatureEnabled(FeatureFlag.ENABLE_TEMPLATE_PROCESSING) &&\n      ___EmotionJSX(Menu.Item, null,\n      ___EmotionJSX(TemplateParamsEditor, {\n        language: \"json\",\n        onChange: (params) => {\n          dispatch(queryEditorSetTemplateParams(qe, params));\n        },\n        queryEditorId: qe.id })),\n\n\n\n      !_isEmpty(scheduledQueriesConf) &&\n      ___EmotionJSX(Menu.Item, null,\n      ___EmotionJSX(ScheduleQueryButton, {\n        defaultLabel: qe.name,\n        sql: qe.sql,\n        onSchedule: (query) => dispatch(scheduleQuery(query)),\n        schema: qe.schema,\n        dbId: qe.dbId,\n        scheduleQueryWarning: scheduleQueryWarning,\n        tooltip: scheduleToolTip,\n        disabled: !successful }))));\n\n\n\n\n\n  };\n\n  const onSaveQuery = async (query, clientId) => {\n    const savedQuery = await dispatch(saveQuery(query, clientId));\n    dispatch(addSavedQueryToTabState(queryEditor, savedQuery));\n  };\n\n  const renderEditorBottomBar = () => {var _latestQuery$results;\n    const { allow_ctas: allowCTAS, allow_cvas: allowCVAS } = database || {};\n\n    const showMenu = allowCTAS || allowCVAS;\n    const runMenuBtn =\n    ___EmotionJSX(Menu, null,\n    allowCTAS &&\n    ___EmotionJSX(Menu.Item, {\n      onClick: () => {\n        setShowCreateAsModal(true);\n        setCreateAs(CtasEnum.TABLE);\n      },\n      key: \"1\" },\n\n    t('CREATE TABLE AS')),\n\n\n    allowCVAS &&\n    ___EmotionJSX(Menu.Item, {\n      onClick: () => {\n        setShowCreateAsModal(true);\n        setCreateAs(CtasEnum.VIEW);\n      },\n      key: \"2\" },\n\n    t('CREATE VIEW AS')));\n\n\n\n\n\n    return (\n      ___EmotionJSX(StyledToolbar, { className: \"sql-toolbar\", id: \"js-sql-toolbar\" },\n      ___EmotionJSX(\"div\", { className: \"leftItems\" },\n      ___EmotionJSX(\"span\", null,\n      ___EmotionJSX(RunQueryActionButton, {\n        allowAsync: database ? database.allow_run_async : false,\n        queryEditorId: queryEditor.id,\n        queryState: latestQuery == null ? void 0 : latestQuery.state,\n        runQuery: runQuery,\n        stopQuery: stopQuery,\n        overlayCreateAsMenu: showMenu ? runMenuBtn : null })),\n\n\n      isFeatureEnabled(FeatureFlag.ESTIMATE_QUERY_COST) && (\n      database == null ? void 0 : database.allows_cost_estimate) &&\n      ___EmotionJSX(\"span\", null,\n      ___EmotionJSX(EstimateQueryCostButton, {\n        getEstimate: getQueryCostEstimate,\n        queryEditorId: queryEditor.id,\n        tooltip: t('Estimate the cost before running a query') })),\n\n\n\n      ___EmotionJSX(\"span\", null,\n      ___EmotionJSX(QueryLimitSelect, {\n        queryEditorId: queryEditor.id,\n        maxRow: maxRow,\n        defaultQueryLimit: defaultQueryLimit })),\n\n\n      latestQuery &&\n      ___EmotionJSX(Timer, {\n        startTime: latestQuery.startDttm,\n        endTime: latestQuery.endDttm,\n        state: STATE_TYPE_MAP[latestQuery.state],\n        isRunning: latestQuery.state === 'running' })),\n\n\n\n      ___EmotionJSX(\"div\", { className: \"rightItems\" },\n      ___EmotionJSX(\"span\", null,\n      ___EmotionJSX(SaveQuery, {\n        queryEditorId: queryEditor.id,\n        columns: (latestQuery == null ? void 0 : (_latestQuery$results = latestQuery.results) == null ? void 0 : _latestQuery$results.columns) || [],\n        onSave: onSaveQuery,\n        onUpdate: (query, remoteId, id) =>\n        dispatch(updateSavedQuery(query, remoteId, id)),\n\n        saveQueryWarning: saveQueryWarning,\n        database: database })),\n\n\n      ___EmotionJSX(\"span\", null,\n      ___EmotionJSX(ShareSqlLabQuery, { queryEditorId: queryEditor.id })),\n\n      ___EmotionJSX(AntdDropdown, { overlay: renderDropdown(), trigger: \"click\" },\n      ___EmotionJSX(Icons.MoreHoriz, { iconColor: theme.colors.grayscale.base })))));\n\n\n\n\n  };\n\n  const queryPane = () => {\n    const hotkeys = getHotkeyConfig();\n    const { aceEditorHeight, southPaneHeight } =\n    getAceEditorAndSouthPaneHeights(height, northPercent, southPercent);\n    return (\n      ___EmotionJSX(Split, {\n        expandToMin: true,\n        className: \"queryPane\",\n        sizes: [northPercent, southPercent],\n        elementStyle: elementStyle,\n        minSize: 200,\n        direction: \"vertical\",\n        gutterSize: SQL_EDITOR_GUTTER_HEIGHT,\n        onDragStart: onResizeStart,\n        onDragEnd: onResizeEnd },\n\n      ___EmotionJSX(\"div\", { ref: northPaneRef, className: \"north-pane\" },\n      ___EmotionJSX(AceEditorWrapper, {\n        autocomplete: autocompleteEnabled,\n        onBlur: setQueryEditorAndSaveSql,\n        onChange: onSqlChanged,\n        queryEditorId: queryEditor.id,\n        database: database,\n        extendedTables: tables,\n        height: `${aceEditorHeight}px`,\n        hotkeys: hotkeys }),\n\n      renderEditorBottomBar(hotkeys)),\n\n      ___EmotionJSX(SouthPane, {\n        queryEditorId: queryEditor.id,\n        latestQueryId: latestQuery == null ? void 0 : latestQuery.id,\n        height: southPaneHeight,\n        displayLimit: displayLimit,\n        defaultQueryLimit: defaultQueryLimit })));\n\n\n\n  };\n\n  const createViewModalTitle =\n  createAs === CtasEnum.VIEW ? 'CREATE VIEW AS' : 'CREATE TABLE AS';\n\n  const createModalPlaceHolder =\n  createAs === CtasEnum.VIEW ?\n  t('Specify name to CREATE VIEW AS schema in: public') :\n  t('Specify name to CREATE TABLE AS schema in: public');\n\n  const leftBarStateClass = hideLeftBar ?\n  'schemaPane-exit-done' :\n  'schemaPane-enter-done';\n  return (\n    ___EmotionJSX(StyledSqlEditor, { ref: sqlEditorRef, className: \"SqlEditor\" },\n    ___EmotionJSX(CSSTransition, { classNames: \"schemaPane\", in: !hideLeftBar, timeout: 300 },\n    ___EmotionJSX(ResizableSidebar, {\n      id: `sqllab:${queryEditor.id}`,\n      minWidth: SQL_EDITOR_LEFTBAR_WIDTH,\n      initialWidth: SQL_EDITOR_LEFTBAR_WIDTH,\n      enable: !hideLeftBar },\n\n    (adjustedWidth) =>\n    ___EmotionJSX(StyledSidebar, {\n      className: `schemaPane ${leftBarStateClass}`,\n      width: adjustedWidth,\n      hide: hideLeftBar },\n\n    ___EmotionJSX(SqlEditorLeftBar, {\n      database: database,\n      queryEditorId: queryEditor.id,\n      tables: tables,\n      setEmptyState: (bool) => setShowEmptyState(bool) })))),\n\n\n\n\n\n    showEmptyState ?\n    ___EmotionJSX(EmptyStateBig, {\n      image: \"vector.svg\",\n      title: t('Select a database to write a query'),\n      description: t(\n      'Choose one of the available databases from the panel on the left.') }) :\n\n\n\n    queryPane(),\n\n    ___EmotionJSX(Modal, {\n      visible: showCreateAsModal,\n      title: t(createViewModalTitle),\n      onHide: () => setShowCreateAsModal(false),\n      footer:\n      ___EmotionJSX(React.Fragment, null,\n      ___EmotionJSX(Button, { onClick: () => setShowCreateAsModal(false) },\n      t('Cancel')),\n\n      createAs === CtasEnum.TABLE &&\n      ___EmotionJSX(Button, {\n        buttonStyle: \"primary\",\n        disabled: ctas.length === 0,\n        onClick: createTableAs },\n\n      t('Create')),\n\n\n      createAs === CtasEnum.VIEW &&\n      ___EmotionJSX(Button, {\n        buttonStyle: \"primary\",\n        disabled: ctas.length === 0,\n        onClick: createViewAs },\n\n      t('Create'))) },\n\n\n\n\n\n    ___EmotionJSX(\"span\", null, t('Name')),\n    ___EmotionJSX(Input, { placeholder: createModalPlaceHolder, onChange: ctasChanged }))));\n\n\n\n};__signature__(SqlEditor, \"useTheme{theme}\\nuseDispatch{dispatch}\\nuseSelector{{ database, latestQuery, hideLeftBar }}\\nuseState{[height, setHeight](0)}\\nuseState{[autorun, setAutorun](queryEditor.autorun)}\\nuseState{[ctas, setCtas]('')}\\nuseState{[northPercent, setNorthPercent](queryEditor.northPercent || INITIAL_NORTH_PERCENT)}\\nuseState{[southPercent, setSouthPercent](queryEditor.southPercent || INITIAL_SOUTH_PERCENT)}\\nuseState{[autocompleteEnabled, setAutocompleteEnabled](getItem(LocalStorageKeys.sqllab__is_autocomplete_enabled, true))}\\nuseState{[showCreateAsModal, setShowCreateAsModal](false)}\\nuseState{[createAs, setCreateAs]('')}\\nuseState{[showEmptyState, setShowEmptyState](false)}\\nuseRef{sqlEditorRef}\\nuseRef{northPaneRef}\\nuseCallback{startQuery}\\nuseCallback{stopQuery}\\nuseEffect{}\\nuseCallback{getHotkeyConfig}\\nuseEffectEvent{onBeforeUnload}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseCallback{setQueryEditorAndSaveSql}\\nuseMemo{setQueryEditorAndSaveSqlWithDebounce}\\nuseCallback{requestValidation}\\nuseMemo{requestValidationWithDebounce}\", () => [useTheme, useDispatch, useSelector, useEffectEvent]);\n\nSqlEditor.propTypes = propTypes;const _default =\n\nSqlEditor;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(bootstrapData, \"bootstrapData\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(validatorMap, \"validatorMap\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(scheduledQueriesConf, \"scheduledQueriesConf\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(StyledToolbar, \"StyledToolbar\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(StyledSidebar, \"StyledSidebar\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(StyledSqlEditor, \"StyledSqlEditor\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(SqlEditor, \"SqlEditor\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");reactHotLoader.register(_default, \"default\", \"/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","useCallback","useEffectEvent","CSSTransition","shallowEqual","useDispatch","useSelector","PropTypes","Split","css","FeatureFlag","styled","t","useTheme","debounce","throttle","Modal","Mousetrap","Button","Timer","ResizableSidebar","AntdDropdown","AntdSwitch","Input","Menu","Icons","detectOS","addNewQueryEditor","CtasEnum","estimateQueryCost","persistEditorHeight","postStopQuery","queryEditorSetAutorun","queryEditorSetSql","queryEditorSetAndSaveSql","queryEditorSetTemplateParams","runQueryFromSqlEditor","saveQuery","addSavedQueryToTabState","scheduleQuery","setActiveSouthPaneTab","updateSavedQuery","validateQuery","STATE_TYPE_MAP","SQL_EDITOR_GUTTER_HEIGHT","SQL_EDITOR_GUTTER_MARGIN","SQL_TOOLBAR_HEIGHT","SQL_EDITOR_LEFTBAR_WIDTH","SQL_EDITOR_PADDING","INITIAL_NORTH_PERCENT","INITIAL_SOUTH_PERCENT","SET_QUERY_EDITOR_SQL_DEBOUNCE_MS","VALIDATION_DEBOUNCE_MS","WINDOW_RESIZE_THROTTLE_MS","getItem","LocalStorageKeys","setItem","isFeatureEnabled","EmptyStateBig","getBootstrapData","TemplateParamsEditor","SouthPane","SaveQuery","ScheduleQueryButton","EstimateQueryCostButton","ShareSqlLabQuery","SqlEditorLeftBar","AceEditorWrapper","RunQueryActionButton","QueryLimitSelect","bootstrapData","validatorMap","common","conf","SQL_VALIDATORS_BY_ENGINE","scheduledQueriesConf","SCHEDULED_QUERIES","StyledToolbar","div","theme","gridUnit","colors","grayscale","light5","light2","StyledSidebar","width","hide","StyledSqlEditor","transitionTiming","propTypes","tables","array","isRequired","queryEditor","object","defaultQueryLimit","number","maxRow","displayLimit","saveQueryWarning","string","scheduleQueryWarning","SqlEditor","dispatch","database","latestQuery","hideLeftBar","sqlLab","unsavedQueryEditor","databases","queries","dbId","latestQueryId","id","height","setHeight","autorun","setAutorun","ctas","setCtas","northPercent","setNorthPercent","southPercent","setSouthPercent","autocompleteEnabled","setAutocompleteEnabled","sqllab__is_autocomplete_enabled","showCreateAsModal","setShowCreateAsModal","createAs","setCreateAs","showEmptyState","setShowEmptyState","sqlEditorRef","northPaneRef","startQuery","ctasArg","ctas_method","TABLE","stopQuery","indexOf","state","runQuery","getSqlEditorHeight","current","clientHeight","getHotkeyConfig","userOS","base","name","key","descr","func","sql","trim","push","editor","navigateUp","onBeforeUnload","event","extra_json","cancel_query_on_windows_unload","preventDefault","handleWindowResizeWithThrottle","window","addEventListener","removeEventListener","reset","hotkeys","forEach","keyConfig","bind","onResizeStart","document","getElementsByClassName","style","onResizeEnd","setQueryEditorAndSaveSql","setQueryEditorAndSaveSqlWithDebounce","canValidateQuery","hasOwnProperty","backend","requestValidation","requestValidationWithDebounce","onSqlChanged","getAceEditorAndSouthPaneHeights","aceEditorHeight","southPaneHeight","getQueryCostEstimate","handleToggleAutocompleteEnabled","elementStyle","dimension","elementSize","gutterSize","createTableAs","createViewAs","VIEW","ctasChanged","target","value","renderDropdown","qe","successful","scheduleToolTip","ENABLE_TEMPLATE_PROCESSING","params","query","schema","onSaveQuery","clientId","savedQuery","renderEditorBottomBar","allow_ctas","allowCTAS","allow_cvas","allowCVAS","showMenu","runMenuBtn","allow_run_async","ESTIMATE_QUERY_COST","allows_cost_estimate","startDttm","endDttm","results","columns","remoteId","queryPane","createViewModalTitle","createModalPlaceHolder","leftBarStateClass","adjustedWidth","bool","length"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/SqlLab/components/SqlEditor/index.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable jsx-a11y/anchor-is-valid */\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, {\n  useState,\n  useEffect,\n  useMemo,\n  useRef,\n  useCallback,\n} from 'react';\nimport useEffectEvent from 'src/hooks/useEffectEvent';\nimport { CSSTransition } from 'react-transition-group';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport Split from 'react-split';\nimport { css, FeatureFlag, styled, t, useTheme } from '@superset-ui/core';\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\nimport Modal from 'src/components/Modal';\nimport Mousetrap from 'mousetrap';\nimport Button from 'src/components/Button';\nimport Timer from 'src/components/Timer';\nimport ResizableSidebar from 'src/components/ResizableSidebar';\nimport { AntdDropdown, AntdSwitch } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport { Menu } from 'src/components/Menu';\nimport Icons from 'src/components/Icons';\nimport { detectOS } from 'src/utils/common';\nimport {\n  addNewQueryEditor,\n  CtasEnum,\n  estimateQueryCost,\n  persistEditorHeight,\n  postStopQuery,\n  queryEditorSetAutorun,\n  queryEditorSetSql,\n  queryEditorSetAndSaveSql,\n  queryEditorSetTemplateParams,\n  runQueryFromSqlEditor,\n  saveQuery,\n  addSavedQueryToTabState,\n  scheduleQuery,\n  setActiveSouthPaneTab,\n  updateSavedQuery,\n  validateQuery,\n} from 'src/SqlLab/actions/sqlLab';\nimport {\n  STATE_TYPE_MAP,\n  SQL_EDITOR_GUTTER_HEIGHT,\n  SQL_EDITOR_GUTTER_MARGIN,\n  SQL_TOOLBAR_HEIGHT,\n  SQL_EDITOR_LEFTBAR_WIDTH,\n  SQL_EDITOR_PADDING,\n  INITIAL_NORTH_PERCENT,\n  INITIAL_SOUTH_PERCENT,\n  SET_QUERY_EDITOR_SQL_DEBOUNCE_MS,\n  VALIDATION_DEBOUNCE_MS,\n  WINDOW_RESIZE_THROTTLE_MS,\n} from 'src/SqlLab/constants';\nimport {\n  getItem,\n  LocalStorageKeys,\n  setItem,\n} from 'src/utils/localStorageHelpers';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport { isEmpty } from 'lodash';\nimport TemplateParamsEditor from '../TemplateParamsEditor';\nimport SouthPane from '../SouthPane';\nimport SaveQuery from '../SaveQuery';\nimport ScheduleQueryButton from '../ScheduleQueryButton';\nimport EstimateQueryCostButton from '../EstimateQueryCostButton';\nimport ShareSqlLabQuery from '../ShareSqlLabQuery';\nimport SqlEditorLeftBar from '../SqlEditorLeftBar';\nimport AceEditorWrapper from '../AceEditorWrapper';\nimport RunQueryActionButton from '../RunQueryActionButton';\nimport QueryLimitSelect from '../QueryLimitSelect';\n\nconst bootstrapData = getBootstrapData();\nconst validatorMap =\n  bootstrapData?.common?.conf?.SQL_VALIDATORS_BY_ENGINE || {};\nconst scheduledQueriesConf = bootstrapData?.common?.conf?.SCHEDULED_QUERIES;\n\nconst StyledToolbar = styled.div`\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n  background: ${({ theme }) => theme.colors.grayscale.light5};\n  display: flex;\n  justify-content: space-between;\n  border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  border-top: 0;\n\n  form {\n    margin-block-end: 0;\n  }\n\n  .leftItems,\n  .rightItems {\n    display: flex;\n    align-items: center;\n    & > span {\n      margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n      display: inline-block;\n\n      &:last-child {\n        margin-right: 0;\n      }\n    }\n  }\n\n  .limitDropdown {\n    white-space: nowrap;\n  }\n`;\n\nconst StyledSidebar = styled.div`\n  flex: 0 0 ${({ width }) => width}px;\n  width: ${({ width }) => width}px;\n  padding: ${({ theme, hide }) => (hide ? 0 : theme.gridUnit * 2.5)}px;\n  border-right: 1px solid\n    ${({ theme, hide }) =>\n      hide ? 'transparent' : theme.colors.grayscale.light2};\n`;\n\nconst StyledSqlEditor = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    flex-direction: row;\n    height: 100%;\n\n    .schemaPane {\n      transition: transform ${theme.transitionTiming}s ease-in-out;\n    }\n\n    .queryPane {\n      flex: 1 1 auto;\n      padding: ${theme.gridUnit * 2}px;\n      overflow-y: auto;\n      overflow-x: scroll;\n    }\n\n    .schemaPane-enter-done,\n    .schemaPane-exit {\n      transform: translateX(0);\n      z-index: 7;\n    }\n\n    .schemaPane-exit-active {\n      transform: translateX(-120%);\n    }\n\n    .schemaPane-enter-active {\n      transform: translateX(0);\n      max-width: ${theme.gridUnit * 75}px;\n    }\n\n    .schemaPane-enter,\n    .schemaPane-exit-done {\n      max-width: 0;\n      transform: translateX(-120%);\n      overflow: hidden;\n    }\n\n    .schemaPane-exit-done + .queryPane {\n      margin-left: 0;\n    }\n\n    .gutter {\n      border-top: 1px solid ${theme.colors.grayscale.light2};\n      border-bottom: 1px solid ${theme.colors.grayscale.light2};\n      width: 3%;\n      margin: ${SQL_EDITOR_GUTTER_MARGIN}px 47%;\n    }\n\n    .gutter.gutter-vertical {\n      cursor: row-resize;\n    }\n  `}\n`;\n\nconst propTypes = {\n  tables: PropTypes.array.isRequired,\n  queryEditor: PropTypes.object.isRequired,\n  defaultQueryLimit: PropTypes.number.isRequired,\n  maxRow: PropTypes.number.isRequired,\n  displayLimit: PropTypes.number.isRequired,\n  saveQueryWarning: PropTypes.string,\n  scheduleQueryWarning: PropTypes.string,\n};\n\nconst SqlEditor = ({\n  tables,\n  queryEditor,\n  defaultQueryLimit,\n  maxRow,\n  displayLimit,\n  saveQueryWarning,\n  scheduleQueryWarning = null,\n}) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n\n  const { database, latestQuery, hideLeftBar } = useSelector(\n    ({ sqlLab: { unsavedQueryEditor, databases, queries } }) => {\n      let { dbId, latestQueryId, hideLeftBar } = queryEditor;\n      if (unsavedQueryEditor.id === queryEditor.id) {\n        dbId = unsavedQueryEditor.dbId || dbId;\n        latestQueryId = unsavedQueryEditor.latestQueryId || latestQueryId;\n        hideLeftBar = unsavedQueryEditor.hideLeftBar || hideLeftBar;\n      }\n      return {\n        database: databases[dbId],\n        latestQuery: queries[latestQueryId],\n        hideLeftBar,\n      };\n    },\n    shallowEqual,\n  );\n\n  const [height, setHeight] = useState(0);\n  const [autorun, setAutorun] = useState(queryEditor.autorun);\n  const [ctas, setCtas] = useState('');\n  const [northPercent, setNorthPercent] = useState(\n    queryEditor.northPercent || INITIAL_NORTH_PERCENT,\n  );\n  const [southPercent, setSouthPercent] = useState(\n    queryEditor.southPercent || INITIAL_SOUTH_PERCENT,\n  );\n  const [autocompleteEnabled, setAutocompleteEnabled] = useState(\n    getItem(LocalStorageKeys.sqllab__is_autocomplete_enabled, true),\n  );\n  const [showCreateAsModal, setShowCreateAsModal] = useState(false);\n  const [createAs, setCreateAs] = useState('');\n  const [showEmptyState, setShowEmptyState] = useState(false);\n\n  const sqlEditorRef = useRef(null);\n  const northPaneRef = useRef(null);\n\n  const startQuery = useCallback(\n    (ctasArg = false, ctas_method = CtasEnum.TABLE) => {\n      if (!database) {\n        return;\n      }\n\n      dispatch(\n        runQueryFromSqlEditor(\n          database,\n          queryEditor,\n          defaultQueryLimit,\n          ctasArg ? ctas : '',\n          ctasArg,\n          ctas_method,\n        ),\n      );\n      dispatch(setActiveSouthPaneTab('Results'));\n    },\n    [ctas, database, defaultQueryLimit, dispatch, queryEditor],\n  );\n\n  const stopQuery = useCallback(() => {\n    if (latestQuery && ['running', 'pending'].indexOf(latestQuery.state) >= 0) {\n      dispatch(postStopQuery(latestQuery));\n    }\n    return false;\n  }, [dispatch, latestQuery]);\n\n  const runQuery = () => {\n    if (database) {\n      startQuery();\n    }\n  };\n\n  useEffect(() => {\n    if (autorun) {\n      setAutorun(false);\n      dispatch(queryEditorSetAutorun(queryEditor, false));\n      startQuery();\n    }\n  }, [autorun, dispatch, queryEditor, startQuery]);\n\n  // One layer of abstraction for easy spying in unit tests\n  const getSqlEditorHeight = () =>\n    sqlEditorRef.current\n      ? sqlEditorRef.current.clientHeight - SQL_EDITOR_PADDING * 2\n      : 0;\n\n  const getHotkeyConfig = useCallback(() => {\n    // Get the user's OS\n    const userOS = detectOS();\n    const base = [\n      {\n        name: 'runQuery1',\n        key: 'ctrl+r',\n        descr: t('Run query'),\n        func: () => {\n          if (queryEditor.sql.trim() !== '') {\n            startQuery();\n          }\n        },\n      },\n      {\n        name: 'runQuery2',\n        key: 'ctrl+enter',\n        descr: t('Run query'),\n        func: () => {\n          if (queryEditor.sql.trim() !== '') {\n            startQuery();\n          }\n        },\n      },\n      {\n        name: 'newTab',\n        key: userOS === 'Windows' ? 'ctrl+q' : 'ctrl+t',\n        descr: t('New tab'),\n        func: () => {\n          dispatch(addNewQueryEditor());\n        },\n      },\n      {\n        name: 'stopQuery',\n        key: userOS === 'MacOS' ? 'ctrl+x' : 'ctrl+e',\n        descr: t('Stop query'),\n        func: stopQuery,\n      },\n    ];\n\n    if (userOS === 'MacOS') {\n      base.push({\n        name: 'previousLine',\n        key: 'ctrl+p',\n        descr: t('Previous Line'),\n        func: editor => {\n          editor.navigateUp(1);\n        },\n      });\n    }\n\n    return base;\n  }, [dispatch, queryEditor.sql, startQuery, stopQuery]);\n\n  const onBeforeUnload = useEffectEvent(event => {\n    if (\n      database?.extra_json?.cancel_query_on_windows_unload &&\n      latestQuery?.state === 'running'\n    ) {\n      event.preventDefault();\n      stopQuery();\n    }\n  });\n\n  useEffect(() => {\n    // We need to measure the height of the sql editor post render to figure the height of\n    // the south pane so it gets rendered properly\n    setHeight(getSqlEditorHeight());\n    const handleWindowResizeWithThrottle = throttle(\n      () => setHeight(getSqlEditorHeight()),\n      WINDOW_RESIZE_THROTTLE_MS,\n    );\n\n    window.addEventListener('resize', handleWindowResizeWithThrottle);\n    window.addEventListener('beforeunload', onBeforeUnload);\n\n    return () => {\n      window.removeEventListener('resize', handleWindowResizeWithThrottle);\n      window.removeEventListener('beforeunload', onBeforeUnload);\n    };\n    // TODO: Remove useEffectEvent deps once https://github.com/facebook/react/pull/25881 is released\n  }, [onBeforeUnload]);\n\n  useEffect(() => {\n    if (!database || isEmpty(database)) {\n      setShowEmptyState(true);\n    }\n  }, [database]);\n\n  useEffect(() => {\n    // setup hotkeys\n    Mousetrap.reset();\n    const hotkeys = getHotkeyConfig();\n    hotkeys.forEach(keyConfig => {\n      Mousetrap.bind([keyConfig.key], keyConfig.func);\n    });\n  }, [getHotkeyConfig, latestQuery]);\n\n  const onResizeStart = () => {\n    // Set the heights on the ace editor and the ace content area after drag starts\n    // to smooth out the visual transition to the new heights when drag ends\n    document.getElementsByClassName('ace_content')[0].style.height = '100%';\n  };\n\n  const onResizeEnd = ([northPercent, southPercent]) => {\n    setNorthPercent(northPercent);\n    setSouthPercent(southPercent);\n\n    if (northPaneRef.current?.clientHeight) {\n      dispatch(persistEditorHeight(queryEditor, northPercent, southPercent));\n    }\n  };\n\n  const setQueryEditorAndSaveSql = useCallback(\n    sql => {\n      dispatch(queryEditorSetAndSaveSql(queryEditor, sql));\n    },\n    [dispatch, queryEditor],\n  );\n\n  const setQueryEditorAndSaveSqlWithDebounce = useMemo(\n    () => debounce(setQueryEditorAndSaveSql, SET_QUERY_EDITOR_SQL_DEBOUNCE_MS),\n    [setQueryEditorAndSaveSql],\n  );\n\n  const canValidateQuery = () => {\n    // Check whether or not we can validate the current query based on whether\n    // or not the backend has a validator configured for it.\n    if (database) {\n      return validatorMap.hasOwnProperty(database.backend);\n    }\n    return false;\n  };\n\n  const requestValidation = useCallback(\n    sql => {\n      if (database) {\n        dispatch(validateQuery(queryEditor, sql));\n      }\n    },\n    [database, dispatch, queryEditor],\n  );\n\n  const requestValidationWithDebounce = useMemo(\n    () => debounce(requestValidation, VALIDATION_DEBOUNCE_MS),\n    [requestValidation],\n  );\n\n  const onSqlChanged = sql => {\n    dispatch(queryEditorSetSql(queryEditor, sql));\n    setQueryEditorAndSaveSqlWithDebounce(sql);\n    // Request server-side validation of the query text\n    if (canValidateQuery()) {\n      // NB. requestValidation is debounced\n      requestValidationWithDebounce(sql);\n    }\n  };\n\n  // Return the heights for the ace editor and the south pane as an object\n  // given the height of the sql editor, north pane percent and south pane percent.\n  const getAceEditorAndSouthPaneHeights = (\n    height,\n    northPercent,\n    southPercent,\n  ) => ({\n    aceEditorHeight:\n      (height * northPercent) / (theme.gridUnit * 25) -\n      (SQL_EDITOR_GUTTER_HEIGHT / 2 + SQL_EDITOR_GUTTER_MARGIN) -\n      SQL_TOOLBAR_HEIGHT,\n    southPaneHeight:\n      (height * southPercent) / (theme.gridUnit * 25) -\n      (SQL_EDITOR_GUTTER_HEIGHT / 2 + SQL_EDITOR_GUTTER_MARGIN),\n  });\n\n  const getQueryCostEstimate = () => {\n    if (database) {\n      dispatch(estimateQueryCost(queryEditor));\n    }\n  };\n\n  const handleToggleAutocompleteEnabled = () => {\n    setItem(\n      LocalStorageKeys.sqllab__is_autocomplete_enabled,\n      !autocompleteEnabled,\n    );\n    setAutocompleteEnabled(!autocompleteEnabled);\n  };\n\n  const elementStyle = (dimension, elementSize, gutterSize) => ({\n    [dimension]: `calc(${elementSize}% - ${\n      gutterSize + SQL_EDITOR_GUTTER_MARGIN\n    }px)`,\n  });\n\n  const createTableAs = () => {\n    startQuery(true, CtasEnum.TABLE);\n    setShowCreateAsModal(false);\n    setCtas('');\n  };\n\n  const createViewAs = () => {\n    startQuery(true, CtasEnum.VIEW);\n    setShowCreateAsModal(false);\n    setCtas('');\n  };\n\n  const ctasChanged = event => {\n    setCtas(event.target.value);\n  };\n\n  const renderDropdown = () => {\n    const qe = queryEditor;\n    const successful = latestQuery?.state === 'success';\n    const scheduleToolTip = successful\n      ? t('Schedule the query periodically')\n      : t('You must run the query successfully first');\n    return (\n      <Menu css={{ width: theme.gridUnit * 44 }}>\n        <Menu.Item css={{ display: 'flex', justifyContent: 'space-between' }}>\n          {' '}\n          <span>{t('Autocomplete')}</span>{' '}\n          <AntdSwitch\n            checked={autocompleteEnabled}\n            onChange={handleToggleAutocompleteEnabled}\n            name=\"autocomplete-switch\"\n          />{' '}\n        </Menu.Item>\n        {isFeatureEnabled(FeatureFlag.ENABLE_TEMPLATE_PROCESSING) && (\n          <Menu.Item>\n            <TemplateParamsEditor\n              language=\"json\"\n              onChange={params => {\n                dispatch(queryEditorSetTemplateParams(qe, params));\n              }}\n              queryEditorId={qe.id}\n            />\n          </Menu.Item>\n        )}\n        {!isEmpty(scheduledQueriesConf) && (\n          <Menu.Item>\n            <ScheduleQueryButton\n              defaultLabel={qe.name}\n              sql={qe.sql}\n              onSchedule={query => dispatch(scheduleQuery(query))}\n              schema={qe.schema}\n              dbId={qe.dbId}\n              scheduleQueryWarning={scheduleQueryWarning}\n              tooltip={scheduleToolTip}\n              disabled={!successful}\n            />\n          </Menu.Item>\n        )}\n      </Menu>\n    );\n  };\n\n  const onSaveQuery = async (query, clientId) => {\n    const savedQuery = await dispatch(saveQuery(query, clientId));\n    dispatch(addSavedQueryToTabState(queryEditor, savedQuery));\n  };\n\n  const renderEditorBottomBar = () => {\n    const { allow_ctas: allowCTAS, allow_cvas: allowCVAS } = database || {};\n\n    const showMenu = allowCTAS || allowCVAS;\n    const runMenuBtn = (\n      <Menu>\n        {allowCTAS && (\n          <Menu.Item\n            onClick={() => {\n              setShowCreateAsModal(true);\n              setCreateAs(CtasEnum.TABLE);\n            }}\n            key=\"1\"\n          >\n            {t('CREATE TABLE AS')}\n          </Menu.Item>\n        )}\n        {allowCVAS && (\n          <Menu.Item\n            onClick={() => {\n              setShowCreateAsModal(true);\n              setCreateAs(CtasEnum.VIEW);\n            }}\n            key=\"2\"\n          >\n            {t('CREATE VIEW AS')}\n          </Menu.Item>\n        )}\n      </Menu>\n    );\n\n    return (\n      <StyledToolbar className=\"sql-toolbar\" id=\"js-sql-toolbar\">\n        <div className=\"leftItems\">\n          <span>\n            <RunQueryActionButton\n              allowAsync={database ? database.allow_run_async : false}\n              queryEditorId={queryEditor.id}\n              queryState={latestQuery?.state}\n              runQuery={runQuery}\n              stopQuery={stopQuery}\n              overlayCreateAsMenu={showMenu ? runMenuBtn : null}\n            />\n          </span>\n          {isFeatureEnabled(FeatureFlag.ESTIMATE_QUERY_COST) &&\n            database?.allows_cost_estimate && (\n              <span>\n                <EstimateQueryCostButton\n                  getEstimate={getQueryCostEstimate}\n                  queryEditorId={queryEditor.id}\n                  tooltip={t('Estimate the cost before running a query')}\n                />\n              </span>\n            )}\n          <span>\n            <QueryLimitSelect\n              queryEditorId={queryEditor.id}\n              maxRow={maxRow}\n              defaultQueryLimit={defaultQueryLimit}\n            />\n          </span>\n          {latestQuery && (\n            <Timer\n              startTime={latestQuery.startDttm}\n              endTime={latestQuery.endDttm}\n              state={STATE_TYPE_MAP[latestQuery.state]}\n              isRunning={latestQuery.state === 'running'}\n            />\n          )}\n        </div>\n        <div className=\"rightItems\">\n          <span>\n            <SaveQuery\n              queryEditorId={queryEditor.id}\n              columns={latestQuery?.results?.columns || []}\n              onSave={onSaveQuery}\n              onUpdate={(query, remoteId, id) =>\n                dispatch(updateSavedQuery(query, remoteId, id))\n              }\n              saveQueryWarning={saveQueryWarning}\n              database={database}\n            />\n          </span>\n          <span>\n            <ShareSqlLabQuery queryEditorId={queryEditor.id} />\n          </span>\n          <AntdDropdown overlay={renderDropdown()} trigger=\"click\">\n            <Icons.MoreHoriz iconColor={theme.colors.grayscale.base} />\n          </AntdDropdown>\n        </div>\n      </StyledToolbar>\n    );\n  };\n\n  const queryPane = () => {\n    const hotkeys = getHotkeyConfig();\n    const { aceEditorHeight, southPaneHeight } =\n      getAceEditorAndSouthPaneHeights(height, northPercent, southPercent);\n    return (\n      <Split\n        expandToMin\n        className=\"queryPane\"\n        sizes={[northPercent, southPercent]}\n        elementStyle={elementStyle}\n        minSize={200}\n        direction=\"vertical\"\n        gutterSize={SQL_EDITOR_GUTTER_HEIGHT}\n        onDragStart={onResizeStart}\n        onDragEnd={onResizeEnd}\n      >\n        <div ref={northPaneRef} className=\"north-pane\">\n          <AceEditorWrapper\n            autocomplete={autocompleteEnabled}\n            onBlur={setQueryEditorAndSaveSql}\n            onChange={onSqlChanged}\n            queryEditorId={queryEditor.id}\n            database={database}\n            extendedTables={tables}\n            height={`${aceEditorHeight}px`}\n            hotkeys={hotkeys}\n          />\n          {renderEditorBottomBar(hotkeys)}\n        </div>\n        <SouthPane\n          queryEditorId={queryEditor.id}\n          latestQueryId={latestQuery?.id}\n          height={southPaneHeight}\n          displayLimit={displayLimit}\n          defaultQueryLimit={defaultQueryLimit}\n        />\n      </Split>\n    );\n  };\n\n  const createViewModalTitle =\n    createAs === CtasEnum.VIEW ? 'CREATE VIEW AS' : 'CREATE TABLE AS';\n\n  const createModalPlaceHolder =\n    createAs === CtasEnum.VIEW\n      ? t('Specify name to CREATE VIEW AS schema in: public')\n      : t('Specify name to CREATE TABLE AS schema in: public');\n\n  const leftBarStateClass = hideLeftBar\n    ? 'schemaPane-exit-done'\n    : 'schemaPane-enter-done';\n  return (\n    <StyledSqlEditor ref={sqlEditorRef} className=\"SqlEditor\">\n      <CSSTransition classNames=\"schemaPane\" in={!hideLeftBar} timeout={300}>\n        <ResizableSidebar\n          id={`sqllab:${queryEditor.id}`}\n          minWidth={SQL_EDITOR_LEFTBAR_WIDTH}\n          initialWidth={SQL_EDITOR_LEFTBAR_WIDTH}\n          enable={!hideLeftBar}\n        >\n          {adjustedWidth => (\n            <StyledSidebar\n              className={`schemaPane ${leftBarStateClass}`}\n              width={adjustedWidth}\n              hide={hideLeftBar}\n            >\n              <SqlEditorLeftBar\n                database={database}\n                queryEditorId={queryEditor.id}\n                tables={tables}\n                setEmptyState={bool => setShowEmptyState(bool)}\n              />\n            </StyledSidebar>\n          )}\n        </ResizableSidebar>\n      </CSSTransition>\n      {showEmptyState ? (\n        <EmptyStateBig\n          image=\"vector.svg\"\n          title={t('Select a database to write a query')}\n          description={t(\n            'Choose one of the available databases from the panel on the left.',\n          )}\n        />\n      ) : (\n        queryPane()\n      )}\n      <Modal\n        visible={showCreateAsModal}\n        title={t(createViewModalTitle)}\n        onHide={() => setShowCreateAsModal(false)}\n        footer={\n          <>\n            <Button onClick={() => setShowCreateAsModal(false)}>\n              {t('Cancel')}\n            </Button>\n            {createAs === CtasEnum.TABLE && (\n              <Button\n                buttonStyle=\"primary\"\n                disabled={ctas.length === 0}\n                onClick={createTableAs}\n              >\n                {t('Create')}\n              </Button>\n            )}\n            {createAs === CtasEnum.VIEW && (\n              <Button\n                buttonStyle=\"primary\"\n                disabled={ctas.length === 0}\n                onClick={createViewAs}\n              >\n                {t('Create')}\n              </Button>\n            )}\n          </>\n        }\n      >\n        <span>{t('Name')}</span>\n        <Input placeholder={createModalPlaceHolder} onChange={ctasChanged} />\n      </Modal>\n    </StyledSqlEditor>\n  );\n};\n\nSqlEditor.propTypes = propTypes;\n\nexport default SqlEditor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}