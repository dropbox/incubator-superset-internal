{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Select } from 'src/components/DeprecatedSelect';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nexport default class OnPasteSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onPaste = this.onPaste.bind(this);\n  }\n\n  onPaste(evt) {\n    if (!this.props.isMulti) {\n      return;\n    }\n    evt.preventDefault();\n    const clipboard = evt.clipboardData.getData('Text');\n    if (!clipboard) {\n      return;\n    }\n    const regex = `[${this.props.separator}]+`;\n    const values = clipboard.split(new RegExp(regex)).map((v) => v.trim());\n    const validator = this.props.isValidNewOption;\n    const selected = this.props.value || [];\n    const existingOptions = {};\n    const existing = {};\n    this.props.options.forEach((v) => {\n      existingOptions[v[this.props.valueKey]] = 1;\n    });\n    let options = [];\n    selected.forEach((v) => {\n      options.push({ [this.props.labelKey]: v, [this.props.valueKey]: v });\n      existing[v] = 1;\n    });\n    options = options.concat(\n    values.\n    filter((v) => {\n      const notExists = !existing[v];\n      existing[v] = 1;\n      return (\n        notExists && (\n        validator ? validator({ [this.props.labelKey]: v }) : !!v));\n\n    }).\n    map((v) => {\n      const opt = { [this.props.labelKey]: v, [this.props.valueKey]: v };\n      if (!existingOptions[v]) {\n        this.props.options.unshift(opt);\n      }\n      return opt;\n    }));\n\n    if (options.length) {\n      if (this.props.onChange) {\n        this.props.onChange(options);\n      }\n    }\n  }\n\n  render() {\n    const { selectWrap: SelectComponent, ...restProps } = this.props;\n    return ___EmotionJSX(SelectComponent, _extends({}, restProps, { onPaste: this.onPaste }));\n  }}\n\n\nOnPasteSelect.propTypes = {\n  separator: PropTypes.array,\n  selectWrap: PropTypes.elementType,\n  selectRef: PropTypes.func,\n  onChange: PropTypes.func.isRequired,\n  valueKey: PropTypes.string,\n  labelKey: PropTypes.string,\n  options: PropTypes.array,\n  isMulti: PropTypes.bool,\n  value: PropTypes.any,\n  isValidNewOption: PropTypes.func,\n  noResultsText: PropTypes.string,\n  forceOverflow: PropTypes.bool };\n\nOnPasteSelect.defaultProps = {\n  separator: [',', '\\n', '\\t', ';'],\n  selectWrap: Select,\n  valueKey: 'value',\n  labelKey: 'label',\n  options: [],\n  isMulti: false };","map":{"version":3,"names":["React","PropTypes","Select","OnPasteSelect","Component","constructor","props","onPaste","bind","evt","isMulti","preventDefault","clipboard","clipboardData","getData","regex","separator","values","split","RegExp","map","v","trim","validator","isValidNewOption","selected","value","existingOptions","existing","options","forEach","valueKey","push","labelKey","concat","filter","notExists","opt","unshift","length","onChange","render","selectWrap","SelectComponent","restProps","propTypes","array","elementType","selectRef","func","isRequired","string","bool","any","noResultsText","forceOverflow","defaultProps"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/components/DeprecatedSelect/OnPasteSelect.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Select } from 'src/components/DeprecatedSelect';\n\nexport default class OnPasteSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onPaste = this.onPaste.bind(this);\n  }\n\n  onPaste(evt) {\n    if (!this.props.isMulti) {\n      return;\n    }\n    evt.preventDefault();\n    const clipboard = evt.clipboardData.getData('Text');\n    if (!clipboard) {\n      return;\n    }\n    const regex = `[${this.props.separator}]+`;\n    const values = clipboard.split(new RegExp(regex)).map(v => v.trim());\n    const validator = this.props.isValidNewOption;\n    const selected = this.props.value || [];\n    const existingOptions = {};\n    const existing = {};\n    this.props.options.forEach(v => {\n      existingOptions[v[this.props.valueKey]] = 1;\n    });\n    let options = [];\n    selected.forEach(v => {\n      options.push({ [this.props.labelKey]: v, [this.props.valueKey]: v });\n      existing[v] = 1;\n    });\n    options = options.concat(\n      values\n        .filter(v => {\n          const notExists = !existing[v];\n          existing[v] = 1;\n          return (\n            notExists &&\n            (validator ? validator({ [this.props.labelKey]: v }) : !!v)\n          );\n        })\n        .map(v => {\n          const opt = { [this.props.labelKey]: v, [this.props.valueKey]: v };\n          if (!existingOptions[v]) {\n            this.props.options.unshift(opt);\n          }\n          return opt;\n        }),\n    );\n    if (options.length) {\n      if (this.props.onChange) {\n        this.props.onChange(options);\n      }\n    }\n  }\n\n  render() {\n    const { selectWrap: SelectComponent, ...restProps } = this.props;\n    return <SelectComponent {...restProps} onPaste={this.onPaste} />;\n  }\n}\n\nOnPasteSelect.propTypes = {\n  separator: PropTypes.array,\n  selectWrap: PropTypes.elementType,\n  selectRef: PropTypes.func,\n  onChange: PropTypes.func.isRequired,\n  valueKey: PropTypes.string,\n  labelKey: PropTypes.string,\n  options: PropTypes.array,\n  isMulti: PropTypes.bool,\n  value: PropTypes.any,\n  isValidNewOption: PropTypes.func,\n  noResultsText: PropTypes.string,\n  forceOverflow: PropTypes.bool,\n};\nOnPasteSelect.defaultProps = {\n  separator: [',', '\\n', '\\t', ';'],\n  selectWrap: Select,\n  valueKey: 'value',\n  labelKey: 'label',\n  options: [],\n  isMulti: false,\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}