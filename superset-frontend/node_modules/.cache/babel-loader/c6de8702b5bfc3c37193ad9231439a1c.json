{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport {\ntoggleExpandSlice,\nsetFocusedFilterField,\nunsetFocusedFilterField } from\n'src/dashboard/actions/dashboardState';\nimport { updateComponents } from 'src/dashboard/actions/dashboardLayout';\nimport { changeFilter } from 'src/dashboard/actions/dashboardFilters';\nimport {\naddSuccessToast,\naddDangerToast } from\n'src/components/MessageToasts/actions';\nimport { refreshChart } from 'src/components/Chart/chartAction';\nimport { logEvent } from 'src/logger/actions';\nimport {\ngetActiveFilters,\ngetAppliedFilterValues } from\n'src/dashboard/util/activeDashboardFilters';\nimport getFormDataWithExtraFilters from 'src/dashboard/util/charts/getFormDataWithExtraFilters';\nimport Chart from 'src/dashboard/components/gridComponents/Chart';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\n\nconst EMPTY_OBJECT = {};\n\nfunction mapStateToProps(_ref,\n\n\n\n\n\n\n\n\n\n\nownProps)\n{var _dashboardInfo$metada, _dashboardInfo$metada2, _dashboardInfo$metada3, _dataMask$id, _dataMask$id2;let { charts: chartQueries, dashboardInfo, dashboardState, dataMask, datasources, sliceEntities, nativeFilters, common } = _ref;\n  const { id, extraControls, setControlValue } = ownProps;\n  const chart = chartQueries[id] || EMPTY_OBJECT;\n  const datasource =\n  chart && chart.form_data && datasources[chart.form_data.datasource] ||\n  PLACEHOLDER_DATASOURCE;\n  const { colorScheme, colorNamespace, datasetsStatus } = dashboardState;\n  const labelColors = (dashboardInfo == null ? void 0 : (_dashboardInfo$metada = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada.label_colors) || {};\n  const sharedLabelColors = (dashboardInfo == null ? void 0 : (_dashboardInfo$metada2 = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada2.shared_label_colors) || {};\n  // note: this method caches filters if possible to prevent render cascades\n  const formData = getFormDataWithExtraFilters({\n    chart,\n    chartConfiguration: (_dashboardInfo$metada3 = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada3.chart_configuration,\n    charts: chartQueries,\n    filters: getAppliedFilterValues(id),\n    colorScheme,\n    colorNamespace,\n    sliceId: id,\n    nativeFilters: nativeFilters == null ? void 0 : nativeFilters.filters,\n    allSliceIds: dashboardState.sliceIds,\n    dataMask,\n    extraControls,\n    labelColors,\n    sharedLabelColors });\n\n\n  formData.dashboardId = dashboardInfo.id;\n\n  return {\n    chart,\n    datasource,\n    labelColors,\n    sharedLabelColors,\n    slice: sliceEntities.slices[id],\n    timeout: dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT,\n    filters: getActiveFilters() || EMPTY_OBJECT,\n    formData,\n    editMode: dashboardState.editMode,\n    isExpanded: !!dashboardState.expandedSlices[id],\n    supersetCanExplore: !!dashboardInfo.superset_can_explore,\n    supersetCanShare: !!dashboardInfo.superset_can_share,\n    supersetCanCSV: !!dashboardInfo.superset_can_csv,\n    sliceCanEdit: !!dashboardInfo.slice_can_edit,\n    ownState: (_dataMask$id = dataMask[id]) == null ? void 0 : _dataMask$id.ownState,\n    filterState: (_dataMask$id2 = dataMask[id]) == null ? void 0 : _dataMask$id2.filterState,\n    maxRows: common.conf.SQL_MAX_ROW,\n    setControlValue,\n    datasetsStatus,\n    emitCrossFilters: !!dashboardInfo.crossFiltersEnabled };\n\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n  {\n    updateComponents,\n    addSuccessToast,\n    addDangerToast,\n    toggleExpandSlice,\n    changeFilter,\n    setFocusedFilterField,\n    unsetFocusedFilterField,\n    refreshChart,\n    logEvent },\n\n  dispatch);\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chart);","map":{"version":3,"names":["bindActionCreators","connect","toggleExpandSlice","setFocusedFilterField","unsetFocusedFilterField","updateComponents","changeFilter","addSuccessToast","addDangerToast","refreshChart","logEvent","getActiveFilters","getAppliedFilterValues","getFormDataWithExtraFilters","Chart","PLACEHOLDER_DATASOURCE","EMPTY_OBJECT","mapStateToProps","ownProps","charts","chartQueries","dashboardInfo","dashboardState","dataMask","datasources","sliceEntities","nativeFilters","common","id","extraControls","setControlValue","chart","datasource","form_data","colorScheme","colorNamespace","datasetsStatus","labelColors","metadata","label_colors","sharedLabelColors","shared_label_colors","formData","chartConfiguration","chart_configuration","filters","sliceId","allSliceIds","sliceIds","dashboardId","slice","slices","timeout","conf","SUPERSET_WEBSERVER_TIMEOUT","editMode","isExpanded","expandedSlices","supersetCanExplore","superset_can_explore","supersetCanShare","superset_can_share","supersetCanCSV","superset_can_csv","sliceCanEdit","slice_can_edit","ownState","filterState","maxRows","SQL_MAX_ROW","emitCrossFilters","crossFiltersEnabled","mapDispatchToProps","dispatch"],"sources":["/Users/bogdankyryliuk/code/opensource/superset/superset-frontend/src/dashboard/containers/Chart.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport {\n  toggleExpandSlice,\n  setFocusedFilterField,\n  unsetFocusedFilterField,\n} from 'src/dashboard/actions/dashboardState';\nimport { updateComponents } from 'src/dashboard/actions/dashboardLayout';\nimport { changeFilter } from 'src/dashboard/actions/dashboardFilters';\nimport {\n  addSuccessToast,\n  addDangerToast,\n} from 'src/components/MessageToasts/actions';\nimport { refreshChart } from 'src/components/Chart/chartAction';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  getActiveFilters,\n  getAppliedFilterValues,\n} from 'src/dashboard/util/activeDashboardFilters';\nimport getFormDataWithExtraFilters from 'src/dashboard/util/charts/getFormDataWithExtraFilters';\nimport Chart from 'src/dashboard/components/gridComponents/Chart';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\n\nconst EMPTY_OBJECT = {};\n\nfunction mapStateToProps(\n  {\n    charts: chartQueries,\n    dashboardInfo,\n    dashboardState,\n    dataMask,\n    datasources,\n    sliceEntities,\n    nativeFilters,\n    common,\n  },\n  ownProps,\n) {\n  const { id, extraControls, setControlValue } = ownProps;\n  const chart = chartQueries[id] || EMPTY_OBJECT;\n  const datasource =\n    (chart && chart.form_data && datasources[chart.form_data.datasource]) ||\n    PLACEHOLDER_DATASOURCE;\n  const { colorScheme, colorNamespace, datasetsStatus } = dashboardState;\n  const labelColors = dashboardInfo?.metadata?.label_colors || {};\n  const sharedLabelColors = dashboardInfo?.metadata?.shared_label_colors || {};\n  // note: this method caches filters if possible to prevent render cascades\n  const formData = getFormDataWithExtraFilters({\n    chart,\n    chartConfiguration: dashboardInfo.metadata?.chart_configuration,\n    charts: chartQueries,\n    filters: getAppliedFilterValues(id),\n    colorScheme,\n    colorNamespace,\n    sliceId: id,\n    nativeFilters: nativeFilters?.filters,\n    allSliceIds: dashboardState.sliceIds,\n    dataMask,\n    extraControls,\n    labelColors,\n    sharedLabelColors,\n  });\n\n  formData.dashboardId = dashboardInfo.id;\n\n  return {\n    chart,\n    datasource,\n    labelColors,\n    sharedLabelColors,\n    slice: sliceEntities.slices[id],\n    timeout: dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT,\n    filters: getActiveFilters() || EMPTY_OBJECT,\n    formData,\n    editMode: dashboardState.editMode,\n    isExpanded: !!dashboardState.expandedSlices[id],\n    supersetCanExplore: !!dashboardInfo.superset_can_explore,\n    supersetCanShare: !!dashboardInfo.superset_can_share,\n    supersetCanCSV: !!dashboardInfo.superset_can_csv,\n    sliceCanEdit: !!dashboardInfo.slice_can_edit,\n    ownState: dataMask[id]?.ownState,\n    filterState: dataMask[id]?.filterState,\n    maxRows: common.conf.SQL_MAX_ROW,\n    setControlValue,\n    datasetsStatus,\n    emitCrossFilters: !!dashboardInfo.crossFiltersEnabled,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      updateComponents,\n      addSuccessToast,\n      addDangerToast,\n      toggleExpandSlice,\n      changeFilter,\n      setFocusedFilterField,\n      unsetFocusedFilterField,\n      refreshChart,\n      logEvent,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chart);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}