"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeLocate = void 0;
const driver_1 = require("@applitools/driver");
const take_screenshot_1 = require("./utils/take-screenshot");
function makeLocate({ spec, core, logger: defaultLogger, }) {
    return async function locate({ settings, target, logger = defaultLogger, }) {
        logger.log(`Command "locate" is called with settings`, settings);
        if (!(0, driver_1.isDriver)(target, spec)) {
            return core.locate({ target, settings: settings, logger });
        }
        const driver = (0, driver_1.isDriver)(target, spec) ? await (0, driver_1.makeDriver)({ spec, driver: target, logger }) : null;
        const screenshot = await (0, take_screenshot_1.takeScreenshot)({ driver, settings, logger });
        const baseTarget = { image: await screenshot.image.toPng() };
        const results = await core.locate({ target: baseTarget, settings: settings, logger });
        return results;
    };
}
exports.makeLocate = makeLocate;
