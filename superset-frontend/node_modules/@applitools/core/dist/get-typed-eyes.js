"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeGetTypedEyes = void 0;
function makeGetTypedEyes({ type: defaultType, settings: defaultSettings, target, cores, logger: defaultLogger, }) {
    let eyes;
    return async function getTypesEyes({ type = defaultType, settings, logger = defaultLogger, } = {}) {
        if (!eyes) {
            eyes =
                type === 'ufg'
                    ? await cores.ufg.openEyes({ target, settings: defaultSettings, logger })
                    : await cores.classic.openEyes({ target, settings: defaultSettings, logger });
            return eyes;
        }
        else if (eyes.type === type) {
            return eyes;
        }
        else if (type === 'ufg') {
            const baseEyes = await eyes.getBaseEyes();
            return cores.ufg.openEyes({ target, settings: defaultSettings, eyes: baseEyes, logger });
        }
        else {
            const baseEyes = (await Promise.all(settings.renderers.map(renderer => eyes.getBaseEyes({ settings: { type: settings.type, renderer } })))).flat();
            return cores.classic.openEyes({ target, settings: defaultSettings, eyes: baseEyes, logger });
        }
    };
}
exports.makeGetTypedEyes = makeGetTypedEyes;
