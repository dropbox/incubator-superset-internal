
# Changelog

## Unreleased

- Skips non-screen media queries
- Handle issues with wrongly placed shorthands while constructing css string from cssom
- export cjs modules as well as string scripts
- fix style programmatic generated fallback

## 4.6.2 - 2022/7/19

- Add (limited) support for 'slot' type elements in DOM

## 4.6.1 - 2022/7/7

- Fix MediaRecorder due to DOM Snapshot tool getting stuck on certain pages

## 4.6.0 - 2022/6/17

- Use MediaRecorder to get video from blob url or srcObject

## 4.5.13 - 2022/6/8

- Supporting special case of shadowRoot element

## 4.5.12 - 2022/1/6

- add fallback for the case when script has failed in sandbox

## 4.5.11 - 2021/11/17

- prevent useless deps of deps from bundling

## 4.5.10 - 2021/10/20

- fix url encoding/decoding
- updated to @applitools/dom-shared@1.0.8 (from 1.0.7)

## 4.5.9 - 2021/10/18

- try to fix `appendChild of null` exception in Cypress
- updated to @applitools/dom-shared@1.0.7 (from 1.0.6)

## 4.5.8 - 2021/9/22

 - decode all urls for blob arrays

## 4.5.7 - 2021/8/13

- fix bug in compareName

  ## 4.5.6 - 2021/8/3

 - send cdtNode to objects in imageBlobs array as we need the cdtNode when calling resetNodeAndResolve method 

## 4.5.5 - 2021/7/28

- include `baseUri` in snapshot

## 4.5.4 - 2021/7/7

- fix cssom psuedo class selector

## 4.5.3 - 2021/5/31

- handle `column-gap` and `row-gap` as aliases for deprecated `grid-gap` css property

## 4.5.2 - 2021/5/27

- fix tainted canvas attribute value

## 4.5.1 - 2021/5/12

- support relative urls in adopted stylesheets

## 4.5.0 - 2021/4/6

- split style property shorthands in `style` attribute

## 4.4.14 - 2021/3/15

- fix blob url in inline css text

## 4.4.13 - 2021/3/15

- fix response header validations

## 4.4.12 - 2021/3/9

- mark tainted canvas elements

## 4.4.11 - 2021/2/2

- add streaming resource timeout

## 4.4.10 - 2021/1/31

- fix: don't crash when empty canvas has styles

## 4.4.9 - 2021/1/31

- fix: filter empty canvas elements [trello](https://trello.com/c/t0Znt8sn)
- chore: add husky

## 4.4.8 - 2021/1/17

- fix base tag with basic authentication for css import ([Trello](https://trello.com/c/OyWRWqJm))

## 4.4.7 - 2021/1/13

- support reverse proxy URLs when processing font face rules in stylesheets

## 4.4.6 - 2021/1/12

- preserve original style property shorthands

## 4.4.5 - 2021/1/11

- fix base tag with basic authentication ([Trello](https://trello.com/c/OyWRWqJm))

## 4.4.4 - 2021/1/8

- Change the way URLs are captured from inline styles and stylesheet import rules ([Trello](https://trello.com/c/nlMUhJTp/682-eyes-testcafe-some-resources-missing-in-eyes-jobs-works-in-18x-of-testcafe-but-not-19x))

## 4.4.3 - 2021/1/3

- Transform animation shorthand to ie compatible syntax

## 4.4.2 - 2020/12/31

- catch errors in sandbox

## 4.4.1 - 2020/12/15

- add fallback for contexts with content-security-policy

## 4.4.0 - 2020/12/14

- fix the way native builtins are extracted

## 4.3.1 - 2020/12/10

- fix same-origin iframes URLs  [Trello](https://trello.com/c/3c1WsmZ4)
- fix `OPTION` tags `selected` attribute for wrapped node elements [Trello](https://trello.com/c/7IZ7xrWm)

## 4.3.0 - 2020/12/8

- support skip list

## 4.2.9 - 2020/12/4

- add `text-decoration` as a preferred shorthand to avoid usage of its longhands on IE

## 4.2.8 - 2020/12/3

- fix style property typo

## 4.2.7 - 2020/11/18

- protect script from Object and Array prototypes monkey patching

## 4.2.6 - 2020/11/10

- protect script from Element prototype monkey patching

## 4.2.5 - 2020/10/28

- handle revoked image blobs

## 4.2.4 - 2020/10/28

- Support indeterminate checkboxes

## 4.2.3 - 2020/10/25

- protect script scope from Set and Map monkey patching

## 4.2.2 - 2020/10/15

- better parsing inline styles

## 4.2.1 - 2020/10/13

- replace `crossFramesSelector` with `crossFrames`
- return index of the cross frame in `cdt` array alongside selector

## 4.2.0 - 2020/10/6

- fix inline frames
- extend current polling protocol to support chunking
- add `pollResult` script which could be used to avoid sending full script in case of polling
- add `serializeResources` and `compressResources` options for `processPage` script
- deprecate `processPageAndSerialize`, `processPageAndSerializePoll`, `processPageAndSerializeForIE` and `processPageAndSerializePollForIE` scripts

## 4.1.2 - 2020/10/6

- use strong selectors

## 4.1.1 - 2020/9/29

- handle inline frames with location href

## 4.1.0 - 2020/9/23

- support cross origin unframe

## 4.0.6 - 2020/9/2

- fix fake shadow dom null node ([Trello](https://trello.com/c/8DEaODgE))

## 4.0.5 - 2020/8/12

- fix exception in tainted canvas ([Trello](https://trello.com/c/HQXe3omq))
- fix adopted stylesheets css with shorthand css variable ([Trello](https://trello.com/c/a22B3tUB))

## 4.0.4 - 2020/8/9

- move to private repo
- add dist script: processPageAndSerializeCjs

## 4.0.3 - 2020/8/6

- change to exp_adoptedStyleSheets

## 4.0.2 - 2020/8/6

- support adoptedStyleSheets ([Trello](https://trello.com/c/cX4q0DzH) [Trello](https://trello.com/c/a22B3tUB))

## 4.0.1 - 2020/7/30

- fix faux shadow DOM
- fix url in css variable

## 4.0.0 - 2020/7/26

- support non-200 resources ([Trello](https://trello.com/c/J5lBWutP))

## 3.7.3 - 2020/7/23

- support src attribute in video tags

## 3.7.2 - 2020/7/22

- avoid removing single `?` from query param in resource urls (mainly to address `?#iefix`, see https://github.com/applitools/mono/issues/79)

## 3.7.1 - 2020/7/16

- fix selected options in select element ([Trello](https://trello.com/c/PftuuFqx))

## 3.7.0 - 2020/7/9

- support resource skip list ([Trello](https://trello.com/c/dz46CZM5/399-dom-snapshot-should-accept-a-skip-list-for-fetched-resources))

## 3.6.2 - 2020/7/7

- fix redirected frames

## 3.6.1 - 2020/7/5

- fix frames that were redirected with JavaScript ([Trello](https://trello.com/c/egprwtNp))

## 3.6.0 - 2020/6/29

- don't fetch google fonts

## 3.5.4 - 2020/6/28

- handle hanging resources ([Trello](https://trello.com/c/iDf2x25p/393-dom-snapshot-fails-to-resource-map-imported-hrefs))

## 3.5.3 - 2020/6/4

- fix dist scripts

## 3.5.2 - 2020/5/6

- fix bug when experimental longhands extracted from the cssom [Trello](https://trello.com/c/ASx8Bwd8/323-difference-in-gradient) [Trello](https://trello.com/c/wOytxwv4/346-ufg-safari-incorrect-render-repeated-image)

## 3.5.0 - 2020/4/30

- added data-applitools-disabled attribute to scripts and fixed disabled attribute for links  

## 3.4.5 - 2020/4/7

- fix missing audio tag src attribute resources

## 3.4.4 - 2020/4/7

- fix missing resources when dealing with fake shadow dom

## 3.4.3 - 2020/4/5

- fix javascript values returned from on<event> attributes

## 3.4.2

- fix shorthand mappings merge

## 3.4.1

- move css-tree from `devDependencies` to `dependencies` for eyes-testcafe
