{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/common.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/lib/common.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/lib/validators.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/vec3.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/index.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/mat4.js","webpack:///../loader-utils/src/index.ts","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/env/globals.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/vec4.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/lib/assert.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/lib/gl-matrix-extras.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/mat3.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/vec2.js","webpack:///../core/src/javascript-utils/is-type.ts","webpack:///../core/src/lib/loader-utils/option-utils.ts","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/euler.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/base/math-array.js","webpack:///../worker-utils/src/lib/env-utils/assert.ts","webpack:///../core/src/lib/loader-utils/normalize-loader.ts","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/env/is-browser.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/vector3.js","webpack:////home/user/apps/loaders.gl/node_modules/process/browser.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/env/is-electron.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/base/vector.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/matrix4.js","webpack:///(webpack)/buildin/global.js","webpack:///../core/src/lib/utils/resource-utils.ts","webpack:///./src/constants.ts","webpack:///./src/tileset/traversers/tileset-traverser.ts","webpack:////home/user/apps/loaders.gl/node_modules/@probe.gl/stats/dist/esm/lib/stat.js","webpack:////home/user/apps/loaders.gl/node_modules/@probe.gl/stats/dist/esm/lib/stats.js","webpack:////home/user/apps/loaders.gl/node_modules/@probe.gl/stats/dist/esm/utils/hi-res-timestamp.js","webpack:////home/user/apps/loaders.gl/node_modules/gl-matrix/esm/quat.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/quaternion.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/spherical-coordinates.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/pose.js","webpack:///../worker-utils/src/lib/env-utils/version.ts","webpack:///../core/src/lib/api/select-loader.ts","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/geospatial/dist/esm/constants.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/geospatial/dist/esm/type-utils.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/geospatial/dist/esm/ellipsoid/helpers/scale-to-geodetic-surface.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/geospatial/dist/esm/ellipsoid/helpers/ellipsoid-transform.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/geospatial/dist/esm/ellipsoid/ellipsoid.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/base/matrix.js","webpack:///../worker-utils/src/index.ts","webpack:///../worker-utils/src/lib/env-utils/globals.ts","webpack:///../worker-utils/src/lib/worker-farm/worker-thread.ts","webpack:///../worker-utils/src/lib/worker-utils/get-transfer-list.ts","webpack:///./src/tileset/tile-3d.ts","webpack:///../core/src/lib/fetch/fetch-file.ts","webpack:///../core/src/lib/fetch/write-file.ts","webpack:///../core/src/lib/api/parse.ts","webpack:///../core/src/lib/loader-utils/get-data.ts","webpack:///../core/src/lib/loader-utils/loader-context.ts","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/constants.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/bounding-volumes/axis-aligned-bounding-box.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/bounding-volumes/bounding-sphere.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/bounding-volumes/oriented-bounding-box.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/plane.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/culling-volume.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/perspective-off-center-frustum.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/perspective-frustum.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/algorithms/bounding-sphere-from-points.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/algorithms/compute-eigen-decomposition.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/culling/dist/esm/lib/algorithms/bounding-box-from-points.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/vector2.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/vector4.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/classes/matrix3.js","webpack:////home/user/apps/loaders.gl/node_modules/@math.gl/core/dist/esm/lib/math-utils.js","webpack:///../loader-utils/src/lib/env-utils/assert.ts","webpack:///../worker-utils/src/lib/worker-farm/worker-job.ts","webpack:///../worker-utils/src/lib/worker-farm/worker-farm.ts","webpack:///../worker-utils/src/lib/worker-farm/worker-pool.ts","webpack:///../worker-utils/src/lib/worker-farm/worker-body.ts","webpack:///../worker-utils/src/lib/worker-api/get-worker-url.ts","webpack:///../worker-utils/src/lib/async-queue/async-queue.ts","webpack:///../loader-utils/src/lib/binary-utils/get-first-characters.ts","webpack:///../loader-utils/src/lib/binary-utils/array-buffer-utils.ts","webpack:///../loader-utils/src/lib/binary-utils/memory-copy-utils.ts","webpack:///./src/tileset/tileset-cache.ts","webpack:///./src/tileset/helpers/transform-utils.ts","webpack:///./src/tileset/helpers/frame-state.ts","webpack:///../core/src/index.ts","webpack:///../core/src/lib/utils/response-utils.ts","webpack:///../core/src/lib/loader-utils/loggers.ts","webpack:///../core/src/lib/api/register-loaders.ts","webpack:///../core/src/iterators/make-iterator/make-iterator.ts","webpack:///../core/src/lib/api/parse-in-batches.ts","webpack:///../core/src/lib/api/encode.ts","webpack:///../core/src/iterators/make-stream/make-dom-stream.ts","webpack:///./src/tileset/helpers/bounding-volume.ts","webpack:///./src/tileset/helpers/i3s-lod.ts","webpack:///./src/bundle.ts","webpack:///./src/index.ts","webpack:///./src/tileset/tileset-3d.ts","webpack:///../loader-utils/src/lib/env-utils/globals.ts","webpack:///../loader-utils/src/lib/worker-loader-utils/create-loader-worker.ts","webpack:///../worker-utils/src/lib/worker-utils/get-loadable-worker-url.ts","webpack:///../worker-utils/src/lib/worker-api/process-on-worker.ts","webpack:///../worker-utils/src/lib/worker-utils/remove-nontransferable-options.ts","webpack:///../worker-utils/src/lib/worker-api/create-worker.ts","webpack:///../worker-utils/src/lib/worker-api/validate-worker-version.ts","webpack:///../worker-utils/src/lib/library-utils/library-utils.ts","webpack:///../loader-utils/src/lib/worker-loader-utils/parse-with-worker.ts","webpack:///../loader-utils/src/lib/parser-utils/parse-json.ts","webpack:///../loader-utils/src/lib/binary-utils/binary-copy-utils.ts","webpack:///../loader-utils/src/lib/binary-utils/encode-utils.ts","webpack:///../loader-utils/src/lib/iterators/text-iterators.ts","webpack:///../loader-utils/src/lib/iterators/async-iteration.ts","webpack:///../loader-utils/src/lib/request-utils/request-scheduler.ts","webpack:///../loader-utils/src/lib/path-utils/path.ts","webpack:///../loader-utils/src/lib/path-utils/file-aliases.ts","webpack:///../loader-utils/src/lib/binary-utils/buffer-utils.ts","webpack:///../loader-utils/src/json-loader.ts","webpack:///./src/utils/doubly-linked-list.js","webpack:///./src/utils/doubly-linked-list-node.js","webpack:///./src/tileset/helpers/zoom.ts","webpack:///../core/src/lib/utils/mime-type-utils.ts","webpack:///../core/src/lib/fetch/read-array-buffer.ts","webpack:///../core/src/lib/fetch/read-file.ts","webpack:///../core/src/lib/api/set-loader-options.ts","webpack:///../core/src/lib/loader-utils/option-defaults.ts","webpack:///../core/src/iterators/make-iterator/make-string-iterator.ts","webpack:///../core/src/iterators/make-iterator/make-array-buffer-iterator.ts","webpack:///../core/src/iterators/make-iterator/make-blob-iterator.ts","webpack:///../core/src/iterators/make-iterator/make-stream-iterator.ts","webpack:///../core/src/lib/api/parse-sync.ts","webpack:///../core/src/lib/api/load.ts","webpack:///../core/src/lib/api/load-in-batches.ts","webpack:///../core/src/lib/api/save.ts","webpack:///../core/src/iterators/make-stream/make-stream.ts","webpack:///../core/src/null-loader.ts","webpack:///../core/src/lib/progress/fetch-progress.ts","webpack:///../core/src/lib/filesystems/browser-filesystem.ts","webpack:///./src/tileset/helpers/tiles-3d-lod.ts","webpack:///./src/tileset/helpers/3d-tiles-options.ts","webpack:///./src/utils/managed-array.js","webpack:///./src/tileset/traversers/tileset-3d-traverser.ts","webpack:///./src/tileset/traversers/i3s-tileset-traverser.ts","webpack:///./src/tileset/traversers/i3s-tile-manager.ts","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/globals.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/local-storage.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/formatters.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/color.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/autobind.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/assert.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/utils/hi-res-timestamp.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/lib/log.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/env/get-browser.js","webpack:////home/user/apps/loaders.gl/node_modules/probe.gl/dist/esm/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","EPSILON","ARRAY_TYPE","Float32Array","Array","RANDOM","Math","random","PI","hypot","y","arguments","length","sqrt","RADIANS_TO_DEGREES","DEGREES_TO_RADIANS","config","configure","options","formatValue","precision","round","concat","parseFloat","toPrecision","isArray","ArrayBuffer","isView","DataView","clone","array","map","func","result","toRadians","degrees","radians","toDegrees","sin","angle","cos","tan","asin","acos","atan","clamp","min","max","lerp","a","b","ai","equals","epsilon","oldEpsilon","Number","isFinite","abs","exactEquals","constructor","withEpsilon","oldPrecision","debug","printTypes","printDegrees","printRowMajor","checkNumber","Error","checkVector","v","callerName","validateVector","deprecated","method","version","console","warn","out","x","z","fromValues","normalize","len","dot","cross","ax","ay","az","bx","by","bz","transformMat4","w","transformMat3","transformQuat","q","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","rotateX","rad","rotateY","rotateZ","mag","cosine","vec","globals","self","window","global","mathgl","transpose","a01","a02","a03","a12","a13","a23","invert","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","determinant","multiply","b0","b1","b2","b3","translate","scale","rotate","axis","b12","b20","b21","b22","getScaling","mat","m11","m12","m13","m21","m22","m23","m31","m32","m33","fromQuat","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","frustum","left","right","bottom","top","near","far","rl","tb","nf","perspective","fovy","aspect","f","Infinity","ortho","lr","bt","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","identity","document","process","self_","window_","global_","document_","process_","console_","copy","set","add","squaredLength","aw","ix","iy","iz","iw","a0","a1","a2","a3","assert","condition","message","vec2_transformMat4AsVector","vec3_transformMat4AsVector","vec3_transformMat2","vec4_transformMat2","vec4_transformMat3","transformMat2","transformMat2d","isBoolean","isFunction","isObject","then","iterator","asyncIterator","next","Response","arrayBuffer","text","json","File","Blob","isWritableDOMStream","abort","getWriter","isReadableDOMStream","ReadableStream","tee","cancel","getReader","isBuffer","isWritableNodeStream","end","write","writable","isReadableNodeStream","read","pipe","readable","state","getGlobalLoaderState","globalOptions","getGlobalLoaderOptions","normalizeOptionsInternal","loader","loaders","url","validateOptionsObject","DEFAULT_LOADER_OPTIONS","REMOVED_LOADER_OPTIONS","idOptions","id","loaderOptions","deprecatedOptions","validateOptions","context","fetchOptions","fetch","fetchFile","_state","defaultOptions","loaderName","prefix","isSubOptions","probeLog","suggestion","findSimilarOption","optionKey","lowerCaseOptionKey","toLowerCase","bestSuggestion","lowerCaseKey","startsWith","mergedOptions","baseUri","addUrlOptions","log","NullLog","mergeNestedFields","isPureObject","Euler","ZYX","order","RotationOrders","DefaultOrder","super","this","fromVector3","quaternion","ysqr","t0","t1","t2","t3","t4","roll","atan2","pitch","yaw","RollPitchYaw","check","offset","checkOrder","undefined","_fromRotationMatrix","_getRotationMatrix","XYZ","YXZ","ZXY","YZX","XZY","te","elements","e","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","cy","sy","cr","sr","cp","sp","MathArray","cls","ExtendableBuiltin","instance","Reflect","construct","from","setPrototypeOf","getPrototypeOf","configurable","__proto__","_extendableBuiltin","arrayOrObject","fromObject","ELEMENTS","toArray","toObject","target","to","formatString","opts","string","vector","minVector","maxVector","vectors","subtract","addScalar","scalar","validate","valid","isLoaderObject","parseTextSync","parseText","binary","extensions","isBrowser","String","browser","isBrowserMainThread","ORIGIN","constants","Vector3","ZERO","freeze","origin","matrix4","transformAsPoint","matrix3","matrix2","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","noop","nextTick","args","push","apply","title","env","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","isElectron","mockUserAgent","type","Boolean","electron","realUserAgent","navigator","userAgent","indexOf","Vector","lengthSquared","mathArray","distanceSquared","dist","product","magnitude","distance","multiplyScalar","IDENTITY","INDICES","COL0ROW0","COL0ROW1","COL0ROW2","COL0ROW3","COL1ROW0","COL1ROW1","COL1ROW2","COL1ROW3","COL2ROW0","COL2ROW1","COL2ROW2","COL2ROW3","COL3ROW0","COL3ROW1","COL3ROW2","COL3ROW3","Matrix4","m00","m10","m20","m30","m01","m02","m03","_computeInfinitePerspectiveOffCenter","column0Row0","column1Row1","column2Row0","column2Row1","column3Row2","focalDistance","halfY","fov","scaleResult","getScale","inverseScale0","inverseScale1","inverseScale2","rx","ry","rz","factor","transformAsVector","g","Function","resource","isResponse","stripQueryString","contentTypeHeader","headers","parseMIMEType","parseMIMETypeFromURL","isBlob","size","byteLength","QUERY_STRING_PATTERN","replace","UNLOADED","LOADING","PROCESSING","READY","EXPIRED","FAILED","ADD","REPLACE","EMPTY","SCENEGRAPH","POINTCLOUD","MESH","I3S","TILES3D","GEOMETRIC_ERROR","MAX_SCREEN_THRESHOLD","NOT_COMPUTED","USE_OPTIMIZATION","SKIP_OPTIMIZATION","DEFAULT_PROPS","loadSiblings","skipLevelOfDetail","maximumScreenSpaceError","updateTransforms","onTraversalEnd","viewportTraversersMap","basePath","TilesetTraverser","_traversalStack","ManagedArray","_emptyTraversalStack","_frameNumber","root","selectedTiles","requestedTiles","emptyTiles","frameState","reset","updateTile","frameNumber","executeTraversal","stack","_selectionDepth","tile","pop","shouldRefine","canTraverse","updateChildTiles","updateAndPushChildren","hasRenderContent","parent","parentRefines","_shouldRefine","stoppedRefining","refine","TILE_REFINEMENT","loadTile","selectTile","touchTile","children","child","depth","sort","compareDistanceToCamera","checkRefines","hasVisibleChild","refines","isVisibleAndInRequestVolume","find","childRefines","_inRequestVolume","contentAvailable","executeEmptyTraversal","updateTileVisibility","shouldSelectTile","_selectedFrame","shouldLoadTile","_requestedFrame","_priority","_getPriority","tileset","_cache","touch","_touchedFrame","useParentMetric","ignoreVisibility","hasChildren","hasTilesetContent","contentExpired","hasUnloadedContent","screenSpaceError","_screenSpaceError","getScreenSpaceError","viewportIds","viewport","updateVisibility","_distanceToCamera","anyVisible","allDescendantsLoaded","sampleSize","samples","addCount","subtractCount","_count","_samples","_checkSampling","time","_time","lastTiming","_startTime","_timerPending","addTime","lastSampleCount","lastSampleTime","count","stats","_initializeStats","seal","_getOrCreate","keys","fn","table","forEach","stat","average","getAverageTime","hz","getHz","getHiResTimestamp","timestamp","performance","now","hrtime","timeParts","Date","setAxisAngle","bw","slerp","omega","cosom","sinom","scale0","scale1","fromMat3","fRoot","fTrace","j","k","vec4","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","rotationTo","vec3","mat3","IDENTITY_QUATERNION","fromAxisRotation","vectorA","vectorB","invDot","start","ratio","multiplyLeft","multiplyRight","SphericalCoordinates","phi","theta","radius","bearing","altitude","radiusScale","other","lng","lat","Pose","position","orientation","pose","sw","cw","setRowMajor","getTransformationMatrix","EXT_PATTERN","data","validHTTPResponse","selectLoaderSync","nothrow","slice","getNoValidLoaderMessage","normalizeLoader","candidateLoaders","ignoreRegisteredLoaders","getRegisteredLoaders","normalizeLoaders","selectLoaderInternal","getResourceUrlAndType","testUrl","mimeType","findLoaderByMIMEType","match","exec","extension","findLoaderByExtension","findLoaderByUrl","testDataAgainstText","testDataAgainstBinary","buffer","byteOffset","findLoaderByInitialBytes","fallbackMimeType","status","getMagicString","getFirstCharacters","mimeTypes","includes","testText","tests","some","test","compareArrayBuffers","magic","testBinary","dataView","fromCharCode","getUint8","WGS84_CONSTANTS","radii","radiiSquared","WGS84_RADIUS_X","WGS84_RADIUS_Y","WGS84_RADIUS_Z","oneOverRadii","oneOverRadiiSquared","maximumRadius","centerToleranceSquared","scratchVector","fromCartographic","cartographic","longitude","latitude","height","toCartographic","isWGS84","scaleToGeodeticSurfaceIntersection","scaleToGeodeticSurfaceGradient","scratchOrigin","VECTOR_PRODUCT_LOCAL_FRAME","south","north","west","east","down","degeneratePositionLocalFrame","scratchAxisVectors","scratchVector1","scratchVector2","scratchVector3","localFrameToFixedFrame","ellipsoid","firstAxis","secondAxis","thirdAxis","cartesianOrigin","thirdAxisInferred","firstAxisVector","secondAxisVector","thirdAxisVector","sign","fromArray","geodeticSurfaceNormal","scratchNormal","scratchK","scratchPosition","scratchHeight","scratchCartesian","wgs84","radiiToTheFourth","minimumRadius","EPSILON1","squaredXOverSquaredZ","toString","normal","geodeticSurfaceNormalCartographic","gamma","cartesian","point","scaleToGeodeticSurface","h","_cartographicRadians","cartographicVectorRadians","fromCartographicToRadians","cosLatitude","positionX","positionY","positionZ","oneOverRadiiX","oneOverRadiiY","oneOverRadiiZ","squaredNorm","intersection","oneOverRadiiSquaredX","oneOverRadiiSquaredY","oneOverRadiiSquaredZ","gradient","xMultiplier","yMultiplier","zMultiplier","lambda","correction","xMultiplier2","yMultiplier2","zMultiplier2","EPSILON12","beta","EPSILON15","Matrix","row","RANK","col","columnIndex","fill","firstIndex","columnVector","NullWorker","VERSION","null","isWorker","importScripts","isMobile","matches","nodeVersion","NOOP","WorkerThread","props","source","onMessage","onError","error","worker","_createBrowserWorker","Worker","terminate","terminated","transferList","getTransferList","postMessage","event","lineno","colno","_loadableURL","getLoadableWorkerURL","onmessage","onerror","_getErrorFromErrorEvent","onmessageerror","isTransferable","MessagePort","ImageBitmap","OffscreenCanvas","recursive","transfers","transfersSet","Set","TileHeader","header","parentHeader","extendedId","_getRefine","contentUrl","lodMetricType","lodMetricValue","boundingVolume","content","contentState","TILE_CONTENT_STATE","gpuMemoryUsageInBytes","hasEmptyContent","userData","_visitedFrame","_cacheNode","traverser","_centerZDepth","_visible","_stackLength","_initialTransform","transform","_initializeLodMetric","_initializeTransforms","_initializeBoundingVolumes","_initializeContent","_initializeRenderingState","_lodJudge","_expireDate","_expiredContent","contentReady","contentFailed","contentUnloaded","useParentLodMetric","TILESET_TYPE","getI3ScreenSize","getTiles3DScreenSpaceError","_traverser","maySkipTile","isVisible","rootScreenSpaceError","_requestScheduler","scheduleRequest","requestToken","getTileUrl","loadOptions","isTileset","_getLoaderSpecificOptions","load","contentLoader","_isTileset","_initializeTileHeaders","_onContentLoaded","done","destroy","parentVisibilityPlaneMask","_visibilityPlaneMask","CullingVolume","MASK_INDETERMINATE","parentTransform","computedTransform","modelMatrix","_updateTransform","distanceToTile","visibility","MASK_OUTSIDE","insideViewerRequestVolume","cullingVolume","computeVisibilityWithPlaneMask","distanceSquaredTo","camera","subVectors","direction","viewerRequestVolume","_viewerRequestVolume","lessThan","extras","tileHeader","parentInitialTransform","_contentBoundingVolume","_updateBoundingVolume","_tileset","_tile","level","disableSkipLevelOfDetail","createBoundingVolume","didTransformChange","loaderId","i3s","isTileHeader","get3dTilesOptions","resolvePath","makeResponse","filePath","arrayBufferOrString","fs","writeFileSync","toBuffer","flag","writeFile","parse","typedLoaders","getLoadersFromContext","selectLoader","normalizeOptions","getLoaderContext","parseWithLoader","validateWorkerVersion","getArrayBufferOrStringFromData","dataType","canParseWithWorker","parseWithWorker","parseSync","ERR_DATA","getArrayBufferOrStringFromDataSync","TextDecoder","decode","isArrayBuffer","response","checkResponse","isReadableStream","makeIterator","isIterable","isAsyncIterable","concatenateArrayBuffersAsync","isIterator","body","getIterableFromData","oneChunk","previousContext","resolvedContext","getFetchFunction","contextLoaders","INTERSECTION","OUTSIDE","INTERSECTING","INSIDE","minimum","maximum","halfDiagonal","transformation","plane","fromCenterRadius","corner","oppositeCorner","boundingSphere","leftCenter","leftRadius","rightCenter","rightRadius","toRightCenter","centerSeparation","halfDistanceBetweenTangentPoints","mat4","distanceToPlane","scratchOffset","scratchVectorU","scratchVectorV","scratchVectorW","scratchCorner","scratchToCenter","MATRIX3","halfAxes","xAxis","getColumn","yAxis","zAxis","normXAxis","normYAxis","normZAxis","fromMatrix3","halfSize","quaternionObject","directionsMatrix","fromQuaternion","u","cornerVector","normalX","normalY","normalZ","radEffective","uHalf","vHalf","wHalf","minDist","POSITIVE_INFINITY","maxDist","NEGATIVE_INFINITY","toCenter","fromNormalDistance","fromPointNormal","pointDistance","getPointDistance","scaledNormal","faces","scratchPlaneCenter","scratchPlaneNormal","planes","every","planeIndex","faceNormal","plane0","plane1","plane0Center","plane1Center","negatedFaceNormal","negate","intersect","intersectPlane","parentPlaneMask","MASK_INSIDE","mask","scratchPlaneUpVector","scratchPlaneRightVector","scratchPlaneNearCenter","scratchPlaneFarCenter","_left","_right","_top","_bottom","_near","_far","_cullingVolume","_perspectiveMatrix","_infinitePerspective","update","nearCenter","multiplyByScalar","farCenter","drawingBufferWidth","drawingBufferHeight","inverseNear","tanTheta","pixelHeight","pixelWidth","xOffset","yOffset","_offCenterFrustum","_fov","_fovy","_sseDenominator","aspectRatio","_aspectRatio","_xOffset","_yOffset","val","projectionMatrix","infiniteProjectionMatrix","computeCullingVolume","getPixelDimensions","fromPointsXMin","fromPointsYMin","fromPointsZMin","fromPointsXMax","fromPointsYMax","fromPointsZMax","fromPointsCurrentPos","fromPointsScratch","fromPointsRitterCenter","fromPointsMinBoxPt","fromPointsMaxBoxPt","fromPointsNaiveCenterScratch","makeBoundingSphereFromPoints","positions","currentPos","xMin","yMin","zMin","xMax","yMax","zMax","xSpan","magnitudeSquared","ySpan","zSpan","diameter1","diameter2","maxSpan","ritterCenter","radiusSquared","ritterRadius","minBoxPt","maxBoxPt","naiveCenter","naiveRadius","oldCenterToPointSquared","oldCenterToPoint","oldToNew","scratchMatrix","scratchUnitary","scratchDiagonal","jMatrix","jMatrixTranspose","computeEigenDecomposition","matrix","EIGEN_TOLERANCE","EPSILON20","sweep","unitaryMatrix","diagonalMatrix","norm","temp","computeFrobeniusNorm","offDiagonalFrobeniusNorm","shurDecomposition","unitary","toTarget","diagonal","rowVal","colVal","getElementIndex","tolerance","maxDiagonal","rotAxis","tau","scratchVector4","scratchVector5","scratchVector6","scratchCovarianceResult","scratchEigenResult","makeOrientedBoundingBoxFromPoints","meanPoint","invLength","exx","exy","exz","eyy","eyz","ezz","covarianceMatrix","rotation","v1","v2","v3","u1","MAX_VALUE","u2","u3","l1","l2","l3","scaleMatrix","makeAxisAlignedBoundingBoxFromPoints","minimumX","minimumY","minimumZ","maximumX","maximumY","maximumZ","Vector2","matrix2x3","Vector4","Matrix3","EPSILON2","EPSILON3","EPSILON4","EPSILON5","EPSILON6","EPSILON7","EPSILON8","EPSILON9","EPSILON10","EPSILON11","EPSILON13","EPSILON14","EPSILON16","EPSILON17","EPSILON18","EPSILON19","PI_OVER_TWO","PI_OVER_FOUR","PI_OVER_SIX","TWO_PI","WorkerJob","jobName","workerThread","isRunning","_resolve","_reject","Promise","resolve","reject","payload","maxConcurrency","maxMobileConcurrency","onDebug","reuseWorkers","WorkerFarm","Map","setProps","workerPools","isSupported","_workerFarm","values","_getWorkerPoolProps","workerPool","WorkerPool","idleQueue","isDestroyed","job","startPromise","onStart","jobQueue","_startQueuedJob","_getAvailableWorker","queuedJob","shift","backlog","returnWorkerToQueue","_getMaxConcurrency","onMessageWrapperMap","WorkerBody","isKnownMessage","onMessageWrapper","addEventListener","removeEventListener","warning","workerOptions","workerFile","workerUrl","_workerType","versionTag","AsyncQueue","_values","_settlers","_closed","enqueue","settler","node","toArrayBuffer","TextEncoder","encode","_toArrayBuffer","arrayBuffer1","arrayBuffer2","array1","Uint8Array","array2","sources","sourceArrays","source2","reduce","typedArray","sourceArray","typedArrays","arrays","TypedArrayConstructor","sumLength","acc","subArray","subarray","targetBuffer","sourceBuffer","targetArray","targetOffset","srcByteOffset","srcByteLength","padToNBytes","padding","defined","TilesetCache","_list","DoublyLinkedList","_sentinel","_trimTiles","splice","tail","addCallback","unloadCallback","remove","trimTiles","list","maximumMemoryUsageInBytes","maximumMemoryUsage","sentinel","head","item","unloadTile","rtcCenter","gltfUpAxis","rotationY","rotationX","isQuantized","quantizedVolumeOffset","quantizedVolumeScale","cartesianModelMatrix","cartographicOrigin","Ellipsoid","WGS84","cartesianToCartographic","toFixedFrameMatrix","eastNorthUpToFixedFrame","cartographicModelMatrix","cameraDirection","cameraUp","metersPerUnit","distanceScales","viewportCenterCartographic","viewportCenterCartesian","cartographicToCartesian","enuToFixedTransform","cameraPositionCartographic","unprojectPosition","cameraPosition","cameraPositionCartesian","cameraDirectionCartesian","cameraUpCartesian","frustumPlanes","getFrustumPlanes","distanceToCenter","cartographicPos","cartesianPos","commonSpacePlanesToWGS84","sseDenominator","Plane","ok","statusText","contentLength","getResourceContentLength","getInitialDataUrl","initialDataUrl","getResponseError","contentType","INITIAL_DATA_LENGTH","blobSlice","reader","FileReader","onload","readAsDataURL","base64","arrayBufferToBase64","bytes","btoa","Log","ConsoleLog","info","loaderRegistry","getGlobalLoaderRegistry","normalizedLoader","registeredLoader","unshift","makeStringIterator","makeArrayBufferIterator","makeBlobIterator","makeStreamIterator","parseInBatches","parseWithLoaderInBatches","makeMetadataBatchIterator","async","metadataBatch","parseToOutputIterator","outputIterator","metadata","batchType","_loader","_context","bytesUsed","parseChunkInBatches","transformedIterator","parsedData","batch","shape","getAsyncIterableFromData","inputIterator","applyInputTransforms","transforms","iteratorChain","writer","encodeSync","encodeText","encodeInBatches","batches","chunks","concatenateArrayBuffers","encodeURLtoURL","tmpInputFilename","getTemporaryFilename","tmpOutputFilename","outputFilename","dataIterator","getIterator","inputUrl","outputUrl","filename","pull","controller","close","highWaterMark","boundingVolumeHeader","box","Quaternion","transformByQuaternion","OrientedBoundingBox","createBox","region","minHeight","maxHeight","northWest","scratchNorthWest","southEast","scratchSouthEast","centerInCartesian","addVectors","createSphere","sphere","scratchScale","uniformScale","BoundingSphere","metersPerPixel","mbsLat","mbs","mbsLon","mbsZ","mbsR","width","viewportCenter","mbsCenter","mbsLatProjected","mbsLonProjected","diagonalInMeters","distanceInMeters","getDistanceFromLatLon","visibleHeight","visibleWidth","screenSize","qualityFactor","projectVertexToSphere","azim","incl","radCosInc","observer","observerLon","observerLat","observerZ","centerLon","centerLat","projectedCenter","projectedObserver","dx","dy","dz","mbsRNormalized","getTanOfHalfVFAngle","moduleExports","require","_global","assign","description","throttleRequests","maxRequests","onTileLoad","onTileUnload","onTileError","onTraversalComplete","viewDistanceScale","loadTiles","attributions","Tileset3D","path","dirname","roots","cartographicCenter","cartesianCenter","zoom","traverseCounter","geometricError","_initializeTraverser","RequestScheduler","_pendingCount","_tiles","_emptyTiles","_requestedTiles","frameStateData","lastUpdatedVieports","_queryParams","_queryParamsString","Stats","_extensionsUsed","dynamicScreenSpaceErrorComputedDensity","asset","credits","_initializeTileSet","_destroy","queryParams","queryParamStrings","join","getQueryParamString","tilePath","extensionName","viewports","viewportsToTraverse","_needTraverse","getFrameState","traverse","viewportId","traverserId","currentFrameStateData","_updateTiles","frameStateKey","frameStateDataValue","_loadTiles","_unloadTiles","_updateStats","oldSelectedTiles","set1","set2","changed","filter","has","_loadTile","unloadTiles","_unloadTile","tilesRenderable","pointsRenderable","pointCount","tilesetJson","_initializeCesiumTileset","_initializeI3STileset","_calculateViewProps","getZoomFromBoundingVolume","parentTileHeader","rootTile","Tile3D","incrementCount","childHeader","childTile","TraverserClass","Tileset3DTraverser","I3SetTraverser","_onTraversalEnd","parentTile","_destroySubtree","_onStartTileLoading","loadContent","loaded","_onTileLoadError","_onEndTileLoading","_onTileLoad","calculateTransformProps","_addTileToCache","decrementCount","_updateCacheStats","unloadContent","_destroyTile","tilesetVersion","properties","extensionsUsed","token","input","parseData","parseOnMainThread","requestId","parser","textDecoder","workerURL","workerURLCache","getLoadableWorkerURLFromSource","getLoadableWorkerURLFromURL","workerSource","blob","URL","createObjectURL","getWorkerName","getWorkerURL","workerFarm","getWorkerFarm","getWorkerPool","startJob","transferableOptions","removeNontransferableOptions","JSON","cache","stringify","err","processInBatches","processOnMainThread","inputBatches","resultIterator","coreVersion","workerVersion","loadLibraryPromises","libraryUrl","moduleName","getLibraryUrl","loadLibraryFromFile","library","CDN","endsWith","requireFromFile","scriptSource","loadLibraryFromString","requireFromString","eval","script","createElement","appendChild","createTextNode","_","stringBuffer","copyPaddedArrayBufferToDataView","paddedLength","padLength","setUint8","byteAlignment","ceil","whitespace","charCodeAt","arrayBufferIterator","stream","textIterator","textEncoder","previous","eolIndex","line","lineIterator","counter","visitor","arrayBuffers","chunk","strings","handle","getPriority","requestMap","request","priority","promise","requestQueue","_issueNewRequests","isDone","activeRequestCount","deferredUpdate","_issueNewRequestsAsync","freeSlots","_updateAllRequests","_issueRequest","_updateRequest","slashIndex","lastIndexOf","substr","parts","separator","part","index","RegExp","pathPrefix","aliases","fileAliases","alias","replacement","JSONLoader","category","_typecheckJSONLoader","_length","DoublyLinkedListNode","nextNode","_insert","oldNodeNext","obbSize","axeY","axeZ","getObbSize","log2","zoomX","zoomY","mimeString","MIME_TYPE_PATTERN","DATA_URL_PATTERN","file","_readToArrayBuffer","readBlob","fileReader","readAsArrayBuffer","readFileSync","setGlobalOptions","limit","_limitMB","batchSize","batchDebounceMs","throws","uri","credentials","redirect","referrer","referrerPolicy","integrity","keepalive","signal","chunkSize","chunkLength","chunkByteLength","makeBrowserStreamIterator","makeNodeStreamIterator","currentBatchPromise","nextBatchPromise","_streamReadAhead","releaseLock","parseWithLoaderSync","files","loadOneFileInBatches","encodedData","makeDOMStream","makeNodeStream","NullWorkerLoader","NullLoader","onProgress","onDone","totalBytes","parseInt","progressStream","loadedBytes","percent","BrowserFileSystem","_fetch","lowerCaseFiles","usedFiles","Headers","range","pathname","flags","fd","startPosition","bytesRead","used","minimumHeight","maximumHeight","mapProjection","dynamicScreenSpaceErrorHeightFalloff","dynamicScreenSpaceErrorDensity","tileBoundingVolume","contentBoundingVolume","TileBoundingRegion","Cartesian3","positionWC","scratchPositionNormal","directionWC","positionCartographic","transformLocal","inverseTransformation","centerLocal","multiplyByPoint","scratchCenter","centerCartographic","Cartographic","fromCartesian","scratchCartographic","positionLocal","UNIT_Z","multiplyByPointAsVector","scratchDirection","TileOrientedBoundingBox","boxHeight","_header","TileBoundingSphere","heightFalloff","heightClose","heightFar","horizonFactor","parentLodMetricValue","getDynamicScreenSpaceError","fog","distanceToCamera","density","exp","dynamicScreenSpaceError","dynamicScreenSpaceErrorFactor","assetGltfUpAxis","_array","_map","element","firstChild","meetsScreenSpaceErrorEarly","useOptimization","_optimChildrenWithinParent","TILE3D_OPTIMIZATION_HINT","anyChildrenVisible","I3STilesetTraverser","_tileManager","I3STileManager","lodJudge","childTiles","nodePages","nodePagesTile","formTileFromNodePages","nodeId","nodeUrl","STATUS","_statusMap","callback","LocalStorage","defaultSettings","storage","setItem","removeItem","getStorage","_loadConfiguration","configuration","updateConfiguration","serialized","serializedConfiguration","getItem","leftPad","repeat","rightPad","formatImage","image","maxWidth","imageUrl","src","style","floor","COLOR","BLACK","RED","GREEN","YELLOW","BLUE","MAGENTA","CYAN","WHITE","BRIGHT_BLACK","BRIGHT_RED","BRIGHT_GREEN","BRIGHT_YELLOW","BRIGHT_BLUE","BRIGHT_MAGENTA","BRIGHT_CYAN","BRIGHT_WHITE","getColor","color","toUpperCase","addColor","background","autobind","obj","predefined","proto","propNames","getOwnPropertyNames","originalConsole","DEFAULT_SETTINGS","enabled","ONCE","getTableHeader","_startTs","_deltaTs","LOG_THROTTLE_TIMEOUT","_storage","timeStamp","newLevel","setLevel","getLevel","newPriority","_getLogFunction","oldUsage","newUsage","logLevel","columns","tag","_shouldLog","img","Image","nodeName","toDataURL","logImageInBrowser","asciify","fit","logImageInNode","setting","timeEnd","collapsed","normalizeArguments","groupCollapsed","group","groupEnd","trace","isEnabled","normalizeLogLevel","total","getTotal","delta","getDelta","ms","formatted","toFixed","formatTime","decorateMessage","resolvedLevel","messageType","getBrowser","navigator_","isMSIE","isTrident","chrome","safari","mozInnerScreenX"],"mappings":"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","file":"dist.es5.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 77);\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import assert from './assert';\nconst RADIANS_TO_DEGREES = 1 / Math.PI * 180;\nconst DEGREES_TO_RADIANS = 1 / 180 * Math.PI;\nconst config = {};\nconfig.EPSILON = 1e-12;\nconfig.debug = false;\nconfig.precision = 4;\nconfig.printTypes = false;\nconfig.printDegrees = false;\nconfig.printRowMajor = true;\nexport { config };\nexport function configure(options = {}) {\n  for (const key in options) {\n    assert(key in config);\n    config[key] = options[key];\n  }\n\n  return config;\n}\n\nfunction round(value) {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\nexport function formatValue(value, {\n  precision = config.precision || 4\n} = {}) {\n  value = round(value);\n  return \"\".concat(parseFloat(value.toPrecision(precision)));\n}\nexport function isArray(value) {\n  return Array.isArray(value) || ArrayBuffer.isView(value) && !(value instanceof DataView);\n}\n\nfunction duplicateArray(array) {\n  return array.clone ? array.clone() : new Array(array.length);\n}\n\nexport function clone(array) {\n  return array.clone ? array.clone() : new Array(...array);\n}\n\nfunction map(value, func, result) {\n  if (isArray(value)) {\n    result = result || duplicateArray(value);\n\n    for (let i = 0; i < result.length && i < value.length; ++i) {\n      result[i] = func(value[i], i, result);\n    }\n\n    return result;\n  }\n\n  return func(value);\n}\n\nexport function toRadians(degrees) {\n  return radians(degrees);\n}\nexport function toDegrees(radians) {\n  return degrees(radians);\n}\nexport function radians(degrees, result) {\n  return map(degrees, degrees => degrees * DEGREES_TO_RADIANS, result);\n}\nexport function degrees(radians, result) {\n  return map(radians, radians => radians * RADIANS_TO_DEGREES, result);\n}\nexport function sin(radians) {\n  return map(radians, angle => Math.sin(angle));\n}\nexport function cos(radians) {\n  return map(radians, angle => Math.cos(angle));\n}\nexport function tan(radians) {\n  return map(radians, angle => Math.tan(angle));\n}\nexport function asin(radians) {\n  return map(radians, angle => Math.asin(angle));\n}\nexport function acos(radians) {\n  return map(radians, angle => Math.acos(angle));\n}\nexport function atan(radians) {\n  return map(radians, angle => Math.atan(angle));\n}\nexport function clamp(value, min, max) {\n  return map(value, value => Math.max(min, Math.min(max, value)));\n}\nexport function lerp(a, b, t) {\n  if (isArray(a)) {\n    return a.map((ai, i) => lerp(ai, b[i], t));\n  }\n\n  return t * b + (1 - t) * a;\n}\nexport function equals(a, b, epsilon) {\n  const oldEpsilon = config.EPSILON;\n\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n\n  try {\n    if (a === b) {\n      return true;\n    }\n\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n\n      for (let i = 0; i < a.length; ++i) {\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n\n    if (Number.isFinite(a) && Number.isFinite(b)) {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n    }\n\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\nexport function exactEquals(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\nexport function withEpsilon(EPSILON, func) {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = EPSILON;\n  let value;\n\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n\n  return value;\n}\n//# sourceMappingURL=common.js.map","import { config } from './common';\nexport function validateVector(v, length) {\n  if (v.length !== length) {\n    return false;\n  }\n\n  for (let i = 0; i < v.length; ++i) {\n    if (!Number.isFinite(v[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\nexport function checkNumber(value) {\n  if (!Number.isFinite(value)) {\n    throw new Error(\"Invalid number \".concat(value));\n  }\n\n  return value;\n}\nexport function checkVector(v, length, callerName = '') {\n  if (config.debug && !validateVector(v, length)) {\n    throw new Error(\"math.gl: \".concat(callerName, \" some fields set to invalid numbers'\"));\n  }\n\n  return v;\n}\nconst map = {};\nexport function deprecated(method, version) {\n  if (!map[method]) {\n    map[method] = true;\n    console.warn(\"\".concat(method, \" has been removed in version \").concat(version, \", see upgrade guide for more information\"));\n  }\n}\n//# sourceMappingURL=validators.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import { config } from './lib/common';\nexport { default as Vector2 } from './classes/vector2';\nexport { default as Vector3 } from './classes/vector3';\nexport { default as Vector4 } from './classes/vector4';\nexport { default as Matrix3 } from './classes/matrix3';\nexport { default as Matrix4 } from './classes/matrix4';\nexport { default as Quaternion } from './classes/quaternion';\nexport { config, configure, formatValue, isArray, clone, equals, exactEquals, toRadians, toDegrees, radians, degrees, sin, cos, tan, asin, acos, atan, clamp, lerp, withEpsilon } from './lib/common';\nexport { checkNumber } from './lib/validators';\nexport { default as _MathUtils } from './lib/math-utils';\nexport { default as SphericalCoordinates } from './classes/spherical-coordinates';\nexport { default as Pose } from './classes/pose';\nexport { default as Euler } from './classes/euler';\nexport { default as assert } from './lib/assert';\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global\n};\nconst global_ = globals.global || globals.self || globals.window;\nglobal_.mathgl = {\n  config\n};\nexport { default as _SphericalCoordinates } from './classes/spherical-coordinates';\nexport { default as _Pose } from './classes/pose';\nexport { default as _Euler } from './classes/euler';\n//# sourceMappingURL=index.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","// TYPES\nexport type {\n  Loader,\n  LoaderWithParser,\n  LoaderContext,\n  LoaderOptions,\n  Writer,\n  WriterOptions,\n  DataType,\n  SyncDataType,\n  BatchableDataType,\n  IFileSystem,\n  IRandomAccessReadFileSystem\n} from './types';\n\n// GENERAL UTILS\nexport {assert} from './lib/env-utils/assert';\nexport {\n  isBrowser,\n  isWorker,\n  nodeVersion,\n  self,\n  window,\n  global,\n  document\n} from './lib/env-utils/globals';\n\n// LOADERS.GL-SPECIFIC WORKER UTILS\nexport {createLoaderWorker} from './lib/worker-loader-utils/create-loader-worker';\nexport {parseWithWorker, canParseWithWorker} from './lib/worker-loader-utils/parse-with-worker';\n\n// PARSER UTILS\nexport {parseJSON} from './lib/parser-utils/parse-json';\n\n// MEMORY COPY UTILS\nexport {\n  toArrayBuffer,\n  sliceArrayBuffer,\n  concatenateArrayBuffers,\n  concatenateTypedArrays,\n  compareArrayBuffers\n} from './lib/binary-utils/array-buffer-utils';\nexport {padToNBytes, copyToArray, copyArrayBuffer} from './lib/binary-utils/memory-copy-utils';\nexport {\n  copyPaddedArrayBufferToDataView,\n  copyPaddedStringToDataView\n} from './lib/binary-utils/binary-copy-utils';\nexport {\n  padStringToByteAlignment,\n  copyStringToDataView,\n  copyBinaryToDataView\n} from './lib/binary-utils/encode-utils';\nexport {getFirstCharacters, getMagicString} from './lib/binary-utils/get-first-characters';\n\n// ITERATOR UTILS\nexport {\n  makeTextEncoderIterator,\n  makeTextDecoderIterator,\n  makeLineIterator,\n  makeNumberedLineIterator\n} from './lib/iterators/text-iterators';\nexport {forEach, concatenateArrayBuffersAsync} from './lib/iterators/async-iteration';\n\n// REQUEST UTILS\nexport {default as RequestScheduler} from './lib/request-utils/request-scheduler';\n\n// NODE `path`` REPLACEMENT\nimport * as path from './lib/path-utils/path';\nexport {path};\nexport {setPathPrefix, getPathPrefix, resolvePath} from './lib/path-utils/file-aliases';\nexport {addAliases as _addAliases} from './lib/path-utils/file-aliases';\n\n// NODE `fs` WRAPPERS\nimport * as fs from './lib/node/fs';\nexport {fs};\n\n// NODE `buffer` WRAPPERS\nexport {isBuffer, toBuffer, bufferToArrayBuffer} from './lib/binary-utils/buffer-utils';\n\nexport {JSONLoader} from './json-loader';\n","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: typeof process === 'object' && process\n};\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst global_ = globals.global || globals.self || globals.window;\nconst document_ = globals.document || {};\nconst process_ = globals.process || {};\nconst console_ = console;\nexport { self_ as self, window_ as window, global_ as global, document_ as document, process_ as process, console_ as console };\n//# sourceMappingURL=globals.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(\"math.gl assertion \".concat(message));\n  }\n}\n//# sourceMappingURL=assert.js.map","export function vec2_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const w = m[3] * x + m[7] * y || 1.0;\n  out[0] = (m[0] * x + m[4] * y) / w;\n  out[1] = (m[1] * x + m[5] * y) / w;\n  return out;\n}\nexport function vec3_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  const w = m[3] * x + m[7] * y + m[11] * z || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z) / w;\n  return out;\n}\nexport function vec3_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  return out;\n}\nexport function vec4_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\nexport function vec4_transformMat3(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = m[0] * x + m[3] * y + m[6] * z;\n  out[1] = m[1] * x + m[4] * y + m[7] * z;\n  out[2] = m[2] * x + m[5] * y + m[8] * z;\n  out[3] = a[3];\n  return out;\n}\n//# sourceMappingURL=gl-matrix-extras.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","import type {Readable} from 'stream';\n\n/** A DOM or Node readable stream */\nexport type ReadableStreamType = ReadableStream | Readable;\n\nconst isBoolean: (x: any) => boolean = (x) => typeof x === 'boolean';\nconst isFunction: (x: any) => boolean = (x) => typeof x === 'function';\n\nexport const isObject: (x: any) => boolean = (x) => x !== null && typeof x === 'object';\nexport const isPureObject: (x: any) => boolean = (x) =>\n  isObject(x) && x.constructor === {}.constructor;\nexport const isPromise: (x: any) => boolean = (x) => isObject(x) && isFunction(x.then);\n\nexport const isIterable: (x: any) => boolean = (x) => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable: (x: any) => boolean = (x) =>\n  x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator: (x: any) => boolean = (x) => x && isFunction(x.next);\n\nexport const isResponse: (x: any) => boolean = (x) =>\n  (typeof Response !== 'undefined' && x instanceof Response) ||\n  (x && x.arrayBuffer && x.text && x.json);\n\nexport const isFile: (x: any) => boolean = (x) => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob: (x: any) => boolean = (x) => typeof Blob !== 'undefined' && x instanceof Blob;\n\nexport const isWritableDOMStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\n\nexport const isReadableDOMStream: (x: any) => boolean = (x) =>\n  (typeof ReadableStream !== 'undefined' && x instanceof ReadableStream) ||\n  (isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader));\n// Not implemented in Firefox: && isFunction(x.pipeTo)\n\n/** Check for Node.js `Buffer` without triggering bundler to include buffer polyfill */\nexport const isBuffer: (x: any) => boolean = (x) => x && typeof x === 'object' && x.isBuffer;\n\nexport const isWritableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream: (x: any) => boolean = (x) =>\n  isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream: (x: any) => boolean = (x) =>\n  isWritableDOMStream(x) || isWritableNodeStream(x);\n","import type {Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {global} from '@loaders.gl/loader-utils';\nimport {isPureObject, isObject} from '../../javascript-utils/is-type';\nimport {fetchFile} from '../fetch/fetch-file';\nimport {probeLog, NullLog} from './loggers';\nimport {DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS} from './option-defaults';\n/**\n * Global state for loaders.gl. Stored on `global.loaders._state`\n */\ntype GlobalLoaderState = {\n  loaderRegistry: Loader[];\n  globalOptions: {[key: string]: any};\n};\n\n/**\n * Helper for safely accessing global loaders.gl variables\n * Wraps initialization of global variable in function to defeat overly aggressive tree-shakers\n */\nexport function getGlobalLoaderState(): GlobalLoaderState {\n  // @ts-ignore\n  global.loaders = global.loaders || {};\n  // @ts-ignore\n  const {loaders} = global;\n\n  // Add _state object to keep separate from modules added to global.loaders\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\n\n// Store global loader options on the global object to increase chances of cross loaders-version interoperability\n// NOTE: This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\nconst getGlobalLoaderOptions = () => {\n  const state = getGlobalLoaderState();\n  // Ensure all default loader options from this library are mentioned\n  state.globalOptions = state.globalOptions || {...DEFAULT_LOADER_OPTIONS};\n  return state.globalOptions;\n};\n\n/**\n * Set global loader options\n * @param options\n */\nexport function setGlobalOptions(options: object): void {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\n\n/**\n * Merges options with global opts and loader defaults, also injects baseUri\n * @param options\n * @param loader\n * @param loaders\n * @param url\n */\nexport function normalizeOptions(\n  options: object,\n  loader: Loader,\n  loaders?: Loader[],\n  url?: string\n): object {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\n\n/**\n * Gets the current fetch function from options and context\n * @param options\n * @param context\n */\nexport function getFetchFunction(\n  options?: LoaderOptions,\n  context?: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>\n) {\n  const globalOptions = getGlobalLoaderOptions();\n\n  const fetchOptions = options || globalOptions;\n\n  // options.fetch can be a function\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n\n  // options.fetch can be an options object\n  if (isObject(fetchOptions.fetch)) {\n    return (url) => fetchFile(url, fetchOptions);\n  }\n\n  // else refer to context (from parent loader) if available\n  if (context?.fetch) {\n    return context?.fetch;\n  }\n\n  // else return the default fetch function\n  return fetchFile;\n}\n\n// VALIDATE OPTIONS\n\n/**\n * Warn for unsupported options\n * @param options\n * @param loaders\n */\nfunction validateOptions(options: LoaderOptions, loaders: Loader[]) {\n  // Check top level options\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n  for (const loader of loaders) {\n    // Get the scoped, loader specific options from the user supplied options\n    const idOptions = (options && options[loader.id]) || {};\n\n    // Get scoped, loader specific default and deprecated options from the selected loader\n    const loaderOptions = (loader.options && loader.options[loader.id]) || {};\n    const deprecatedOptions =\n      (loader.deprecatedOptions && loader.deprecatedOptions[loader.id]) || {};\n\n    // Validate loader specific options\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\n\n// eslint-disable-next-line max-params, complexity\nfunction validateOptionsObject(\n  options,\n  id: string | null,\n  defaultOptions,\n  deprecatedOptions,\n  loaders: Loader[]\n) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? `${id}.` : '';\n\n  for (const key in options) {\n    // If top level option value is an object it could options for a loader, so ignore\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n    // <loader>.workerUrl requires special handling as it is now auto-generated and no longer specified as a default option.\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      // Issue deprecation warnings\n      if (key in deprecatedOptions) {\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' no longer supported, use \\'${deprecatedOptions[key]}\\'`\n        )();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' not recognized. ${suggestion}`\n        )();\n      }\n    }\n  }\n}\n\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch =\n        lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n    }\n  }\n  return bestSuggestion;\n}\n\nfunction normalizeOptionsInternal(loader, options, url?: string) {\n  const loaderDefaultOptions = loader.options || {};\n\n  const mergedOptions = {...loaderDefaultOptions};\n\n  addUrlOptions(mergedOptions, url);\n\n  // LOGGING: options.log can be set to `null` to defeat logging\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n\n  return mergedOptions;\n}\n\n// Merge nested options objects\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    // Check for nested options\n    // object in options => either no key in defaultOptions or object in defaultOptions\n    if (key in options) {\n      const value = options[key];\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = {\n          ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n    // else: No need to merge nested opts, and the initial merge already copied over the nested options\n  }\n}\n\n// Harvest information from the url\n// TODO - baseUri should be a directory, i.e. remove file component from baseUri\n// TODO - extract extension?\n// TODO - extract query parameters?\n// TODO - should these be injected on context instead of options?\nfunction addUrlOptions(options, url?: string) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n","import MathArray from './base/math-array';\nimport { clamp } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport Quaternion from './quaternion';\nconst ERR_UNKNOWN_ORDER = 'Unknown Euler angle order';\nconst ALMOST_ONE = 0.99999;\n\nfunction validateOrder(value) {\n  return value >= 0 && value < 6;\n}\n\nfunction checkOrder(value) {\n  if (value < 0 && value >= 6) {\n    throw new Error(ERR_UNKNOWN_ORDER);\n  }\n\n  return value;\n}\n\nexport default class Euler extends MathArray {\n  static get ZYX() {\n    return 0;\n  }\n\n  static get YXZ() {\n    return 1;\n  }\n\n  static get XZY() {\n    return 2;\n  }\n\n  static get ZXY() {\n    return 3;\n  }\n\n  static get YZX() {\n    return 4;\n  }\n\n  static get XYZ() {\n    return 5;\n  }\n\n  static get RollPitchYaw() {\n    return 0;\n  }\n\n  static get DefaultOrder() {\n    return Euler.ZYX;\n  }\n\n  static get RotationOrders() {\n    return ['ZYX', 'YXZ', 'XZY', 'ZXY', 'YZX', 'XYZ'];\n  }\n\n  static rotationOrder(order) {\n    return Euler.RotationOrders[order];\n  }\n\n  get ELEMENTS() {\n    return 4;\n  }\n\n  constructor(x = 0, y = 0, z = 0, order = Euler.DefaultOrder) {\n    super(-0, -0, -0, -0);\n\n    if (arguments.length > 0 && Array.isArray(arguments[0])) {\n      this.fromVector3(...arguments);\n    } else {\n      this.set(x, y, z, order);\n    }\n  }\n\n  fromQuaternion(quaternion) {\n    const [x, y, z, w] = quaternion;\n    const ysqr = y * y;\n    const t0 = -2.0 * (ysqr + z * z) + 1.0;\n    const t1 = +2.0 * (x * y + w * z);\n    let t2 = -2.0 * (x * z - w * y);\n    const t3 = +2.0 * (y * z + w * x);\n    const t4 = -2.0 * (x * x + ysqr) + 1.0;\n    t2 = t2 > 1.0 ? 1.0 : t2;\n    t2 = t2 < -1.0 ? -1.0 : t2;\n    const roll = Math.atan2(t3, t4);\n    const pitch = Math.asin(t2);\n    const yaw = Math.atan2(t1, t0);\n    return new Euler(roll, pitch, yaw, Euler.RollPitchYaw);\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = Number.isFinite(array[3]) || this.order;\n    return this.check();\n  }\n\n  set(x = 0, y = 0, z = 0, order) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = Number.isFinite(order) ? order : this[3];\n    return this.check();\n  }\n\n  validate() {\n    return validateOrder(this[3]) && Number.isFinite(this[0]) && Number.isFinite(this[1]) && Number.isFinite(this[2]);\n  }\n\n  toArray(array = [], offset = 0) {\n    array[offset] = this[0];\n    array[offset + 1] = this[1];\n    array[offset + 2] = this[2];\n    return array;\n  }\n\n  toArray4(array = [], offset = 0) {\n    array[offset] = this[0];\n    array[offset + 1] = this[1];\n    array[offset + 2] = this[2];\n    array[offset + 3] = this[3];\n    return array;\n  }\n\n  toVector3(result = [-0, -0, -0]) {\n    result[0] = this[0];\n    result[1] = this[1];\n    result[2] = this[2];\n    return result;\n  }\n\n  get x() {\n    return this[0];\n  }\n\n  set x(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get y() {\n    return this[1];\n  }\n\n  set y(value) {\n    this[1] = checkNumber(value);\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get alpha() {\n    return this[0];\n  }\n\n  set alpha(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get beta() {\n    return this[1];\n  }\n\n  set beta(value) {\n    this[1] = checkNumber(value);\n  }\n\n  get gamma() {\n    return this[2];\n  }\n\n  set gamma(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get phi() {\n    return this[0];\n  }\n\n  set phi(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get theta() {\n    return this[1];\n  }\n\n  set theta(value) {\n    this[1] = checkNumber(value);\n  }\n\n  get psi() {\n    return this[2];\n  }\n\n  set psi(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get roll() {\n    return this[0];\n  }\n\n  set roll(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get pitch() {\n    return this[1];\n  }\n\n  set pitch(value) {\n    this[1] = checkNumber(value);\n  }\n\n  get yaw() {\n    return this[2];\n  }\n\n  set yaw(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get order() {\n    return this[3];\n  }\n\n  set order(value) {\n    this[3] = checkOrder(value);\n  }\n\n  fromVector3(v, order) {\n    return this.set(v[0], v[1], v[2], Number.isFinite(order) ? order : this[3]);\n  }\n\n  fromArray(array, offset = 0) {\n    this[0] = array[0 + offset];\n    this[1] = array[1 + offset];\n    this[2] = array[2 + offset];\n\n    if (array[3] !== undefined) {\n      this[3] = array[3];\n    }\n\n    return this.check();\n  }\n\n  fromRollPitchYaw(roll, pitch, yaw) {\n    return this.set(roll, pitch, yaw, Euler.ZYX);\n  }\n\n  fromRotationMatrix(m, order = Euler.DefaultOrder) {\n    this._fromRotationMatrix(m, order);\n\n    return this.check();\n  }\n\n  getRotationMatrix(m) {\n    return this._getRotationMatrix(m);\n  }\n\n  getQuaternion() {\n    const q = new Quaternion();\n\n    switch (this[4]) {\n      case Euler.XYZ:\n        return q.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);\n\n      case Euler.YXZ:\n        return q.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);\n\n      case Euler.ZXY:\n        return q.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);\n\n      case Euler.ZYX:\n        return q.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);\n\n      case Euler.YZX:\n        return q.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);\n\n      case Euler.XZY:\n        return q.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);\n\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n  }\n\n  _fromRotationMatrix(m, order = Euler.DefaultOrder) {\n    const te = m.elements;\n    const m11 = te[0],\n          m12 = te[4],\n          m13 = te[8];\n    const m21 = te[1],\n          m22 = te[5],\n          m23 = te[9];\n    const m31 = te[2],\n          m32 = te[6],\n          m33 = te[10];\n    order = order || this[3];\n\n    switch (order) {\n      case Euler.XYZ:\n        this[1] = Math.asin(clamp(m13, -1, 1));\n\n        if (Math.abs(m13) < ALMOST_ONE) {\n          this[0] = Math.atan2(-m23, m33);\n          this[2] = Math.atan2(-m12, m11);\n        } else {\n          this[0] = Math.atan2(m32, m22);\n          this[2] = 0;\n        }\n\n        break;\n\n      case Euler.YXZ:\n        this[0] = Math.asin(-clamp(m23, -1, 1));\n\n        if (Math.abs(m23) < ALMOST_ONE) {\n          this[1] = Math.atan2(m13, m33);\n          this[2] = Math.atan2(m21, m22);\n        } else {\n          this[1] = Math.atan2(-m31, m11);\n          this[2] = 0;\n        }\n\n        break;\n\n      case Euler.ZXY:\n        this[0] = Math.asin(clamp(m32, -1, 1));\n\n        if (Math.abs(m32) < ALMOST_ONE) {\n          this[1] = Math.atan2(-m31, m33);\n          this[2] = Math.atan2(-m12, m22);\n        } else {\n          this[1] = 0;\n          this[2] = Math.atan2(m21, m11);\n        }\n\n        break;\n\n      case Euler.ZYX:\n        this[1] = Math.asin(-clamp(m31, -1, 1));\n\n        if (Math.abs(m31) < ALMOST_ONE) {\n          this[0] = Math.atan2(m32, m33);\n          this[2] = Math.atan2(m21, m11);\n        } else {\n          this[0] = 0;\n          this[2] = Math.atan2(-m12, m22);\n        }\n\n        break;\n\n      case Euler.YZX:\n        this[2] = Math.asin(clamp(m21, -1, 1));\n\n        if (Math.abs(m21) < ALMOST_ONE) {\n          this[0] = Math.atan2(-m23, m22);\n          this[1] = Math.atan2(-m31, m11);\n        } else {\n          this[0] = 0;\n          this[1] = Math.atan2(m13, m33);\n        }\n\n        break;\n\n      case Euler.XZY:\n        this[2] = Math.asin(-clamp(m12, -1, 1));\n\n        if (Math.abs(m12) < ALMOST_ONE) {\n          this[0] = Math.atan2(m32, m22);\n          this[1] = Math.atan2(m13, m11);\n        } else {\n          this[0] = Math.atan2(-m23, m33);\n          this[1] = 0;\n        }\n\n        break;\n\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n\n    this[3] = order;\n    return this;\n  }\n\n  _getRotationMatrix(result) {\n    const te = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0];\n    const x = this.x,\n          y = this.y,\n          z = this.z;\n    const a = Math.cos(x);\n    const c = Math.cos(y);\n    const e = Math.cos(z);\n    const b = Math.sin(x);\n    const d = Math.sin(y);\n    const f = Math.sin(z);\n\n    switch (this[3]) {\n      case Euler.XYZ:\n        {\n          const ae = a * e,\n                af = a * f,\n                be = b * e,\n                bf = b * f;\n          te[0] = c * e;\n          te[4] = -c * f;\n          te[8] = d;\n          te[1] = af + be * d;\n          te[5] = ae - bf * d;\n          te[9] = -b * c;\n          te[2] = bf - ae * d;\n          te[6] = be + af * d;\n          te[10] = a * c;\n          break;\n        }\n\n      case Euler.YXZ:\n        {\n          const ce = c * e,\n                cf = c * f,\n                de = d * e,\n                df = d * f;\n          te[0] = ce + df * b;\n          te[4] = de * b - cf;\n          te[8] = a * d;\n          te[1] = a * f;\n          te[5] = a * e;\n          te[9] = -b;\n          te[2] = cf * b - de;\n          te[6] = df + ce * b;\n          te[10] = a * c;\n          break;\n        }\n\n      case Euler.ZXY:\n        {\n          const ce = c * e,\n                cf = c * f,\n                de = d * e,\n                df = d * f;\n          te[0] = ce - df * b;\n          te[4] = -a * f;\n          te[8] = de + cf * b;\n          te[1] = cf + de * b;\n          te[5] = a * e;\n          te[9] = df - ce * b;\n          te[2] = -a * d;\n          te[6] = b;\n          te[10] = a * c;\n          break;\n        }\n\n      case Euler.ZYX:\n        {\n          const ae = a * e,\n                af = a * f,\n                be = b * e,\n                bf = b * f;\n          te[0] = c * e;\n          te[4] = be * d - af;\n          te[8] = ae * d + bf;\n          te[1] = c * f;\n          te[5] = bf * d + ae;\n          te[9] = af * d - be;\n          te[2] = -d;\n          te[6] = b * c;\n          te[10] = a * c;\n          break;\n        }\n\n      case Euler.YZX:\n        {\n          const ac = a * c,\n                ad = a * d,\n                bc = b * c,\n                bd = b * d;\n          te[0] = c * e;\n          te[4] = bd - ac * f;\n          te[8] = bc * f + ad;\n          te[1] = f;\n          te[5] = a * e;\n          te[9] = -b * e;\n          te[2] = -d * e;\n          te[6] = ad * f + bc;\n          te[10] = ac - bd * f;\n          break;\n        }\n\n      case Euler.XZY:\n        {\n          const ac = a * c,\n                ad = a * d,\n                bc = b * c,\n                bd = b * d;\n          te[0] = c * e;\n          te[4] = -f;\n          te[8] = d * e;\n          te[1] = ac * f + bd;\n          te[5] = a * e;\n          te[9] = ad * f - bc;\n          te[2] = bc * f - ad;\n          te[6] = b * e;\n          te[10] = bd * f + ac;\n          break;\n        }\n\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n\n    te[3] = 0;\n    te[7] = 0;\n    te[11] = 0;\n    te[12] = 0;\n    te[13] = 0;\n    te[14] = 0;\n    te[15] = 1;\n    return te;\n  }\n\n  toQuaternion() {\n    const cy = Math.cos(this.yaw * 0.5);\n    const sy = Math.sin(this.yaw * 0.5);\n    const cr = Math.cos(this.roll * 0.5);\n    const sr = Math.sin(this.roll * 0.5);\n    const cp = Math.cos(this.pitch * 0.5);\n    const sp = Math.sin(this.pitch * 0.5);\n    const w = cy * cr * cp + sy * sr * sp;\n    const x = cy * sr * cp - sy * cr * sp;\n    const y = cy * cr * sp + sy * sr * cp;\n    const z = sy * cr * cp - cy * sr * sp;\n    return new Quaternion(x, y, z, w);\n  }\n\n}\n//# sourceMappingURL=euler.js.map","function _extendableBuiltin(cls) {\n  function ExtendableBuiltin() {\n    var instance = Reflect.construct(cls, Array.from(arguments));\n    Object.setPrototypeOf(instance, Object.getPrototypeOf(this));\n    return instance;\n  }\n\n  ExtendableBuiltin.prototype = Object.create(cls.prototype, {\n    constructor: {\n      value: cls,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(ExtendableBuiltin, cls);\n  } else {\n    ExtendableBuiltin.__proto__ = cls;\n  }\n\n  return ExtendableBuiltin;\n}\n\nimport { config, formatValue, equals, isArray } from '../../lib/common';\nimport assert from '../../lib/assert';\nexport default class MathArray extends _extendableBuiltin(Array) {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  clone() {\n    return new this.constructor().copy(this);\n  }\n\n  from(arrayOrObject) {\n    return Array.isArray(arrayOrObject) ? this.copy(arrayOrObject) : this.fromObject(arrayOrObject);\n  }\n\n  fromArray(array, offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = array[i + offset];\n    }\n\n    return this.check();\n  }\n\n  to(arrayOrObject) {\n    if (arrayOrObject === this) {\n      return this;\n    }\n\n    return isArray(arrayOrObject) ? this.toArray(arrayOrObject) : this.toObject(arrayOrObject);\n  }\n\n  toTarget(target) {\n    return target ? this.to(target) : this;\n  }\n\n  toArray(array = [], offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      array[offset + i] = this[i];\n    }\n\n    return array;\n  }\n\n  toFloat32Array() {\n    return new Float32Array(this);\n  }\n\n  toString() {\n    return this.formatString(config);\n  }\n\n  formatString(opts) {\n    let string = '';\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      string += (i > 0 ? ', ' : '') + formatValue(this[i], opts);\n    }\n\n    return \"\".concat(opts.printTypes ? this.constructor.name : '', \"[\").concat(string, \"]\");\n  }\n\n  equals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (!equals(this[i], array[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  exactEquals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (this[i] !== array[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  negate() {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = -this[i];\n    }\n\n    return this.check();\n  }\n\n  lerp(a, b, t) {\n    if (t === undefined) {\n      t = b;\n      b = a;\n      a = this;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const ai = a[i];\n      this[i] = ai + t * (b[i] - ai);\n    }\n\n    return this.check();\n  }\n\n  min(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  max(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.max(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  clamp(minVector, maxVector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], minVector[i]), maxVector[i]);\n    }\n\n    return this.check();\n  }\n\n  add(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] += vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  subtract(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] -= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  scale(scale) {\n    if (Array.isArray(scale)) {\n      return this.multiply(scale);\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scale;\n    }\n\n    return this.check();\n  }\n\n  sub(a) {\n    return this.subtract(a);\n  }\n\n  setScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = a;\n    }\n\n    return this.check();\n  }\n\n  addScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] += a;\n    }\n\n    return this.check();\n  }\n\n  subScalar(a) {\n    return this.addScalar(-a);\n  }\n\n  multiplyScalar(scalar) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n\n    return this.check();\n  }\n\n  divideScalar(a) {\n    return this.scale(1 / a);\n  }\n\n  clampScalar(min, max) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], min), max);\n    }\n\n    return this.check();\n  }\n\n  multiplyByScalar(scalar) {\n    return this.scale(scalar);\n  }\n\n  get elements() {\n    return this;\n  }\n\n  check() {\n    if (config.debug && !this.validate()) {\n      throw new Error(\"math.gl: \".concat(this.constructor.name, \" some fields set to invalid numbers'\"));\n    }\n\n    return this;\n  }\n\n  validate() {\n    let valid = this.length === this.ELEMENTS;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      valid = valid && Number.isFinite(this[i]);\n    }\n\n    return valid;\n  }\n\n}\n//# sourceMappingURL=math-array.js.map","// Replacement for the external assert method to reduce bundle size\n// Note: We don't use the second \"message\" argument in calling code,\n// so no need to support it here\n\n/** Throws an `Error` with the optional `message` if `condition` is falsy */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n","import type {Loader} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\n\nexport function isLoaderObject(loader?: any): boolean {\n  if (!loader) {\n    return false;\n  }\n\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n\n  const hasExtensions = Array.isArray(loader?.extensions);\n\n  /* Now handled by types and worker loaders do not have these\n  let hasParser =\n    loader.parseTextSync ||\n    loader.parseSync ||\n    loader.parse ||\n    loader.parseStream || // TODO Remove, Replace with parseInBatches\n    loader.parseInBatches;\n  */\n\n  return hasExtensions;\n}\n\nexport function normalizeLoader(loader: Loader): Loader {\n  // This error is fairly easy to trigger by mixing up import statements etc\n  // So we make an exception and add a developer error message for this case\n  // To help new users from getting stuck here\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n\n  // NORMALIZE [LOADER, OPTIONS] => LOADER\n\n  // If [loader, options], create a new loaders object with options merged in\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {...loader.options, ...options}\n    };\n  }\n\n  // NORMALIZE text and binary flags\n  // Ensure at least one of text/binary flags are properly set\n\n  // @ts-expect-error\n  if (loader?.parseTextSync || loader?.parseText) {\n    loader.text = true;\n  }\n\n  if (!loader.text) {\n    loader.binary = true;\n  }\n\n  return loader;\n}\n","import isElectron from './is-electron';\nexport default function isBrowser() {\n  const isNode = typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || isElectron();\n}\nexport function isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","import Vector from './base/vector';\nimport { config, isArray } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { vec3_transformMat2, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nconst ORIGIN = [0, 0, 0];\nconst constants = {};\nexport default class Vector3 extends Vector {\n  static get ZERO() {\n    return constants.ZERO = constants.ZERO || Object.freeze(new Vector3(0, 0, 0, 0));\n  }\n\n  constructor(x = 0, y = 0, z = 0) {\n    super(-0, -0, -0);\n\n    if (arguments.length === 1 && isArray(x)) {\n      this.copy(x);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n      }\n\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n    }\n  }\n\n  set(x, y, z) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    return this.check();\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    return this.check();\n  }\n\n  fromObject(object) {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n    }\n\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    return this.check();\n  }\n\n  toObject(object) {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    return object;\n  }\n\n  get ELEMENTS() {\n    return 3;\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  angle(vector) {\n    return vec3.angle(this, vector);\n  }\n\n  cross(vector) {\n    vec3.cross(this, this, vector);\n    return this.check();\n  }\n\n  rotateX({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateX(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateY({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateY(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateZ({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateZ(this, this, origin, radians);\n    return this.check();\n  }\n\n  transform(matrix4) {\n    return this.transformAsPoint(matrix4);\n  }\n\n  transformAsPoint(matrix4) {\n    vec3.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformAsVector(matrix4) {\n    vec3_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3) {\n    vec3.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2) {\n    vec3_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion) {\n    vec3.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n\n}\n//# sourceMappingURL=vector3.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","export default function isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && typeof process.versions === 'object' && Boolean(process.versions.electron)) {\n    return true;\n  }\n\n  const realUserAgent = typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport assert from '../../lib/assert';\nexport default class Vector extends MathArray {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  copy(vector) {\n    assert(false);\n    return this;\n  }\n\n  get x() {\n    return this[0];\n  }\n\n  set x(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get y() {\n    return this[1];\n  }\n\n  set y(value) {\n    this[1] = checkNumber(value);\n  }\n\n  len() {\n    return Math.sqrt(this.lengthSquared());\n  }\n\n  magnitude() {\n    return this.len();\n  }\n\n  lengthSquared() {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      length += this[i] * this[i];\n    }\n\n    return length;\n  }\n\n  magnitudeSquared() {\n    return this.lengthSquared();\n  }\n\n  distance(mathArray) {\n    return Math.sqrt(this.distanceSquared(mathArray));\n  }\n\n  distanceSquared(mathArray) {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const dist = this[i] - mathArray[i];\n      length += dist * dist;\n    }\n\n    return checkNumber(length);\n  }\n\n  dot(mathArray) {\n    let product = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      product += this[i] * mathArray[i];\n    }\n\n    return checkNumber(product);\n  }\n\n  normalize() {\n    const length = this.magnitude();\n\n    if (length !== 0) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= length;\n      }\n    }\n\n    return this.check();\n  }\n\n  multiply(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  divide(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  lengthSq() {\n    return this.lengthSquared();\n  }\n\n  distanceTo(vector) {\n    return this.distance(vector);\n  }\n\n  distanceToSquared(vector) {\n    return this.distanceSquared(vector);\n  }\n\n  getComponent(i) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    return checkNumber(this[i]);\n  }\n\n  setComponent(i, value) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    this[i] = value;\n    return this.check();\n  }\n\n  addVectors(a, b) {\n    return this.copy(a).add(b);\n  }\n\n  subVectors(a, b) {\n    return this.copy(a).subtract(b);\n  }\n\n  multiplyVectors(a, b) {\n    return this.copy(a).multiply(b);\n  }\n\n  addScaledVector(a, b) {\n    return this.add(new this.constructor(a).multiplyScalar(b));\n  }\n\n}\n//# sourceMappingURL=vector.js.map","import { checkVector, deprecated } from '../lib/validators';\nimport Matrix from './base/matrix';\nimport { vec2_transformMat4AsVector, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport * as vec4 from 'gl-matrix/vec4';\nconst IDENTITY = Object.freeze([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\nconst ZERO = Object.freeze([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\nconst INDICES = Object.freeze({\n  COL0ROW0: 0,\n  COL0ROW1: 1,\n  COL0ROW2: 2,\n  COL0ROW3: 3,\n  COL1ROW0: 4,\n  COL1ROW1: 5,\n  COL1ROW2: 6,\n  COL1ROW3: 7,\n  COL2ROW0: 8,\n  COL2ROW1: 9,\n  COL2ROW2: 10,\n  COL2ROW3: 11,\n  COL3ROW0: 12,\n  COL3ROW1: 13,\n  COL3ROW2: 14,\n  COL3ROW3: 15\n});\nconst constants = {};\nexport default class Matrix4 extends Matrix {\n  static get IDENTITY() {\n    constants.IDENTITY = constants.IDENTITY || Object.freeze(new Matrix4(IDENTITY));\n    return constants.IDENTITY;\n  }\n\n  static get ZERO() {\n    constants.ZERO = constants.ZERO || Object.freeze(new Matrix4(ZERO));\n    return constants.ZERO;\n  }\n\n  get INDICES() {\n    return INDICES;\n  }\n\n  get ELEMENTS() {\n    return 16;\n  }\n\n  get RANK() {\n    return 4;\n  }\n\n  constructor(array) {\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0);\n\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    this[9] = array[9];\n    this[10] = array[10];\n    this[11] = array[11];\n    this[12] = array[12];\n    this[13] = array[13];\n    this[14] = array[14];\n    this[15] = array[15];\n    return this.check();\n  }\n\n  set(m00, m10, m20, m30, m01, m11, m21, m31, m02, m12, m22, m32, m03, m13, m23, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  setRowMajor(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  toRowMajor(result) {\n    result[0] = this[0];\n    result[1] = this[4];\n    result[2] = this[8];\n    result[3] = this[12];\n    result[4] = this[1];\n    result[5] = this[5];\n    result[6] = this[9];\n    result[7] = this[13];\n    result[8] = this[2];\n    result[9] = this[6];\n    result[10] = this[10];\n    result[11] = this[14];\n    result[12] = this[3];\n    result[13] = this[7];\n    result[14] = this[11];\n    result[15] = this[15];\n    return result;\n  }\n\n  identity() {\n    return this.copy(IDENTITY);\n  }\n\n  fromQuaternion(q) {\n    mat4.fromQuat(this, q);\n    return this.check();\n  }\n\n  frustum({\n    left,\n    right,\n    bottom,\n    top,\n    near,\n    far\n  }) {\n    if (far === Infinity) {\n      Matrix4._computeInfinitePerspectiveOffCenter(this, left, right, bottom, top, near);\n    } else {\n      mat4.frustum(this, left, right, bottom, top, near, far);\n    }\n\n    return this.check();\n  }\n\n  static _computeInfinitePerspectiveOffCenter(result, left, right, bottom, top, near) {\n    const column0Row0 = 2.0 * near / (right - left);\n    const column1Row1 = 2.0 * near / (top - bottom);\n    const column2Row0 = (right + left) / (right - left);\n    const column2Row1 = (top + bottom) / (top - bottom);\n    const column2Row2 = -1.0;\n    const column2Row3 = -1.0;\n    const column3Row2 = -2.0 * near;\n    result[0] = column0Row0;\n    result[1] = 0.0;\n    result[2] = 0.0;\n    result[3] = 0.0;\n    result[4] = 0.0;\n    result[5] = column1Row1;\n    result[6] = 0.0;\n    result[7] = 0.0;\n    result[8] = column2Row0;\n    result[9] = column2Row1;\n    result[10] = column2Row2;\n    result[11] = column2Row3;\n    result[12] = 0.0;\n    result[13] = 0.0;\n    result[14] = column3Row2;\n    result[15] = 0.0;\n    return result;\n  }\n\n  lookAt(eye, center, up) {\n    if (arguments.length === 1) {\n      ({\n        eye,\n        center,\n        up\n      } = eye);\n    }\n\n    center = center || [0, 0, 0];\n    up = up || [0, 1, 0];\n    mat4.lookAt(this, eye, center, up);\n    return this.check();\n  }\n\n  ortho({\n    left,\n    right,\n    bottom,\n    top,\n    near = 0.1,\n    far = 500\n  }) {\n    mat4.ortho(this, left, right, bottom, top, near, far);\n    return this.check();\n  }\n\n  orthographic({\n    fovy = 45 * Math.PI / 180,\n    aspect = 1,\n    focalDistance = 1,\n    near = 0.1,\n    far = 500\n  }) {\n    if (fovy > Math.PI * 2) {\n      throw Error('radians');\n    }\n\n    const halfY = fovy / 2;\n    const top = focalDistance * Math.tan(halfY);\n    const right = top * aspect;\n    return new Matrix4().ortho({\n      left: -right,\n      right,\n      bottom: -top,\n      top,\n      near,\n      far\n    });\n  }\n\n  perspective({\n    fovy = undefined,\n    fov = 45 * Math.PI / 180,\n    aspect = 1,\n    near = 0.1,\n    far = 500\n  } = {}) {\n    fovy = fovy || fov;\n\n    if (fovy > Math.PI * 2) {\n      throw Error('radians');\n    }\n\n    mat4.perspective(this, fovy, aspect, near, far);\n    return this.check();\n  }\n\n  determinant() {\n    return mat4.determinant(this);\n  }\n\n  getScale(result = [-0, -0, -0]) {\n    result[0] = Math.sqrt(this[0] * this[0] + this[1] * this[1] + this[2] * this[2]);\n    result[1] = Math.sqrt(this[4] * this[4] + this[5] * this[5] + this[6] * this[6]);\n    result[2] = Math.sqrt(this[8] * this[8] + this[9] * this[9] + this[10] * this[10]);\n    return result;\n  }\n\n  getTranslation(result = [-0, -0, -0]) {\n    result[0] = this[12];\n    result[1] = this[13];\n    result[2] = this[14];\n    return result;\n  }\n\n  getRotation(result = [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0], scaleResult = null) {\n    const scale = this.getScale(scaleResult || [-0, -0, -0]);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = 0;\n    result[4] = this[4] * inverseScale0;\n    result[5] = this[5] * inverseScale1;\n    result[6] = this[6] * inverseScale2;\n    result[7] = 0;\n    result[8] = this[8] * inverseScale0;\n    result[9] = this[9] * inverseScale1;\n    result[10] = this[10] * inverseScale2;\n    result[11] = 0;\n    result[12] = 0;\n    result[13] = 0;\n    result[14] = 0;\n    result[15] = 1;\n    return result;\n  }\n\n  getRotationMatrix3(result = [-0, -0, -0, -0, -0, -0, -0, -0, -0], scaleResult = null) {\n    const scale = this.getScale(scaleResult || [-0, -0, -0]);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = this[4] * inverseScale0;\n    result[4] = this[5] * inverseScale1;\n    result[5] = this[6] * inverseScale2;\n    result[6] = this[8] * inverseScale0;\n    result[7] = this[9] * inverseScale1;\n    result[8] = this[10] * inverseScale2;\n    return result;\n  }\n\n  transpose() {\n    mat4.transpose(this, this);\n    return this.check();\n  }\n\n  invert() {\n    mat4.invert(this, this);\n    return this.check();\n  }\n\n  multiplyLeft(a) {\n    mat4.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a) {\n    mat4.multiply(this, this, a);\n    return this.check();\n  }\n\n  rotateX(radians) {\n    mat4.rotateX(this, this, radians);\n    return this.check();\n  }\n\n  rotateY(radians) {\n    mat4.rotateY(this, this, radians);\n    return this.check();\n  }\n\n  rotateZ(radians) {\n    mat4.rotateZ(this, this, radians);\n    return this.check();\n  }\n\n  rotateXYZ([rx, ry, rz]) {\n    return this.rotateX(rx).rotateY(ry).rotateZ(rz);\n  }\n\n  rotateAxis(radians, axis) {\n    mat4.rotate(this, this, radians, axis);\n    return this.check();\n  }\n\n  scale(factor) {\n    if (Array.isArray(factor)) {\n      mat4.scale(this, this, factor);\n    } else {\n      mat4.scale(this, this, [factor, factor, factor]);\n    }\n\n    return this.check();\n  }\n\n  translate(vec) {\n    mat4.translate(this, this, vec);\n    return this.check();\n  }\n\n  transform(vector, result) {\n    if (vector.length === 4) {\n      result = vec4.transformMat4(result || [-0, -0, -0, -0], vector, this);\n      checkVector(result, 4);\n      return result;\n    }\n\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformAsPoint(vector, result) {\n    const {\n      length\n    } = vector;\n\n    switch (length) {\n      case 2:\n        result = vec2.transformMat4(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        result = vec3.transformMat4(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(result, vector.length);\n    return result;\n  }\n\n  transformAsVector(vector, result) {\n    switch (vector.length) {\n      case 2:\n        result = vec2_transformMat4AsVector(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        result = vec3_transformMat4AsVector(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(result, vector.length);\n    return result;\n  }\n\n  makeRotationX(radians) {\n    return this.identity().rotateX(radians);\n  }\n\n  makeTranslation(x, y, z) {\n    return this.identity().translate([x, y, z]);\n  }\n\n  transformPoint(vector, result) {\n    deprecated('Matrix4.transformPoint', '3.0');\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformVector(vector, result) {\n    deprecated('Matrix4.transformVector', '3.0');\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformDirection(vector, result) {\n    deprecated('Matrix4.transformDirection', '3.0');\n    return this.transformAsVector(vector, result);\n  }\n\n}\n//# sourceMappingURL=matrix4.js.map","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import {isResponse, isBlob} from '../../javascript-utils/is-type';\nimport {parseMIMEType, parseMIMETypeFromURL} from './mime-type-utils';\n\nconst QUERY_STRING_PATTERN = /\\?.*/;\n\n/**\n * Returns an object with `url` and (MIME) `type` fields\n * If it cannot determine url or type, the corresponding value will be an empty string\n *\n * @param resource Any type, but only Responses, string URLs and data URLs are processed\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceUrlAndType(resource: any): {url: string; type: string} {\n  // If resource is a response, it contains the information directly\n  if (isResponse(resource)) {\n    const url = stripQueryString(resource.url || '');\n    const contentTypeHeader = resource.headers.get('content-type') || '';\n    return {\n      url,\n      type: parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(url)\n    };\n  }\n\n  // If the resource is a Blob or a File (subclass of Blob)\n  if (isBlob(resource)) {\n    return {\n      // File objects have a \"name\" property. Blob objects don't have any\n      // url (name) information\n      url: stripQueryString(resource.name || ''),\n      type: resource.type || ''\n    };\n  }\n\n  if (typeof resource === 'string') {\n    return {\n      // TODO this could mess up data URL but it doesn't matter as it is just used for inference\n      url: stripQueryString(resource),\n      // If a data url\n      type: parseMIMETypeFromURL(resource)\n    };\n  }\n\n  // Unknown\n  return {\n    url: '',\n    type: ''\n  };\n}\n\n/**\n  * Returns (approximate) content length for a resource if it can be determined.\n  * Returns -1 if content length cannot be determined.\n  * @param resource\n\n  * @note string parameters are NOT assumed to be URLs\n  */\nexport function getResourceContentLength(resource: any): number {\n  if (isResponse(resource)) {\n    return resource.headers['content-length'] || -1;\n  }\n  if (isBlob(resource)) {\n    return resource.size;\n  }\n  if (typeof resource === 'string') {\n    // TODO - handle data URL?\n    return resource.length;\n  }\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n  return -1;\n}\n\nfunction stripQueryString(url) {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n","export const TILE_CONTENT_STATE = {\n  UNLOADED: 0, // Has never been requested\n  LOADING: 1, // Is waiting on a pending request\n  PROCESSING: 2, // Request received.  Contents are being processed for rendering.  Depending on the content, it might make its own requests for external data.\n  READY: 3, // Ready to render.\n  EXPIRED: 4, // Is expired and will be unloaded once new content is loaded.\n  FAILED: 5 // Request failed.\n};\n\nexport const TILE_REFINEMENT = {\n  ADD: 1, // Render tile and, if screen space error exceeded, also refine to its children.\n  REPLACE: 2 // Render tile or, if screen space error exceeded, refine to its descendants instead.\n};\n\nexport const TILE_TYPE = {\n  EMPTY: 'empty',\n  SCENEGRAPH: 'scenegraph',\n  POINTCLOUD: 'pointcloud',\n  MESH: 'mesh'\n};\n\nexport const TILESET_TYPE = {\n  I3S: 'I3S',\n  TILES3D: 'TILES3D'\n};\n\nexport const LOD_METRIC_TYPE = {\n  GEOMETRIC_ERROR: 'geometricError',\n  MAX_SCREEN_THRESHOLD: 'maxScreenThreshold'\n};\n\n// Cesium 3D Tiles Specific\nexport const TILE3D_OPTIMIZATION_HINT = {\n  NOT_COMPUTED: -1,\n  USE_OPTIMIZATION: 1,\n  SKIP_OPTIMIZATION: 0\n};\n","import ManagedArray from '../../utils/managed-array';\nimport {TILE_REFINEMENT} from '../../constants';\n\nexport type TilesetTraverserProps = {\n  loadSiblings?: boolean;\n  skipLevelOfDetail?: boolean;\n  maximumScreenSpaceError?: number;\n  onTraversalEnd?: (frameState) => any;\n  viewportTraversersMap?: {[key: string]: any};\n  basePath?: string;\n};\n\nexport type Props = {\n  loadSiblings: boolean;\n  skipLevelOfDetail: boolean;\n  updateTransforms: boolean;\n  maximumScreenSpaceError: number;\n  onTraversalEnd: (frameState) => any;\n  viewportTraversersMap: {[key: string]: any};\n  basePath: string;\n};\n\nexport const DEFAULT_PROPS: Props = {\n  loadSiblings: false,\n  skipLevelOfDetail: false,\n  maximumScreenSpaceError: 2,\n  updateTransforms: true,\n  onTraversalEnd: () => {},\n  viewportTraversersMap: {},\n  basePath: ''\n};\n\nexport default class TilesetTraverser {\n  options: Props;\n\n  root: any;\n  requestedTiles: object;\n  selectedTiles: object;\n  emptyTiles: object;\n\n  protected _traversalStack: ManagedArray;\n  protected _emptyTraversalStack: ManagedArray;\n  protected _frameNumber: number | null;\n\n  // TODO nested props\n  constructor(options: TilesetTraverserProps) {\n    this.options = {...DEFAULT_PROPS, ...options};\n    // TRAVERSAL\n    // temporary storage to hold the traversed tiles during a traversal\n    this._traversalStack = new ManagedArray();\n    this._emptyTraversalStack = new ManagedArray();\n\n    // set in every traverse cycle\n    this._frameNumber = null;\n\n    // fulfill in traverse call\n    this.root = null;\n\n    // RESULT\n    // tiles should be rendered\n    this.selectedTiles = {};\n    // tiles should be loaded from server\n    this.requestedTiles = {};\n    // tiles does not have render content\n    this.emptyTiles = {};\n  }\n\n  // tiles should be visible\n  traverse(root, frameState, options) {\n    this.root = root; // for root screen space error\n    this.options = {...this.options, ...options};\n\n    // reset result\n    this.reset();\n\n    // update tile (visibility and expiration)\n    this.updateTile(root, frameState);\n\n    this._frameNumber = frameState.frameNumber;\n    this.executeTraversal(root, frameState);\n  }\n\n  reset() {\n    this.requestedTiles = {};\n    this.selectedTiles = {};\n    this.emptyTiles = {};\n    this._traversalStack.reset();\n    this._emptyTraversalStack.reset();\n  }\n\n  // execute traverse\n  // Depth-first traversal that traverses all visible tiles and marks tiles for selection.\n  // If skipLevelOfDetail is off then a tile does not refine until all children are loaded.\n  // This is the traditional replacement refinement approach and is called the base traversal.\n  // Tiles that have a greater screen space error than the base screen space error are part of the base traversal,\n  // all other tiles are part of the skip traversal. The skip traversal allows for skipping levels of the tree\n  // and rendering children and parent tiles simultaneously.\n  /* eslint-disable-next-line complexity, max-statements */\n  executeTraversal(root, frameState) {\n    // stack to store traversed tiles, only visible tiles should be added to stack\n    // visible: visible in the current view frustum\n    const stack = this._traversalStack;\n    root._selectionDepth = 1;\n\n    stack.push(root);\n    while (stack.length > 0) {\n      // 1. pop tile\n      const tile = stack.pop();\n\n      // 2. check if tile needs to be refine, needs refine if a tile's LoD is not sufficient and tile has available children (available content)\n      let shouldRefine = false;\n      if (this.canTraverse(tile, frameState)) {\n        this.updateChildTiles(tile, frameState);\n        shouldRefine = this.updateAndPushChildren(\n          tile,\n          frameState,\n          stack,\n          tile.hasRenderContent ? tile._selectionDepth + 1 : tile._selectionDepth\n        );\n      }\n\n      // 3. decide if should render (select) this tile\n      //   - tile does not have render content\n      //   - tile has render content and tile is `add` type (pointcloud)\n      //   - tile has render content and tile is `replace` type (photogrammetry) and can't refine any further\n      const parent = tile.parent;\n      const parentRefines = Boolean(!parent || parent._shouldRefine);\n      const stoppedRefining = !shouldRefine;\n\n      if (!tile.hasRenderContent) {\n        this.emptyTiles[tile.id] = tile;\n        this.loadTile(tile, frameState);\n        if (stoppedRefining) {\n          this.selectTile(tile, frameState);\n        }\n        // additive tiles\n      } else if (tile.refine === TILE_REFINEMENT.ADD) {\n        // Additive tiles are always loaded and selected\n        this.loadTile(tile, frameState);\n        this.selectTile(tile, frameState);\n\n        // replace tiles\n      } else if (tile.refine === TILE_REFINEMENT.REPLACE) {\n        // Always load tiles in the base traversal\n        // Select tiles that can't refine further\n        this.loadTile(tile, frameState);\n        if (stoppedRefining) {\n          this.selectTile(tile, frameState);\n        }\n      }\n\n      // 3. update cache, most recent touched tiles have higher priority to be fetched from server\n      this.touchTile(tile, frameState);\n\n      // 4. update tile refine prop and parent refinement status to trickle down to the descendants\n      tile._shouldRefine = shouldRefine && parentRefines;\n    }\n\n    this.options.onTraversalEnd(frameState);\n  }\n\n  updateChildTiles(tile, frameState) {\n    const children = tile.children;\n    for (const child of children) {\n      this.updateTile(child, frameState);\n    }\n    return true;\n  }\n\n  /* eslint-disable complexity, max-statements */\n  updateAndPushChildren(tile, frameState, stack, depth) {\n    const {loadSiblings, skipLevelOfDetail} = this.options;\n\n    const children = tile.children;\n\n    // sort children tiles\n    children.sort(this.compareDistanceToCamera.bind(this));\n\n    // For traditional replacement refinement only refine if all children are loaded.\n    // Empty tiles are exempt since it looks better if children stream in as they are loaded to fill the empty space.\n    const checkRefines =\n      tile.refine === TILE_REFINEMENT.REPLACE && tile.hasRenderContent && !skipLevelOfDetail;\n\n    let hasVisibleChild = false;\n    let refines = true;\n\n    for (const child of children) {\n      child._selectionDepth = depth;\n      if (child.isVisibleAndInRequestVolume) {\n        if (stack.find(child)) {\n          stack.delete(child);\n        }\n        stack.push(child);\n        hasVisibleChild = true;\n      } else if (checkRefines || loadSiblings) {\n        // Keep non-visible children loaded since they are still needed before the parent can refine.\n        // Or loadSiblings is true so always load tiles regardless of visibility.\n        this.loadTile(child, frameState);\n        this.touchTile(child, frameState);\n      }\n\n      if (checkRefines) {\n        let childRefines;\n        if (!child._inRequestVolume) {\n          childRefines = false;\n        } else if (!child.hasRenderContent) {\n          childRefines = this.executeEmptyTraversal(child, frameState);\n        } else {\n          childRefines = child.contentAvailable;\n        }\n        refines = refines && childRefines;\n\n        if (!refines) {\n          return false;\n        }\n      }\n    }\n\n    if (!hasVisibleChild) {\n      refines = false;\n    }\n    return refines;\n  }\n  /* eslint-enable complexity, max-statements */\n\n  updateTile(tile, frameState) {\n    this.updateTileVisibility(tile, frameState);\n  }\n\n  // tile to render in the browser\n  selectTile(tile, frameState) {\n    if (this.shouldSelectTile(tile)) {\n      // The tile can be selected right away and does not require traverseAndSelect\n      tile._selectedFrame = frameState.frameNumber;\n      this.selectedTiles[tile.id] = tile;\n    }\n  }\n\n  // tile to load from server\n  loadTile(tile, frameState) {\n    if (this.shouldLoadTile(tile)) {\n      tile._requestedFrame = frameState.frameNumber;\n      tile._priority = tile._getPriority();\n      this.requestedTiles[tile.id] = tile;\n    }\n  }\n\n  // cache tile\n  touchTile(tile, frameState) {\n    tile.tileset._cache.touch(tile);\n    tile._touchedFrame = frameState.frameNumber;\n  }\n\n  // tile should be visible\n  // tile should have children\n  // tile LoD (level of detail) is not sufficient under current viewport\n  canTraverse(tile, frameState, useParentMetric = false, ignoreVisibility = false) {\n    if (!tile.hasChildren) {\n      return false;\n    }\n\n    // cesium specific\n    if (tile.hasTilesetContent) {\n      // Traverse external this to visit its root tile\n      // Don't traverse if the subtree is expired because it will be destroyed\n      return !tile.contentExpired;\n    }\n\n    if (!ignoreVisibility && !tile.isVisibleAndInRequestVolume) {\n      return false;\n    }\n\n    return this.shouldRefine(tile, frameState, useParentMetric);\n  }\n\n  shouldLoadTile(tile) {\n    // if request tile is in current frame\n    // and has unexpired render content\n    return tile.hasUnloadedContent || tile.contentExpired;\n  }\n\n  shouldSelectTile(tile) {\n    // if select tile is in current frame\n    // and content available\n    return tile.contentAvailable && !this.options.skipLevelOfDetail;\n  }\n\n  // Decide if tile LoD (level of detail) is not sufficient under current viewport\n  shouldRefine(tile, frameState, useParentMetric) {\n    let screenSpaceError = tile._screenSpaceError;\n    if (useParentMetric) {\n      screenSpaceError = tile.getScreenSpaceError(frameState, true);\n    }\n\n    return screenSpaceError > this.options.maximumScreenSpaceError;\n  }\n\n  updateTileVisibility(tile, frameState) {\n    const viewportIds: string[] = [];\n    if (this.options.viewportTraversersMap) {\n      for (const key in this.options.viewportTraversersMap) {\n        const value = this.options.viewportTraversersMap[key];\n        if (value === frameState.viewport.id) {\n          viewportIds.push(key);\n        }\n      }\n    } else {\n      viewportIds.push(frameState.viewport.id);\n    }\n    tile.updateVisibility(frameState, viewportIds);\n  }\n\n  // UTILITIES\n\n  compareDistanceToCamera(b, a) {\n    return b._distanceToCamera - a._distanceToCamera;\n  }\n\n  anyChildrenVisible(tile, frameState) {\n    let anyVisible = false;\n    for (const child of tile.children) {\n      child.updateVisibility(frameState);\n      anyVisible = anyVisible || child.isVisibleAndInRequestVolume;\n    }\n    return anyVisible;\n  }\n\n  // Depth-first traversal that checks if all nearest descendants with content are loaded.\n  // Ignores visibility.\n  executeEmptyTraversal(root, frameState) {\n    let allDescendantsLoaded = true;\n    const stack = this._emptyTraversalStack;\n\n    stack.push(root);\n\n    while (stack.length > 0 && allDescendantsLoaded) {\n      const tile = stack.pop();\n\n      this.updateTile(tile, frameState);\n\n      if (!tile.isVisibleAndInRequestVolume) {\n        // Load tiles that aren't visible since they are still needed for the parent to refine\n        this.loadTile(tile, frameState);\n      }\n\n      this.touchTile(tile, frameState);\n\n      // Only traverse if the tile is empty - traversal stop at descendants with content\n      const traverse = !tile.hasRenderContent && this.canTraverse(tile, frameState, false, true);\n\n      if (traverse) {\n        const children = tile.children;\n        for (const child of children) {\n          // eslint-disable-next-line max-depth\n          if (stack.find(child)) {\n            stack.delete(child);\n          }\n          stack.push(child);\n        }\n      } else if (!tile.contentAvailable) {\n        allDescendantsLoaded = false;\n      }\n    }\n\n    return allDescendantsLoaded;\n  }\n}\n\n// TODO\n// enable expiration\n// enable optimization hint\n","import getHiResTimestamp from '../utils/hi-res-timestamp';\nexport default class Stat {\n  constructor(name, type) {\n    this.name = name;\n    this.type = type;\n    this.sampleSize = 1;\n    this.reset();\n  }\n\n  setSampleSize(samples) {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  incrementCount() {\n    this.addCount(1);\n    return this;\n  }\n\n  decrementCount() {\n    this.subtractCount(1);\n    return this;\n  }\n\n  addCount(value) {\n    this._count += value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  subtractCount(value) {\n    this._count -= value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  addTime(time) {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  timeStart() {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n    return this;\n  }\n\n  timeEnd() {\n    if (!this._timerPending) {\n      return this;\n    }\n\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount() {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  getSampleAverageTime() {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  getSampleHz() {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount() {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  getAverageTime() {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  getHz() {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset() {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n    return this;\n  }\n\n  _checkSampling() {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n\n}\n//# sourceMappingURL=stat.js.map","import Stat from './stat';\nexport default class Stats {\n  constructor({\n    id,\n    stats\n  }) {\n    this.id = id;\n    this.stats = {};\n\n    this._initializeStats(stats);\n\n    Object.seal(this);\n  }\n\n  get(name, type = 'count') {\n    return this._getOrCreate({\n      name,\n      type\n    });\n  }\n\n  get size() {\n    return Object.keys(this.stats).length;\n  }\n\n  reset() {\n    for (const key in this.stats) {\n      this.stats[key].reset();\n    }\n\n    return this;\n  }\n\n  forEach(fn) {\n    for (const key in this.stats) {\n      fn(this.stats[key]);\n    }\n  }\n\n  getTable() {\n    const table = {};\n    this.forEach(stat => {\n      table[stat.name] = {\n        time: stat.time || 0,\n        count: stat.count || 0,\n        average: stat.getAverageTime() || 0,\n        hz: stat.getHz() || 0\n      };\n    });\n    return table;\n  }\n\n  _initializeStats(stats = []) {\n    stats.forEach(stat => this._getOrCreate(stat));\n  }\n\n  _getOrCreate(stat) {\n    if (!stat || !stat.name) {\n      return null;\n    }\n\n    const {\n      name,\n      type\n    } = stat;\n\n    if (!this.stats[name]) {\n      if (stat instanceof Stat) {\n        this.stats[name] = stat;\n      } else {\n        this.stats[name] = new Stat(name, type);\n      }\n    }\n\n    return this.stats[name];\n  }\n\n}\n//# sourceMappingURL=stats.js.map","export default function getHiResTimestamp() {\n  let timestamp;\n\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import MathArray from './base/math-array';\nimport { checkNumber, checkVector } from '../lib/validators';\nimport assert from '../lib/assert';\nimport * as quat from 'gl-matrix/quat';\nimport * as vec4 from 'gl-matrix/vec4';\nconst IDENTITY_QUATERNION = [0, 0, 0, 1];\nexport default class Quaternion extends MathArray {\n  constructor(x = 0, y = 0, z = 0, w = 1) {\n    super(-0, -0, -0, -0);\n\n    if (Array.isArray(x) && arguments.length === 1) {\n      this.copy(x);\n    } else {\n      this.set(x, y, z, w);\n    }\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    return this.check();\n  }\n\n  set(x, y, z, w) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = w;\n    return this.check();\n  }\n\n  fromMatrix3(m) {\n    quat.fromMat3(this, m);\n    return this.check();\n  }\n\n  identity() {\n    quat.identity(this);\n    return this.check();\n  }\n\n  fromAxisRotation(axis, rad) {\n    quat.setAxisAngle(this, axis, rad);\n    return this.check();\n  }\n\n  setAxisAngle(axis, rad) {\n    return this.fromAxisRotation(axis, rad);\n  }\n\n  get ELEMENTS() {\n    return 4;\n  }\n\n  get x() {\n    return this[0];\n  }\n\n  set x(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get y() {\n    return this[1];\n  }\n\n  set y(value) {\n    this[1] = checkNumber(value);\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get w() {\n    return this[3];\n  }\n\n  set w(value) {\n    this[3] = checkNumber(value);\n  }\n\n  len() {\n    return quat.length(this);\n  }\n\n  lengthSquared() {\n    return quat.squaredLength(this);\n  }\n\n  dot(a, b) {\n    if (b !== undefined) {\n      throw new Error('Quaternion.dot only takes one argument');\n    }\n\n    return quat.dot(this, a);\n  }\n\n  rotationTo(vectorA, vectorB) {\n    quat.rotationTo(this, vectorA, vectorB);\n    return this.check();\n  }\n\n  add(a, b) {\n    if (b !== undefined) {\n      throw new Error('Quaternion.add only takes one argument');\n    }\n\n    quat.add(this, this, a);\n    return this.check();\n  }\n\n  calculateW() {\n    quat.calculateW(this, this);\n    return this.check();\n  }\n\n  conjugate() {\n    quat.conjugate(this, this);\n    return this.check();\n  }\n\n  invert() {\n    quat.invert(this, this);\n    return this.check();\n  }\n\n  lerp(a, b, t) {\n    quat.lerp(this, a, b, t);\n    return this.check();\n  }\n\n  multiplyRight(a, b) {\n    assert(!b);\n    quat.multiply(this, this, a);\n    return this.check();\n  }\n\n  multiplyLeft(a, b) {\n    assert(!b);\n    quat.multiply(this, a, this);\n    return this.check();\n  }\n\n  normalize() {\n    const length = this.len();\n    const l = length > 0 ? 1 / length : 0;\n    this[0] = this[0] * l;\n    this[1] = this[1] * l;\n    this[2] = this[2] * l;\n    this[3] = this[3] * l;\n\n    if (length === 0) {\n      this[3] = 1;\n    }\n\n    return this.check();\n  }\n\n  rotateX(rad) {\n    quat.rotateX(this, this, rad);\n    return this.check();\n  }\n\n  rotateY(rad) {\n    quat.rotateY(this, this, rad);\n    return this.check();\n  }\n\n  rotateZ(rad) {\n    quat.rotateZ(this, this, rad);\n    return this.check();\n  }\n\n  scale(b) {\n    quat.scale(this, this, b);\n    return this.check();\n  }\n\n  slerp(start, target, ratio) {\n    switch (arguments.length) {\n      case 1:\n        ({\n          start = IDENTITY_QUATERNION,\n          target,\n          ratio\n        } = arguments[0]);\n        break;\n\n      case 2:\n        [target, ratio] = arguments;\n        start = this;\n        break;\n\n      default:\n    }\n\n    quat.slerp(this, start, target, ratio);\n    return this.check();\n  }\n\n  transformVector4(vector, result = vector) {\n    vec4.transformQuat(result, vector, this);\n    return checkVector(result, 4);\n  }\n\n  lengthSq() {\n    return this.lengthSquared();\n  }\n\n  setFromAxisAngle(axis, rad) {\n    return this.setAxisAngle(axis, rad);\n  }\n\n  premultiply(a, b) {\n    return this.multiplyLeft(a, b);\n  }\n\n  multiply(a, b) {\n    return this.multiplyRight(a, b);\n  }\n\n}\n//# sourceMappingURL=quaternion.js.map","import { formatValue, equals, config } from '../lib/common';\nimport { degrees, radians, clamp } from '../lib/common';\nimport Vector3 from './vector3';\nimport * as vec3 from 'gl-matrix/vec3';\nconst EPSILON = 0.000001;\nconst EARTH_RADIUS_METERS = 6.371e6;\nexport default class SphericalCoordinates {\n  constructor({\n    phi = 0,\n    theta = 0,\n    radius = 1,\n    bearing = undefined,\n    pitch = undefined,\n    altitude = undefined,\n    radiusScale = EARTH_RADIUS_METERS\n  } = {}) {\n    this.phi = phi;\n    this.theta = theta;\n    this.radius = radius || altitude || 1;\n    this.radiusScale = radiusScale || 1;\n\n    if (bearing !== undefined) {\n      this.bearing = bearing;\n    }\n\n    if (pitch !== undefined) {\n      this.pitch = pitch;\n    }\n\n    this.check();\n  }\n\n  toString() {\n    return this.formatString(config);\n  }\n\n  formatString({\n    printTypes = false\n  }) {\n    const f = formatValue;\n    return \"\".concat(printTypes ? 'Spherical' : '', \"[rho:\").concat(f(this.radius), \",theta:\").concat(f(this.theta), \",phi:\").concat(f(this.phi), \"]\");\n  }\n\n  equals(other) {\n    return equals(this.radius, other.radius) && equals(this.theta, other.theta) && equals(this.phi, other.phi);\n  }\n\n  exactEquals(other) {\n    return this.radius === other.radius && this.theta === other.theta && this.phi === other.phi;\n  }\n\n  get bearing() {\n    return 180 - degrees(this.phi);\n  }\n\n  set bearing(v) {\n    this.phi = Math.PI - radians(v);\n  }\n\n  get pitch() {\n    return degrees(this.theta);\n  }\n\n  set pitch(v) {\n    this.theta = radians(v);\n  }\n\n  get longitude() {\n    return degrees(this.phi);\n  }\n\n  get latitude() {\n    return degrees(this.theta);\n  }\n\n  get lng() {\n    return degrees(this.phi);\n  }\n\n  get lat() {\n    return degrees(this.theta);\n  }\n\n  get z() {\n    return (this.radius - 1) * this.radiusScale;\n  }\n\n  set(radius, phi, theta) {\n    this.radius = radius;\n    this.phi = phi;\n    this.theta = theta;\n    return this.check();\n  }\n\n  clone() {\n    return new SphericalCoordinates().copy(this);\n  }\n\n  copy(other) {\n    this.radius = other.radius;\n    this.phi = other.phi;\n    this.theta = other.theta;\n    return this.check();\n  }\n\n  fromLngLatZ([lng, lat, z]) {\n    this.radius = 1 + z / this.radiusScale;\n    this.phi = radians(lat);\n    this.theta = radians(lng);\n  }\n\n  fromVector3(v) {\n    this.radius = vec3.length(v);\n\n    if (this.radius > 0) {\n      this.theta = Math.atan2(v[0], v[1]);\n      this.phi = Math.acos(clamp(v[2] / this.radius, -1, 1));\n    }\n\n    return this.check();\n  }\n\n  toVector3() {\n    return new Vector3(0, 0, this.radius).rotateX({\n      radians: this.theta\n    }).rotateZ({\n      radians: this.phi\n    });\n  }\n\n  makeSafe() {\n    this.phi = Math.max(EPSILON, Math.min(Math.PI - EPSILON, this.phi));\n    return this;\n  }\n\n  check() {\n    if (!Number.isFinite(this.phi) || !Number.isFinite(this.theta) || !(this.radius > 0)) {\n      throw new Error('SphericalCoordinates: some fields set to invalid numbers');\n    }\n\n    return this;\n  }\n\n}\n//# sourceMappingURL=spherical-coordinates.js.map","import Matrix4 from './matrix4';\nimport Vector3 from './vector3';\nimport Euler from './euler';\nexport default class Pose {\n  constructor({\n    x = 0,\n    y = 0,\n    z = 0,\n    roll = 0,\n    pitch = 0,\n    yaw = 0,\n    position = undefined,\n    orientation = undefined\n  } = {}) {\n    if (Array.isArray(position) && position.length === 3) {\n      this.position = new Vector3(position);\n    } else {\n      this.position = new Vector3(x, y, z);\n    }\n\n    if (Array.isArray(orientation) && orientation.length === 4) {\n      this.orientation = new Euler(orientation, orientation[3]);\n    } else {\n      this.orientation = new Euler(roll, pitch, yaw, Euler.RollPitchYaw);\n    }\n  }\n\n  get x() {\n    return this.position.x;\n  }\n\n  set x(value) {\n    this.position.x = value;\n  }\n\n  get y() {\n    return this.position.y;\n  }\n\n  set y(value) {\n    this.position.y = value;\n  }\n\n  get z() {\n    return this.position.z;\n  }\n\n  set z(value) {\n    this.position.z = value;\n  }\n\n  get roll() {\n    return this.orientation.roll;\n  }\n\n  set roll(value) {\n    this.orientation.roll = value;\n  }\n\n  get pitch() {\n    return this.orientation.pitch;\n  }\n\n  set pitch(value) {\n    this.orientation.pitch = value;\n  }\n\n  get yaw() {\n    return this.orientation.yaw;\n  }\n\n  set yaw(value) {\n    this.orientation.yaw = value;\n  }\n\n  getPosition() {\n    return this.position;\n  }\n\n  getOrientation() {\n    return this.orientation;\n  }\n\n  equals(pose) {\n    if (!pose) {\n      return false;\n    }\n\n    return this.position.equals(pose.position) && this.orientation.equals(pose.orientation);\n  }\n\n  exactEquals(pose) {\n    if (!pose) {\n      return false;\n    }\n\n    return this.position.exactEquals(pose.position) && this.orientation.exactEquals(pose.orientation);\n  }\n\n  getTransformationMatrix() {\n    const sr = Math.sin(this.roll);\n    const sp = Math.sin(this.pitch);\n    const sw = Math.sin(this.yaw);\n    const cr = Math.cos(this.roll);\n    const cp = Math.cos(this.pitch);\n    const cw = Math.cos(this.yaw);\n    const matrix = new Matrix4().setRowMajor(cw * cp, -sw * cr + cw * sp * sr, sw * sr + cw * sp * cr, this.x, sw * cp, cw * cr + sw * sp * sr, -cw * sr + sw * sp * cr, this.y, -sp, cp * sr, cp * cr, this.z, 0, 0, 0, 1);\n    return matrix;\n  }\n\n  getTransformationMatrixFromPose(pose) {\n    return new Matrix4().multiplyRight(this.getTransformationMatrix()).multiplyRight(pose.getTransformationMatrix().invert());\n  }\n\n  getTransformationMatrixToPose(pose) {\n    return new Matrix4().multiplyRight(pose.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert());\n  }\n\n}\n//# sourceMappingURL=pose.js.map","// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n\n// Change to `latest` on production branches\nconst DEFAULT_VERSION = 'beta';\ndeclare let __VERSION__;\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : DEFAULT_VERSION;\nif (typeof __VERSION__ === 'undefined') {\n  // eslint-disable-next-line\n  console.error(\n    'loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.'\n  );\n}\n","import type {LoaderContext, LoaderOptions, Loader} from '@loaders.gl/loader-utils';\nimport {compareArrayBuffers} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {getResourceUrlAndType} from '../utils/resource-utils';\nimport {getRegisteredLoaders} from './register-loaders';\nimport {isBlob} from '../../javascript-utils/is-type';\n\nconst EXT_PATTERN = /\\.([^.]+)$/;\n\n// TODO - Need a variant that peeks at streams for parseInBatches\n// TODO - Detect multiple matching loaders? Use heuristics to grade matches?\n// TODO - Allow apps to pass context to disambiguate between multiple matches (e.g. multiple .json formats)?\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport async function selectLoader(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<Loader | null> {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // First make a sync attempt, disabling exceptions\n  let loader = selectLoaderSync(data, loaders, {...options, nothrow: true}, context);\n  if (loader) {\n    return loader;\n  }\n\n  // For Blobs and Files, try to asynchronously read a small initial slice and test again with that\n  // to see if we can detect by initial content\n  if (isBlob(data)) {\n    data = await (data as Blob).slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport function selectLoaderSync(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Loader | null {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // eslint-disable-next-line complexity\n  // if only a single loader was provided (not as array), force its use\n  // TODO - Should this behavior be kept and documented?\n  if (loaders && !Array.isArray(loaders)) {\n    // TODO - remove support for legacy loaders\n    return normalizeLoader(loaders);\n  }\n\n  // Build list of candidate loaders that will be searched in order for a match\n  let candidateLoaders: Loader[] = [];\n  // First search supplied loaders\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n  // Then fall back to registered loaders\n  if (!options?.ignoreRegisteredLoaders) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n\n  // TODO - remove support for legacy loaders\n  normalizeLoaders(candidateLoaders);\n\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/** Implements loaders selection logic */\nfunction selectLoaderInternal(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[],\n  options?: LoaderOptions,\n  context?: LoaderContext\n) {\n  const {url, type} = getResourceUrlAndType(data);\n\n  const testUrl = url || context?.url;\n\n  let loader: Loader | null = null;\n\n  // if options.mimeType is supplied, it takes precedence\n  if (options?.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options?.mimeType);\n  }\n  // Look up loader by url\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  // Look up loader by mime type\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  // Look for loader via initial bytes (Note: not always accessible (e.g. Response, stream, async iterator)\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  // Look up loader by fallback mime type\n  loader = loader || findLoaderByMIMEType(loaders, options?.fallbackMimeType);\n\n  return loader;\n}\n\n/** Check HTTP Response */\nfunction validHTTPResponse(data: any): boolean {\n  // HANDLE HTTP status\n  if (data instanceof Response) {\n    // 204 - NO CONTENT. This handles cases where e.g. a tile server responds with 204 for a missing tile\n    if (data.status === 204) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getNoValidLoaderMessage(data): string {\n  const {url, type} = getResourceUrlAndType(data);\n\n  let message = 'No valid loader found';\n  if (data) {\n    message += ` data: \"${getFirstCharacters(data)}\", contentType: \"${type}\"`;\n  }\n  if (url) {\n    message += ` url: ${url}`;\n  }\n  return message;\n}\n\nfunction normalizeLoaders(loaders: Loader[]): void {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\n\n// TODO - Would be nice to support http://example.com/file.glb?parameter=1\n// E.g: x = new URL('http://example.com/file.glb?load=1'; x.pathname\nfunction findLoaderByUrl(loaders: Loader[], url?: string): Loader | null {\n  // Get extension\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\n\nfunction findLoaderByExtension(loaders: Loader[], extension: string): Loader | null {\n  extension = extension.toLowerCase();\n\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n\n    // Support referring to loaders using the \"unregistered tree\"\n    // https://en.wikipedia.org/wiki/Media_type#Unregistered_tree\n    if (mimeType === `application/x.${loader.id}`) {\n      return loader;\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      // Typed Arrays can have offsets into underlying buffer\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n    // TODO Handle streaming case (requires creating a new AsyncIterator)\n  }\n  return null;\n}\n\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => data.startsWith(test));\n}\n\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => testBinary(data, byteOffset, loader, test));\n}\n\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n\n    case 'string':\n      // Magic bytes check: If `test` is a string, check if binary data starts with that strings\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n\n    default:\n      return false;\n  }\n}\n\nfunction getFirstCharacters(data, length = 5) {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    // Typed Arrays can have offsets into underlying buffer\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\n\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n","export const WGS84_RADIUS_X = 6378137.0;\nexport const WGS84_RADIUS_Y = 6378137.0;\nexport const WGS84_RADIUS_Z = 6356752.3142451793;\nexport const WGS84_CONSTANTS = {\n  radii: [WGS84_RADIUS_X, WGS84_RADIUS_Y, WGS84_RADIUS_Z],\n  radiiSquared: [WGS84_RADIUS_X * WGS84_RADIUS_X, WGS84_RADIUS_Y * WGS84_RADIUS_Y, WGS84_RADIUS_Z * WGS84_RADIUS_Z],\n  oneOverRadii: [1.0 / WGS84_RADIUS_X, 1.0 / WGS84_RADIUS_Y, 1.0 / WGS84_RADIUS_Z],\n  oneOverRadiiSquared: [1.0 / (WGS84_RADIUS_X * WGS84_RADIUS_X), 1.0 / (WGS84_RADIUS_Y * WGS84_RADIUS_Y), 1.0 / (WGS84_RADIUS_Z * WGS84_RADIUS_Z)],\n  maximumRadius: Math.max(WGS84_RADIUS_X, WGS84_RADIUS_Y, WGS84_RADIUS_Z),\n  centerToleranceSquared: 1e-1\n};\n//# sourceMappingURL=constants.js.map","import { Vector3, isArray, toRadians, toDegrees, config } from '@math.gl/core';\nimport { WGS84_CONSTANTS } from './constants';\n\nconst noop = x => x;\n\nconst scratchVector = new Vector3();\nexport function fromCartographic(cartographic, result, map = noop) {\n  if (isArray(cartographic)) {\n    result[0] = map(cartographic[0]);\n    result[1] = map(cartographic[1]);\n    result[2] = cartographic[2];\n  } else if ('longitude' in cartographic) {\n    result[0] = map(cartographic.longitude);\n    result[1] = map(cartographic.latitude);\n    result[2] = cartographic.height;\n  } else {\n    result[0] = map(cartographic.x);\n    result[1] = map(cartographic.y);\n    result[2] = cartographic.z;\n  }\n\n  return result;\n}\nexport function fromCartographicToRadians(cartographic, vector = scratchVector) {\n  return fromCartographic(cartographic, vector, config._cartographicRadians ? noop : toRadians);\n}\nexport function fromCartographicToDegrees(cartographic, vector = scratchVector) {\n  return fromCartographic(cartographic, vector, config._cartographicRadians ? toDegrees : noop);\n}\nexport function toCartographic(vector, cartographic, map = noop) {\n  if (isArray(cartographic)) {\n    cartographic[0] = map(vector[0]);\n    cartographic[1] = map(vector[1]);\n    cartographic[2] = vector[2];\n  } else if ('longitude' in cartographic) {\n    cartographic.longitude = map(vector[0]);\n    cartographic.latitude = map(vector[1]);\n    cartographic.height = vector[2];\n  } else {\n    cartographic.x = map(vector[0]);\n    cartographic.y = map(vector[1]);\n    cartographic.z = vector[2];\n  }\n\n  return cartographic;\n}\nexport function toCartographicFromRadians(vector, cartographic) {\n  return toCartographic(vector, cartographic, config._cartographicRadians ? noop : toDegrees);\n}\nexport function toCartographicFromDegrees(vector, cartographic) {\n  return toCartographic(vector, cartographic, config._cartographicRadians ? toRadians : noop);\n}\nexport function isWGS84(vector) {\n  if (!vector) {\n    return false;\n  }\n\n  scratchVector.from(vector);\n  const {\n    oneOverRadiiSquared,\n    centerToleranceSquared\n  } = WGS84_CONSTANTS;\n  const x2 = vector[0] * vector[0] * oneOverRadiiSquared[0];\n  const y2 = vector[1] * vector[1] * oneOverRadiiSquared[1];\n  const z2 = vector[2] * vector[2] * oneOverRadiiSquared[2];\n  return Math.abs(x2 + y2 + z2 - 1) < centerToleranceSquared;\n}\n//# sourceMappingURL=type-utils.js.map","import { Vector3, assert, _MathUtils } from '@math.gl/core';\nimport * as vec3 from 'gl-matrix/vec3';\nconst scratchVector = new Vector3();\nconst scaleToGeodeticSurfaceIntersection = new Vector3();\nconst scaleToGeodeticSurfaceGradient = new Vector3();\nexport default function scaleToGeodeticSurface(cartesian, ellipsoid, result = new Vector3()) {\n  const {\n    oneOverRadii,\n    oneOverRadiiSquared,\n    centerToleranceSquared\n  } = ellipsoid;\n  scratchVector.from(cartesian);\n  const positionX = cartesian.x;\n  const positionY = cartesian.y;\n  const positionZ = cartesian.z;\n  const oneOverRadiiX = oneOverRadii.x;\n  const oneOverRadiiY = oneOverRadii.y;\n  const oneOverRadiiZ = oneOverRadii.z;\n  const x2 = positionX * positionX * oneOverRadiiX * oneOverRadiiX;\n  const y2 = positionY * positionY * oneOverRadiiY * oneOverRadiiY;\n  const z2 = positionZ * positionZ * oneOverRadiiZ * oneOverRadiiZ;\n  const squaredNorm = x2 + y2 + z2;\n  const ratio = Math.sqrt(1.0 / squaredNorm);\n\n  if (!Number.isFinite(ratio)) {\n    return undefined;\n  }\n\n  const intersection = scaleToGeodeticSurfaceIntersection;\n  intersection.copy(cartesian).scale(ratio);\n\n  if (squaredNorm < centerToleranceSquared) {\n    return intersection.to(result);\n  }\n\n  const oneOverRadiiSquaredX = oneOverRadiiSquared.x;\n  const oneOverRadiiSquaredY = oneOverRadiiSquared.y;\n  const oneOverRadiiSquaredZ = oneOverRadiiSquared.z;\n  const gradient = scaleToGeodeticSurfaceGradient;\n  gradient.set(intersection.x * oneOverRadiiSquaredX * 2.0, intersection.y * oneOverRadiiSquaredY * 2.0, intersection.z * oneOverRadiiSquaredZ * 2.0);\n  let lambda = (1.0 - ratio) * cartesian.len() / (0.5 * gradient.len());\n  let correction = 0.0;\n  let xMultiplier;\n  let yMultiplier;\n  let zMultiplier;\n  let func;\n\n  do {\n    lambda -= correction;\n    xMultiplier = 1.0 / (1.0 + lambda * oneOverRadiiSquaredX);\n    yMultiplier = 1.0 / (1.0 + lambda * oneOverRadiiSquaredY);\n    zMultiplier = 1.0 / (1.0 + lambda * oneOverRadiiSquaredZ);\n    const xMultiplier2 = xMultiplier * xMultiplier;\n    const yMultiplier2 = yMultiplier * yMultiplier;\n    const zMultiplier2 = zMultiplier * zMultiplier;\n    const xMultiplier3 = xMultiplier2 * xMultiplier;\n    const yMultiplier3 = yMultiplier2 * yMultiplier;\n    const zMultiplier3 = zMultiplier2 * zMultiplier;\n    func = x2 * xMultiplier2 + y2 * yMultiplier2 + z2 * zMultiplier2 - 1.0;\n    const denominator = x2 * xMultiplier3 * oneOverRadiiSquaredX + y2 * yMultiplier3 * oneOverRadiiSquaredY + z2 * zMultiplier3 * oneOverRadiiSquaredZ;\n    const derivative = -2.0 * denominator;\n    correction = func / derivative;\n  } while (Math.abs(func) > _MathUtils.EPSILON12);\n\n  return scratchVector.scale([xMultiplier, yMultiplier, zMultiplier]).to(result);\n}\n//# sourceMappingURL=scale-to-geodetic-surface.js.map","import { Vector3, assert, equals as equalsEpsilon } from '@math.gl/core';\nconst EPSILON14 = 1e-14;\nconst scratchOrigin = new Vector3();\nconst VECTOR_PRODUCT_LOCAL_FRAME = {\n  up: {\n    south: 'east',\n    north: 'west',\n    west: 'south',\n    east: 'north'\n  },\n  down: {\n    south: 'west',\n    north: 'east',\n    west: 'north',\n    east: 'south'\n  },\n  south: {\n    up: 'west',\n    down: 'east',\n    west: 'down',\n    east: 'up'\n  },\n  north: {\n    up: 'east',\n    down: 'west',\n    west: 'up',\n    east: 'down'\n  },\n  west: {\n    up: 'north',\n    down: 'south',\n    north: 'down',\n    south: 'up'\n  },\n  east: {\n    up: 'south',\n    down: 'north',\n    north: 'up',\n    south: 'down'\n  }\n};\nconst degeneratePositionLocalFrame = {\n  north: [-1, 0, 0],\n  east: [0, 1, 0],\n  up: [0, 0, 1],\n  south: [1, 0, 0],\n  west: [0, -1, 0],\n  down: [0, 0, -1]\n};\nconst scratchAxisVectors = {\n  east: new Vector3(),\n  north: new Vector3(),\n  up: new Vector3(),\n  west: new Vector3(),\n  south: new Vector3(),\n  down: new Vector3()\n};\nconst scratchVector1 = new Vector3();\nconst scratchVector2 = new Vector3();\nconst scratchVector3 = new Vector3();\nexport default function localFrameToFixedFrame(ellipsoid, firstAxis, secondAxis, thirdAxis, cartesianOrigin, result) {\n  const thirdAxisInferred = VECTOR_PRODUCT_LOCAL_FRAME[firstAxis] && VECTOR_PRODUCT_LOCAL_FRAME[firstAxis][secondAxis];\n  assert(thirdAxisInferred && (!thirdAxis || thirdAxis === thirdAxisInferred));\n  let firstAxisVector;\n  let secondAxisVector;\n  let thirdAxisVector;\n  const origin = scratchOrigin.copy(cartesianOrigin);\n  const atPole = equalsEpsilon(origin.x, 0.0, EPSILON14) && equalsEpsilon(origin.y, 0.0, EPSILON14);\n\n  if (atPole) {\n    const sign = Math.sign(origin.z);\n    firstAxisVector = scratchVector1.fromArray(degeneratePositionLocalFrame[firstAxis]);\n\n    if (firstAxis !== 'east' && firstAxis !== 'west') {\n      firstAxisVector.scale(sign);\n    }\n\n    secondAxisVector = scratchVector2.fromArray(degeneratePositionLocalFrame[secondAxis]);\n\n    if (secondAxis !== 'east' && secondAxis !== 'west') {\n      secondAxisVector.scale(sign);\n    }\n\n    thirdAxisVector = scratchVector3.fromArray(degeneratePositionLocalFrame[thirdAxis]);\n\n    if (thirdAxis !== 'east' && thirdAxis !== 'west') {\n      thirdAxisVector.scale(sign);\n    }\n  } else {\n    const {\n      up,\n      east,\n      north\n    } = scratchAxisVectors;\n    east.set(-origin.y, origin.x, 0.0).normalize();\n    ellipsoid.geodeticSurfaceNormal(origin, up);\n    north.copy(up).cross(east);\n    const {\n      down,\n      west,\n      south\n    } = scratchAxisVectors;\n    down.copy(up).scale(-1);\n    west.copy(east).scale(-1);\n    south.copy(north).scale(-1);\n    firstAxisVector = scratchAxisVectors[firstAxis];\n    secondAxisVector = scratchAxisVectors[secondAxis];\n    thirdAxisVector = scratchAxisVectors[thirdAxis];\n  }\n\n  result[0] = firstAxisVector.x;\n  result[1] = firstAxisVector.y;\n  result[2] = firstAxisVector.z;\n  result[3] = 0.0;\n  result[4] = secondAxisVector.x;\n  result[5] = secondAxisVector.y;\n  result[6] = secondAxisVector.z;\n  result[7] = 0.0;\n  result[8] = thirdAxisVector.x;\n  result[9] = thirdAxisVector.y;\n  result[10] = thirdAxisVector.z;\n  result[11] = 0.0;\n  result[12] = origin.x;\n  result[13] = origin.y;\n  result[14] = origin.z;\n  result[15] = 1.0;\n  return result;\n}\n//# sourceMappingURL=ellipsoid-transform.js.map","import { Vector3, Matrix4, toRadians, toDegrees, assert, equals, _MathUtils } from '@math.gl/core';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { WGS84_RADIUS_X, WGS84_RADIUS_Y, WGS84_RADIUS_Z } from '../constants';\nimport { fromCartographicToRadians, toCartographicFromRadians } from '../type-utils';\nimport scaleToGeodeticSurface from './helpers/scale-to-geodetic-surface';\nimport localFrameToFixedFrame from './helpers/ellipsoid-transform';\nconst scratchVector = new Vector3();\nconst scratchNormal = new Vector3();\nconst scratchK = new Vector3();\nconst scratchPosition = new Vector3();\nconst scratchHeight = new Vector3();\nconst scratchCartesian = new Vector3();\nlet wgs84;\nexport default class Ellipsoid {\n  static get WGS84() {\n    wgs84 = wgs84 || new Ellipsoid(WGS84_RADIUS_X, WGS84_RADIUS_Y, WGS84_RADIUS_Z);\n    return wgs84;\n  }\n\n  constructor(x = 0.0, y = 0.0, z = 0.0) {\n    assert(x >= 0.0);\n    assert(y >= 0.0);\n    assert(z >= 0.0);\n    this.radii = new Vector3(x, y, z);\n    this.radiiSquared = new Vector3(x * x, y * y, z * z);\n    this.radiiToTheFourth = new Vector3(x * x * x * x, y * y * y * y, z * z * z * z);\n    this.oneOverRadii = new Vector3(x === 0.0 ? 0.0 : 1.0 / x, y === 0.0 ? 0.0 : 1.0 / y, z === 0.0 ? 0.0 : 1.0 / z);\n    this.oneOverRadiiSquared = new Vector3(x === 0.0 ? 0.0 : 1.0 / (x * x), y === 0.0 ? 0.0 : 1.0 / (y * y), z === 0.0 ? 0.0 : 1.0 / (z * z));\n    this.minimumRadius = Math.min(x, y, z);\n    this.maximumRadius = Math.max(x, y, z);\n    this.centerToleranceSquared = _MathUtils.EPSILON1;\n\n    if (this.radiiSquared.z !== 0) {\n      this.squaredXOverSquaredZ = this.radiiSquared.x / this.radiiSquared.z;\n    }\n\n    Object.freeze(this);\n  }\n\n  equals(right) {\n    return this === right || Boolean(right && this.radii.equals(right.radii));\n  }\n\n  toString() {\n    return this.radii.toString();\n  }\n\n  cartographicToCartesian(cartographic, result = [0, 0, 0]) {\n    const normal = scratchNormal;\n    const k = scratchK;\n    const [,, height] = cartographic;\n    this.geodeticSurfaceNormalCartographic(cartographic, normal);\n    k.copy(this.radiiSquared).scale(normal);\n    const gamma = Math.sqrt(normal.dot(k));\n    k.scale(1 / gamma);\n    normal.scale(height);\n    k.add(normal);\n    return k.to(result);\n  }\n\n  cartesianToCartographic(cartesian, result = [0, 0, 0]) {\n    scratchCartesian.from(cartesian);\n    const point = this.scaleToGeodeticSurface(scratchCartesian, scratchPosition);\n\n    if (!point) {\n      return undefined;\n    }\n\n    const normal = this.geodeticSurfaceNormal(point, scratchNormal);\n    const h = scratchHeight;\n    h.copy(scratchCartesian).subtract(point);\n    const longitude = Math.atan2(normal.y, normal.x);\n    const latitude = Math.asin(normal.z);\n    const height = Math.sign(vec3.dot(h, scratchCartesian)) * vec3.length(h);\n    return toCartographicFromRadians([longitude, latitude, height], result);\n  }\n\n  eastNorthUpToFixedFrame(origin, result = new Matrix4()) {\n    return localFrameToFixedFrame(this, 'east', 'north', 'up', origin, result);\n  }\n\n  localFrameToFixedFrame(firstAxis, secondAxis, thirdAxis, origin, result = new Matrix4()) {\n    return localFrameToFixedFrame(this, firstAxis, secondAxis, thirdAxis, origin, result);\n  }\n\n  geocentricSurfaceNormal(cartesian, result = [0, 0, 0]) {\n    return scratchVector.from(cartesian).normalize().to(result);\n  }\n\n  geodeticSurfaceNormalCartographic(cartographic, result = [0, 0, 0]) {\n    const cartographicVectorRadians = fromCartographicToRadians(cartographic);\n    const longitude = cartographicVectorRadians[0];\n    const latitude = cartographicVectorRadians[1];\n    const cosLatitude = Math.cos(latitude);\n    scratchVector.set(cosLatitude * Math.cos(longitude), cosLatitude * Math.sin(longitude), Math.sin(latitude)).normalize();\n    return scratchVector.to(result);\n  }\n\n  geodeticSurfaceNormal(cartesian, result = [0, 0, 0]) {\n    return scratchVector.from(cartesian).scale(this.oneOverRadiiSquared).normalize().to(result);\n  }\n\n  scaleToGeodeticSurface(cartesian, result) {\n    return scaleToGeodeticSurface(cartesian, this, result);\n  }\n\n  scaleToGeocentricSurface(cartesian, result = [0, 0, 0]) {\n    scratchPosition.from(cartesian);\n    const positionX = scratchPosition.x;\n    const positionY = scratchPosition.y;\n    const positionZ = scratchPosition.z;\n    const oneOverRadiiSquared = this.oneOverRadiiSquared;\n    const beta = 1.0 / Math.sqrt(positionX * positionX * oneOverRadiiSquared.x + positionY * positionY * oneOverRadiiSquared.y + positionZ * positionZ * oneOverRadiiSquared.z);\n    return scratchPosition.multiplyScalar(beta).to(result);\n  }\n\n  transformPositionToScaledSpace(position, result = [0, 0, 0]) {\n    return scratchPosition.from(position).scale(this.oneOverRadii).to(result);\n  }\n\n  transformPositionFromScaledSpace(position, result = [0, 0, 0]) {\n    return scratchPosition.from(position).scale(this.radii).to(result);\n  }\n\n  getSurfaceNormalIntersectionWithZAxis(position, buffer = 0.0, result = [0, 0, 0]) {\n    assert(equals(this.radii.x, this.radii.y, _MathUtils.EPSILON15));\n    assert(this.radii.z > 0);\n    scratchPosition.from(position);\n    const z = scratchPosition.z * (1 - this.squaredXOverSquaredZ);\n\n    if (Math.abs(z) >= this.radii.z - buffer) {\n      return undefined;\n    }\n\n    return scratchPosition.set(0.0, 0.0, z).to(result);\n  }\n\n}\n//# sourceMappingURL=ellipsoid.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport { config } from '../../lib/common';\nimport assert from '../../lib/assert';\nexport default class Matrix extends MathArray {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  get RANK() {\n    assert(false);\n    return 0;\n  }\n\n  toString() {\n    let string = '[';\n\n    if (config.printRowMajor) {\n      string += 'row-major:';\n\n      for (let row = 0; row < this.RANK; ++row) {\n        for (let col = 0; col < this.RANK; ++col) {\n          string += \" \".concat(this[col * this.RANK + row]);\n        }\n      }\n    } else {\n      string += 'column-major:';\n\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        string += \" \".concat(this[i]);\n      }\n    }\n\n    string += ']';\n    return string;\n  }\n\n  getElementIndex(row, col) {\n    return col * this.RANK + row;\n  }\n\n  getElement(row, col) {\n    return this[col * this.RANK + row];\n  }\n\n  setElement(row, col, value) {\n    this[col * this.RANK + row] = checkNumber(value);\n    return this;\n  }\n\n  getColumn(columnIndex, result = new Array(this.RANK).fill(-0)) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      result[i] = this[firstIndex + i];\n    }\n\n    return result;\n  }\n\n  setColumn(columnIndex, columnVector) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      this[firstIndex + i] = columnVector[i];\n    }\n\n    return this;\n  }\n\n}\n//# sourceMappingURL=matrix.js.map","import type {WorkerObject} from './types';\nimport {VERSION} from './lib/env-utils/version';\n\n// TYPES\nexport type {\n  WorkerObject,\n  WorkerOptions,\n  // Protocol\n  WorkerMessage,\n  WorkerMessageType,\n  WorkerMessageData,\n  WorkerMessagePayload\n} from './types';\n\n// GENERAL UTILS\nexport {assert} from './lib/env-utils/assert';\nexport {isBrowser, isWorker} from './lib/env-utils/globals';\n\n// WORKER UTILS - TYPES\nexport {default as WorkerJob} from './lib/worker-farm/worker-job';\nexport {default as WorkerThread} from './lib/worker-farm/worker-thread';\n\n// WORKER FARMS\nexport {default as WorkerFarm} from './lib/worker-farm/worker-farm';\nexport {default as WorkerPool} from './lib/worker-farm/worker-pool';\nexport {default as WorkerBody} from './lib/worker-farm/worker-body';\n\nexport {processOnWorker, canProcessOnWorker} from './lib/worker-api/process-on-worker';\nexport {createWorker} from './lib/worker-api/create-worker';\n\n// WORKER UTILS - EXPORTS\nexport {getWorkerURL} from './lib/worker-api/get-worker-url';\nexport {validateWorkerVersion} from './lib/worker-api/validate-worker-version';\nexport {getTransferList} from './lib/worker-utils/get-transfer-list';\n\n// LIBRARY UTILS\nexport {getLibraryUrl, loadLibrary} from './lib/library-utils/library-utils';\n\n// PARSER UTILS\nexport {default as AsyncQueue} from './lib/async-queue/async-queue';\n\n// PROCESS UTILS\nexport {default as ChildProcessProxy} from './lib/process-utils/child-process-proxy';\n\n// WORKER OBJECTS\n\n/** A null worker to test that worker processing is functional */\nexport const NullWorker: WorkerObject = {\n  id: 'null',\n  name: 'null',\n  module: 'worker-utils',\n  version: VERSION,\n  options: {\n    null: {}\n  }\n};\n","// Purpose: include this in your module to avoids adding dependencies on\n// micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\nconst self_: {[key: string]: any} = globals.self || globals.window || globals.global || {};\nconst window_: {[key: string]: any} = globals.window || globals.self || globals.global || {};\nconst global_: {[key: string]: any} = globals.global || globals.self || globals.window || {};\nconst document_: {[key: string]: any} = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in the browser, false if running in Node.js */\nexport const isBrowser: boolean =\n  // @ts-ignore process.browser\n  typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n\n/** true if running on a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n/** true if running on a mobile device */\nexport const isMobile: boolean =\n  typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n\n/** Version of Node.js if running under Node, otherwise 0 */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n","import {assert} from '../env-utils/assert';\nimport {getLoadableWorkerURL} from '../worker-utils/get-loadable-worker-url';\nimport {getTransferList} from '../worker-utils/get-transfer-list';\n\nconst NOOP = () => {};\n\nexport type WorkerThreadProps = {\n  name: string;\n  source?: string;\n  url?: string;\n};\n\n/**\n * Represents one worker thread\n */\nexport default class WorkerThread {\n  readonly name: string;\n  readonly source: string | undefined;\n  readonly url: string | undefined;\n  terminated: boolean = false;\n  worker: Worker;\n  onMessage: (message: any) => void;\n  onError: (error: Error) => void;\n\n  private _loadableURL: string = '';\n\n  static isSupported(): boolean {\n    return typeof Worker !== 'undefined';\n  }\n\n  constructor(props: WorkerThreadProps) {\n    const {name, source, url} = props;\n    assert(source || url); // Either source or url must be defined\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n    this.onError = (error) => console.log(error); // eslint-disable-line\n\n    this.worker = this._createBrowserWorker();\n  }\n\n  /**\n   * Terminate this worker thread\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    // @ts-ignore\n    this.worker.terminate();\n    this.terminated = true;\n  }\n\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n\n  /**\n   * Send a message to this worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   * @param transferList If not supplied, calculated automatically by traversing data\n   */\n  postMessage(data: any, transferList?: any[]): void {\n    transferList = transferList || getTransferList(data);\n    // @ts-ignore\n    this.worker.postMessage(data, transferList);\n  }\n\n  // PRIVATE\n\n  /**\n   * Generate a standard Error from an ErrorEvent\n   * @param {ErrorEvent} event\n   */\n  _getErrorFromErrorEvent(event) {\n    // Note Error object does not have the expected fields if loading failed completely\n    // https://developer.mozilla.org/en-US/docs/Web/API/Worker#Event_handlers\n    // https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    let message = 'Failed to load ';\n    message += `worker ${this.name}. `;\n    if (event.message) {\n      message += `${event.message} in `;\n    }\n    // const hasFilename = event.filename && !event.filename.startsWith('blob:');\n    // message += hasFilename ? event.filename : this.source.slice(0, 100);\n    if (event.lineno) {\n      message += `:${event.lineno}:${event.colno}`;\n    }\n    return new Error(message);\n  }\n\n  /**\n   * Creates a worker thread on the browser\n   */\n  _createBrowserWorker() {\n    this._loadableURL = getLoadableWorkerURL({source: this.source, url: this.url});\n    const worker = new Worker(this._loadableURL, {name: this.name});\n\n    worker.onmessage = (event) => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n    // This callback represents an uncaught exception in the worker thread\n    worker.onerror = (error) => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n    // TODO - not clear when this would be called, for now just log in case it happens\n    worker.onmessageerror = (event) => console.error(event); // eslint-disable-line\n\n    return worker;\n  }\n}\n","// NOTE - there is a copy of this function is both in core and loader-utils\n// core does not need all the utils in loader-utils, just this one.\n\n/**\n * Returns an array of Transferrable objects that can be used with postMessage\n * https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\n * @param object data to be sent via postMessage\n * @param recursive - not for application use\n * @param transfers - not for application use\n * @returns a transfer list that can be passed to postMessage\n */\nexport function getTransferList(\n  object: any,\n  recursive: boolean = true,\n  transfers?: Set<any>\n): Transferable[] {\n  // Make sure that items in the transfer list is unique\n  const transfersSet = transfers || new Set();\n\n  if (!object) {\n    // ignore\n  } else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    // Typed array\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {\n    // object is a TypeArray viewing into a SharedArrayBuffer (not transferable)\n    // Do not iterate through the content in this case\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      // Avoid perf hit - only go one level deep\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  // If transfers is defined, is internal recursive call\n  // Otherwise it's called by the user\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Transferable\nfunction isTransferable(object) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\nimport {Vector3, Matrix4} from '@math.gl/core';\nimport {CullingVolume} from '@math.gl/culling';\n\nimport {load} from '@loaders.gl/core';\nimport {TILE_REFINEMENT, TILE_CONTENT_STATE, TILESET_TYPE} from '../constants';\n\nimport {FrameState} from './helpers/frame-state';\nimport {createBoundingVolume} from './helpers/bounding-volume';\nimport {getTiles3DScreenSpaceError} from './helpers/tiles-3d-lod';\nimport {getI3ScreenSize} from './helpers/i3s-lod';\nimport {get3dTilesOptions} from './helpers/3d-tiles-options';\nimport TilesetTraverser from './traversers/tileset-traverser';\n\n// Note: circular dependency\nimport type Tileset3D from './tileset-3d';\n\nconst scratchVector = new Vector3();\n\nfunction defined(x) {\n  return x !== undefined && x !== null;\n}\n\n/**\n * @param tileset - Tileset3D instance\n * @param header - tile header - JSON loaded from a dataset\n * @param parentHeader - parent TileHeader instance\n * @param extendedId - optional ID to separate copies of a tile for different viewports.\n *                              const extendedId = `${tile.id}-${frameState.viewport.id}`;\n */\nexport type TileHeaderProps = {\n  tileset: Tileset3D;\n  header: Object;\n  parentHeader: TileHeader;\n  extendedId: string;\n};\n\n/**\n * A Tile3DHeader represents a tile as Tileset3D. When a tile is first created, its content is not loaded;\n * the content is loaded on-demand when needed based on the view.\n * Do not construct this directly, instead access tiles through {@link Tileset3D#tileVisible}.\n */\nexport default class TileHeader {\n  tileset: Tileset3D;\n  header: any;\n  id: string;\n  url: string;\n  parent: TileHeader;\n  refine: number;\n  type: string;\n  contentUrl: string;\n  lodMetricType: string;\n  lodMetricValue: number;\n  boundingVolume: any;\n  content: any;\n  contentState: any;\n  gpuMemoryUsageInBytes: number;\n  children: TileHeader[];\n  depth: number;\n  viewportIds: any[];\n  transform: Matrix4;\n\n  // Container to store application specific data\n  userData: {[key: string]: any};\n  computedTransform: any;\n  hasEmptyContent: boolean;\n  hasTilesetContent: boolean;\n\n  traverser: object;\n\n  // @ts-ignore\n  private _cacheNode: any;\n  private _frameNumber: any;\n  // TODO i3s specific, needs to remove\n  // @ts-ignore\n  private _lodJudge: any;\n  // TODO Cesium 3d tiles specific\n  private _expireDate: any;\n  private _expiredContent: any;\n  // @ts-ignore\n  private _shouldRefine: boolean;\n\n  // Members this are updated every frame for tree traversal and rendering optimizations:\n  // @ts-ignore\n  private _distanceToCamera: number;\n  // @ts-ignore\n  private _centerZDepth: number;\n  private _screenSpaceError: number;\n  private _visibilityPlaneMask: any;\n  private _visible?: boolean;\n  private _inRequestVolume: boolean;\n\n  // @ts-ignore\n  private _stackLength: number;\n  // @ts-ignore\n  private _selectionDepth: number;\n\n  // @ts-ignore\n  private _touchedFrame: number;\n  // @ts-ignore\n  private _visitedFrame: number;\n  private _selectedFrame: number;\n  // @ts-ignore\n  private _requestedFrame: number;\n\n  // @ts-ignore\n  private _priority: number;\n\n  private _contentBoundingVolume: any;\n  private _viewerRequestVolume: any;\n\n  _initialTransform: Matrix4;\n\n  /**\n   * @constructs\n   * Create a TileHeader instance\n   * @param tileset - Tileset3D instance\n   * @param header - tile header - JSON loaded from a dataset\n   * @param parentHeader - parent TileHeader instance\n   * @param extendedId - optional ID to separate copies of a tile for different viewports.\n   *    const extendedId = `${tile.id}-${frameState.viewport.id}`;\n   */\n  // eslint-disable-next-line max-statements\n  constructor(\n    tileset: Tileset3D,\n    header: {[key: string]: any},\n    parentHeader?: TileHeader,\n    extendedId = ''\n  ) {\n    // PUBLIC MEMBERS\n    // original tile data\n    this.header = header;\n\n    // The tileset containing this tile.\n    this.tileset = tileset;\n    this.id = extendedId || header.id;\n    this.url = header.url;\n\n    // This tile's parent or `undefined` if this tile is the root.\n    // @ts-ignore\n    this.parent = parentHeader;\n    this.refine = this._getRefine(header.refine);\n    this.type = header.type;\n    this.contentUrl = header.contentUrl;\n\n    // The error, in meters, introduced if this tile is rendered and its children are not.\n    this.lodMetricType = 'geometricError';\n    this.lodMetricValue = 0;\n\n    // Specifies the type of refine that is used when traversing this tile for rendering.\n    this.boundingVolume = null;\n\n    // The tile's content.  This represents the actual tile's payload,\n    // not the content's metadata in the tileset JSON file.\n    this.content = null;\n    this.contentState = TILE_CONTENT_STATE.UNLOADED;\n    this.gpuMemoryUsageInBytes = 0;\n\n    // The tile's children - an array of Tile3D objects.\n    this.children = [];\n\n    this.hasEmptyContent = false;\n    this.hasTilesetContent = false;\n\n    this.depth = 0;\n    this.viewportIds = [];\n\n    // Container to store application specific data\n    this.userData = {};\n\n    // PRIVATE MEMBERS\n    this._priority = 0;\n    this._touchedFrame = 0;\n    this._visitedFrame = 0;\n    this._selectedFrame = 0;\n    this._requestedFrame = 0;\n    this._screenSpaceError = 0;\n\n    this._cacheNode = null;\n    this._frameNumber = null;\n    this._cacheNode = null;\n\n    this.traverser = new TilesetTraverser({});\n    this._shouldRefine = false;\n    this._distanceToCamera = 0;\n    this._centerZDepth = 0;\n    this._visible = undefined;\n    this._inRequestVolume = false;\n    this._stackLength = 0;\n    this._selectionDepth = 0;\n    this._initialTransform = new Matrix4();\n    this.transform = new Matrix4();\n\n    this._initializeLodMetric(header);\n    this._initializeTransforms(header);\n    this._initializeBoundingVolumes(header);\n    this._initializeContent(header);\n    this._initializeRenderingState(header);\n\n    // TODO i3s specific, needs to remove\n    this._lodJudge = null;\n\n    // TODO Cesium 3d tiles specific\n    this._expireDate = null;\n    this._expiredContent = null;\n\n    Object.seal(this);\n  }\n\n  destroy() {\n    this.header = null;\n  }\n\n  isDestroyed() {\n    return this.header === null;\n  }\n\n  get selected() {\n    return this._selectedFrame === this.tileset._frameNumber;\n  }\n\n  get isVisible() {\n    return this._visible;\n  }\n\n  get isVisibleAndInRequestVolume() {\n    return this._visible && this._inRequestVolume;\n  }\n\n  /** Returns true if tile is not an empty tile and not an external tileset */\n  get hasRenderContent() {\n    return !this.hasEmptyContent && !this.hasTilesetContent;\n  }\n\n  /** Returns true if tile has children */\n  get hasChildren() {\n    return this.children.length > 0 || (this.header.children && this.header.children.length > 0);\n  }\n\n  /**\n   * Determines if the tile's content is ready. This is automatically `true` for\n   * tiles with empty content.\n   */\n  get contentReady() {\n    return this.contentState === TILE_CONTENT_STATE.READY || this.hasEmptyContent;\n  }\n\n  /**\n   * Determines if the tile has available content to render.  `true` if the tile's\n   * content is ready or if it has expired content this renders while new content loads; otherwise,\n   */\n  get contentAvailable() {\n    return Boolean(\n      (this.contentReady && this.hasRenderContent) || (this._expiredContent && !this.contentFailed)\n    );\n  }\n\n  /** Returns true if tile has renderable content but it's unloaded */\n  get hasUnloadedContent() {\n    return this.hasRenderContent && this.contentUnloaded;\n  }\n\n  /**\n   * Determines if the tile's content has not be requested. `true` if tile's\n   * content has not be requested; otherwise, `false`.\n   */\n  get contentUnloaded() {\n    return this.contentState === TILE_CONTENT_STATE.UNLOADED;\n  }\n\n  /**\n   * Determines if the tile's content is expired. `true` if tile's\n   * content is expired; otherwise, `false`.\n   */\n  get contentExpired() {\n    return this.contentState === TILE_CONTENT_STATE.EXPIRED;\n  }\n\n  // Determines if the tile's content failed to load.  `true` if the tile's\n  // content failed to load; otherwise, `false`.\n  get contentFailed() {\n    return this.contentState === TILE_CONTENT_STATE.FAILED;\n  }\n\n  /** Get the tile's screen space error. */\n  getScreenSpaceError(frameState, useParentLodMetric) {\n    switch (this.tileset.type) {\n      case TILESET_TYPE.I3S:\n        return getI3ScreenSize(this, frameState);\n      case TILESET_TYPE.TILES3D:\n        return getTiles3DScreenSpaceError(this, frameState, useParentLodMetric);\n      default:\n        // eslint-disable-next-line\n        throw new Error('Unsupported tileset type');\n    }\n  }\n\n  /*\n   * If skipLevelOfDetail is off try to load child tiles as soon as possible so that their parent can refine sooner.\n   * Tiles are prioritized by screen space error.\n   */\n  _getPriority() {\n    const traverser = this.tileset._traverser;\n    const {skipLevelOfDetail} = traverser.options;\n\n    /*\n     * Tiles that are outside of the camera's frustum could be skipped if we are in 'ADD' mode\n     * or if we are using 'Skip Traversal' in 'REPLACE' mode.\n     * Otherewise, all 'touched' child tiles have to be loaded and displayed,\n     * this may include tiles that are outide of the camera frustum (so that we can hide the parent tile).\n     */\n    const maySkipTile = this.refine === TILE_REFINEMENT.ADD || skipLevelOfDetail;\n\n    // Check if any reason to abort\n    if (maySkipTile && !this.isVisible && this._visible !== undefined) {\n      return -1;\n    }\n    // Condition used in `cancelOutOfViewRequests` function in CesiumJS/Cesium3DTileset.js\n    if (this.tileset._frameNumber - this._touchedFrame >= 1) {\n      return -1;\n    }\n    if (this.contentState === TILE_CONTENT_STATE.UNLOADED) {\n      return -1;\n    }\n\n    // Based on the priority function `getPriorityReverseScreenSpaceError` in CesiumJS. Scheduling priority is based on the parent's screen space error when possible.\n    const parent = this.parent;\n    const useParentScreenSpaceError =\n      parent && (!maySkipTile || this._screenSpaceError === 0.0 || parent.hasTilesetContent);\n    const screenSpaceError = useParentScreenSpaceError\n      ? parent._screenSpaceError\n      : this._screenSpaceError;\n\n    const rootScreenSpaceError = traverser.root ? traverser.root._screenSpaceError : 0.0;\n\n    // Map higher SSE to lower values (e.g. root tile is highest priority)\n    return Math.max(rootScreenSpaceError - screenSpaceError, 0);\n  }\n\n  /**\n   *  Requests the tile's content.\n   * The request may not be made if the Request Scheduler can't prioritize it.\n   */\n  // eslint-disable-next-line max-statements, complexity\n  async loadContent(): Promise<boolean> {\n    if (this.hasEmptyContent) {\n      return false;\n    }\n\n    if (this.content) {\n      return true;\n    }\n\n    const expired = this.contentExpired;\n\n    if (expired) {\n      this._expireDate = null;\n    }\n\n    this.contentState = TILE_CONTENT_STATE.LOADING;\n\n    const requestToken = await this.tileset._requestScheduler.scheduleRequest(\n      this.id,\n      this._getPriority.bind(this)\n    );\n\n    if (!requestToken) {\n      // cancelled\n      this.contentState = TILE_CONTENT_STATE.UNLOADED;\n      return false;\n    }\n\n    try {\n      const contentUrl = this.tileset.getTileUrl(this.contentUrl);\n      // The content can be a binary tile ot a JSON tileset\n      const loader = this.tileset.loader;\n      const options = {\n        ...this.tileset.loadOptions,\n        [loader.id]: {\n          ...this.tileset.loadOptions[loader.id],\n          isTileset: this.type === 'json',\n          ...this._getLoaderSpecificOptions(loader.id)\n        }\n      };\n\n      this.content = await load(contentUrl, loader, options);\n\n      if (this.tileset.options.contentLoader) {\n        await this.tileset.options.contentLoader(this);\n      }\n\n      if (this._isTileset()) {\n        // Add tile headers for the nested tilset's subtree\n        // Async update of the tree should be fine since there would never be edits to the same node\n        // TODO - we need to capture the child tileset's URL\n        this.tileset._initializeTileHeaders(this.content, this);\n      }\n\n      this.contentState = TILE_CONTENT_STATE.READY;\n      this._onContentLoaded();\n      return true;\n    } catch (error) {\n      // Tile is unloaded before the content finishes loading\n      this.contentState = TILE_CONTENT_STATE.FAILED;\n      throw error;\n    } finally {\n      requestToken.done();\n    }\n  }\n\n  // Unloads the tile's content.\n  unloadContent() {\n    if (this.content && this.content.destroy) {\n      this.content.destroy();\n    }\n    this.content = null;\n    if (this.header.content && this.header.content.destroy) {\n      this.header.content.destroy();\n    }\n    this.header.content = null;\n    this.contentState = TILE_CONTENT_STATE.UNLOADED;\n    return true;\n  }\n\n  /**\n   * Update the tile's visibility\n   * @param {Object} frameState - frame state for tile culling\n   * @param {string[]} viewportIds - a list of viewport ids that show this tile\n   * @return {void}\n   */\n  updateVisibility(frameState, viewportIds) {\n    if (this._frameNumber === frameState.frameNumber) {\n      // Return early if visibility has already been checked during the traversal.\n      // The visibility may have already been checked if the cullWithChildrenBounds optimization is used.\n      return;\n    }\n\n    const parent = this.parent;\n    const parentVisibilityPlaneMask = parent\n      ? parent._visibilityPlaneMask\n      : CullingVolume.MASK_INDETERMINATE;\n\n    if (this.tileset._traverser.options.updateTransforms) {\n      const parentTransform = parent ? parent.computedTransform : this.tileset.modelMatrix;\n      this._updateTransform(parentTransform);\n    }\n\n    this._distanceToCamera = this.distanceToTile(frameState);\n    this._screenSpaceError = this.getScreenSpaceError(frameState, false);\n    this._visibilityPlaneMask = this.visibility(frameState, parentVisibilityPlaneMask); // Use parent's plane mask to speed up visibility test\n    this._visible = this._visibilityPlaneMask !== CullingVolume.MASK_OUTSIDE;\n    this._inRequestVolume = this.insideViewerRequestVolume(frameState);\n\n    this._frameNumber = frameState.frameNumber;\n    this.viewportIds = viewportIds;\n  }\n\n  // Determines whether the tile's bounding volume intersects the culling volume.\n  // @param {FrameState} frameState The frame state.\n  // @param {Number} parentVisibilityPlaneMask The parent's plane mask to speed up the visibility check.\n  // @returns {Number} A plane mask as described above in {@link CullingVolume#computeVisibilityWithPlaneMask}.\n  visibility(frameState, parentVisibilityPlaneMask) {\n    const {cullingVolume} = frameState;\n    const {boundingVolume} = this;\n\n    // TODO Cesium specific - restore clippingPlanes\n    // const {clippingPlanes, clippingPlanesOriginMatrix} = tileset;\n    // if (clippingPlanes && clippingPlanes.enabled) {\n    //   const intersection = clippingPlanes.computeIntersectionWithBoundingVolume(\n    //     boundingVolume,\n    //     clippingPlanesOriginMatrix\n    //   );\n    //   this._isClipped = intersection !== Intersect.INSIDE;\n    //   if (intersection === Intersect.OUTSIDE) {\n    //     return CullingVolume.MASK_OUTSIDE;\n    //   }\n    // }\n\n    // return cullingVolume.computeVisibilityWithPlaneMask(boundingVolume, parentVisibilityPlaneMask);\n    return cullingVolume.computeVisibilityWithPlaneMask(boundingVolume, parentVisibilityPlaneMask);\n  }\n\n  // Assuming the tile's bounding volume intersects the culling volume, determines\n  // whether the tile's content's bounding volume intersects the culling volume.\n  // @param {FrameState} frameState The frame state.\n  // @returns {Intersect} The result of the intersection: the tile's content is completely outside, completely inside, or intersecting the culling volume.\n  contentVisibility() {\n    return true;\n\n    // TODO restore\n    /*\n    // Assumes the tile's bounding volume intersects the culling volume already, so\n    // just return Intersect.INSIDE if there is no content bounding volume.\n    if (!defined(this.contentBoundingVolume)) {\n      return Intersect.INSIDE;\n    }\n\n    if (this._visibilityPlaneMask === CullingVolume.MASK_INSIDE) {\n      // The tile's bounding volume is completely inside the culling volume so\n      // the content bounding volume must also be inside.\n      return Intersect.INSIDE;\n    }\n\n    // PERFORMANCE_IDEA: is it possible to burn less CPU on this test since we know the\n    // tile's (not the content's) bounding volume intersects the culling volume?\n    const cullingVolume = frameState.cullingVolume;\n    const boundingVolume = tile.contentBoundingVolume;\n\n    const tileset = this.tileset;\n    const clippingPlanes = tileset.clippingPlanes;\n    if (defined(clippingPlanes) && clippingPlanes.enabled) {\n      const intersection = clippingPlanes.computeIntersectionWithBoundingVolume(\n        boundingVolume,\n        tileset.clippingPlanesOriginMatrix\n      );\n      this._isClipped = intersection !== Intersect.INSIDE;\n      if (intersection === Intersect.OUTSIDE) {\n        return Intersect.OUTSIDE;\n      }\n    }\n\n    return cullingVolume.computeVisibility(boundingVolume);\n    */\n  }\n\n  /**\n   * Computes the (potentially approximate) distance from the closest point of the tile's bounding volume to the camera.\n   * @param frameState The frame state.\n   * @returns {Number} The distance, in meters, or zero if the camera is inside the bounding volume.\n   */\n  distanceToTile(frameState: FrameState): number {\n    const boundingVolume = this.boundingVolume;\n    return Math.sqrt(Math.max(boundingVolume.distanceSquaredTo(frameState.camera.position), 0));\n  }\n\n  /**\n   * Computes the tile's camera-space z-depth.\n   * @param frameState The frame state.\n   * @returns The distance, in meters.\n   */\n  cameraSpaceZDepth({camera}): number {\n    const boundingVolume = this.boundingVolume; // Gets the underlying OrientedBoundingBox or BoundingSphere\n    scratchVector.subVectors(boundingVolume.center, camera.position);\n    return camera.direction.dot(scratchVector);\n  }\n\n  /**\n   * Checks if the camera is inside the viewer request volume.\n   * @param {FrameState} frameState The frame state.\n   * @returns {Boolean} Whether the camera is inside the volume.\n   */\n  insideViewerRequestVolume(frameState: FrameState) {\n    const viewerRequestVolume = this._viewerRequestVolume;\n    return (\n      !viewerRequestVolume || viewerRequestVolume.distanceSquaredTo(frameState.camera.position) <= 0\n    );\n  }\n\n  // TODO Cesium specific\n\n  // Update whether the tile has expired.\n  updateExpiration() {\n    if (defined(this._expireDate) && this.contentReady && !this.hasEmptyContent) {\n      const now = Date.now();\n      // @ts-ignore Date.lessThan - replace with ms compare?\n      if (Date.lessThan(this._expireDate, now)) {\n        this.contentState = TILE_CONTENT_STATE.EXPIRED;\n        this._expiredContent = this.content;\n      }\n    }\n  }\n\n  get extras() {\n    return this.header.extras;\n  }\n\n  // INTERNAL METHODS\n\n  _initializeLodMetric(header) {\n    if ('lodMetricType' in header) {\n      this.lodMetricType = header.lodMetricType;\n    } else {\n      this.lodMetricType = (this.parent && this.parent.lodMetricType) || this.tileset.lodMetricType;\n      // eslint-disable-next-line\n      console.warn(`3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType`);\n    }\n\n    // This is used to compute screen space error, i.e., the error measured in pixels.\n    if ('lodMetricValue' in header) {\n      this.lodMetricValue = header.lodMetricValue;\n    } else {\n      this.lodMetricValue =\n        (this.parent && this.parent.lodMetricValue) || this.tileset.lodMetricValue;\n      // eslint-disable-next-line\n      console.warn(\n        '3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue'\n      );\n    }\n  }\n\n  _initializeTransforms(tileHeader) {\n    // The local transform of this tile.\n    this.transform = tileHeader.transform ? new Matrix4(tileHeader.transform) : new Matrix4();\n\n    const parent = this.parent;\n    const tileset = this.tileset;\n\n    const parentTransform =\n      parent && parent.computedTransform\n        ? parent.computedTransform.clone()\n        : tileset.modelMatrix.clone();\n    this.computedTransform = new Matrix4(parentTransform).multiplyRight(this.transform);\n\n    const parentInitialTransform =\n      parent && parent._initialTransform ? parent._initialTransform.clone() : new Matrix4();\n    this._initialTransform = new Matrix4(parentInitialTransform).multiplyRight(this.transform);\n  }\n\n  _initializeBoundingVolumes(tileHeader) {\n    this._contentBoundingVolume = null;\n    this._viewerRequestVolume = null;\n\n    this._updateBoundingVolume(tileHeader);\n  }\n\n  _initializeContent(tileHeader) {\n    // Empty tile by default\n    this.content = {_tileset: this.tileset, _tile: this};\n    this.hasEmptyContent = true;\n    this.contentState = TILE_CONTENT_STATE.UNLOADED;\n\n    // When `true`, the tile's content points to an external tileset.\n    // This is `false` until the tile's content is loaded.\n    this.hasTilesetContent = false;\n\n    if (tileHeader.contentUrl) {\n      this.content = null;\n      this.hasEmptyContent = false;\n    }\n  }\n\n  // TODO - remove anything not related to basic visibility detection\n  _initializeRenderingState(header) {\n    this.depth = header.level || (this.parent ? this.parent.depth + 1 : 0);\n    this._shouldRefine = false;\n\n    // Members this are updated every frame for tree traversal and rendering optimizations:\n    this._distanceToCamera = 0;\n    this._centerZDepth = 0;\n    this._screenSpaceError = 0;\n    this._visibilityPlaneMask = CullingVolume.MASK_INDETERMINATE;\n    this._visible = undefined;\n    this._inRequestVolume = false;\n\n    this._stackLength = 0;\n    this._selectionDepth = 0;\n\n    this._frameNumber = 0;\n    this._touchedFrame = 0;\n    this._visitedFrame = 0;\n    this._selectedFrame = 0;\n    this._requestedFrame = 0;\n\n    this._priority = 0.0;\n  }\n\n  _getRefine(refine) {\n    // Inherit from parent tile if omitted.\n    return refine || (this.parent && this.parent.refine) || TILE_REFINEMENT.REPLACE;\n  }\n\n  _isTileset() {\n    return this.contentUrl.indexOf('.json') !== -1;\n  }\n\n  _onContentLoaded() {\n    // Vector and Geometry tile rendering do not support the skip LOD optimization.\n    switch (this.content && this.content.type) {\n      case 'vctr':\n      case 'geom':\n        // @ts-ignore\n        this.tileset._traverser.disableSkipLevelOfDetail = true;\n        break;\n      default:\n    }\n\n    // The content may be tileset json\n    if (this._isTileset()) {\n      this.hasTilesetContent = true;\n    }\n  }\n\n  _updateBoundingVolume(header) {\n    // Update the bounding volumes\n    this.boundingVolume = createBoundingVolume(\n      header.boundingVolume,\n      this.computedTransform,\n      this.boundingVolume\n    );\n\n    const content = header.content;\n    if (!content) {\n      return;\n    }\n\n    // TODO Cesium specific\n    // Non-leaf tiles may have a content bounding-volume, which is a tight-fit bounding volume\n    // around only the features in the tile. This box is useful for culling for rendering,\n    // but not for culling for traversing the tree since it does not guarantee spatial coherence, i.e.,\n    // since it only bounds features in the tile, not the entire tile, children may be\n    // outside of this box.\n    if (content.boundingVolume) {\n      this._contentBoundingVolume = createBoundingVolume(\n        content.boundingVolume,\n        this.computedTransform,\n        this._contentBoundingVolume\n      );\n    }\n    if (header.viewerRequestVolume) {\n      this._viewerRequestVolume = createBoundingVolume(\n        header.viewerRequestVolume,\n        this.computedTransform,\n        this._viewerRequestVolume\n      );\n    }\n  }\n\n  // Update the tile's transform. The transform is applied to the tile's bounding volumes.\n  _updateTransform(parentTransform = new Matrix4()) {\n    const computedTransform = parentTransform.clone().multiplyRight(this.transform);\n    const didTransformChange = !computedTransform.equals(this.computedTransform);\n\n    if (!didTransformChange) {\n      return;\n    }\n\n    this.computedTransform = computedTransform;\n\n    this._updateBoundingVolume(this.header);\n  }\n\n  // Get options which are applicable only for the particular loader\n  _getLoaderSpecificOptions(loaderId) {\n    switch (loaderId) {\n      case 'i3s':\n        return {\n          ...this.tileset.options.i3s,\n          tile: this.header,\n          tileset: this.tileset.tileset,\n          isTileHeader: false\n        };\n      case '3d-tiles':\n      case 'cesium-ion':\n      default:\n        return get3dTilesOptions(this.tileset.tileset);\n    }\n  }\n}\n","import {resolvePath} from '@loaders.gl/loader-utils';\nimport {makeResponse} from '../utils/response-utils';\n// import {getErrorMessageFromResponse} from './fetch-error-message';\n\n/**\n * fetch compatible function\n * Reads file data from:\n * - http/http urls\n * - data urls\n * - File/Blob objects\n * Leverages `@loaders.gl/polyfills` for Node.js support\n * Respects pathPrefix and file aliases\n */\nexport async function fetchFile(\n  url: string | Blob,\n  options?: RequestInit & {fetch?: RequestInit | Function}\n): Promise<Response> {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n\n    let fetchOptions: RequestInit = options as RequestInit;\n    if (options?.fetch && typeof options?.fetch !== 'function') {\n      fetchOptions = options.fetch;\n    }\n\n    return await fetch(url, fetchOptions);\n  }\n\n  return await makeResponse(url);\n}\n","// file write\nimport {isBrowser, assert, resolvePath} from '@loaders.gl/loader-utils';\nimport {fs, toBuffer} from '@loaders.gl/loader-utils';\n\nexport async function writeFile(\n  filePath: string,\n  arrayBufferOrString: ArrayBuffer | string,\n  options?\n): Promise<void> {\n  filePath = resolvePath(filePath);\n  if (!isBrowser) {\n    await fs.writeFile(filePath, toBuffer(arrayBufferOrString), {flag: 'w'});\n  }\n  assert(false);\n}\n\nexport function writeFileSync(\n  filePath: string,\n  arrayBufferOrString: ArrayBuffer | string,\n  options?\n): void {\n  filePath = resolvePath(filePath);\n  if (!isBrowser) {\n    fs.writeFileSync(filePath, toBuffer(arrayBufferOrString), {flag: 'w'});\n  }\n  assert(false);\n}\n","import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {assert, validateWorkerVersion} from '@loaders.gl/worker-utils';\nimport {parseWithWorker, canParseWithWorker} from '@loaders.gl/loader-utils';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {normalizeOptions} from '../loader-utils/option-utils';\nimport {getArrayBufferOrStringFromData} from '../loader-utils/get-data';\nimport {getLoaderContext, getLoadersFromContext} from '../loader-utils/loader-context';\nimport {getResourceUrlAndType} from '../utils/resource-utils';\nimport {selectLoader} from './select-loader';\n\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport async function parse(\n  data: DataType | Promise<DataType>,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  assert(!context || typeof context === 'object'); // parse no longer accepts final url\n\n  // Signature: parse(data, options, context | url)\n  // Uses registered loaders\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  data = await data; // Resolve any promise\n  options = options || {};\n\n  // Extract a url for auto detection\n  const {url} = getResourceUrlAndType(data);\n\n  // Chooses a loader (and normalizes it)\n  // Also use any loaders in the context, new loaders take priority\n  const typedLoaders = loaders as Loader | Loader[] | undefined;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  // todo hacky type cast\n  const loader = await selectLoader(data as ArrayBuffer, candidateLoaders, options);\n  // Note: if no loader was found, if so just return null\n  if (!loader) {\n    return null;\n  }\n\n  // Normalize options\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n\n  // Get a context (if already present, will be unchanged)\n  context = getLoaderContext({url, parse, loaders: candidateLoaders}, options, context);\n\n  return await parseWithLoader(loader, data, options, context);\n}\n\n// TODO: support progress and abort\n// TODO - should accept loader.parseAsyncIterator and concatenate.\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n\n  // First check for synchronous text parser, wrap results in promises\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n\n  // If we have a workerUrl and the loader can parse the given options efficiently in a worker\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n\n  // Check for asynchronous parser\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n\n  // This should not happen, all sync loaders should also offer `parse` function\n  assert(!loader.parseSync);\n\n  // TBD - If asynchronous parser not available, return null\n  throw new Error(`${loader.id} loader - no parser found and worker is disabled`);\n}\n","import type {\n  DataType,\n  SyncDataType,\n  BatchableDataType,\n  Loader,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport {concatenateArrayBuffersAsync} from '@loaders.gl/loader-utils';\nimport {\n  isResponse,\n  isReadableStream,\n  isAsyncIterable,\n  isIterable,\n  isIterator,\n  isBlob,\n  isBuffer\n} from '../../javascript-utils/is-type';\nimport {makeIterator} from '../../iterators/make-iterator/make-iterator';\nimport {checkResponse, makeResponse} from '../utils/response-utils';\n\nconst ERR_DATA = 'Cannot convert supplied data type';\n\n// eslint-disable-next-line complexity\nexport function getArrayBufferOrStringFromDataSync(\n  data: SyncDataType,\n  loader: Loader,\n  options: LoaderOptions\n): ArrayBuffer | string {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n\n  if (isBuffer(data)) {\n    // @ts-ignore\n    data = data.buffer;\n  }\n\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n    return arrayBuffer;\n  }\n\n  // We may need to handle offsets\n  if (ArrayBuffer.isView(data)) {\n    // TextDecoder is invoked on typed arrays and will handle offsets\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n\n    let arrayBuffer = data.buffer;\n\n    // Since we are returning the underlying arrayBuffer, we must create a new copy\n    // if this typed array / Buffer is a partial view into the ArryayBuffer\n    // TODO - this is a potentially unnecessary copy\n    const byteLength = data.byteLength || data.length;\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      // console.warn(`loaders.gl copying arraybuffer of length ${byteLength}`);\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n    return arrayBuffer;\n  }\n\n  throw new Error(ERR_DATA);\n}\n\n// Convert async iterator to a promise\nexport async function getArrayBufferOrStringFromData(\n  data: DataType,\n  loader: Loader,\n  options: LoaderOptions\n): Promise<ArrayBuffer | string> {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data as string | ArrayBuffer, loader, options);\n  }\n\n  // Blobs and files are FileReader compatible\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n\n  if (isReadableStream(data)) {\n    // @ts-expect-error TS2559 options type\n    data = makeIterator(data as ReadableStream, options);\n  }\n\n  if (isIterable(data) || isAsyncIterable(data)) {\n    // Assume arrayBuffer iterator - attempt to concatenate\n    return concatenateArrayBuffersAsync(data as AsyncIterable<ArrayBuffer>);\n  }\n\n  throw new Error(ERR_DATA);\n}\n\nexport async function getAsyncIterableFromData(\n  data: BatchableDataType,\n  options: LoaderOptions\n): Promise<AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>> {\n  if (isIterator(data)) {\n    return data as AsyncIterable<ArrayBuffer>;\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    // Note Since this function is not async, we currently can't load error message, just status\n    await checkResponse(response);\n    // TODO - bug in polyfill, body can be a Promise under Node.js\n    // eslint-disable-next-line @typescript-eslint/await-thenable\n    const body = await response.body;\n    // TODO - body can be null?\n    return makeIterator(body as ReadableStream<Uint8Array>, options as any);\n  }\n\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data as Blob | ReadableStream, options as any);\n  }\n\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n\n  return getIterableFromData(data);\n}\n\nexport async function getReadableStream(data: BatchableDataType): Promise<ReadableStream> {\n  if (isReadableStream(data)) {\n    return data as ReadableStream;\n  }\n  if (isResponse(data)) {\n    // @ts-ignore\n    return data.body;\n  }\n  const response = await makeResponse(data);\n  // @ts-ignore\n  return response.body;\n}\n\n// HELPERS\n\nfunction getIterableFromData(data) {\n  // generate an iterator that emits a single chunk\n  if (ArrayBuffer.isView(data)) {\n    return (function* oneChunk() {\n      yield data.buffer;\n    })();\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return (function* oneChunk() {\n      yield data;\n    })();\n  }\n\n  if (isIterator(data)) {\n    return data;\n  }\n\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n\n  throw new Error(ERR_DATA);\n}\n","import type {Loader, LoaderOptions, LoaderContext} from '@loaders.gl/loader-utils';\nimport {getFetchFunction} from './option-utils';\n\n/**\n * \"sub\" loaders invoked by other loaders get a \"context\" injected on `this`\n * The context will inject core methods like `parse` and contain information\n * about loaders and options passed in to the top-level `parse` call.\n *\n * @param context\n * @param options\n * @param previousContext\n */\nexport function getLoaderContext(\n  context: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>,\n  options?: LoaderOptions,\n  previousContext: LoaderContext | null = null\n): LoaderContext {\n  // For recursive calls, we already have a context\n  // TODO - add any additional loaders to context?\n  if (previousContext) {\n    return previousContext;\n  }\n\n  const resolvedContext: LoaderContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n\n  // Recursive loading does not use single loader\n  if (!Array.isArray(resolvedContext.loaders)) {\n    resolvedContext.loaders = null;\n  }\n\n  return resolvedContext;\n}\n\n// eslint-disable-next-line complexity\nexport function getLoadersFromContext(\n  loaders: Loader[] | Loader | undefined,\n  context?: LoaderContext\n) {\n  // A single non-array loader is force selected, but only on top-level (context === null)\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n\n  // Create a merged list\n  let candidateLoaders;\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n  // If no loaders, return null to look in globally registered loaders\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n","export const INTERSECTION = Object.freeze({\n  OUTSIDE: -1,\n  INTERSECTING: 0,\n  INSIDE: 1\n});\n//# sourceMappingURL=constants.js.map","import { Vector3 } from '@math.gl/core';\nimport { INTERSECTION } from '../../constants';\nconst scratchVector = new Vector3();\nconst scratchNormal = new Vector3();\nexport default class AxisAlignedBoundingBox {\n  constructor(minimum = [0, 0, 0], maximum = [0, 0, 0], center = null) {\n    center = center || scratchVector.copy(minimum).add(maximum).scale(0.5);\n    this.center = new Vector3(center);\n    this.halfDiagonal = new Vector3(maximum).subtract(this.center);\n    this.minimum = new Vector3(minimum);\n    this.maximum = new Vector3(maximum);\n  }\n\n  clone() {\n    return new AxisAlignedBoundingBox(this.minimum, this.maximum, this.center);\n  }\n\n  equals(right) {\n    return this === right || Boolean(right) && this.minimum.equals(right.minimum) && this.maximum.equals(right.maximum);\n  }\n\n  transform(transformation) {\n    this.center.transformAsPoint(transformation);\n    this.halfDiagonal.transform(transformation);\n    this.minimum.transform(transformation);\n    this.maximum.transform(transformation);\n    return this;\n  }\n\n  intersectPlane(plane) {\n    const {\n      halfDiagonal\n    } = this;\n    const normal = scratchNormal.from(plane.normal);\n    const e = halfDiagonal.x * Math.abs(normal.x) + halfDiagonal.y * Math.abs(normal.y) + halfDiagonal.z * Math.abs(normal.z);\n    const s = this.center.dot(normal) + plane.distance;\n\n    if (s - e > 0) {\n      return INTERSECTION.INSIDE;\n    }\n\n    if (s + e < 0) {\n      return INTERSECTION.OUTSIDE;\n    }\n\n    return INTERSECTION.INTERSECTING;\n  }\n\n  distanceTo(point) {\n    return Math.sqrt(this.distanceSquaredTo(point));\n  }\n\n  distanceSquaredTo(point) {\n    const offset = scratchVector.from(point).subtract(this.center);\n    const {\n      halfDiagonal\n    } = this;\n    let distanceSquared = 0.0;\n    let d;\n    d = Math.abs(offset.x) - halfDiagonal.x;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    d = Math.abs(offset.y) - halfDiagonal.y;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    d = Math.abs(offset.z) - halfDiagonal.z;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    return distanceSquared;\n  }\n\n}\n//# sourceMappingURL=axis-aligned-bounding-box.js.map","import { Vector3 } from '@math.gl/core';\nimport * as mat4 from 'gl-matrix/mat4';\nimport { INTERSECTION } from '../../constants';\nconst scratchVector = new Vector3();\nconst scratchVector2 = new Vector3();\nexport default class BoundingSphere {\n  constructor(center = [0, 0, 0], radius = 0.0) {\n    this.radius = -0;\n    this.center = new Vector3();\n    this.fromCenterRadius(center, radius);\n  }\n\n  fromCenterRadius(center, radius) {\n    this.center.from(center);\n    this.radius = radius;\n    return this;\n  }\n\n  fromCornerPoints(corner, oppositeCorner) {\n    oppositeCorner = scratchVector.from(oppositeCorner);\n    this.center = new Vector3().from(corner).add(oppositeCorner).scale(0.5);\n    this.radius = this.center.distance(oppositeCorner);\n    return this;\n  }\n\n  equals(right) {\n    return this === right || Boolean(right) && this.center.equals(right.center) && this.radius === right.radius;\n  }\n\n  clone() {\n    return new BoundingSphere(this.center, this.radius);\n  }\n\n  union(boundingSphere) {\n    const leftCenter = this.center;\n    const leftRadius = this.radius;\n    const rightCenter = boundingSphere.center;\n    const rightRadius = boundingSphere.radius;\n    const toRightCenter = scratchVector.copy(rightCenter).subtract(leftCenter);\n    const centerSeparation = toRightCenter.magnitude();\n\n    if (leftRadius >= centerSeparation + rightRadius) {\n      return this.clone();\n    }\n\n    if (rightRadius >= centerSeparation + leftRadius) {\n      return boundingSphere.clone();\n    }\n\n    const halfDistanceBetweenTangentPoints = (leftRadius + centerSeparation + rightRadius) * 0.5;\n    scratchVector2.copy(toRightCenter).scale((-leftRadius + halfDistanceBetweenTangentPoints) / centerSeparation).add(leftCenter);\n    this.center.copy(scratchVector2);\n    this.radius = halfDistanceBetweenTangentPoints;\n    return this;\n  }\n\n  expand(point) {\n    point = scratchVector.from(point);\n    const radius = point.subtract(this.center).magnitude();\n\n    if (radius > this.radius) {\n      this.radius = radius;\n    }\n\n    return this;\n  }\n\n  transform(transform) {\n    this.center.transform(transform);\n    const scale = mat4.getScaling(scratchVector, transform);\n    this.radius = Math.max(scale[0], Math.max(scale[1], scale[2])) * this.radius;\n    return this;\n  }\n\n  distanceSquaredTo(point) {\n    point = scratchVector.from(point);\n    const delta = point.subtract(this.center);\n    return delta.lengthSquared() - this.radius * this.radius;\n  }\n\n  distanceTo(point) {\n    return Math.sqrt(this.distanceSquaredTo(point));\n  }\n\n  intersectPlane(plane) {\n    const center = this.center;\n    const radius = this.radius;\n    const normal = plane.normal;\n    const distanceToPlane = normal.dot(center) + plane.distance;\n\n    if (distanceToPlane < -radius) {\n      return INTERSECTION.OUTSIDE;\n    }\n\n    if (distanceToPlane < radius) {\n      return INTERSECTION.INTERSECTING;\n    }\n\n    return INTERSECTION.INSIDE;\n  }\n\n}\n//# sourceMappingURL=bounding-sphere.js.map","import { Vector3, Matrix3, Quaternion } from '@math.gl/core';\nimport BoundingSphere from './bounding-sphere';\nimport { INTERSECTION } from '../../constants';\nconst scratchVector3 = new Vector3();\nconst scratchOffset = new Vector3();\nconst scratchVectorU = new Vector3();\nconst scratchVectorV = new Vector3();\nconst scratchVectorW = new Vector3();\nconst scratchCorner = new Vector3();\nconst scratchToCenter = new Vector3();\nconst MATRIX3 = {\n  COLUMN0ROW0: 0,\n  COLUMN0ROW1: 1,\n  COLUMN0ROW2: 2,\n  COLUMN1ROW0: 3,\n  COLUMN1ROW1: 4,\n  COLUMN1ROW2: 5,\n  COLUMN2ROW0: 6,\n  COLUMN2ROW1: 7,\n  COLUMN2ROW2: 8\n};\nexport default class OrientedBoundingBox {\n  constructor(center = [0, 0, 0], halfAxes = [0, 0, 0, 0, 0, 0, 0, 0, 0]) {\n    this.center = new Vector3().from(center);\n    this.halfAxes = new Matrix3(halfAxes);\n  }\n\n  get halfSize() {\n    const xAxis = this.halfAxes.getColumn(0);\n    const yAxis = this.halfAxes.getColumn(1);\n    const zAxis = this.halfAxes.getColumn(2);\n    return [new Vector3(xAxis).len(), new Vector3(yAxis).len(), new Vector3(zAxis).len()];\n  }\n\n  get quaternion() {\n    const xAxis = this.halfAxes.getColumn(0);\n    const yAxis = this.halfAxes.getColumn(1);\n    const zAxis = this.halfAxes.getColumn(2);\n    const normXAxis = new Vector3(xAxis).normalize();\n    const normYAxis = new Vector3(yAxis).normalize();\n    const normZAxis = new Vector3(zAxis).normalize();\n    return new Quaternion().fromMatrix3(new Matrix3([...normXAxis, ...normYAxis, ...normZAxis]));\n  }\n\n  fromCenterHalfSizeQuaternion(center, halfSize, quaternion) {\n    const quaternionObject = new Quaternion(quaternion);\n    const directionsMatrix = new Matrix3().fromQuaternion(quaternionObject);\n    directionsMatrix[0] = directionsMatrix[0] * halfSize[0];\n    directionsMatrix[1] = directionsMatrix[1] * halfSize[0];\n    directionsMatrix[2] = directionsMatrix[2] * halfSize[0];\n    directionsMatrix[3] = directionsMatrix[3] * halfSize[1];\n    directionsMatrix[4] = directionsMatrix[4] * halfSize[1];\n    directionsMatrix[5] = directionsMatrix[5] * halfSize[1];\n    directionsMatrix[6] = directionsMatrix[6] * halfSize[2];\n    directionsMatrix[7] = directionsMatrix[7] * halfSize[2];\n    directionsMatrix[8] = directionsMatrix[8] * halfSize[2];\n    this.center = new Vector3().from(center);\n    this.halfAxes = directionsMatrix;\n    return this;\n  }\n\n  clone() {\n    return new OrientedBoundingBox(this.center, this.halfAxes);\n  }\n\n  equals(right) {\n    return this === right || Boolean(right) && this.center.equals(right.center) && this.halfAxes.equals(right.halfAxes);\n  }\n\n  getBoundingSphere(result = new BoundingSphere()) {\n    const halfAxes = this.halfAxes;\n    const u = halfAxes.getColumn(0, scratchVectorU);\n    const v = halfAxes.getColumn(1, scratchVectorV);\n    const w = halfAxes.getColumn(2, scratchVectorW);\n    const cornerVector = scratchVector3.copy(u).add(v).add(w);\n    result.center.copy(this.center);\n    result.radius = cornerVector.magnitude();\n    return result;\n  }\n\n  intersectPlane(plane) {\n    const center = this.center;\n    const normal = plane.normal;\n    const halfAxes = this.halfAxes;\n    const normalX = normal.x;\n    const normalY = normal.y;\n    const normalZ = normal.z;\n    const radEffective = Math.abs(normalX * halfAxes[MATRIX3.COLUMN0ROW0] + normalY * halfAxes[MATRIX3.COLUMN0ROW1] + normalZ * halfAxes[MATRIX3.COLUMN0ROW2]) + Math.abs(normalX * halfAxes[MATRIX3.COLUMN1ROW0] + normalY * halfAxes[MATRIX3.COLUMN1ROW1] + normalZ * halfAxes[MATRIX3.COLUMN1ROW2]) + Math.abs(normalX * halfAxes[MATRIX3.COLUMN2ROW0] + normalY * halfAxes[MATRIX3.COLUMN2ROW1] + normalZ * halfAxes[MATRIX3.COLUMN2ROW2]);\n    const distanceToPlane = normal.dot(center) + plane.distance;\n\n    if (distanceToPlane <= -radEffective) {\n      return INTERSECTION.OUTSIDE;\n    } else if (distanceToPlane >= radEffective) {\n      return INTERSECTION.INSIDE;\n    }\n\n    return INTERSECTION.INTERSECTING;\n  }\n\n  distanceTo(point) {\n    return Math.sqrt(this.distanceSquaredTo(point));\n  }\n\n  distanceSquaredTo(point) {\n    const offset = scratchOffset.from(point).subtract(this.center);\n    const halfAxes = this.halfAxes;\n    const u = halfAxes.getColumn(0, scratchVectorU);\n    const v = halfAxes.getColumn(1, scratchVectorV);\n    const w = halfAxes.getColumn(2, scratchVectorW);\n    const uHalf = u.magnitude();\n    const vHalf = v.magnitude();\n    const wHalf = w.magnitude();\n    u.normalize();\n    v.normalize();\n    w.normalize();\n    let distanceSquared = 0.0;\n    let d;\n    d = Math.abs(offset.dot(u)) - uHalf;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    d = Math.abs(offset.dot(v)) - vHalf;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    d = Math.abs(offset.dot(w)) - wHalf;\n\n    if (d > 0) {\n      distanceSquared += d * d;\n    }\n\n    return distanceSquared;\n  }\n\n  computePlaneDistances(position, direction, result = [-0, -0]) {\n    let minDist = Number.POSITIVE_INFINITY;\n    let maxDist = Number.NEGATIVE_INFINITY;\n    const center = this.center;\n    const halfAxes = this.halfAxes;\n    const u = halfAxes.getColumn(0, scratchVectorU);\n    const v = halfAxes.getColumn(1, scratchVectorV);\n    const w = halfAxes.getColumn(2, scratchVectorW);\n    const corner = scratchCorner.copy(u).add(v).add(w).add(center);\n    const toCenter = scratchToCenter.copy(corner).subtract(position);\n    let mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    corner.copy(center).add(u).add(v).subtract(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    corner.copy(center).add(u).subtract(v).add(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    corner.copy(center).add(u).subtract(v).subtract(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    center.copy(corner).subtract(u).add(v).add(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    center.copy(corner).subtract(u).add(v).subtract(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    center.copy(corner).subtract(u).subtract(v).add(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    center.copy(corner).subtract(u).subtract(v).subtract(w);\n    toCenter.copy(corner).subtract(position);\n    mag = direction.dot(toCenter);\n    minDist = Math.min(mag, minDist);\n    maxDist = Math.max(mag, maxDist);\n    result[0] = minDist;\n    result[1] = maxDist;\n    return result;\n  }\n\n  transform(transformation) {\n    this.center.transformAsPoint(transformation);\n    const xAxis = this.halfAxes.getColumn(0, scratchVectorU);\n    xAxis.transformAsPoint(transformation);\n    const yAxis = this.halfAxes.getColumn(1, scratchVectorV);\n    yAxis.transformAsPoint(transformation);\n    const zAxis = this.halfAxes.getColumn(2, scratchVectorW);\n    zAxis.transformAsPoint(transformation);\n    this.halfAxes = new Matrix3([...xAxis, ...yAxis, ...zAxis]);\n    return this;\n  }\n\n  getTransform() {\n    throw new Error('not implemented');\n  }\n\n}\n//# sourceMappingURL=oriented-bounding-box.js.map","import { Vector3, equals, assert } from '@math.gl/core';\nconst scratchPosition = new Vector3();\nconst scratchNormal = new Vector3();\nexport default class Plane {\n  constructor(normal = [0, 0, 1], distance = 0) {\n    this.normal = new Vector3();\n    this.distance = -0;\n    this.fromNormalDistance(normal, distance);\n  }\n\n  fromNormalDistance(normal, distance) {\n    assert(Number.isFinite(distance));\n    this.normal.from(normal).normalize();\n    this.distance = distance;\n    return this;\n  }\n\n  fromPointNormal(point, normal) {\n    point = scratchPosition.from(point);\n    this.normal.from(normal).normalize();\n    const distance = -this.normal.dot(point);\n    this.distance = distance;\n    return this;\n  }\n\n  fromCoefficients(a, b, c, d) {\n    this.normal.set(a, b, c);\n    assert(equals(this.normal.len(), 1));\n    this.distance = d;\n    return this;\n  }\n\n  clone(plane) {\n    return new Plane(this.normal, this.distance);\n  }\n\n  equals(right) {\n    return equals(this.distance, right.distance) && equals(this.normal, right.normal);\n  }\n\n  getPointDistance(point) {\n    return this.normal.dot(point) + this.distance;\n  }\n\n  transform(matrix4) {\n    const normal = scratchNormal.copy(this.normal).transformAsVector(matrix4).normalize();\n    const point = this.normal.scale(-this.distance).transform(matrix4);\n    return this.fromPointNormal(point, normal);\n  }\n\n  projectPointOntoPlane(point, result = [0, 0, 0]) {\n    point = scratchPosition.from(point);\n    const pointDistance = this.getPointDistance(point);\n    const scaledNormal = scratchNormal.copy(this.normal).scale(pointDistance);\n    return point.subtract(scaledNormal).to(result);\n  }\n\n}\n//# sourceMappingURL=plane.js.map","import { Vector3, Vector4, assert } from '@math.gl/core';\nimport { INTERSECTION } from '../constants';\nimport Plane from './plane';\nconst faces = [new Vector3([1, 0, 0]), new Vector3([0, 1, 0]), new Vector3([0, 0, 1])];\nconst scratchPlaneCenter = new Vector3();\nconst scratchPlaneNormal = new Vector3();\nconst scratchPlane = new Plane(new Vector3(1.0, 0.0, 0.0), 0.0);\nexport default class CullingVolume {\n  static get MASK_OUTSIDE() {\n    return 0xffffffff;\n  }\n\n  static get MASK_INSIDE() {\n    return 0x00000000;\n  }\n\n  static get MASK_INDETERMINATE() {\n    return 0x7fffffff;\n  }\n\n  constructor(planes = []) {\n    this.planes = planes;\n    assert(this.planes.every(plane => plane instanceof Plane));\n  }\n\n  fromBoundingSphere(boundingSphere) {\n    this.planes.length = 2 * faces.length;\n    const center = boundingSphere.center;\n    const radius = boundingSphere.radius;\n    let planeIndex = 0;\n\n    for (const faceNormal of faces) {\n      let plane0 = this.planes[planeIndex];\n      let plane1 = this.planes[planeIndex + 1];\n\n      if (!plane0) {\n        plane0 = this.planes[planeIndex] = new Plane();\n      }\n\n      if (!plane1) {\n        plane1 = this.planes[planeIndex + 1] = new Plane();\n      }\n\n      const plane0Center = scratchPlaneCenter.copy(faceNormal).scale(-radius).add(center);\n      const plane0Distance = -faceNormal.dot(plane0Center);\n      plane0.fromPointNormal(plane0Center, faceNormal);\n      const plane1Center = scratchPlaneCenter.copy(faceNormal).scale(radius).add(center);\n      const negatedFaceNormal = scratchPlaneNormal.copy(faceNormal).negate();\n      const plane1Distance = -negatedFaceNormal.dot(plane1Center);\n      plane1.fromPointNormal(plane1Center, negatedFaceNormal);\n      planeIndex += 2;\n    }\n\n    return this;\n  }\n\n  computeVisibility(boundingVolume) {\n    assert(boundingVolume);\n    let intersect = INTERSECTION.INSIDE;\n\n    for (const plane of this.planes) {\n      const result = boundingVolume.intersectPlane(plane);\n\n      switch (result) {\n        case INTERSECTION.OUTSIDE:\n          return INTERSECTION.OUTSIDE;\n\n        case INTERSECTION.INTERSECTING:\n          intersect = INTERSECTION.INTERSECTING;\n          break;\n\n        default:\n      }\n    }\n\n    return intersect;\n  }\n\n  computeVisibilityWithPlaneMask(boundingVolume, parentPlaneMask) {\n    assert(boundingVolume, 'boundingVolume is required.');\n    assert(Number.isFinite(parentPlaneMask), 'parentPlaneMask is required.');\n\n    if (parentPlaneMask === CullingVolume.MASK_OUTSIDE || parentPlaneMask === CullingVolume.MASK_INSIDE) {\n      return parentPlaneMask;\n    }\n\n    let mask = CullingVolume.MASK_INSIDE;\n    const planes = this.planes;\n\n    for (let k = 0; k < this.planes.length; ++k) {\n      const flag = k < 31 ? 1 << k : 0;\n\n      if (k < 31 && (parentPlaneMask & flag) === 0) {\n        continue;\n      }\n\n      const plane = planes[k];\n      const result = boundingVolume.intersectPlane(plane);\n\n      if (result === INTERSECTION.OUTSIDE) {\n        return CullingVolume.MASK_OUTSIDE;\n      } else if (result === INTERSECTION.INTERSECTING) {\n        mask |= flag;\n      }\n    }\n\n    return mask;\n  }\n\n}\n//# sourceMappingURL=culling-volume.js.map","import { Vector3, Matrix4, assert } from '@math.gl/core';\nimport CullingVolume from './culling-volume';\nimport Plane from './plane';\nconst scratchPlaneUpVector = new Vector3();\nconst scratchPlaneRightVector = new Vector3();\nconst scratchPlaneNearCenter = new Vector3();\nconst scratchPlaneFarCenter = new Vector3();\nconst scratchPlaneNormal = new Vector3();\nexport default class PerspectiveOffCenterFrustum {\n  constructor(options = {}) {\n    options = {\n      near: 1.0,\n      far: 500000000.0,\n      ...options\n    };\n    this.left = options.left;\n    this._left = undefined;\n    this.right = options.right;\n    this._right = undefined;\n    this.top = options.top;\n    this._top = undefined;\n    this.bottom = options.bottom;\n    this._bottom = undefined;\n    this.near = options.near;\n    this._near = this.near;\n    this.far = options.far;\n    this._far = this.far;\n    this._cullingVolume = new CullingVolume([new Plane(), new Plane(), new Plane(), new Plane(), new Plane(), new Plane()]);\n    this._perspectiveMatrix = new Matrix4();\n    this._infinitePerspective = new Matrix4();\n  }\n\n  clone() {\n    return new PerspectiveOffCenterFrustum({\n      right: this.right,\n      left: this.left,\n      top: this.top,\n      bottom: this.bottom,\n      near: this.near,\n      far: this.far\n    });\n  }\n\n  equals(other) {\n    return other && other instanceof PerspectiveOffCenterFrustum && this.right === other.right && this.left === other.left && this.top === other.top && this.bottom === other.bottom && this.near === other.near && this.far === other.far;\n  }\n\n  get projectionMatrix() {\n    update(this);\n    return this._perspectiveMatrix;\n  }\n\n  get infiniteProjectionMatrix() {\n    update(this);\n    return this._infinitePerspective;\n  }\n\n  computeCullingVolume(position, direction, up) {\n    assert(position, 'position is required.');\n    assert(direction, 'direction is required.');\n    assert(up, 'up is required.');\n    const planes = this._cullingVolume.planes;\n    up = scratchPlaneUpVector.copy(up).normalize();\n    const right = scratchPlaneRightVector.copy(direction).cross(up).normalize();\n    const nearCenter = scratchPlaneNearCenter.copy(direction).multiplyByScalar(this.near).add(position);\n    const farCenter = scratchPlaneFarCenter.copy(direction).multiplyByScalar(this.far).add(position);\n    let normal = scratchPlaneNormal;\n    normal.copy(right).multiplyByScalar(this.left).add(nearCenter).subtract(position).cross(up);\n    planes[0].fromPointNormal(position, normal);\n    normal.copy(right).multiplyByScalar(this.right).add(nearCenter).subtract(position).cross(up).negate();\n    planes[1].fromPointNormal(position, normal);\n    normal.copy(up).multiplyByScalar(this.bottom).add(nearCenter).subtract(position).cross(right).negate();\n    planes[2].fromPointNormal(position, normal);\n    normal.copy(up).multiplyByScalar(this.top).add(nearCenter).subtract(position).cross(right);\n    planes[3].fromPointNormal(position, normal);\n    normal = new Vector3().copy(direction);\n    planes[4].fromPointNormal(nearCenter, normal);\n    normal.negate();\n    planes[5].fromPointNormal(farCenter, normal);\n    return this._cullingVolume;\n  }\n\n  getPixelDimensions(drawingBufferWidth, drawingBufferHeight, distance, result) {\n    update(this);\n    assert(Number.isFinite(drawingBufferWidth) && Number.isFinite(drawingBufferHeight));\n    assert(drawingBufferWidth > 0);\n    assert(drawingBufferHeight > 0);\n    assert(distance > 0);\n    assert(result);\n    const inverseNear = 1.0 / this.near;\n    let tanTheta = this.top * inverseNear;\n    const pixelHeight = 2.0 * distance * tanTheta / drawingBufferHeight;\n    tanTheta = this.right * inverseNear;\n    const pixelWidth = 2.0 * distance * tanTheta / drawingBufferWidth;\n    result.x = pixelWidth;\n    result.y = pixelHeight;\n    return result;\n  }\n\n}\n\nfunction update(frustum) {\n  assert(Number.isFinite(frustum.right) && Number.isFinite(frustum.left) && Number.isFinite(frustum.top) && Number.isFinite(frustum.bottom) && Number.isFinite(frustum.near) && Number.isFinite(frustum.far));\n  const {\n    top,\n    bottom,\n    right,\n    left,\n    near,\n    far\n  } = frustum;\n\n  if (top !== frustum._top || bottom !== frustum._bottom || left !== frustum._left || right !== frustum._right || near !== frustum._near || far !== frustum._far) {\n    assert(frustum.near > 0 && frustum.near < frustum.far, 'near must be greater than zero and less than far.');\n    frustum._left = left;\n    frustum._right = right;\n    frustum._top = top;\n    frustum._bottom = bottom;\n    frustum._near = near;\n    frustum._far = far;\n    frustum._perspectiveMatrix = new Matrix4().frustum({\n      left,\n      right,\n      bottom,\n      top,\n      near,\n      far\n    });\n    frustum._infinitePerspective = new Matrix4().frustum({\n      left,\n      right,\n      bottom,\n      top,\n      near,\n      far: Infinity\n    });\n  }\n}\n//# sourceMappingURL=perspective-off-center-frustum.js.map","import { assert } from '@math.gl/core';\nimport PerspectiveOffCenterFrustum from './perspective-off-center-frustum';\n\nconst defined = val => val !== null && typeof val !== 'undefined';\n\nexport default class PerspectiveFrustum {\n  constructor(options = {}) {\n    options = {\n      near: 1.0,\n      far: 500000000.0,\n      xOffset: 0.0,\n      yOffset: 0.0,\n      ...options\n    };\n    this._offCenterFrustum = new PerspectiveOffCenterFrustum();\n    this.fov = options.fov;\n    this._fov = undefined;\n    this._fovy = undefined;\n    this._sseDenominator = undefined;\n    this.aspectRatio = options.aspectRatio;\n    this._aspectRatio = undefined;\n    this.near = options.near;\n    this._near = this.near;\n    this.far = options.far;\n    this._far = this.far;\n    this.xOffset = options.xOffset;\n    this._xOffset = this.xOffset;\n    this.yOffset = options.yOffset;\n    this._yOffset = this.yOffset;\n  }\n\n  clone() {\n    return new PerspectiveFrustum({\n      aspectRatio: this.aspectRatio,\n      fov: this.fov,\n      near: this.near,\n      far: this.far\n    });\n  }\n\n  equals(other) {\n    if (!defined(other) || !(other instanceof PerspectiveFrustum)) {\n      return false;\n    }\n\n    update(this);\n    update(other);\n    return this.fov === other.fov && this.aspectRatio === other.aspectRatio && this.near === other.near && this.far === other.far && this._offCenterFrustum.equals(other._offCenterFrustum);\n  }\n\n  get projectionMatrix() {\n    update(this);\n    return this._offCenterFrustum.projectionMatrix;\n  }\n\n  get infiniteProjectionMatrix() {\n    update(this);\n    return this._offCenterFrustum.infiniteProjectionMatrix;\n  }\n\n  get fovy() {\n    update(this);\n    return this._fovy;\n  }\n\n  get sseDenominator() {\n    update(this);\n    return this._sseDenominator;\n  }\n\n  computeCullingVolume(position, direction, up) {\n    update(this);\n    return this._offCenterFrustum.computeCullingVolume(position, direction, up);\n  }\n\n  getPixelDimensions(drawingBufferWidth, drawingBufferHeight, distance, result) {\n    update(this);\n    return this._offCenterFrustum.getPixelDimensions(drawingBufferWidth, drawingBufferHeight, distance, result);\n  }\n\n}\n\nfunction update(frustum) {\n  assert(Number.isFinite(frustum.fov) && Number.isFinite(frustum.aspectRatio) && Number.isFinite(frustum.near) && Number.isFinite(frustum.far));\n  const f = frustum._offCenterFrustum;\n\n  if (frustum.fov !== frustum._fov || frustum.aspectRatio !== frustum._aspectRatio || frustum.near !== frustum._near || frustum.far !== frustum._far || frustum.xOffset !== frustum._xOffset || frustum.yOffset !== frustum._yOffset) {\n    assert(frustum.fov >= 0 && frustum.fov < Math.PI);\n    assert(frustum.aspectRatio > 0);\n    assert(frustum.near >= 0 && frustum.near < frustum.far);\n    frustum._aspectRatio = frustum.aspectRatio;\n    frustum._fov = frustum.fov;\n    frustum._fovy = frustum.aspectRatio <= 1 ? frustum.fov : Math.atan(Math.tan(frustum.fov * 0.5) / frustum.aspectRatio) * 2.0;\n    frustum._near = frustum.near;\n    frustum._far = frustum.far;\n    frustum._sseDenominator = 2.0 * Math.tan(0.5 * frustum._fovy);\n    frustum._xOffset = frustum.xOffset;\n    frustum._yOffset = frustum.yOffset;\n    f.top = frustum.near * Math.tan(0.5 * frustum._fovy);\n    f.bottom = -f.top;\n    f.right = frustum.aspectRatio * f.top;\n    f.left = -f.right;\n    f.near = frustum.near;\n    f.far = frustum.far;\n    f.right += frustum.xOffset;\n    f.left += frustum.xOffset;\n    f.top += frustum.yOffset;\n    f.bottom += frustum.yOffset;\n  }\n}\n//# sourceMappingURL=perspective-frustum.js.map","import { Vector3 } from '@math.gl/core';\nimport BoundingSphere from '../bounding-volumes/bounding-sphere';\nconst fromPointsXMin = new Vector3();\nconst fromPointsYMin = new Vector3();\nconst fromPointsZMin = new Vector3();\nconst fromPointsXMax = new Vector3();\nconst fromPointsYMax = new Vector3();\nconst fromPointsZMax = new Vector3();\nconst fromPointsCurrentPos = new Vector3();\nconst fromPointsScratch = new Vector3();\nconst fromPointsRitterCenter = new Vector3();\nconst fromPointsMinBoxPt = new Vector3();\nconst fromPointsMaxBoxPt = new Vector3();\nconst fromPointsNaiveCenterScratch = new Vector3();\nconst volumeConstant = 4.0 / 3.0 * Math.PI;\nexport default function makeBoundingSphereFromPoints(positions, result = new BoundingSphere()) {\n  if (!positions || positions.length === 0) {\n    return result.fromCenterRadius([0, 0, 0], 0);\n  }\n\n  const currentPos = fromPointsCurrentPos.copy(positions[0]);\n  const xMin = fromPointsXMin.copy(currentPos);\n  const yMin = fromPointsYMin.copy(currentPos);\n  const zMin = fromPointsZMin.copy(currentPos);\n  const xMax = fromPointsXMax.copy(currentPos);\n  const yMax = fromPointsYMax.copy(currentPos);\n  const zMax = fromPointsZMax.copy(currentPos);\n\n  for (const position of positions) {\n    currentPos.copy(position);\n    const x = currentPos.x;\n    const y = currentPos.y;\n    const z = currentPos.z;\n\n    if (x < xMin.x) {\n      currentPos.copy(xMin);\n    }\n\n    if (x > xMax.x) {\n      currentPos.copy(xMax);\n    }\n\n    if (y < yMin.y) {\n      currentPos.copy(yMin);\n    }\n\n    if (y > yMax.y) {\n      currentPos.copy(yMax);\n    }\n\n    if (z < zMin.z) {\n      currentPos.copy(zMin);\n    }\n\n    if (z > zMax.z) {\n      currentPos.copy(zMax);\n    }\n  }\n\n  const xSpan = fromPointsScratch.copy(xMax).subtract(xMin).magnitudeSquared();\n  const ySpan = fromPointsScratch.copy(yMax).subtract(yMin).magnitudeSquared();\n  const zSpan = fromPointsScratch.copy(zMax).subtract(zMin).magnitudeSquared();\n  let diameter1 = xMin;\n  let diameter2 = xMax;\n  let maxSpan = xSpan;\n\n  if (ySpan > maxSpan) {\n    maxSpan = ySpan;\n    diameter1 = yMin;\n    diameter2 = yMax;\n  }\n\n  if (zSpan > maxSpan) {\n    maxSpan = zSpan;\n    diameter1 = zMin;\n    diameter2 = zMax;\n  }\n\n  const ritterCenter = fromPointsRitterCenter;\n  ritterCenter.x = (diameter1.x + diameter2.x) * 0.5;\n  ritterCenter.y = (diameter1.y + diameter2.y) * 0.5;\n  ritterCenter.z = (diameter1.z + diameter2.z) * 0.5;\n  let radiusSquared = fromPointsScratch.copy(diameter2).subtract(ritterCenter).magnitudeSquared();\n  let ritterRadius = Math.sqrt(radiusSquared);\n  const minBoxPt = fromPointsMinBoxPt;\n  minBoxPt.x = xMin.x;\n  minBoxPt.y = yMin.y;\n  minBoxPt.z = zMin.z;\n  const maxBoxPt = fromPointsMaxBoxPt;\n  maxBoxPt.x = xMax.x;\n  maxBoxPt.y = yMax.y;\n  maxBoxPt.z = zMax.z;\n  const naiveCenter = fromPointsNaiveCenterScratch.copy(minBoxPt).add(maxBoxPt).multiplyByScalar(0.5);\n  let naiveRadius = 0;\n\n  for (const position of positions) {\n    currentPos.copy(position);\n    const r = fromPointsScratch.copy(currentPos).subtract(naiveCenter).magnitude();\n\n    if (r > naiveRadius) {\n      naiveRadius = r;\n    }\n\n    const oldCenterToPointSquared = fromPointsScratch.copy(currentPos).subtract(ritterCenter).magnitudeSquared();\n\n    if (oldCenterToPointSquared > radiusSquared) {\n      const oldCenterToPoint = Math.sqrt(oldCenterToPointSquared);\n      ritterRadius = (ritterRadius + oldCenterToPoint) * 0.5;\n      radiusSquared = ritterRadius * ritterRadius;\n      const oldToNew = oldCenterToPoint - ritterRadius;\n      ritterCenter.x = (ritterRadius * ritterCenter.x + oldToNew * currentPos.x) / oldCenterToPoint;\n      ritterCenter.y = (ritterRadius * ritterCenter.y + oldToNew * currentPos.y) / oldCenterToPoint;\n      ritterCenter.z = (ritterRadius * ritterCenter.z + oldToNew * currentPos.z) / oldCenterToPoint;\n    }\n  }\n\n  if (ritterRadius < naiveRadius) {\n    ritterCenter.to(result.center);\n    result.radius = ritterRadius;\n  } else {\n    naiveCenter.to(result.center);\n    result.radius = naiveRadius;\n  }\n\n  return result;\n}\n//# sourceMappingURL=bounding-sphere-from-points.js.map","import { Matrix3, _MathUtils } from '@math.gl/core';\nconst scratchMatrix = new Matrix3();\nconst scratchUnitary = new Matrix3();\nconst scratchDiagonal = new Matrix3();\nconst jMatrix = new Matrix3();\nconst jMatrixTranspose = new Matrix3();\nexport default function computeEigenDecomposition(matrix, result = {}) {\n  const EIGEN_TOLERANCE = _MathUtils.EPSILON20;\n  const EIGEN_MAX_SWEEPS = 10;\n  let count = 0;\n  let sweep = 0;\n  const unitaryMatrix = scratchUnitary;\n  const diagonalMatrix = scratchDiagonal;\n  unitaryMatrix.identity();\n  diagonalMatrix.copy(matrix);\n  const epsilon = EIGEN_TOLERANCE * computeFrobeniusNorm(diagonalMatrix);\n\n  while (sweep < EIGEN_MAX_SWEEPS && offDiagonalFrobeniusNorm(diagonalMatrix) > epsilon) {\n    shurDecomposition(diagonalMatrix, jMatrix);\n    jMatrixTranspose.copy(jMatrix).transpose();\n    diagonalMatrix.multiplyRight(jMatrix);\n    diagonalMatrix.multiplyLeft(jMatrixTranspose);\n    unitaryMatrix.multiplyRight(jMatrix);\n\n    if (++count > 2) {\n      ++sweep;\n      count = 0;\n    }\n  }\n\n  result.unitary = unitaryMatrix.toTarget(result.unitary);\n  result.diagonal = diagonalMatrix.toTarget(result.diagonal);\n  return result;\n}\n\nfunction computeFrobeniusNorm(matrix) {\n  let norm = 0.0;\n\n  for (let i = 0; i < 9; ++i) {\n    const temp = matrix[i];\n    norm += temp * temp;\n  }\n\n  return Math.sqrt(norm);\n}\n\nconst rowVal = [1, 0, 0];\nconst colVal = [2, 2, 1];\n\nfunction offDiagonalFrobeniusNorm(matrix) {\n  let norm = 0.0;\n\n  for (let i = 0; i < 3; ++i) {\n    const temp = matrix[scratchMatrix.getElementIndex(colVal[i], rowVal[i])];\n    norm += 2.0 * temp * temp;\n  }\n\n  return Math.sqrt(norm);\n}\n\nfunction shurDecomposition(matrix, result) {\n  const tolerance = _MathUtils.EPSILON15;\n  let maxDiagonal = 0.0;\n  let rotAxis = 1;\n\n  for (let i = 0; i < 3; ++i) {\n    const temp = Math.abs(matrix[scratchMatrix.getElementIndex(colVal[i], rowVal[i])]);\n\n    if (temp > maxDiagonal) {\n      rotAxis = i;\n      maxDiagonal = temp;\n    }\n  }\n\n  const p = rowVal[rotAxis];\n  const q = colVal[rotAxis];\n  let c = 1.0;\n  let s = 0.0;\n\n  if (Math.abs(matrix[scratchMatrix.getElementIndex(q, p)]) > tolerance) {\n    const qq = matrix[scratchMatrix.getElementIndex(q, q)];\n    const pp = matrix[scratchMatrix.getElementIndex(p, p)];\n    const qp = matrix[scratchMatrix.getElementIndex(q, p)];\n    const tau = (qq - pp) / 2.0 / qp;\n    let t;\n\n    if (tau < 0.0) {\n      t = -1.0 / (-tau + Math.sqrt(1.0 + tau * tau));\n    } else {\n      t = 1.0 / (tau + Math.sqrt(1.0 + tau * tau));\n    }\n\n    c = 1.0 / Math.sqrt(1.0 + t * t);\n    s = t * c;\n  }\n\n  Matrix3.IDENTITY.to(result);\n  result[scratchMatrix.getElementIndex(p, p)] = result[scratchMatrix.getElementIndex(q, q)] = c;\n  result[scratchMatrix.getElementIndex(q, p)] = s;\n  result[scratchMatrix.getElementIndex(p, q)] = -s;\n  return result;\n}\n//# sourceMappingURL=compute-eigen-decomposition.js.map","import { Vector3, Matrix3 } from '@math.gl/core';\nimport computeEigenDecomposition from './compute-eigen-decomposition';\nimport OrientedBoundingBox from '../bounding-volumes/oriented-bounding-box';\nimport AxisAlignedBoundingBox from '../bounding-volumes/axis-aligned-bounding-box';\nconst scratchVector2 = new Vector3();\nconst scratchVector3 = new Vector3();\nconst scratchVector4 = new Vector3();\nconst scratchVector5 = new Vector3();\nconst scratchVector6 = new Vector3();\nconst scratchCovarianceResult = new Matrix3();\nconst scratchEigenResult = {\n  diagonal: new Matrix3(),\n  unitary: new Matrix3()\n};\nexport function makeOrientedBoundingBoxFromPoints(positions, result = new OrientedBoundingBox()) {\n  if (!positions || positions.length === 0) {\n    result.halfAxes = new Matrix3([0, 0, 0, 0, 0, 0, 0, 0, 0]);\n    result.center = new Vector3();\n    return result;\n  }\n\n  const length = positions.length;\n  const meanPoint = new Vector3(0, 0, 0);\n\n  for (const position of positions) {\n    meanPoint.add(position);\n  }\n\n  const invLength = 1.0 / length;\n  meanPoint.multiplyByScalar(invLength);\n  let exx = 0.0;\n  let exy = 0.0;\n  let exz = 0.0;\n  let eyy = 0.0;\n  let eyz = 0.0;\n  let ezz = 0.0;\n\n  for (const position of positions) {\n    const p = scratchVector2.copy(position).subtract(meanPoint);\n    exx += p.x * p.x;\n    exy += p.x * p.y;\n    exz += p.x * p.z;\n    eyy += p.y * p.y;\n    eyz += p.y * p.z;\n    ezz += p.z * p.z;\n  }\n\n  exx *= invLength;\n  exy *= invLength;\n  exz *= invLength;\n  eyy *= invLength;\n  eyz *= invLength;\n  ezz *= invLength;\n  const covarianceMatrix = scratchCovarianceResult;\n  covarianceMatrix[0] = exx;\n  covarianceMatrix[1] = exy;\n  covarianceMatrix[2] = exz;\n  covarianceMatrix[3] = exy;\n  covarianceMatrix[4] = eyy;\n  covarianceMatrix[5] = eyz;\n  covarianceMatrix[6] = exz;\n  covarianceMatrix[7] = eyz;\n  covarianceMatrix[8] = ezz;\n  const {\n    unitary\n  } = computeEigenDecomposition(covarianceMatrix, scratchEigenResult);\n  const rotation = result.halfAxes.copy(unitary);\n  let v1 = rotation.getColumn(0, scratchVector4);\n  let v2 = rotation.getColumn(1, scratchVector5);\n  let v3 = rotation.getColumn(2, scratchVector6);\n  let u1 = -Number.MAX_VALUE;\n  let u2 = -Number.MAX_VALUE;\n  let u3 = -Number.MAX_VALUE;\n  let l1 = Number.MAX_VALUE;\n  let l2 = Number.MAX_VALUE;\n  let l3 = Number.MAX_VALUE;\n\n  for (const position of positions) {\n    u1 = Math.max(position.dot(v1), u1);\n    u2 = Math.max(position.dot(v2), u2);\n    u3 = Math.max(position.dot(v3), u3);\n    l1 = Math.min(position.dot(v1), l1);\n    l2 = Math.min(position.dot(v2), l2);\n    l3 = Math.min(position.dot(v3), l3);\n  }\n\n  v1 = v1.multiplyByScalar(0.5 * (l1 + u1));\n  v2 = v2.multiplyByScalar(0.5 * (l2 + u2));\n  v3 = v3.multiplyByScalar(0.5 * (l3 + u3));\n  result.center.copy(v1).add(v2).add(v3);\n  const scale = scratchVector3.set(u1 - l1, u2 - l2, u3 - l3).multiplyByScalar(0.5);\n  const scaleMatrix = new Matrix3([scale[0], 0, 0, 0, scale[1], 0, 0, 0, scale[2]]);\n  result.halfAxes.multiplyRight(scaleMatrix);\n  return result;\n}\nexport function makeAxisAlignedBoundingBoxFromPoints(positions, result = new AxisAlignedBoundingBox()) {\n  if (!positions || positions.length === 0) {\n    result.minimum.set(0, 0, 0);\n    result.maximum.set(0, 0, 0);\n    result.center.set(0, 0, 0);\n    result.halfDiagonal.set(0, 0, 0);\n    return result;\n  }\n\n  let minimumX = positions[0][0];\n  let minimumY = positions[0][1];\n  let minimumZ = positions[0][2];\n  let maximumX = positions[0][0];\n  let maximumY = positions[0][1];\n  let maximumZ = positions[0][2];\n\n  for (const p of positions) {\n    const x = p[0];\n    const y = p[1];\n    const z = p[2];\n    minimumX = Math.min(x, minimumX);\n    maximumX = Math.max(x, maximumX);\n    minimumY = Math.min(y, minimumY);\n    maximumY = Math.max(y, maximumY);\n    minimumZ = Math.min(z, minimumZ);\n    maximumZ = Math.max(z, maximumZ);\n  }\n\n  result.minimum.set(minimumX, minimumY, minimumZ);\n  result.maximum.set(maximumX, maximumY, maximumZ);\n  result.center.copy(result.minimum).add(result.maximum).scale(0.5);\n  result.halfDiagonal.copy(result.maximum).subtract(result.center);\n  return result;\n}\n//# sourceMappingURL=bounding-box-from-points.js.map","import Vector from './base/vector';\nimport { config, isArray } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { vec2_transformMat4AsVector } from '../lib/gl-matrix-extras';\nexport default class Vector2 extends Vector {\n  constructor(x = 0, y = 0) {\n    super(2);\n\n    if (isArray(x) && arguments.length === 1) {\n      this.copy(x);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n      }\n\n      this[0] = x;\n      this[1] = y;\n    }\n  }\n\n  set(x, y) {\n    this[0] = x;\n    this[1] = y;\n    return this.check();\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    return this.check();\n  }\n\n  fromObject(object) {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n    }\n\n    this[0] = object.x;\n    this[1] = object.y;\n    return this.check();\n  }\n\n  toObject(object) {\n    object.x = this[0];\n    object.y = this[1];\n    return object;\n  }\n\n  get ELEMENTS() {\n    return 2;\n  }\n\n  horizontalAngle() {\n    return Math.atan2(this.y, this.x);\n  }\n\n  verticalAngle() {\n    return Math.atan2(this.x, this.y);\n  }\n\n  transform(matrix4) {\n    return this.transformAsPoint(matrix4);\n  }\n\n  transformAsPoint(matrix4) {\n    vec2.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformAsVector(matrix4) {\n    vec2_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3) {\n    vec2.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2x3(matrix2x3) {\n    vec2.transformMat2d(this, this, matrix2x3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2) {\n    vec2.transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n}\n//# sourceMappingURL=vector2.js.map","import Vector from './base/vector';\nimport { config, isArray } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport * as vec4 from 'gl-matrix/vec3';\nimport { vec4_transformMat2, vec4_transformMat3 } from '../lib/gl-matrix-extras';\nconst constants = {};\nexport default class Vector4 extends Vector {\n  static get ZERO() {\n    return constants.ZERO = constants.ZERO || Object.freeze(new Vector4(0, 0, 0, 0));\n  }\n\n  constructor(x = 0, y = 0, z = 0, w = 0) {\n    super(-0, -0, -0, -0);\n\n    if (isArray(x) && arguments.length === 1) {\n      this.copy(x);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n        checkNumber(w);\n      }\n\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n      this[3] = w;\n    }\n  }\n\n  set(x, y, z, w) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = w;\n    return this.check();\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    return this.check();\n  }\n\n  fromObject(object) {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n      checkNumber(object.w);\n    }\n\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    this[3] = object.w;\n    return this;\n  }\n\n  toObject(object) {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    object.w = this[3];\n    return object;\n  }\n\n  get ELEMENTS() {\n    return 4;\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  get w() {\n    return this[3];\n  }\n\n  set w(value) {\n    this[3] = checkNumber(value);\n  }\n\n  transform(matrix4) {\n    vec4.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3) {\n    vec4_transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2) {\n    vec4_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion) {\n    vec4.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n\n  applyMatrix4(m) {\n    m.transform(this, this);\n    return this;\n  }\n\n}\n//# sourceMappingURL=vector4.js.map","import Matrix from './base/matrix';\nimport { checkVector, deprecated } from '../lib/validators';\nimport { vec4_transformMat3 } from '../lib/gl-matrix-extras';\nimport * as mat3 from 'gl-matrix/mat3';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nconst IDENTITY = Object.freeze([1, 0, 0, 0, 1, 0, 0, 0, 1]);\nconst ZERO = Object.freeze([0, 0, 0, 0, 0, 0, 0, 0, 0]);\nconst INDICES = Object.freeze({\n  COL0ROW0: 0,\n  COL0ROW1: 1,\n  COL0ROW2: 2,\n  COL1ROW0: 3,\n  COL1ROW1: 4,\n  COL1ROW2: 5,\n  COL2ROW0: 6,\n  COL2ROW1: 7,\n  COL2ROW2: 8\n});\nconst constants = {};\nexport default class Matrix3 extends Matrix {\n  static get IDENTITY() {\n    constants.IDENTITY = constants.IDENTITY || Object.freeze(new Matrix3(IDENTITY));\n    return constants.IDENTITY;\n  }\n\n  static get ZERO() {\n    constants.ZERO = constants.ZERO || Object.freeze(new Matrix3(ZERO));\n    return constants.ZERO;\n  }\n\n  get ELEMENTS() {\n    return 9;\n  }\n\n  get RANK() {\n    return 3;\n  }\n\n  get INDICES() {\n    return INDICES;\n  }\n\n  constructor(array) {\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0);\n\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    return this.check();\n  }\n\n  set(m00, m10, m20, m01, m11, m21, m02, m12, m22) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  setRowMajor(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  determinant() {\n    return mat3.determinant(this);\n  }\n\n  identity() {\n    return this.copy(IDENTITY);\n  }\n\n  fromQuaternion(q) {\n    mat3.fromQuat(this, q);\n    return this.check();\n  }\n\n  transpose() {\n    mat3.transpose(this, this);\n    return this.check();\n  }\n\n  invert() {\n    mat3.invert(this, this);\n    return this.check();\n  }\n\n  multiplyLeft(a) {\n    mat3.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a) {\n    mat3.multiply(this, this, a);\n    return this.check();\n  }\n\n  rotate(radians) {\n    mat3.rotate(this, this, radians);\n    return this.check();\n  }\n\n  scale(factor) {\n    if (Array.isArray(factor)) {\n      mat3.scale(this, this, factor);\n    } else {\n      mat3.scale(this, this, [factor, factor, factor]);\n    }\n\n    return this.check();\n  }\n\n  translate(vec) {\n    mat3.translate(this, this, vec);\n    return this.check();\n  }\n\n  transform(vector, result) {\n    switch (vector.length) {\n      case 2:\n        result = vec2.transformMat3(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        result = vec3.transformMat3(result || [-0, -0, -0], vector, this);\n        break;\n\n      case 4:\n        result = vec4_transformMat3(result || [-0, -0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(result, vector.length);\n    return result;\n  }\n\n  transformVector(vector, result) {\n    deprecated('Matrix3.transformVector');\n    return this.transform(vector, result);\n  }\n\n  transformVector2(vector, result) {\n    deprecated('Matrix3.transformVector');\n    return this.transform(vector, result);\n  }\n\n  transformVector3(vector, result) {\n    deprecated('Matrix3.transformVector');\n    return this.transform(vector, result);\n  }\n\n}\n//# sourceMappingURL=matrix3.js.map","export default {\n  EPSILON1: 1e-1,\n  EPSILON2: 1e-2,\n  EPSILON3: 1e-3,\n  EPSILON4: 1e-4,\n  EPSILON5: 1e-5,\n  EPSILON6: 1e-6,\n  EPSILON7: 1e-7,\n  EPSILON8: 1e-8,\n  EPSILON9: 1e-9,\n  EPSILON10: 1e-10,\n  EPSILON11: 1e-11,\n  EPSILON12: 1e-12,\n  EPSILON13: 1e-13,\n  EPSILON14: 1e-14,\n  EPSILON15: 1e-15,\n  EPSILON16: 1e-16,\n  EPSILON17: 1e-17,\n  EPSILON18: 1e-18,\n  EPSILON19: 1e-19,\n  EPSILON20: 1e-20,\n  PI_OVER_TWO: Math.PI / 2,\n  PI_OVER_FOUR: Math.PI / 4,\n  PI_OVER_SIX: Math.PI / 6,\n  TWO_PI: Math.PI * 2\n};\n//# sourceMappingURL=math-utils.js.map","/**\n * Throws an `Error` with the optional `message` if `condition` is falsy\n * @note Replacement for the external assert method to reduce bundle size\n */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n","import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport WorkerThread from './worker-thread';\nimport {assert} from '../env-utils/assert';\n\n/**\n * Represents one Job handled by a WorkerPool or WorkerFarm\n */\nexport default class WorkerJob {\n  readonly name: string;\n  readonly workerThread: WorkerThread;\n  isRunning: boolean;\n  /** Promise that resolves when Job is done */\n  readonly result: Promise<any>;\n\n  private _resolve: (value: any) => void;\n  private _reject: (reason?: any) => void;\n\n  constructor(jobName: string, workerThread: WorkerThread) {\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.isRunning = true;\n    this._resolve = () => {};\n    this._reject = () => {};\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  /**\n   * Send a message to the job's worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   */\n  postMessage(type: WorkerMessageType, payload: WorkerMessagePayload): void {\n    this.workerThread.postMessage({\n      source: 'loaders.gl', // Lets worker ignore unrelated messages\n      type,\n      payload\n    });\n  }\n\n  /**\n   * Call to resolve the `result` Promise with the supplied value\n   */\n  done(value): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._resolve(value);\n  }\n\n  /**\n   * Call to reject the `result` Promise with the supplied error\n   */\n  error(error): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._reject(error);\n  }\n}\n","import WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\n\n/**\n * @param maxConcurrency {number} - max count of workers\n */\nexport type WorkerFarmProps = {\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  reuseWorkers?: boolean;\n  onDebug?: () => void;\n};\n\nconst DEFAULT_PROPS: WorkerFarmProps = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  onDebug: () => {},\n  reuseWorkers: true\n};\n\n/**\n * Process multiple jobs with a \"farm\" of different workers in worker pools.\n */\nexport default class WorkerFarm {\n  private props: WorkerFarmProps;\n  private workerPools = new Map<string, WorkerPool>();\n  // singleton\n  private static _workerFarm?: WorkerFarm;\n\n  /** Check if Workers are supported */\n  static isSupported(): boolean {\n    return WorkerThread.isSupported();\n  }\n\n  /** Get the singleton instance of the global worker farm */\n  static getWorkerFarm(props: WorkerFarmProps = {}): WorkerFarm {\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n    WorkerFarm._workerFarm.setProps(props);\n    return WorkerFarm._workerFarm;\n  }\n\n  /** get global instance with WorkerFarm.getWorkerFarm() */\n  private constructor(props: WorkerFarmProps) {\n    this.props = {...DEFAULT_PROPS};\n    this.setProps(props);\n    /** @type Map<string, WorkerPool>} */\n    this.workerPools = new Map();\n  }\n\n  /**\n   * Terminate all workers in the farm\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n  }\n\n  /**\n   * Set props used when initializing worker pools\n   * @param props\n   */\n  setProps(props: WorkerFarmProps): void {\n    this.props = {...this.props, ...props};\n    // Update worker pool props\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n\n  /**\n   * Returns a worker pool for the specified worker\n   * @param options - only used first time for a specific worker name\n   * @param options.name - the name of the worker - used to identify worker pool\n   * @param options.url -\n   * @param options.source -\n   * @example\n   *   const job = WorkerFarm.getWorkerFarm().getWorkerPool({name, url}).startJob(...);\n   */\n  getWorkerPool(options: {name: string; source?: string; url?: string}): WorkerPool {\n    const {name, source, url} = options;\n    let workerPool = this.workerPools.get(name);\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n    return workerPool;\n  }\n\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n}\n","import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport {isMobile} from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\n\n/** WorkerPool onDebug Callback Parameters */\ntype OnDebugParameters = {\n  message: string;\n  worker: string;\n  name: string;\n  job: string;\n  backlog: number;\n  workerThread: WorkerThread;\n};\n\n/** WorkerPool Properties */\nexport type WorkerPoolProps = {\n  name?: string;\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  onDebug?: (options: OnDebugParameters) => any;\n  reuseWorkers?: boolean;\n};\n\n/** Private helper types */\ntype OnMessage = (job: WorkerJob, type: WorkerMessageType, payload: WorkerMessagePayload) => void;\ntype OnError = (job: WorkerJob, error: Error) => void;\n\ntype QueuedJob = {\n  name: string;\n  onMessage: OnMessage;\n  onError: OnError;\n  onStart: (value: any) => void; // Resolve job start promise\n};\n\n/**\n * Process multiple data messages with small pool of identical workers\n */\nexport default class WorkerPool {\n  name: string = 'unnamed';\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency: number = 1;\n  maxMobileConcurrency: number = 1;\n  onDebug: (options: OnDebugParameters) => any = () => {};\n  reuseWorkers: boolean = true;\n\n  private props: WorkerPoolProps = {};\n  private jobQueue: QueuedJob[] = [];\n  private idleQueue: WorkerThread[] = [];\n  private count = 0;\n  private isDestroyed = false;\n\n  /**\n   * @param processor - worker function\n   * @param maxConcurrency - max count of workers\n   */\n  constructor(props: WorkerPoolProps) {\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n\n  /**\n   * Terminates all workers in the pool\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    // Destroy idle workers, active Workers will be destroyed on completion\n    this.idleQueue.forEach((worker) => worker.destroy());\n    this.isDestroyed = true;\n  }\n\n  setProps(props: WorkerPoolProps) {\n    this.props = {...this.props, ...props};\n\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n\n  async startJob(\n    name: string,\n    onMessage: OnMessage = (job, type, data) => job.done(data),\n    onError: OnError = (job, error) => job.error(error)\n  ): Promise<WorkerJob> {\n    // Promise resolves when thread starts working on this job\n    const startPromise = new Promise<WorkerJob>((onStart) => {\n      // Promise resolves when thread completes or fails working on this job\n      this.jobQueue.push({name, onMessage, onError, onStart});\n      return this;\n    });\n    this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    return await startPromise;\n  }\n\n  // PRIVATE\n\n  /**\n   * Starts first queued job if worker is available or can be created\n   * Called when job is started and whenever a worker returns to the idleQueue\n   */\n  async _startQueuedJob(): Promise<void> {\n    if (!this.jobQueue.length) {\n      return;\n    }\n\n    const workerThread = this._getAvailableWorker();\n    if (!workerThread) {\n      return;\n    }\n\n    // We have a worker, dequeue and start the job\n    const queuedJob = this.jobQueue.shift();\n    if (queuedJob) {\n      // Emit a debug event\n      // @ts-ignore\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n\n      // Create a worker job to let the app access thread and manage job completion\n      const job = new WorkerJob(queuedJob.name, workerThread);\n\n      // Set the worker thread's message handlers\n      workerThread.onMessage = (data) => queuedJob.onMessage(job, data.type, data.payload);\n      workerThread.onError = (error) => queuedJob.onError(job, error);\n\n      // Resolve the start promise so that the app can start sending messages to worker\n      queuedJob.onStart(job);\n\n      // Wait for the app to signal that the job is complete, then return worker to queue\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n\n  /**\n   * Returns a worker to the idle queue\n   * Destroys the worker if\n   *  - pool is destroyed\n   *  - if this pool doesn't reuse workers\n   *  - if maxConcurrency has been lowered\n   * @param worker\n   */\n  returnWorkerToQueue(worker: WorkerThread) {\n    const shouldDestroyWorker =\n      this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n\n    if (!this.isDestroyed) {\n      this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    }\n  }\n\n  /**\n   * Returns idle worker or creates new worker if maxConcurrency has not been reached\n   */\n  _getAvailableWorker(): WorkerThread | null {\n    // If a worker has completed and returned to the queue, it can be used\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n\n    // Create fresh worker if we haven't yet created the max amount of worker threads for this worker source\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = `${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;\n      return new WorkerThread({name, source: this.source, url: this.url});\n    }\n\n    // No worker available, have to wait\n    return null;\n  }\n\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n}\n","import type {WorkerMessageData, WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport {getTransferList} from '../worker-utils/get-transfer-list';\n\nconst onMessageWrapperMap = new Map();\n\n/**\n * Type safe wrapper for worker code\n */\nexport default class WorkerBody {\n  /*\n   * (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n   */\n  static set onmessage(onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any) {\n    // eslint-disable-next-line no-restricted-globals\n    self.onmessage = (message) => {\n      if (!isKnownMessage(message)) {\n        return;\n      }\n\n      // Confusingly the message itself also has a 'type' field which is always set to 'message'\n      const {type, payload} = message.data;\n      onMessage(type, payload);\n    };\n  }\n\n  static addEventListener(\n    onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n  ) {\n    let onMessageWrapper = onMessageWrapperMap.get(onMessage);\n\n    if (!onMessageWrapper) {\n      onMessageWrapper = (message) => {\n        if (!isKnownMessage(message)) {\n          return;\n        }\n\n        // Confusingly the message itself also has a 'type' field which is always set to 'message'\n        const {type, payload} = message.data;\n        onMessage(type, payload);\n      };\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    self.addEventListener('message', onMessageWrapper);\n  }\n\n  static removeEventListener(\n    onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n  ) {\n    const onMessageWrapper = onMessageWrapperMap.get(onMessage);\n    onMessageWrapperMap.delete(onMessage);\n    // eslint-disable-next-line no-restricted-globals\n    self.removeEventListener('message', onMessageWrapper);\n  }\n\n  /**\n   * Send a message from a worker to creating thread (main thread)\n   * @param type\n   * @param payload\n   */\n  static postMessage(type: WorkerMessageType, payload: WorkerMessagePayload): void {\n    if (self) {\n      const data: WorkerMessageData = {source: 'loaders.gl', type, payload};\n      const transferList = getTransferList(payload);\n      // eslint-disable-next-line no-restricted-globals\n      // @ts-ignore\n      self.postMessage(data, transferList);\n    }\n  }\n}\n\n// Filter out noise messages sent to workers\nfunction isKnownMessage(message) {\n  const {type, data} = message;\n  return (\n    type === 'message' &&\n    data &&\n    typeof data.source === 'string' &&\n    data.source.startsWith('loaders.gl')\n  );\n}\n","import type {WorkerObject, WorkerOptions} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION as __VERSION__} from '../env-utils/version';\n\nconst NPM_TAG = 'latest';\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : NPM_TAG;\n\n/**\n * Gets worker object's name (for debugging in Chrome thread inspector window)\n */\nexport function getWorkerName(worker: WorkerObject): string {\n  const warning = worker.version !== VERSION ? ` (worker-utils@${VERSION})` : '';\n  return `${worker.name}@${worker.version}${warning}`;\n}\n\n/**\n * Generate a worker URL based on worker object and options\n * @returns A URL to one of the following:\n * - a published worker on unpkg CDN\n * - a local test worker\n * - a URL provided by the user in options\n */\nexport function getWorkerURL(worker: WorkerObject, options: WorkerOptions = {}): string {\n  const workerOptions = options[worker.id] || {};\n\n  const workerFile = `${worker.id}-worker.js`;\n\n  let url = workerOptions.workerUrl;\n\n  // If URL is test, generate local loaders.gl url\n  // @ts-ignore _workerType\n  if (options._workerType === 'test') {\n    url = `modules/${worker.module}/dist/${workerFile}`;\n  }\n\n  // If url override is not provided, generate a URL to published version on npm CDN unpkg.com\n  if (!url) {\n    // GENERATE\n    let version = worker.version;\n    // On master we need to load npm alpha releases published with the `beta` tag\n    if (version === 'latest') {\n      // throw new Error('latest worker version specified');\n      version = NPM_TAG;\n    }\n    const versionTag = version ? `@${version}` : '';\n    url = `https://unpkg.com/@loaders.gl/${worker.module}${versionTag}/dist/${workerFile}`;\n  }\n\n  assert(url);\n\n  // Allow user to override location\n  return url;\n}\n","// From https://github.com/rauschma/async-iter-demo/tree/master/src under MIT license\n// http://2ality.com/2016/10/asynchronous-iteration.html\n\n/**\n * Async Queue\n * - AsyncIterable: An async iterator can be\n * - Values can be pushed onto the queue\n * @example\n *   const asyncQueue = new AsyncQueue();\n *   setTimeout(() => asyncQueue.enqueue('tick'), 1000);\n *   setTimeout(() => asyncQueue.enqueue(new Error('done')), 10000);\n *   for await (const value of asyncQueue) {\n *     console.log(value); // tick\n *   }\n */\nexport default class AsyncQueue<T> {\n  private _values: any[];\n  private _settlers: any[];\n  private _closed: boolean;\n\n  constructor() {\n    this._values = []; // enqueues > dequeues\n    this._settlers = []; // dequeues > enqueues\n    this._closed = false;\n  }\n\n  /** Return an async iterator for this queue */\n  [Symbol.asyncIterator](): AsyncIterator<T> {\n    return this;\n  }\n\n  /** Push a new value - the async iterator will yield a promise resolved to this value */\n  push(value: T): void {\n    return this.enqueue(value);\n  }\n\n  /**\n   * Push a new value - the async iterator will yield a promise resolved to this value\n   * Add an error - the async iterator will yield a promise rejected with this value\n   */\n  enqueue(value: T | Error): void {\n    if (this._closed) {\n      throw new Error('Closed');\n    }\n\n    if (this._settlers.length > 0) {\n      if (this._values.length > 0) {\n        throw new Error('Illegal internal state');\n      }\n      const settler = this._settlers.shift();\n      if (value instanceof Error) {\n        settler.reject(value);\n      } else {\n        settler.resolve({value});\n      }\n    } else {\n      this._values.push(value);\n    }\n  }\n\n  /** Indicate that we not waiting for more values - The async iterator will be done */\n  close(): void {\n    while (this._settlers.length > 0) {\n      const settler = this._settlers.shift();\n      settler.resolve({done: true});\n    }\n    this._closed = true;\n  }\n\n  // ITERATOR IMPLEMENTATION\n\n  /** @returns a Promise for an IteratorResult */\n  next(): Promise<IteratorResult<T, any>> {\n    // If values in queue, yield the first value\n    if (this._values.length > 0) {\n      const value = this._values.shift();\n      if (value instanceof Error) {\n        return Promise.reject(value);\n      }\n      return Promise.resolve({done: false, value});\n    }\n\n    // If queue is closed, the iterator is done\n    if (this._closed) {\n      if (this._settlers.length > 0) {\n        throw new Error('Illegal internal state');\n      }\n      return Promise.resolve({done: true, value: undefined});\n    }\n\n    // Yield a promise that waits for new values to be enqueued\n    return new Promise((resolve, reject) => {\n      this._settlers.push({resolve, reject});\n    });\n  }\n}\n","export function getFirstCharacters(data, length = 5): string {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    // Typed Arrays can have offsets into underlying buffer\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\n\nexport function getMagicString(\n  arrayBuffer: ArrayBuffer,\n  byteOffset: number,\n  length: number\n): string {\n  if (arrayBuffer.byteLength <= byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n","import {TypedArray} from '../../types';\nimport * as node from '../node/buffer-utils.node';\n\n/**\n * Convert an object to an array buffer\n */\nexport function toArrayBuffer(data: any): ArrayBuffer {\n  // Note: Should be called first, Buffers can trigger other detections below\n  if (node.toArrayBuffer) {\n    // TODO - per docs we should just be able to call buffer.buffer, but there are issues\n    data = node.toArrayBuffer(data);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n\n  // Careful - Node Buffers will look like ArrayBuffers (keep after isBuffer)\n  if (ArrayBuffer.isView(data)) {\n    return data.buffer;\n  }\n\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n\n  // HACK to support Blob polyfill\n  if (data && typeof data === 'object' && data._toArrayBuffer) {\n    return data._toArrayBuffer();\n  }\n\n  throw new Error('toArrayBuffer');\n}\n\n/**\n * compare two binary arrays for equality\n * @param {ArrayBuffer} a\n * @param {ArrayBuffer} b\n * @param {number} byteLength\n */\nexport function compareArrayBuffers(\n  arrayBuffer1: ArrayBuffer,\n  arrayBuffer2: ArrayBuffer,\n  byteLength?: number\n): boolean {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Concatenate a sequence of ArrayBuffers\n * @return A concatenated ArrayBuffer\n */\nexport function concatenateArrayBuffers(...sources: (ArrayBuffer | Uint8Array)[]): ArrayBuffer {\n  // Make sure all inputs are wrapped in typed arrays\n  const sourceArrays = sources.map((source2) =>\n    source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2\n  );\n\n  // Get length of all inputs\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n\n  // Allocate array with space for all inputs\n  const result = new Uint8Array(byteLength);\n\n  // Copy the subarrays\n  let offset = 0;\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n\n  // We work with ArrayBuffers, discard the typed array wrapper\n  return result.buffer;\n}\n\n/**\n * Concatenate arbitrary count of typed arrays\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays\n * @param {...*} arrays - list of arrays. All arrays should be the same type\n * @return A concatenated TypedArray\n */\nexport function concatenateTypedArrays<T>(...typedArrays: T[]): T {\n  // @ts-ignore\n  const arrays = typedArrays as TypedArray[];\n  // @ts-ignore\n  const TypedArrayConstructor = (arrays && arrays.length > 1 && arrays[0].constructor) || null;\n  if (!TypedArrayConstructor) {\n    throw new Error(\n      '\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types'\n    );\n  }\n\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  // @ts-ignore typescript does not like dynamic constructors\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n  return result;\n}\n\n/**\n * Copy a view of an ArrayBuffer into new ArrayBuffer with byteOffset = 0\n * @param arrayBuffer\n * @param byteOffset\n * @param byteLength\n */\nexport function sliceArrayBuffer(\n  arrayBuffer: ArrayBuffer,\n  byteOffset: number,\n  byteLength?: number\n): ArrayBuffer {\n  const subArray =\n    byteLength !== undefined\n      ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength)\n      : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n","import {assert} from '../env-utils/assert';\n\n/**\n * Calculate new size of an arrayBuffer to be aligned to an n-byte boundary\n * This function increases `byteLength` by the minimum delta,\n * allowing the total length to be divided by `padding`\n * @param byteLength\n * @param padding\n */\nexport function padToNBytes(byteLength: number, padding: number): number {\n  assert(byteLength >= 0); // `Incorrect 'byteLength' value: ${byteLength}`\n  assert(padding > 0); // `Incorrect 'padding' value: ${padding}`\n  return (byteLength + (padding - 1)) & ~(padding - 1);\n}\n\n/**\n * Creates a new Uint8Array based on two different ArrayBuffers\n * @param targetBuffer The first buffer.\n * @param sourceBuffer The second buffer.\n * @return The new ArrayBuffer created out of the two.\n */\nexport function copyArrayBuffer(\n  targetBuffer: ArrayBuffer,\n  sourceBuffer: ArrayBuffer,\n  byteOffset: number,\n  byteLength: number = sourceBuffer.byteLength\n): ArrayBuffer {\n  const targetArray = new Uint8Array(targetBuffer, byteOffset, byteLength);\n  const sourceArray = new Uint8Array(sourceBuffer);\n  targetArray.set(sourceArray);\n  return targetBuffer;\n}\n\n/**\n * Copy from source to target at the targetOffset\n *\n * @param source - The data to copy\n * @param target - The destination to copy data into\n * @param targetOffset - The start offset into target to place the copied data\n * @returns the new offset taking into account proper padding\n */\nexport function copyToArray(source: ArrayBuffer | any, target: any, targetOffset: number): number {\n  let sourceArray;\n\n  if (source instanceof ArrayBuffer) {\n    sourceArray = new Uint8Array(source);\n  } else {\n    // Pack buffer onto the big target array\n    //\n    // 'source.data.buffer' could be a view onto a larger buffer.\n    // We MUST use this constructor to ensure the byteOffset and byteLength is\n    // set to correct values from 'source.data' and not the underlying\n    // buffer for target.set() to work properly.\n    const srcByteOffset = source.byteOffset;\n    const srcByteLength = source.byteLength;\n    // In gltf parser it is set as \"arrayBuffer\" instead of \"buffer\"\n    // https://github.com/visgl/loaders.gl/blob/1e3a82a0a65d7b6a67b1e60633453e5edda2960a/modules/gltf/src/lib/parse-gltf.js#L85\n    sourceArray = new Uint8Array(source.buffer || source.arrayBuffer, srcByteOffset, srcByteLength);\n  }\n\n  // Pack buffer onto the big target array\n  target.set(sourceArray, targetOffset);\n\n  return targetOffset + padToNBytes(sourceArray.byteLength, 4);\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\nimport DoublyLinkedList from '../utils/doubly-linked-list';\n\nfunction defined(x) {\n  return x !== undefined && x !== null;\n}\n\n/**\n * Stores tiles with content loaded.\n *\n * @private\n */\nexport default class TilesetCache {\n  private _list: DoublyLinkedList;\n  private _sentinel: any;\n  private _trimTiles: boolean;\n\n  constructor() {\n    // [head, sentinel) -> tiles that weren't selected this frame and may be removed from the cache\n    // (sentinel, tail] -> tiles that were selected this frame\n    this._list = new DoublyLinkedList();\n    this._sentinel = this._list.add('sentinel');\n    this._trimTiles = false;\n  }\n\n  reset() {\n    // Move sentinel node to the tail so, at the start of the frame, all tiles\n    // may be potentially replaced.  Tiles are moved to the right of the sentinel\n    // when they are selected so they will not be replaced.\n    this._list.splice(this._list.tail, this._sentinel);\n  }\n\n  touch(tile) {\n    const node = tile._cacheNode;\n    if (defined(node)) {\n      this._list.splice(this._sentinel, node);\n    }\n  }\n\n  add(tileset, tile, addCallback) {\n    if (!defined(tile._cacheNode)) {\n      tile._cacheNode = this._list.add(tile);\n\n      if (addCallback) {\n        addCallback(tileset, tile);\n      }\n    }\n  }\n\n  unloadTile(tileset, tile, unloadCallback?) {\n    const node = tile._cacheNode;\n    if (!defined(node)) {\n      return;\n    }\n\n    this._list.remove(node);\n    tile._cacheNode = undefined;\n    if (unloadCallback) {\n      unloadCallback(tileset, tile);\n    }\n  }\n\n  unloadTiles(tileset, unloadCallback) {\n    const trimTiles = this._trimTiles;\n    this._trimTiles = false;\n\n    const list = this._list;\n\n    const maximumMemoryUsageInBytes = tileset.maximumMemoryUsage * 1024 * 1024;\n\n    // Traverse the list only to the sentinel since tiles/nodes to the\n    // right of the sentinel were used this frame.\n    // The sub-list to the left of the sentinel is ordered from LRU to MRU.\n    const sentinel = this._sentinel;\n    let node = list.head;\n\n    while (\n      node !== sentinel &&\n      (tileset.gpuMemoryUsageInBytes > maximumMemoryUsageInBytes || trimTiles)\n    ) {\n      const tile = node.item;\n      node = node.next;\n      this.unloadTile(tileset, tile, unloadCallback);\n    }\n  }\n\n  trim() {\n    this._trimTiles = true;\n  }\n}\n","import {Ellipsoid} from '@math.gl/geospatial';\nimport {Matrix4, Vector3} from '@math.gl/core';\nimport {assert} from '@loaders.gl/loader-utils';\n\nexport function calculateTransformProps(tileHeader, tile) {\n  assert(tileHeader);\n  assert(tile);\n\n  const {rtcCenter, gltfUpAxis} = tile;\n  const {\n    computedTransform,\n    boundingVolume: {center}\n  } = tileHeader;\n\n  let modelMatrix = new Matrix4(computedTransform);\n\n  // Translate if appropriate\n  if (rtcCenter) {\n    modelMatrix.translate(rtcCenter);\n  }\n\n  // glTF models need to be rotated from Y to Z up\n  // https://github.com/AnalyticalGraphicsInc/3d-tiles/tree/master/specification#y-up-to-z-up\n  switch (gltfUpAxis) {\n    case 'Z':\n      break;\n    case 'Y':\n      const rotationY = new Matrix4().rotateX(Math.PI / 2);\n      modelMatrix = modelMatrix.multiplyRight(rotationY);\n      break;\n    case 'X':\n      const rotationX = new Matrix4().rotateY(-Math.PI / 2);\n      modelMatrix = modelMatrix.multiplyRight(rotationX);\n      break;\n    default:\n      break;\n  }\n\n  // Scale/offset positions if normalized integers\n  if (tile.isQuantized) {\n    modelMatrix.translate(tile.quantizedVolumeOffset).scale(tile.quantizedVolumeScale);\n  }\n\n  // Option 1: Cartesian matrix and origin\n  const cartesianOrigin = new Vector3(center);\n\n  tile.cartesianModelMatrix = modelMatrix;\n  tile.cartesianOrigin = cartesianOrigin;\n\n  // Option 2: Cartographic matrix and origin\n  const cartographicOrigin = Ellipsoid.WGS84.cartesianToCartographic(\n    cartesianOrigin,\n    new Vector3()\n  );\n  const fromFixedFrameMatrix = Ellipsoid.WGS84.eastNorthUpToFixedFrame(cartesianOrigin);\n  const toFixedFrameMatrix = fromFixedFrameMatrix.invert();\n\n  tile.cartographicModelMatrix = toFixedFrameMatrix.multiplyRight(modelMatrix);\n  tile.cartographicOrigin = cartographicOrigin;\n\n  // Deprecated, drop\n  tile.modelMatrix = tile.cartographicModelMatrix;\n}\n","import {Vector3} from '@math.gl/core';\nimport {CullingVolume, Plane} from '@math.gl/culling';\nimport {Ellipsoid} from '@math.gl/geospatial';\n\nexport type FrameState = {\n  camera: {\n    position: number[];\n    direction: number[];\n    up: number[];\n  };\n  viewport: {[key: string]: any};\n  height: number;\n  cullingVolume: CullingVolume;\n  frameNumber: number; // TODO: This can be the same between updates, what number is unique for between updates?\n  sseDenominator: number; // Assumes fovy = 60 degrees\n};\n\nconst scratchVector = new Vector3();\nconst scratchPosition = new Vector3();\nconst cullingVolume = new CullingVolume([\n  new Plane(),\n  new Plane(),\n  new Plane(),\n  new Plane(),\n  new Plane(),\n  new Plane()\n]);\n\n// Extracts a frame state appropriate for tile culling from a deck.gl viewport\n// TODO - this could likely be generalized and merged back into deck.gl for other culling scenarios\nexport function getFrameState(viewport, frameNumber: number): FrameState {\n  // Traverse and and request. Update _selectedTiles so that we know what to render.\n  const {cameraDirection, cameraUp, height} = viewport;\n  const {metersPerUnit} = viewport.distanceScales;\n\n  const viewportCenterCartographic = [viewport.longitude, viewport.latitude, 0];\n  // TODO - Ellipsoid.eastNorthUpToFixedFrame() breaks on raw array, create a Vector.\n  // TODO - Ellipsoid.eastNorthUpToFixedFrame() takes a cartesian, is that intuitive?\n  const viewportCenterCartesian = Ellipsoid.WGS84.cartographicToCartesian(\n    viewportCenterCartographic,\n    new Vector3()\n  );\n  const enuToFixedTransform = Ellipsoid.WGS84.eastNorthUpToFixedFrame(viewportCenterCartesian);\n\n  const cameraPositionCartographic = viewport.unprojectPosition(viewport.cameraPosition);\n  const cameraPositionCartesian = Ellipsoid.WGS84.cartographicToCartesian(\n    cameraPositionCartographic,\n    new Vector3()\n  );\n\n  // These should still be normalized as the transform has scale 1 (goes from meters to meters)\n  const cameraDirectionCartesian = new Vector3(\n    // @ts-ignore\n    enuToFixedTransform.transformAsVector(new Vector3(cameraDirection).scale(metersPerUnit))\n  ).normalize();\n  const cameraUpCartesian = new Vector3(\n    // @ts-ignore\n    enuToFixedTransform.transformAsVector(new Vector3(cameraUp).scale(metersPerUnit))\n  ).normalize();\n\n  commonSpacePlanesToWGS84(viewport, viewportCenterCartesian);\n\n  // TODO: make a file/class for frameState and document what needs to be attached to this so that traversal can function\n  return {\n    camera: {\n      position: cameraPositionCartesian,\n      direction: cameraDirectionCartesian,\n      up: cameraUpCartesian\n    },\n    viewport,\n    height,\n    cullingVolume,\n    frameNumber, // TODO: This can be the same between updates, what number is unique for between updates?\n    sseDenominator: 1.15 // Assumes fovy = 60 degrees\n  };\n}\n\nfunction commonSpacePlanesToWGS84(viewport, viewportCenterCartesian) {\n  // Extract frustum planes based on current view.\n  const frustumPlanes = viewport.getFrustumPlanes();\n  let i = 0;\n  for (const dir in frustumPlanes) {\n    const plane = frustumPlanes[dir];\n    const distanceToCenter = plane.normal.dot(viewport.center);\n    scratchPosition\n      .copy(plane.normal)\n      .scale(plane.distance - distanceToCenter)\n      .add(viewport.center);\n    const cartographicPos = viewport.unprojectPosition(scratchPosition);\n\n    const cartesianPos = Ellipsoid.WGS84.cartographicToCartesian(cartographicPos, new Vector3());\n\n    cullingVolume.planes[i++].fromPointNormal(\n      cartesianPos,\n      // Want the normal to point into the frustum since that's what culling expects\n      scratchVector.copy(viewportCenterCartesian).subtract(cartesianPos)\n    );\n  }\n}\n","// FILE READING AND WRITING\nexport {fetchFile} from './lib/fetch/fetch-file';\n\nexport {readArrayBuffer} from './lib/fetch/read-array-buffer';\nexport {readFileSync} from './lib/fetch/read-file';\nexport {writeFile, writeFileSync} from './lib/fetch/write-file';\n\n// CONFIGURATION\nexport {setLoaderOptions} from './lib/api/set-loader-options';\nexport {registerLoaders} from './lib/api/register-loaders';\nexport {selectLoader, selectLoaderSync} from './lib/api/select-loader';\n\n// LOADING (READING + PARSING)\nexport {parse} from './lib/api/parse';\nexport {parseSync} from './lib/api/parse-sync';\nexport {parseInBatches} from './lib/api/parse-in-batches';\n\nexport {load} from './lib/api/load';\nexport {loadInBatches} from './lib/api/load-in-batches';\n\n// ENCODING (ENCODING AND WRITING)\nexport {encode, encodeSync, encodeInBatches, encodeText, encodeURLtoURL} from './lib/api/encode';\nexport {save, saveSync} from './lib/api/save';\n\n// CORE UTILS SHARED WITH LOADERS (RE-EXPORTED FROM LOADER-UTILS)\nexport {setPathPrefix, getPathPrefix, resolvePath} from '@loaders.gl/loader-utils';\nexport {RequestScheduler} from '@loaders.gl/loader-utils';\n\n// ITERATOR UTILS\nexport {makeIterator} from './iterators/make-iterator/make-iterator';\nexport {makeStream} from './iterators/make-stream/make-stream';\nexport {makeDOMStream} from './iterators/make-stream/make-dom-stream';\nexport {makeNodeStream} from './iterators/make-stream/make-node-stream';\n\n// CORE LOADERS\nexport {NullWorkerLoader, NullLoader} from './null-loader';\nexport {JSONLoader} from '@loaders.gl/loader-utils';\n\n// EXPERIMENTAL\nexport {default as _fetchProgress} from './lib/progress/fetch-progress';\nexport {default as _BrowserFileSystem} from './lib/filesystems/browser-filesystem';\n\n// FOR TESTING\nexport {_unregisterLoaders} from './lib/api/register-loaders';\n\n//\n// TODO - MOVE TO LOADER-UTILS AND DEPRECATE IN CORE?\n//\n\nexport {isBrowser, isWorker, self, window, global, document} from '@loaders.gl/loader-utils';\nexport {assert} from '@loaders.gl/loader-utils';\nexport {forEach, concatenateArrayBuffersAsync} from '@loaders.gl/loader-utils';\n\nexport {\n  makeTextDecoderIterator,\n  makeTextEncoderIterator,\n  makeLineIterator,\n  makeNumberedLineIterator\n} from '@loaders.gl/loader-utils';\n\n// \"JAVASCRIPT\" UTILS - move to loader-utils?\nexport {\n  isPureObject,\n  isPromise,\n  isIterable,\n  isAsyncIterable,\n  isIterator,\n  isResponse,\n  isReadableStream,\n  isWritableStream\n} from './javascript-utils/is-type';\n","import {isResponse} from '../../javascript-utils/is-type';\nimport {getResourceContentLength, getResourceUrlAndType} from './resource-utils';\n\n/**\n * Returns a Response object\n * Adds content-length header when possible\n *\n * @param resource\n */\nexport async function makeResponse(resource: any): Promise<Response> {\n  if (isResponse(resource)) {\n    return resource;\n  }\n\n  // Add content-length header if possible\n  const headers: {[header: string]: string} = {};\n\n  const contentLength = getResourceContentLength(resource);\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n\n  // `new Response(File)` does not preserve content-type and URL\n  // so we add them here\n  const {url, type} = getResourceUrlAndType(resource);\n  if (type) {\n    headers['content-type'] = type;\n  }\n\n  // Add a custom header with initial bytes if available\n  const initialDataUrl = await getInitialDataUrl(resource);\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n\n  // TODO - is this the best way of handling strings?\n  // Maybe package as data URL instead?\n  if (typeof resource === 'string') {\n    // Convert to ArrayBuffer to avoid Response treating it as a URL\n    resource = new TextEncoder().encode(resource);\n  }\n\n  // Attempt to create a Response from the resource, adding headers and setting url\n  const response = new Response(resource, {headers});\n  // We can't control `Response.url` via constructor, use a property override to record URL.\n  Object.defineProperty(response, 'url', {value: url});\n  return response;\n}\n\n/**\n * Checks response status (async) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport async function checkResponse(response: Response): Promise<void> {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\n\n/**\n * Checks response status (sync) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport function checkResponseSync(response: Response): void {\n  if (!response.ok) {\n    let message = `${response.status} ${response.statusText}`;\n    message = message.length > 60 ? `${message.slice(60)}...` : message;\n    throw new Error(message);\n  }\n}\n\n// HELPERS\n\nasync function getResponseError(response): Promise<string> {\n  let message = `Failed to fetch resource ${response.url} (${response.status}): `;\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n    if (contentType.includes('application/json')) {\n      text += ` ${await response.text()}`;\n    }\n    message += text;\n    message = message.length > 60 ? `${message.slice(60)}...` : message;\n  } catch (error) {\n    // eslint forbids return in a finally statement, so we just catch here\n  }\n  return message;\n}\n\nasync function getInitialDataUrl(resource): Promise<string | null> {\n  const INITIAL_DATA_LENGTH = 5;\n  if (typeof resource === 'string') {\n    return `data:,${resource.slice(0, INITIAL_DATA_LENGTH)}`;\n  }\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onload = (event) => resolve(event?.target?.result as string);\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return `data:base64,${base64}`;\n  }\n  return null;\n}\n\n// https://stackoverflow.com/questions/9267899/arraybuffer-to-base64-encoded-string\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n","// probe.gl Log compatible loggers\nimport {Log} from 'probe.gl';\n\nexport const probeLog = new Log({id: 'loaders.gl'});\n\n// Logs nothing\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n  info() {\n    return () => {};\n  }\n  warn() {\n    return () => {};\n  }\n  error() {\n    return () => {};\n  }\n}\n\n// Logs to console\nexport class ConsoleLog {\n  console;\n\n  constructor() {\n    this.console = console; // eslint-disable-line\n  }\n  log(...args) {\n    return this.console.log.bind(this.console, ...args);\n  }\n  info(...args) {\n    return this.console.info.bind(this.console, ...args);\n  }\n  warn(...args) {\n    return this.console.warn.bind(this.console, ...args);\n  }\n  error(...args) {\n    return this.console.error.bind(this.console, ...args);\n  }\n}\n","import {Loader} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {getGlobalLoaderState} from '../loader-utils/option-utils';\n\n// Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\n// This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\nexport function registerLoaders(loaders: Loader[]) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\n      // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\n\nexport function getRegisteredLoaders(): Loader[] {\n  return getGlobalLoaderRegistry();\n}\n\n// For testing\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n","import type {ReadStream} from 'fs';\n\nimport {makeStringIterator} from './make-string-iterator';\nimport {makeArrayBufferIterator} from './make-array-buffer-iterator';\nimport {makeBlobIterator} from './make-blob-iterator';\nimport type {StreamIteratorOptions} from './make-stream-iterator';\nimport {makeStreamIterator} from './make-stream-iterator';\nimport {isBlob, isReadableStream, isResponse} from '../../javascript-utils/is-type';\n\n/**\n * @param [options.chunkSize]\n */\nexport type IteratorOptions = StreamIteratorOptions & {\n  chunkSize?: number;\n};\n\n/**\n * Returns an iterator that breaks its input into chunks and yields them one-by-one.\n * @param data\n * @param options\n * @returns\n * This function can e.g. be used to enable data sources that can only be read atomically\n * (such as `Blob` and `File` via `FileReader`) to still be parsed in batches.\n */\nexport function makeIterator(\n  data: ArrayBuffer | string | Blob | Response | ReadableStream | ReadStream,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer> {\n  if (typeof data === 'string') {\n    // Note: Converts string chunks to binary\n    return makeStringIterator(data, options);\n  }\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n  if (isBlob(data)) {\n    return makeBlobIterator(data as Blob, options);\n  }\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data as ReadableStream, options);\n  }\n  if (isResponse(data)) {\n    const response = data as Response;\n    return makeStreamIterator(response.body as ReadableStream, options);\n  }\n  throw new Error('makeIterator');\n}\n","import type {Batch} from '@loaders.gl/schema';\nimport type {\n  BatchableDataType,\n  Loader,\n  LoaderWithParser,\n  LoaderContext,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport {assert, concatenateArrayBuffersAsync} from '@loaders.gl/loader-utils';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {normalizeOptions} from '../loader-utils/option-utils';\nimport {getLoaderContext} from '../loader-utils/loader-context';\nimport {getAsyncIterableFromData} from '../loader-utils/get-data';\nimport {getResourceUrlAndType} from '../utils/resource-utils';\nimport {selectLoader} from './select-loader';\n\n// Ensure `parse` is available in context if loader falls back to `parse`\nimport {parse} from './parse';\n\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport async function parseInBatches(\n  data: BatchableDataType,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<AsyncIterable<any>> {\n  assert(!context || typeof context === 'object'); // parseInBatches no longer accepts final url\n\n  // Signature: parseInBatches(data, options, url) - Uses registered loaders\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  data = await data; // Resolve any promise\n  options = options || {};\n\n  // Extract a url for auto detection\n  const {url} = getResourceUrlAndType(data);\n\n  // Chooses a loader and normalizes it\n  // Note - only uses URL and contentType for streams and iterator inputs\n  const loader = await selectLoader(data as ArrayBuffer, loaders as Loader[], options);\n  // Note: if options.nothrow was set, it is possible that no loader was found, if so just return null\n  if (!loader) {\n    // @ts-ignore\n    return null;\n  }\n\n  // Normalize options\n  // @ts-ignore\n  options = normalizeOptions(options, loader, loaders, url);\n  // @ts-ignore\n  context = getLoaderContext(\n    // @ts-ignore\n    {url, parseInBatches, parse, loaders: loaders as Loader[]},\n    options,\n    context\n  );\n\n  return await parseWithLoaderInBatches(loader as LoaderWithParser, data, options, context);\n}\n\n/**\n * Loader has been selected and context has been prepared, see if we need to emit a metadata batch\n */\nasync function parseWithLoaderInBatches(\n  loader: LoaderWithParser,\n  data: BatchableDataType,\n  options: LoaderOptions,\n  context: LoaderContext\n): Promise<AsyncIterable<any>> {\n  const outputIterator = await parseToOutputIterator(loader, data, options, context);\n\n  // Generate metadata batch if requested\n  if (!options.metadata) {\n    return outputIterator;\n  }\n\n  const metadataBatch = {\n    batchType: 'metadata',\n    metadata: {\n      _loader: loader,\n      _context: context\n    },\n    // Populate with some default fields to avoid crashing\n    data: [],\n    bytesUsed: 0\n  };\n\n  async function* makeMetadataBatchIterator(iterator) {\n    yield metadataBatch;\n    yield* iterator;\n  }\n\n  return makeMetadataBatchIterator(outputIterator);\n}\n\n/**\n * Prep work is done, now it is time to start parsing into an output operator\n * The approach depends on which parse function the loader exposes\n * `parseInBatches` (preferred), `parse` (fallback)\n */\nasync function parseToOutputIterator(\n  loader: LoaderWithParser,\n  data: BatchableDataType,\n  options: LoaderOptions,\n  context: LoaderContext\n): Promise<AsyncIterable<any>> {\n  // Get an iterator from the input\n  const inputIterator = await getAsyncIterableFromData(data, options);\n\n  // Apply any iterator transforms (options.transforms)\n  const transformedIterator = await applyInputTransforms(inputIterator, options?.transforms || []);\n\n  // If loader supports parseInBatches, we are done\n  if (loader.parseInBatches) {\n    return loader.parseInBatches(transformedIterator, options, context);\n  }\n\n  // Fallback: load atomically using `parse` concatenating input iterator into single chunk\n  async function* parseChunkInBatches() {\n    const arrayBuffer = await concatenateArrayBuffersAsync(transformedIterator);\n    // Call `parse` instead of `loader.parse` to ensure we can call workers etc.\n    const parsedData = await parse(\n      arrayBuffer,\n      loader,\n      // TODO - Hack: supply loaders MIME type to ensure we match it\n      {...options, mimeType: loader.mimeTypes[0]},\n      context\n    );\n    // yield a single batch, the output from loader.parse()\n    // TODO - run through batch builder to apply options etc...\n    const batch: Batch = {\n      mimeType: loader.mimeTypes[0],\n      shape: Array.isArray(parsedData) ? 'row-table' : 'unknown',\n      batchType: 'data',\n      data: parsedData,\n      length: Array.isArray(parsedData) ? parsedData.length : 1\n    };\n    yield batch;\n  }\n\n  return parseChunkInBatches();\n}\n\ntype TransformBatches = (\n  asyncIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>\n) => AsyncIterable<ArrayBuffer>;\n\n/**\n * Create an iterator chain with any transform iterators (crypto, decompression)\n * @param inputIterator\n * @param options\n */\nasync function applyInputTransforms(\n  inputIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>,\n  transforms: TransformBatches[] = []\n): Promise<AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>> {\n  let iteratorChain = inputIterator;\n  for await (const transformBatches of transforms) {\n    iteratorChain = transformBatches(iteratorChain);\n  }\n  return iteratorChain;\n}\n","import type {Writer, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {concatenateArrayBuffers, resolvePath} from '@loaders.gl/loader-utils';\nimport {isBrowser} from '@loaders.gl/loader-utils';\nimport {writeFile} from '../fetch/write-file';\nimport {fetchFile} from '../fetch/fetch-file';\n\n/**\n * Encode loaded data into a binary ArrayBuffer using the specified Writer.\n */\nexport async function encode(\n  data: any,\n  writer: Writer,\n  options?: LoaderOptions\n): Promise<ArrayBuffer> {\n  if (writer.encode) {\n    return await writer.encode(data, options);\n  }\n\n  if (writer.encodeSync) {\n    return writer.encodeSync(data, options);\n  }\n\n  if (writer.encodeText) {\n    return new TextEncoder().encode(await writer.encodeText(data, options));\n  }\n\n  if (writer.encodeInBatches) {\n    // Create an iterator representing the data\n    // TODO - Assumes this is a table\n    const batches = encodeInBatches(data, writer, options);\n\n    // Concatenate the output\n    const chunks: any[] = [];\n    for await (const batch of batches) {\n      chunks.push(batch);\n    }\n    // @ts-ignore\n    return concatenateArrayBuffers(...chunks);\n  }\n\n  if (!isBrowser && writer.encodeURLtoURL) {\n    // TODO - how to generate filenames with correct extensions?\n    const tmpInputFilename = getTemporaryFilename('input');\n    await writeFile(tmpInputFilename, data);\n\n    const tmpOutputFilename = getTemporaryFilename('output');\n\n    const outputFilename = await encodeURLtoURL(\n      tmpInputFilename,\n      tmpOutputFilename,\n      writer,\n      options\n    );\n\n    const response = await fetchFile(outputFilename);\n    return response.arrayBuffer();\n  }\n\n  throw new Error('Writer could not encode data');\n}\n\n/**\n * Encode loaded data into a binary ArrayBuffer using the specified Writer.\n */\nexport function encodeSync(data: any, writer: Writer, options?: LoaderOptions): ArrayBuffer {\n  if (writer.encodeSync) {\n    return writer.encodeSync(data, options);\n  }\n  throw new Error('Writer could not synchronously encode data');\n}\n\n/**\n * Encode loaded data to text using the specified Writer\n * @note This is a convenience function not intended for production use on large input data.\n * It is not optimized for performance. Data maybe converted from text to binary and back.\n * @throws if the writer does not generate text output\n */\nexport async function encodeText(\n  data: any,\n  writer: Writer,\n  options?: LoaderOptions\n): Promise<string> {\n  if (writer.text && writer.encodeText) {\n    return await writer.encodeText(data, options);\n  }\n\n  if (writer.text && (writer.encode || writer.encodeInBatches)) {\n    const arrayBuffer = await encode(data, writer, options);\n    return new TextDecoder().decode(arrayBuffer);\n  }\n\n  throw new Error('Writer could not encode data as text');\n}\n\n/**\n * Encode loaded data into a sequence (iterator) of binary ArrayBuffers using the specified Writer.\n */\nexport function encodeInBatches(\n  data: any,\n  writer: Writer,\n  options?: LoaderOptions\n): AsyncIterable<ArrayBuffer> {\n  if (writer.encodeInBatches) {\n    const dataIterator = getIterator(data);\n    return writer.encodeInBatches(dataIterator, options);\n  }\n  // TODO -fall back to atomic encode?\n  throw new Error('Writer could not encode data in batches');\n}\n\n/**\n * Encode data stored in a file (on disk) to another file.\n * @note Node.js only. This function enables using command-line converters as \"writers\".\n */\nexport async function encodeURLtoURL(\n  inputUrl,\n  outputUrl,\n  writer: Writer,\n  options\n): Promise<string> {\n  inputUrl = resolvePath(inputUrl);\n  outputUrl = resolvePath(outputUrl);\n  if (isBrowser || !writer.encodeURLtoURL) {\n    throw new Error();\n  }\n  const outputFilename = await writer.encodeURLtoURL(inputUrl, outputUrl, options);\n  return outputFilename;\n}\n\n/**\n * @todo TODO - this is an unacceptable hack!!!\n */\nfunction getIterator(data) {\n  const dataIterator = [{table: data, start: 0, end: data.length}];\n  return dataIterator;\n}\n\n/**\n * @todo Move to utils\n */\nfunction getTemporaryFilename(filename: string): string {\n  return `/tmp/${filename}`;\n}\n","export type MakeDOMStreamOptions = {\n  /** Stream allocates an arrayBuffer. Enables use of a default reader. */\n  autoAllocateChunkSize?: number;\n  /** Total number of chunks in queue before back pressure is applied */\n  highWaterMark?: number;\n};\n\n/** Builds a DOM stream from an iterator */\nexport function makeDOMStream<ArrayBuffer>(\n  source: Iterable<ArrayBuffer> | AsyncIterable<ArrayBuffer>,\n  options?: MakeDOMStreamOptions\n): ReadableStream {\n  const iterator = source[Symbol.asyncIterator]\n    ? source[Symbol.asyncIterator]()\n    : source[Symbol.iterator]();\n\n  return new ReadableStream<Uint8Array>(\n    {\n      // Create a byte stream (enables `Response(stream).arrayBuffer()`)\n      // Only supported on Chrome\n      // See: https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController\n      // @ts-expect-error Only Chrome supports byte streams\n      type: 'bytes',\n\n      async pull(controller) {\n        try {\n          const {done, value} = await iterator.next();\n          if (done) {\n            controller.close();\n          } else {\n            // TODO - ignores controller.desiredSize\n            controller.enqueue(new Uint8Array(value));\n          }\n        } catch (error) {\n          controller.error(error);\n        }\n      },\n\n      async cancel() {\n        await iterator?.return?.();\n      }\n    },\n    // options: QueingStrategy<Uint8Array>\n    {\n      // This is bytes, not chunks\n      highWaterMark: 2 ** 24,\n      ...options\n    }\n  );\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\n/* eslint-disable */\nimport {Quaternion, Vector3, Matrix3, Matrix4, degrees} from '@math.gl/core';\nimport {BoundingSphere, OrientedBoundingBox} from '@math.gl/culling';\nimport {Ellipsoid} from '@math.gl/geospatial';\nimport {assert} from '@loaders.gl/loader-utils';\n\n// const scratchProjectedBoundingSphere = new BoundingSphere();\n\nfunction defined(x) {\n  return x !== undefined && x !== null;\n}\n\n// const scratchMatrix = new Matrix3();\nconst scratchScale = new Vector3();\nconst scratchNorthWest = new Vector3();\nconst scratchSouthEast = new Vector3();\n// const scratchRectangle = new Rectangle();\n// const scratchOrientedBoundingBox = new OrientedBoundingBox();\n// const scratchTransform = new Matrix4();\n\n/**\n * Create a bounding volume from the tile's bounding volume header.\n * @param {Object} boundingVolumeHeader The tile's bounding volume header.\n * @param {Matrix4} transform The transform to apply to the bounding volume.\n * @param [result] The object onto which to store the result.\n * @returns The modified result parameter or a new TileBoundingVolume instance if none was provided.\n */\nexport function createBoundingVolume(boundingVolumeHeader, transform, result) {\n  assert(boundingVolumeHeader, '3D Tile: boundingVolume must be defined');\n\n  // boundingVolume schema:\n  // https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/specification/schema/boundingVolume.schema.json\n  if (boundingVolumeHeader.box) {\n    return createBox(boundingVolumeHeader.box, transform, result);\n  }\n  if (boundingVolumeHeader.region) {\n    // [west, south, east, north, minimum height, maximum height]\n    // Latitudes and longitudes are in the WGS 84 datum as defined in EPSG 4979 and are in radians.\n    // Heights are in meters above (or below) the WGS 84 ellipsoid.\n    const [west, south, east, north, minHeight, maxHeight] = boundingVolumeHeader.region;\n\n    const northWest = Ellipsoid.WGS84.cartographicToCartesian(\n      [degrees(west), degrees(north), minHeight],\n      scratchNorthWest\n    );\n    const southEast = Ellipsoid.WGS84.cartographicToCartesian(\n      [degrees(east), degrees(south), maxHeight],\n      scratchSouthEast\n    );\n    const centerInCartesian = new Vector3().addVectors(northWest, southEast).multiplyScalar(0.5);\n    const radius = new Vector3().subVectors(northWest, southEast).len() / 2.0;\n\n    // TODO improve region boundingVolume\n    // for now, create a sphere as the boundingVolume instead of box\n    return createSphere(\n      [centerInCartesian[0], centerInCartesian[1], centerInCartesian[2], radius],\n      new Matrix4()\n    );\n  }\n\n  if (boundingVolumeHeader.sphere) {\n    return createSphere(boundingVolumeHeader.sphere, transform, result);\n  }\n\n  throw new Error('3D Tile: boundingVolume must contain a sphere, region, or box');\n}\n\nfunction createBox(box, transform, result) {\n  // https://math.gl/modules/culling/docs/api-reference/oriented-bounding-box\n  // 1. A half-axes based representation.\n  // box: An array of 12 numbers that define an oriented bounding box.\n  // The first three elements define the x, y, and z values for the center of the box.\n  // The next three elements (with indices 3, 4, and 5) define the x axis direction and half-length.\n  // The next three elements (indices 6, 7, and 8) define the y axis direction and half-length.\n  // The last three elements (indices 9, 10, and 11) define the z axis direction and half-length.\n  // 2. A half-size-quaternion based representation.\n  // box: An array of 10 numbers that define an oriented bounding box.\n  // The first three elements define the x, y, and z values for the center of the box in a right-handed 3-axis (x, y, z) Cartesian coordinate system where the z-axis is up.\n  // The next three elements (with indices 3, 4, and 5) define the halfSize.\n  // The last four elements (indices 6, 7, 8 and 10) define the quaternion.\n  const center = new Vector3(box[0], box[1], box[2]);\n  transform.transform(center, center);\n  let origin: number[] = [];\n  if (box.length === 10) {\n    const halfSize = box.slice(3, 6);\n    const quaternion = new Quaternion();\n    quaternion.fromArray(box, 6);\n    const x = new Vector3([1, 0, 0]);\n    const y = new Vector3([0, 1, 0]);\n    const z = new Vector3([0, 0, 1]);\n    x.transformByQuaternion(quaternion);\n    x.scale(halfSize[0]);\n    y.transformByQuaternion(quaternion);\n    y.scale(halfSize[1]);\n    z.transformByQuaternion(quaternion);\n    z.scale(halfSize[2]);\n    origin = [...x.toArray(), ...y.toArray(), ...z.toArray()];\n  } else {\n    origin = [...box.slice(3, 6), ...box.slice(6, 9), ...box.slice(9, 12)];\n  }\n  const xAxis = transform.transformAsVector(origin.slice(0, 3));\n  const yAxis = transform.transformAsVector(origin.slice(3, 6));\n  const zAxis = transform.transformAsVector(origin.slice(6, 9));\n  const halfAxes = new Matrix3([\n    xAxis[0],\n    xAxis[1],\n    xAxis[2],\n    yAxis[0],\n    yAxis[1],\n    yAxis[2],\n    zAxis[0],\n    zAxis[1],\n    zAxis[2]\n  ]);\n\n  if (defined(result)) {\n    result.center = center;\n    result.halfAxes = halfAxes;\n    return result;\n  }\n\n  return new OrientedBoundingBox(center, halfAxes);\n}\n\n/*\nfunction createBoxFromTransformedRegion(region, transform, initialTransform, result) {\n  const rectangle = Rectangle.unpack(region, 0, scratchRectangle);\n  const minimumHeight = region[4];\n  const maximumHeight = region[5];\n\n  const orientedBoundingBox = OrientedBoundingBox.fromRectangle(\n    rectangle,\n    minimumHeight,\n    maximumHeight,\n    Ellipsoid.WGS84,\n    scratchOrientedBoundingBox\n  );\n  const center = orientedBoundingBox.center;\n  const halfAxes = orientedBoundingBox.halfAxes;\n\n  // A region bounding volume is not transformed by the transform in the tileset JSON,\n  // but may be transformed by additional transforms applied in Cesium.\n  // This is why the transform is calculated as the difference between the initial transform and the current transform.\n  transform = Matrix4.multiplyTransformation(\n    transform,\n    Matrix4.inverseTransformation(initialTransform, scratchTransform),\n    scratchTransform\n  );\n  center = Matrix4.multiplyByPoint(transform, center, center);\n  const rotationScale = Matrix4.getRotation(transform, scratchMatrix);\n  halfAxes = Matrix3.multiply(rotationScale, halfAxes, halfAxes);\n\n  if (defined(result) && result instanceof TileOrientedBoundingBox) {\n    result.update(center, halfAxes);\n    return result;\n  }\n\n  return new TileOrientedBoundingBox(center, halfAxes);\n}\n\nfunction createRegion(region, transform, initialTransform, result) {\n  if (!Matrix4.equalsEpsilon(transform, initialTransform, CesiumMath.EPSILON8)) {\n    return createBoxFromTransformedRegion(region, transform, initialTransform, result);\n  }\n\n  if (defined(result)) {\n    return result;\n  }\n\n  const rectangleRegion = Rectangle.unpack(region, 0, scratchRectangle);\n\n  return new TileBoundingRegion({\n    rectangle: rectangleRegion,\n    minimumHeight: region[4],\n    maximumHeight: region[5]\n  });\n}\n*/\n\nfunction createSphere(sphere, transform, result?) {\n  // Find the transformed center\n  const center = new Vector3(sphere[0], sphere[1], sphere[2]);\n  transform.transform(center, center);\n  const scale = transform.getScale(scratchScale);\n\n  const uniformScale = Math.max(Math.max(scale[0], scale[1]), scale[2]);\n  const radius = sphere[3] * uniformScale;\n\n  if (defined(result)) {\n    result.center = center;\n    result.radius = radius;\n    return result;\n  }\n\n  return new BoundingSphere(center, radius);\n}\n","import {toRadians} from '@math.gl/core';\n\nconst WGS84_RADIUS_X = 6378137.0;\n// use this to bias the lod switching  (1+ results in increasing the LOD quality)\nconst qualityFactor = Math.PI / 2; // empirical derived bias factor\n/* eslint-disable max-statements */\nexport function lodJudge(tile, frameState) {\n  const viewport = frameState.viewport;\n  const metersPerPixel = viewport.metersPerPixel;\n\n  const mbsLat = tile.header.mbs[1];\n  const mbsLon = tile.header.mbs[0];\n  const mbsZ = tile.header.mbs[2];\n  const mbsR = tile.header.mbs[3];\n\n  const {height, width, latitude, longitude} = viewport;\n\n  const viewportCenter = [longitude, latitude];\n  const mbsCenter = [mbsLon, mbsLat, mbsZ];\n  const mbsLatProjected = [longitude, mbsLat];\n  const mbsLonProjected = [mbsLon, latitude];\n\n  const diagonalInMeters = Math.sqrt(height * height + width * width) * metersPerPixel[0];\n  const distanceInMeters = getDistanceFromLatLon(viewportCenter, mbsCenter);\n\n  const visibleHeight = height * 0.5 + mbsR / WGS84_RADIUS_X;\n  const visibleWidth = width * 0.5 + mbsR / WGS84_RADIUS_X;\n\n  if (distanceInMeters > diagonalInMeters + mbsR / WGS84_RADIUS_X) {\n    return 'OUT';\n  }\n  if (getDistanceFromLatLon(viewportCenter, mbsLatProjected) > visibleHeight) {\n    return 'OUT';\n  }\n  if (getDistanceFromLatLon(viewportCenter, mbsLonProjected) > visibleWidth) {\n    return 'OUT';\n  }\n\n  if (tile.lodMetricValue === 0) {\n    return 'DIG';\n  }\n\n  // For the maxScreenThreshold error metric, maxError means that you should replace the node with it's children\n  // as soon as the nodes bounding sphere has a screen radius larger than maxError pixels.\n  // In this sense a value of 0 means you should always load it's children,\n  // or if it's a leaf node, you should always display it.\n  let screenSize = getI3ScreenSize(tile, frameState); // in pixels\n  screenSize *= qualityFactor;\n  if (screenSize < 0.5) {\n    return 'OUT';\n  }\n  if (!tile.header.children || screenSize <= tile.lodMetricValue) {\n    return 'DRAW';\n  } else if (tile.header.children) {\n    return 'DIG';\n  }\n  return 'OUT';\n}\n\n/* eslint-enable max-statements */\n\nfunction projectVertexToSphere([x, y, z]) {\n  const azim = toRadians(x);\n  const incl = toRadians(y);\n  const radius = 1.0 + z / WGS84_RADIUS_X;\n  const radCosInc = radius * Math.cos(incl);\n  x = radCosInc * Math.cos(azim);\n  y = radCosInc * Math.sin(azim);\n  z = radius * Math.sin(incl);\n  return [x, y, z];\n}\n\nfunction getDistanceFromLatLon(observer: number[], center: number[]) {\n  const [observerLon, observerLat, observerZ = 0.0] = observer;\n  const [centerLon, centerLat, centerZ = 0.0] = center;\n\n  const projectedCenter = projectVertexToSphere([centerLon, centerLat, centerZ]);\n  const projectedObserver = projectVertexToSphere([observerLon, observerLat, observerZ]);\n  const dx = projectedObserver[0] - projectedCenter[0];\n  const dy = projectedObserver[1] - projectedCenter[1];\n  const dz = projectedObserver[2] - projectedCenter[2];\n  return dx * dx + dy * dy + dz * dz;\n}\n\nexport function getI3ScreenSize(tile, frameState) {\n  const viewport = frameState.viewport;\n  const mbsLat = tile.header.mbs[1];\n  const mbsLon = tile.header.mbs[0];\n  const mbsZ = tile.header.mbs[2];\n  const mbsR = tile.header.mbs[3];\n\n  const mbsCenter = [mbsLon, mbsLat, mbsZ];\n  const cameraPositionCartographic = viewport.unprojectPosition(viewport.cameraPosition);\n  const dSquared = getDistanceFromLatLon(cameraPositionCartographic, mbsCenter);\n  const mbsRNormalized = mbsR / WGS84_RADIUS_X;\n  const d = dSquared - mbsRNormalized * mbsRNormalized;\n  const fltMax = 3.4028235e38; // convert from 0x7f7fffff which is the maximum\n  if (d <= 0.0) {\n    return 0.5 * fltMax;\n  }\n  // https://stackoverflow.com/questions/21648630/radius-of-projected-sphere-in-screen-space\n  // There is a formula there to calculate projected radius:\n  // return 1.0 / Math.tan(fov) * r / Math.sqrt(d * d - r * r); // Right\n  // Hack: 300 is a Magic number to get the correct LoD. Possibly, d and r are calculated in a wrong way.\n  const screenSizeFactor =\n    ((getTanOfHalfVFAngle(frameState) * mbsRNormalized) / Math.sqrt(d)) * 300;\n  return screenSizeFactor;\n}\n\nfunction getTanOfHalfVFAngle(frameState) {\n  const {projectionMatrix} = frameState.viewport;\n  const t = projectionMatrix[5];\n  return t;\n}\n","// @ts-nocheck\nconst moduleExports = require('./index');\nconst _global = typeof window === 'undefined' ? global : window;\n_global.loaders = _global.loaders || {};\nmodule.exports = Object.assign(_global.loaders, moduleExports);\n","export type {Tileset3DProps} from './tileset/tileset-3d';\nexport {default as Tileset3D} from './tileset/tileset-3d';\nexport {default as Tile3D} from './tileset/tile-3d';\n\nexport {default as TilesetTraverser} from './tileset/traversers/tileset-traverser';\nexport {default as TilesetCache} from './tileset/tileset-cache';\n\nexport {createBoundingVolume} from './tileset/helpers/bounding-volume';\nexport {calculateTransformProps} from './tileset/helpers/transform-utils';\n\nexport {getFrameState} from './tileset/helpers/frame-state';\n\nexport {\n  TILE_CONTENT_STATE,\n  TILE_REFINEMENT,\n  TILE_TYPE,\n  TILESET_TYPE,\n  LOD_METRIC_TYPE\n} from './constants';\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\n/*\n\n  The Tileset loading and rendering flow is as below,\n  A rendered (i.e. deck.gl `Tile3DLayer`) triggers `tileset.update()` after a `tileset` is loaded\n  `tileset` starts traversing the tile tree and update `requestTiles` (tiles of which content need\n  to be fetched) and `selectedTiles` (tiles ready for rendering under the current viewport).\n  `Tile3DLayer` will update rendering based on `selectedTiles`.\n  `Tile3DLayer` also listens to `onTileLoad` callback and trigger another round of `update and then traversal`\n  when new tiles are loaded.\n\n  As I3S tileset have stored `tileHeader` file (metadata) and tile content files (geometry, texture, ...) separately.\n  During each traversal, it issues `tilHeader` requests if that `tileHeader` is not yet fetched,\n  after the tile header is fulfilled, it will resume the traversal starting from the tile just fetched (not root).\n\n  Tile3DLayer\n       |\n   await load(tileset)\n       |\n   tileset.update()\n       |                async load tileHeader\n   tileset.traverse() -------------------------- Queued\n       |        resume traversal after fetched  |\n       |----------------------------------------|\n       |\n       |                     async load tile content\n  tilset.requestedTiles  ----------------------------- RequestScheduler\n                                                              |\n  tilset.selectedTiles (ready for rendering)                  |\n       |         Listen to                                    |\n    Tile3DLayer ----------- onTileLoad  ----------------------|\n       |                         |   notify new tile is available\n    updateLayers                 |\n                        tileset.update // trigger another round of update\n*/\n\nimport {Matrix4, Vector3} from '@math.gl/core';\nimport {Ellipsoid} from '@math.gl/geospatial';\nimport {Stats} from '@probe.gl/stats';\nimport {\n  RequestScheduler,\n  assert,\n  path,\n  LoaderWithParser,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport TilesetCache from './tileset-cache';\nimport {calculateTransformProps} from './helpers/transform-utils';\nimport {FrameState, getFrameState} from './helpers/frame-state';\nimport {getZoomFromBoundingVolume} from './helpers/zoom';\nimport Tile3D from './tile-3d';\nimport Tileset3DTraverser from './traversers/tileset-3d-traverser';\nimport TilesetTraverser from './traversers/tileset-traverser';\nimport I3SetTraverser from './traversers/i3s-tileset-traverser';\nimport {TILESET_TYPE} from '../constants';\n\nexport type Tileset3DProps = {\n  // loading\n  throttleRequests?: boolean;\n  maxRequests?: number;\n  loadOptions?: LoaderOptions;\n  loadTiles?: boolean;\n  basePath?: string;\n  maximumMemoryUsage?: number;\n\n  // Metadata\n  description?: string;\n  attributions?: string[];\n\n  // Transforms\n  ellipsoid?: object;\n  modelMatrix?: Matrix4;\n\n  // Traversal\n  maximumScreenSpaceError?: number;\n  viewportTraversersMap?: any;\n  updateTransforms?: boolean;\n  viewDistanceScale?: number;\n\n  // Callbacks\n  onTileLoad?: (tile: Tile3D) => any;\n  onTileUnload?: (tile: Tile3D) => any;\n  onTileError?: (tile: Tile3D, message: string, url: string) => any;\n  contentLoader?: (tile: Tile3D) => Promise<void>;\n  onTraversalComplete?: (selectedTiles: Tile3D[]) => Tile3D[];\n};\n\ntype Props = {\n  description: string;\n  ellipsoid: object;\n  modelMatrix: Matrix4;\n  throttleRequests: boolean;\n  maximumMemoryUsage: number;\n  onTileLoad: (tile: Tile3D) => any;\n  onTileUnload: (tile: Tile3D) => any;\n  onTileError: (tile: Tile3D, message: string, url: string) => any;\n  onTraversalComplete: (selectedTiles: Tile3D[]) => Tile3D[];\n  maximumScreenSpaceError: number;\n  viewportTraversersMap: any;\n  attributions: string[];\n  maxRequests: number;\n  loadTiles: boolean;\n  loadOptions: LoaderOptions;\n  updateTransforms: boolean;\n  viewDistanceScale: number;\n  basePath: string;\n  contentLoader?: (tile: Tile3D) => Promise<void>;\n  i3s: {[key: string]: any};\n};\n\nconst DEFAULT_PROPS: Props = {\n  description: '',\n\n  ellipsoid: Ellipsoid.WGS84,\n  // A 4x4 transformation matrix this transforms the entire tileset.\n  modelMatrix: new Matrix4(),\n\n  // Set to false to disable network request throttling\n  throttleRequests: true,\n\n  // Number of simultaneous requsts, if throttleRequests is true\n  maxRequests: 64,\n\n  maximumMemoryUsage: 32,\n\n  /**\n   * Callback. Indicates this a tile's content was loaded\n   * @param tile {TileHeader}\n   */\n  onTileLoad: () => {},\n  /**\n   * Callback. Indicates this a tile's content was unloaded\n   * @param tile {TileHeader}\n   */\n  onTileUnload: () => {},\n  onTileError: () => {},\n  /**\n   * Callback. Allows post-process selectedTiles right after traversal.\n   * @param selectedTiles {TileHeader[]}\n   * @returns TileHeader[] - output array of tiles to return to deck.gl\n   */\n  onTraversalComplete: (selectedTiles: Tile3D[]) => selectedTiles,\n\n  // Optional async tile content loader\n  contentLoader: undefined,\n\n  // View distance scale modifier\n  viewDistanceScale: 1.0,\n\n  // TODO CESIUM\n  // The maximum screen space error used to drive level of detail refinement.\n  maximumScreenSpaceError: 8,\n\n  loadTiles: true,\n  updateTransforms: true,\n  viewportTraversersMap: null,\n\n  loadOptions: {fetch: {}},\n\n  attributions: [],\n  basePath: '',\n\n  i3s: {}\n};\n\n// Tracked Stats\nconst TILES_TOTAL = 'Tiles In Tileset(s)';\nconst TILES_IN_MEMORY = 'Tiles In Memory';\nconst TILES_IN_VIEW = 'Tiles In View';\nconst TILES_RENDERABLE = 'Tiles To Render';\nconst TILES_LOADED = 'Tiles Loaded';\nconst TILES_LOADING = 'Tiles Loading';\nconst TILES_UNLOADED = 'Tiles Unloaded';\nconst TILES_LOAD_FAILED = 'Failed Tile Loads';\nconst POINTS_COUNT = 'Points';\nconst TILES_GPU_MEMORY = 'Tile Memory Use';\n\nexport default class Tileset3D {\n  // props: Tileset3DProps;\n  options: Props;\n  loadOptions: {[key: string]: any};\n\n  type: string;\n  tileset: {[key: string]: any};\n  loader: LoaderWithParser;\n  url: string;\n  basePath: string;\n  modelMatrix: Matrix4;\n  ellipsoid: any;\n  lodMetricType: string;\n  lodMetricValue: number;\n  refine: string;\n  root: Tile3D | null;\n  roots: {[key: string]: Tile3D};\n  asset: {[key: string]: any};\n\n  description: string;\n  properties: any;\n  extras: any;\n  attributions: any;\n  credits: any;\n\n  stats: Stats;\n\n  traverseCounter: number;\n  geometricError: number;\n  selectedTiles: Tile3D[];\n\n  cartographicCenter: Vector3 | null;\n  cartesianCenter: Vector3 | null;\n  zoom: number;\n  boundingVolume: any;\n\n  // METRICS\n  // The maximum amount of GPU memory (in MB) that may be used to cache tiles.\n  // Tiles not in view are unloaded to enforce private\n  // The total amount of GPU memory in bytes used by the tileset.\n  gpuMemoryUsageInBytes: any;\n  dynamicScreenSpaceErrorComputedDensity: any;\n\n  // TRAVERSAL\n  _traverser: TilesetTraverser;\n  private _cache: TilesetCache;\n  _requestScheduler: RequestScheduler;\n\n  _frameNumber: number;\n  private _queryParamsString: string;\n  private _queryParams: any;\n  private _extensionsUsed: any;\n  private _tiles: {[id: string]: Tile3D};\n\n  // counter for tracking tiles requests\n  private _pendingCount: any;\n\n  // HOLD TRAVERSAL RESULTS\n  private lastUpdatedVieports: any[] | null;\n  private _requestedTiles: any;\n  private _emptyTiles: any;\n  private frameStateData: any;\n\n  maximumMemoryUsage: number;\n\n  /**\n   * Create a new Tileset3D\n   * @param json\n   * @param props\n   */\n  // eslint-disable-next-line max-statements\n  constructor(json: any, options?: Tileset3DProps) {\n    assert(json);\n\n    // PUBLIC MEMBERS\n    this.options = {...DEFAULT_PROPS, ...options};\n    // raw data\n    this.tileset = json;\n    this.loader = json.loader;\n    // could be  3d tiles, i3s\n    this.type = json.type;\n    // The url to a tileset JSON file.\n    this.url = json.url;\n    this.basePath = json.basePath || path.dirname(this.url);\n    this.modelMatrix = this.options.modelMatrix;\n    this.ellipsoid = this.options.ellipsoid;\n\n    // Geometric error when the tree is not rendered at all\n    this.lodMetricType = json.lodMetricType;\n    this.lodMetricValue = json.lodMetricValue;\n    this.refine = json.root.refine;\n\n    this.loadOptions = this.options.loadOptions || {};\n\n    this.root = null;\n    this.roots = {};\n    // view props\n    this.cartographicCenter = null;\n    this.cartesianCenter = null;\n    this.zoom = 1;\n    this.boundingVolume = null;\n\n    // TRAVERSAL\n    this.traverseCounter = 0;\n    this.geometricError = 0;\n    this._traverser = this._initializeTraverser();\n    this._cache = new TilesetCache();\n    this._requestScheduler = new RequestScheduler({\n      throttleRequests: this.options.throttleRequests,\n      maxRequests: this.options.maxRequests\n    });\n    // update tracker\n    // increase in each update cycle\n    this._frameNumber = 0;\n\n    // counter for tracking tiles requests\n    this._pendingCount = 0;\n\n    // HOLD TRAVERSAL RESULTS\n    this._tiles = {};\n    this.selectedTiles = [];\n    this._emptyTiles = [];\n    this._requestedTiles = [];\n    this.frameStateData = {};\n    this.lastUpdatedVieports = null;\n\n    this._queryParams = {};\n    this._queryParamsString = '';\n\n    // METRICS\n    // The maximum amount of GPU memory (in MB) that may be used to cache tiles.\n    // Tiles not in view are unloaded to enforce this.\n    this.maximumMemoryUsage = this.options.maximumMemoryUsage || 32;\n    // The total amount of GPU memory in bytes used by the tileset.\n    this.gpuMemoryUsageInBytes = 0;\n    this.stats = new Stats({id: this.url});\n    this._initializeStats();\n\n    // EXTRACTED FROM TILESET\n    this._extensionsUsed = undefined;\n    this.dynamicScreenSpaceErrorComputedDensity = 0.0; // Updated based on the camera position and direction\n    // Metadata for the entire tileset\n    this.extras = null;\n    this.asset = {};\n    this.credits = {};\n    this.description = this.options.description || '';\n\n    this._initializeTileSet(json);\n  }\n\n  /** Release resources */\n  destroy(): void {\n    this._destroy();\n  }\n\n  /** Is the tileset loaded (update needs to have been called at least once) */\n  isLoaded(): boolean {\n    // Check that `_frameNumber !== 0` which means that update was called at least once\n    return this._pendingCount === 0 && this._frameNumber !== 0;\n  }\n\n  get tiles(): object[] {\n    return Object.values(this._tiles);\n  }\n\n  get frameNumber(): number {\n    return this._frameNumber;\n  }\n\n  get queryParams(): string {\n    if (!this._queryParamsString) {\n      this._queryParamsString = getQueryParamString(this._queryParams);\n    }\n    return this._queryParamsString;\n  }\n\n  setProps(props: Tileset3DProps): void {\n    this.options = {...this.options, ...props};\n  }\n\n  /** @deprecated */\n  setOptions(options: Tileset3DProps): void {\n    this.options = {...this.options, ...options};\n  }\n\n  /**\n   * Return a loadable tile url for a specific tile subpath\n   * @param tilePath a tile subpath\n   */\n  getTileUrl(tilePath: string): string {\n    const isDataUrl = tilePath.startsWith('data:');\n    if (isDataUrl) {\n      return tilePath;\n    }\n    return `${tilePath}${this.queryParams}`;\n  }\n\n  // TODO CESIUM specific\n  hasExtension(extensionName: string): boolean {\n    return Boolean(this._extensionsUsed && this._extensionsUsed.indexOf(extensionName) > -1);\n  }\n\n  /**\n   * Update visible tiles relying on a list of viewports\n   * @param viewports - list of viewports\n   */\n  // eslint-disable-next-line max-statements, complexity\n  update(viewports: any[]): void {\n    if ('loadTiles' in this.options && !this.options.loadTiles) {\n      return;\n    }\n    if (this.traverseCounter > 0) {\n      return;\n    }\n    if (!viewports && this.lastUpdatedVieports) {\n      viewports = this.lastUpdatedVieports;\n    } else {\n      this.lastUpdatedVieports = viewports;\n    }\n    if (!(viewports instanceof Array)) {\n      viewports = [viewports];\n    }\n\n    this._cache.reset();\n    this._frameNumber++;\n    this.traverseCounter = viewports.length;\n    const viewportsToTraverse: string[] = [];\n    // First loop to decrement traverseCounter\n    for (const viewport of viewports) {\n      const id = viewport.id as string;\n      if (this._needTraverse(id)) {\n        viewportsToTraverse.push(id);\n      } else {\n        this.traverseCounter--;\n      }\n    }\n\n    // Second loop to traverse\n    for (const viewport of viewports) {\n      const id = viewport.id as string;\n      if (!this.roots[id]) {\n        this.roots[id] = this._initializeTileHeaders(this.tileset, null);\n      }\n\n      if (!viewportsToTraverse.includes(id)) {\n        continue; // eslint-disable-line no-continue\n      }\n      const frameState = getFrameState(viewport, this._frameNumber);\n      this._traverser.traverse(this.roots[id], frameState, this.options);\n    }\n  }\n\n  /**\n   * Check if traversal is needed for particular viewport\n   * @param {string} viewportId - id of a viewport\n   * @return {boolean}\n   */\n  _needTraverse(viewportId: string): boolean {\n    let traverserId = viewportId;\n    if (this.options.viewportTraversersMap) {\n      traverserId = this.options.viewportTraversersMap[viewportId];\n    }\n    if (traverserId !== viewportId) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * The callback to post-process tiles after traversal procedure\n   * @param frameState - frame state for tile culling\n   */\n  _onTraversalEnd(frameState: FrameState): void {\n    const id = frameState.viewport.id;\n    if (!this.frameStateData[id]) {\n      this.frameStateData[id] = {selectedTiles: [], _requestedTiles: [], _emptyTiles: []};\n    }\n    const currentFrameStateData = this.frameStateData[id];\n    const selectedTiles = Object.values(this._traverser.selectedTiles);\n    currentFrameStateData.selectedTiles = selectedTiles;\n    currentFrameStateData._requestedTiles = Object.values(this._traverser.requestedTiles);\n    currentFrameStateData._emptyTiles = Object.values(this._traverser.emptyTiles);\n\n    this.traverseCounter--;\n    if (this.traverseCounter > 0) {\n      return;\n    }\n\n    this._updateTiles();\n  }\n\n  /**\n   * Update tiles relying on data from all traversers\n   */\n  _updateTiles(): void {\n    this.selectedTiles = [];\n    this._requestedTiles = [];\n    this._emptyTiles = [];\n\n    for (const frameStateKey in this.frameStateData) {\n      const frameStateDataValue = this.frameStateData[frameStateKey];\n      this.selectedTiles = this.selectedTiles.concat(frameStateDataValue.selectedTiles);\n      this._requestedTiles = this._requestedTiles.concat(frameStateDataValue._requestedTiles);\n      this._emptyTiles = this._emptyTiles.concat(frameStateDataValue._emptyTiles);\n    }\n\n    this.selectedTiles = this.options.onTraversalComplete(this.selectedTiles);\n\n    for (const tile of this.selectedTiles) {\n      this._tiles[tile.id] = tile;\n    }\n\n    this._loadTiles();\n    this._unloadTiles();\n    this._updateStats();\n  }\n\n  _tilesChanged(oldSelectedTiles, selectedTiles) {\n    if (oldSelectedTiles.length !== selectedTiles.length) {\n      return true;\n    }\n    const set1 = new Set(oldSelectedTiles.map((t) => t.id));\n    const set2 = new Set(selectedTiles.map((t) => t.id));\n    let changed = oldSelectedTiles.filter((x) => !set2.has(x.id)).length > 0;\n    changed = changed || selectedTiles.filter((x) => !set1.has(x.id)).length > 0;\n    return changed;\n  }\n\n  _loadTiles() {\n    // Sort requests by priority before making any requests.\n    // This makes it less likely this requests will be cancelled after being issued.\n    // requestedTiles.sort((a, b) => a._priority - b._priority);\n    for (const tile of this._requestedTiles) {\n      if (tile.contentUnloaded) {\n        this._loadTile(tile);\n      }\n    }\n  }\n\n  _unloadTiles() {\n    // unload tiles from cache when hit maximumMemoryUsage\n    this._cache.unloadTiles(this, (tileset, tile) => tileset._unloadTile(tile));\n  }\n\n  _updateStats() {\n    let tilesRenderable = 0;\n    let pointsRenderable = 0;\n    for (const tile of this.selectedTiles) {\n      if (tile.contentAvailable && tile.content) {\n        tilesRenderable++;\n        if (tile.content.pointCount) {\n          pointsRenderable += tile.content.pointCount;\n        }\n      }\n    }\n\n    this.stats.get(TILES_IN_VIEW).count = this.selectedTiles.length;\n    this.stats.get(TILES_RENDERABLE).count = tilesRenderable;\n    this.stats.get(POINTS_COUNT).count = pointsRenderable;\n  }\n\n  _initializeTileSet(tilesetJson) {\n    this.root = this._initializeTileHeaders(tilesetJson, null);\n\n    // TODO CESIUM Specific\n    if (this.type === TILESET_TYPE.TILES3D) {\n      this._initializeCesiumTileset(tilesetJson);\n    }\n\n    if (this.type === TILESET_TYPE.I3S) {\n      this._initializeI3STileset();\n    }\n    // Calculate cartographicCenter & zoom props to help apps center view on tileset\n    this._calculateViewProps();\n  }\n\n  // Called during initialize Tileset to initialize the tileset's cartographic center (longitude, latitude) and zoom.\n  _calculateViewProps() {\n    const root = this.root as Tile3D;\n    assert(root);\n    const {center} = root.boundingVolume;\n    // TODO - handle all cases\n    if (!center) {\n      // eslint-disable-next-line\n      console.warn('center was not pre-calculated for the root tile');\n      this.cartographicCenter = new Vector3();\n      this.zoom = 1;\n      return;\n    }\n    this.cartographicCenter = Ellipsoid.WGS84.cartesianToCartographic(center, new Vector3());\n    this.cartesianCenter = center;\n    this.zoom = getZoomFromBoundingVolume(root.boundingVolume);\n  }\n\n  _initializeStats() {\n    this.stats.get(TILES_TOTAL);\n    this.stats.get(TILES_LOADING);\n    this.stats.get(TILES_IN_MEMORY);\n    this.stats.get(TILES_IN_VIEW);\n    this.stats.get(TILES_RENDERABLE);\n    this.stats.get(TILES_LOADED);\n    this.stats.get(TILES_UNLOADED);\n    this.stats.get(TILES_LOAD_FAILED);\n    this.stats.get(POINTS_COUNT, 'memory');\n    this.stats.get(TILES_GPU_MEMORY, 'memory');\n  }\n\n  // Installs the main tileset JSON file or a tileset JSON file referenced from a tile.\n  // eslint-disable-next-line max-statements\n  _initializeTileHeaders(tilesetJson, parentTileHeader) {\n    // A tileset JSON file referenced from a tile may exist in a different directory than the root tileset.\n    // Get the basePath relative to the external tileset.\n    const rootTile = new Tile3D(this, tilesetJson.root, parentTileHeader); // resource\n\n    // If there is a parentTileHeader, add the root of the currently loading tileset\n    // to parentTileHeader's children, and update its depth.\n    if (parentTileHeader) {\n      parentTileHeader.children.push(rootTile);\n      rootTile.depth = parentTileHeader.depth + 1;\n    }\n\n    // Cesium 3d tiles knows the hierarchy beforehand\n    if (this.type === TILESET_TYPE.TILES3D) {\n      const stack: Tile3D[] = [];\n      stack.push(rootTile);\n\n      while (stack.length > 0) {\n        const tile = stack.pop() as Tile3D;\n        this.stats.get(TILES_TOTAL).incrementCount();\n        const children = tile.header.children || [];\n        for (const childHeader of children) {\n          const childTile = new Tile3D(this, childHeader, tile);\n          tile.children.push(childTile);\n          childTile.depth = tile.depth + 1;\n          stack.push(childTile);\n        }\n      }\n    }\n\n    return rootTile;\n  }\n\n  _initializeTraverser() {\n    let TraverserClass;\n    const type = this.type;\n    switch (type) {\n      case TILESET_TYPE.TILES3D:\n        TraverserClass = Tileset3DTraverser;\n        break;\n      case TILESET_TYPE.I3S:\n        TraverserClass = I3SetTraverser;\n        break;\n      default:\n        TraverserClass = TilesetTraverser;\n    }\n\n    return new TraverserClass({\n      basePath: this.basePath,\n      onTraversalEnd: this._onTraversalEnd.bind(this)\n    });\n  }\n\n  _destroyTileHeaders(parentTile) {\n    this._destroySubtree(parentTile);\n  }\n\n  async _loadTile(tile) {\n    let loaded;\n    try {\n      this._onStartTileLoading();\n      loaded = await tile.loadContent();\n    } catch (error) {\n      this._onTileLoadError(tile, error);\n    } finally {\n      this._onEndTileLoading();\n      this._onTileLoad(tile, loaded);\n    }\n  }\n\n  _onTileLoadError(tile, error) {\n    this.stats.get(TILES_LOAD_FAILED).incrementCount();\n\n    const message = error.message || error.toString();\n    const url = tile.url;\n    // TODO - Allow for probe log to be injected instead of console?\n    console.error(`A 3D tile failed to load: ${tile.url} ${message}`); // eslint-disable-line\n    this.options.onTileError(tile, message, url);\n  }\n\n  _onTileLoad(tile, loaded) {\n    if (!loaded) {\n      return;\n    }\n\n    // add coordinateOrigin and modelMatrix to tile\n    if (tile && tile.content) {\n      calculateTransformProps(tile, tile.content);\n    }\n\n    this._addTileToCache(tile);\n    this.options.onTileLoad(tile);\n  }\n\n  _onStartTileLoading() {\n    this._pendingCount++;\n    this.stats.get(TILES_LOADING).incrementCount();\n  }\n\n  _onEndTileLoading() {\n    this._pendingCount--;\n    this.stats.get(TILES_LOADING).decrementCount();\n  }\n\n  _addTileToCache(tile) {\n    this._cache.add(this, tile, (tileset) => tileset._updateCacheStats(tile));\n  }\n\n  _updateCacheStats(tile) {\n    this.stats.get(TILES_LOADED).incrementCount();\n    this.stats.get(TILES_IN_MEMORY).incrementCount();\n\n    // Good enough? Just use the raw binary ArrayBuffer's byte length.\n    this.gpuMemoryUsageInBytes += tile.content.byteLength || 0;\n    this.stats.get(TILES_GPU_MEMORY).count = this.gpuMemoryUsageInBytes;\n  }\n\n  _unloadTile(tile) {\n    this.gpuMemoryUsageInBytes -= (tile.content && tile.content.byteLength) || 0;\n\n    this.stats.get(TILES_IN_MEMORY).decrementCount();\n    this.stats.get(TILES_UNLOADED).incrementCount();\n    this.stats.get(TILES_GPU_MEMORY).count = this.gpuMemoryUsageInBytes;\n\n    this.options.onTileUnload(tile);\n    tile.unloadContent();\n  }\n\n  // Traverse the tree and destroy all tiles\n  _destroy() {\n    const stack: Tile3D[] = [];\n\n    if (this.root) {\n      stack.push(this.root);\n    }\n\n    while (stack.length > 0) {\n      const tile: Tile3D = stack.pop() as Tile3D;\n\n      for (const child of tile.children) {\n        stack.push(child);\n      }\n\n      this._destroyTile(tile);\n    }\n    this.root = null;\n  }\n\n  // Traverse the tree and destroy all sub tiles\n  _destroySubtree(tile) {\n    const root = tile;\n    const stack: Tile3D[] = [];\n    stack.push(root);\n    while (stack.length > 0) {\n      tile = stack.pop();\n      for (const child of tile.children) {\n        stack.push(child);\n      }\n      if (tile !== root) {\n        this._destroyTile(tile);\n      }\n    }\n    root.children = [];\n  }\n\n  _destroyTile(tile) {\n    this._cache.unloadTile(this, tile);\n    this._unloadTile(tile);\n    tile.destroy();\n  }\n\n  _initializeCesiumTileset(tilesetJson) {\n    this.asset = tilesetJson.asset;\n    if (!this.asset) {\n      throw new Error('Tileset must have an asset property.');\n    }\n    if (this.asset.version !== '0.0' && this.asset.version !== '1.0') {\n      throw new Error('The tileset must be 3D Tiles version 0.0 or 1.0.');\n    }\n\n    // Note: `asset.tilesetVersion` is version of the tileset itself (not the version of the 3D TILES standard)\n    // We add this version as a `v=1.0` query param to fetch the right version and not get an older cached version\n    if ('tilesetVersion' in this.asset) {\n      this._queryParams.v = this.asset.tilesetVersion;\n    }\n\n    // TODO - ion resources have a credits property we can use for additional attribution.\n    this.credits = {\n      attributions: this.options.attributions || []\n    };\n    this.description = this.options.description || '';\n\n    // Gets the tileset's properties dictionary object, which contains metadata about per-feature properties.\n    this.properties = tilesetJson.properties;\n    this.geometricError = tilesetJson.geometricError;\n    this._extensionsUsed = tilesetJson.extensionsUsed;\n    // Returns the extras property at the top of the tileset JSON (application specific metadata).\n    this.extras = tilesetJson.extras;\n  }\n\n  _initializeI3STileset() {\n    if (this.loadOptions.i3s && 'token' in this.loadOptions.i3s) {\n      this._queryParams.token = this.loadOptions.i3s.token;\n    }\n  }\n}\n\nfunction getQueryParamString(queryParams): string {\n  const queryParamStrings: string[] = [];\n  for (const key of Object.keys(queryParams)) {\n    queryParamStrings.push(`${key}=${queryParams[key]}`);\n  }\n  switch (queryParamStrings.length) {\n    case 0:\n      return '';\n    case 1:\n      return `?${queryParamStrings[0]}`;\n    default:\n      return `?${queryParamStrings.join('&')}`;\n  }\n}\n","// Purpose: include this in your module to avoid\n// dependencies on micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\ntype obj = {[key: string]: any};\nconst self_: obj = globals.self || globals.window || globals.global || {};\nconst window_: obj = globals.window || globals.self || globals.global || {};\nconst global_: obj = globals.global || globals.self || globals.window || {};\nconst document_: obj = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in a browser */\nexport const isBrowser: boolean =\n  // @ts-ignore process does not exist on browser\n  typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n\n/** true if running in a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n/** Major Node version (as a number) */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n","/* eslint-disable no-restricted-globals */\nimport type {LoaderWithParser} from '../../types';\nimport {WorkerBody} from '@loaders.gl/worker-utils';\n// import {validateLoaderVersion} from './validate-loader-version';\n\nlet requestId = 0;\n\n/**\n * Set up a WebWorkerGlobalScope to talk with the main thread\n * @param loader\n */\nexport function createLoaderWorker(loader: LoaderWithParser) {\n  // Check that we are actually in a worker thread\n  if (typeof self === 'undefined') {\n    return;\n  }\n\n  WorkerBody.onmessage = async (type, payload) => {\n    switch (type) {\n      case 'process':\n        try {\n          // validateLoaderVersion(loader, data.source.split('@')[1]);\n\n          const {input, options = {}} = payload;\n\n          const result = await parseData({\n            loader,\n            arrayBuffer: input,\n            options,\n            context: {\n              parse: parseOnMainThread\n            }\n          });\n          WorkerBody.postMessage('done', {result});\n        } catch (error) {\n          const message = error instanceof Error ? error.message : '';\n          WorkerBody.postMessage('error', {error: message});\n        }\n        break;\n      default:\n    }\n  };\n}\n\nfunction parseOnMainThread(arrayBuffer: ArrayBuffer, options: {[key: string]: any}): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const id = requestId++;\n\n    /**\n     */\n    const onMessage = (type, payload) => {\n      if (payload.id !== id) {\n        // not ours\n        return;\n      }\n\n      switch (type) {\n        case 'done':\n          WorkerBody.removeEventListener(onMessage);\n          resolve(payload.result);\n          break;\n\n        case 'error':\n          WorkerBody.removeEventListener(onMessage);\n          reject(payload.error);\n          break;\n\n        default:\n        // ignore\n      }\n    };\n\n    WorkerBody.addEventListener(onMessage);\n\n    // Ask the main thread to decode data\n    const payload = {id, input: arrayBuffer, options};\n    WorkerBody.postMessage('process', payload);\n  });\n}\n\n// TODO - Support byteOffset and byteLength (enabling parsing of embedded binaries without copies)\n// TODO - Why not support async loader.parse* funcs here?\n// TODO - Why not reuse a common function instead of reimplementing loader.parse* selection logic? Keeping loader small?\n// TODO - Lack of appropriate parser functions can be detected when we create worker, no need to wait until parse\nasync function parseData({loader, arrayBuffer, options, context}) {\n  let data;\n  let parser;\n  if (loader.parseSync || loader.parse) {\n    data = arrayBuffer;\n    parser = loader.parseSync || loader.parse;\n  } else if (loader.parseTextSync) {\n    const textDecoder = new TextDecoder();\n    data = textDecoder.decode(arrayBuffer);\n    parser = loader.parseTextSync;\n  } else {\n    throw new Error(`Could not load data with ${loader.name} loader`);\n  }\n\n  // TODO - proper merge in of loader options...\n  options = {\n    ...options,\n    modules: (loader && loader.options && loader.options.modules) || {},\n    worker: false\n  };\n\n  return await parser(data, {...options}, context, loader);\n}\n","import {assert} from '../env-utils/assert';\n\nconst workerURLCache = new Map();\n\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props: {source?: string; url?: string}) {\n  assert((props.source && !props.url) || (!props.source && props.url)); // Either source or url must be defined\n\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    // Differentiate worker urls from worker source code\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n\n  assert(workerURL);\n  return workerURL;\n}\n\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url: string): string {\n  // A local script url, we can use it to initialize a Worker directly\n  if (!url.startsWith('http')) {\n    return url;\n  }\n\n  // A remote script, we need to use `importScripts` to load from different origin\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource: string): string {\n  // NOTE: webworkify was previously used\n  // const blob = webworkify(workerSource, {bare: true});\n  const blob = new Blob([workerSource], {type: 'application/javascript'});\n  return URL.createObjectURL(blob);\n}\n\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl: string): string {\n  return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n","import type {\n  WorkerObject,\n  WorkerOptions,\n  WorkerContext,\n  WorkerMessageType,\n  WorkerMessagePayload\n} from '../../types';\nimport type WorkerJob from '../worker-farm/worker-job';\nimport WorkerFarm from '../worker-farm/worker-farm';\nimport {removeNontransferableOptions} from '../worker-utils/remove-nontransferable-options';\nimport {getWorkerURL, getWorkerName} from './get-worker-url';\n\ntype ProcessOnWorkerOptions = WorkerOptions & {\n  jobName?: string;\n  [key: string]: any;\n};\n\n/**\n * Determines if we can parse with worker\n * @param loader\n * @param data\n * @param options\n */\nexport function canProcessOnWorker(worker: WorkerObject, options?: WorkerOptions) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  return worker.worker && options?.worker;\n}\n\n/**\n * This function expects that the worker thread sends certain messages,\n * Creating such a worker can be automated if the worker is wrapper by a call to\n * createWorker in @loaders.gl/worker-utils.\n */\nexport async function processOnWorker(\n  worker: WorkerObject,\n  data: any,\n  options: ProcessOnWorkerOptions = {},\n  context: WorkerContext = {}\n): Promise<any> {\n  const name = getWorkerName(worker);\n  const url = getWorkerURL(worker, options);\n\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({name, url});\n\n  const jobName = options.jobName || worker.name;\n  const job = await workerPool.startJob(\n    jobName,\n    // eslint-disable-next-line\n    onMessage.bind(null, context)\n  );\n\n  // Kick off the processing in the worker\n  const transferableOptions = removeNontransferableOptions(options);\n  job.postMessage('process', {input: data, options: transferableOptions});\n\n  const result = await job.result;\n  return result.result;\n}\n\n/**\n * Job completes when we receive the result\n * @param job\n * @param message\n */\nasync function onMessage(\n  context: WorkerContext,\n  job: WorkerJob,\n  type: WorkerMessageType,\n  payload: WorkerMessagePayload\n) {\n  switch (type) {\n    case 'done':\n      // Worker is done\n      job.done(payload);\n      break;\n\n    case 'error':\n      // Worker encountered an error\n      job.error(payload.error);\n      break;\n\n    case 'process':\n      // Worker is asking for us (main thread) to process something\n      const {id, input, options} = payload;\n      try {\n        if (!context.process) {\n          job.postMessage('error', {id, error: 'Worker not set up to process on main thread'});\n          return;\n        }\n        const result = await context.process(input, options);\n        job.postMessage('done', {id, result});\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {id, error: message});\n      }\n      break;\n\n    default:\n      // eslint-disable-next-line\n      console.warn(`process-on-worker: unknown message ${type}`);\n  }\n}\n","/**\n * Safely stringify JSON (drop non serializable values like functions and regexps)\n * @param value\n */\nexport function removeNontransferableOptions(object: object): object {\n  // options.log object contains functions which cannot be transferred\n  // TODO - decide how to handle logging on workers\n  // TODO - warn if options stringification is long\n  return JSON.parse(stringifyJSON(object));\n}\n\nfunction stringifyJSON(v) {\n  const cache = new Set();\n  return JSON.stringify(v, (key, value) => {\n    if (typeof value === 'object' && value !== null) {\n      if (cache.has(value)) {\n        // Circular reference found\n        try {\n          // If this value does not reference a parent it can be deduped\n          return JSON.parse(JSON.stringify(value));\n        } catch (err) {\n          // discard key if value cannot be deduped\n          return undefined;\n        }\n      }\n      // Store value in our set\n      cache.add(value);\n    }\n    return value;\n  });\n}\n","import type {\n  WorkerMessageType,\n  WorkerMessagePayload,\n  WorkerContext,\n  Process,\n  ProcessInBatches\n} from '../../types';\nimport AsyncQueue from '../async-queue/async-queue';\nimport WorkerBody from '../worker-farm/worker-body';\n// import {validateWorkerVersion} from './validate-worker-version';\n\n/** Counter for jobs */\nlet requestId = 0;\nlet inputBatches;\nlet options;\n\nexport type ProcessOnMainThread = (data: any, options?: {[key: string]: any}, context?) => any;\n\n/**\n * Set up a WebWorkerGlobalScope to talk with the main thread\n */\nexport function createWorker(process: Process, processInBatches?: ProcessInBatches): void {\n  // Check that we are actually in a worker thread\n  if (typeof self === 'undefined') {\n    return;\n  }\n\n  const context: WorkerContext = {\n    process: processOnMainThread\n  };\n\n  // eslint-disable-next-line complexity\n  WorkerBody.onmessage = async (type: WorkerMessageType, payload: WorkerMessagePayload) => {\n    try {\n      switch (type) {\n        case 'process':\n          if (!process) {\n            throw new Error('Worker does not support atomic processing');\n          }\n          const result = await process(payload.input, payload.options || {}, context);\n          WorkerBody.postMessage('done', {result});\n          break;\n\n        case 'process-in-batches':\n          if (!processInBatches) {\n            throw new Error('Worker does not support batched processing');\n          }\n          inputBatches = new AsyncQueue();\n          options = payload.options || {};\n          const resultIterator = processInBatches(inputBatches, options, context?.processInBatches);\n          for await (const batch of resultIterator) {\n            WorkerBody.postMessage('output-batch', {result: batch});\n          }\n          WorkerBody.postMessage('done', {});\n          break;\n\n        case 'input-batch':\n          inputBatches.push(payload.input);\n          break;\n\n        case 'input-done':\n          inputBatches.close();\n          break;\n\n        default:\n      }\n    } catch (error) {\n      const message = error instanceof Error ? error.message : '';\n      WorkerBody.postMessage('error', {error: message});\n    }\n  };\n}\n\nfunction processOnMainThread(arrayBuffer, options = {}) {\n  return new Promise((resolve, reject) => {\n    const id = requestId++;\n\n    /**\n     */\n    const onMessage = (type, payload) => {\n      if (payload.id !== id) {\n        // not ours\n        return;\n      }\n\n      switch (type) {\n        case 'done':\n          WorkerBody.removeEventListener(onMessage);\n          resolve(payload.result);\n          break;\n\n        case 'error':\n          WorkerBody.removeEventListener(onMessage);\n          reject(payload.error);\n          break;\n\n        default:\n        // ignore\n      }\n    };\n\n    WorkerBody.addEventListener(onMessage);\n\n    // Ask the main thread to decode data\n    const payload = {id, input: arrayBuffer, options};\n    WorkerBody.postMessage('process', payload);\n  });\n}\n","import type {WorkerObject} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION} from '../env-utils/version';\n\n/**\n * Check if worker is compatible with this library version\n * @param worker\n * @param libVersion\n * @returns `true` if the two versions are compatible\n */\nexport function validateWorkerVersion(\n  worker: WorkerObject,\n  coreVersion: string = VERSION\n): boolean {\n  assert(worker, 'no worker provided');\n\n  const workerVersion = worker.version;\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n\n  // TODO enable when fix the __version__ injection\n  // const coreVersions = parseVersion(coreVersion);\n  // const workerVersions = parseVersion(workerVersion);\n  // assert(\n  //   coreVersion.major === workerVersion.major && coreVersion.minor <= workerVersion.minor,\n  //   `worker: ${worker.name} is not compatible. ${coreVersion.major}.${\n  //     coreVersion.minor\n  //   }+ is required.`\n  // );\n\n  return true;\n}\n\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {major: parts[0], minor: parts[1]};\n}\n","/* global importScripts */\nimport {global, isBrowser, isWorker} from '../env-utils/globals';\nimport * as node from '../node/require-utils.node';\nimport {assert} from '../env-utils/assert';\nimport {VERSION as __VERSION__} from '../env-utils/version';\n\n// TODO - unpkg.com doesn't seem to have a `latest` specifier for alpha releases...\nconst LATEST = 'beta';\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : LATEST;\n\nconst loadLibraryPromises = {}; // promises\n\n/**\n * Dynamically loads a library (\"module\")\n *\n * - wasm library: Array buffer is returned\n * - js library: Parse JS is returned\n *\n * Method depends on environment\n * - browser - script element is created and installed on document\n * - worker - eval is called on global context\n * - node - file is required\n *\n * @param libraryUrl\n * @param moduleName\n * @param options\n */\nexport async function loadLibrary(\n  libraryUrl: string,\n  moduleName: string | null = null,\n  options: object = {}\n): Promise<any> {\n  if (moduleName) {\n    libraryUrl = getLibraryUrl(libraryUrl, moduleName, options);\n  }\n\n  // Ensure libraries are only loaded once\n  loadLibraryPromises[libraryUrl] =\n    loadLibraryPromises[libraryUrl] || loadLibraryFromFile(libraryUrl);\n  return await loadLibraryPromises[libraryUrl];\n}\n\n// TODO - sort out how to resolve paths for main/worker and dev/prod\nexport function getLibraryUrl(library, moduleName?: string, options?): string {\n  // Check if already a URL\n  if (library.startsWith('http')) {\n    return library;\n  }\n\n  // Allow application to import and supply libraries through `options.modules`\n  const modules = options.modules || {};\n  if (modules[library]) {\n    return modules[library];\n  }\n\n  // Load from local files, not from CDN scripts in Node.js\n  // TODO - needs to locate the modules directory when installed!\n  if (!isBrowser) {\n    return `modules/${moduleName}/dist/libs/${library}`;\n  }\n\n  // In browser, load from external scripts\n  if (options.CDN) {\n    assert(options.CDN.startsWith('http'));\n    return `${options.CDN}/${moduleName}@${VERSION}/dist/libs/${library}`;\n  }\n\n  // TODO - loading inside workers requires paths relative to worker script location...\n  if (isWorker) {\n    return `../src/libs/${library}`;\n  }\n\n  return `modules/${moduleName}/src/libs/${library}`;\n}\n\nasync function loadLibraryFromFile(libraryUrl) {\n  if (libraryUrl.endsWith('wasm')) {\n    const response = await fetch(libraryUrl);\n    return await response.arrayBuffer();\n  }\n\n  if (!isBrowser) {\n    return node.requireFromFile && (await node.requireFromFile(libraryUrl));\n  }\n  if (isWorker) {\n    return importScripts(libraryUrl);\n  }\n  // TODO - fix - should be more secure than string parsing since observes CORS\n  // if (isBrowser) {\n  //   return await loadScriptFromFile(libraryUrl);\n  // }\n\n  const response = await fetch(libraryUrl);\n  const scriptSource = await response.text();\n  return loadLibraryFromString(scriptSource, libraryUrl);\n}\n\n/*\nasync function loadScriptFromFile(libraryUrl) {\n  const script = document.createElement('script');\n  script.src = libraryUrl;\n  return await new Promise((resolve, reject) => {\n    script.onload = data => {\n      resolve(data);\n    };\n    script.onerror = reject;\n  });\n}\n*/\n\n// TODO - Needs security audit...\n//  - Raw eval call\n//  - Potentially bypasses CORS\n// Upside is that this separates fetching and parsing\n// we could create a`LibraryLoader` or`ModuleLoader`\nfunction loadLibraryFromString(scriptSource, id) {\n  if (!isBrowser) {\n    return node.requireFromString && node.requireFromString(scriptSource, id);\n  }\n\n  if (isWorker) {\n    // Use lvalue trick to make eval run in global scope\n    eval.call(global, scriptSource); // eslint-disable-line no-eval\n    // https://stackoverflow.com/questions/9107240/1-evalthis-vs-evalthis-in-javascript\n    // http://perfectionkills.com/global-eval-what-are-the-options/\n    return null;\n  }\n\n  const script = document.createElement('script');\n  script.id = id;\n  // most browsers like a separate text node but some throw an error. The second method covers those.\n  try {\n    script.appendChild(document.createTextNode(scriptSource));\n  } catch (e) {\n    script.text = scriptSource;\n  }\n  document.body.appendChild(script);\n  return null;\n}\n\n// TODO - technique for module injection into worker, from THREE.DracoLoader...\n/*\nfunction combineWorkerWithLibrary(worker, jsContent) {\n  var fn = wWorker.toString();\n  var body = [\n    '// injected',\n    jsContent,\n    '',\n    '// worker',\n    fn.substring(fn.indexOf('{') + 1, fn.lastIndexOf('}'))\n  ].join('\\n');\n  this.workerSourceURL = URL.createObjectURL(new Blob([body]));\n}\n*/\n","import type {WorkerJob, WorkerMessageType, WorkerMessagePayload} from '@loaders.gl/worker-utils';\nimport type {Loader, LoaderOptions, LoaderContext} from '../../types';\nimport {WorkerFarm, getWorkerURL} from '@loaders.gl/worker-utils';\n\n/**\n * Determines if a loader can parse with worker\n * @param loader\n * @param options\n */\nexport function canParseWithWorker(loader: Loader, options?: LoaderOptions) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  return loader.worker && options?.worker;\n}\n\n/**\n * this function expects that the worker function sends certain messages,\n * this can be automated if the worker is wrapper by a call to createLoaderWorker in @loaders.gl/loader-utils.\n */\nexport async function parseWithWorker(\n  loader: Loader,\n  data,\n  options?: LoaderOptions,\n  context?: LoaderContext,\n  parseOnMainThread?: (arrayBuffer: ArrayBuffer, options: {[key: string]: any}) => Promise<void>\n) {\n  const name = loader.id; // TODO\n  const url = getWorkerURL(loader, options);\n\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({name, url});\n\n  // options.log object contains functions which cannot be transferred\n  // TODO - decide how to handle logging on workers\n  options = JSON.parse(JSON.stringify(options));\n\n  const job = await workerPool.startJob(\n    'process-on-worker',\n    // eslint-disable-next-line\n    onMessage.bind(null, parseOnMainThread)\n  );\n\n  job.postMessage('process', {\n    // @ts-ignore\n    input: data,\n    options\n  });\n\n  const result = await job.result;\n  return await result.result;\n}\n\n/**\n * Handle worker's responses to the main thread\n * @param job\n * @param type\n * @param payload\n */\nasync function onMessage(\n  parseOnMainThread,\n  job: WorkerJob,\n  type: WorkerMessageType,\n  payload: WorkerMessagePayload\n) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n\n    case 'error':\n      job.error(payload.error);\n      break;\n\n    case 'process':\n      // Worker is asking for main thread to parseO\n      const {id, input, options} = payload;\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {id, result});\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {id, error: message});\n      }\n      break;\n\n    default:\n      // eslint-disable-next-line\n      console.warn(`parse-with-worker unknown message ${type}`);\n  }\n}\n","import {getFirstCharacters} from '../binary-utils/get-first-characters';\n\n/**\n * Minimal JSON parser that throws more meaningful error messages\n */\nexport function parseJSON(string: string): any {\n  try {\n    return JSON.parse(string);\n  } catch (_) {\n    throw new Error(`Failed to parse JSON from data starting with \"${getFirstCharacters(string)}\"`);\n  }\n}\n","import {TypedArray} from '../../types';\nimport {padToNBytes} from './memory-copy-utils';\n\n/**\n * Copy sourceBuffer to dataView with some padding\n *\n * @param {DataView | null} dataView - destination data container. If null - only new offset is calculated\n * @param {number} byteOffset - destination byte offset to copy to\n * @param {Array | TypedArray} sourceBuffer - source data buffer\n * @param {number} padding - pad the resulting array to multiple of \"padding\" bytes. Additional bytes are filled with 0x20 (ASCII space)\n *\n * @return new byteOffset of resulting dataView\n */\nexport function copyPaddedArrayBufferToDataView(\n  dataView: DataView | null,\n  byteOffset: number,\n  sourceBuffer: TypedArray,\n  padding: number\n) {\n  const paddedLength = padToNBytes(sourceBuffer.byteLength, padding);\n  const padLength = paddedLength - sourceBuffer.byteLength;\n\n  if (dataView) {\n    // Copy array\n    const targetArray = new Uint8Array(\n      dataView.buffer,\n      dataView.byteOffset + byteOffset,\n      sourceBuffer.byteLength\n    );\n    const sourceArray = new Uint8Array(sourceBuffer);\n    targetArray.set(sourceArray);\n\n    // Add PADDING\n    for (let i = 0; i < padLength; ++i) {\n      // json chunk is padded with spaces (ASCII 0x20)\n      dataView.setUint8(byteOffset + sourceBuffer.byteLength + i, 0x20);\n    }\n  }\n  byteOffset += paddedLength;\n  return byteOffset;\n}\n\n/**\n * Copy string to dataView with some padding\n *\n * @param {DataView | null} dataView - destination data container. If null - only new offset is calculated\n * @param {number} byteOffset - destination byte offset to copy to\n * @param {string} string - source string\n * @param {number} padding - pad the resulting array to multiple of \"padding\" bytes. Additional bytes are filled with 0x20 (ASCII space)\n *\n * @return new byteOffset of resulting dataView\n */\nexport function copyPaddedStringToDataView(\n  dataView: DataView | null,\n  byteOffset: number,\n  string: string,\n  padding: number\n): number {\n  const textEncoder = new TextEncoder();\n  // PERFORMANCE IDEA: We encode twice, once to get size and once to store\n  // PERFORMANCE IDEA: Use TextEncoder.encodeInto() to avoid temporary copy\n  const stringBuffer = textEncoder.encode(string);\n\n  byteOffset = copyPaddedArrayBufferToDataView(dataView, byteOffset, stringBuffer, padding);\n\n  return byteOffset;\n}\n","// Note: These were broken out from gltf loader...\n// eslint-disable-next-line complexity\n\n// PERFORMANCE IDEA: No need to copy string twice...\nexport function padStringToByteAlignment(string, byteAlignment) {\n  const length = string.length;\n  const paddedLength = Math.ceil(length / byteAlignment) * byteAlignment; // Round up to the required alignment\n  const padding = paddedLength - length;\n  let whitespace = '';\n  for (let i = 0; i < padding; ++i) {\n    whitespace += ' ';\n  }\n  return string + whitespace;\n}\n\nexport function copyStringToDataView(dataView, byteOffset, string, byteLength) {\n  if (dataView) {\n    for (let i = 0; i < byteLength; i++) {\n      dataView.setUint8(byteOffset + i, string.charCodeAt(i));\n    }\n  }\n  return byteOffset + byteLength;\n}\n\nexport function copyBinaryToDataView(dataView, byteOffset, binary, byteLength) {\n  if (dataView) {\n    for (let i = 0; i < byteLength; i++) {\n      dataView.setUint8(byteOffset + i, binary[i]);\n    }\n  }\n  return byteOffset + byteLength;\n}\n","// TextDecoder iterators\n// TextDecoder will keep any partial undecoded bytes between calls to `decode`\n\nexport async function* makeTextDecoderIterator(\n  arrayBufferIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>,\n  options: TextDecoderOptions = {}\n): AsyncIterable<string> {\n  const textDecoder = new TextDecoder(undefined, options);\n  for await (const arrayBuffer of arrayBufferIterator) {\n    yield typeof arrayBuffer === 'string'\n      ? arrayBuffer\n      : textDecoder.decode(arrayBuffer, {stream: true});\n  }\n}\n\n// TextEncoder iterator\n// TODO - this is not useful unless min chunk size is given\n// TextEncoder will keep any partial undecoded bytes between calls to `encode`\n// If iterator does not yield strings, assume arrayBuffer and return unencoded\n\nexport async function* makeTextEncoderIterator(\n  textIterator: AsyncIterable<string> | Iterable<ArrayBuffer>\n): AsyncIterable<ArrayBuffer> {\n  const textEncoder = new TextEncoder();\n  for await (const text of textIterator) {\n    yield typeof text === 'string' ? textEncoder.encode(text) : text;\n  }\n}\n\n/**\n * @param textIterator async iterable yielding strings\n * @returns an async iterable over lines\n * See http://2ality.com/2018/04/async-iter-nodejs.html\n */\n\nexport async function* makeLineIterator(\n  textIterator: AsyncIterable<string>\n): AsyncIterable<string> {\n  let previous = '';\n  for await (const textChunk of textIterator) {\n    previous += textChunk;\n    let eolIndex;\n    while ((eolIndex = previous.indexOf('\\n')) >= 0) {\n      // line includes the EOL\n      const line = previous.slice(0, eolIndex + 1);\n      previous = previous.slice(eolIndex + 1);\n      yield line;\n    }\n  }\n\n  if (previous.length > 0) {\n    yield previous;\n  }\n}\n\n/**\n * @param lineIterator async iterable yielding lines\n * @returns async iterable yielding numbered lines\n *\n * See http://2ality.com/2018/04/async-iter-nodejs.html\n */\nexport async function* makeNumberedLineIterator(\n  lineIterator: AsyncIterable<string>\n): AsyncIterable<{counter: number; line: string}> {\n  let counter = 1;\n  for await (const line of lineIterator) {\n    yield {counter, line};\n    counter++;\n  }\n}\n","import {concatenateArrayBuffers} from '../binary-utils/array-buffer-utils';\n\n// GENERAL UTILITIES\n\n/**\n * Iterate over async iterator, without resetting iterator if end is not reached\n * - forEach intentionally does not reset iterator if exiting loop prematurely\n *   so that iteration can continue in a second loop\n * - It is recommended to use a standard for-await as last loop to ensure\n *   iterator gets properly reset\n *\n * TODO - optimize using sync iteration if argument is an Iterable?\n *\n * @param iterator\n * @param visitor\n */\nexport async function forEach(iterator, visitor) {\n  // eslint-disable-next-line\n  while (true) {\n    const {done, value} = await iterator.next();\n    if (done) {\n      iterator.return();\n      return;\n    }\n    const cancel = visitor(value);\n    if (cancel) {\n      return;\n    }\n  }\n}\n\n// Breaking big data into iterable chunks, concatenating iterable chunks into big data objects\n\n/**\n * Concatenates all data chunks yielded by an (async) iterator\n * This function can e.g. be used to enable atomic parsers to work on (async) iterator inputs\n */\n\nexport async function concatenateArrayBuffersAsync(\n  asyncIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>\n): Promise<ArrayBuffer> {\n  const arrayBuffers: ArrayBuffer[] = [];\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n  return concatenateArrayBuffers(...arrayBuffers);\n}\n\nexport async function concatenateStringsAsync(\n  asyncIterator: AsyncIterable<string> | Iterable<string>\n): Promise<string> {\n  const strings: string[] = [];\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n  return strings.join('');\n}\n","import {Stats} from '@probe.gl/stats';\n\ntype Handle = any;\ntype DoneFunction = () => any;\ntype GetPriorityFunction = () => number;\ntype RequestResult = {\n  done: DoneFunction;\n} | null;\n\n/** RequestScheduler Options */\nexport type RequestSchedulerProps = {\n  id?: string;\n  throttleRequests?: boolean;\n  maxRequests?: number;\n};\n\nconst STAT_QUEUED_REQUESTS = 'Queued Requests';\nconst STAT_ACTIVE_REQUESTS = 'Active Requests';\nconst STAT_CANCELLED_REQUESTS = 'Cancelled Requests';\nconst STAT_QUEUED_REQUESTS_EVER = 'Queued Requests Ever';\nconst STAT_ACTIVE_REQUESTS_EVER = 'Active Requests Ever';\n\nconst DEFAULT_PROPS: Required<RequestSchedulerProps> = {\n  id: 'request-scheduler',\n  // Specifies if the request scheduler should throttle incoming requests, mainly for comparative testing\n  throttleRequests: true,\n  // The maximum number of simultaneous active requests. Un-throttled requests do not observe this limit.\n  maxRequests: 6\n};\n\n/** Tracks one request */\ntype Request = {\n  handle: Handle;\n  priority: number;\n  getPriority: GetPriorityFunction;\n  resolve?: (value: any) => any;\n};\n\n/**\n * Used to issue a request, without having them \"deeply queued\" by the browser.\n * @todo - Track requests globally, across multiple servers\n */\nexport default class RequestScheduler {\n  readonly props: Required<RequestSchedulerProps>;\n  readonly stats: Stats;\n  activeRequestCount: number = 0;\n\n  /** Tracks the number of active requests and prioritizes/cancels queued requests. */\n  private requestQueue: Request[] = [];\n  private requestMap: Map<Handle, Promise<RequestResult>> = new Map();\n  private deferredUpdate: any = null;\n\n  constructor(props: RequestSchedulerProps = {}) {\n    this.props = {...DEFAULT_PROPS, ...props};\n\n    // Returns the statistics used by the request scheduler.\n    this.stats = new Stats({id: this.props.id});\n    this.stats.get(STAT_QUEUED_REQUESTS);\n    this.stats.get(STAT_ACTIVE_REQUESTS);\n    this.stats.get(STAT_CANCELLED_REQUESTS);\n    this.stats.get(STAT_QUEUED_REQUESTS_EVER);\n    this.stats.get(STAT_ACTIVE_REQUESTS_EVER);\n  }\n\n  /**\n   * Called by an application that wants to issue a request, without having it deeply queued by the browser\n   *\n   * When the returned promise resolved, it is OK for the application to issue a request.\n   * The promise resolves to an object that contains a `done` method.\n   * When the application's request has completed (or failed), the application must call the `done` function\n   *\n   * @param handle\n   * @param getPriority will be called when request \"slots\" open up,\n   *    allowing the caller to update priority or cancel the request\n   *    Highest priority executes first, priority < 0 cancels the request\n   * @returns a promise\n   *   - resolves to a object (with a `done` field) when the request can be issued without queueing,\n   *   - resolves to `null` if the request has been cancelled (by the callback return < 0).\n   *     In this case the application should not issue the request\n   */\n  scheduleRequest(\n    handle: Handle,\n    getPriority: GetPriorityFunction = () => 0\n  ): Promise<RequestResult> {\n    // Allows throttling to be disabled\n    if (!this.props.throttleRequests) {\n      return Promise.resolve({done: () => {}});\n    }\n\n    // dedupe\n    if (this.requestMap.has(handle)) {\n      return this.requestMap.get(handle) as Promise<any>;\n    }\n\n    const request: Request = {handle, priority: 0, getPriority};\n    const promise = new Promise<RequestResult>((resolve) => {\n      // @ts-ignore\n      request.resolve = resolve;\n      return request;\n    });\n\n    this.requestQueue.push(request);\n    this.requestMap.set(handle, promise);\n    this._issueNewRequests();\n    return promise;\n  }\n\n  // PRIVATE\n\n  _issueRequest(request: Request): Promise<any> {\n    const {handle, resolve} = request;\n    let isDone = false;\n\n    const done = () => {\n      // can only be called once\n      if (!isDone) {\n        isDone = true;\n\n        // Stop tracking a request - it has completed, failed, cancelled etc\n        this.requestMap.delete(handle);\n        this.activeRequestCount--;\n        // A slot just freed up, see if any queued requests are waiting\n        this._issueNewRequests();\n      }\n    };\n\n    // Track this request\n    this.activeRequestCount++;\n\n    return resolve ? resolve({done}) : Promise.resolve({done});\n  }\n\n  /** We check requests asynchronously, to prevent multiple updates */\n  _issueNewRequests(): void {\n    if (!this.deferredUpdate) {\n      this.deferredUpdate = setTimeout(() => this._issueNewRequestsAsync(), 0);\n    }\n  }\n\n  /** Refresh all requests  */\n  _issueNewRequestsAsync() {\n    // TODO - shouldn't we clear the timeout?\n    this.deferredUpdate = null;\n\n    const freeSlots = Math.max(this.props.maxRequests - this.activeRequestCount, 0);\n\n    if (freeSlots === 0) {\n      return;\n    }\n\n    this._updateAllRequests();\n\n    // Resolve pending promises for the top-priority requests\n    for (let i = 0; i < freeSlots; ++i) {\n      const request = this.requestQueue.shift();\n      if (request) {\n        this._issueRequest(request); // eslint-disable-line @typescript-eslint/no-floating-promises\n      }\n    }\n\n    // Uncomment to debug\n    // console.log(`${freeSlots} free slots, ${this.requestQueue.length} queued requests`);\n  }\n\n  /** Ensure all requests have updated priorities, and that no longer valid requests are cancelled */\n  _updateAllRequests() {\n    const requestQueue = this.requestQueue;\n    for (let i = 0; i < requestQueue.length; ++i) {\n      const request = requestQueue[i];\n      if (!this._updateRequest(request)) {\n        // Remove the element and make sure to adjust the counter to account for shortened array\n        requestQueue.splice(i, 1);\n        this.requestMap.delete(request.handle);\n        i--;\n      }\n    }\n\n    // Sort the remaining requests based on priority\n    requestQueue.sort((a, b) => a.priority - b.priority);\n  }\n\n  /** Update a single request by calling the callback */\n  _updateRequest(request) {\n    request.priority = request.getPriority(request.handle); // eslint-disable-line callback-return\n\n    // by returning a negative priority, the callback cancels the request\n    if (request.priority < 0) {\n      request.resolve(null);\n      return false;\n    }\n    return true;\n  }\n}\n","// Beginning of a minimal implementation of the Node.js path API, that doesn't pull in big polyfills.\n\n/**\n * Replacement for Node.js path.dirname\n * @param url\n */\nexport function dirname(url: string): string {\n  const slashIndex = url && url.lastIndexOf('/');\n  return slashIndex >= 0 ? url.substr(0, slashIndex as number) : '';\n}\n\n/**\n * Replacement for Node.js path.join\n * @param parts\n */\nexport function join(...parts: string[]): string {\n  const separator = '/';\n  parts = parts.map((part, index) => {\n    if (index) {\n      part = part.replace(new RegExp(`^${separator}`), '');\n    }\n    if (index !== parts.length - 1) {\n      part = part.replace(new RegExp(`${separator}$`), '');\n    }\n    return part;\n  });\n  return parts.join(separator);\n}\n","// Simple file alias mechanisms for tests.\n\nlet pathPrefix = '';\nconst fileAliases: {[aliasPath: string]: string} = {};\n\n/*\n * Set a relative path prefix\n */\nexport function setPathPrefix(prefix: string): void {\n  pathPrefix = prefix;\n}\n\n/*\n * Get the relative path prefix\n */\nexport function getPathPrefix(): string {\n  return pathPrefix;\n}\n\n/**\n *\n * @param aliases\n *\n * Note: addAliases are an experimental export, they are only for testing of loaders.gl loaders\n * not intended as a generic aliasing mechanism\n */\nexport function addAliases(aliases: {[aliasPath: string]: string}): void {\n  Object.assign(fileAliases, aliases);\n}\n\n/**\n * Resolves aliases and adds path-prefix to paths\n */\nexport function resolvePath(filename: string): string {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = `${pathPrefix}${filename}`;\n  }\n  return filename;\n}\n","import * as node from '../node/buffer-utils.node';\n\n/**\n * Check for Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n */\nexport function isBuffer(value: any): boolean {\n  return value && typeof value === 'object' && value.isBuffer;\n}\n\n/**\n * Converts to Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toBuffer(data: any): Buffer {\n  return node.toBuffer ? node.toBuffer(data) : data;\n}\n\n/**\n * Converts Node.js `Buffer` to `ArrayBuffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function bufferToArrayBuffer(data: any): ArrayBuffer {\n  if (node.toArrayBuffer) {\n    // TODO - per docs we should just be able to call buffer.buffer, but there are issues\n    return node.toArrayBuffer(data);\n  }\n  return data;\n}\n","import type {LoaderWithParser} from './types';\n\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'latest';\n\n/**\n * A JSON Micro loader (minimal bundle size)\n * Alternative to `@loaders.gl/json`\n */\nexport const JSONLoader = {\n  name: 'JSON',\n  id: 'json',\n  module: 'json',\n  version: VERSION,\n  extensions: ['json', 'geojson'],\n  mimeTypes: ['application/json'],\n  category: 'json',\n  text: true,\n  parseTextSync,\n  parse: async (arrayBuffer) => parseTextSync(new TextDecoder().decode(arrayBuffer)),\n  options: {}\n};\n\n// TODO - deprecated\nfunction parseTextSync(text) {\n  return JSON.parse(text);\n}\n\nexport const _typecheckJSONLoader: LoaderWithParser = JSONLoader;\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\nimport DoublyLinkedListNode from '../utils/doubly-linked-list-node';\n\n/**\n * Doubly linked list\n *\n * @private\n */\nexport default class DoublyLinkedList {\n  constructor() {\n    this.head = null;\n    this.tail = null;\n    this._length = 0;\n  }\n\n  get length() {\n    return this._length;\n  }\n\n  /**\n   * Adds the item to the end of the list\n   * @param {*} [item]\n   * @return {DoublyLinkedListNode}\n   */\n  add(item) {\n    const node = new DoublyLinkedListNode(item, this.tail, null);\n\n    if (this.tail) {\n      this.tail.next = node;\n      this.tail = node;\n    } else {\n      this.head = node;\n      this.tail = node;\n    }\n\n    ++this._length;\n\n    return node;\n  }\n\n  /**\n   * Removes the given node from the list\n   * @param {DoublyLinkedListNode} node\n   */\n  remove(node) {\n    if (!node) {\n      return;\n    }\n\n    if (node.previous && node.next) {\n      node.previous.next = node.next;\n      node.next.previous = node.previous;\n    } else if (node.previous) {\n      // Remove last node\n      node.previous.next = null;\n      this.tail = node.previous;\n    } else if (node.next) {\n      // Remove first node\n      node.next.previous = null;\n      this.head = node.next;\n    } else {\n      // Remove last node in the linked list\n      this.head = null;\n      this.tail = null;\n    }\n\n    node.next = null;\n    node.previous = null;\n\n    --this._length;\n  }\n\n  /**\n   * Moves nextNode after node\n   * @param {DoublyLinkedListNode} node\n   * @param {DoublyLinkedListNode} nextNode\n   */\n  splice(node, nextNode) {\n    if (node === nextNode) {\n      return;\n    }\n\n    // Remove nextNode, then insert after node\n    this.remove(nextNode);\n    this._insert(node, nextNode);\n  }\n\n  _insert(node, nextNode) {\n    const oldNodeNext = node.next;\n    node.next = nextNode;\n\n    // nextNode is the new tail\n    if (this.tail === node) {\n      this.tail = nextNode;\n    } else {\n      oldNodeNext.previous = nextNode;\n    }\n\n    nextNode.next = oldNodeNext;\n    nextNode.previous = node;\n\n    ++this._length;\n  }\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\n/**\n * Doubly linked list node\n *\n * @private\n */\nexport default class DoublyLinkedListNode {\n  constructor(item, previous, next) {\n    this.item = item;\n    this.previous = previous;\n    this.next = next;\n  }\n}\n","import {Vector3} from '@math.gl/core';\n\nconst WGS84_RADIUS_X = 6378137.0;\nconst WGS84_RADIUS_Y = 6378137.0;\nconst WGS84_RADIUS_Z = 6356752.3142451793;\n\nconst scratchVector = new Vector3();\n\n/**\n * Calculate appropriate zoom value for a particular boundingVolume\n * @param {BoundingSphere, OrientedBoundingBox} boundingVolume - the instance of bounding volume\n * @returns {number} - zoom value\n */\nexport function getZoomFromBoundingVolume(boundingVolume) {\n  const {halfAxes, radius, width, height} = boundingVolume;\n\n  if (halfAxes) {\n    // OrientedBoundingBox\n    const obbSize = getObbSize(halfAxes);\n    // Use WGS84_RADIUS_Z to allign with BoundingSphere algorithm\n    return Math.log2(WGS84_RADIUS_Z / obbSize);\n  } else if (radius) {\n    // BoundingSphere\n    return Math.log2(WGS84_RADIUS_Z / radius);\n  } else if (height && width) {\n    // BoundingRectangle\n    const zoomX = Math.log2(WGS84_RADIUS_X / width);\n    const zoomY = Math.log2(WGS84_RADIUS_Y / height);\n\n    return (zoomX + zoomY) / 2;\n  }\n\n  return 1;\n}\n\nfunction getObbSize(halfAxes) {\n  halfAxes.getColumn(0, scratchVector);\n  const axeY = halfAxes.getColumn(1);\n  const axeZ = halfAxes.getColumn(2);\n  const farthestVertex = scratchVector.add(axeY).add(axeZ);\n  const size = farthestVertex.len();\n  return size;\n}\n","// TODO - build/integrate proper MIME type parsing\n// https://mimesniff.spec.whatwg.org/\n\nconst DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\n\n/**\n * Remove extra data like `charset` from MIME types\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMEType(mimeString: string): string {\n  // If resource is a data url, extract any embedded mime type\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n  if (matches) {\n    return matches[1];\n  }\n  return mimeString;\n}\n\n/**\n * Extract MIME type from data URL\n *\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMETypeFromURL(url: string): string {\n  // If resource is a data URL, extract any embedded mime type\n  const matches = DATA_URL_PATTERN.exec(url);\n  if (matches) {\n    return matches[1];\n  }\n  return '';\n}\n","//\nimport {fs} from '@loaders.gl/loader-utils';\n\n/**\n * Reads a chunk from a random access file\n * @param file\n * @param start\n * @param length\n * @returns\n */\nexport async function readArrayBuffer(\n  file: Blob | ArrayBuffer | string | number,\n  start: number,\n  length: number\n): Promise<ArrayBuffer> {\n  if (typeof file === 'number') {\n    return await fs._readToArrayBuffer(file, start, length);\n  }\n  // TODO - we can do better for ArrayBuffer and string\n  if (!(file instanceof Blob)) {\n    file = new Blob([file]);\n  }\n  const slice = file.slice(start, start + length);\n  return await readBlob(slice);\n}\n\n/**\n * Read a slice of a Blob or File, without loading the entire file into memory\n * The trick when reading File objects is to read successive \"slices\" of the File\n * Per spec https://w3c.github.io/FileAPI/, slicing a File only updates the start and end fields\n * Actually reading from file happens in `readAsArrayBuffer`\n * @param blob to read\n */\nexport async function readBlob(blob: Blob): Promise<ArrayBuffer> {\n  return await new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = (event: ProgressEvent<FileReader>) =>\n      resolve(event?.target?.result as ArrayBuffer);\n    // TODO - reject with a proper Error\n    fileReader.onerror = (error: ProgressEvent<FileReader>) => reject(error);\n    fileReader.readAsArrayBuffer(blob);\n  });\n}\n","// File read\nimport {isBrowser, resolvePath, fs, toArrayBuffer} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\n\n// TODO - this is not tested\n// const isDataURL = (url) => url.startsWith('data:');\n\n/**\n * In a few cases (data URIs, node.js) \"files\" can be read synchronously\n */\nexport function readFileSync(url: string, options: object = {}) {\n  url = resolvePath(url);\n\n  // Only support this if we can also support sync data URL decoding in browser\n  // if (isDataURL(url)) {\n  //   return decodeDataUri(url);\n  // }\n\n  if (!isBrowser) {\n    const buffer = fs.readFileSync(url, options);\n    return typeof buffer !== 'string' ? toArrayBuffer(buffer) : buffer;\n  }\n\n  // @ts-ignore\n  if (!options.nothrow) {\n    // throw new Error('Cant load URI synchronously');\n    assert(false);\n  }\n\n  return null;\n}\n","import {setGlobalOptions} from '../loader-utils/option-utils';\n\n/**\n * Set global loader options\n * @param options\n */\nexport function setLoaderOptions(options: object): void {\n  setGlobalOptions(options);\n}\n","import type {LoaderOptions} from '@loaders.gl/loader-utils';\nimport {ConsoleLog} from './loggers';\n\nexport const DEFAULT_LOADER_OPTIONS: LoaderOptions = {\n  // baseUri\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(), // A probe.gl compatible (`log.log()()` syntax) that just logs to console\n\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true, // By default, use worker if provided by loader.\n  maxConcurrency: 3, // How many worker instances should be created for each loader.\n  maxMobileConcurrency: 1, // How many worker instances should be created for each loader on mobile devices.\n  reuseWorkers: true, // By default reuse workers,\n  _workerType: '', // 'test' to use locally generated workers\n\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false, // TODO - currently only implemented for parseInBatches, adds initial metadata batch,\n  transforms: []\n};\n\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  // Warn if fetch options are used on top-level\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n","import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big string into chunks and yields them one-by-one as ArrayBuffers\n * @param blob string to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeStringIterator(\n  string: string,\n  options?: IteratorOptions\n): Iterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n  while (offset < string.length) {\n    // Create a chunk of the right size\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n\n    // yield an ArrayBuffer chunk\n    yield textEncoder.encode(chunk);\n  }\n}\n","import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big ArrayBuffer into chunks and yields them one-by-one\n * @param blob ArrayBuffer to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeArrayBufferIterator(\n  arrayBuffer: ArrayBuffer,\n  options: IteratorOptions = {}\n): Iterable<ArrayBuffer> {\n  const {chunkSize = DEFAULT_CHUNK_SIZE} = options;\n\n  let byteOffset = 0;\n\n  while (byteOffset < arrayBuffer.byteLength) {\n    // Create a chunk of the right size\n    const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n    const chunk = new ArrayBuffer(chunkByteLength);\n\n    // Copy data from the big chunk\n    const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n    const chunkArray = new Uint8Array(chunk);\n    chunkArray.set(sourceArray);\n\n    // yield the chunk\n    byteOffset += chunkByteLength;\n    yield chunk;\n  }\n}\n","import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 1024 * 1024; // 1MB  biggest value that keeps UI responsive\n\n/**\n * Returns an iterator that breaks a big Blob into chunks and yields them one-by-one\n * @param blob Blob or File object\n * @param options\n * @param options.chunkSize\n */\nexport async function* makeBlobIterator(\n  blob: Blob,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n\n    offset = end;\n    yield chunk;\n  }\n}\n","import type {Readable} from 'stream';\nimport {isBrowser, toArrayBuffer} from '@loaders.gl/loader-utils';\n\nexport type StreamIteratorOptions = {\n  _streamReadAhead?: boolean;\n};\n\n/**\n * Returns an async iterable that reads from a stream (works in both Node.js and browsers)\n * @param stream stream to iterator over\n */\nexport function makeStreamIterator(\n  stream: ReadableStream | Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  return isBrowser\n    ? makeBrowserStreamIterator(stream as ReadableStream, options)\n    : makeNodeStreamIterator(stream as Readable, options);\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @see https://jakearchibald.com/2017/async-iterators-and-generators/#making-streams-iterate\n */\nasync function* makeBrowserStreamIterator(\n  stream: ReadableStream,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // WhatWG: stream is supposed to have a `getIterator` method\n  // if (typeof stream.getIterator === 'function') {\n  //   return stream.getIterator();\n  // }\n  // if (typeof stream[Symbol.asyncIterator] === 'function') {\n  //   return makeToArrayBufferIterator(stream);\n  // }\n\n  // In the browser, we first need to get a lock on the stream\n  const reader = stream.getReader();\n\n  let nextBatchPromise: Promise<{done?: boolean; value?: Uint8Array}> | undefined;\n\n  try {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n      // Issue a read for an additional batch, while we await the next batch\n      // Idea is to make fetching happen in parallel with processing / parsing\n      if (options?._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n      // Read from the stream\n      // value is a Uint8Array\n      const {done, value} = await currentBatchPromise;\n      // Exit if we're done\n      if (done) {\n        return;\n      }\n      // Else yield the chunk\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    // TODO - examples makes it look like this should always be called,\n    // but that generates exceptions so only call it if we do not reach the end\n    reader.releaseLock();\n  }\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @note Requires Node.js >= 10\n */\nasync function* makeNodeStreamIterator(\n  stream: Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // Hacky test for node version to ensure we don't call bad polyfills\n  // NODE 10+: stream is an asyncIterator\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk); // Coerce each chunk to ArrayBuffer\n  }\n}\n/* TODO - remove NODE < 10\n * @see https://github.com/bustle/streaming-iterables, MIT license\n *\n  if (typeof stream[Symbol.asyncIterator] === 'function') {\n    return;\n  }\n\n  // TODO - check if is this ever used in Node 10+?\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const data = stream.read();\n    if (data !== null) {\n      yield toArrayBuffer(data);\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    if (stream._readableState?.ended) {\n      return;\n    }\n    await onceReadable(stream);\n  }\n\nasync function onceReadable(stream: Readable): Promise<any> {\n  return new Promise((resolve) => {\n    stream.once('readable', resolve);\n  });\n}\n  */\n","import type {\n  SyncDataType,\n  Loader,\n  LoaderWithParser,\n  LoaderContext,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\nimport {selectLoaderSync} from './select-loader';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {normalizeOptions} from '../loader-utils/option-utils';\nimport {getArrayBufferOrStringFromDataSync} from '../loader-utils/get-data';\nimport {getLoaderContext, getLoadersFromContext} from '../loader-utils/loader-context';\nimport {getResourceUrlAndType} from '../utils/resource-utils';\n\n/**\n * Parses `data` synchronously using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport function parseSync(\n  data: SyncDataType,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): any {\n  assert(!context || typeof context === 'object'); // parseSync no longer accepts final url\n\n  // Signature: parseSync(data, options)\n  // Uses registered loaders\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  options = options || {};\n\n  // Chooses a loader (and normalizes it)\n  // Also use any loaders in the context, new loaders take priority\n  const typedLoaders = loaders as Loader | Loader[] | undefined;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  const loader = selectLoaderSync(data, candidateLoaders, options);\n  // Note: if nothrow option was set, it is possible that no loader was found, if so just return null\n  if (!loader) {\n    return null;\n  }\n\n  // Normalize options\n  options = normalizeOptions(options, loader, candidateLoaders);\n\n  // Extract a url for auto detection\n  const {url} = getResourceUrlAndType(data);\n\n  const parse = () => {\n    throw new Error('parseSync called parse');\n  };\n  context = getLoaderContext({url, parseSync, parse, loaders: loaders as Loader[]}, options);\n\n  return parseWithLoaderSync(loader as LoaderWithParser, data, options, context);\n}\n\n// TODO - should accept loader.parseSync/parse and generate 1 chunk asyncIterator\nfunction parseWithLoaderSync(\n  loader: LoaderWithParser,\n  data: SyncDataType,\n  options: LoaderOptions,\n  context: LoaderContext\n) {\n  data = getArrayBufferOrStringFromDataSync(data, loader, options);\n\n  if (loader.parseTextSync && typeof data === 'string') {\n    return loader.parseTextSync(data, options); // , context, loader);\n  }\n\n  if (loader.parseSync && data instanceof ArrayBuffer) {\n    return loader.parseSync(data, options, context); // , loader);\n  }\n\n  // TBD - If synchronous parser not available, return null\n  throw new Error(\n    `${loader.name} loader: 'parseSync' not supported by this loader, use 'parse' instead. ${\n      context.url || ''\n    }`\n  );\n}\n","import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isBlob} from '../../javascript-utils/is-type';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {getFetchFunction} from '../loader-utils/option-utils';\n\nimport {parse} from './parse';\n\n/**\n * Parses `data` using a specified loader\n * Note: Load does duplicate a lot of parse.\n * it can also call fetchFile on string urls, which `parse` won't do.\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\n// implementation signature\nexport async function load(\n  url: string | DataType,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  // Signature: load(url, options)\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  // Select fetch function\n  const fetch = getFetchFunction(options);\n\n  // at this point, `url` could be already loaded binary data\n  let data = url;\n  // url is a string, fetch the url\n  if (typeof url === 'string') {\n    data = await fetch(url);\n    // URL is Blob or File, fetchFile handles it (alt: we could generate ObjectURL here)\n  }\n\n  if (isBlob(url)) {\n    // The fetch response object will contain blob.name\n    data = await fetch(url);\n  }\n\n  // Data is loaded (at least we have a `Response` object) so time to hand over to `parse`\n  return await parse(data, loaders, options);\n}\n","import type {LoaderWithParser, LoaderOptions, LoaderContext} from '@loaders.gl/loader-utils';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {getFetchFunction} from '../loader-utils/option-utils';\n\nimport {parseInBatches} from './parse-in-batches';\n\ntype FileType = string | File | Blob | Response | (string | File | Blob | Response)[] | FileList;\n\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport function loadInBatches(\n  files: FileType,\n  loaders?: LoaderWithParser | LoaderWithParser[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<AsyncIterable<any>>;\n\nexport function loadInBatches(\n  files: FileType[] | FileList,\n  loaders?: LoaderWithParser | LoaderWithParser[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<AsyncIterable<any>>;\n\nexport function loadInBatches(files, loaders, options, context) {\n  // Signature: load(url, options)\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders;\n    loaders = null;\n  }\n\n  // Select fetch function\n  const fetch = getFetchFunction(options || {});\n\n  // Single url/file\n  if (!Array.isArray(files)) {\n    return loadOneFileInBatches(files, loaders, options, fetch);\n  }\n\n  // Multiple URLs / files\n  const promises = files.map((file) => loadOneFileInBatches(file, loaders, options, fetch));\n\n  // No point in waiting here for all responses before starting to stream individual streams?\n  return promises;\n}\n\nasync function loadOneFileInBatches(file, loaders, options, fetch) {\n  if (typeof file === 'string') {\n    const url = file;\n    const response = await fetch(url);\n    return await parseInBatches(response, loaders, options);\n  }\n  return await parseInBatches(file, loaders, options);\n}\n","import type {Writer, WriterOptions} from '@loaders.gl/loader-utils';\nimport {encode, encodeSync} from './encode';\nimport {writeFile, writeFileSync} from '../fetch/write-file';\n\nexport async function save(data, url, writer: Writer, options: WriterOptions) {\n  const encodedData = await encode(data, writer, options);\n  return await writeFile(url, encodedData);\n}\n\nexport function saveSync(data, url, writer, options) {\n  const encodedData = encodeSync(data, writer, options);\n  return writeFileSync(url, encodedData);\n}\n","import type {ReadableStreamType} from '../../javascript-utils/is-type';\nimport type {MakeDOMStreamOptions} from './make-dom-stream';\nimport type {MakeNodeStreamOptions} from './make-node-stream';\n\nimport {isBrowser} from '@loaders.gl/loader-utils';\nimport {makeDOMStream} from './make-dom-stream';\nimport {makeNodeStream} from './make-node-stream';\n\nexport type MakeStreamOptions = MakeDOMStreamOptions | MakeNodeStreamOptions;\n\n/**\n * Returns a stream for an (async) iterator (works in both Node.js and browsers)\n */\nexport function makeStream(\n  data: Iterable<ArrayBuffer> | AsyncIterable<ArrayBuffer>,\n  options?: MakeStreamOptions\n): ReadableStreamType {\n  return isBrowser ? makeDOMStream(data, options) : makeNodeStream(data, options);\n}\n","// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'latest';\n\nimport {Loader, LoaderWithParser} from '@loaders.gl/loader-utils';\n\n/**\n * Loads any data and returns null (or optionally passes through data unparsed)\n */\nexport const NullWorkerLoader: Loader = {\n  name: 'Null loader',\n  id: 'null',\n  module: 'core',\n  version: VERSION,\n  worker: true,\n  mimeTypes: ['application/x.empty'],\n  extensions: ['null'],\n  tests: [() => false],\n  options: {\n    null: {}\n  }\n};\n\n/**\n * Loads any data and returns null (or optionally passes through data unparsed)\n */\nexport const NullLoader: LoaderWithParser = {\n  name: 'Null loader',\n  id: 'null',\n  module: 'core',\n  version: VERSION,\n  mimeTypes: ['application/x.empty'],\n  extensions: ['null'],\n  parse: async (arrayBuffer) => arrayBuffer,\n  parseSync: (arrayBuffer) => arrayBuffer,\n  parseInBatches: async function* generator(asyncIterator) {\n    for await (const batch of asyncIterator) {\n      yield batch;\n    }\n  },\n  tests: [() => false],\n  options: {\n    null: {}\n  }\n};\n","// Forked from github AnthumChris/fetch-progress-indicators under MIT license\n\n/**\n * Intercepts the Response stream and creates a new Response\n */\nexport default async function fetchProgress(\n  response: Response | Promise<Response>,\n  onProgress: any, // TODO better callback types\n  onDone = () => {},\n  onError = () => {}\n) {\n  response = await response;\n  if (!response.ok) {\n    // ERROR checking needs to be done separately\n    return response;\n  }\n  const body = response.body;\n  if (!body) {\n    // 'ReadableStream not yet supported in this browser.\n    return response;\n  }\n  const contentLength = response.headers.get('content-length') || 0;\n  const totalBytes = contentLength && parseInt(contentLength);\n  if (!(contentLength > 0)) {\n    return response;\n  }\n  // Currently override only implemented in browser\n  if (typeof ReadableStream === 'undefined' || !body.getReader) {\n    return response;\n  }\n\n  // Create a new stream that invisbly wraps original stream\n  const progressStream = new ReadableStream({\n    async start(controller) {\n      const reader = body.getReader();\n      await read(controller, reader, 0, totalBytes, onProgress, onDone, onError);\n    }\n  });\n\n  return new Response(progressStream);\n}\n\n// Forward to original streams controller\n// TODO - this causes a crazy deep \"async stack\"... rewrite as async iterator?\n// eslint-disable-next-line max-params\nasync function read(controller, reader, loadedBytes, totalBytes, onProgress, onDone, onError) {\n  try {\n    const {done, value} = await reader.read();\n    if (done) {\n      onDone();\n      controller.close();\n      return;\n    }\n    loadedBytes += value.byteLength;\n    const percent = Math.round((loadedBytes / totalBytes) * 100);\n    onProgress(percent, {loadedBytes, totalBytes});\n    controller.enqueue(value);\n    await read(controller, reader, loadedBytes, totalBytes, onProgress, onDone, onError);\n  } catch (error) {\n    controller.error(error);\n    onError(error);\n  }\n}\n","import type {FileSystem} from './filesystem';\n\ntype BrowserFileSystemOptions = {\n  fetch?: typeof fetch;\n};\n\n/**\n * FileSystem adapter for a browser FileList.\n * Holds a list of browser 'File' objects.\n */\nexport default class BrowserFileSystem implements FileSystem {\n  private _fetch: typeof fetch;\n  private files: {[filename: string]: File} = {};\n  private lowerCaseFiles: {[filename: string]: File} = {};\n  private usedFiles: {[filename: string]: boolean} = {};\n\n  /**\n   * A FileSystem API wrapper around a list of browser 'File' objects\n   * @param files\n   * @param options\n   */\n  constructor(files: FileList | File[], options?: BrowserFileSystemOptions) {\n    this._fetch = options?.fetch || fetch;\n\n    for (let i = 0; i < files.length; ++i) {\n      const file = files[i];\n      this.files[file.name] = file;\n      this.lowerCaseFiles[file.name.toLowerCase()] = file;\n      this.usedFiles[file.name] = false;\n    }\n\n    this.fetch = this.fetch.bind(this);\n  }\n\n  // implements IFileSystem\n\n  /**\n   * Implementation of fetch against this file system\n   * Delegates to global fetch for http{s}:// or data://\n   */\n  async fetch(path: string, options?: RequestInit): Promise<Response> {\n    // Fallback to handle https:/http:/data: etc fetches\n    if (path.includes('://')) {\n      return this._fetch(path, options);\n    }\n\n    // Local fetches are served from the list of files\n    const file = this.files[path];\n    if (!file) {\n      return new Response(path, {status: 400, statusText: 'NOT FOUND'});\n    }\n\n    const headers = new Headers(options?.headers);\n    const range = headers.get('Range');\n    const bytes = range && /bytes=($1)-($2)/.exec(range);\n\n    if (bytes) {\n      const start = parseInt(bytes[1]);\n      const end = parseInt(bytes[2]);\n      // The trick when reading File objects is to read successive \"slices\" of the File\n      // Per spec https://w3c.github.io/FileAPI/, slicing a File should only update the start and end fields\n      // Actually reading from file should happen in `readAsArrayBuffer` (and as far we can tell it does)\n      const data = await file.slice(start, end).arrayBuffer();\n      const response = new Response(data);\n      Object.defineProperty(response, 'url', {value: path});\n      return response;\n    }\n\n    // return makeResponse()\n    const response = new Response(file);\n    Object.defineProperty(response, 'url', {value: path});\n    return response;\n  }\n\n  /**\n   * List filenames in this filesystem\n   * @param dirname\n   * @returns\n   */\n  async readdir(dirname?: string): Promise<string[]> {\n    const files: string[] = [];\n    for (const path in this.files) {\n      files.push(path);\n    }\n    // TODO filter by dirname\n    return files;\n  }\n\n  /**\n   * Return information (size) about files in this file system\n   */\n  async stat(path: string, options?: object): Promise<{size: number}> {\n    const file = this.files[path];\n    if (!file) {\n      throw new Error(path);\n    }\n    return {size: file.size};\n  }\n\n  /**\n   * Just removes the file from the list\n   */\n  async unlink(path: string): Promise<void> {\n    delete this.files[path];\n    delete this.lowerCaseFiles[path];\n    this.usedFiles[path] = true;\n  }\n\n  // implements IRandomAccessFileSystem\n\n  // RANDOM ACCESS\n  async open(pathname: string, flags, mode?): Promise<any> {\n    return this.files[pathname];\n  }\n\n  /**\n   * Read a range into a buffer\n   * @todo - handle position memory\n   * @param buffer is the buffer that the data (read from the fd) will be written to.\n   * @param offset is the offset in the buffer to start writing at.\n   * @param length is an integer specifying the number of bytes to read.\n   * @param position is an argument specifying where to begin reading from in the file. If position is null, data will be read from the current file position, and the file position will be updated. If position is an integer, the file position will remain unchanged.\n   */\n  async read(\n    fd: any,\n    buffer: ArrayBuffer,\n    offset: number = 0,\n    length: number = buffer.byteLength,\n    position: number | null = null\n  ): Promise<{bytesRead: number; buffer: ArrayBuffer}> {\n    const file = fd as File;\n    const startPosition = 0; // position\n    const arrayBuffer = await file.slice(startPosition, startPosition + length).arrayBuffer();\n    // copy into target buffer\n    return {bytesRead: length, buffer: arrayBuffer};\n  }\n\n  async close(fd: number): Promise<void> {\n    // NO OP\n  }\n\n  // fstat(fd: number): Promise<object>; // Stat\n\n  // PRIVATE\n\n  // Supports case independent paths, and file usage tracking\n  _getFile(path, used) {\n    // Prefer case match, but fall back to case indepent.\n    const file = this.files[path] || this.lowerCaseFiles[path];\n    if (file && used) {\n      this.usedFiles[path] = true;\n    }\n    return file;\n  }\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\n// TODO - Dynamic screen space error provides an optimization when looking at\n// tilesets from above\n\n/* eslint-disable */\n// @ts-nocheck\nimport {Matrix4, Vector3, clamp} from '@math.gl/core';\n\nconst scratchPositionNormal = new Vector3();\nconst scratchCartographic = new Vector3();\nconst scratchMatrix = new Matrix4();\nconst scratchCenter = new Vector3();\nconst scratchPosition = new Vector3();\nconst scratchDirection = new Vector3();\n\n// eslint-disable-next-line max-statements, complexity\nexport function calculateDynamicScreenSpaceError(root, {camera, mapProjection}, options = {}) {\n  const {dynamicScreenSpaceErrorHeightFalloff = 0.25, dynamicScreenSpaceErrorDensity = 0.00278} =\n    options;\n\n  let up;\n  let direction;\n  let height;\n  let minimumHeight;\n  let maximumHeight;\n\n  const tileBoundingVolume = root.contentBoundingVolume;\n\n  if (tileBoundingVolume instanceof TileBoundingRegion) {\n    up = Cartesian3.normalize(camera.positionWC, scratchPositionNormal);\n    direction = camera.directionWC;\n    height = camera.positionCartographic.height;\n    minimumHeight = tileBoundingVolume.minimumHeight;\n    maximumHeight = tileBoundingVolume.maximumHeight;\n  } else {\n    // Transform camera position and direction into the local coordinate system of the tileset\n    const transformLocal = Matrix4.inverseTransformation(root.computedTransform, scratchMatrix);\n    const ellipsoid = mapProjection.ellipsoid;\n    const boundingVolume = tileBoundingVolume.boundingVolume;\n    const centerLocal = Matrix4.multiplyByPoint(\n      transformLocal,\n      boundingVolume.center,\n      scratchCenter\n    );\n    if (Cartesian3.magnitude(centerLocal) > ellipsoid.minimumRadius) {\n      // The tileset is defined in WGS84. Approximate the minimum and maximum height.\n      const centerCartographic = Cartographic.fromCartesian(\n        centerLocal,\n        ellipsoid,\n        scratchCartographic\n      );\n      up = Cartesian3.normalize(camera.positionWC, scratchPositionNormal);\n      direction = camera.directionWC;\n      height = camera.positionCartographic.height;\n      minimumHeight = 0.0;\n      maximumHeight = centerCartographic.height * 2.0;\n    } else {\n      // The tileset is defined in local coordinates (z-up)\n      const positionLocal = Matrix4.multiplyByPoint(\n        transformLocal,\n        camera.positionWC,\n        scratchPosition\n      );\n      up = Cartesian3.UNIT_Z;\n      direction = Matrix4.multiplyByPointAsVector(\n        transformLocal,\n        camera.directionWC,\n        scratchDirection\n      );\n      direction = Cartesian3.normalize(direction, direction);\n      height = positionLocal.z;\n      if (tileBoundingVolume instanceof TileOrientedBoundingBox) {\n        // Assuming z-up, the last component stores the half-height of the box\n        const boxHeight = root._header.boundingVolume.box[11];\n        minimumHeight = centerLocal.z - boxHeight;\n        maximumHeight = centerLocal.z + boxHeight;\n      } else if (tileBoundingVolume instanceof TileBoundingSphere) {\n        const radius = boundingVolume.radius;\n        minimumHeight = centerLocal.z - radius;\n        maximumHeight = centerLocal.z + radius;\n      }\n    }\n  }\n\n  // The range where the density starts to lessen. Start at the quarter height of the tileset.\n  const heightFalloff = dynamicScreenSpaceErrorHeightFalloff;\n  const heightClose = minimumHeight + (maximumHeight - minimumHeight) * heightFalloff;\n  const heightFar = maximumHeight;\n\n  const t = clamp((height - heightClose) / (heightFar - heightClose), 0.0, 1.0);\n\n  // Increase density as the camera tilts towards the horizon\n  const dot = Math.abs(Cartesian3.dot(direction, up));\n\n  let horizonFactor = 1.0 - dot;\n\n  // Weaken the horizon factor as the camera height increases, implying the camera is further away from the tileset.\n  // The goal is to increase density for the \"street view\", not when viewing the tileset from a distance.\n  horizonFactor = horizonFactor * (1.0 - t);\n\n  return dynamicScreenSpaceErrorDensity * horizonFactor;\n}\n\nexport function fog(distanceToCamera, density) {\n  const scalar = distanceToCamera * density;\n  return 1.0 - Math.exp(-(scalar * scalar));\n}\n\nexport function getDynamicScreenSpaceError(tileset, distanceToCamera) {\n  if (tileset.dynamicScreenSpaceError && tileset.dynamicScreenSpaceErrorComputedDensity) {\n    const density = tileset.dynamicScreenSpaceErrorComputedDensity;\n    const factor = tileset.dynamicScreenSpaceErrorFactor;\n    // TODO: Refined screen space error that minimizes tiles in non-first-person\n    const dynamicError = fog(distanceToCamera, density) * factor;\n    return dynamicError;\n  }\n\n  return 0;\n}\n\nexport function getTiles3DScreenSpaceError(tile, frameState, useParentLodMetric) {\n  const tileset = tile.tileset;\n  const parentLodMetricValue = (tile.parent && tile.parent.lodMetricValue) || tile.lodMetricValue;\n  const lodMetricValue = useParentLodMetric ? parentLodMetricValue : tile.lodMetricValue;\n\n  // Leaf tiles do not have any error so save the computation\n  if (lodMetricValue === 0.0) {\n    return 0.0;\n  }\n\n  // TODO: Orthographic Frustum needs special treatment?\n  // this._getOrthograhicScreenSpaceError();\n\n  // Avoid divide by zero when viewer is inside the tile\n  const distance = Math.max(tile._distanceToCamera, 1e-7);\n  const {height, sseDenominator} = frameState;\n  const {viewDistanceScale} = tileset.options;\n  let error = (lodMetricValue * height * (viewDistanceScale || 1.0)) / (distance * sseDenominator);\n\n  error -= getDynamicScreenSpaceError(tileset, distance);\n\n  return error;\n}\n","export function get3dTilesOptions(tileset) {\n  return {\n    assetGltfUpAxis: (tileset.asset && tileset.asset.gltfUpAxis) || 'Y'\n  };\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\nimport {assert} from '@loaders.gl/loader-utils';\n\n/**\n * A wrapper around arrays so that the internal length of the array can be manually managed.\n *\n * @alias ManagedArray\n * @constructor\n * @private\n *\n * @param {Number} [length=0] The initial length of the array.\n */\nexport default class ManagedArray {\n  constructor(length = 0) {\n    this._array = new Array(length);\n    this._map = new Map();\n    this._length = length;\n  }\n\n  /**\n   * Gets or sets the length of the array.\n   * If the set length is greater than the length of the internal array, the internal array is resized.\n   *\n   * @memberof ManagedArray.prototype\n   * @type Number\n   */\n  get length() {\n    return this._length;\n  }\n\n  set length(length) {\n    this._length = length;\n    if (length > this._array.length) {\n      this._array.length = length;\n    }\n  }\n\n  /**\n   * Gets the internal array.\n   *\n   * @memberof ManagedArray.prototype\n   * @type Array\n   * @readonly\n   */\n  get values() {\n    return this._array;\n  }\n\n  /**\n   * Gets the element at an index.\n   *\n   * @param {Number} index The index to get.\n   */\n  get(index) {\n    assert(index < this._array.length);\n    return this._array[index];\n  }\n\n  /**\n   * Sets the element at an index. Resizes the array if index is greater than the length of the array.\n   *\n   * @param {Number} index The index to set.\n   * @param {*} element The element to set at index.\n   */\n  set(index, element) {\n    assert(index >= 0);\n\n    if (index >= this.length) {\n      this.length = index + 1;\n    }\n\n    if (this._map.has(this._array[index])) {\n      this._map.delete(this._array[index]);\n    }\n\n    this._array[index] = element;\n    this._map.set(element, index);\n  }\n\n  delete(element) {\n    const index = this._map.get(element);\n    if (index >= 0) {\n      this._array.splice(index, 1);\n      this._map.delete(element);\n      this.length--;\n    }\n  }\n\n  /**\n   * Returns the last element in the array without modifying the array.\n   *\n   * @returns {*} The last element in the array.\n   */\n  peek() {\n    return this._array[this._length - 1];\n  }\n\n  /**\n   * Push an element into the array.\n   *\n   * @param {*} element The element to push.\n   */\n  push(element) {\n    if (!this._map.has(element)) {\n      const index = this.length++;\n      this._array[index] = element;\n      this._map.set(element, index);\n    }\n  }\n\n  /**\n   * Pop an element from the array.\n   *\n   * @returns {*} The last element in the array.\n   */\n  pop() {\n    const element = this._array[--this.length];\n    this._map.delete(element);\n    return element;\n  }\n\n  /**\n   * Resize the internal array if length > _array.length.\n   *\n   * @param {Number} length The length.\n   */\n  reserve(length) {\n    assert(length >= 0);\n\n    if (length > this._array.length) {\n      this._array.length = length;\n    }\n  }\n\n  /**\n   * Resize the array.\n   *\n   * @param {Number} length The length.\n   */\n  resize(length) {\n    assert(length >= 0);\n\n    this.length = length;\n  }\n\n  /**\n   * Trim the internal array to the specified length. Defaults to the current length.\n   *\n   * @param {Number} [length] The length.\n   */\n  trim(length) {\n    if (length === null || length === undefined) {\n      length = this.length;\n    }\n    this._array.length = length;\n  }\n\n  reset() {\n    this._array = [];\n    this._map = new Map();\n    this._length = 0;\n  }\n\n  find(target) {\n    return this._map.has(target);\n  }\n}\n","// This file is derived from the Cesium code base under Apache 2 license\n// See LICENSE.md and https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md\n\nimport {TILE3D_OPTIMIZATION_HINT, TILE_REFINEMENT} from '../../constants';\nimport TilesetTraverser from './tileset-traverser';\n\nexport default class Tileset3DTraverser extends TilesetTraverser {\n  compareDistanceToCamera(a, b) {\n    // Sort by farthest child first since this is going on a stack\n    return b._distanceToCamera === 0 && a._distanceToCamera === 0\n      ? b._centerZDepth - a._centerZDepth\n      : b._distanceToCamera - a._distanceToCamera;\n  }\n\n  updateTileVisibility(tile, frameState) {\n    super.updateTileVisibility(tile, frameState);\n\n    //  Optimization - if none of the tile's children are visible then this tile isn't visible\n    if (!tile.isVisibleAndInRequestVolume) {\n      return;\n    }\n\n    const hasChildren = tile.children.length > 0;\n    if (tile.hasTilesetContent && hasChildren) {\n      // Use the root tile's visibility instead of this tile's visibility.\n      // The root tile may be culled by the children bounds optimization in which\n      // case this tile should also be culled.\n      const firstChild = tile.children[0];\n      this.updateTileVisibility(firstChild, frameState);\n      tile._visible = firstChild._visible;\n      return;\n    }\n\n    if (this.meetsScreenSpaceErrorEarly(tile, frameState)) {\n      tile._visible = false;\n      return;\n    }\n\n    const replace = tile.refine === TILE_REFINEMENT.REPLACE;\n    const useOptimization =\n      tile._optimChildrenWithinParent === TILE3D_OPTIMIZATION_HINT.USE_OPTIMIZATION;\n    if (replace && useOptimization && hasChildren) {\n      if (!this.anyChildrenVisible(tile, frameState)) {\n        tile._visible = false;\n        return;\n      }\n    }\n  }\n\n  meetsScreenSpaceErrorEarly(tile, frameState) {\n    const {parent} = tile;\n    if (!parent || parent.hasTilesetContent || parent.refine !== TILE_REFINEMENT.ADD) {\n      return false;\n    }\n\n    // Use parent's geometric error with child's box to see if the tile already meet the SSE\n    return !this.shouldRefine(tile, frameState, true);\n  }\n}\n","import {load} from '@loaders.gl/core';\nimport TilesetTraverser from './tileset-traverser';\n\nimport {lodJudge} from '../helpers/i3s-lod';\nimport TileHeader from '../tile-3d';\nimport I3STileManager from './i3s-tile-manager';\n\nexport default class I3STilesetTraverser extends TilesetTraverser {\n  private _tileManager: I3STileManager;\n\n  constructor(options) {\n    super(options);\n    this._tileManager = new I3STileManager();\n  }\n\n  shouldRefine(tile, frameState) {\n    // TODO refactor loaJudge\n    tile._lodJudge = lodJudge(tile, frameState);\n    return tile._lodJudge === 'DIG';\n  }\n\n  updateChildTiles(tile, frameState): boolean {\n    const children = tile.header.children || [];\n    // children which are already fetched and constructed as Tile3D instances\n    const childTiles = tile.children;\n    const tileset = tile.tileset;\n\n    for (const child of children) {\n      const extendedId = `${child.id}-${frameState.viewport.id}`;\n      // if child tile is not fetched\n      const childTile = childTiles && childTiles.find((t) => t.id === extendedId);\n      if (!childTile) {\n        let request = () => this._loadTile(child.id, tileset);\n        const cachedRequest = this._tileManager.find(extendedId);\n        if (!cachedRequest) {\n          // eslint-disable-next-line max-depth\n          if (tileset.tileset.nodePages) {\n            request = () => tileset.tileset.nodePagesTile.formTileFromNodePages(child.id);\n          }\n          this._tileManager.add(\n            request,\n            extendedId,\n            (header) => this._onTileLoad(header, tile, extendedId),\n            frameState\n          );\n        } else {\n          // update frameNumber since it is still needed in current frame\n          this._tileManager.update(extendedId, frameState);\n        }\n      } else if (childTile) {\n        // if child tile is fetched and available\n        this.updateTile(childTile, frameState);\n      }\n    }\n    return false;\n  }\n\n  async _loadTile(nodeId, tileset) {\n    const {loader} = tileset;\n    const nodeUrl = tileset.getTileUrl(`${tileset.url}/nodes/${nodeId}`);\n    // load metadata\n    const options = {\n      ...tileset.loadOptions,\n      i3s: {\n        ...tileset.loadOptions.i3s,\n        isTileHeader: true,\n        loadContent: false\n      }\n    };\n\n    return await load(nodeUrl, loader, options);\n  }\n\n  /**\n   * The callback to init TileHeader instance after loading the tile JSON\n   * @param {Object} header - the tile JSON from a dataset\n   * @param {TileHeader} tile - the parent TileHeader instance\n   * @param {string} extendedId - optional ID to separate copies of a tile for different viewports.\n   *                              const extendedId = `${tile.id}-${frameState.viewport.id}`;\n   * @return {void}\n   */\n  _onTileLoad(header, tile, extendedId) {\n    // after child tile is fetched\n    const childTile = new TileHeader(tile.tileset, header, tile, extendedId);\n    tile.children.push(childTile);\n    const frameState = this._tileManager.find(childTile.id).frameState;\n    this.updateTile(childTile, frameState);\n\n    // after tile fetched, resume traversal if still in current update/traversal frame\n    if (this._frameNumber === frameState.frameNumber) {\n      this.executeTraversal(childTile, frameState);\n    }\n  }\n}\n","const STATUS = {\n  REQUESTED: 'REQUESTED',\n  COMPLETED: 'COMPLETED',\n  ERROR: 'ERROR'\n};\n\n// A helper class to manage tile metadata fetching\nexport default class I3STileManager {\n  private _statusMap: object;\n\n  constructor() {\n    this._statusMap = {};\n  }\n\n  add(request, key, callback, frameState) {\n    if (!this._statusMap[key]) {\n      this._statusMap[key] = {request, callback, key, frameState, status: STATUS.REQUESTED};\n      request()\n        .then((data) => {\n          this._statusMap[key].status = STATUS.COMPLETED;\n          this._statusMap[key].callback(data, frameState);\n        })\n        .catch((error) => {\n          this._statusMap[key].status = STATUS.ERROR;\n          callback(error);\n        });\n    }\n  }\n\n  update(key, frameState) {\n    if (this._statusMap[key]) {\n      this._statusMap[key].frameState = frameState;\n    }\n  }\n\n  find(key) {\n    return this._statusMap[key];\n  }\n}\n","import checkIfBrowser from '../env/is-browser';\nexport { self, window, global, document, process, console } from '../env/globals';\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\nexport const isBrowser = checkIfBrowser();\n//# sourceMappingURL=globals.js.map","function getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport default class LocalStorage {\n  constructor(id, defaultSettings, type = 'sessionStorage') {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = {};\n    Object.assign(this.config, defaultSettings);\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    this.config = {};\n    return this.updateConfiguration(configuration);\n  }\n\n  updateConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n\n    return this;\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}\n//# sourceMappingURL=local-storage.js.map","export function formatTime(ms) {\n  let formatted;\n\n  if (ms < 10) {\n    formatted = \"\".concat(ms.toFixed(2), \"ms\");\n  } else if (ms < 100) {\n    formatted = \"\".concat(ms.toFixed(1), \"ms\");\n  } else if (ms < 1000) {\n    formatted = \"\".concat(ms.toFixed(0), \"ms\");\n  } else {\n    formatted = \"\".concat((ms / 1000).toFixed(2), \"s\");\n  }\n\n  return formatted;\n}\nexport function leftPad(string, length = 8) {\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(' '.repeat(padLength)).concat(string);\n}\nexport function rightPad(string, length = 8) {\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(string).concat(' '.repeat(padLength));\n}\nexport function formatValue(v, opts = {}) {\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\nfunction formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatImage(image, message, scale, maxWidth = 600) {\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n  const style = ['font-size:1px;', \"padding:\".concat(Math.floor(height / 2), \"px \").concat(Math.floor(width / 2), \"px;\"), \"line-height:\".concat(height, \"px;\"), \"background:url(\".concat(imageUrl, \");\"), \"background-size:\".concat(width, \"px \").concat(height, \"px;\"), 'color:transparent;'].join('');\n  return [\"\".concat(message, \" %c+\"), style];\n}\n//# sourceMappingURL=formatters.js.map","import { isBrowser } from './globals';\nexport const COLOR = {\n  BLACK: 30,\n  RED: 31,\n  GREEN: 32,\n  YELLOW: 33,\n  BLUE: 34,\n  MAGENTA: 35,\n  CYAN: 36,\n  WHITE: 37,\n  BRIGHT_BLACK: 90,\n  BRIGHT_RED: 91,\n  BRIGHT_GREEN: 92,\n  BRIGHT_YELLOW: 93,\n  BRIGHT_BLUE: 94,\n  BRIGHT_MAGENTA: 95,\n  BRIGHT_CYAN: 96,\n  BRIGHT_WHITE: 97\n};\n\nfunction getColor(color) {\n  return typeof color === 'string' ? COLOR[color.toUpperCase()] || COLOR.WHITE : color;\n}\n\nexport function addColor(string, color, background) {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      color = getColor(color);\n      string = \"\\x1B[\".concat(color, \"m\").concat(string, \"\\x1B[39m\");\n    }\n\n    if (background) {\n      color = getColor(background);\n      string = \"\\x1B[\".concat(background + 10, \"m\").concat(string, \"\\x1B[49m\");\n    }\n  }\n\n  return string;\n}\n//# sourceMappingURL=color.js.map","export function autobind(obj, predefined = ['constructor']) {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  for (const key of propNames) {\n    if (typeof obj[key] === 'function') {\n      if (!predefined.find(name => key === name)) {\n        obj[key] = obj[key].bind(obj);\n      }\n    }\n  }\n}\n//# sourceMappingURL=autobind.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { window, process, isBrowser } from './globals';\nexport default function getHiResTimestamp() {\n  let timestamp;\n\n  if (isBrowser && window.performance) {\n    timestamp = window.performance.now();\n  } else if (process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import { VERSION, isBrowser } from '../utils/globals';\nimport LocalStorage from '../utils/local-storage';\nimport { formatImage, formatTime, leftPad } from '../utils/formatters';\nimport { addColor } from '../utils/color';\nimport { autobind } from '../utils/autobind';\nimport assert from '../utils/assert';\nimport getHiResTimestamp from '../utils/hi-res-timestamp';\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\nconst DEFAULT_SETTINGS = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\nconst ONCE = {\n  once: true\n};\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n\n  return 'empty';\n}\n\nexport default class Log {\n  constructor({\n    id\n  } = {\n    id: ''\n  }) {\n    this.id = id;\n    this.VERSION = VERSION;\n    this._startTs = getHiResTimestamp();\n    this._deltaTs = getHiResTimestamp();\n    this.LOG_THROTTLE_TIMEOUT = 0;\n    this._storage = new LocalStorage(\"__probe-\".concat(this.id, \"__\"), DEFAULT_SETTINGS);\n    this.userData = {};\n    this.timeStamp(\"\".concat(this.id, \" started\"));\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel) {\n    this.setLevel(newLevel);\n  }\n\n  get level() {\n    return this.getLevel();\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getLevel() {\n    return this._storage.config.level;\n  }\n\n  getTotal() {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  getDelta() {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  set priority(newPriority) {\n    this.level = newPriority;\n  }\n\n  get priority() {\n    return this.level;\n  }\n\n  getPriority() {\n    return this.level;\n  }\n\n  enable(enabled = true) {\n    this._storage.updateConfiguration({\n      enabled\n    });\n\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.updateConfiguration({\n      level\n    });\n\n    return this;\n  }\n\n  assert(condition, message) {\n    assert(condition, message);\n  }\n\n  warn(message) {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  error(message) {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(\"`\".concat(oldUsage, \"` is deprecated and will be removed in a later version. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(\"`\".concat(oldUsage, \"` has been removed. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  probe(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  log(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  info(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  once(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug || originalConsole.info, arguments, ONCE);\n  }\n\n  table(logLevel, table, columns) {\n    if (table) {\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n\n    return noop;\n  }\n\n  image({\n    logLevel,\n    priority,\n    image,\n    message = '',\n    scale = 1\n  }) {\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n\n    return isBrowser ? logImageInBrowser({\n      image,\n      message,\n      scale\n    }) : logImageInNode({\n      image,\n      message,\n      scale\n    });\n  }\n\n  settings() {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  get(setting) {\n    return this._storage.config[setting];\n  }\n\n  set(setting, value) {\n    this._storage.updateConfiguration({\n      [setting]: value\n    });\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeEnd ? console.timeEnd : console.info);\n  }\n\n  timeStamp(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {\n    collapsed: false\n  }) {\n    opts = normalizeArguments({\n      logLevel,\n      message,\n      opts\n    });\n    const {\n      collapsed\n    } = opts;\n    opts.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n    return this._getLogFunction(opts);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {\n      collapsed: true\n    }));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  withGroup(logLevel, message, func) {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  _shouldLog(logLevel) {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(logLevel, message, method, args = [], opts) {\n    if (this._shouldLog(logLevel)) {\n      opts = normalizeArguments({\n        logLevel,\n        message,\n        args,\n        opts\n      });\n      method = method || opts.method;\n      assert(method);\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      this._deltaTs = getHiResTimestamp();\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      message = decorateMessage(this.id, opts.message, opts);\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n}\nLog.VERSION = VERSION;\n\nfunction normalizeLogLevel(logLevel) {\n  if (!logLevel) {\n    return 0;\n  }\n\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n  return resolvedLevel;\n}\n\nexport function normalizeArguments(opts) {\n  const {\n    logLevel,\n    message\n  } = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n  const args = opts.args ? Array.from(opts.args) : [];\n\n  while (args.length && args.shift() !== message) {}\n\n  opts.args = args;\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n\n  const messageType = typeof opts.message;\n  assert(messageType === 'string' || messageType === 'object');\n  return Object.assign(opts, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? \"\".concat(id, \": \").concat(time, \"  \").concat(message) : \"\".concat(id, \": \").concat(message);\n    message = addColor(message, opts.color, opts.background);\n  }\n\n  return message;\n}\n\nfunction logImageInNode({\n  image,\n  message = '',\n  scale = 1\n}) {\n  let asciify = null;\n\n  try {\n    asciify = module.require('asciify-image');\n  } catch (error) {}\n\n  if (asciify) {\n    return () => asciify(image, {\n      fit: 'box',\n      width: \"\".concat(Math.round(80 * scale), \"%\")\n    }).then(data => console.log(data));\n  }\n\n  return noop;\n}\n\nfunction logImageInBrowser({\n  image,\n  message = '',\n  scale = 1\n}) {\n  if (typeof image === 'string') {\n    const img = new Image();\n\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n\n    img.src = image;\n    return noop;\n  }\n\n  const element = image.nodeName || '';\n\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n\n    img.onload = () => console.log(...formatImage(img, message, scale));\n\n    img.src = image.toDataURL();\n    return noop;\n  }\n\n  return noop;\n}\n//# sourceMappingURL=log.js.map","import { window } from './globals';\nimport isBrowser from './is-browser';\nimport isElectron from './is-electron';\nexport function isMobile() {\n  return typeof window.orientation !== 'undefined';\n}\nexport default function getBrowser(mockUserAgent) {\n  if (!mockUserAgent && !isBrowser()) {\n    return 'Node';\n  }\n\n  if (isElectron(mockUserAgent)) {\n    return 'Electron';\n  }\n\n  const navigator_ = typeof navigator !== 'undefined' ? navigator : {};\n  const userAgent = mockUserAgent || navigator_.userAgent || '';\n\n  if (userAgent.indexOf('Edge') > -1) {\n    return 'Edge';\n  }\n\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n\n  if (isMSIE || isTrident) {\n    return 'IE';\n  }\n\n  if (window.chrome) {\n    return 'Chrome';\n  }\n\n  if (window.safari) {\n    return 'Safari';\n  }\n\n  if (window.mozInnerScreenX) {\n    return 'Firefox';\n  }\n\n  return 'Unknown';\n}\n//# sourceMappingURL=get-browser.js.map","import './init';\nimport { default as Log } from './lib/log';\nexport { VERSION } from './utils/globals';\nexport { self, window, global, document, process, console } from './env/globals';\nexport { default as isBrowser, isBrowserMainThread } from './env/is-browser';\nexport { default as getBrowser, isMobile } from './env/get-browser';\nexport { default as isElectron } from './env/is-electron';\nexport { default as assert } from './utils/assert';\nexport { default as Log } from './lib/log';\nexport { COLOR } from './utils/color';\nexport default new Log({\n  id: 'probe.gl'\n});\nexport { addColor } from './utils/color';\nexport { leftPad, rightPad } from './utils/formatters';\nexport { autobind } from './utils/autobind';\nexport { default as LocalStorage } from './utils/local-storage';\nexport { default as getHiResTimestamp } from './utils/hi-res-timestamp';\nexport { Stats, Stat } from '@probe.gl/stats';\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}