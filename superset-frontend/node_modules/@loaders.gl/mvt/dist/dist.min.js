!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";t.exports=r;var i=n(4);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function o(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function c(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function x(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function v(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=7&i,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=w(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=w(this.buf,this.pos)+4294967296*b(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,s=n.buf;if(r=s[n.pos++],i=(112&r)>>4,r<128)return a(t,i,e);if(r=s[n.pos++],i|=(127&r)<<3,r<128)return a(t,i,e);if(r=s[n.pos++],i|=(127&r)<<10,r<128)return a(t,i,e);if(r=s[n.pos++],i|=(127&r)<<17,r<128)return a(t,i,e);if(r=s[n.pos++],i|=(127&r)<<24,r<128)return a(t,i,e);if(r=s[n.pos++],i|=(1&r)<<31,r<128)return a(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&s?function(t,e,n){return s.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var i="",r=e;for(;r<n;){var s,o,a,u=t[r],h=null,l=u>239?4:u>223?3:u>191?2:1;if(r+l>n)break;1===l?u<128&&(h=u):2===l?128==(192&(s=t[r+1]))&&(h=(31&u)<<6|63&s)<=127&&(h=null):3===l?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((h=(15&u)<<12|(63&s)<<6|63&o)<=2047||h>=55296&&h<=57343)&&(h=null)):4===l&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,l=1):h>65535&&(h-=65536,i+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),i+=String.fromCharCode(h),r+=l}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var n=o(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,s=0;s<e.length;s++){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){i>56319||s+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&u(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&u(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,x,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,g,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},,function(t,e,n){(function(e){const i=n(5),r="undefined"==typeof window?e:window;r.loaders=r.loaders||{},t.exports=Object.assign(r.loaders,i)}).call(this,n(3))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,u=(1<<a)-1,h=u>>1,l=-7,f=n?r-1:0,p=n?-1:1,c=t[e+f];for(f+=p,s=c&(1<<-l)-1,c>>=-l,l+=a;l>0;s=256*s+t[e+f],f+=p,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=256*o+t[e+f],f+=p,l-=8);if(0===s)s=1-h;else{if(s===u)return o?NaN:1/0*(c?-1:1);o+=Math.pow(2,i),s-=h}return(c?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,u,h=8*s-r-1,l=(1<<h)-1,f=l>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,c=i?0:s-1,d=i?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*u-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[n+c]=255&a,c+=d,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[n+c]=255&o,c+=d,o/=256,h-=8);t[n+c-d]|=128*y}},function(t,e,n){"use strict";n.r(e),n.d(e,"MVTLoader",(function(){return dt})),n.d(e,"MVTWorkerLoader",(function(){return ct}));class i{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(s,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,i=0,r=0,s=0;const o=[];let a;for(;t.pos<e;){if(i<=0){const e=t.readVarint();n=7&e,i=e>>3}if(i--,1===n||2===n)r+=t.readSVarint(),s+=t.readSVarint(),1===n&&(a&&o.push(a),a=[]),a.push([r,s]);else{if(7!==n)throw new Error("unknown command "+n);a&&a.push(a[0].slice())}}return a&&o.push(a),o}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,i=0,r=0,s=0,o=1/0,a=-1/0,u=1/0,h=-1/0;for(;t.pos<e;){if(i<=0){const e=t.readVarint();n=7&e,i=e>>3}if(i--,1===n||2===n)r+=t.readSVarint(),s+=t.readSVarint(),r<o&&(o=r),r>a&&(a=r),s<u&&(u=s),s>h&&(h=s);else if(7!==n)throw new Error("unknown command "+n)}return[o,u,a,h]}_toGeoJSON(t){let e,n,s=this.loadGeometry(),o=i.types[this.type];switch(this.type){case 1:var a=[];for(e=0;e<s.length;e++)a[e]=s[e][0];s=a,t(s,this);break;case 2:for(e=0;e<s.length;e++)t(s[e],this);break;case 3:for(s=function(t){const e=t.length;if(e<=1)return[t];const n=[];let i,s;for(let o=0;o<e;o++){const e=r(t[o]);0!==e&&(void 0===s&&(s=e<0),s===e<0?(i&&n.push(i),i=[t[o]]):i.push(t[o]))}i&&n.push(i);return n}(s),e=0;e<s.length;e++)for(n=0;n<s[e].length;n++)t(s[e][n],this)}1===s.length?s=s[0]:o="Multi"+o;const u={type:"Feature",geometry:{type:o,coordinates:s},properties:this.properties};return null!==this.id&&(u.id=this.id),u}toGeoJSON(t){if("function"==typeof t)return this._toGeoJSON(t);const{x:e,y:n,z:i}=t,r=this.extent*Math.pow(2,i),s=this.extent*e,o=this.extent*n;return this._toGeoJSON((function(t){for(let e=0;e<t.length;e++){const n=t[e];n[0]=360*(n[0]+s)/r-180;const i=180-360*(n[1]+o)/r;n[1]=360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90}}))}}function r(t){let e=0;for(let n,i,r=0,s=t.length-1;r<t.length;s=r++)n=t[r],i=t[s],e+=(i[0]-n[0])*(n[1]+i[1]);return e}function s(t,e,n){1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos)}class o{constructor(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(a,this,e),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,e,this.extent,this._keys,this._values)}}function a(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(n))}class u{constructor(t,e){this.layers=t.readFields(h,{},e)}}function h(t,e,n){if(3===t){const t=new o(n,n.readVarint()+n.pos);t.length&&(e[t.name]=t)}}Math.PI,Math.PI;const l={};l.EPSILON=1e-12,l.debug=!1,l.precision=4,l.printTypes=!1,l.printDegrees=!1,l.printRowMajor=!0;function f(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let s=0;for(let e=n,o=i-r;e<i;e+=r)s+=(t[e]-t[o])*(t[e+1]+t[o+1]),o=e;return s/2}function p(t,e,n,i){n=n||2;const r=e&&e.length,s=r?e[0]*n:t.length;let o=c(t,0,s,n,!0,i&&i[0]);const a=[];if(!o||o.next===o.prev)return a;let u,h,l,f,p,x,g;if(r&&(o=function(t,e,n,i,r){const s=[];let o,a,u,h,l;for(o=0,a=e.length;o<a;o++)u=e[o]*i,h=o<a-1?e[o+1]*i:t.length,l=c(t,u,h,i,!1,r&&r[o+1]),l===l.next&&(l.steiner=!0),s.push(V(l));for(s.sort(b),o=0;o<s.length;o++)P(s[o],n),n=d(n,n.next);return n}(t,e,o,n,i)),t.length>80*n){f=h=t[0],p=l=t[1];for(let e=n;e<s;e+=n)x=t[e],g=t[e+1],x<f&&(f=x),g<p&&(p=g),x>h&&(h=x),g>l&&(l=g);u=Math.max(h-f,l-p),u=0!==u?1/u:0}return y(o,a,n,f,p,u),a}function c(t,e,n,i,r,s){let o,a;if(void 0===s&&(s=f(t,{start:e,end:n,size:i})),r===s<0)for(o=e;o<n;o+=i)a=Z(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=Z(o,t[o],t[o+1],a);return a&&I(a,a.next)&&(A(a),a=a.next),a}function d(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!I(i,i.next)&&0!==M(i.prev,i,i.next))i=i.next;else{if(A(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function y(t,e,n,i,r,s,o){if(!t)return;!o&&s&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=m(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,s,o,a,u,h=1;do{for(r=t,t=null,u=null,i=0;r;){for(i++,o=r,s=0,n=0;n<h&&(s++,o=o.nextZ,o);n++);for(a=h;s>0||a>0&&o;)0!==s&&(0===a||!o||r.z<=o.z)?(e=r,r=r.nextZ,s--):(e=o,o=o.nextZ,a--),u?u.nextZ=e:t=e,e.prevZ=u,u=e;r=o}u.nextZ=null,h*=2}while(i>1)}(r)}(t,i,r,s);let a,u,h=t;for(;t.prev!==t.next;)if(a=t.prev,u=t.next,s?g(t,i,r,s):x(t))e.push(a.i/n),e.push(t.i/n),e.push(u.i/n),A(t),t=u.next,h=u.next;else if((t=u)===h){o?1===o?y(t=w(d(t),e,n),e,n,i,r,s,2):2===o&&v(t,e,n,i,r,s):y(d(t),e,n,i,r,s,1);break}}function x(t){const e=t.prev,n=t,i=t.next;if(M(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(_(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&M(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function g(t,e,n,i){const r=t.prev,s=t,o=t.next;if(M(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,u=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,f=m(a,u,e,n,i),p=m(h,l,e,n,i);let c=t.prevZ,d=t.nextZ;for(;c&&c.z>=f&&d&&d.z<=p;){if(c!==t.prev&&c!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,c.x,c.y)&&M(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,d!==t.prev&&d!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&M(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;c&&c.z>=f;){if(c!==t.prev&&c!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,c.x,c.y)&&M(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&M(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function w(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!I(r,s)&&k(r,i,i.next,s)&&z(r,s)&&z(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),A(i),A(i.next),i=t=s),i=i.next}while(i!==t);return d(i)}function v(t,e,n,i,r,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&S(o,t)){let a=D(o,t);return o=d(o,o.next),a=d(a,a.next),y(o,e,n,i,r,s),void y(a,e,n,i,r,s)}t=t.next}o=o.next}while(o!==t)}function b(t,e){return t.x-e.x}function P(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let s,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>o){if(o=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(i===o)return s;const a=s,u=s.x,h=s.y;let l,f=1/0;n=s;do{i>=n.x&&n.x>=u&&i!==n.x&&_(r<h?i:o,r,u,h,r<h?o:i,r,n.x,n.y)&&(l=Math.abs(r-n.y)/(i-n.x),z(n,t)&&(l<f||l===f&&(n.x>s.x||n.x===s.x&&F(s,n)))&&(s=n,f=l)),n=n.next}while(n!==a);return s}(t,e)){const n=D(e,t);d(e,e.next),d(n,n.next)}}function F(t,e){return M(t.prev,t,e.prev)<0&&M(e.next,t,t.next)<0}function m(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function V(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function _(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function S(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&k(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(z(t,e)&&z(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(M(t.prev,t,e.prev)||M(t,e.prev,e))||I(t,e)&&M(t.prev,t,t.next)>0&&M(e.prev,e,e.next)>0)}function M(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function I(t,e){return t.x===e.x&&t.y===e.y}function k(t,e,n,i){const r=C(M(t,e,n)),s=C(M(t,e,i)),o=C(M(n,i,t)),a=C(M(n,i,e));return r!==s&&o!==a||(!(0!==r||!B(t,n,e))||(!(0!==s||!B(t,i,e))||(!(0!==o||!B(n,t,i))||!(0!==a||!B(n,e,i)))))}function B(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function C(t){return t>0?1:t<0?-1:0}function z(t,e){return M(t.prev,t,t.next)<0?M(t,e,t.next)>=0&&M(t,t.prev,e)>=0:M(t,e,t.prev)<0||M(t,t.next,e)<0}function D(t,e){const n=new T(t.i,t.x,t.y),i=new T(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Z(t,e,n,i){const r=new T(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function T(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}let N,O,j,U,L,E,G;class R{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,e,n,i,r,s){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,this._firstPassData=s,t.readFields(K,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry,N=t.readVarint()+t.pos,O=1,U=0,L=0,E=0,G=0;const e=[],n=[];for(;t.pos<N;)if(U<=0&&(j=t.readVarint(),O=7&j,U=j>>3),U--,1===O||2===O)L+=t.readSVarint(),E+=t.readSVarint(),1===O&&e.push(G),n.push(L,E),G+=2;else{if(7!==O)throw new Error("unknown command "+O);if(G>0){const t=e[e.length-1];n.push(n[t],n[t+1]),G+=2}}return{data:n,lines:e}}_toBinaryCoordinates(t){let e=this.loadGeometry();t(e.data,this);switch(this.type){case 1:this._firstPassData.pointFeaturesCount++,this._firstPassData.pointPositionsCount+=e.lines.length;break;case 2:this._firstPassData.lineFeaturesCount++,this._firstPassData.linePathsCount+=e.lines.length,this._firstPassData.linePositionsCount+=e.data.length/2;break;case 3:const t=J(e);this._firstPassData.polygonFeaturesCount++,this._firstPassData.polygonObjectsCount+=t.lines.length;for(const e of t.lines)this._firstPassData.polygonRingsCount+=e.length;this._firstPassData.polygonPositionsCount+=t.data.length/2,e=t}e.type=R.types[this.type],e.lines.length>1&&(e.type="Multi"+e.type);const n={type:"Feature",geometry:e,properties:this.properties};return null!==this.id&&(n.id=this.id),n}toBinaryCoordinates(t){if("function"==typeof t)return this._toBinaryCoordinates(t);const{x:e,y:n,z:i}=t,r=this.extent*Math.pow(2,i),s=this.extent*e,o=this.extent*n;return this._toBinaryCoordinates((function(t){for(let e=0,n=t.length;e<n;e+=2){t[e]=360*(t[e]+s)/r-180;const n=180-360*(t[e+1]+o)/r;t[e+1]=360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}}))}}function J(t){const e=t.lines.length;if(e<=1)return{data:t.data,areas:[[f(t.data)]],lines:[t.lines]};const n=[],i=[];let r,s,o,a=0;for(let u,h,l=0;l<e;l++){u=t.lines[l]-a,h=t.lines[l+1]-a||t.data.length;const e=f(t.data.slice(u,h));if(0!==e)void 0===o&&(o=e<0),o===e<0?(s&&(n.push(r),i.push(s)),s=[u],r=[e]):(r.push(e),s.push(u));else{const e=t.data.slice(0,u),n=t.data.slice(h);t.data=e.concat(n),a+=h-u}}return r&&n.push(r),s&&i.push(s),{areas:n,lines:i,data:t.data}}function K(t,e,n){1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos)}class W{constructor(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(q,this,e),this.length=this._features.length}feature(t,e){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new R(this._pbf,n,this.extent,this._keys,this._values,e)}}function q(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(n))}class H{constructor(t,e){this.layers=t.readFields(Q,{},e)}}function Q(t,e,n){if(3===t){const t=new W(n,n.readVarint()+n.pos);t.length&&(e[t.name]=t)}}function X(t){const e={};for(const n of t)if(n.properties)for(const t in n.properties){const i=e[t];if(i||void 0===i){const i=n.properties[t];e[t]=st(i)}}return Object.keys(e).filter(t=>e[t])}function Y(t,e={},n={}){const{pointPositionsCount:i,pointFeaturesCount:r,linePositionsCount:s,linePathsCount:o,lineFeaturesCount:a,polygonPositionsCount:u,polygonObjectsCount:h,polygonRingsCount:l,polygonFeaturesCount:f}=e,{numericPropKeys:p,PositionDataType:c=Float32Array}=n,d=t[0]&&"id"in t[0],y=t.length>65535?Uint32Array:Uint16Array,x={positions:new c(2*i),globalFeatureIds:new y(i),featureIds:r>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[],fields:[]},g={pathIndices:s>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new c(2*s),globalFeatureIds:new y(s),featureIds:a>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},w={polygonIndices:u>65535?new Uint32Array(h+1):new Uint16Array(h+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new c(2*u),triangles:[],globalFeatureIds:new y(u),featureIds:f>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]};for(const t of[x,g,w])for(const e of p)t.numericProps[e]=new Float32Array(t.positions.length/2);g.pathIndices[o]=s,w.polygonIndices[h]=u,w.primitivePolygonIndices[l]=u;const v={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const e of t){const t=e.geometry,n=e.properties||{};switch(t.type){case"Point":case"MultiPoint":$(t,x,v,2,n),x.properties.push(rt(n,p)),d&&x.fields.push({id:e.id}),v.pointFeature++;break;case"LineString":case"MultiLineString":tt(t,g,v,2,n),g.properties.push(rt(n,p)),d&&g.fields.push({id:e.id}),v.lineFeature++;break;case"Polygon":case"MultiPolygon":et(t,w,v,2,n),w.properties.push(rt(n,p)),d&&w.fields.push({id:e.id}),v.polygonFeature++;break;default:throw new Error("Invalid geometry type")}v.feature++}return function(t,e,n,i){const r={points:{...t,positions:{value:t.positions,size:i},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1}},lines:{...e,pathIndices:{value:e.pathIndices,size:1},positions:{value:e.positions,size:i},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1}},polygons:{...n,polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},positions:{value:n.positions,size:i},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1}}};for(const t in r)for(const e in r[t].numericProps)r[t].numericProps[e]={value:r[t].numericProps[e],size:1};return r}(x,g,w,2)}function $(t,e,n,i,r){e.positions.set(t.data,n.pointPosition*i);const s=t.data.length/i;it(e,r,n.pointPosition,s),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+s),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+s),n.pointPosition+=s}function tt(t,e,n,i,r){e.positions.set(t.data,n.linePosition*i);const s=t.data.length/i;it(e,r,n.linePosition,s),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+s),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+s);for(let r=0,s=t.lines.length;r<s;++r){const o=t.lines[r],a=r===s-1?t.data.length:t.lines[r+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(a-o)/i}}function et(t,e,n,i,r){e.positions.set(t.data,n.polygonPosition*i);const s=t.data.length/i;it(e,r,n.polygonPosition,s),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+s),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+s);for(let r=0,s=t.lines.length;r<s;++r){const s=n.polygonPosition;e.polygonIndices[n.polygonObject++]=s;const o=t.areas[r],a=t.lines[r],u=t.lines[r+1];for(let r=0,s=a.length;r<s;++r){const o=a[r],h=r===s-1?void 0===u?t.data.length:u[0]:a[r+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(h-o)/i}nt(e,o,a,{startPosition:s,endPosition:n.polygonPosition,coordLength:i})}}function nt(t,e,n,{startPosition:i,endPosition:r,coordLength:s}){const o=i*s,a=r*s,u=t.positions.subarray(o,a),h=n[0],l=p(u,n.slice(1).map(t=>(t-h)/s),s,e);for(let e=0,n=l.length;e<n;++e)t.triangles.push(i+l[e])}function it(t,e,n,i){for(const r in t.numericProps)r in e&&t.numericProps[r].fill(e[r],n,n+i)}function rt(t,e){const n={};for(const i in t)e.includes(i)||(n[i]=t[i]);return n}function st(t){return Number.isFinite(t)}var ot=n(0),at=n.n(ot);function ut(t,e){const n="binary"===(e=function(t){const e="wgs84"===(t={...t,mvt:t.mvt||{},gis:t.gis||{}}).coordinates,{tileIndex:n}=t,i=n&&Number.isFinite(n.x)&&Number.isFinite(n.y)&&Number.isFinite(n.z);if(e&&!i)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property. Check documentation.");return t}(e)).gis.format,i=[],r={pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength>0){const s=n?new H(new at.a(t)):new u(new at.a(t)),o=e.mvt;(Array.isArray(o.layers)?o.layers:Object.keys(s.layers)).forEach(t=>{const e=s.layers[t],a={...o,layerName:t};if(e)for(let t=0;t<e.length;t++){const s=e.feature(t,r),o=n?lt(s,a):ht(s,a);i.push(o)}})}if(n){const n=function(t,e,n={}){return Y(t,e,{numericPropKeys:n.numericPropKeys||X(t),PositionDataType:n.PositionDataType||Float32Array})}(i,r,e.gis);return n.byteLength=t.byteLength,n}return i}function ht(t,e={}){const n=t.toGeoJSON("wgs84"===e.coordinates?e.tileIndex:ft);return e.layerProperty&&(n.properties[e.layerProperty]=e.layerName),n}function lt(t,e={}){const n=t.toBinaryCoordinates("wgs84"===e.coordinates?e.tileIndex:pt);return e.layerProperty&&(n.properties[e.layerProperty]=e.layerName),n}function ft(t,e){const{extent:n}=e;for(let e=0;e<t.length;e++){const i=t[e];i[0]/=n,i[1]/=n}}function pt(t,e){const{extent:n}=e;for(let e=0,i=t.length;e<i;++e)t[e]/=n}const ct={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.0.8",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null}}},dt={...ct,parse:async(t,e)=>ut(t,e),parseSync:ut,binary:!0}}])}));
//# sourceMappingURL=dist.min.js.map