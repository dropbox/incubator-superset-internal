!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document},a=i.global||i.self||i.window,o="object"!=typeof r||"[object process]"!==String(r)||r.browser,u=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);u&&parseFloat(u[1])}).call(this,n(1),n(3))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(t){const r=n(4),i="undefined"==typeof window?t:window;i.loaders=i.loaders||{},e.exports=Object.assign(i.loaders,r)}).call(this,n(1))},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,s=[],f=!1,g=-1;function m(){f&&c&&(f=!1,c.length?s=c.concat(s):g=-1,s.length&&l())}function l(){if(!f){var e=u(m);f=!0;for(var t=s.length;t;){for(c=s,s=[];++g<t;)c&&c[g].run();g=-1,t=s.length}c=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new d(e,t)),1!==s.length||f||u(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"ImageLoader",(function(){return E})),n.d(t,"ImageWriter",(function(){return k})),n.d(t,"getBinaryImageMetadata",(function(){return U})),n.d(t,"isImageTypeSupported",(function(){return f})),n.d(t,"getDefaultImageType",(function(){return g})),n.d(t,"isImage",(function(){return m})),n.d(t,"getImageType",(function(){return l})),n.d(t,"getImageSize",(function(){return d})),n.d(t,"getImageData",(function(){return p})),n.d(t,"loadImage",(function(){return V}));function r(e,t){if(!e)throw new Error(t)}var i=n(0);const{_parseImageNode:a}=i.a,o="undefined"!=typeof Image,u="undefined"!=typeof ImageBitmap,c=Boolean(a),s=!!i.b||c;function f(e){switch(e){case"auto":return u||o||s;case"imagebitmap":return u;case"image":return o;case"data":return s;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function g(){if(u)return"imagebitmap";if(o)return"image";if(s)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function m(e){return Boolean(w(e))}function l(e){const t=w(e);if(!t)throw new Error("Not an image");return t}function d(e){return p(e)}function p(e){switch(l(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function w(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}const h=/^data:image\/svg\+xml/,y=/\.svg((\?|#).*)?$/;function b(e){return e&&(h.test(e)||y.test(e))}function v(e,t){if(b(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function I(e,t,n){const r=function(e,t){if(b(t)){const t=(new TextDecoder).decode(e);return"data:image/svg+xml;base64,"+btoa(t)}return v(e,t)}(e,n),i=self.URL||self.webkitURL,a="string"!=typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise((t,r)=>{try{n.onload=()=>t(n),n.onerror=t=>r(new Error(`Could not load image ${e}: ${t}`))}catch(e){r(e)}})}(a||r,t)}finally{a&&i.revokeObjectURL(a)}}const T={};let j=!0;async function x(e,t,n){let r;if(b(n)){r=await I(e,t,n)}else r=v(e,n);const i=t&&t.imagebitmap;return await async function(e,t=null){!function(e){for(const t in e||T)return!1;return!0}(t)&&j||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(e){console.warn(e),j=!1}return await createImageBitmap(e)}(r,i)}function U(e){const t=B(e);return function(e){const t=B(e);if(!(t.byteLength>=24&&2303741511===t.getUint32(0,!1)))return null;return{mimeType:"image/png",width:t.getUint32(16,!1),height:t.getUint32(20,!1)}}(t)||function(e){const t=B(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,!1)&&255===t.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)e.add(t);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let i=2;for(;i+9<t.byteLength;){const e=t.getUint16(i,!1);if(r.has(e))return{mimeType:"image/jpeg",height:t.getUint16(i+5,!1),width:t.getUint16(i+7,!1)};if(!n.has(e))return null;i+=2,i+=t.getUint16(i,!1)}return null}(t)||function(e){const t=B(e);if(!(t.byteLength>=10&&1195984440===t.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:t.getUint16(6,!0),height:t.getUint16(8,!0)}}(t)||function(e){const t=B(e);if(!(t.byteLength>=14&&16973===t.getUint16(0,!1)&&t.getUint32(2,!0)===t.byteLength))return null;return{mimeType:"image/bmp",width:t.getUint32(18,!0),height:t.getUint32(22,!0)}}(t)}function B(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function L(e,t,n){const a=((t=t||{}).image||{}).type||"auto",{url:o}=n||{};let u;switch(function(e){switch(e){case"auto":case"data":return g();default:return f(e),e}}(a)){case"imagebitmap":u=await x(e,t,o);break;case"image":u=await I(e,t,o);break;case"data":u=await function(e,t){const{mimeType:n}=U(e)||{},{_parseImageNode:a}=i.a;return r(a),a(e,n,t)}(e,t);break;default:r(!1)}return"data"===a&&(u=p(u)),u}const E={id:"image",module:"images",name:"Images",version:"3.0.8",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:L,tests:[e=>Boolean(U(new DataView(e)))],options:{image:{type:"auto",decode:!0}}},{_encodeImageNode:D}=i.a;let M=!0;const k={name:"Images",id:"image",module:"images",version:"3.0.8",extensions:["jpeg"],options:{image:{mimeType:"image/png",jpegQuality:null}},encode:async function(e,t){return(t=t||{}).image=t.image||{},D?D(e,{type:t.image.mimeType}):async function(e,t){const{mimeType:n,jpegQuality:r}=t.image,{width:i,height:a}=d(e),o=document.createElement("canvas");o.width=i,o.height=a,function(e,t,n=0,r=0){if(0===n&&0===r&&"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=t.getContext("bitmaprenderer");if(n)return n.transferFromImageBitmap(e),t}const i=t.getContext("2d");if(e.data){const n=new Uint8ClampedArray(e.data),r=new ImageData(n,e.width,e.height);return i.putImageData(r,0,0),t}i.drawImage(e,0,0)}(e,o);const u=await new Promise(e=>{if(r&&M)try{return void o.toBlob(e,n,r)}catch(e){M=!1}o.toBlob(e,n)});if(!u)throw new Error("image encoding failed");return await u.arrayBuffer()}(e,t)}};let O="";const S={};function $(e,t,n){let i=e;"function"==typeof e&&(i=e({...t,...n})),r("string"==typeof i);const{baseUrl:a}=t;return a&&(i="/"===a[a.length-1]?`${a}${i}`:`${a}/${i}`),function(e){for(const t in S)if(e.startsWith(t)){const n=S[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${O}${e}`),e}(i)}async function P(e,t,n){if(Array.isArray(e))return await async function(e,t,n={}){const r=e.map(e=>P(e,t,n));return await Promise.all(r)}(e,t,n);if((r=e)&&"object"==typeof r)return await async function(e,t,n){const r=[],i={};for(const a in e){const o=P(e[a],t,n).then(e=>{i[a]=e});r.push(o)}return await Promise.all(r),i}(e,t,n);var r;const i=e;return await t(i,n)}async function _(e,t,n){return await async function(e,t,n={}){return await P(e,t,n)}(e,e=>A(e,t,n))}async function A(e,t,n){const r=await fetch(e,n.fetch),i=await r.arrayBuffer();return await t(i,n)}async function V(e,t={}){const n=await async function(e,t,n={}){const i=t&&t.image&&t.image.mipLevels||0;return 0!==i?await async function(e,t,n,i){const a=[];if("auto"===t){const r=$(e,n,{...i,lod:0}),o=await A(r,L,n),{width:u,height:c}=d(o);t=function({width:e,height:t}){return 1+Math.floor(Math.log2(Math.max(e,t)))}({width:u,height:c}),a.push(r)}r(t>0);for(let r=a.length;r<t;++r){const t=$(e,n,{...i,lod:r});a.push(t)}return a}(e,i,t,n):$(e,t,n)}(e,t);return await _(n,L,t)}}])}));
//# sourceMappingURL=dist.min.js.map