{"version":3,"sources":["../../src/normalize-viewport-props.js"],"names":["worldToLngLat","mod","log2","TILE_SIZE","normalizeViewportProps","width","height","longitude","latitude","zoom","pitch","bearing","minZoom","halfHeightPixels","Math","pow","minLatitude","maxLatitude"],"mappings":"AAAA,SAAQA,aAAR,QAA4B,sBAA5B;AACA,SAAQC,GAAR,EAAaC,IAAb,QAAwB,cAAxB;AAGA,MAAMC,SAAS,GAAG,GAAlB;AAIA,eAAe,SAASC,sBAAT,CAAgC;AAC7CC,EAAAA,KAD6C;AAE7CC,EAAAA,MAF6C;AAG7CC,EAAAA,SAH6C;AAI7CC,EAAAA,QAJ6C;AAK7CC,EAAAA,IAL6C;AAM7CC,EAAAA,KAAK,GAAG,CANqC;AAO7CC,EAAAA,OAAO,GAAG;AAPmC,CAAhC,EAQZ;AAED,MAAIJ,SAAS,GAAG,CAAC,GAAb,IAAoBA,SAAS,GAAG,GAApC,EAAyC;AACvCA,IAAAA,SAAS,GAAGN,GAAG,CAACM,SAAS,GAAG,GAAb,EAAkB,GAAlB,CAAH,GAA4B,GAAxC;AACD;;AACD,MAAII,OAAO,GAAG,CAAC,GAAX,IAAkBA,OAAO,GAAG,GAAhC,EAAqC;AACnCA,IAAAA,OAAO,GAAGV,GAAG,CAACU,OAAO,GAAG,GAAX,EAAgB,GAAhB,CAAH,GAA0B,GAApC;AACD;;AAGD,QAAMC,OAAO,GAAGV,IAAI,CAACI,MAAM,GAAGH,SAAV,CAApB;;AACA,MAAIM,IAAI,IAAIG,OAAZ,EAAqB;AACnBH,IAAAA,IAAI,GAAGG,OAAP;AACAJ,IAAAA,QAAQ,GAAG,CAAX;AACD,GAHD,MAGO;AAEL,UAAMK,gBAAgB,GAAGP,MAAM,GAAG,CAAT,GAAaQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYN,IAAZ,CAAtC;AACA,UAAMO,WAAW,GAAGhB,aAAa,CAAC,CAAC,CAAD,EAAIa,gBAAJ,CAAD,CAAb,CAAqC,CAArC,CAApB;;AACA,QAAIL,QAAQ,GAAGQ,WAAf,EAA4B;AAC1BR,MAAAA,QAAQ,GAAGQ,WAAX;AACD,KAFD,MAEO;AACL,YAAMC,WAAW,GAAGjB,aAAa,CAAC,CAAC,CAAD,EAAIG,SAAS,GAAGU,gBAAhB,CAAD,CAAb,CAAiD,CAAjD,CAApB;;AACA,UAAIL,QAAQ,GAAGS,WAAf,EAA4B;AAC1BT,QAAAA,QAAQ,GAAGS,WAAX;AACD;AACF;AACF;;AAED,SAAO;AAACZ,IAAAA,KAAD;AAAQC,IAAAA,MAAR;AAAgBC,IAAAA,SAAhB;AAA2BC,IAAAA,QAA3B;AAAqCC,IAAAA,IAArC;AAA2CC,IAAAA,KAA3C;AAAkDC,IAAAA;AAAlD,GAAP;AACD","sourcesContent":["import {worldToLngLat} from './web-mercator-utils';\nimport {mod, log2} from './math-utils';\n\n// defined by mapbox-gl\nconst TILE_SIZE = 512;\n\n// Apply mathematical constraints to viewport props\n// eslint-disable-next-line complexity\nexport default function normalizeViewportProps({\n  width,\n  height,\n  longitude,\n  latitude,\n  zoom,\n  pitch = 0,\n  bearing = 0\n}) {\n  // Normalize degrees\n  if (longitude < -180 || longitude > 180) {\n    longitude = mod(longitude + 180, 360) - 180;\n  }\n  if (bearing < -180 || bearing > 180) {\n    bearing = mod(bearing + 180, 360) - 180;\n  }\n\n  // Constrain zoom and shift center at low zoom levels\n  const minZoom = log2(height / TILE_SIZE);\n  if (zoom <= minZoom) {\n    zoom = minZoom;\n    latitude = 0;\n  } else {\n    // Eliminate white space above and below the map\n    const halfHeightPixels = height / 2 / Math.pow(2, zoom);\n    const minLatitude = worldToLngLat([0, halfHeightPixels])[1];\n    if (latitude < minLatitude) {\n      latitude = minLatitude;\n    } else {\n      const maxLatitude = worldToLngLat([0, TILE_SIZE - halfHeightPixels])[1];\n      if (latitude > maxLatitude) {\n        latitude = maxLatitude;\n      }\n    }\n  }\n\n  return {width, height, longitude, latitude, zoom, pitch, bearing};\n}\n"],"file":"normalize-viewport-props.js"}