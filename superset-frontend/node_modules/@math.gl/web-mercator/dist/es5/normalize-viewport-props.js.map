{"version":3,"sources":["../../src/normalize-viewport-props.js"],"names":["TILE_SIZE","normalizeViewportProps","width","height","longitude","latitude","zoom","pitch","bearing","minZoom","halfHeightPixels","Math","pow","minLatitude","maxLatitude"],"mappings":";;;;;;;AAAA;;AACA;;AAGA,IAAMA,SAAS,GAAG,GAAlB;;AAIe,SAASC,sBAAT,OAQZ;AAAA,MAPDC,KAOC,QAPDA,KAOC;AAAA,MANDC,MAMC,QANDA,MAMC;AAAA,MALDC,SAKC,QALDA,SAKC;AAAA,MAJDC,QAIC,QAJDA,QAIC;AAAA,MAHDC,IAGC,QAHDA,IAGC;AAAA,wBAFDC,KAEC;AAAA,MAFDA,KAEC,2BAFO,CAEP;AAAA,0BADDC,OACC;AAAA,MADDA,OACC,6BADS,CACT;;AAED,MAAIJ,SAAS,GAAG,CAAC,GAAb,IAAoBA,SAAS,GAAG,GAApC,EAAyC;AACvCA,IAAAA,SAAS,GAAG,oBAAIA,SAAS,GAAG,GAAhB,EAAqB,GAArB,IAA4B,GAAxC;AACD;;AACD,MAAII,OAAO,GAAG,CAAC,GAAX,IAAkBA,OAAO,GAAG,GAAhC,EAAqC;AACnCA,IAAAA,OAAO,GAAG,oBAAIA,OAAO,GAAG,GAAd,EAAmB,GAAnB,IAA0B,GAApC;AACD;;AAGD,MAAMC,OAAO,GAAG,qBAAKN,MAAM,GAAGH,SAAd,CAAhB;;AACA,MAAIM,IAAI,IAAIG,OAAZ,EAAqB;AACnBH,IAAAA,IAAI,GAAGG,OAAP;AACAJ,IAAAA,QAAQ,GAAG,CAAX;AACD,GAHD,MAGO;AAEL,QAAMK,gBAAgB,GAAGP,MAAM,GAAG,CAAT,GAAaQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYN,IAAZ,CAAtC;AACA,QAAMO,WAAW,GAAG,qCAAc,CAAC,CAAD,EAAIH,gBAAJ,CAAd,EAAqC,CAArC,CAApB;;AACA,QAAIL,QAAQ,GAAGQ,WAAf,EAA4B;AAC1BR,MAAAA,QAAQ,GAAGQ,WAAX;AACD,KAFD,MAEO;AACL,UAAMC,WAAW,GAAG,qCAAc,CAAC,CAAD,EAAId,SAAS,GAAGU,gBAAhB,CAAd,EAAiD,CAAjD,CAApB;;AACA,UAAIL,QAAQ,GAAGS,WAAf,EAA4B;AAC1BT,QAAAA,QAAQ,GAAGS,WAAX;AACD;AACF;AACF;;AAED,SAAO;AAACZ,IAAAA,KAAK,EAALA,KAAD;AAAQC,IAAAA,MAAM,EAANA,MAAR;AAAgBC,IAAAA,SAAS,EAATA,SAAhB;AAA2BC,IAAAA,QAAQ,EAARA,QAA3B;AAAqCC,IAAAA,IAAI,EAAJA,IAArC;AAA2CC,IAAAA,KAAK,EAALA,KAA3C;AAAkDC,IAAAA,OAAO,EAAPA;AAAlD,GAAP;AACD","sourcesContent":["import {worldToLngLat} from './web-mercator-utils';\nimport {mod, log2} from './math-utils';\n\n// defined by mapbox-gl\nconst TILE_SIZE = 512;\n\n// Apply mathematical constraints to viewport props\n// eslint-disable-next-line complexity\nexport default function normalizeViewportProps({\n  width,\n  height,\n  longitude,\n  latitude,\n  zoom,\n  pitch = 0,\n  bearing = 0\n}) {\n  // Normalize degrees\n  if (longitude < -180 || longitude > 180) {\n    longitude = mod(longitude + 180, 360) - 180;\n  }\n  if (bearing < -180 || bearing > 180) {\n    bearing = mod(bearing + 180, 360) - 180;\n  }\n\n  // Constrain zoom and shift center at low zoom levels\n  const minZoom = log2(height / TILE_SIZE);\n  if (zoom <= minZoom) {\n    zoom = minZoom;\n    latitude = 0;\n  } else {\n    // Eliminate white space above and below the map\n    const halfHeightPixels = height / 2 / Math.pow(2, zoom);\n    const minLatitude = worldToLngLat([0, halfHeightPixels])[1];\n    if (latitude < minLatitude) {\n      latitude = minLatitude;\n    } else {\n      const maxLatitude = worldToLngLat([0, TILE_SIZE - halfHeightPixels])[1];\n      if (latitude > maxLatitude) {\n        latitude = maxLatitude;\n      }\n    }\n  }\n\n  return {width, height, longitude, latitude, zoom, pitch, bearing};\n}\n"],"file":"normalize-viewport-props.js"}