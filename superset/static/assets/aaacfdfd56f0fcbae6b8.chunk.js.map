{"version":3,"file":"aaacfdfd56f0fcbae6b8.chunk.js","mappings":"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","sources":["webpack://superset/./src/types/ChartSource.ts","webpack://superset/./src/components/Chart/types.ts","webpack://superset/./src/components/Chart/DrillBy/DrillByChart.tsx","webpack://superset/./src/components/Chart/DrillBy/useDrillByBreadcrumbs.tsx","webpack://superset/./src/components/Chart/DrillBy/useResultsTableView.tsx","webpack://superset/./src/components/Chart/DrillBy/DrillByModal.tsx","webpack://superset/./src/components/Chart/DrillBy/useDisplayModeToggle.tsx","webpack://superset/./src/components/Chart/ChartContextMenu/useContextMenu.tsx","webpack://superset/./src/components/Chart/DrillBy/DrillByMenuItems.tsx","webpack://superset/./src/hooks/apiResources/datasets.ts","webpack://superset/./src/components/Chart/ChartContextMenu/ChartContextMenu.tsx","webpack://superset/./src/components/Chart/ChartRenderer.jsx","webpack://superset/./src/components/Chart/ChartErrorMessage.tsx","webpack://superset/./src/components/Chart/Chart.jsx","webpack://superset/./src/components/Chart/ChartContainer.jsx","webpack://superset/./src/explore/components/EmbedCodeContent.jsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/DashboardsSubMenu.tsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/index.jsx","webpack://superset/./src/components/Chart/DisabledMenuItemTooltip.tsx","webpack://superset/./src/components/Table/cell-renderers/BooleanCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/NullCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/TimeCell/index.tsx","webpack://superset/./src/components/Table/header-renderers/HeaderWithRadioGroup.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailTableControls.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailPane.tsx","webpack://superset/./src/components/Chart/DrillDetail/utils.ts","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailModal.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailMenuItems.tsx","webpack://superset/./src/components/Chart/MenuItemWithTruncation.tsx","webpack://superset/./src/components/Chart/utils.ts","webpack://superset/./src/components/CronPicker/CronPicker.tsx","webpack://superset/./src/components/Dropdown/index.tsx","webpack://superset/./src/components/MetadataBar/ContentType.ts","webpack://superset/./src/components/MetadataBar/ContentConfig.tsx","webpack://superset/./src/components/MetadataBar/MetadataBar.tsx","webpack://superset/./src/components/MetadataBar/index.tsx","webpack://superset/./src/components/DynamicEditableTitle/index.tsx","webpack://superset/./src/components/PageHeaderWithActions/index.tsx","webpack://superset/./src/reports/types.ts","webpack://superset/./src/components/ReportModal/index.tsx","webpack://superset/./src/components/ReportModal/HeaderReportDropdown/index.tsx","webpack://superset/./src/components/ReportModal/styles.tsx","webpack://superset/./src/components/Switch/index.tsx","webpack://superset/./src/components/TimezoneSelector/index.tsx","webpack://superset/./src/dashboard/util/activeAllDashboardFilters.ts","webpack://superset/./src/dashboard/util/charts/getEffectiveExtraFilters.ts","webpack://superset/./src/dashboard/util/charts/getFormDataWithExtraFilters.ts","webpack://superset/./src/explore/components/DataTablesPane/components/DataTableControls.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SingleQueryResultPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/types.ts","webpack://superset/./src/explore/components/DataTablesPane/components/useResultsPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/ResultsPaneOnDashboard.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SamplesPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/DataTablesPane.tsx","webpack://superset/./src/explore/components/controls/ViewQueryModal.tsx","webpack://superset/./src/features/datasets/metadataBar/useDatasetMetadataBar.tsx","webpack://superset/./src/hooks/useTabId.ts","webpack://superset/./src/utils/cachedSupersetGet.ts","webpack://superset/./src/utils/downloadAsImage.ts","webpack://superset/./src/utils/getChartRequiredFieldsMissingMessage.ts","webpack://superset/./src/utils/isBot.ts","webpack://superset/./src/utils/simpleFilterToAdhoc.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum ChartSource {\n  Explore = 'explore',\n  Dashboard = 'dashboard',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Column, Metric } from '@superset-ui/core';\n\nexport enum DrillByType {\n  Chart,\n  Table,\n}\n\nexport type Dataset = {\n  changed_by?: {\n    first_name: string;\n    last_name: string;\n  };\n  created_by?: {\n    first_name: string;\n    last_name: string;\n  };\n  changed_on_humanized: string;\n  created_on_humanized: string;\n  description: string;\n  table_name: string;\n  owners: {\n    first_name: string;\n    last_name: string;\n  }[];\n  columns?: Column[];\n  metrics?: Metric[];\n  verbose_map?: Record<string, string>;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport {\n  BaseFormData,\n  QueryData,\n  SuperChart,\n  css,\n  ContextMenuFilters,\n} from '@superset-ui/core';\nimport { Dataset } from '../types';\n\ninterface DrillByChartProps {\n  formData: BaseFormData & { [key: string]: any };\n  result: QueryData[];\n  dataset: Dataset;\n  onContextMenu: (\n    offsetX: number,\n    offsetY: number,\n    filters: ContextMenuFilters,\n  ) => void;\n  inContextMenu: boolean;\n}\n\nexport default function DrillByChart({\n  formData,\n  result,\n  dataset,\n  onContextMenu,\n  inContextMenu,\n}: DrillByChartProps) {\n  const hooks = useMemo(() => ({ onContextMenu }), [onContextMenu]);\n\n  return (\n    <div\n      css={css`\n        width: 100%;\n        height: 100%;\n        min-height: 0;\n      `}\n      data-test=\"drill-by-chart\"\n    >\n      <SuperChart\n        disableErrorBoundary\n        chartType={formData.viz_type}\n        enableNoResults\n        datasource={dataset}\n        formData={formData}\n        queriesData={result}\n        hooks={hooks}\n        inContextMenu={inContextMenu}\n        height=\"100%\"\n        width=\"100%\"\n      />\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useMemo } from 'react';\nimport {\n  BinaryQueryObjectFilterClause,\n  Column,\n  css,\n  ensureIsArray,\n  styled,\n  SupersetTheme,\n} from '@superset-ui/core';\nimport { AntdBreadcrumb } from 'src/components/index';\nimport { noOp } from 'src/utils/common';\n\nexport interface DrillByBreadcrumb {\n  groupby: Column | Column[];\n  filters?: BinaryQueryObjectFilterClause[];\n}\n\nconst BreadcrumbItem = styled(AntdBreadcrumb.Item)<{ isClickable: boolean }>`\n  ${({ theme, isClickable }) => css`\n    cursor: ${isClickable ? 'pointer' : 'auto'};\n    color: ${theme.colors.grayscale.light1};\n    transition: color ease-in ${theme.transitionTiming}s;\n    .ant-breadcrumb > span:last-child > & {\n      color: ${theme.colors.grayscale.dark1};\n    }\n    &:hover {\n      color: ${isClickable ? theme.colors.grayscale.dark1 : 'inherit'};\n    }\n  `}\n`;\n\nexport const useDrillByBreadcrumbs = (\n  breadcrumbsData: DrillByBreadcrumb[],\n  onBreadcrumbClick: (\n    breadcrumb: DrillByBreadcrumb,\n    index: number,\n  ) => void = noOp,\n) =>\n  useMemo(() => {\n    // the last breadcrumb is not clickable\n    const isClickable = (index: number) => index < breadcrumbsData.length - 1;\n    const getBreadcrumbText = (breadcrumb: DrillByBreadcrumb) =>\n      `${ensureIsArray(breadcrumb.groupby)\n        .map(column => column.verbose_name || column.column_name)\n        .join(', ')} ${\n        breadcrumb.filters\n          ? `(${breadcrumb.filters\n              .map(filter => filter.formattedVal || filter.val)\n              .join(', ')})`\n          : ''\n      }`;\n    return (\n      <AntdBreadcrumb\n        css={(theme: SupersetTheme) => css`\n          margin: ${theme.gridUnit * 2}px 0 ${theme.gridUnit * 4}px;\n        `}\n      >\n        {breadcrumbsData.map((breadcrumb, index) => (\n          <BreadcrumbItem\n            key={index}\n            isClickable={isClickable(index)}\n            onClick={\n              isClickable(index)\n                ? () => onBreadcrumbClick(breadcrumb, index)\n                : noOp\n            }\n            data-test=\"drill-by-breadcrumb-item\"\n          >\n            {getBreadcrumbText(breadcrumb)}\n          </BreadcrumbItem>\n        ))}\n      </AntdBreadcrumb>\n    );\n  }, [breadcrumbsData, onBreadcrumbClick]);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { css, styled, isDefined, QueryData, t } from '@superset-ui/core';\nimport { SingleQueryResultPane } from 'src/explore/components/DataTablesPane/components/SingleQueryResultPane';\nimport Tabs from 'src/components/Tabs';\n\nconst DATA_SIZE = 15;\n\nconst PaginationContainer = styled.div`\n  ${({ theme }) => css`\n    & .pagination-container {\n      bottom: ${-theme.gridUnit * 4}px;\n    }\n  `}\n`;\n\nexport const useResultsTableView = (\n  chartDataResult: QueryData[] | undefined,\n  datasourceId: string,\n) => {\n  if (!isDefined(chartDataResult)) {\n    return <div />;\n  }\n  if (chartDataResult.length === 1) {\n    return (\n      <PaginationContainer data-test=\"drill-by-results-table\">\n        <SingleQueryResultPane\n          colnames={chartDataResult[0].colnames}\n          coltypes={chartDataResult[0].coltypes}\n          data={chartDataResult[0].data}\n          dataSize={DATA_SIZE}\n          datasourceId={datasourceId}\n          isVisible\n        />\n      </PaginationContainer>\n    );\n  }\n  return (\n    <Tabs fullWidth={false} data-test=\"drill-by-results-tabs\">\n      {chartDataResult.map((res, index) => (\n        <Tabs.TabPane tab={t('Results %s', index + 1)} key={index}>\n          <PaginationContainer>\n            <SingleQueryResultPane\n              colnames={res.colnames}\n              coltypes={res.coltypes}\n              data={res.data}\n              dataSize={DATA_SIZE}\n              datasourceId={datasourceId}\n              isVisible\n            />\n          </PaginationContainer>\n        </Tabs.TabPane>\n      ))}\n    </Tabs>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport {\n  BaseFormData,\n  Column,\n  QueryData,\n  css,\n  ensureIsArray,\n  isDefined,\n  t,\n  useTheme,\n  ContextMenuFilters,\n} from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport Modal from 'src/components/Modal';\nimport Loading from 'src/components/Loading';\nimport Button from 'src/components/Button';\nimport { RootState } from 'src/dashboard/types';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { postFormData } from 'src/explore/exploreUtils/formData';\nimport { simpleFilterToAdhoc } from 'src/utils/simpleFilterToAdhoc';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Alert from 'src/components/Alert';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED,\n  LOG_ACTIONS_DRILL_BY_EDIT_CHART,\n  LOG_ACTIONS_DRILL_BY_MODAL_OPENED,\n  LOG_ACTIONS_FURTHER_DRILL_BY,\n} from 'src/logger/LogUtils';\nimport { Dataset, DrillByType } from '../types';\nimport DrillByChart from './DrillByChart';\nimport { ContextMenuItem } from '../ChartContextMenu/ChartContextMenu';\nimport { useContextMenu } from '../ChartContextMenu/useContextMenu';\nimport { getChartDataRequest } from '../chartAction';\nimport { useDisplayModeToggle } from './useDisplayModeToggle';\nimport {\n  DrillByBreadcrumb,\n  useDrillByBreadcrumbs,\n} from './useDrillByBreadcrumbs';\nimport { useResultsTableView } from './useResultsTableView';\n\nconst DEFAULT_ADHOC_FILTER_FIELD_NAME = 'adhoc_filters';\ninterface ModalFooterProps {\n  closeModal?: () => void;\n  formData: BaseFormData;\n}\n\nconst ModalFooter = ({ formData, closeModal }: ModalFooterProps) => {\n  const dispatch = useDispatch();\n  const { addDangerToast } = useToasts();\n  const [url, setUrl] = useState('');\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const onEditChartClick = useCallback(() => {\n    dispatch(\n      logEvent(LOG_ACTIONS_DRILL_BY_EDIT_CHART, {\n        slice_id: formData.slice_id,\n      }),\n    );\n  }, [dispatch, formData.slice_id]);\n\n  const [datasource_id, datasource_type] = formData.datasource.split('__');\n  useEffect(() => {\n    postFormData(Number(datasource_id), datasource_type, formData, 0)\n      .then(key => {\n        setUrl(\n          `/explore/?form_data_key=${key}&dashboard_page_id=${dashboardPageId}`,\n        );\n      })\n      .catch(() => {\n        addDangerToast(t('Failed to generate chart edit URL'));\n      });\n  }, [\n    addDangerToast,\n    dashboardPageId,\n    datasource_id,\n    datasource_type,\n    formData,\n  ]);\n  return (\n    <>\n      <Button\n        buttonStyle=\"secondary\"\n        buttonSize=\"small\"\n        onClick={onEditChartClick}\n        disabled={!url}\n      >\n        <Link\n          css={css`\n            &:hover {\n              text-decoration: none;\n            }\n          `}\n          to={url}\n        >\n          {t('Edit chart')}\n        </Link>\n      </Button>\n\n      <Button\n        buttonStyle=\"primary\"\n        buttonSize=\"small\"\n        onClick={closeModal}\n        data-test=\"close-drill-by-modal\"\n      >\n        {t('Close')}\n      </Button>\n    </>\n  );\n};\n\nexport interface DrillByModalProps {\n  column?: Column;\n  dataset: Dataset;\n  drillByConfig: Required<ContextMenuFilters>['drillBy'];\n  formData: BaseFormData & { [key: string]: any };\n  onHideModal: () => void;\n}\n\ntype DrillByConfigs = (ContextMenuFilters['drillBy'] & { column?: Column })[];\n\nexport default function DrillByModal({\n  column,\n  dataset,\n  drillByConfig,\n  formData,\n  onHideModal,\n}: DrillByModalProps) {\n  const dispatch = useDispatch();\n  const theme = useTheme();\n  const { addDangerToast } = useToasts();\n  const [isChartDataLoading, setIsChartDataLoading] = useState(true);\n\n  const [drillByConfigs, setDrillByConfigs] = useState<DrillByConfigs>([\n    { ...drillByConfig, column },\n  ]);\n\n  useEffect(() => {\n    dispatch(\n      logEvent(LOG_ACTIONS_DRILL_BY_MODAL_OPENED, {\n        slice_id: formData.slice_id,\n      }),\n    );\n  }, [dispatch, formData.slice_id]);\n\n  const {\n    column: currentColumn,\n    groupbyFieldName = drillByConfig.groupbyFieldName,\n  } = drillByConfigs[drillByConfigs.length - 1] || {};\n\n  const initialGroupbyColumns = useMemo(\n    () =>\n      ensureIsArray(formData[groupbyFieldName])\n        .map(colName =>\n          dataset.columns?.find(col => col.column_name === colName),\n        )\n        .filter(isDefined),\n    [dataset.columns, formData, groupbyFieldName],\n  );\n\n  const { displayModeToggle, drillByDisplayMode } = useDisplayModeToggle();\n  const [chartDataResult, setChartDataResult] = useState<QueryData[]>();\n\n  const resultsTable = useResultsTableView(\n    chartDataResult,\n    formData.datasource,\n  );\n\n  const [currentFormData, setCurrentFormData] = useState(formData);\n  const [usedGroupbyColumns, setUsedGroupbyColumns] = useState<Column[]>(\n    [...initialGroupbyColumns, column].filter(isDefined),\n  );\n  const [breadcrumbsData, setBreadcrumbsData] = useState<DrillByBreadcrumb[]>([\n    { groupby: initialGroupbyColumns, filters: drillByConfig.filters },\n    { groupby: column || [] },\n  ]);\n\n  const getNewGroupby = useCallback(\n    (groupbyCol: Column, fieldName = groupbyFieldName) =>\n      Array.isArray(formData[fieldName])\n        ? [groupbyCol.column_name]\n        : groupbyCol.column_name,\n    [formData, groupbyFieldName],\n  );\n\n  const getFormDataChangesFromConfigs = useCallback(\n    (configs: DrillByConfigs) =>\n      configs.reduce(\n        (acc, config) => {\n          if (config?.groupbyFieldName && config.column) {\n            acc.formData[config.groupbyFieldName] = getNewGroupby(\n              config.column,\n              config.groupbyFieldName,\n            );\n            acc.overridenGroupbyFields.add(config.groupbyFieldName);\n          }\n          const adhocFilterFieldName =\n            config?.adhocFilterFieldName || DEFAULT_ADHOC_FILTER_FIELD_NAME;\n          acc.formData[adhocFilterFieldName] = [\n            ...ensureIsArray(acc[adhocFilterFieldName]),\n            ...ensureIsArray(config.filters).map(filter =>\n              simpleFilterToAdhoc(filter),\n            ),\n          ];\n          acc.overridenAdhocFilterFields.add(adhocFilterFieldName);\n\n          return acc;\n        },\n        {\n          formData: {},\n          overridenGroupbyFields: new Set<string>(),\n          overridenAdhocFilterFields: new Set<string>(),\n        },\n      ),\n    [getNewGroupby],\n  );\n\n  const getFiltersFromConfigsByFieldName = useCallback(\n    () =>\n      drillByConfigs.reduce((acc, config) => {\n        const adhocFilterFieldName =\n          config.adhocFilterFieldName || DEFAULT_ADHOC_FILTER_FIELD_NAME;\n        acc[adhocFilterFieldName] = [\n          ...(acc[adhocFilterFieldName] || []),\n          ...config.filters.map(filter => simpleFilterToAdhoc(filter)),\n        ];\n        return acc;\n      }, {}),\n    [drillByConfigs],\n  );\n\n  const onBreadcrumbClick = useCallback(\n    (breadcrumb: DrillByBreadcrumb, index: number) => {\n      dispatch(\n        logEvent(LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED, {\n          slice_id: formData.slice_id,\n        }),\n      );\n      setDrillByConfigs(prevConfigs => prevConfigs.slice(0, index));\n      setBreadcrumbsData(prevBreadcrumbs => {\n        const newBreadcrumbs = prevBreadcrumbs.slice(0, index + 1);\n        delete newBreadcrumbs[newBreadcrumbs.length - 1].filters;\n        return newBreadcrumbs;\n      });\n      setUsedGroupbyColumns(prevUsedGroupbyColumns =>\n        prevUsedGroupbyColumns.slice(0, index),\n      );\n      setCurrentFormData(() => {\n        if (index === 0) {\n          return formData;\n        }\n        const { formData: overrideFormData, overridenAdhocFilterFields } =\n          getFormDataChangesFromConfigs(drillByConfigs.slice(0, index));\n\n        const newFormData = {\n          ...formData,\n          ...overrideFormData,\n        };\n        overridenAdhocFilterFields.forEach(adhocFilterField => ({\n          ...newFormData,\n          [adhocFilterField]: [\n            ...formData[adhocFilterField],\n            ...overrideFormData[adhocFilterField],\n          ],\n        }));\n        return newFormData;\n      });\n    },\n    [dispatch, drillByConfigs, formData, getFormDataChangesFromConfigs],\n  );\n\n  const breadcrumbs = useDrillByBreadcrumbs(breadcrumbsData, onBreadcrumbClick);\n\n  const drilledFormData = useMemo(() => {\n    let updatedFormData = { ...currentFormData };\n    if (currentColumn && groupbyFieldName) {\n      updatedFormData[groupbyFieldName] = getNewGroupby(currentColumn);\n    }\n\n    const adhocFilters = getFiltersFromConfigsByFieldName();\n    Object.keys(adhocFilters).forEach(adhocFilterFieldName => {\n      updatedFormData = {\n        ...updatedFormData,\n        [adhocFilterFieldName]: [\n          ...ensureIsArray(formData[adhocFilterFieldName]),\n          ...adhocFilters[adhocFilterFieldName],\n        ],\n      };\n    });\n\n    updatedFormData.slice_id = 0;\n    delete updatedFormData.slice_name;\n    delete updatedFormData.dashboards;\n    return updatedFormData;\n  }, [\n    currentFormData,\n    currentColumn,\n    groupbyFieldName,\n    getFiltersFromConfigsByFieldName,\n    getNewGroupby,\n    formData,\n  ]);\n\n  useEffect(() => {\n    setUsedGroupbyColumns(usedCols =>\n      !currentColumn ||\n      usedCols.some(\n        usedCol => usedCol.column_name === currentColumn.column_name,\n      )\n        ? usedCols\n        : [...usedCols, currentColumn],\n    );\n  }, [currentColumn]);\n\n  const onSelection = useCallback(\n    (\n      newColumn: Column,\n      drillByConfig: Required<ContextMenuFilters>['drillBy'],\n    ) => {\n      dispatch(\n        logEvent(LOG_ACTIONS_FURTHER_DRILL_BY, {\n          drill_depth: drillByConfigs.length + 1,\n          slice_id: formData.slice_id,\n        }),\n      );\n      setCurrentFormData(drilledFormData);\n      setDrillByConfigs(prevConfigs => [\n        ...prevConfigs,\n        { ...drillByConfig, column: newColumn },\n      ]);\n      setBreadcrumbsData(prevBreadcrumbs => {\n        const newBreadcrumbs = [...prevBreadcrumbs, { groupby: newColumn }];\n        newBreadcrumbs[newBreadcrumbs.length - 2].filters =\n          drillByConfig.filters;\n        return newBreadcrumbs;\n      });\n    },\n    [dispatch, drillByConfigs.length, drilledFormData, formData.slice_id],\n  );\n\n  const additionalConfig = useMemo(\n    () => ({\n      drillBy: { excludedColumns: usedGroupbyColumns, openNewModal: false },\n    }),\n    [usedGroupbyColumns],\n  );\n\n  const { contextMenu, inContextMenu, onContextMenu } = useContextMenu(\n    0,\n    currentFormData,\n    onSelection,\n    ContextMenuItem.DrillBy,\n    additionalConfig,\n  );\n\n  const chartName = useSelector<RootState, string | undefined>(state => {\n    const chartLayoutItem = Object.values(state.dashboardLayout.present).find(\n      layoutItem => layoutItem.meta?.chartId === formData.slice_id,\n    );\n    return (\n      chartLayoutItem?.meta.sliceNameOverride || chartLayoutItem?.meta.sliceName\n    );\n  });\n\n  useEffect(() => {\n    if (drilledFormData) {\n      setIsChartDataLoading(true);\n      setChartDataResult(undefined);\n      getChartDataRequest({\n        formData: drilledFormData,\n      })\n        .then(({ json }) => {\n          setChartDataResult(json.result);\n        })\n        .catch(() => {\n          addDangerToast(t('Failed to load chart data.'));\n        })\n        .finally(() => {\n          setIsChartDataLoading(false);\n        });\n    }\n  }, [addDangerToast, drilledFormData]);\n  const { metadataBar } = useDatasetMetadataBar({ dataset });\n\n  return (\n    <Modal\n      css={css`\n        .ant-modal-footer {\n          border-top: none;\n        }\n      `}\n      show\n      onHide={onHideModal ?? (() => null)}\n      title={t('Drill by: %s', chartName)}\n      footer={<ModalFooter formData={drilledFormData} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '80vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n        `}\n      >\n        {metadataBar}\n        {breadcrumbs}\n        {displayModeToggle}\n        {isChartDataLoading && <Loading />}\n        {!isChartDataLoading && !chartDataResult && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the chart data')}\n          />\n        )}\n        {drillByDisplayMode === DrillByType.Chart && chartDataResult && (\n          <DrillByChart\n            dataset={dataset}\n            formData={drilledFormData}\n            result={chartDataResult}\n            onContextMenu={onContextMenu}\n            inContextMenu={inContextMenu}\n          />\n        )}\n        {drillByDisplayMode === DrillByType.Table &&\n          chartDataResult &&\n          resultsTable}\n        {contextMenu}\n      </div>\n    </Modal>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useMemo, useState } from 'react';\nimport { css, SupersetTheme, t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { DrillByType } from '../types';\n\nexport const useDisplayModeToggle = () => {\n  const [drillByDisplayMode, setDrillByDisplayMode] = useState<DrillByType>(\n    DrillByType.Chart,\n  );\n\n  const displayModeToggle = useMemo(\n    () => (\n      <div\n        css={(theme: SupersetTheme) => css`\n          margin-bottom: ${theme.gridUnit * 6}px;\n          .ant-radio-button-wrapper-checked:not(.ant-radio-button-wrapper-disabled):focus-within {\n            box-shadow: none;\n          }\n        `}\n        data-test=\"drill-by-display-toggle\"\n      >\n        <Radio.Group\n          onChange={({ target: { value } }) => {\n            setDrillByDisplayMode(value);\n          }}\n          defaultValue={DrillByType.Chart}\n        >\n          <Radio.Button\n            value={DrillByType.Chart}\n            data-test=\"drill-by-chart-radio\"\n          >\n            {t('Chart')}\n          </Radio.Button>\n          <Radio.Button\n            value={DrillByType.Table}\n            data-test=\"drill-by-table-radio\"\n          >\n            {t('Table')}\n          </Radio.Button>\n        </Radio.Group>\n      </div>\n    ),\n    [],\n  );\n  return { displayModeToggle, drillByDisplayMode };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useRef, useState } from 'react';\nimport { BaseFormData, ContextMenuFilters } from '@superset-ui/core';\nimport ChartContextMenu, {\n  ChartContextMenuRef,\n  ContextMenuItem,\n} from './ChartContextMenu';\n\nexport const useContextMenu = (\n  chartId: number,\n  formData: BaseFormData & { [key: string]: any },\n  onSelection?: (...args: any) => void,\n  displayedItems?: ContextMenuItem[] | ContextMenuItem,\n  additionalConfig?: {\n    crossFilter?: Record<string, any>;\n    drillToDetail?: Record<string, any>;\n    drillBy?: Record<string, any>;\n  },\n) => {\n  const contextMenuRef = useRef<ChartContextMenuRef>(null);\n  const [inContextMenu, setInContextMenu] = useState(false);\n  const onContextMenu = (\n    offsetX: number,\n    offsetY: number,\n    filters: ContextMenuFilters,\n  ) => {\n    contextMenuRef.current?.open(offsetX, offsetY, filters);\n    setInContextMenu(true);\n  };\n\n  const handleContextMenuSelected = useCallback(\n    (...args: any) => {\n      setInContextMenu(false);\n      onSelection?.(...args);\n    },\n    [onSelection],\n  );\n\n  const handleContextMenuClosed = useCallback(() => {\n    setInContextMenu(false);\n  }, []);\n\n  const contextMenu = useMemo(\n    () => (\n      <ChartContextMenu\n        ref={contextMenuRef}\n        id={chartId}\n        formData={formData}\n        onSelection={handleContextMenuSelected}\n        onClose={handleContextMenuClosed}\n        displayedItems={displayedItems}\n        additionalConfig={additionalConfig}\n      />\n    ),\n    [\n      additionalConfig,\n      chartId,\n      displayedItems,\n      formData,\n      handleContextMenuClosed,\n      handleContextMenuSelected,\n    ],\n  );\n  return { contextMenu, inContextMenu, onContextMenu };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { Menu } from 'src/components/Menu';\nimport {\n  BaseFormData,\n  Behavior,\n  Column,\n  ContextMenuFilters,\n  css,\n  ensureIsArray,\n  getChartMetadataRegistry,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Input } from 'src/components/Input';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport {\n  cachedSupersetGet,\n  supersetGetCache,\n} from 'src/utils/cachedSupersetGet';\nimport { useVerboseMap } from 'src/hooks/apiResources/datasets';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport DrillByModal from './DrillByModal';\nimport { getSubmenuYOffset } from '../utils';\nimport { MenuItemWithTruncation } from '../MenuItemWithTruncation';\nimport { Dataset } from '../types';\n\nconst MAX_SUBMENU_HEIGHT = 200;\nconst SHOW_COLUMNS_SEARCH_THRESHOLD = 10;\nconst SEARCH_INPUT_HEIGHT = 48;\n\nexport interface DrillByMenuItemsProps {\n  drillByConfig?: ContextMenuFilters['drillBy'];\n  formData: BaseFormData & { [key: string]: any };\n  contextMenuY?: number;\n  submenuIndex?: number;\n  onSelection?: (...args: any) => void;\n  onClick?: (event: MouseEvent) => void;\n  openNewModal?: boolean;\n  excludedColumns?: Column[];\n}\n\nexport const DrillByMenuItems = ({\n  drillByConfig,\n  formData,\n  contextMenuY = 0,\n  submenuIndex = 0,\n  onSelection = () => {},\n  onClick = () => {},\n  excludedColumns,\n  openNewModal = true,\n  ...rest\n}: DrillByMenuItemsProps) => {\n  const theme = useTheme();\n  const { addDangerToast } = useToasts();\n  const [isLoadingColumns, setIsLoadingColumns] = useState(true);\n  const [searchInput, setSearchInput] = useState('');\n  const [dataset, setDataset] = useState<Dataset>();\n  const [columns, setColumns] = useState<Column[]>([]);\n  const [showModal, setShowModal] = useState(false);\n  const [currentColumn, setCurrentColumn] = useState();\n  const handleSelection = useCallback(\n    (event, column) => {\n      onClick(event);\n      onSelection(column, drillByConfig);\n      setCurrentColumn(column);\n      if (openNewModal) {\n        setShowModal(true);\n      }\n    },\n    [drillByConfig, onClick, onSelection, openNewModal],\n  );\n  const closeModal = useCallback(() => {\n    setShowModal(false);\n  }, []);\n\n  useEffect(() => {\n    // Input is displayed only when columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD\n    // Reset search input in case Input gets removed\n    setSearchInput('');\n  }, [columns.length]);\n\n  const hasDrillBy =\n    ensureIsArray(drillByConfig?.filters).length &&\n    drillByConfig?.groupbyFieldName;\n\n  const handlesDimensionContextMenu = useMemo(\n    () =>\n      getChartMetadataRegistry()\n        .get(formData.viz_type)\n        ?.behaviors.find(behavior => behavior === Behavior.DRILL_BY),\n    [formData.viz_type],\n  );\n  const verboseMap = useVerboseMap(dataset);\n\n  useEffect(() => {\n    if (handlesDimensionContextMenu && hasDrillBy) {\n      const datasetId = formData.datasource.split('__')[0];\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then(({ json: { result } }) => {\n          setDataset(result);\n          setColumns(\n            ensureIsArray(result.columns)\n              .filter(column => column.groupby)\n              .filter(\n                column =>\n                  !ensureIsArray(\n                    formData[drillByConfig.groupbyFieldName ?? ''],\n                  ).includes(column.column_name) &&\n                  column.column_name !== formData.x_axis &&\n                  ensureIsArray(excludedColumns)?.every(\n                    excludedCol =>\n                      excludedCol.column_name !== column.column_name,\n                  ),\n              ),\n          );\n        })\n        .catch(() => {\n          supersetGetCache.delete(`/api/v1/dataset/${datasetId}`);\n          addDangerToast(t('Failed to load dimensions for drill by'));\n        })\n        .finally(() => {\n          setIsLoadingColumns(false);\n        });\n    }\n  }, [\n    addDangerToast,\n    excludedColumns,\n    formData,\n    drillByConfig?.groupbyFieldName,\n    handlesDimensionContextMenu,\n    hasDrillBy,\n  ]);\n\n  const handleInput = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    e.stopPropagation();\n    const input = e?.target?.value;\n    setSearchInput(input);\n  }, []);\n\n  const filteredColumns = useMemo(\n    () =>\n      columns.filter(column =>\n        (column.verbose_name || column.column_name)\n          .toLowerCase()\n          .includes(searchInput.toLowerCase()),\n      ),\n    [columns, searchInput],\n  );\n\n  const submenuYOffset = useMemo(\n    () =>\n      getSubmenuYOffset(\n        contextMenuY,\n        filteredColumns.length || 1,\n        submenuIndex,\n        MAX_SUBMENU_HEIGHT,\n        columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD\n          ? SEARCH_INPUT_HEIGHT\n          : 0,\n      ),\n    [contextMenuY, filteredColumns.length, submenuIndex, columns.length],\n  );\n\n  let tooltip: ReactNode;\n\n  if (!handlesDimensionContextMenu) {\n    tooltip = t('Drill by is not yet supported for this chart type');\n  } else if (!hasDrillBy) {\n    tooltip = t('Drill by is not available for this data point');\n  }\n\n  if (!handlesDimensionContextMenu || !hasDrillBy) {\n    return (\n      <Menu.Item key=\"drill-by-disabled\" disabled {...rest}>\n        <div>\n          {t('Drill by')}\n          <MenuItemTooltip title={tooltip} />\n        </div>\n      </Menu.Item>\n    );\n  }\n\n  return (\n    <>\n      <Menu.SubMenu\n        title={t('Drill by')}\n        key=\"drill-by-submenu\"\n        popupClassName=\"chart-context-submenu\"\n        popupOffset={[0, submenuYOffset]}\n        {...rest}\n      >\n        <div data-test=\"drill-by-submenu\">\n          {columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD && (\n            <Input\n              prefix={\n                <Icons.Search\n                  iconSize=\"l\"\n                  iconColor={theme.colors.grayscale.light1}\n                />\n              }\n              onChange={handleInput}\n              placeholder={t('Search columns')}\n              value={searchInput}\n              onClick={e => {\n                // prevent closing menu when clicking on input\n                e.nativeEvent.stopImmediatePropagation();\n              }}\n              allowClear\n              css={css`\n                width: auto;\n                max-width: 100%;\n                margin: ${theme.gridUnit * 2}px ${theme.gridUnit * 3}px;\n                box-shadow: none;\n              `}\n            />\n          )}\n          {isLoadingColumns ? (\n            <div\n              css={css`\n                padding: ${theme.gridUnit * 3}px 0;\n              `}\n            >\n              <Loading position=\"inline-centered\" />\n            </div>\n          ) : filteredColumns.length ? (\n            <div\n              css={css`\n                max-height: ${MAX_SUBMENU_HEIGHT}px;\n                overflow: auto;\n              `}\n            >\n              {filteredColumns.map(column => (\n                <MenuItemWithTruncation\n                  key={`drill-by-item-${column.column_name}`}\n                  tooltipText={column.verbose_name || column.column_name}\n                  {...rest}\n                  onClick={e => handleSelection(e, column)}\n                >\n                  {column.verbose_name || column.column_name}\n                </MenuItemWithTruncation>\n              ))}\n            </div>\n          ) : (\n            <Menu.Item disabled key=\"no-drill-by-columns-found\" {...rest}>\n              {t('No columns found')}\n            </Menu.Item>\n          )}\n        </div>\n      </Menu.SubMenu>\n      {showModal && (\n        <DrillByModal\n          column={currentColumn}\n          drillByConfig={drillByConfig}\n          formData={formData}\n          onHideModal={closeModal}\n          dataset={{ ...dataset!, verbose_map: verboseMap }}\n        />\n      )}\n    </>\n  );\n};\n","/* eslint-disable no-underscore-dangle */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Column, Metric, ensureIsArray } from '@superset-ui/core';\nimport { Dataset } from 'src/components/Chart/types';\n\nexport const useVerboseMap = (dataset?: Dataset) => {\n  const verbose_map = {};\n  ensureIsArray(dataset?.columns).forEach((column: Column) => {\n    verbose_map[column.column_name] = column.verbose_name || column.column_name;\n  });\n  ensureIsArray(dataset?.metrics).forEach((metric: Metric) => {\n    verbose_map[metric.metric_name] = metric.verbose_name || metric.metric_name;\n  });\n  return verbose_map;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  forwardRef,\n  ReactNode,\n  RefObject,\n  useCallback,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  Behavior,\n  ContextMenuFilters,\n  ensureIsArray,\n  FeatureFlag,\n  getChartMetadataRegistry,\n  isFeatureEnabled,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { RootState } from 'src/dashboard/types';\nimport { findPermission } from 'src/utils/findPermission';\nimport { Menu } from 'src/components/Menu';\nimport { AntdDropdown as Dropdown } from 'src/components/index';\nimport { updateDataMask } from 'src/dataMask/actions';\nimport { DrillDetailMenuItems } from '../DrillDetail';\nimport { getMenuAdjustedY } from '../utils';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport { DrillByMenuItems } from '../DrillBy/DrillByMenuItems';\n\nexport enum ContextMenuItem {\n  CrossFilter,\n  DrillToDetail,\n  DrillBy,\n  All,\n}\nexport interface ChartContextMenuProps {\n  id: number;\n  formData: QueryFormData;\n  onSelection: () => void;\n  onClose: () => void;\n  additionalConfig?: {\n    crossFilter?: Record<string, any>;\n    drillToDetail?: Record<string, any>;\n    drillBy?: Record<string, any>;\n  };\n  displayedItems?: ContextMenuItem[] | ContextMenuItem;\n}\n\nexport interface ChartContextMenuRef {\n  open: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n}\n\nconst ChartContextMenu = (\n  {\n    id,\n    formData,\n    onSelection,\n    onClose,\n    displayedItems = ContextMenuItem.All,\n    additionalConfig,\n  }: ChartContextMenuProps,\n  ref: RefObject<ChartContextMenuRef>,\n) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const canExplore = useSelector((state: RootState) =>\n    findPermission('can_explore', 'Superset', state.user?.roles),\n  );\n  const crossFiltersEnabled = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.crossFiltersEnabled,\n  );\n\n  const isDisplayed = (item: ContextMenuItem) =>\n    displayedItems === ContextMenuItem.All ||\n    ensureIsArray(displayedItems).includes(item);\n\n  const [{ filters, clientX, clientY }, setState] = useState<{\n    clientX: number;\n    clientY: number;\n    filters?: ContextMenuFilters;\n  }>({ clientX: 0, clientY: 0 });\n\n  const menuItems = [];\n\n  const showDrillToDetail =\n    isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) &&\n    canExplore &&\n    isDisplayed(ContextMenuItem.DrillToDetail);\n\n  const showDrillBy =\n    isFeatureEnabled(FeatureFlag.DRILL_BY) &&\n    canExplore &&\n    isDisplayed(ContextMenuItem.DrillBy);\n\n  const showCrossFilters =\n    isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS) &&\n    isDisplayed(ContextMenuItem.CrossFilter);\n\n  const isCrossFilteringSupportedByChart = getChartMetadataRegistry()\n    .get(formData.viz_type)\n    ?.behaviors?.includes(Behavior.INTERACTIVE_CHART);\n\n  let itemsCount = 0;\n  if (showCrossFilters) {\n    itemsCount += 1;\n  }\n  if (showDrillToDetail) {\n    itemsCount += 2; // Drill to detail always has 2 top-level menu items\n  }\n  if (showDrillBy) {\n    itemsCount += 1;\n  }\n  if (itemsCount === 0) {\n    itemsCount = 1; // \"No actions\" appears if no actions in menu\n  }\n\n  if (showCrossFilters) {\n    const isCrossFilterDisabled =\n      !isCrossFilteringSupportedByChart ||\n      !crossFiltersEnabled ||\n      !filters?.crossFilter;\n\n    let crossFilteringTooltipTitle: ReactNode = null;\n    if (!isCrossFilterDisabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t(\n              'Cross-filter will be applied to all of the charts that use this dataset.',\n            )}\n          </div>\n          <div>\n            {t('You can also just click on the chart to apply cross-filter.')}\n          </div>\n        </>\n      );\n    } else if (!crossFiltersEnabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t('Cross-filtering is not enabled for this dashboard.')}</div>\n        </>\n      );\n    } else if (!isCrossFilteringSupportedByChart) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t('This visualization type does not support cross-filtering.')}\n          </div>\n        </>\n      );\n    } else if (!filters?.crossFilter) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t(`You can't apply cross-filter on this data point.`)}</div>\n        </>\n      );\n    }\n    menuItems.push(\n      <>\n        <Menu.Item\n          key=\"cross-filtering-menu-item\"\n          disabled={isCrossFilterDisabled}\n          onClick={() => {\n            if (filters?.crossFilter) {\n              dispatch(updateDataMask(id, filters.crossFilter.dataMask));\n            }\n          }}\n        >\n          {filters?.crossFilter?.isCurrentValueSelected ? (\n            t('Remove cross-filter')\n          ) : (\n            <div>\n              {t('Add cross-filter')}\n              <MenuItemTooltip\n                title={crossFilteringTooltipTitle}\n                color={\n                  !isCrossFilterDisabled\n                    ? theme.colors.grayscale.base\n                    : undefined\n                }\n              />\n            </div>\n          )}\n        </Menu.Item>\n        {itemsCount > 1 && <Menu.Divider />}\n      </>,\n    );\n  }\n  if (showDrillToDetail) {\n    menuItems.push(\n      <DrillDetailMenuItems\n        chartId={id}\n        formData={formData}\n        filters={filters?.drillToDetail}\n        isContextMenu\n        contextMenuY={clientY}\n        onSelection={onSelection}\n        submenuIndex={showCrossFilters ? 2 : 1}\n        {...(additionalConfig?.drillToDetail || {})}\n      />,\n    );\n  }\n  if (showDrillBy) {\n    let submenuIndex = 0;\n    if (showCrossFilters) {\n      submenuIndex += 1;\n    }\n    if (showDrillToDetail) {\n      submenuIndex += 2;\n    }\n    menuItems.push(\n      <DrillByMenuItems\n        drillByConfig={filters?.drillBy}\n        onSelection={onSelection}\n        formData={formData}\n        contextMenuY={clientY}\n        submenuIndex={submenuIndex}\n        {...(additionalConfig?.drillBy || {})}\n      />,\n    );\n  }\n\n  const open = useCallback(\n    (clientX: number, clientY: number, filters?: ContextMenuFilters) => {\n      const adjustedY = getMenuAdjustedY(clientY, itemsCount);\n      setState({\n        clientX,\n        clientY: adjustedY,\n        filters,\n      });\n\n      // Since Ant Design's Dropdown does not offer an imperative API\n      // and we can't attach event triggers to charts SVG elements, we\n      // use a hidden span that gets clicked on when receiving click events\n      // from the charts.\n      document.getElementById(`hidden-span-${id}`)?.click();\n    },\n    [id, itemsCount],\n  );\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      open,\n    }),\n    [open],\n  );\n\n  return ReactDOM.createPortal(\n    <Dropdown\n      overlay={\n        <Menu className=\"chart-context-menu\" data-test=\"chart-context-menu\">\n          {menuItems.length ? (\n            menuItems\n          ) : (\n            <Menu.Item disabled>No actions</Menu.Item>\n          )}\n        </Menu>\n      }\n      trigger={['click']}\n      onVisibleChange={value => !value && onClose()}\n    >\n      <span\n        id={`hidden-span-${id}`}\n        css={{\n          visibility: 'hidden',\n          position: 'fixed',\n          top: clientY,\n          left: clientX,\n          width: 1,\n          height: 1,\n        }}\n      />\n    </Dropdown>,\n    document.body,\n  );\n};\n\nexport default forwardRef(ChartContextMenu);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { snakeCase, isEqual, cloneDeep } from 'lodash';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  SuperChart,\n  logging,\n  Behavior,\n  t,\n  isFeatureEnabled,\n  FeatureFlag,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { EmptyStateBig, EmptyStateSmall } from 'src/components/EmptyState';\nimport { ChartSource } from 'src/types/ChartSource';\nimport ChartContextMenu from './ChartContextMenu/ChartContextMenu';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  initialValues: PropTypes.object,\n  formData: PropTypes.object.isRequired,\n  latestQueryFormData: PropTypes.object,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  height: PropTypes.number,\n  width: PropTypes.number,\n  setControlValue: PropTypes.func,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  setDataMask: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  source: PropTypes.oneOf([ChartSource.Dashboard, ChartSource.Explore]),\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\n\nconst BIG_NO_RESULT_MIN_WIDTH = 300;\nconst BIG_NO_RESULT_MIN_HEIGHT = 220;\n\nconst behaviors = [Behavior.INTERACTIVE_CHART];\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n};\n\nclass ChartRenderer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showContextMenu:\n        props.source === ChartSource.Dashboard &&\n        (isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) ||\n          isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)),\n      inContextMenu: false,\n    };\n    this.hasQueryResponseChange = false;\n\n    this.contextMenuRef = React.createRef();\n\n    this.handleAddFilter = this.handleAddFilter.bind(this);\n    this.handleRenderSuccess = this.handleRenderSuccess.bind(this);\n    this.handleRenderFailure = this.handleRenderFailure.bind(this);\n    this.handleSetControlValue = this.handleSetControlValue.bind(this);\n    this.handleOnContextMenu = this.handleOnContextMenu.bind(this);\n    this.handleContextMenuSelected = this.handleContextMenuSelected.bind(this);\n    this.handleContextMenuClosed = this.handleContextMenuClosed.bind(this);\n    this.onContextMenuFallback = this.onContextMenuFallback.bind(this);\n\n    this.hooks = {\n      onAddFilter: this.handleAddFilter,\n      onContextMenu: this.state.showContextMenu\n        ? this.handleOnContextMenu\n        : undefined,\n      onError: this.handleRenderFailure,\n      setControlValue: this.handleSetControlValue,\n      onFilterMenuOpen: this.props.onFilterMenuOpen,\n      onFilterMenuClose: this.props.onFilterMenuClose,\n      setDataMask: dataMask => {\n        this.props.actions?.updateDataMask(this.props.chartId, dataMask);\n      },\n    };\n\n    // TODO: queriesResponse comes from Redux store but it's being edited by\n    // the plugins, hence we need to clone it to avoid state mutation\n    // until we change the reducers to use Redux Toolkit with Immer\n    this.mutableQueriesResponse = cloneDeep(this.props.queriesResponse);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const resultsReady =\n      nextProps.queriesResponse &&\n      ['success', 'rendered'].indexOf(nextProps.chartStatus) > -1 &&\n      !nextProps.queriesResponse?.[0]?.error;\n\n    if (resultsReady) {\n      if (!isEqual(this.state, nextState)) {\n        return true;\n      }\n      this.hasQueryResponseChange =\n        nextProps.queriesResponse !== this.props.queriesResponse;\n\n      if (this.hasQueryResponseChange) {\n        this.mutableQueriesResponse = cloneDeep(nextProps.queriesResponse);\n      }\n\n      return (\n        this.hasQueryResponseChange ||\n        !isEqual(nextProps.datasource, this.props.datasource) ||\n        nextProps.annotationData !== this.props.annotationData ||\n        nextProps.ownState !== this.props.ownState ||\n        nextProps.filterState !== this.props.filterState ||\n        nextProps.height !== this.props.height ||\n        nextProps.width !== this.props.width ||\n        nextProps.triggerRender ||\n        nextProps.labelColors !== this.props.labelColors ||\n        nextProps.sharedLabelColors !== this.props.sharedLabelColors ||\n        nextProps.formData.color_scheme !== this.props.formData.color_scheme ||\n        nextProps.formData.stack !== this.props.formData.stack ||\n        nextProps.cacheBusterProp !== this.props.cacheBusterProp ||\n        nextProps.emitCrossFilters !== this.props.emitCrossFilters\n      );\n    }\n    return false;\n  }\n\n  handleAddFilter(col, vals, merge = true, refresh = true) {\n    this.props.addFilter(col, vals, merge, refresh);\n  }\n\n  handleRenderSuccess() {\n    const { actions, chartStatus, chartId, vizType } = this.props;\n    if (['loading', 'rendered'].indexOf(chartStatus) < 0) {\n      actions.chartRenderingSucceeded(chartId);\n    }\n\n    // only log chart render time which is triggered by query results change\n    // currently we don't log chart re-render time, like window resize etc\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        viz_type: vizType,\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleRenderFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    // only trigger render log when query is changed\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        has_err: true,\n        error_details: error.toString(),\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleSetControlValue(...args) {\n    const { setControlValue } = this.props;\n    if (setControlValue) {\n      setControlValue(...args);\n    }\n  }\n\n  handleOnContextMenu(offsetX, offsetY, filters) {\n    this.contextMenuRef.current.open(offsetX, offsetY, filters);\n    this.setState({ inContextMenu: true });\n  }\n\n  handleContextMenuSelected() {\n    this.setState({ inContextMenu: false });\n  }\n\n  handleContextMenuClosed() {\n    this.setState({ inContextMenu: false });\n  }\n\n  // When viz plugins don't handle `contextmenu` event, fallback handler\n  // calls `handleOnContextMenu` with no `filters` param.\n  onContextMenuFallback(event) {\n    if (!this.state.inContextMenu) {\n      event.preventDefault();\n      this.handleOnContextMenu(event.clientX, event.clientY);\n    }\n  }\n\n  render() {\n    const { chartAlert, chartStatus, chartId, emitCrossFilters } = this.props;\n\n    // Skip chart rendering\n    if (chartStatus === 'loading' || !!chartAlert || chartStatus === null) {\n      return null;\n    }\n\n    this.renderStartTime = Logger.getTimestamp();\n\n    const {\n      width,\n      height,\n      datasource,\n      annotationData,\n      initialValues,\n      ownState,\n      filterState,\n      chartIsStale,\n      formData,\n      latestQueryFormData,\n      postTransformProps,\n    } = this.props;\n\n    const currentFormData =\n      chartIsStale && latestQueryFormData ? latestQueryFormData : formData;\n    const vizType = currentFormData.viz_type || this.props.vizType;\n\n    // It's bad practice to use unprefixed `vizType` as classnames for chart\n    // container. It may cause css conflicts as in the case of legacy table chart.\n    // When migrating charts, we should gradually add a `superset-chart-` prefix\n    // to each one of them.\n    const snakeCaseVizType = snakeCase(vizType);\n    const chartClassName =\n      vizType === 'table'\n        ? `superset-chart-${snakeCaseVizType}`\n        : snakeCaseVizType;\n\n    const webpackHash =\n      process.env.WEBPACK_MODE === 'development'\n        ? `-${\n            // eslint-disable-next-line camelcase\n            typeof __webpack_require__ !== 'undefined' &&\n            // eslint-disable-next-line camelcase, no-undef\n            typeof __webpack_require__.h === 'function' &&\n            // eslint-disable-next-line no-undef\n            __webpack_require__.h()\n          }`\n        : '';\n\n    let noResultsComponent;\n    const noResultTitle = t('No results were returned for this query');\n    const noResultDescription =\n      this.props.source === ChartSource.Explore\n        ? t(\n            'Make sure that the controls are configured properly and the datasource contains data for the selected time range',\n          )\n        : undefined;\n    const noResultImage = 'chart.svg';\n    if (width > BIG_NO_RESULT_MIN_WIDTH && height > BIG_NO_RESULT_MIN_HEIGHT) {\n      noResultsComponent = (\n        <EmptyStateBig\n          title={noResultTitle}\n          description={noResultDescription}\n          image={noResultImage}\n        />\n      );\n    } else {\n      noResultsComponent = (\n        <EmptyStateSmall title={noResultTitle} image={noResultImage} />\n      );\n    }\n\n    // Check for Behavior.DRILL_TO_DETAIL to tell if chart can receive Drill to\n    // Detail props or if it'll cause side-effects (e.g. excessive re-renders).\n    const drillToDetailProps = getChartMetadataRegistry()\n      .get(formData.viz_type)\n      ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL)\n      ? { inContextMenu: this.state.inContextMenu }\n      : {};\n\n    return (\n      <>\n        {this.state.showContextMenu && (\n          <ChartContextMenu\n            ref={this.contextMenuRef}\n            id={chartId}\n            formData={currentFormData}\n            onSelection={this.handleContextMenuSelected}\n            onClose={this.handleContextMenuClosed}\n          />\n        )}\n        <div\n          onContextMenu={\n            this.state.showContextMenu ? this.onContextMenuFallback : undefined\n          }\n        >\n          <SuperChart\n            disableErrorBoundary\n            key={`${chartId}${webpackHash}`}\n            id={`chart-id-${chartId}`}\n            className={chartClassName}\n            chartType={vizType}\n            width={width}\n            height={height}\n            annotationData={annotationData}\n            datasource={datasource}\n            initialValues={initialValues}\n            formData={currentFormData}\n            ownState={ownState}\n            filterState={filterState}\n            hooks={this.hooks}\n            behaviors={behaviors}\n            queriesData={this.mutableQueriesResponse}\n            onRenderSuccess={this.handleRenderSuccess}\n            onRenderFailure={this.handleRenderFailure}\n            noResults={noResultsComponent}\n            postTransformProps={postTransformProps}\n            emitCrossFilters={emitCrossFilters}\n            {...drillToDetailProps}\n          />\n        </div>\n      </>\n    );\n  }\n}\n\nChartRenderer.propTypes = propTypes;\nChartRenderer.defaultProps = defaultProps;\n\nexport default ChartRenderer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { useChartOwnerNames } from 'src/hooks/apiResources';\nimport ErrorMessageWithStackTrace from 'src/components/ErrorMessage/ErrorMessageWithStackTrace';\nimport { SupersetError } from 'src/components/ErrorMessage/types';\n\ninterface Props {\n  chartId: string;\n  error?: SupersetError;\n}\n\n/**\n * fetches the chart owners and adds them to the extra data of the error message\n */\nexport const ChartErrorMessage: React.FC<Props> = ({\n  chartId,\n  error,\n  ...props\n}) => {\n  const { result: owners } = useChartOwnerNames(chartId);\n\n  // don't mutate props\n  const ownedError = error && {\n    ...error,\n    extra: { ...error.extra, owners },\n  };\n\n  return <ErrorMessageWithStackTrace {...props} error={ownedError} />;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  ensureIsArray,\n  FeatureFlag,\n  logging,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { isCurrentUserBot } from 'src/utils/isBot';\nimport { ChartSource } from 'src/types/ChartSource';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport ChartRenderer from './ChartRenderer';\nimport { ChartErrorMessage } from './ChartErrorMessage';\nimport { getChartRequiredFieldsMissingMessage } from '../../utils/getChartRequiredFieldsMissingMessage';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  // current chart is included by dashboard\n  dashboardId: PropTypes.number,\n  // original selected values for FilterBox viz\n  // so that FilterBox can pre-populate selected values\n  // only affect UI control\n  initialValues: PropTypes.object,\n  // formData contains chart's own filter parameter\n  // and merged with extra filter that current dashboard applying\n  formData: PropTypes.object.isRequired,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  setControlValue: PropTypes.func,\n  timeout: PropTypes.number,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  force: PropTypes.bool,\n  isFiltersInitialized: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  chartStackTrace: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  errorMessage: PropTypes.node,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  onQuery: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  datasetsStatus: PropTypes.oneOf(['loading', 'error', 'complete']),\n  isInView: PropTypes.bool,\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\nconst NONEXISTENT_DATASET = t(\n  'The dataset associated with this chart no longer exists',\n);\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n  dashboardId: null,\n  chartStackTrace: null,\n  force: false,\n  isInView: true,\n};\n\nconst Styles = styled.div`\n  min-height: ${p => p.height}px;\n  position: relative;\n\n  .chart-tooltip {\n    opacity: 0.75;\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  }\n\n  .slice_container {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    height: ${p => p.height}px;\n\n    .pivot_table tbody tr {\n      font-feature-settings: 'tnum' 1;\n    }\n\n    .alert {\n      margin: ${({ theme }) => theme.gridUnit * 2}px;\n    }\n  }\n`;\n\nconst MonospaceDiv = styled.div`\n  font-family: ${({ theme }) => theme.typography.families.monospace};\n  word-break: break-word;\n  overflow-x: auto;\n  white-space: pre-wrap;\n`;\n\nclass Chart extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleRenderContainerFailure =\n      this.handleRenderContainerFailure.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  runQuery() {\n    if (this.props.chartId > 0 && isFeatureEnabled(FeatureFlag.CLIENT_CACHE)) {\n      // Load saved chart with a GET request\n      this.props.actions.getSavedChart(\n        this.props.formData,\n        this.props.force || getUrlParam(URL_PARAMS.force), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    } else {\n      // Create chart with POST request\n      this.props.actions.postChartFormData(\n        this.props.formData,\n        this.props.force || getUrlParam(URL_PARAMS.force), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    }\n  }\n\n  handleRenderContainerFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n      slice_id: chartId,\n      has_err: true,\n      error_details: error.toString(),\n      start_offset: this.renderStartTime,\n      ts: new Date().getTime(),\n      duration: Logger.getTimestamp() - this.renderStartTime,\n    });\n  }\n\n  renderErrorMessage(queryResponse) {\n    const {\n      chartId,\n      chartAlert,\n      chartStackTrace,\n      datasource,\n      dashboardId,\n      height,\n      datasetsStatus,\n    } = this.props;\n    const error = queryResponse?.errors?.[0];\n    const message = chartAlert || queryResponse?.message;\n\n    // if datasource is still loading, don't render JS errors\n    if (\n      chartAlert !== undefined &&\n      chartAlert !== NONEXISTENT_DATASET &&\n      datasource === PLACEHOLDER_DATASOURCE &&\n      datasetsStatus !== ResourceStatus.ERROR\n    ) {\n      return (\n        <Styles\n          key={chartId}\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n        >\n          <Loading />\n        </Styles>\n      );\n    }\n\n    return (\n      <ChartErrorMessage\n        key={chartId}\n        chartId={chartId}\n        error={error}\n        subtitle={<MonospaceDiv>{message}</MonospaceDiv>}\n        copyText={message}\n        link={queryResponse ? queryResponse.link : null}\n        source={dashboardId ? ChartSource.Dashboard : ChartSource.Explore}\n        stackTrace={chartStackTrace}\n      />\n    );\n  }\n\n  render() {\n    const {\n      height,\n      chartAlert,\n      chartStatus,\n      errorMessage,\n      chartIsStale,\n      queriesResponse = [],\n      width,\n    } = this.props;\n\n    const isLoading = chartStatus === 'loading';\n    this.renderContainerStartTime = Logger.getTimestamp();\n    if (chartStatus === 'failed') {\n      return queriesResponse.map(item => this.renderErrorMessage(item));\n    }\n\n    if (errorMessage && ensureIsArray(queriesResponse).length === 0) {\n      return (\n        <EmptyStateBig\n          title={t('Add required control values to preview chart')}\n          description={getChartRequiredFieldsMissingMessage(true)}\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    if (\n      !isLoading &&\n      !chartAlert &&\n      !errorMessage &&\n      chartIsStale &&\n      ensureIsArray(queriesResponse).length === 0\n    ) {\n      return (\n        <EmptyStateBig\n          title={t('Your chart is ready to go!')}\n          description={\n            <span>\n              {t(\n                'Click on \"Create chart\" button in the control panel on the left to preview a visualization or',\n              )}{' '}\n              <span role=\"button\" tabIndex={0} onClick={this.props.onQuery}>\n                {t('click here')}\n              </span>\n              .\n            </span>\n          }\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    return (\n      <ErrorBoundary\n        onError={this.handleRenderContainerFailure}\n        showMessage={false}\n      >\n        <Styles\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n          width={width}\n        >\n          <div className=\"slice_container\" data-test=\"slice-container\">\n            {this.props.isInView ||\n            !isFeatureEnabled(FeatureFlag.DASHBOARD_VIRTUALIZATION) ||\n            isCurrentUserBot() ? (\n              <ChartRenderer\n                {...this.props}\n                source={this.props.dashboardId ? 'dashboard' : 'explore'}\n                data-test={this.props.vizType}\n              />\n            ) : (\n              <Loading />\n            )}\n          </div>\n          {isLoading && <Loading />}\n        </Styles>\n      </ErrorBoundary>\n    );\n  }\n}\n\nChart.propTypes = propTypes;\nChart.defaultProps = defaultProps;\n\nexport default Chart;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport * as actions from './chartAction';\nimport { logEvent } from '../../logger/actions';\nimport Chart from './Chart';\nimport { updateDataMask } from '../../dataMask/actions';\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...actions,\n        updateDataMask,\n        logEvent,\n      },\n      dispatch,\n    ),\n  };\n}\n\nexport default connect(null, mapDispatchToProps)(Chart);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback(e => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData)\n      .then(url => {\n        setUrl(url);\n        setErrorMessage('');\n      })\n      .catch(() => {\n        setErrorMessage(t('Error'));\n        addDangerToast(t('Sorry, something went wrong. Try again later.'));\n      });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>'\n    );\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    <div id=\"embed-code-popover\" data-test=\"embed-code-popover\">\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n        `}\n      >\n        <CopyToClipboard\n          shouldShowText={false}\n          text={html}\n          copyNode={\n            <CopyButtonEmbedCode buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonEmbedCode>\n          }\n        />\n        <TextArea\n          data-test=\"embed-code-textarea\"\n          name=\"embedCode\"\n          disabled={!html}\n          value={text}\n          rows=\"4\"\n          readOnly\n          css={theme => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          `}\n        />\n      </div>\n      <div\n        css={theme => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `}\n      >\n        <div>\n          <label htmlFor=\"embed-height\">{t('Chart height')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={height}\n            name=\"height\"\n            onChange={handleInputChange}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"embed-width\">{t('Chart width')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={width}\n            name=\"width\"\n            onChange={handleInputChange}\n            id=\"embed-width\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmbedCodeContent;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport { Link } from 'react-router-dom';\n\nexport interface DashboardsSubMenuProps {\n  chartId?: number;\n  dashboards?: { id: number; dashboard_title: string }[];\n}\n\nconst WIDTH = 220;\nconst HEIGHT = 300;\nconst SEARCH_THRESHOLD = 10;\n\nconst DashboardsSubMenu = ({\n  chartId,\n  dashboards = [],\n  ...menuProps\n}: DashboardsSubMenuProps) => {\n  const theme = useTheme();\n  const [dashboardSearch, setDashboardSearch] = useState<string>();\n  const [hoveredItem, setHoveredItem] = useState<number | null>();\n  const showSearch = dashboards.length > SEARCH_THRESHOLD;\n  const filteredDashboards = dashboards.filter(\n    dashboard =>\n      !dashboardSearch ||\n      dashboard.dashboard_title\n        .toLowerCase()\n        .includes(dashboardSearch.toLowerCase()),\n  );\n  const noResults = dashboards.length === 0;\n  const noResultsFound = dashboardSearch && filteredDashboards.length === 0;\n  const urlQueryString = chartId ? `?focused_chart=${chartId}` : '';\n  return (\n    <>\n      {showSearch && (\n        <Input\n          allowClear\n          placeholder={t('Search')}\n          prefix={<Icons.Search iconSize=\"l\" />}\n          css={css`\n            width: ${WIDTH}px;\n            margin: ${theme.gridUnit * 2}px ${theme.gridUnit * 3}px;\n          `}\n          value={dashboardSearch}\n          onChange={e => setDashboardSearch(e.currentTarget.value)}\n        />\n      )}\n      <div\n        css={css`\n          max-height: ${HEIGHT}px;\n          overflow: auto;\n        `}\n      >\n        {filteredDashboards.map(dashboard => (\n          <Menu.Item\n            key={String(dashboard.id)}\n            onMouseEnter={() => setHoveredItem(dashboard.id)}\n            onMouseLeave={() => {\n              if (hoveredItem === dashboard.id) {\n                setHoveredItem(null);\n              }\n            }}\n            {...menuProps}\n          >\n            <Link\n              target=\"_blank\"\n              rel=\"noreferer noopener\"\n              to={`/superset/dashboard/${dashboard.id}${urlQueryString}`}\n            >\n              <div\n                css={css`\n                  display: flex;\n                  flex-direction: row;\n                  align-items: center;\n                  max-width: ${WIDTH}px;\n                `}\n              >\n                <div\n                  css={css`\n                    white-space: normal;\n                  `}\n                >\n                  {dashboard.dashboard_title}\n                </div>\n                <Icons.Full\n                  iconSize=\"l\"\n                  iconColor={theme.colors.grayscale.base}\n                  css={css`\n                    margin-left: ${theme.gridUnit * 2}px;\n                    visibility: ${hoveredItem === dashboard.id\n                      ? 'visible'\n                      : 'hidden'};\n                  `}\n                />\n              </div>\n            </Link>\n          </Menu.Item>\n        ))}\n        {noResultsFound && (\n          <div\n            css={css`\n              margin-left: ${theme.gridUnit * 3}px;\n              margin-bottom: ${theme.gridUnit}px;\n            `}\n          >\n            {t('No results found')}\n          </div>\n        )}\n        {noResults && (\n          <Menu.Item\n            disabled\n            css={css`\n              min-width: ${WIDTH}px;\n            `}\n            {...menuProps}\n          >\n            {t('None')}\n          </Menu.Item>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default DashboardsSubMenu;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { css, FeatureFlag, styled, t, useTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { exportChart, getChartKey } from 'src/explore/exploreUtils';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport copyTextToClipboard from 'src/utils/copy';\nimport HeaderReportDropDown from 'src/components/ReportModal/HeaderReportDropdown';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport ViewQueryModal from '../controls/ViewQueryModal';\nimport EmbedCodeContent from '../EmbedCodeContent';\nimport DashboardsSubMenu from './DashboardsSubMenu';\n\nconst MENU_KEYS = {\n  EDIT_PROPERTIES: 'edit_properties',\n  DASHBOARDS_ADDED_TO: 'dashboards_added_to',\n  DOWNLOAD_SUBMENU: 'download_submenu',\n  EXPORT_TO_CSV: 'export_to_csv',\n  EXPORT_TO_CSV_PIVOTED: 'export_to_csv_pivoted',\n  EXPORT_TO_JSON: 'export_to_json',\n  EXPORT_TO_XLSX: 'export_to_xlsx',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  SHARE_SUBMENU: 'share_submenu',\n  COPY_PERMALINK: 'copy_permalink',\n  EMBED_CODE: 'embed_code',\n  SHARE_BY_EMAIL: 'share_by_email',\n  REPORT_SUBMENU: 'report_submenu',\n  SET_UP_REPORT: 'set_up_report',\n  SET_REPORT_ACTIVE: 'set_report_active',\n  EDIT_REPORT: 'edit_report',\n  DELETE_REPORT: 'delete_report',\n  VIEW_QUERY: 'view_query',\n  RUN_IN_SQL_LAB: 'run_in_sql_lab',\n};\n\nconst VIZ_TYPES_PIVOTABLE = ['pivot_table', 'pivot_table_v2'];\n\nexport const MenuItemWithCheckboxContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n\n    & svg {\n      width: ${theme.gridUnit * 3}px;\n      height: ${theme.gridUnit * 3}px;\n    }\n\n    & span[role='checkbox'] {\n      display: inline-flex;\n      margin-right: ${theme.gridUnit}px;\n    }\n  `}\n`;\n\nexport const MenuTrigger = styled(Button)`\n  ${({ theme }) => css`\n    width: ${theme.gridUnit * 8}px;\n    height: ${theme.gridUnit * 8}px;\n    padding: 0;\n    border: 1px solid ${theme.colors.primary.dark2};\n\n    &.ant-btn > span.anticon {\n      line-height: 0;\n      transition: inherit;\n    }\n\n    &:hover:not(:focus) > span.anticon {\n      color: ${theme.colors.primary.light1};\n    }\n  `}\n`;\n\nconst iconReset = css`\n  .ant-dropdown-menu-item > & > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nexport const useExploreAdditionalActionsMenu = (\n  latestQueryFormData,\n  canDownloadCSV,\n  slice,\n  onOpenInEditor,\n  onOpenPropertiesModal,\n  ownState,\n  dashboards,\n) => {\n  const theme = useTheme();\n  const { addDangerToast, addSuccessToast } = useToasts();\n  const [showReportSubMenu, setShowReportSubMenu] = useState(null);\n  const [isDropdownVisible, setIsDropdownVisible] = useState(false);\n  const [openSubmenus, setOpenSubmenus] = useState([]);\n  const chart = useSelector(\n    state => state.charts?.[getChartKey(state.explore)],\n  );\n\n  const { datasource } = latestQueryFormData;\n\n  const shareByEmail = useCallback(async () => {\n    try {\n      const subject = t('Superset Chart');\n      const url = await getChartPermalink(latestQueryFormData);\n      const body = encodeURIComponent(t('%s%s', 'Check out this chart: ', url));\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, latestQueryFormData]);\n\n  const exportCSV = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            ownState,\n            resultType: 'full',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportCSVPivoted = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'post_processed',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportJson = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'json',\n      }),\n    [latestQueryFormData],\n  );\n\n  const exportExcel = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'xlsx',\n      }),\n    [latestQueryFormData],\n  );\n\n  const copyLink = useCallback(async () => {\n    try {\n      if (!latestQueryFormData) {\n        throw new Error();\n      }\n      await copyTextToClipboard(() => getChartPermalink(latestQueryFormData));\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, addSuccessToast, latestQueryFormData]);\n\n  const handleMenuClick = useCallback(\n    ({ key, domEvent }) => {\n      switch (key) {\n        case MENU_KEYS.EDIT_PROPERTIES:\n          onOpenPropertiesModal();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV:\n          exportCSV();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV_PIVOTED:\n          exportCSVPivoted();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EXPORT_TO_JSON:\n          exportJson();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n\n          break;\n        case MENU_KEYS.EXPORT_TO_XLSX:\n          exportExcel();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.DOWNLOAD_AS_IMAGE:\n          downloadAsImage(\n            '.panel-body .chart-container',\n            // eslint-disable-next-line camelcase\n            slice?.slice_name ?? t('New chart'),\n            true,\n          )(domEvent);\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.COPY_PERMALINK:\n          copyLink();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EMBED_CODE:\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.SHARE_BY_EMAIL:\n          shareByEmail();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.VIEW_QUERY:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.RUN_IN_SQL_LAB:\n          onOpenInEditor(latestQueryFormData);\n          setIsDropdownVisible(false);\n          break;\n        default:\n          break;\n      }\n    },\n    [\n      copyLink,\n      exportCSV,\n      exportCSVPivoted,\n      exportJson,\n      latestQueryFormData,\n      onOpenInEditor,\n      onOpenPropertiesModal,\n      shareByEmail,\n      slice?.slice_name,\n    ],\n  );\n\n  const menu = useMemo(\n    () => (\n      <Menu\n        onClick={handleMenuClick}\n        selectable={false}\n        openKeys={openSubmenus}\n        onOpenChange={setOpenSubmenus}\n      >\n        <>\n          {slice && (\n            <Menu.Item key={MENU_KEYS.EDIT_PROPERTIES}>\n              {t('Edit chart properties')}\n            </Menu.Item>\n          )}\n          <Menu.SubMenu\n            title={t('Dashboards added to')}\n            key={MENU_KEYS.DASHBOARDS_ADDED_TO}\n          >\n            <DashboardsSubMenu\n              chartId={slice?.slice_id}\n              dashboards={dashboards}\n            />\n          </Menu.SubMenu>\n          <Menu.Divider />\n        </>\n        <Menu.SubMenu title={t('Download')} key={MENU_KEYS.DOWNLOAD_SUBMENU}>\n          {VIZ_TYPES_PIVOTABLE.includes(latestQueryFormData.viz_type) ? (\n            <>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to original .CSV')}\n              </Menu.Item>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV_PIVOTED}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to pivoted .CSV')}\n              </Menu.Item>\n            </>\n          ) : (\n            <Menu.Item\n              key={MENU_KEYS.EXPORT_TO_CSV}\n              icon={<Icons.FileOutlined css={iconReset} />}\n              disabled={!canDownloadCSV}\n            >\n              {t('Export to .CSV')}\n            </Menu.Item>\n          )}\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_JSON}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to .JSON')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n            icon={<Icons.FileImageOutlined css={iconReset} />}\n          >\n            {t('Download as image')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_XLSX}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to Excel')}\n          </Menu.Item>\n        </Menu.SubMenu>\n        <Menu.SubMenu title={t('Share')} key={MENU_KEYS.SHARE_SUBMENU}>\n          <Menu.Item key={MENU_KEYS.COPY_PERMALINK}>\n            {t('Copy permalink to clipboard')}\n          </Menu.Item>\n          <Menu.Item key={MENU_KEYS.SHARE_BY_EMAIL}>\n            {t('Share chart by email')}\n          </Menu.Item>\n          {isFeatureEnabled(FeatureFlag.EMBEDDABLE_CHARTS) ? (\n            <Menu.Item key={MENU_KEYS.EMBED_CODE}>\n              <ModalTrigger\n                triggerNode={\n                  <span data-test=\"embed-code-button\">{t('Embed code')}</span>\n                }\n                modalTitle={t('Embed code')}\n                modalBody={\n                  <EmbedCodeContent\n                    formData={latestQueryFormData}\n                    addDangerToast={addDangerToast}\n                  />\n                }\n                maxWidth={`${theme.gridUnit * 100}px`}\n                destroyOnClose\n                responsive\n              />\n            </Menu.Item>\n          ) : null}\n        </Menu.SubMenu>\n        <Menu.Divider />\n        {showReportSubMenu ? (\n          <>\n            <Menu.SubMenu title={t('Manage email report')}>\n              <HeaderReportDropDown\n                chart={chart}\n                setShowReportSubMenu={setShowReportSubMenu}\n                showReportSubMenu={showReportSubMenu}\n                setIsDropdownVisible={setIsDropdownVisible}\n                isDropdownVisible={isDropdownVisible}\n                useTextMenu\n              />\n            </Menu.SubMenu>\n            <Menu.Divider />\n          </>\n        ) : (\n          <Menu>\n            <HeaderReportDropDown\n              chart={chart}\n              setShowReportSubMenu={setShowReportSubMenu}\n              setIsDropdownVisible={setIsDropdownVisible}\n              isDropdownVisible={isDropdownVisible}\n              useTextMenu\n            />\n          </Menu>\n        )}\n        <Menu.Item key={MENU_KEYS.VIEW_QUERY}>\n          <ModalTrigger\n            triggerNode={\n              <span data-test=\"view-query-menu-item\">{t('View query')}</span>\n            }\n            modalTitle={t('View query')}\n            modalBody={\n              <ViewQueryModal latestQueryFormData={latestQueryFormData} />\n            }\n            draggable\n            resizable\n            responsive\n          />\n        </Menu.Item>\n        {datasource && (\n          <Menu.Item key={MENU_KEYS.RUN_IN_SQL_LAB}>\n            {t('Run in SQL Lab')}\n          </Menu.Item>\n        )}\n      </Menu>\n    ),\n    [\n      addDangerToast,\n      canDownloadCSV,\n      chart,\n      dashboards,\n      handleMenuClick,\n      isDropdownVisible,\n      latestQueryFormData,\n      openSubmenus,\n      showReportSubMenu,\n      slice,\n      theme.gridUnit,\n    ],\n  );\n  return [menu, isDropdownVisible, setIsDropdownVisible];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode } from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\n\nexport const MenuItemTooltip = ({\n  title,\n  color,\n}: {\n  title: ReactNode;\n  color?: string;\n}) => (\n  <Tooltip title={title} placement=\"top\">\n    <Icons.InfoCircleOutlined\n      data-test=\"tooltip-trigger\"\n      css={(theme: SupersetTheme) => css`\n        color: ${color || theme.colors.text.label};\n        margin-left: ${theme.gridUnit * 2}px;\n        &.anticon {\n          font-size: unset;\n          .anticon {\n            line-height: unset;\n            vertical-align: unset;\n          }\n        }\n      `}\n    />\n  </Tooltip>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { BOOL_FALSE_DISPLAY, BOOL_TRUE_DISPLAY } from 'src/constants';\n\nexport interface BooleanCellProps {\n  value?: boolean;\n}\n\nfunction BooleanCell({ value }: BooleanCellProps) {\n  return <span>{value ? BOOL_TRUE_DISPLAY : BOOL_FALSE_DISPLAY}</span>;\n}\n\nexport default BooleanCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport { NULL_DISPLAY } from 'src/constants';\n\nfunction NullCell() {\n  return (\n    <span\n      css={(theme: SupersetTheme) => css`\n        color: ${theme.colors.grayscale.light1};\n      `}\n    >\n      {NULL_DISPLAY}\n    </span>\n  );\n}\n\nexport default NullCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { getTimeFormatter, TimeFormats } from '@superset-ui/core';\nimport NullCell from '../NullCell';\n\nexport interface TimeCellProps {\n  format?: string;\n  value?: number | Date;\n}\n\nfunction TimeCell({\n  format = TimeFormats.DATABASE_DATETIME,\n  value,\n}: TimeCellProps) {\n  if (value) {\n    return <span>{getTimeFormatter(format).format(value)}</span>;\n  }\n  return <NullCell />;\n}\n\nexport default TimeCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, useTheme } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { Space } from 'src/components';\nimport Icons from 'src/components/Icons';\nimport Popover from 'src/components/Popover';\n\nexport interface HeaderWithRadioGroupProps {\n  headerTitle: string;\n  groupTitle: string;\n  groupOptions: { label: string; value: string | number }[];\n  value?: string | number;\n  onChange: (value: string) => void;\n}\n\nfunction HeaderWithRadioGroup(props: HeaderWithRadioGroupProps) {\n  const { headerTitle, groupTitle, groupOptions, value, onChange } = props;\n  const theme = useTheme();\n  const [popoverVisible, setPopoverVisible] = useState(false);\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        align-items: center;\n      `}\n    >\n      <Popover\n        trigger=\"click\"\n        visible={popoverVisible}\n        content={\n          <div>\n            <div\n              css={css`\n                font-weight: ${theme.typography.weights.bold};\n                margin-bottom: ${theme.gridUnit}px;\n              `}\n            >\n              {groupTitle}\n            </div>\n            <Radio.Group\n              value={value}\n              onChange={e => {\n                onChange(e.target.value);\n                setPopoverVisible(false);\n              }}\n            >\n              <Space direction=\"vertical\">\n                {groupOptions.map(option => (\n                  <Radio key={option.value} value={option.value}>\n                    {option.label}\n                  </Radio>\n                ))}\n              </Space>\n            </Radio.Group>\n          </div>\n        }\n        placement=\"bottomLeft\"\n        arrowPointAtCenter\n      >\n        <Icons.SettingOutlined\n          iconSize=\"m\"\n          iconColor={theme.colors.grayscale.light1}\n          css={css`\n            margin-top: 3px; // we need exactly 3px to align the icon\n            margin-right: ${theme.gridUnit}px;\n          `}\n          onClick={() => setPopoverVisible(true)}\n        />\n      </Popover>\n      {headerTitle}\n    </div>\n  );\n}\n\nexport default HeaderWithRadioGroup;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\nimport { Tag } from 'antd';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  isAdhocColumn,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport RowCountLabel from 'src/explore/components/RowCountLabel';\nimport Icons from 'src/components/Icons';\n\nexport default function TableControls({\n  filters,\n  setFilters,\n  totalCount,\n  loading,\n  onReload,\n}: {\n  filters: BinaryQueryObjectFilterClause[];\n  setFilters: (filters: BinaryQueryObjectFilterClause[]) => void;\n  totalCount?: number;\n  loading: boolean;\n  onReload: () => void;\n}) {\n  const theme = useTheme();\n  const filterMap: Record<string, BinaryQueryObjectFilterClause> = useMemo(\n    () =>\n      Object.assign(\n        {},\n        ...filters.map(filter => ({\n          [isAdhocColumn(filter.col)\n            ? (filter.col.label as string)\n            : filter.col]: filter,\n        })),\n      ),\n    [filters],\n  );\n\n  const removeFilter = useCallback(\n    colName => {\n      const updatedFilterMap = { ...filterMap };\n      delete updatedFilterMap[colName];\n      setFilters([...Object.values(updatedFilterMap)]);\n    },\n    [filterMap, setFilters],\n  );\n\n  const filterTags = useMemo(\n    () =>\n      Object.entries(filterMap)\n        .map(([colName, { val, formattedVal }]) => ({\n          colName,\n          val: formattedVal ?? val,\n        }))\n        .sort((a, b) => a.colName.localeCompare(b.colName)),\n    [filterMap],\n  );\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        justify-content: space-between;\n        padding: ${theme.gridUnit / 2}px 0;\n        margin-bottom: ${theme.gridUnit * 2}px;\n      `}\n    >\n      <div\n        css={css`\n          display: flex;\n          flex-wrap: wrap;\n          margin-bottom: -${theme.gridUnit * 4}px;\n        `}\n      >\n        {filterTags.map(({ colName, val }) => (\n          <Tag\n            closable\n            onClose={removeFilter.bind(null, colName)}\n            key={colName}\n            css={css`\n              height: ${theme.gridUnit * 6}px;\n              display: flex;\n              align-items: center;\n              padding: ${theme.gridUnit / 2}px ${theme.gridUnit * 2}px;\n              margin-right: ${theme.gridUnit * 4}px;\n              margin-bottom: ${theme.gridUnit * 4}px;\n              line-height: 1.2;\n            `}\n            data-test=\"filter-col\"\n          >\n            <span\n              css={css`\n                margin-right: ${theme.gridUnit}px;\n              `}\n            >\n              {colName}\n            </span>\n            <strong data-test=\"filter-val\">{val}</strong>\n          </Tag>\n        ))}\n      </div>\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n          height: min-content;\n        `}\n      >\n        <RowCountLabel loading={loading && !totalCount} rowcount={totalCount} />\n        <Icons.ReloadOutlined\n          iconColor={theme.colors.grayscale.light1}\n          iconSize=\"l\"\n          aria-label={t('Reload')}\n          role=\"button\"\n          onClick={onReload}\n        />\n      </div>\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  ensureIsArray,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, { ColumnsType, TableSize } from 'src/components/Table';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';\nimport { ResultsPage } from './types';\n\nconst PAGE_SIZE = 50;\n\ninterface DataType {\n  [key: string]: any;\n}\n\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nfunction Resizable({ children }: { children: ReactElement }) {\n  const { ref, height } = useResizeDetector();\n  return (\n    <div ref={ref} css={{ flex: 1 }}>\n      {React.cloneElement(children, { height })}\n    </div>\n  );\n}\n\nenum TimeFormatting {\n  Original,\n  Formatted,\n}\n\nexport default function DrillDetailPane({\n  formData,\n  initialFilters,\n}: {\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n}) {\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState<Map<number, ResultsPage>>(\n    new Map(),\n  );\n  const [timeFormatting, setTimeFormatting] = useState({});\n\n  const SAMPLES_ROW_LIMIT = useSelector(\n    (state: { common: { conf: JsonObject } }) =>\n      state.common.conf.SAMPLES_ROW_LIMIT,\n  );\n\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(\n    () => formData.datasource.split('__'),\n    [formData.datasource],\n  );\n\n  const { metadataBar, status: metadataBarStatus } = useDatasetMetadataBar({\n    datasetId: datasourceId,\n  });\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n\n  const mappedColumns: ColumnsType<DataType> = useMemo(\n    () =>\n      resultsPage?.colNames.map((column, index) => ({\n        key: column,\n        dataIndex: column,\n        title:\n          resultsPage?.colTypes[index] === GenericDataType.TEMPORAL ? (\n            <HeaderWithRadioGroup\n              headerTitle={column}\n              groupTitle={t('Formatting')}\n              groupOptions={[\n                { label: t('Original value'), value: TimeFormatting.Original },\n                {\n                  label: t('Formatted value'),\n                  value: TimeFormatting.Formatted,\n                },\n              ]}\n              value={\n                timeFormatting[column] === TimeFormatting.Original\n                  ? TimeFormatting.Original\n                  : TimeFormatting.Formatted\n              }\n              onChange={value =>\n                setTimeFormatting(state => ({ ...state, [column]: value }))\n              }\n            />\n          ) : (\n            column\n          ),\n        render: value => {\n          if (value === true || value === false) {\n            return <BooleanCell value={value} />;\n          }\n          if (value === null) {\n            return <NullCell />;\n          }\n          if (\n            resultsPage?.colTypes[index] === GenericDataType.TEMPORAL &&\n            timeFormatting[column] !== TimeFormatting.Original &&\n            (typeof value === 'number' || value instanceof Date)\n          ) {\n            return <TimeCell value={value} />;\n          }\n          return String(value);\n        },\n        width: 150,\n      })) || [],\n    [resultsPage?.colNames, resultsPage?.colTypes, timeFormatting],\n  );\n\n  const data: DataType[] = useMemo(\n    () =>\n      resultsPage?.data.map((row, index) =>\n        resultsPage?.colNames.reduce(\n          (acc, curr) => ({ ...acc, [curr]: row[curr] }),\n          {\n            key: index,\n          },\n        ),\n      ) || [],\n    [resultsPage?.colNames, resultsPage?.data],\n  );\n\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (\n      resultsPages.has(pageIndex) &&\n      [...resultsPages.keys()].at(-1) !== pageIndex\n    ) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(\n        nextResultsPages.set(\n          pageIndex,\n          resultsPages.get(pageIndex) as ResultsPage,\n        ),\n      );\n    }\n  }, [pageIndex, resultsPages]);\n\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {\n      setIsLoading(true);\n      const jsonPayload = getDrillPayload(formData, filters) ?? {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(\n        datasourceType,\n        datasourceId,\n        false,\n        jsonPayload,\n        PAGE_SIZE,\n        pageIndex + 1,\n      )\n        .then(response => {\n          setResultsPages(\n            new Map([\n              ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n              [\n                pageIndex,\n                {\n                  total: response.total_count,\n                  data: response.data,\n                  colNames: ensureIsArray(response.colnames),\n                  colTypes: ensureIsArray(response.coltypes),\n                },\n              ],\n            ]),\n          );\n          setResponseError('');\n        })\n        .catch(error => {\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [\n    SAMPLES_ROW_LIMIT,\n    datasourceId,\n    datasourceType,\n    filters,\n    formData,\n    isLoading,\n    pageIndex,\n    responseError,\n    resultsPages,\n  ]);\n\n  const bootstrapping =\n    (!responseError && !resultsPages.size) ||\n    metadataBarStatus === ResourceStatus.LOADING;\n\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = (\n      <pre\n        css={css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {responseError}\n      </pre>\n    );\n  } else if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = <Loading />;\n  } else if (resultsPage?.total === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = <EmptyStateMedium image=\"document.svg\" title={title} />;\n  } else {\n    // Render table if at least one page has successfully loaded\n    tableContent = (\n      <Resizable>\n        <Table\n          data={data}\n          columns={mappedColumns}\n          size={TableSize.SMALL}\n          defaultPageSize={PAGE_SIZE}\n          recordCount={resultsPage?.total}\n          usePagination\n          loading={isLoading}\n          onChange={pagination =>\n            setPageIndex(pagination.current ? pagination.current - 1 : 0)\n          }\n          resizable\n          virtualize\n        />\n      </Resizable>\n    );\n  }\n\n  return (\n    <>\n      {!bootstrapping && metadataBar}\n      {!bootstrapping && (\n        <TableControls\n          filters={filters}\n          setFilters={setFilters}\n          totalCount={resultsPage?.total}\n          loading={isLoading}\n          onReload={handleReload}\n        />\n      )}\n      {tableContent}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { omit } from 'lodash';\nimport {\n  ensureIsArray,\n  QueryFormData,\n  BinaryQueryObjectFilterClause,\n  buildQueryObject,\n} from '@superset-ui/core';\n\nexport function getDrillPayload(\n  queryFormData?: QueryFormData,\n  drillFilters?: BinaryQueryObjectFilterClause[],\n) {\n  if (!queryFormData) {\n    return undefined;\n  }\n  const queryObject = buildQueryObject(queryFormData);\n  const extras = omit(queryObject.extras, 'having');\n  const filters = [\n    ...ensureIsArray(queryObject.filters),\n    ...ensureIsArray(drillFilters).map(f => omit(f, 'formattedVal')),\n  ];\n  return {\n    granularity: queryObject.granularity,\n    time_range: queryObject.time_range,\n    filters,\n    extras,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { Slice } from 'src/types/Chart';\nimport DrillDetailPane from './DrillDetailPane';\n\ninterface ModalFooterProps {\n  exploreChart: () => void;\n  closeModal?: () => void;\n}\n\nconst ModalFooter = ({ exploreChart, closeModal }: ModalFooterProps) => (\n  <>\n    <Button buttonStyle=\"secondary\" buttonSize=\"small\" onClick={exploreChart}>\n      {t('Edit chart')}\n    </Button>\n    <Button\n      buttonStyle=\"primary\"\n      buttonSize=\"small\"\n      onClick={closeModal}\n      data-test=\"close-drilltodetail-modal\"\n    >\n      {t('Close')}\n    </Button>\n  </>\n);\n\ninterface DrillDetailModalProps {\n  chartId: number;\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n  showModal: boolean;\n  onHideModal: () => void;\n}\n\nexport default function DrillDetailModal({\n  chartId,\n  formData,\n  initialFilters,\n  showModal,\n  onHideModal,\n}: DrillDetailModalProps) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector(\n    (state: { sliceEntities: { slices: Record<number, Slice> } }) =>\n      state.sliceEntities.slices[chartId],\n  );\n\n  const exploreUrl = useMemo(\n    () => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`,\n    [chartId, dashboardPageId],\n  );\n\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n\n  return (\n    <Modal\n      show={showModal}\n      onHide={onHideModal ?? (() => null)}\n      css={css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `}\n      title={t('Drill to detail: %s', chartName)}\n      footer={<ModalFooter exploreChart={exploreChart} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '75vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <DrillDetailPane formData={formData} initialFilters={initialFilters} />\n    </Modal>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode, useCallback, useMemo, useState } from 'react';\nimport { isEmpty } from 'lodash';\nimport {\n  Behavior,\n  BinaryQueryObjectFilterClause,\n  css,\n  extractQueryFields,\n  getChartMetadataRegistry,\n  QueryFormData,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport DrillDetailModal from './DrillDetailModal';\nimport { getSubmenuYOffset } from '../utils';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport { MenuItemWithTruncation } from '../MenuItemWithTruncation';\n\nconst DRILL_TO_DETAIL_TEXT = t('Drill to detail by');\n\nconst DisabledMenuItem = ({ children, ...props }: { children: ReactNode }) => (\n  <Menu.Item disabled {...props}>\n    <div\n      css={css`\n        white-space: normal;\n        max-width: 160px;\n      `}\n    >\n      {children}\n    </div>\n  </Menu.Item>\n);\n\nconst Filter = styled.span`\n  ${({ theme }) => `\n     font-weight: ${theme.typography.weights.bold};\n     color: ${theme.colors.primary.base};\n   `}\n`;\n\nexport type DrillDetailMenuItemsProps = {\n  chartId: number;\n  formData: QueryFormData;\n  filters?: BinaryQueryObjectFilterClause[];\n  isContextMenu?: boolean;\n  contextMenuY?: number;\n  onSelection?: () => void;\n  onClick?: (event: MouseEvent) => void;\n  submenuIndex?: number;\n};\n\nconst DrillDetailMenuItems = ({\n  chartId,\n  formData,\n  filters = [],\n  isContextMenu = false,\n  contextMenuY = 0,\n  onSelection = () => null,\n  onClick = () => null,\n  submenuIndex = 0,\n  ...props\n}: DrillDetailMenuItemsProps) => {\n  const [modalFilters, setFilters] = useState<BinaryQueryObjectFilterClause[]>(\n    [],\n  );\n\n  const [showModal, setShowModal] = useState(false);\n  const openModal = useCallback(\n    (filters, event) => {\n      onClick(event);\n      onSelection();\n      setFilters(filters);\n      setShowModal(true);\n    },\n    [onClick, onSelection],\n  );\n\n  const closeModal = useCallback(() => {\n    setShowModal(false);\n  }, []);\n\n  // Check for Behavior.DRILL_TO_DETAIL to tell if plugin handles the `contextmenu`\n  // event for dimensions.  If it doesn't, tell the user that drill to detail by\n  // dimension is not supported.  If it does, and the `contextmenu` handler didn't\n  // pass any filters, tell the user that they didn't select a dimension.\n  const handlesDimensionContextMenu = useMemo(\n    () =>\n      getChartMetadataRegistry()\n        .get(formData.viz_type)\n        ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL),\n    [formData.viz_type],\n  );\n\n  // Check metrics to see if chart's current configuration lacks\n  // aggregations, in which case Drill to Detail should be disabled.\n  const noAggregations = useMemo(() => {\n    const { metrics } = extractQueryFields(formData);\n    return isEmpty(metrics);\n  }, [formData]);\n\n  let drillToDetailMenuItem;\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-no-aggregations\">\n        {t('Drill to detail')}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail is disabled because this chart does not group data by dimension value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  } else {\n    drillToDetailMenuItem = (\n      <Menu.Item\n        {...props}\n        key=\"drill-detail-no-filters\"\n        onClick={openModal.bind(null, [])}\n      >\n        {t('Drill to detail')}\n      </Menu.Item>\n    );\n  }\n\n  let drillToDetailByMenuItem;\n  if (!handlesDimensionContextMenu) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-chart-not-supported\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail by value is not yet supported for this chart type.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-no-aggregations\">\n        {DRILL_TO_DETAIL_TEXT}\n      </DisabledMenuItem>\n    );\n  }\n\n  // Ensure submenu doesn't appear offscreen\n  const submenuYOffset = useMemo(\n    () =>\n      getSubmenuYOffset(\n        contextMenuY,\n        filters.length > 1 ? filters.length + 1 : filters.length,\n        submenuIndex,\n      ),\n    [contextMenuY, filters.length, submenuIndex],\n  );\n\n  if (handlesDimensionContextMenu && !noAggregations && filters?.length) {\n    drillToDetailByMenuItem = (\n      <Menu.SubMenu\n        {...props}\n        popupOffset={[0, submenuYOffset]}\n        popupClassName=\"chart-context-submenu\"\n        title={DRILL_TO_DETAIL_TEXT}\n      >\n        <div data-test=\"drill-to-detail-by-submenu\">\n          {filters.map((filter, i) => (\n            <MenuItemWithTruncation\n              {...props}\n              tooltipText={`${DRILL_TO_DETAIL_TEXT} ${filter.formattedVal}`}\n              key={`drill-detail-filter-${i}`}\n              onClick={openModal.bind(null, [filter])}\n            >\n              {`${DRILL_TO_DETAIL_TEXT} `}\n              <Filter>{filter.formattedVal}</Filter>\n            </MenuItemWithTruncation>\n          ))}\n          {filters.length > 1 && (\n            <Menu.Item\n              {...props}\n              key=\"drill-detail-filter-all\"\n              onClick={openModal.bind(null, filters)}\n            >\n              <div>\n                {`${DRILL_TO_DETAIL_TEXT} `}\n                <Filter>{t('all')}</Filter>\n              </div>\n            </Menu.Item>\n          )}\n        </div>\n      </Menu.SubMenu>\n    );\n  }\n\n  if (handlesDimensionContextMenu && !noAggregations && !filters?.length) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-select-aggregation\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Right-click on a dimension value to drill to detail by that value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  return (\n    <>\n      {drillToDetailMenuItem}\n      {isContextMenu && drillToDetailByMenuItem}\n      <DrillDetailModal\n        chartId={chartId}\n        formData={formData}\n        initialFilters={modalFilters}\n        showModal={showModal}\n        onHideModal={closeModal}\n      />\n    </>\n  );\n};\n\nexport default DrillDetailMenuItems;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode } from 'react';\nimport { css, truncationCSS, useCSSTextTruncation } from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport { Tooltip } from 'src/components/Tooltip';\nimport type { MenuProps } from 'antd/lib/menu';\n\nexport type MenuItemWithTruncationProps = {\n  tooltipText: ReactNode;\n  children: ReactNode;\n  onClick?: MenuProps['onClick'];\n};\n\nexport const MenuItemWithTruncation = ({\n  tooltipText,\n  children,\n  ...props\n}: MenuItemWithTruncationProps) => {\n  const [itemRef, itemIsTruncated] = useCSSTextTruncation<HTMLDivElement>();\n\n  return (\n    <Menu.Item\n      css={css`\n        display: flex;\n      `}\n      {...props}\n    >\n      <Tooltip title={itemIsTruncated ? tooltipText : null}>\n        <div\n          ref={itemRef}\n          css={css`\n            max-width: 100%;\n            ${truncationCSS};\n          `}\n        >\n          {children}\n        </div>\n      </Tooltip>\n    </Menu.Item>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const MENU_ITEM_HEIGHT = 32;\nconst MENU_PADDING = 4;\nconst MENU_VERTICAL_SPACING = 32;\n\n/**\n * Calculates an adjusted Y-offset for a menu or submenu to prevent that\n * menu from appearing offscreen\n *\n * @param clientY The original Y-offset\n * @param itemsCount The number of menu items\n */\nexport const getMenuAdjustedY = (\n  clientY: number,\n  itemsCount: number,\n  maxItemsContainerHeight = Number.MAX_SAFE_INTEGER,\n  additionalItemsHeight = 0,\n) => {\n  // Viewport height\n  const vh = Math.max(\n    document.documentElement.clientHeight || 0,\n    window.innerHeight || 0,\n  );\n\n  const menuHeight =\n    Math.min(MENU_ITEM_HEIGHT * itemsCount, maxItemsContainerHeight) +\n    MENU_VERTICAL_SPACING +\n    additionalItemsHeight;\n  // Always show the context menu inside the viewport\n  return vh - clientY < menuHeight ? vh - menuHeight : clientY;\n};\n\nexport const getSubmenuYOffset = (\n  contextMenuY: number,\n  itemsCount: number,\n  submenuIndex = 0,\n  maxItemsContainerHeight = Number.MAX_SAFE_INTEGER,\n  additionalItemsHeight = 0,\n) => {\n  const submenuY =\n    contextMenuY +\n    MENU_PADDING +\n    MENU_ITEM_HEIGHT * submenuIndex +\n    MENU_PADDING;\n\n  return (\n    getMenuAdjustedY(\n      submenuY,\n      itemsCount,\n      maxItemsContainerHeight,\n      additionalItemsHeight,\n    ) - submenuY\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ConfigProvider } from 'antd';\nimport { styled, t } from '@superset-ui/core';\nimport ReactCronPicker, { Locale, CronProps } from 'react-js-cron';\n\nexport * from 'react-js-cron';\n\nexport const LOCALE: Locale = {\n  everyText: t('every'),\n  emptyMonths: t('every month'),\n  emptyMonthDays: t('every day of the month'),\n  emptyMonthDaysShort: t('day of the month'),\n  emptyWeekDays: t('every day of the week'),\n  emptyWeekDaysShort: t('day of the week'),\n  emptyHours: t('every hour'),\n  emptyMinutes: t('every minute'),\n  emptyMinutesForHourPeriod: t('every'),\n  yearOption: t('year'),\n  monthOption: t('month'),\n  weekOption: t('week'),\n  dayOption: t('day'),\n  hourOption: t('hour'),\n  minuteOption: t('minute'),\n  rebootOption: t('reboot'),\n  prefixPeriod: t('Every'),\n  prefixMonths: t('in'),\n  prefixMonthDays: t('on'),\n  prefixWeekDays: t('on'),\n  prefixWeekDaysForMonthAndYearPeriod: t('and'),\n  prefixHours: t('at'),\n  prefixMinutes: t(':'),\n  prefixMinutesForHourPeriod: t('at'),\n  suffixMinutesForHourPeriod: t('minute(s)'),\n  errorInvalidCron: t('Invalid cron expression'),\n  clearButtonText: t('Clear'),\n  weekDays: [\n    // Order is important, the index will be used as value\n    t('Sunday'), // Sunday must always be first, it's \"0\"\n    t('Monday'),\n    t('Tuesday'),\n    t('Wednesday'),\n    t('Thursday'),\n    t('Friday'),\n    t('Saturday'),\n  ],\n  months: [\n    // Order is important, the index will be used as value\n    t('January'),\n    t('February'),\n    t('March'),\n    t('April'),\n    t('May'),\n    t('June'),\n    t('July'),\n    t('August'),\n    t('September'),\n    t('October'),\n    t('November'),\n    t('December'),\n  ],\n  // Order is important, the index will be used as value\n  altWeekDays: [\n    t('SUN'), // Sunday must always be first, it's \"0\"\n    t('MON'),\n    t('TUE'),\n    t('WED'),\n    t('THU'),\n    t('FRI'),\n    t('SAT'),\n  ],\n  // Order is important, the index will be used as value\n  altMonths: [\n    t('JAN'),\n    t('FEB'),\n    t('MAR'),\n    t('APR'),\n    t('MAY'),\n    t('JUN'),\n    t('JUL'),\n    t('AUG'),\n    t('SEP'),\n    t('OCT'),\n    t('NOV'),\n    t('DEC'),\n  ],\n};\n\nexport const CronPicker = styled((props: CronProps) => (\n  <ConfigProvider\n    getPopupContainer={trigger => trigger.parentElement as HTMLElement}\n  >\n    <ReactCronPicker locale={LOCALE} {...props} />\n  </ConfigProvider>\n))`\n  .react-js-cron-field {\n    margin-bottom: 0px;\n  }\n  .react-js-cron-select:not(.react-js-cron-custom-select) > div:first-of-type,\n  .react-js-cron-custom-select {\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n    background-color: ${({ theme }) =>\n      theme.colors.grayscale.light4} !important;\n  }\n  .react-js-cron-custom-select > div:first-of-type {\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n  }\n  .react-js-cron-custom-select .ant-select-selection-placeholder {\n    flex: auto;\n  }\n  .react-js-cron-custom-select .ant-select-selection-overflow-item {\n    align-self: center;\n  }\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport { AntdDropdown } from 'src/components';\nimport { DropDownProps } from 'antd/lib/dropdown';\nimport { styled } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\n\nconst MenuDots = styled.div`\n  width: ${({ theme }) => theme.gridUnit * 0.75}px;\n  height: ${({ theme }) => theme.gridUnit * 0.75}px;\n  border-radius: 50%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light1};\n\n  font-weight: ${({ theme }) => theme.typography.weights.normal};\n  display: inline-flex;\n  position: relative;\n\n  &:hover {\n    background-color: ${({ theme }) => theme.colors.primary.base};\n\n    &::before,\n    &::after {\n      background-color: ${({ theme }) => theme.colors.primary.base};\n    }\n  }\n\n  &::before,\n  &::after {\n    position: absolute;\n    content: ' ';\n    width: ${({ theme }) => theme.gridUnit * 0.75}px;\n    height: ${({ theme }) => theme.gridUnit * 0.75}px;\n    border-radius: 50%;\n    background-color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n\n  &::before {\n    top: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  &::after {\n    bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst MenuDotsWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n  padding-left: ${({ theme }) => theme.gridUnit}px;\n`;\n\nexport enum IconOrientation {\n  VERTICAL = 'vertical',\n  HORIZONTAL = 'horizontal',\n}\nexport interface DropdownProps extends DropDownProps {\n  overlay: React.ReactElement;\n  iconOrientation?: IconOrientation;\n}\n\nconst RenderIcon = (\n  iconOrientation: IconOrientation = IconOrientation.VERTICAL,\n) => {\n  const component =\n    iconOrientation === IconOrientation.HORIZONTAL ? (\n      <Icons.MoreHoriz iconSize=\"xl\" />\n    ) : (\n      <MenuDots />\n    );\n  return component;\n};\n\nexport const Dropdown = ({\n  overlay,\n  iconOrientation = IconOrientation.VERTICAL,\n  ...rest\n}: DropdownProps) => (\n  <AntdDropdown overlay={overlay} {...rest}>\n    <MenuDotsWrapper data-test=\"dropdown-trigger\">\n      {RenderIcon(iconOrientation)}\n    </MenuDotsWrapper>\n  </AntdDropdown>\n);\n\ninterface ExtendedDropDownProps extends DropDownProps {\n  ref?: RefObject<HTMLDivElement>;\n}\n\n// @z-index-below-dashboard-header (100) - 1 = 99\nexport const NoAnimationDropdown = (\n  props: ExtendedDropDownProps & { children?: React.ReactNode },\n) => (\n  <AntdDropdown\n    overlayStyle={{ zIndex: 99, animationDuration: '0s' }}\n    {...props}\n  />\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum MetadataType {\n  DASHBOARDS = 'dashboards',\n  DESCRIPTION = 'description',\n  LAST_MODIFIED = 'lastModified',\n  OWNER = 'owner',\n  ROWS = 'rows',\n  SQL = 'sql',\n  TABLE = 'table',\n  TAGS = 'tags',\n}\n\nexport type Dashboards = {\n  type: MetadataType.DASHBOARDS;\n  title: string;\n  description?: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Description = {\n  type: MetadataType.DESCRIPTION;\n  value: string;\n  onClick?: (type: string) => void;\n};\n\nexport type LastModified = {\n  type: MetadataType.LAST_MODIFIED;\n  value: string;\n  modifiedBy: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Owner = {\n  type: MetadataType.OWNER;\n  createdBy: string;\n  owners: string[];\n  createdOn: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Rows = {\n  type: MetadataType.ROWS;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Sql = {\n  type: MetadataType.SQL;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Table = {\n  type: MetadataType.TABLE;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Tags = {\n  type: MetadataType.TAGS;\n  values: string[];\n  onClick?: (type: string) => void;\n};\n\nexport type ContentType =\n  | Dashboards\n  | Description\n  | LastModified\n  | Owner\n  | Rows\n  | Sql\n  | Table\n  | Tags;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsArray, styled, t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { ContentType, MetadataType } from '.';\n\nconst Header = styled.div`\n  font-weight: ${({ theme }) => theme.typography.weights.bold};\n`;\n\nconst Info = ({\n  text,\n  header,\n}: {\n  text?: string | string[];\n  header?: string;\n}) => {\n  const values = ensureIsArray(text);\n  return (\n    <>\n      {header && <Header>{header}</Header>}\n      {values.map(value => (\n        <div key={value}>{value}</div>\n      ))}\n    </>\n  );\n};\n\nconst config = (contentType: ContentType) => {\n  const { type } = contentType;\n\n  /**\n   * Tooltips are very similar. It's pretty much blocks\n   * of header/text pairs. That's why they are implemented here.\n   * If more complex tooltips emerge, then we should extract the different\n   * types of tooltips to their own components and reference them here.\n   */\n\n  switch (type) {\n    case MetadataType.DASHBOARDS:\n      return {\n        icon: Icons.FundProjectionScreenOutlined,\n        title: contentType.title,\n        tooltip: contentType.description ? (\n          <div>\n            <Info header={contentType.title} text={contentType.description} />\n          </div>\n        ) : undefined,\n      };\n\n    case MetadataType.DESCRIPTION:\n      return {\n        icon: Icons.BookOutlined,\n        title: contentType.value,\n      };\n\n    case MetadataType.LAST_MODIFIED:\n      return {\n        icon: Icons.EditOutlined,\n        title: contentType.value,\n        tooltip: (\n          <div>\n            <Info header={t('Last modified')} text={contentType.value} />\n            <Info header={t('Modified by')} text={contentType.modifiedBy} />\n          </div>\n        ),\n      };\n\n    case MetadataType.OWNER:\n      return {\n        icon: Icons.UserOutlined,\n        title: contentType.createdBy,\n        tooltip: (\n          <div>\n            <Info header={t('Created by')} text={contentType.createdBy} />\n            <Info header={t('Owners')} text={contentType.owners} />\n            <Info header={t('Created on')} text={contentType.createdOn} />\n          </div>\n        ),\n      };\n\n    case MetadataType.ROWS:\n      return {\n        icon: Icons.InsertRowBelowOutlined,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.SQL:\n      return {\n        icon: Icons.ConsoleSqlOutlined,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.TABLE:\n      return {\n        icon: Icons.Table,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.TAGS:\n      return {\n        icon: Icons.TagsOutlined,\n        title: contentType.values.join(', '),\n        tooltip: (\n          <div>\n            <Info header={t('Tags')} text={contentType.values} />\n          </div>\n        ),\n      };\n\n    default:\n      throw Error(`Invalid type provided: ${type}`);\n  }\n};\n\nexport { config };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useResizeDetector } from 'react-resize-detector';\nimport { uniqWith } from 'lodash';\nimport { styled } from '@superset-ui/core';\nimport { Tooltip, TooltipPlacement } from 'src/components/Tooltip';\nimport { ContentType } from './ContentType';\nimport { config } from './ContentConfig';\n\nexport const MIN_NUMBER_ITEMS = 2;\nexport const MAX_NUMBER_ITEMS = 6;\n\nconst HORIZONTAL_PADDING = 12;\nconst VERTICAL_PADDING = 8;\nconst ICON_PADDING = 8;\nconst SPACE_BETWEEN_ITEMS = 16;\nconst ICON_WIDTH = 16;\nconst TEXT_MIN_WIDTH = 70;\nconst TEXT_MAX_WIDTH = 150;\nconst ORDER = {\n  dashboards: 0,\n  table: 1,\n  sql: 2,\n  rows: 3,\n  tags: 4,\n  description: 5,\n  owner: 6,\n  lastModified: 7,\n};\n\nconst Bar = styled.div<{ count: number }>`\n  ${({ theme, count }) => `\n    display: flex;\n    align-items: center;\n    padding: ${VERTICAL_PADDING}px ${HORIZONTAL_PADDING}px;\n    background-color: ${theme.colors.grayscale.light4};\n    color: ${theme.colors.grayscale.base};\n    font-size: ${theme.typography.sizes.s}px;\n    min-width: ${\n      HORIZONTAL_PADDING * 2 +\n      (ICON_WIDTH + SPACE_BETWEEN_ITEMS) * count -\n      SPACE_BETWEEN_ITEMS\n    }px;\n    border-radius: ${theme.borderRadius}px;\n    line-height: 1;\n  `}\n`;\n\nconst StyledItem = styled.div<{\n  collapsed: boolean;\n  last: boolean;\n  onClick?: () => void;\n}>`\n  ${({ theme, collapsed, last, onClick }) => `\n    display: flex;\n    align-items: center;\n    max-width: ${\n      ICON_WIDTH +\n      ICON_PADDING +\n      TEXT_MAX_WIDTH +\n      (last ? 0 : SPACE_BETWEEN_ITEMS)\n    }px;\n    min-width: ${\n      collapsed\n        ? ICON_WIDTH + (last ? 0 : SPACE_BETWEEN_ITEMS)\n        : ICON_WIDTH +\n          ICON_PADDING +\n          TEXT_MIN_WIDTH +\n          (last ? 0 : SPACE_BETWEEN_ITEMS)\n    }px;\n    padding-right: ${last ? 0 : SPACE_BETWEEN_ITEMS}px;\n    cursor: ${onClick ? 'pointer' : 'default'};\n    & .metadata-icon {\n      color: ${\n        onClick && collapsed\n          ? theme.colors.primary.base\n          : theme.colors.grayscale.base\n      };\n      padding-right: ${collapsed ? 0 : ICON_PADDING}px;\n      & .anticon {\n        line-height: 0;\n      }\n    }\n    & .metadata-text {\n      min-width: ${TEXT_MIN_WIDTH}px;\n      overflow: hidden;\n      text-overflow: ${collapsed ? 'unset' : 'ellipsis'};\n      white-space: nowrap;\n      text-decoration: ${onClick ? 'underline' : 'none'};\n    }\n  `}\n`;\n\n// Make sure big tootips are truncated\nconst TootipContent = styled.div`\n  display: -webkit-box;\n  -webkit-line-clamp: 20;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Item = ({\n  barWidth,\n  contentType,\n  collapsed,\n  last = false,\n  tooltipPlacement,\n}: {\n  barWidth: number | undefined;\n  contentType: ContentType;\n  collapsed: boolean;\n  last?: boolean;\n  tooltipPlacement: TooltipPlacement;\n}) => {\n  const { icon, title, tooltip = title } = config(contentType);\n  const [isTruncated, setIsTruncated] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n  const Icon = icon;\n  const { type, onClick } = contentType;\n\n  useEffect(() => {\n    setIsTruncated(\n      ref.current ? ref.current.scrollWidth > ref.current.clientWidth : false,\n    );\n  }, [barWidth, setIsTruncated, contentType]);\n\n  const content = (\n    <StyledItem\n      collapsed={collapsed}\n      last={last}\n      onClick={onClick ? () => onClick(type) : undefined}\n    >\n      <Icon iconSize=\"l\" className=\"metadata-icon\" />\n      {!collapsed && (\n        <span ref={ref} className=\"metadata-text\">\n          {title}\n        </span>\n      )}\n    </StyledItem>\n  );\n  return isTruncated || collapsed || (tooltip && tooltip !== title) ? (\n    <Tooltip\n      placement={tooltipPlacement}\n      title={<TootipContent>{tooltip}</TootipContent>}\n    >\n      {content}\n    </Tooltip>\n  ) : (\n    content\n  );\n};\n\nexport interface MetadataBarProps {\n  /**\n   * Array of content type configurations. To see the available properties\n   * for each content type, check {@link ContentType}\n   */\n  items: ContentType[];\n  /**\n   * Antd tooltip placement. To see available values, check {@link TooltipPlacement}.\n   * Defaults to \"top\".\n   */\n  tooltipPlacement?: TooltipPlacement;\n}\n\n/**\n * The metadata bar component is used to display additional information about an entity.\n * Content types are predefined and consistent across the whole app. This means that\n * they will be displayed and behave in a consistent manner, keeping the same ordering,\n * information formatting, and interactions.\n * To extend the list of content types, a developer needs to request the inclusion of the new type in the design system.\n * This process is important to make sure the new type is reviewed by the design team, improving Superset consistency.\n */\nconst MetadataBar = ({ items, tooltipPlacement = 'top' }: MetadataBarProps) => {\n  const [width, setWidth] = useState<number>();\n  const [collapsed, setCollapsed] = useState(false);\n  const uniqueItems = uniqWith(items, (a, b) => a.type === b.type);\n  const sortedItems = uniqueItems.sort((a, b) => ORDER[a.type] - ORDER[b.type]);\n  const count = sortedItems.length;\n  if (count < MIN_NUMBER_ITEMS) {\n    throw Error('The minimum number of items for the metadata bar is 2.');\n  }\n  if (count > MAX_NUMBER_ITEMS) {\n    throw Error('The maximum number of items for the metadata bar is 6.');\n  }\n\n  const onResize = useCallback(\n    width => {\n      // Calculates the breakpoint width to collapse the bar.\n      // The last item does not have a space, so we subtract SPACE_BETWEEN_ITEMS from the total.\n      const breakpoint =\n        (ICON_WIDTH + ICON_PADDING + TEXT_MIN_WIDTH + SPACE_BETWEEN_ITEMS) *\n          count -\n        SPACE_BETWEEN_ITEMS;\n      setWidth(width);\n      setCollapsed(Boolean(width && width < breakpoint));\n    },\n    [count],\n  );\n\n  const { ref } = useResizeDetector({ onResize });\n\n  return (\n    <Bar ref={ref} count={count} data-test=\"metadata-bar\">\n      {sortedItems.map((item, index) => (\n        <Item\n          barWidth={width}\n          key={index}\n          contentType={item}\n          collapsed={collapsed}\n          last={index === count - 1}\n          tooltipPlacement={tooltipPlacement}\n        />\n      ))}\n    </Bar>\n  );\n};\n\nexport default MetadataBar;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport MetadataBar, {\n  MetadataBarProps,\n  MIN_NUMBER_ITEMS,\n  MAX_NUMBER_ITEMS,\n} from './MetadataBar';\n\nexport default MetadataBar;\n\nexport { MetadataBarProps, MIN_NUMBER_ITEMS, MAX_NUMBER_ITEMS };\n\nexport * from './ContentType';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  KeyboardEvent,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { css, SupersetTheme, t } from '@superset-ui/core';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { useResizeDetector } from 'react-resize-detector';\n\nexport type DynamicEditableTitleProps = {\n  title: string;\n  placeholder: string;\n  onSave: (title: string) => void;\n  canEdit: boolean;\n  label: string | undefined;\n};\n\nconst titleStyles = (theme: SupersetTheme) => css`\n  display: flex;\n  font-size: ${theme.typography.sizes.xl}px;\n  font-weight: ${theme.typography.weights.bold};\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  & .dynamic-title,\n  & .dynamic-title-input {\n    display: inline-block;\n    max-width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  & .dynamic-title {\n    cursor: default;\n  }\n  & .dynamic-title-input {\n    border: none;\n    padding: 0;\n    outline: none;\n\n    &::placeholder {\n      color: ${theme.colors.grayscale.light1};\n    }\n  }\n\n  & .input-sizer {\n    position: absolute;\n    left: -9999px;\n    display: inline-block;\n  }\n`;\n\nexport const DynamicEditableTitle = ({\n  title,\n  placeholder,\n  onSave,\n  canEdit,\n  label,\n}: DynamicEditableTitleProps) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [currentTitle, setCurrentTitle] = useState(title || '');\n  const contentRef = useRef<HTMLInputElement>(null);\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  const { width: inputWidth, ref: sizerRef } = useResizeDetector();\n  const { width: containerWidth, ref: containerRef } = useResizeDetector({\n    refreshMode: 'debounce',\n  });\n\n  useEffect(() => {\n    setCurrentTitle(title);\n  }, [title]);\n\n  useEffect(() => {\n    if (isEditing && contentRef?.current) {\n      contentRef.current.focus();\n      // move cursor and scroll to the end\n      if (contentRef.current.setSelectionRange) {\n        const { length } = contentRef.current.value;\n        contentRef.current.setSelectionRange(length, length);\n        contentRef.current.scrollLeft = contentRef.current.scrollWidth;\n      }\n    }\n  }, [isEditing]);\n\n  // a trick to make the input grow when user types text\n  // we make additional span component, place it somewhere out of view and copy input\n  // then we can measure the width of that span to resize the input element\n  useLayoutEffect(() => {\n    if (sizerRef?.current) {\n      sizerRef.current.innerHTML = (currentTitle || placeholder).replace(\n        /\\s/g,\n        '&nbsp;',\n      );\n    }\n  }, [currentTitle, placeholder, sizerRef]);\n\n  useEffect(() => {\n    if (\n      contentRef.current &&\n      contentRef.current.scrollWidth > contentRef.current.clientWidth\n    ) {\n      setShowTooltip(true);\n    } else {\n      setShowTooltip(false);\n    }\n  }, [inputWidth, containerWidth]);\n\n  const handleClick = useCallback(() => {\n    if (!canEdit || isEditing) {\n      return;\n    }\n    setIsEditing(true);\n  }, [canEdit, isEditing]);\n\n  const handleBlur = useCallback(() => {\n    if (!canEdit) {\n      return;\n    }\n    const formattedTitle = currentTitle.trim();\n    setCurrentTitle(formattedTitle);\n    if (title !== formattedTitle) {\n      onSave(formattedTitle);\n    }\n    setIsEditing(false);\n  }, [canEdit, currentTitle, onSave, title]);\n\n  const handleChange = useCallback(\n    (ev: ChangeEvent<HTMLInputElement>) => {\n      if (!canEdit || !isEditing) {\n        return;\n      }\n      setCurrentTitle(ev.target.value);\n    },\n    [canEdit, isEditing],\n  );\n\n  const handleKeyPress = useCallback(\n    (ev: KeyboardEvent<HTMLInputElement>) => {\n      if (!canEdit) {\n        return;\n      }\n      if (ev.key === 'Enter') {\n        ev.preventDefault();\n        contentRef.current?.blur();\n      }\n    },\n    [canEdit],\n  );\n\n  return (\n    <div css={titleStyles} ref={containerRef}>\n      <Tooltip\n        id=\"title-tooltip\"\n        title={showTooltip && currentTitle && !isEditing ? currentTitle : null}\n      >\n        {canEdit ? (\n          <input\n            data-test=\"editable-title-input\"\n            className=\"dynamic-title-input\"\n            aria-label={label ?? t('Title')}\n            ref={contentRef}\n            onChange={handleChange}\n            onBlur={handleBlur}\n            onClick={handleClick}\n            onKeyPress={handleKeyPress}\n            placeholder={placeholder}\n            value={currentTitle}\n            css={css`\n              cursor: ${isEditing ? 'text' : 'pointer'};\n\n              ${inputWidth &&\n              inputWidth > 0 &&\n              css`\n                width: ${inputWidth + 1}px;\n              `}\n            `}\n          />\n        ) : (\n          <span\n            className=\"dynamic-title\"\n            aria-label={label ?? t('Title')}\n            ref={contentRef}\n            data-test=\"editable-title\"\n          >\n            {currentTitle}\n          </span>\n        )}\n      </Tooltip>\n      <span ref={sizerRef} className=\"input-sizer\" aria-hidden tabIndex={-1} />\n    </div>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { ReactNode, ReactElement } from 'react';\nimport { css, SupersetTheme, t, useTheme } from '@superset-ui/core';\nimport { AntdDropdown, AntdDropdownProps } from 'src/components';\nimport { TooltipPlacement } from 'src/components/Tooltip';\nimport {\n  DynamicEditableTitle,\n  DynamicEditableTitleProps,\n} from '../DynamicEditableTitle';\nimport CertifiedBadge, { CertifiedBadgeProps } from '../CertifiedBadge';\nimport FaveStar, { FaveStarProps } from '../FaveStar';\nimport Icons from '../Icons';\nimport Button from '../Button';\n\nexport const menuTriggerStyles = (theme: SupersetTheme) => css`\n  width: ${theme.gridUnit * 8}px;\n  height: ${theme.gridUnit * 8}px;\n  padding: 0;\n  border: 1px solid ${theme.colors.primary.dark2};\n\n  &.ant-btn > span.anticon {\n    line-height: 0;\n    transition: inherit;\n  }\n\n  &:hover:not(:focus) > span.anticon {\n    color: ${theme.colors.primary.light1};\n  }\n`;\n\nconst headerStyles = (theme: SupersetTheme) => css`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  background-color: ${theme.colors.grayscale.light5};\n  height: ${theme.gridUnit * 16}px;\n  padding: 0 ${theme.gridUnit * 4}px;\n\n  .editable-title {\n    overflow: hidden;\n\n    & > input[type='button'],\n    & > span {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      max-width: 100%;\n      white-space: nowrap;\n    }\n  }\n\n  span[role='button'] {\n    display: flex;\n    height: 100%;\n  }\n\n  .title-panel {\n    display: flex;\n    align-items: center;\n    min-width: 0;\n    margin-right: ${theme.gridUnit * 12}px;\n  }\n\n  .right-button-panel {\n    display: flex;\n    align-items: center;\n  }\n`;\n\nconst buttonsStyles = (theme: SupersetTheme) => css`\n  display: flex;\n  align-items: center;\n  padding-left: ${theme.gridUnit * 2}px;\n\n  & .fave-unfave-icon {\n    padding: 0 ${theme.gridUnit}px;\n\n    &:first-of-type {\n      padding-left: 0;\n    }\n  }\n`;\n\nconst additionalActionsContainerStyles = (theme: SupersetTheme) => css`\n  margin-left: ${theme.gridUnit * 2}px;\n`;\n\nexport type PageHeaderWithActionsProps = {\n  editableTitleProps: DynamicEditableTitleProps;\n  showTitlePanelItems: boolean;\n  certificatiedBadgeProps?: CertifiedBadgeProps;\n  showFaveStar: boolean;\n  faveStarProps: FaveStarProps;\n  titlePanelAdditionalItems: ReactNode;\n  rightPanelAdditionalItems: ReactNode;\n  additionalActionsMenu: ReactElement;\n  menuDropdownProps: Omit<AntdDropdownProps, 'overlay'>;\n  tooltipProps?: {\n    text?: string;\n    placement?: TooltipPlacement;\n  };\n};\n\nexport const PageHeaderWithActions = ({\n  editableTitleProps,\n  showTitlePanelItems,\n  certificatiedBadgeProps,\n  showFaveStar,\n  faveStarProps,\n  titlePanelAdditionalItems,\n  rightPanelAdditionalItems,\n  additionalActionsMenu,\n  menuDropdownProps,\n  tooltipProps,\n}: PageHeaderWithActionsProps) => {\n  const theme = useTheme();\n  return (\n    <div css={headerStyles} className=\"header-with-actions\">\n      <div className=\"title-panel\">\n        <DynamicEditableTitle {...editableTitleProps} />\n        {showTitlePanelItems && (\n          <div css={buttonsStyles}>\n            {certificatiedBadgeProps?.certifiedBy && (\n              <CertifiedBadge {...certificatiedBadgeProps} />\n            )}\n            {showFaveStar && <FaveStar {...faveStarProps} />}\n            {titlePanelAdditionalItems}\n          </div>\n        )}\n      </div>\n      <div className=\"right-button-panel\">\n        {rightPanelAdditionalItems}\n        <div css={additionalActionsContainerStyles}>\n          <AntdDropdown\n            trigger={['click']}\n            overlay={additionalActionsMenu}\n            {...menuDropdownProps}\n          >\n            <Button\n              css={menuTriggerStyles}\n              buttonStyle=\"tertiary\"\n              aria-label={t('Menu actions trigger')}\n              tooltip={tooltipProps?.text}\n              placement={tooltipProps?.placement}\n              data-test=\"actions-trigger\"\n            >\n              <Icons.MoreHoriz\n                iconColor={theme.colors.primary.dark2}\n                iconSize=\"l\"\n              />\n            </Button>\n          </AntdDropdown>\n        </div>\n      </div>\n    </div>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Types mirroring enums in `superset/reports/models.py`:\n */\nexport type ReportScheduleType = 'Alert' | 'Report';\nexport type ReportCreationMethod = 'charts' | 'dashboards' | 'alerts_reports';\n\nexport type ReportRecipientType = 'Email' | 'Slack';\n\nexport enum ReportType {\n  DASHBOARDS = 'dashboards',\n  CHARTS = 'charts',\n}\n\nexport enum NOTIFICATION_FORMATS {\n  TEXT = 'TEXT',\n  PNG = 'PNG',\n  CSV = 'CSV',\n}\nexport interface ReportObject {\n  id?: number;\n  active: boolean;\n  crontab: string;\n  dashboard?: number;\n  chart?: number;\n  description?: string;\n  log_retention: number;\n  name: string;\n  owners: number[];\n  recipients: [\n    { recipient_config_json: { target: string }; type: ReportRecipientType },\n  ];\n  report_format: string;\n  timezone: string;\n  type: ReportScheduleType;\n  validator_config_json: {} | null;\n  validator_type: string;\n  working_timeout: number;\n  creation_method: string;\n  force_screenshot: boolean;\n  error?: string;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useState,\n  useEffect,\n  useReducer,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { t, SupersetTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { addReport, editReport } from 'src/reports/actions/reports';\nimport Alert from 'src/components/Alert';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport LabeledErrorBoundInput from 'src/components/Form/LabeledErrorBoundInput';\nimport Icons from 'src/components/Icons';\nimport { CronError } from 'src/components/CronPicker';\nimport { RadioChangeEvent } from 'src/components';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { ChartState } from 'src/explore/types';\nimport {\n  ReportCreationMethod,\n  ReportObject,\n  NOTIFICATION_FORMATS,\n} from 'src/reports/types';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport { CreationMethod } from './HeaderReportDropdown';\nimport {\n  antDErrorAlertStyles,\n  StyledModal,\n  StyledTopSection,\n  StyledBottomSection,\n  StyledIconWrapper,\n  StyledScheduleTitle,\n  StyledCronPicker,\n  StyledCronError,\n  noBottomMargin,\n  StyledFooterButton,\n  TimezoneHeaderStyle,\n  SectionHeaderStyle,\n  StyledMessageContentTitle,\n  StyledRadio,\n  StyledRadioGroup,\n} from './styles';\n\ninterface ReportProps {\n  onHide: () => {};\n  addDangerToast: (msg: string) => void;\n  show: boolean;\n  userId: number;\n  userEmail: string;\n  chart?: ChartState;\n  chartName?: string;\n  dashboardId?: number;\n  dashboardName?: string;\n  creationMethod: ReportCreationMethod;\n  props: any;\n}\n\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n  'pivot_table',\n  'pivot_table_v2',\n  'table',\n  'paired_ttest',\n];\n\nconst INITIAL_STATE = {\n  crontab: '0 12 * * 1',\n};\n\ntype ReportObjectState = Partial<ReportObject> & {\n  error?: string;\n  /**\n   * Is submitting changes to the backend.\n   */\n  isSubmitting?: boolean;\n};\n\n// Same instance to be used in useEffects\nconst EMPTY_OBJECT = {};\n\nfunction ReportModal({\n  onHide,\n  show = false,\n  dashboardId,\n  chart,\n  userId,\n  userEmail,\n  creationMethod,\n  dashboardName,\n  chartName,\n}: ReportProps) {\n  const vizType = chart?.sliceFormData?.viz_type;\n  const isChart = !!chart;\n  const isTextBasedChart =\n    isChart && vizType && TEXT_BASED_VISUALIZATION_TYPES.includes(vizType);\n  const defaultNotificationFormat = isTextBasedChart\n    ? NOTIFICATION_FORMATS.TEXT\n    : NOTIFICATION_FORMATS.PNG;\n  const entityName = dashboardName || chartName;\n  const initialState: ReportObjectState = useMemo(\n    () => ({\n      ...INITIAL_STATE,\n      name: entityName\n        ? t('Weekly Report for %s', entityName)\n        : t('Weekly Report'),\n    }),\n    [entityName],\n  );\n\n  const reportReducer = useCallback(\n    (state: ReportObjectState | null, action: 'reset' | ReportObjectState) => {\n      if (action === 'reset') {\n        return initialState;\n      }\n      return {\n        ...state,\n        ...action,\n      };\n    },\n    [initialState],\n  );\n\n  const [currentReport, setCurrentReport] = useReducer(\n    reportReducer,\n    initialState,\n  );\n  const [cronError, setCronError] = useState<CronError>();\n\n  const dispatch = useDispatch();\n  // Report fetch logic\n  const report = useSelector<any, ReportObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return (\n      reportSelector(state, resourceType, dashboardId || chart?.id) ||\n      EMPTY_OBJECT\n    );\n  });\n  const isEditMode = report && Object.keys(report).length;\n\n  useEffect(() => {\n    if (isEditMode) {\n      setCurrentReport(report);\n    } else {\n      setCurrentReport('reset');\n    }\n  }, [isEditMode, report]);\n\n  const onSave = async () => {\n    // Create new Report\n    const newReportValues: Partial<ReportObject> = {\n      type: 'Report',\n      active: true,\n      force_screenshot: false,\n      creation_method: creationMethod,\n      dashboard: dashboardId,\n      chart: chart?.id,\n      owners: [userId],\n      recipients: [\n        {\n          recipient_config_json: { target: userEmail },\n          type: 'Email',\n        },\n      ],\n      name: currentReport.name,\n      description: currentReport.description,\n      crontab: currentReport.crontab,\n      report_format: currentReport.report_format || defaultNotificationFormat,\n      timezone: currentReport.timezone,\n    };\n\n    setCurrentReport({ isSubmitting: true, error: undefined });\n    try {\n      if (isEditMode) {\n        await dispatch(\n          editReport(currentReport.id, newReportValues as ReportObject),\n        );\n      } else {\n        await dispatch(addReport(newReportValues as ReportObject));\n      }\n      onHide();\n    } catch (e) {\n      const { error } = await getClientErrorObject(e);\n      setCurrentReport({ error });\n    }\n    setCurrentReport({ isSubmitting: false });\n  };\n\n  const wrappedTitle = (\n    <StyledIconWrapper>\n      <Icons.Calendar />\n      <span className=\"text\">\n        {isEditMode ? t('Edit email report') : t('Schedule a new email report')}\n      </span>\n    </StyledIconWrapper>\n  );\n\n  const renderModalFooter = (\n    <>\n      <StyledFooterButton key=\"back\" onClick={onHide}>\n        {t('Cancel')}\n      </StyledFooterButton>\n      <StyledFooterButton\n        key=\"submit\"\n        buttonStyle=\"primary\"\n        onClick={onSave}\n        disabled={!currentReport.name}\n        loading={currentReport.isSubmitting}\n      >\n        {isEditMode ? t('Save') : t('Add')}\n      </StyledFooterButton>\n    </>\n  );\n\n  const renderMessageContentSection = (\n    <>\n      <StyledMessageContentTitle>\n        <h4>{t('Message content')}</h4>\n      </StyledMessageContentTitle>\n      <div className=\"inline-container\">\n        <StyledRadioGroup\n          onChange={(event: RadioChangeEvent) => {\n            setCurrentReport({ report_format: event.target.value });\n          }}\n          value={currentReport.report_format || defaultNotificationFormat}\n        >\n          {isTextBasedChart && (\n            <StyledRadio value={NOTIFICATION_FORMATS.TEXT}>\n              {t('Text embedded in email')}\n            </StyledRadio>\n          )}\n          <StyledRadio value={NOTIFICATION_FORMATS.PNG}>\n            {t('Image (PNG) embedded in email')}\n          </StyledRadio>\n          <StyledRadio value={NOTIFICATION_FORMATS.CSV}>\n            {t('Formatted CSV attached in email')}\n          </StyledRadio>\n        </StyledRadioGroup>\n      </div>\n    </>\n  );\n\n  return (\n    <StyledModal\n      show={show}\n      onHide={onHide}\n      title={wrappedTitle}\n      footer={renderModalFooter}\n      width=\"432\"\n      centered\n    >\n      <StyledTopSection>\n        <LabeledErrorBoundInput\n          id=\"name\"\n          name=\"name\"\n          value={currentReport.name || ''}\n          placeholder={initialState.name}\n          required\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) =>\n              setCurrentReport({ name: target.value }),\n          }}\n          label={t('Report Name')}\n          data-test=\"report-name-test\"\n        />\n        <LabeledErrorBoundInput\n          id=\"description\"\n          name=\"description\"\n          value={currentReport?.description || ''}\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) => {\n              setCurrentReport({ description: target.value });\n            },\n          }}\n          label={t('Description')}\n          placeholder={t(\n            'Include a description that will be sent with your report',\n          )}\n          css={noBottomMargin}\n          data-test=\"report-description-test\"\n        />\n      </StyledTopSection>\n\n      <StyledBottomSection>\n        <StyledScheduleTitle>\n          <h4 css={(theme: SupersetTheme) => SectionHeaderStyle(theme)}>\n            {t('Schedule')}\n          </h4>\n          <p>\n            {t('A screenshot of the dashboard will be sent to your email at')}\n          </p>\n        </StyledScheduleTitle>\n\n        <StyledCronPicker\n          clearButton={false}\n          value={currentReport.crontab || '0 12 * * 1'}\n          setValue={(newValue: string) => {\n            setCurrentReport({ crontab: newValue });\n          }}\n          onError={setCronError}\n        />\n        <StyledCronError>{cronError}</StyledCronError>\n        <div\n          className=\"control-label\"\n          css={(theme: SupersetTheme) => TimezoneHeaderStyle(theme)}\n        >\n          {t('Timezone')}\n        </div>\n        <TimezoneSelector\n          timezone={currentReport.timezone}\n          onTimezoneChange={value => {\n            setCurrentReport({ timezone: value });\n          }}\n        />\n        {isChart && renderMessageContentSection}\n      </StyledBottomSection>\n      {currentReport.error && (\n        <Alert\n          type=\"error\"\n          css={(theme: SupersetTheme) => antDErrorAlertStyles(theme)}\n          message={\n            isEditMode\n              ? t('Failed to update report')\n              : t('Failed to create report')\n          }\n          description={currentReport.error}\n        />\n      )}\n    </StyledModal>\n  );\n}\n\nexport default withToasts(ReportModal);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { isEmpty } from 'lodash';\nimport {\n  t,\n  SupersetTheme,\n  css,\n  styled,\n  useTheme,\n  FeatureFlag,\n  isFeatureEnabled,\n  getExtensionsRegistry,\n  usePrevious,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Switch } from 'src/components/Switch';\nimport { AlertObject } from 'src/features/alerts/types';\nimport { Menu } from 'src/components/Menu';\nimport Checkbox from 'src/components/Checkbox';\nimport { noOp } from 'src/utils/common';\nimport { NoAnimationDropdown } from 'src/components/Dropdown';\nimport DeleteModal from 'src/components/DeleteModal';\nimport ReportModal from 'src/components/ReportModal';\nimport { ChartState } from 'src/explore/types';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport {\n  fetchUISpecificReport,\n  toggleActive,\n  deleteActiveReport,\n} from 'src/reports/actions/reports';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport { MenuItemWithCheckboxContainer } from 'src/explore/components/useExploreAdditionalActionsMenu/index';\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nconst deleteColor = (theme: SupersetTheme) => css`\n  color: ${theme.colors.error.base};\n`;\n\nconst onMenuHover = (theme: SupersetTheme) => css`\n  & .ant-menu-item {\n    padding: 5px 12px;\n    margin-top: 0px;\n    margin-bottom: 4px;\n    :hover {\n      color: ${theme.colors.grayscale.dark1};\n    }\n  }\n  :hover {\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst onMenuItemHover = (theme: SupersetTheme) => css`\n  &:hover {\n    color: ${theme.colors.grayscale.dark1};\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst StyledDropdownItemWithIcon = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  > *:first-child {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst DropdownItemExtension = extensionsRegistry.get(\n  'report-modal.dropdown.item.icon',\n);\n\nexport enum CreationMethod {\n  CHARTS = 'charts',\n  DASHBOARDS = 'dashboards',\n}\nexport interface HeaderReportProps {\n  dashboardId?: number;\n  chart?: ChartState;\n  useTextMenu?: boolean;\n  setShowReportSubMenu?: (show: boolean) => void;\n  setIsDropdownVisible?: (visible: boolean) => void;\n  isDropdownVisible?: boolean;\n  showReportSubMenu?: boolean;\n}\n\n// Same instance to be used in useEffects\nconst EMPTY_OBJECT = {};\n\nexport default function HeaderReportDropDown({\n  dashboardId,\n  chart,\n  useTextMenu = false,\n  setShowReportSubMenu,\n  setIsDropdownVisible,\n  isDropdownVisible,\n}: HeaderReportProps) {\n  const dispatch = useDispatch();\n  const report = useSelector<any, AlertObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return (\n      reportSelector(state, resourceType, dashboardId || chart?.id) ||\n      EMPTY_OBJECT\n    );\n  });\n\n  const isReportActive: boolean = report?.active || false;\n  const user: UserWithPermissionsAndRoles = useSelector<\n    any,\n    UserWithPermissionsAndRoles\n  >(state => state.user);\n  const canAddReports = () => {\n    if (!isFeatureEnabled(FeatureFlag.ALERT_REPORTS)) {\n      return false;\n    }\n\n    if (!user?.userId) {\n      // this is in the case that there is an anonymous user.\n      return false;\n    }\n\n    // Cannot add reports if the resource is not saved\n    if (!(dashboardId || chart?.id)) {\n      return false;\n    }\n\n    const roles = Object.keys(user.roles || []);\n    const permissions = roles.map(key =>\n      user.roles[key].filter(\n        perms => perms[0] === 'menu_access' && perms[1] === 'Manage',\n      ),\n    );\n    return permissions.some(permission => permission.length > 0);\n  };\n\n  const [currentReportDeleting, setCurrentReportDeleting] =\n    useState<AlertObject | null>(null);\n  const theme = useTheme();\n  const prevDashboard = usePrevious(dashboardId);\n  const [showModal, setShowModal] = useState<boolean>(false);\n  const toggleActiveKey = async (data: AlertObject, checked: boolean) => {\n    if (data?.id) {\n      dispatch(toggleActive(data, checked));\n    }\n  };\n\n  const handleReportDelete = async (report: AlertObject) => {\n    await dispatch(deleteActiveReport(report));\n    setCurrentReportDeleting(null);\n  };\n\n  const shouldFetch =\n    canAddReports() &&\n    !!((dashboardId && prevDashboard !== dashboardId) || chart?.id);\n\n  useEffect(() => {\n    if (shouldFetch) {\n      dispatch(\n        fetchUISpecificReport({\n          userId: user.userId,\n          filterField: dashboardId ? 'dashboard_id' : 'chart_id',\n          creationMethod: dashboardId ? 'dashboards' : 'charts',\n          resourceId: dashboardId || chart?.id,\n        }),\n      );\n    }\n  }, []);\n\n  const showReportSubMenu = report && setShowReportSubMenu && canAddReports();\n\n  useEffect(() => {\n    if (showReportSubMenu) {\n      setShowReportSubMenu(true);\n    } else if (!report && setShowReportSubMenu) {\n      setShowReportSubMenu(false);\n    }\n  }, [report]);\n\n  const handleShowMenu = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setShowModal(true);\n    }\n  };\n\n  const handleDeleteMenuClick = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setCurrentReportDeleting(report);\n    }\n  };\n\n  const textMenu = () =>\n    isEmpty(report) ? (\n      <Menu selectable={false} css={onMenuHover}>\n        <Menu.Item onClick={handleShowMenu}>\n          {DropdownItemExtension ? (\n            <StyledDropdownItemWithIcon>\n              <div>{t('Set up an email report')}</div>\n              <DropdownItemExtension />\n            </StyledDropdownItemWithIcon>\n          ) : (\n            t('Set up an email report')\n          )}\n        </Menu.Item>\n        <Menu.Divider />\n      </Menu>\n    ) : (\n      isDropdownVisible && (\n        <Menu selectable={false} css={{ border: 'none' }}>\n          <Menu.Item\n            css={onMenuItemHover}\n            onClick={() => toggleActiveKey(report, !isReportActive)}\n          >\n            <MenuItemWithCheckboxContainer>\n              <Checkbox checked={isReportActive} onChange={noOp} />\n              {t('Email reports active')}\n            </MenuItemWithCheckboxContainer>\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleShowMenu}>\n            {t('Edit email report')}\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleDeleteMenuClick}>\n            {t('Delete email report')}\n          </Menu.Item>\n        </Menu>\n      )\n    );\n  const menu = () => (\n    <Menu selectable={false} css={{ width: '200px' }}>\n      <Menu.Item>\n        {t('Email reports active')}\n        <Switch\n          data-test=\"toggle-active\"\n          checked={isReportActive}\n          onClick={(checked: boolean) => toggleActiveKey(report, checked)}\n          size=\"small\"\n          css={{ marginLeft: theme.gridUnit * 2 }}\n        />\n      </Menu.Item>\n      <Menu.Item onClick={() => setShowModal(true)}>\n        {t('Edit email report')}\n      </Menu.Item>\n      <Menu.Item\n        onClick={() => setCurrentReportDeleting(report)}\n        css={deleteColor}\n      >\n        {t('Delete email report')}\n      </Menu.Item>\n    </Menu>\n  );\n\n  const iconMenu = () =>\n    isEmpty(report) ? (\n      <span\n        role=\"button\"\n        title={t('Schedule email report')}\n        tabIndex={0}\n        className=\"action-button action-schedule-report\"\n        onClick={() => setShowModal(true)}\n      >\n        <Icons.Calendar />\n      </span>\n    ) : (\n      <>\n        <NoAnimationDropdown\n          overlay={menu()}\n          trigger={['click']}\n          getPopupContainer={(triggerNode: any) =>\n            triggerNode.closest('.action-button')\n          }\n        >\n          <span\n            role=\"button\"\n            className=\"action-button action-schedule-report\"\n            tabIndex={0}\n          >\n            <Icons.Calendar />\n          </span>\n        </NoAnimationDropdown>\n      </>\n    );\n\n  return (\n    <>\n      {canAddReports() && (\n        <>\n          <ReportModal\n            userId={user.userId}\n            show={showModal}\n            onHide={() => setShowModal(false)}\n            userEmail={user.email}\n            dashboardId={dashboardId}\n            chart={chart}\n            creationMethod={\n              dashboardId ? CreationMethod.DASHBOARDS : CreationMethod.CHARTS\n            }\n          />\n          {useTextMenu ? textMenu() : iconMenu()}\n          {currentReportDeleting && (\n            <DeleteModal\n              description={t(\n                'This action will permanently delete %s.',\n                currentReportDeleting?.name,\n              )}\n              onConfirm={() => {\n                if (currentReportDeleting) {\n                  handleReportDelete(currentReportDeleting);\n                }\n              }}\n              onHide={() => setCurrentReportDeleting(null)}\n              open\n              title={t('Delete Report?')}\n            />\n          )}\n        </>\n      )}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { styled, css, SupersetTheme } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { Radio } from 'src/components/Radio';\nimport { CronPicker } from 'src/components/CronPicker';\n\nexport const StyledModal = styled(Modal)`\n  .ant-modal-body {\n    padding: 0;\n  }\n`;\n\nexport const StyledTopSection = styled.div`\n  padding: ${({ theme }) =>\n    `${theme.gridUnit * 3}px ${theme.gridUnit * 4}px ${theme.gridUnit * 2}px`};\n  label {\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n`;\n\nexport const StyledBottomSection = styled.div`\n  border-top: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  padding: ${({ theme }) =>\n    `${theme.gridUnit * 4}px ${theme.gridUnit * 4}px ${theme.gridUnit * 6}px`};\n  .ant-select {\n    width: 100%;\n  }\n  .control-label {\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n`;\n\nexport const StyledIconWrapper = styled.span`\n  span {\n    margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n    vertical-align: middle;\n  }\n  .text {\n    vertical-align: middle;\n  }\n`;\n\nexport const StyledScheduleTitle = styled.div`\n  margin-bottom: ${({ theme }) => theme.gridUnit * 7}px;\n\n  h4 {\n    margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  }\n`;\n\nexport const StyledCronPicker = styled(CronPicker)`\n  margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  width: ${({ theme }) => theme.gridUnit * 120}px;\n`;\n\nexport const StyledCronError = styled.p`\n  color: ${({ theme }) => theme.colors.error.base};\n`;\n\nexport const noBottomMargin = css`\n  margin-bottom: 0;\n`;\n\nexport const StyledFooterButton = styled(Button)`\n  width: ${({ theme }) => theme.gridUnit * 40}px;\n`;\n\nexport const TimezoneHeaderStyle = (theme: SupersetTheme) => css`\n  margin: ${theme.gridUnit * 3}px 0 ${theme.gridUnit * 2}px;\n`;\n\nexport const SectionHeaderStyle = (theme: SupersetTheme) => css`\n  margin: ${theme.gridUnit * 3}px 0;\n`;\n\nexport const StyledMessageContentTitle = styled.div`\n  margin: ${({ theme }) => theme.gridUnit * 8}px 0\n    ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nexport const StyledRadio = styled(Radio)`\n  display: block;\n  line-height: ${({ theme }) => theme.gridUnit * 8}px;\n`;\n\nexport const StyledRadioGroup = styled(Radio.Group)`\n  margin-left: ${({ theme }) => theme.gridUnit * 0.5}px;\n`;\n\nexport const antDErrorAlertStyles = (theme: SupersetTheme) => css`\n  border: ${theme.colors.error.base} 1px solid;\n  padding: ${theme.gridUnit * 4}px;\n  margin: ${theme.gridUnit * 4}px;\n  margin-top: 0;\n  color: ${theme.colors.error.dark2};\n  .ant-alert-message {\n    font-size: ${theme.typography.sizes.m}px;\n    font-weight: bold;\n  }\n  .ant-alert-description {\n    font-size: ${theme.typography.sizes.m}px;\n    line-height: ${theme.gridUnit * 4}px;\n    .ant-alert-icon {\n      margin-right: ${theme.gridUnit * 2.5}px;\n      font-size: ${theme.typography.sizes.l}px;\n      position: relative;\n      top: ${theme.gridUnit / 4}px;\n    }\n  }\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { styled } from '@superset-ui/core';\nimport BaseSwitch, { SwitchProps } from 'antd/lib/switch';\n\nconst StyledSwitch = styled(BaseSwitch)`\n  .ant-switch-checked {\n    background-color: ${({ theme }) => theme.colors.primary.base};\n  }\n`;\n\nexport const Switch = (props: SwitchProps) => <StyledSwitch {...props} />;\nexport type { SwitchProps };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useEffect, useMemo } from 'react';\nimport moment from 'moment-timezone';\nimport { t } from '@superset-ui/core';\nimport { Select } from 'src/components';\n\nconst DEFAULT_TIMEZONE = {\n  name: 'GMT Standard Time',\n  value: 'Africa/Abidjan', // timezones are deduped by the first alphabetical value\n};\n\nconst MIN_SELECT_WIDTH = '400px';\n\nconst offsetsToName = {\n  '-300-240': ['Eastern Standard Time', 'Eastern Daylight Time'],\n  '-360-300': ['Central Standard Time', 'Central Daylight Time'],\n  '-420-360': ['Mountain Standard Time', 'Mountain Daylight Time'],\n  '-420-420': [\n    'Mountain Standard Time - Phoenix',\n    'Mountain Standard Time - Phoenix',\n  ],\n  '-480-420': ['Pacific Standard Time', 'Pacific Daylight Time'],\n  '-540-480': ['Alaska Standard Time', 'Alaska Daylight Time'],\n  '-600-600': ['Hawaii Standard Time', 'Hawaii Daylight Time'],\n  '60120': ['Central European Time', 'Central European Daylight Time'],\n  '00': [DEFAULT_TIMEZONE.name, DEFAULT_TIMEZONE.name],\n  '060': ['GMT Standard Time - London', 'British Summer Time'],\n};\n\nconst currentDate = moment();\nconst JANUARY = moment([2021, 1]);\nconst JULY = moment([2021, 7]);\n\nconst getOffsetKey = (name: string) =>\n  JANUARY.tz(name).utcOffset().toString() +\n  JULY.tz(name).utcOffset().toString();\n\nconst getTimezoneName = (name: string) => {\n  const offsets = getOffsetKey(name);\n  return (\n    (currentDate.tz(name).isDST()\n      ? offsetsToName[offsets]?.[1]\n      : offsetsToName[offsets]?.[0]) || name\n  );\n};\n\nconst ALL_ZONES = moment.tz\n  .countries()\n  .map(country => moment.tz.zonesForCountry(country, true))\n  .flat();\n\nconst TIMEZONES: moment.MomentZoneOffset[] = [];\nALL_ZONES.forEach(zone => {\n  if (\n    !TIMEZONES.find(\n      option => getOffsetKey(option.name) === getOffsetKey(zone.name),\n    )\n  ) {\n    TIMEZONES.push(zone); // dedupe zones by offsets\n  }\n});\n\nconst TIMEZONE_OPTIONS = TIMEZONES.map(zone => ({\n  label: `GMT ${moment\n    .tz(currentDate, zone.name)\n    .format('Z')} (${getTimezoneName(zone.name)})`,\n  value: zone.name,\n  offsets: getOffsetKey(zone.name),\n  timezoneName: zone.name,\n}));\n\nconst TIMEZONE_OPTIONS_SORT_COMPARATOR = (\n  a: typeof TIMEZONE_OPTIONS[number],\n  b: typeof TIMEZONE_OPTIONS[number],\n) =>\n  moment.tz(currentDate, a.timezoneName).utcOffset() -\n  moment.tz(currentDate, b.timezoneName).utcOffset();\n\n// pre-sort timezone options by time offset\nTIMEZONE_OPTIONS.sort(TIMEZONE_OPTIONS_SORT_COMPARATOR);\n\nconst matchTimezoneToOptions = (timezone: string) =>\n  TIMEZONE_OPTIONS.find(option => option.offsets === getOffsetKey(timezone))\n    ?.value || DEFAULT_TIMEZONE.value;\n\nexport type TimezoneSelectorProps = {\n  onTimezoneChange: (value: string) => void;\n  timezone?: string | null;\n  minWidth?: string;\n};\n\nexport default function TimezoneSelector({\n  onTimezoneChange,\n  timezone,\n  minWidth = MIN_SELECT_WIDTH, // smallest size for current values\n}: TimezoneSelectorProps) {\n  const validTimezone = useMemo(\n    () => matchTimezoneToOptions(timezone || moment.tz.guess()),\n    [timezone],\n  );\n\n  // force trigger a timezone update if provided `timezone` is not invalid\n  useEffect(() => {\n    if (timezone !== validTimezone) {\n      onTimezoneChange(validTimezone);\n    }\n  }, [validTimezone, onTimezoneChange, timezone]);\n\n  return (\n    <Select\n      ariaLabel={t('Timezone selector')}\n      css={{ minWidth }}\n      onChange={tz => onTimezoneChange(tz as string)}\n      value={validTimezone}\n      options={TIMEZONE_OPTIONS}\n      sortComparator={TIMEZONE_OPTIONS_SORT_COMPARATOR}\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  PartialFilters,\n  JsonObject,\n} from '@superset-ui/core';\nimport { ActiveFilters, ChartConfiguration } from '../types';\n\nexport const getRelevantDataMask = (\n  dataMask: DataMaskStateWithId,\n  prop: string,\n): JsonObject | DataMaskStateWithId =>\n  Object.values(dataMask)\n    .filter(item => item[prop])\n    .reduce(\n      (prev, next) => ({ ...prev, [next.id]: prop ? next[prop] : next }),\n      {},\n    );\n\nexport const getAllActiveFilters = ({\n  chartConfiguration,\n  nativeFilters,\n  dataMask,\n  allSliceIds,\n}: {\n  chartConfiguration: ChartConfiguration;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: PartialFilters;\n  allSliceIds: number[];\n}): ActiveFilters => {\n  const activeFilters = {};\n\n  // Combine native filters with cross filters, because they have similar logic\n  Object.values(dataMask).forEach(({ id: filterId, extraFormData }) => {\n    const scope =\n      nativeFilters?.[filterId]?.chartsInScope ??\n      chartConfiguration?.[filterId]?.crossFilters?.chartsInScope ??\n      allSliceIds ??\n      [];\n    // Iterate over all roots to find all affected charts\n    activeFilters[filterId] = {\n      scope,\n      values: extraFormData,\n    };\n  });\n  return activeFilters;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DataRecordFilters } from '@superset-ui/core';\n\nexport default function getEffectiveExtraFilters(filters: DataRecordFilters) {\n  return Object.entries(filters)\n    .map(([column, values]) => ({\n      col: column,\n      op: Array.isArray(values) ? 'IN' : '==',\n      val: values,\n    }))\n    .filter(filter => filter.val !== null);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  DataRecordFilters,\n  JsonObject,\n  PartialFilters,\n} from '@superset-ui/core';\nimport { ChartConfiguration, ChartQueryPayload } from 'src/dashboard/types';\nimport { getExtraFormData } from 'src/dashboard/components/nativeFilters/utils';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport getEffectiveExtraFilters from './getEffectiveExtraFilters';\nimport { getAllActiveFilters } from '../activeAllDashboardFilters';\n\n// We cache formData objects so that our connected container components don't always trigger\n// render cascades. we cannot leverage the reselect library because our cache size is >1\nconst cachedFiltersByChart = {};\nconst cachedFormdataByChart = {};\n\nexport interface GetFormDataWithExtraFiltersArguments {\n  chartConfiguration: ChartConfiguration;\n  chart: ChartQueryPayload;\n  filters: DataRecordFilters;\n  colorScheme?: string;\n  colorNamespace?: string;\n  sliceId: number;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: PartialFilters;\n  extraControls: Record<string, string | boolean | null>;\n  labelColors?: Record<string, string>;\n  sharedLabelColors?: Record<string, string>;\n  allSliceIds: number[];\n}\n\n// this function merge chart's formData with dashboard filters value,\n// and generate a new formData which will be used in the new query.\n// filters param only contains those applicable to this chart.\nexport default function getFormDataWithExtraFilters({\n  chart,\n  filters,\n  nativeFilters,\n  chartConfiguration,\n  colorScheme,\n  colorNamespace,\n  sliceId,\n  dataMask,\n  extraControls,\n  labelColors,\n  sharedLabelColors,\n  allSliceIds,\n}: GetFormDataWithExtraFiltersArguments) {\n  // if dashboard metadata + filters have not changed, use cache if possible\n  const cachedFormData = cachedFormdataByChart[sliceId];\n  if (\n    cachedFiltersByChart[sliceId] === filters &&\n    areObjectsEqual(cachedFormData?.color_scheme, colorScheme, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.color_namespace, colorNamespace, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.label_colors, labelColors, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.shared_label_colors, sharedLabelColors, {\n      ignoreUndefined: true,\n    }) &&\n    !!cachedFormData &&\n    areObjectsEqual(cachedFormData?.dataMask, dataMask, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.extraControls, extraControls, {\n      ignoreUndefined: true,\n    })\n  ) {\n    return cachedFormData;\n  }\n\n  let extraData: { extra_form_data?: JsonObject } = {};\n  const activeFilters = getAllActiveFilters({\n    chartConfiguration,\n    dataMask,\n    nativeFilters,\n    allSliceIds,\n  });\n  const filterIdsAppliedOnChart = Object.entries(activeFilters)\n    .filter(([, { scope }]) => scope.includes(chart.id))\n    .map(([filterId]) => filterId);\n  if (filterIdsAppliedOnChart.length) {\n    extraData = {\n      extra_form_data: getExtraFormData(dataMask, filterIdsAppliedOnChart),\n    };\n  }\n\n  const formData = {\n    ...chart.form_data,\n    label_colors: labelColors,\n    shared_label_colors: sharedLabelColors,\n    ...(colorScheme && { color_scheme: colorScheme }),\n    extra_filters: getEffectiveExtraFilters(filters),\n    ...extraData,\n    ...extraControls,\n  };\n\n  cachedFiltersByChart[sliceId] = filters;\n  cachedFormdataByChart[sliceId] = { ...formData, dataMask, extraControls };\n\n  return formData;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { zip } from 'lodash';\nimport { css, GenericDataType, styled } from '@superset-ui/core';\nimport {\n  CopyToClipboardButton,\n  FilterInput,\n  RowCount,\n} from 'src/explore/components/DataTableControl';\nimport { applyFormattingToTabularData } from 'src/utils/common';\nimport { getTimeColumns } from 'src/explore/components/DataTableControl/utils';\nimport { TableControlsProps } from '../types';\n\nexport const TableControlsWrapper = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: ${theme.gridUnit * 2}px;\n\n    span {\n      flex-shrink: 0;\n    }\n  `}\n`;\n\nexport const TableControls = ({\n  data,\n  datasourceId,\n  onInputChange,\n  columnNames,\n  columnTypes,\n  isLoading,\n}: TableControlsProps) => {\n  const originalTimeColumns = getTimeColumns(datasourceId);\n  const formattedTimeColumns = zip<string, GenericDataType>(\n    columnNames,\n    columnTypes,\n  )\n    .filter(\n      ([name, type]) =>\n        type === GenericDataType.TEMPORAL &&\n        name &&\n        !originalTimeColumns.includes(name),\n    )\n    .map(([colname]) => colname);\n  const formattedData = useMemo(\n    () => applyFormattingToTabularData(data, formattedTimeColumns),\n    [data, formattedTimeColumns],\n  );\n  return (\n    <TableControlsWrapper>\n      <FilterInput onChangeHandler={onInputChange} />\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n        `}\n      >\n        <RowCount data={data} loading={isLoading} />\n        <CopyToClipboardButton data={formattedData} columns={columnNames} />\n      </div>\n    </TableControlsWrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { t } from '@superset-ui/core';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { TableControls } from './DataTableControls';\nimport { SingleQueryResultPaneProp } from '../types';\n\nexport const SingleQueryResultPane = ({\n  data,\n  colnames,\n  coltypes,\n  datasourceId,\n  dataSize = 50,\n  isVisible,\n}: SingleQueryResultPaneProp) => {\n  const [filterText, setFilterText] = useState('');\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={false}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Datasource,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { ExploreActions } from 'src/explore/actions/exploreActions';\nimport { ChartStatus } from 'src/explore/types';\n\nexport enum ResultTypes {\n  Results = 'results',\n  Samples = 'samples',\n}\n\nexport interface DataTablesPaneProps {\n  queryFormData: QueryFormData;\n  datasource: Datasource;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  chartStatus: ChartStatus;\n  onCollapseChange: (isOpen: boolean) => void;\n  errorMessage?: JSX.Element;\n  actions: ExploreActions;\n}\n\nexport interface ResultsPaneProps {\n  isRequest: boolean;\n  queryFormData: QueryFormData;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  errorMessage?: React.ReactElement;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface SamplesPaneProps {\n  isRequest: boolean;\n  datasource: Datasource;\n  queryForce: boolean;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface TableControlsProps {\n  data: Record<string, any>[];\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  onInputChange: (input: string) => void;\n  columnNames: string[];\n  columnTypes: GenericDataType[];\n  isLoading: boolean;\n}\n\nexport interface QueryResultInterface {\n  colnames: string[];\n  coltypes: GenericDataType[];\n  data: Record<string, any>[][];\n}\n\nexport interface SingleQueryResultPaneProp extends QueryResultInterface {\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport {\n  ensureIsArray,\n  styled,\n  t,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { ResultsPaneProps, QueryResultInterface } from '../types';\nimport { SingleQueryResultPane } from './SingleQueryResultPane';\nimport { TableControls } from './DataTableControls';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakMap();\n\nexport const useResultsPane = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps): React.ReactElement[] => {\n  const metadata = getChartMetadataRegistry().get(\n    queryFormData?.viz_type || queryFormData?.vizType,\n  );\n\n  const [resultResp, setResultResp] = useState<QueryResultInterface[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [responseError, setResponseError] = useState<string>('');\n  const queryCount = metadata?.queryObjectCount ?? 1;\n\n  useEffect(() => {\n    // it's an invalid formData when gets a errorMessage\n    if (errorMessage) return;\n    if (isRequest && cache.has(queryFormData)) {\n      setResultResp(ensureIsArray(cache.get(queryFormData)));\n      setResponseError('');\n      if (queryForce && actions) {\n        actions.setForceQuery(false);\n      }\n      setIsLoading(false);\n    }\n    if (isRequest && !cache.has(queryFormData)) {\n      setIsLoading(true);\n      getChartDataRequest({\n        formData: queryFormData,\n        force: queryForce,\n        resultFormat: 'json',\n        resultType: 'results',\n        ownState,\n      })\n        .then(({ json }) => {\n          setResultResp(ensureIsArray(json.result));\n          setResponseError('');\n          cache.set(queryFormData, json.result);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(response => {\n          getClientErrorObject(response).then(({ error, message }) => {\n            setResponseError(error || message || t('Sorry, an error occurred'));\n          });\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [queryFormData, isRequest]);\n\n  useEffect(() => {\n    if (errorMessage) {\n      setIsLoading(false);\n    }\n  }, [errorMessage]);\n\n  if (isLoading) {\n    return Array(queryCount).fill(<Loading />);\n  }\n\n  if (errorMessage) {\n    const title = t('Run a query to display results');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  if (responseError) {\n    const err = (\n      <>\n        <TableControls\n          data={[]}\n          columnNames={[]}\n          columnTypes={[]}\n          datasourceId={queryFormData.datasource}\n          onInputChange={() => {}}\n          isLoading={false}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n    return Array(queryCount).fill(err);\n  }\n\n  if (resultResp.length === 0) {\n    const title = t('No results were returned for this query');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  return resultResp\n    .slice(0, queryCount)\n    .map((result, idx) => (\n      <SingleQueryResultPane\n        data={result.data}\n        colnames={result.colnames}\n        coltypes={result.coltypes}\n        dataSize={dataSize}\n        datasourceId={queryFormData.datasource}\n        key={idx}\n        isVisible={isVisible}\n      />\n    ));\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, styled } from '@superset-ui/core';\nimport Tabs from 'src/components/Tabs';\nimport { ResultTypes, ResultsPaneProps } from '../types';\nimport { useResultsPane } from './useResultsPane';\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .ant-tabs {\n    height: 100%;\n  }\n\n  .ant-tabs-content {\n    height: 100%;\n  }\n\n  .ant-tabs-tabpane {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-condensed {\n    overflow: auto;\n  }\n`;\n\nexport const ResultsPaneOnDashboard = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps) => {\n  const resultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest,\n    actions,\n    dataSize,\n    isVisible,\n  });\n\n  if (resultsPanes.length === 1) {\n    return <Wrapper>{resultsPanes[0]}</Wrapper>;\n  }\n\n  const panes = resultsPanes.map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n\n    return (\n      <Tabs.TabPane\n        tab={t('Results %s', idx + 1)}\n        key={`${ResultTypes.Results} ${idx + 1}`}\n      >\n        {pane}\n      </Tabs.TabPane>\n    );\n  });\n\n  return (\n    <Wrapper>\n      <Tabs fullWidth={false}>{panes}</Tabs>\n    </Wrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { ensureIsArray, GenericDataType, styled, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport { TableControls } from './DataTableControls';\nimport { SamplesPaneProps } from '../types';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakSet();\n\nexport const SamplesPane = ({\n  isRequest,\n  datasource,\n  queryForce,\n  actions,\n  dataSize = 50,\n  isVisible,\n}: SamplesPaneProps) => {\n  const [filterText, setFilterText] = useState('');\n  const [data, setData] = useState<Record<string, any>[][]>([]);\n  const [colnames, setColnames] = useState<string[]>([]);\n  const [coltypes, setColtypes] = useState<GenericDataType[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [responseError, setResponseError] = useState<string>('');\n  const datasourceId = useMemo(\n    () => `${datasource.id}__${datasource.type}`,\n    [datasource],\n  );\n\n  useEffect(() => {\n    if (isRequest && queryForce) {\n      cache.delete(datasource);\n    }\n\n    if (isRequest && !cache.has(datasource)) {\n      setIsLoading(true);\n      getDatasourceSamples(datasource.type, datasource.id, queryForce, {})\n        .then(response => {\n          setData(ensureIsArray(response.data));\n          setColnames(ensureIsArray(response.colnames));\n          setColtypes(ensureIsArray(response.coltypes));\n          setResponseError('');\n          cache.add(datasource);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(error => {\n          setData([]);\n          setColnames([]);\n          setColtypes([]);\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [datasource, isRequest, queryForce]);\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n  if (responseError) {\n    return (\n      <>\n        <TableControls\n          data={filteredData}\n          columnNames={colnames}\n          columnTypes={coltypes}\n          datasourceId={datasourceId}\n          onInputChange={input => setFilterText(input)}\n          isLoading={isLoading}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n  }\n\n  if (data.length === 0) {\n    const title = t('No samples were returned for this dataset');\n    return <EmptyStateMedium image=\"document.svg\" title={title} />;\n  }\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={isLoading}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  MouseEvent,\n} from 'react';\nimport { FeatureFlag, styled, t, useTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport Tabs from 'src/components/Tabs';\nimport { isFeatureEnabled } from 'src/featureFlags';\nimport {\n  getItem,\n  setItem,\n  LocalStorageKeys,\n} from 'src/utils/localStorageHelpers';\nimport {\n  SamplesPane,\n  TableControlsWrapper,\n  useResultsPane,\n} from './components';\nimport { DataTablesPaneProps, ResultTypes } from './types';\n\nconst SouthPane = styled.div`\n  ${({ theme }) => `\n    position: relative;\n    background-color: ${theme.colors.grayscale.light5};\n    z-index: 5;\n    overflow: hidden;\n\n    .ant-tabs {\n      height: 100%;\n    }\n\n    .ant-tabs-content-holder {\n      height: 100%;\n    }\n\n    .ant-tabs-content {\n      height: 100%;\n    }\n\n    .ant-tabs-tabpane {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      .table-condensed {\n        height: 100%;\n        overflow: auto;\n        margin-bottom: ${theme.gridUnit * 4}px;\n\n        .table {\n          margin-bottom: ${theme.gridUnit * 2}px;\n        }\n      }\n\n      .pagination-container > ul[role='navigation'] {\n        margin-top: 0;\n      }\n    }\n  `}\n`;\n\nexport const DataTablesPane = ({\n  queryFormData,\n  datasource,\n  queryForce,\n  onCollapseChange,\n  chartStatus,\n  ownState,\n  errorMessage,\n  actions,\n}: DataTablesPaneProps) => {\n  const theme = useTheme();\n  const [activeTabKey, setActiveTabKey] = useState<string>(ResultTypes.Results);\n  const [isRequest, setIsRequest] = useState<Record<ResultTypes, boolean>>({\n    results: false,\n    samples: false,\n  });\n  const [panelOpen, setPanelOpen] = useState(\n    isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT)\n      ? false\n      : getItem(LocalStorageKeys.is_datapanel_open, false),\n  );\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT))\n      setItem(LocalStorageKeys.is_datapanel_open, panelOpen);\n  }, [panelOpen]);\n\n  useEffect(() => {\n    if (!panelOpen) {\n      setIsRequest({\n        results: false,\n        samples: false,\n      });\n    }\n\n    if (\n      panelOpen &&\n      activeTabKey.startsWith(ResultTypes.Results) &&\n      chartStatus === 'rendered'\n    ) {\n      setIsRequest({\n        results: true,\n        samples: false,\n      });\n    }\n\n    if (panelOpen && activeTabKey === ResultTypes.Samples) {\n      setIsRequest({\n        results: false,\n        samples: true,\n      });\n    }\n  }, [panelOpen, activeTabKey, chartStatus]);\n\n  const handleCollapseChange = useCallback(\n    (isOpen: boolean) => {\n      onCollapseChange(isOpen);\n      setPanelOpen(isOpen);\n    },\n    [onCollapseChange],\n  );\n\n  const handleTabClick = useCallback(\n    (tabKey: string, e: MouseEvent) => {\n      if (!panelOpen) {\n        handleCollapseChange(true);\n      } else if (tabKey === activeTabKey) {\n        e.preventDefault();\n        handleCollapseChange(false);\n      }\n      setActiveTabKey(tabKey);\n    },\n    [activeTabKey, handleCollapseChange, panelOpen],\n  );\n\n  const CollapseButton = useMemo(() => {\n    const caretIcon = panelOpen ? (\n      <Icons.CaretUp\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Collapse data panel')}\n      />\n    ) : (\n      <Icons.CaretDown\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Expand data panel')}\n      />\n    );\n    return (\n      <TableControlsWrapper>\n        {panelOpen ? (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(false)}\n          >\n            {caretIcon}\n          </span>\n        ) : (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(true)}\n          >\n            {caretIcon}\n          </span>\n        )}\n      </TableControlsWrapper>\n    );\n  }, [handleCollapseChange, panelOpen, theme.colors.grayscale.base]);\n\n  const queryResultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest: isRequest.results,\n    actions,\n    isVisible: ResultTypes.Results === activeTabKey,\n  }).map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    if (idx > 0) {\n      return (\n        <Tabs.TabPane\n          tab={t('Results %s', idx + 1)}\n          key={`${ResultTypes.Results} ${idx + 1}`}\n        >\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    return null;\n  });\n\n  return (\n    <SouthPane data-test=\"some-purposeful-instance\">\n      <Tabs\n        fullWidth={false}\n        tabBarExtraContent={CollapseButton}\n        activeKey={panelOpen ? activeTabKey : ''}\n        onTabClick={handleTabClick}\n      >\n        {queryResultsPanes}\n        <Tabs.TabPane tab={t('Samples')} key={ResultTypes.Samples}>\n          <SamplesPane\n            datasource={datasource}\n            queryForce={queryForce}\n            isRequest={isRequest.samples}\n            actions={actions}\n            isVisible={ResultTypes.Samples === activeTabKey}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n    </SouthPane>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { styled, ensureIsArray, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport ViewQuery from 'src/explore/components/controls/ViewQuery';\n\ninterface Props {\n  latestQueryFormData: object;\n}\n\ntype Result = {\n  query: string;\n  language: string;\n};\n\nconst ViewQueryModalContainer = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ViewQueryModal: React.FC<Props> = props => {\n  const [result, setResult] = useState<Result[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadChartData = (resultType: string) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType,\n    })\n      .then(({ json }) => {\n        setResult(ensureIsArray(json.result));\n        setIsLoading(false);\n        setError(null);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(({ error, message }) => {\n          setError(\n            error ||\n              message ||\n              response.statusText ||\n              t('Sorry, An error occurred'),\n          );\n          setIsLoading(false);\n        });\n      });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [JSON.stringify(props.latestQueryFormData)]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  if (error) {\n    return <pre>{error}</pre>;\n  }\n\n  return (\n    <ViewQueryModalContainer>\n      {result.map(item =>\n        item.query ? (\n          <ViewQuery sql={item.query} language={item.language || undefined} />\n        ) : null,\n      )}\n    </ViewQueryModalContainer>\n  );\n};\n\nexport default ViewQueryModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport { Dataset } from 'src/components/Chart/types';\nimport MetadataBar from 'src/components/MetadataBar';\nimport {\n  ContentType,\n  MetadataType,\n} from 'src/components/MetadataBar/ContentType';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';\n\nexport type UseDatasetMetadataBarProps =\n  | { datasetId?: undefined; dataset: Dataset }\n  | { datasetId: number | string; dataset?: undefined };\nexport const useDatasetMetadataBar = ({\n  dataset: datasetProps,\n  datasetId,\n}: UseDatasetMetadataBarProps) => {\n  const theme = useTheme();\n  const [result, setResult] = useState<Dataset>();\n  const [status, setStatus] = useState<ResourceStatus>(\n    datasetProps ? ResourceStatus.COMPLETE : ResourceStatus.LOADING,\n  );\n\n  useEffect(() => {\n    if (!datasetProps && datasetId) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then(({ json: { result } }) => {\n          setResult(result);\n          setStatus(ResourceStatus.COMPLETE);\n        })\n        .catch(() => {\n          setStatus(ResourceStatus.ERROR);\n        });\n    }\n  }, [datasetId, datasetProps]);\n\n  const metadataBar = useMemo(() => {\n    const items: ContentType[] = [];\n    const dataset = datasetProps || result;\n    if (dataset) {\n      const {\n        changed_on_humanized,\n        created_on_humanized,\n        description,\n        table_name,\n        changed_by,\n        created_by,\n        owners,\n      } = dataset;\n      const notAvailable = t('Not available');\n      const createdBy =\n        `${created_by?.first_name ?? ''} ${\n          created_by?.last_name ?? ''\n        }`.trim() || notAvailable;\n      const modifiedBy = changed_by\n        ? `${changed_by.first_name} ${changed_by.last_name}`\n        : notAvailable;\n      const formattedOwners =\n        owners?.length > 0\n          ? owners.map(owner => `${owner.first_name} ${owner.last_name}`)\n          : [notAvailable];\n      items.push({\n        type: MetadataType.TABLE,\n        title: table_name,\n      });\n      items.push({\n        type: MetadataType.LAST_MODIFIED,\n        value: changed_on_humanized,\n        modifiedBy,\n      });\n      items.push({\n        type: MetadataType.OWNER,\n        createdBy,\n        owners: formattedOwners,\n        createdOn: created_on_humanized,\n      });\n      if (description) {\n        items.push({\n          type: MetadataType.DESCRIPTION,\n          value: description,\n        });\n      }\n    }\n    return (\n      <div\n        css={css`\n          display: flex;\n          margin-bottom: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {status === ResourceStatus.COMPLETE && (\n          <MetadataBar items={items} tooltipPlacement=\"bottom\" />\n        )}\n        {status === ResourceStatus.ERROR && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the dataset metadata')}\n          />\n        )}\n      </div>\n    );\n  }, [datasetProps, result, status, theme.gridUnit]);\n\n  return {\n    metadataBar,\n    status,\n  };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport shortid from 'shortid';\nimport { BroadcastChannel } from 'broadcast-channel';\n\ninterface TabIdChannelMessage {\n  type: 'REQUESTING_TAB_ID' | 'TAB_ID_DENIED';\n  tabId: string;\n}\n\n// TODO: We are using broadcast-channel to support Safari.\n// The native BroadcastChannel API will be supported in Safari version 15.4.\n// After that, we should remove this dependency and use the native API.\nconst channel = new BroadcastChannel<TabIdChannelMessage>('tab_id_channel');\n\nexport function useTabId() {\n  const [tabId, setTabId] = useState<string>();\n\n  function isStorageAvailable() {\n    try {\n      return window.localStorage && window.sessionStorage;\n    } catch (error) {\n      return false;\n    }\n  }\n  useEffect(() => {\n    if (!isStorageAvailable()) {\n      if (!tabId) {\n        setTabId(shortid.generate());\n      }\n      return;\n    }\n\n    const updateTabId = () => {\n      const lastTabId = window.localStorage.getItem('last_tab_id');\n      const newTabId = String(\n        lastTabId ? Number.parseInt(lastTabId, 10) + 1 : 1,\n      );\n      window.sessionStorage.setItem('tab_id', newTabId);\n      window.localStorage.setItem('last_tab_id', newTabId);\n      setTabId(newTabId);\n    };\n\n    const storedTabId = window.sessionStorage.getItem('tab_id');\n    if (storedTabId) {\n      channel.postMessage({\n        type: 'REQUESTING_TAB_ID',\n        tabId: storedTabId,\n      });\n      setTabId(storedTabId);\n    } else {\n      updateTabId();\n    }\n\n    channel.onmessage = messageEvent => {\n      if (messageEvent.tabId === tabId) {\n        if (messageEvent.type === 'REQUESTING_TAB_ID') {\n          const message: TabIdChannelMessage = {\n            type: 'TAB_ID_DENIED',\n            tabId: messageEvent.tabId,\n          };\n          channel.postMessage(message);\n        } else if (messageEvent.type === 'TAB_ID_DENIED') {\n          updateTabId();\n        }\n      }\n    };\n  }, [tabId]);\n\n  return tabId;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SupersetClient } from '@superset-ui/core';\nimport { cacheWrapper } from './cacheWrapper';\n\nexport const supersetGetCache = new Map<string, any>();\n\nexport const cachedSupersetGet = cacheWrapper(\n  SupersetClient.get,\n  supersetGetCache,\n  ({ endpoint }) => endpoint || '',\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SyntheticEvent } from 'react';\nimport domToImage from 'dom-to-image-more';\nimport kebabCase from 'lodash/kebabCase';\nimport { t, supersetTheme } from '@superset-ui/core';\nimport { addWarningToast } from 'src/components/MessageToasts/actions';\n\n/**\n * generate a consistent file stem from a description and date\n *\n * @param description title or description of content of file\n * @param date date when file was generated\n */\nconst generateFileStem = (description: string, date = new Date()) =>\n  `${kebabCase(description)}-${date.toISOString().replace(/[: ]/g, '-')}`;\n\n/**\n * Create an event handler for turning an element into an image\n *\n * @param selector css selector of the parent element which should be turned into image\n * @param description name or a short description of what is being printed.\n *   Value will be normalized, and a date as well as a file extension will be added.\n * @param isExactSelector if false, searches for the closest ancestor that matches selector.\n * @returns event handler\n */\nexport default function downloadAsImage(\n  selector: string,\n  description: string,\n  isExactSelector = false,\n) {\n  return (event: SyntheticEvent) => {\n    const elementToPrint = isExactSelector\n      ? document.querySelector(selector)\n      : event.currentTarget.closest(selector);\n\n    if (!elementToPrint) {\n      return addWarningToast(\n        t('Image download failed, please refresh and try again.'),\n      );\n    }\n\n    // Mapbox controls are loaded from different origin, causing CORS error\n    // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL#exceptions\n    const filter = (node: Element) => {\n      if (typeof node.className === 'string') {\n        return (\n          node.className !== 'mapboxgl-control-container' &&\n          !node.className.includes('ant-dropdown')\n        );\n      }\n      return true;\n    };\n\n    return domToImage\n      .toJpeg(elementToPrint, {\n        quality: 0.95,\n        bgcolor: supersetTheme.colors.grayscale.light4,\n        filter,\n      })\n      .then(dataUrl => {\n        const link = document.createElement('a');\n        link.download = `${generateFileStem(description)}.jpg`;\n        link.href = dataUrl;\n        link.click();\n      })\n      .catch(e => {\n        console.error('Creating image failed', e);\n      });\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '@superset-ui/core';\n\nconst CREATE_CHART_TEXT = t('Create chart');\nconst UPDATE_CHART_TEXT = t('Update chart');\n\nexport const getChartRequiredFieldsMissingMessage = (isCreating: boolean) =>\n  t(\n    'Select values in highlighted field(s) in the control panel. Then run the query by clicking on the %s button.',\n    `\"${isCreating ? CREATE_CHART_TEXT : UPDATE_CHART_TEXT}\"`,\n  );\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// navigator.webdriver is true when browser is controlled by a bot\nexport const isCurrentUserBot = () => window?.navigator?.webdriver;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocFilter,\n  isAdhocColumn,\n  QueryObjectFilterClause,\n  SimpleAdhocFilter,\n} from '@superset-ui/core';\nimport {\n  CLAUSES,\n  EXPRESSION_TYPES,\n} from '../explore/components/controls/FilterControl/types';\nimport { OPERATOR_ENUM_TO_OPERATOR_TYPE } from '../explore/constants';\nimport { translateToSql } from '../explore/components/controls/FilterControl/utils/translateToSQL';\n\nexport const simpleFilterToAdhoc = (\n  filterClause: QueryObjectFilterClause,\n  clause: CLAUSES = CLAUSES.WHERE,\n) => {\n  let result: AdhocFilter;\n  if (isAdhocColumn(filterClause.col)) {\n    result = {\n      expressionType: 'SQL',\n      clause,\n      sqlExpression: translateToSql({\n        expressionType: EXPRESSION_TYPES.SIMPLE,\n        subject: `(${filterClause.col.sqlExpression})`,\n        operator: filterClause.op,\n        comparator: 'val' in filterClause ? filterClause.val : undefined,\n      } as SimpleAdhocFilter),\n    };\n  } else {\n    result = {\n      expressionType: 'SIMPLE',\n      clause,\n      operator: filterClause.op,\n      operatorId: Object.entries(OPERATOR_ENUM_TO_OPERATOR_TYPE).find(\n        operatorEntry => operatorEntry[1].operation === filterClause.op,\n      )?.[0],\n      subject: filterClause.col,\n      comparator: 'val' in filterClause ? filterClause.val : undefined,\n    } as SimpleAdhocFilter;\n  }\n  if (filterClause.isExtra) {\n    Object.assign(result, {\n      isExtra: true,\n      filterOptionName: `filter_${Math.random()\n        .toString(36)\n        .substring(2, 15)}_${Math.random().toString(36).substring(2, 15)}`,\n    });\n  }\n  return result;\n};\n"],"names":["ChartSource","DrillByType","DrillByChart","formData","result","dataset","onContextMenu","inContextMenu","hooks","useMemo","css","SuperChart","disableErrorBoundary","chartType","viz_type","enableNoResults","datasource","queriesData","height","width","BreadcrumbItem","styled","AntdBreadcrumb","theme","isClickable","colors","grayscale","light1","transitionTiming","dark1","PaginationContainer","gridUnit","DEFAULT_ADHOC_FILTER_FIELD_NAME","ModalFooter","closeModal","dispatch","useDispatch","addDangerToast","useToasts","url","setUrl","useState","dashboardPageId","useContext","DashboardPageIdContext","onEditChartClick","useCallback","logEvent","LOG_ACTIONS_DRILL_BY_EDIT_CHART","slice_id","datasource_id","datasource_type","split","useEffect","postFormData","Number","then","key","catch","t","Button","buttonStyle","buttonSize","onClick","disabled","to","DrillByModal","column","drillByConfig","onHideModal","useTheme","isChartDataLoading","setIsChartDataLoading","drillByConfigs","setDrillByConfigs","LOG_ACTIONS_DRILL_BY_MODAL_OPENED","currentColumn","groupbyFieldName","length","initialGroupbyColumns","ensureIsArray","map","colName","columns","find","col","column_name","filter","isDefined","displayModeToggle","drillByDisplayMode","setDrillByDisplayMode","Chart","Radio","onChange","target","value","defaultValue","Table","useDisplayModeToggle","chartDataResult","setChartDataResult","resultsTable","datasourceId","SingleQueryResultPane","colnames","coltypes","data","dataSize","isVisible","Tabs","fullWidth","res","index","tab","useResultsTableView","currentFormData","setCurrentFormData","usedGroupbyColumns","setUsedGroupbyColumns","breadcrumbsData","setBreadcrumbsData","groupby","filters","getNewGroupby","groupbyCol","fieldName","Array","isArray","getFormDataChangesFromConfigs","configs","reduce","acc","config","overridenGroupbyFields","add","adhocFilterFieldName","simpleFilterToAdhoc","overridenAdhocFilterFields","Set","getFiltersFromConfigsByFieldName","breadcrumbs","onBreadcrumbClick","noOp","breadcrumb","verbose_name","join","formattedVal","val","getBreadcrumbText","useDrillByBreadcrumbs","LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED","prevConfigs","slice","prevBreadcrumbs","newBreadcrumbs","prevUsedGroupbyColumns","overrideFormData","newFormData","forEach","adhocFilterField","drilledFormData","updatedFormData","adhocFilters","Object","keys","slice_name","dashboards","usedCols","some","usedCol","onSelection","newColumn","LOG_ACTIONS_FURTHER_DRILL_BY","drill_depth","additionalConfig","drillBy","excludedColumns","openNewModal","contextMenu","chartId","displayedItems","contextMenuRef","useRef","setInContextMenu","handleContextMenuSelected","args","handleContextMenuClosed","ref","id","onClose","offsetX","offsetY","current","open","useContextMenu","ContextMenuItem","DrillBy","chartName","useSelector","state","chartLayoutItem","values","dashboardLayout","present","layoutItem","meta","sliceNameOverride","sliceName","undefined","getChartDataRequest","json","finally","metadataBar","useDatasetMetadataBar","Modal","show","onHide","title","footer","responsive","resizable","resizableConfig","minHeight","minWidth","defaultSize","draggable","destroyOnClose","maskClosable","Loading","Alert","type","message","DrillByMenuItems","contextMenuY","submenuIndex","rest","isLoadingColumns","setIsLoadingColumns","searchInput","setSearchInput","setDataset","setColumns","showModal","setShowModal","setCurrentColumn","handleSelection","event","hasDrillBy","handlesDimensionContextMenu","getChartMetadataRegistry","get","behaviors","behavior","Behavior","verboseMap","verbose_map","metrics","metric","metric_name","useVerboseMap","datasetId","cachedSupersetGet","endpoint","x_axis","every","excludedCol","supersetGetCache","handleInput","e","stopPropagation","input","filteredColumns","toLowerCase","submenuYOffset","getSubmenuYOffset","tooltip","Menu","popupClassName","popupOffset","Input","prefix","Icons","iconSize","iconColor","placeholder","nativeEvent","stopImmediatePropagation","allowClear","position","MenuItemWithTruncation","tooltipText","ChartContextMenu","All","canExplore","findPermission","user","roles","crossFiltersEnabled","dashboardInfo","isDisplayed","item","clientX","clientY","setState","menuItems","showDrillToDetail","isFeatureEnabled","FeatureFlag","DrillToDetail","showDrillBy","showCrossFilters","CrossFilter","isCrossFilteringSupportedByChart","itemsCount","isCrossFilterDisabled","crossFilter","crossFilteringTooltipTitle","push","updateDataMask","dataMask","isCurrentValueSelected","color","base","DrillDetail","drillToDetail","isContextMenu","adjustedY","getMenuAdjustedY","document","getElementById","click","useImperativeHandle","ReactDOM","overlay","className","trigger","onVisibleChange","visibility","top","left","body","forwardRef","propTypes","annotationData","PropTypes","actions","initialValues","latestQueryFormData","labelColors","sharedLabelColors","setControlValue","vizType","triggerRender","chartAlert","chartStatus","queriesResponse","triggerQuery","chartIsStale","addFilter","setDataMask","onFilterMenuOpen","onFilterMenuClose","ownState","postTransformProps","source","Dashboard","Explore","emitCrossFilters","BLANK","defaultProps","ChartRenderer","React","constructor","props","super","this","showContextMenu","hasQueryResponseChange","handleAddFilter","bind","handleRenderSuccess","handleRenderFailure","handleSetControlValue","handleOnContextMenu","onContextMenuFallback","onAddFilter","onError","mutableQueriesResponse","shouldComponentUpdate","nextProps","nextState","indexOf","error","filterState","color_scheme","stack","cacheBusterProp","vals","merge","refresh","chartRenderingSucceeded","LOG_ACTIONS_RENDER_CHART","start_offset","renderStartTime","ts","Date","getTime","duration","Logger","info","logging","chartRenderingFailed","toString","componentStack","has_err","error_details","preventDefault","render","snakeCaseVizType","chartClassName","noResultsComponent","noResultTitle","noResultDescription","noResultImage","EmptyState","description","image","drillToDetailProps","onRenderSuccess","onRenderFailure","noResults","ChartErrorMessage","owners","useChartOwnerNames","ownedError","extra","ErrorMessageWithStackTrace","dashboardId","timeout","force","isFiltersInitialized","chartStackTrace","errorMessage","onQuery","datasetsStatus","isInView","NONEXISTENT_DATASET","Styles","p","typography","sizes","s","MonospaceDiv","families","monospace","handleRenderContainerFailure","componentDidMount","runQuery","componentDidUpdate","getSavedChart","getUrlParam","URL_PARAMS","postChartFormData","renderErrorMessage","queryResponse","errors","PLACEHOLDER_DATASOURCE","ResourceStatus","subtitle","copyText","link","stackTrace","isLoading","renderContainerStartTime","getChartRequiredFieldsMissingMessage","ErrorBoundary","showMessage","isCurrentUserBot","role","tabIndex","connect","bindActionCreators","CopyButtonEmbedCode","CopyButton","setHeight","setWidth","setErrorMessage","handleInputChange","name","currentTarget","updateUrl","getChartPermalink","html","srcLink","text","CopyToClipboard","shouldShowText","copyNode","rows","readOnly","secondary","light5","htmlFor","menuProps","dashboardSearch","setDashboardSearch","hoveredItem","setHoveredItem","showSearch","filteredDashboards","dashboard","dashboard_title","noResultsFound","urlQueryString","String","onMouseEnter","onMouseLeave","rel","MENU_KEYS","VIZ_TYPES_PIVOTABLE","MenuItemWithCheckboxContainer","iconReset","primary","dark2","useExploreAdditionalActionsMenu","canDownloadCSV","onOpenInEditor","onOpenPropertiesModal","addSuccessToast","showReportSubMenu","setShowReportSubMenu","isDropdownVisible","setIsDropdownVisible","openSubmenus","setOpenSubmenus","chart","charts","getChartKey","explore","shareByEmail","async","subject","encodeURIComponent","window","location","href","exportCSV","exportChart","resultType","resultFormat","exportCSVPivoted","exportJson","exportExcel","copyLink","Error","copyTextToClipboard","handleMenuClick","domEvent","downloadAsImage","selectable","openKeys","onOpenChange","icon","ModalTrigger","triggerNode","modalTitle","modalBody","maxWidth","useTextMenu","ViewQueryModal","MenuItemTooltip","placement","label","BOOL_TRUE_DISPLAY","BOOL_FALSE_DISPLAY","NULL_DISPLAY","format","TimeFormats","getTimeFormatter","headerTitle","groupTitle","groupOptions","popoverVisible","setPopoverVisible","Popover","visible","content","weights","bold","direction","option","arrowPointAtCenter","TableControls","setFilters","totalCount","loading","onReload","filterMap","assign","isAdhocColumn","removeFilter","updatedFilterMap","filterTags","entries","sort","a","b","localeCompare","closable","RowCountLabel","rowcount","TimeFormatting","Resizable","children","useResizeDetector","DrillDetailPane","initialFilters","pageIndex","setPageIndex","lastPageIndex","setIsLoading","responseError","setResponseError","resultsPages","setResultsPages","Map","timeFormatting","setTimeFormatting","SAMPLES_ROW_LIMIT","common","conf","datasourceType","status","metadataBarStatus","resultsPage","nextResultsPage","mappedColumns","colNames","dataIndex","colTypes","GenericDataType","Original","Formatted","row","curr","handleReload","has","at","nextResultsPages","delete","set","jsonPayload","queryFormData","drillFilters","queryObject","buildQueryObject","extras","f","granularity","time_range","getDrillPayload","cachePageLimit","Math","ceil","getDatasourceSamples","response","total","total_count","bootstrapping","size","tableContent","TableSize","defaultPageSize","recordCount","usePagination","pagination","virtualize","exploreChart","DrillDetailModal","history","useHistory","sliceEntities","slices","exploreUrl","DRILL_TO_DETAIL_TEXT","DisabledMenuItem","Filter","modalFilters","openModal","noAggregations","extractQueryFields","drillToDetailMenuItem","drillToDetailByMenuItem","i","itemRef","itemIsTruncated","useCSSTextTruncation","truncationCSS","maxItemsContainerHeight","additionalItemsHeight","MAX_SAFE_INTEGER","vh","max","documentElement","clientHeight","innerHeight","menuHeight","min","submenuY","LOCALE","everyText","emptyMonths","emptyMonthDays","emptyMonthDaysShort","emptyWeekDays","emptyWeekDaysShort","emptyHours","emptyMinutes","emptyMinutesForHourPeriod","yearOption","monthOption","weekOption","dayOption","hourOption","minuteOption","rebootOption","prefixPeriod","prefixMonths","prefixMonthDays","prefixWeekDays","prefixWeekDaysForMonthAndYearPeriod","prefixHours","prefixMinutes","prefixMinutesForHourPeriod","suffixMinutesForHourPeriod","errorInvalidCron","clearButtonText","weekDays","months","altWeekDays","altMonths","CronPicker","getPopupContainer","parentElement","locale","light4","MenuDots","normal","MenuDotsWrapper","IconOrientation","Dropdown","iconOrientation","VERTICAL","HORIZONTAL","RenderIcon","NoAnimationDropdown","overlayStyle","zIndex","animationDuration","MetadataType","Header","Info","header","SPACE_BETWEEN_ITEMS","ORDER","table","sql","tags","owner","lastModified","Bar","count","HORIZONTAL_PADDING","borderRadius","StyledItem","collapsed","last","ICON_WIDTH","TootipContent","Item","barWidth","contentType","tooltipPlacement","modifiedBy","createdBy","createdOn","isTruncated","setIsTruncated","Icon","scrollWidth","clientWidth","Tooltip","items","setCollapsed","sortedItems","onResize","breakpoint","Boolean","titleStyles","xl","DynamicEditableTitle","onSave","canEdit","isEditing","setIsEditing","currentTitle","setCurrentTitle","contentRef","showTooltip","setShowTooltip","inputWidth","sizerRef","containerWidth","containerRef","refreshMode","focus","setSelectionRange","scrollLeft","useLayoutEffect","innerHTML","replace","handleClick","handleBlur","formattedTitle","trim","handleChange","ev","handleKeyPress","blur","onBlur","onKeyPress","menuTriggerStyles","headerStyles","buttonsStyles","additionalActionsContainerStyles","PageHeaderWithActions","editableTitleProps","showTitlePanelItems","certificatiedBadgeProps","showFaveStar","faveStarProps","titlePanelAdditionalItems","rightPanelAdditionalItems","additionalActionsMenu","menuDropdownProps","tooltipProps","certifiedBy","CertifiedBadge","FaveStar","ReportType","NOTIFICATION_FORMATS","TEXT_BASED_VISUALIZATION_TYPES","INITIAL_STATE","crontab","EMPTY_OBJECT","withToasts","userId","userEmail","creationMethod","dashboardName","sliceFormData","isChart","isTextBasedChart","defaultNotificationFormat","TEXT","PNG","entityName","initialState","reportReducer","action","currentReport","setCurrentReport","useReducer","cronError","setCronError","report","resourceType","CreationMethod","DASHBOARDS","CHARTS","reportSelector","isEditMode","wrappedTitle","renderModalFooter","newReportValues","active","force_screenshot","creation_method","recipients","recipient_config_json","report_format","timezone","isSubmitting","editReport","addReport","getClientErrorObject","renderMessageContentSection","CSV","centered","LabeledErrorBoundInput","required","validationMethods","noBottomMargin","SectionHeaderStyle","clearButton","setValue","newValue","TimezoneHeaderStyle","TimezoneSelector","onTimezoneChange","antDErrorAlertStyles","extensionsRegistry","getExtensionsRegistry","deleteColor","onMenuHover","onMenuItemHover","StyledDropdownItemWithIcon","DropdownItemExtension","HeaderReportDropDown","isReportActive","canAddReports","perms","permission","currentReportDeleting","setCurrentReportDeleting","prevDashboard","usePrevious","toggleActiveKey","checked","toggleActive","shouldFetch","fetchUISpecificReport","filterField","resourceId","handleShowMenu","email","Checkbox","Switch","marginLeft","closest","DeleteModal","onConfirm","deleteActiveReport","handleReportDelete","StyledModal","StyledTopSection","StyledBottomSection","light2","StyledIconWrapper","StyledScheduleTitle","StyledCronPicker","StyledCronError","StyledFooterButton","StyledMessageContentTitle","StyledRadio","StyledRadioGroup","m","l","StyledSwitch","BaseSwitch","DEFAULT_TIMEZONE","MIN_SELECT_WIDTH","offsetsToName","currentDate","moment","JANUARY","JULY","getOffsetKey","tz","utcOffset","getTimezoneName","offsets","isDST","ALL_ZONES","country","flat","TIMEZONES","zone","TIMEZONE_OPTIONS","timezoneName","TIMEZONE_OPTIONS_SORT_COMPARATOR","validTimezone","matchTimezoneToOptions","ariaLabel","options","sortComparator","getRelevantDataMask","prop","prev","next","getAllActiveFilters","chartConfiguration","nativeFilters","allSliceIds","activeFilters","filterId","extraFormData","scope","chartsInScope","crossFilters","getEffectiveExtraFilters","op","cachedFiltersByChart","cachedFormdataByChart","getFormDataWithExtraFilters","colorScheme","colorNamespace","sliceId","extraControls","cachedFormData","areObjectsEqual","ignoreUndefined","color_namespace","label_colors","shared_label_colors","extraData","filterIdsAppliedOnChart","extra_form_data","getExtraFormData","form_data","extra_filters","TableControlsWrapper","onInputChange","columnNames","columnTypes","originalTimeColumns","getTimeColumns","formattedTimeColumns","colname","formattedData","applyFormattingToTabularData","onChangeHandler","filterText","setFilterText","useTableColumns","filteredData","useFilteredTableData","pageSize","noDataText","emptyWrapperType","EmptyWrapperType","isPaginationSticky","showRowCount","small","ResultTypes","cache","WeakMap","useResultsPane","isRequest","queryForce","metadata","resultResp","setResultResp","queryCount","queryObjectCount","setForceQuery","fill","err","idx","Wrapper","ResultsPaneOnDashboard","resultsPanes","panes","pane","Results","WeakSet","SamplesPane","setData","setColnames","setColtypes","TableView","SouthPane","DataTablesPane","onCollapseChange","activeTabKey","setActiveTabKey","setIsRequest","results","samples","panelOpen","setPanelOpen","getItem","LocalStorageKeys","setItem","startsWith","Samples","handleCollapseChange","isOpen","handleTabClick","tabKey","CollapseButton","caretIcon","queryResultsPanes","tabBarExtraContent","activeKey","onTabClick","ViewQueryModalContainer","setResult","setError","statusText","JSON","stringify","query","language","datasetProps","setStatus","changed_on_humanized","created_on_humanized","table_name","changed_by","created_by","notAvailable","first_name","last_name","formattedOwners","channel","BroadcastChannel","useTabId","tabId","setTabId","localStorage","sessionStorage","isStorageAvailable","shortid","updateTabId","lastTabId","newTabId","parseInt","storedTabId","postMessage","onmessage","messageEvent","cacheWrapper","SupersetClient","selector","isExactSelector","elementToPrint","querySelector","domToImage","quality","bgcolor","supersetTheme","node","dataUrl","createElement","download","date","kebabCase","toISOString","generateFileStem","console","addWarningToast","CREATE_CHART_TEXT","UPDATE_CHART_TEXT","isCreating","navigator","webdriver","filterClause","clause","CLAUSES","expressionType","sqlExpression","translateToSql","EXPRESSION_TYPES","operator","comparator","operatorId","OPERATOR_ENUM_TO_OPERATOR_TYPE","operatorEntry","operation","isExtra","filterOptionName","random","substring"],"sourceRoot":""}