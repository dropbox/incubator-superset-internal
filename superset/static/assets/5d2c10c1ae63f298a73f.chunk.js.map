{"version":3,"file":"5d2c10c1ae63f298a73f.chunk.js","mappings":"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","sources":["webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/utils/prop-utils.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/aggregation-layer.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/utils/color-utils.js","webpack://superset/./node_modules/@deck.gl/core/dist/esm/lib/composite-layer.js","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/components/Legend.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/CategoricalDeckGLContainer.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/factory.tsx","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/heatmap-layer-utils.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/triangle-layer.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/triangle-layer-vertex.glsl.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/triangle-layer-fragment.glsl.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/weights-vs.glsl.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/heatmap-layer.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/weights-fs.glsl.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/max-vs.glsl.js","webpack://superset/./node_modules/@deck.gl/aggregation-layers/dist/esm/heatmap-layer/max-fs.glsl.js","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx"],"sourcesContent":["export function filterProps(props, filterKeys) {\n  const filteredProps = {};\n\n  for (const key in props) {\n    if (!filterKeys.includes(key)) {\n      filteredProps[key] = props[key];\n    }\n  }\n\n  return filteredProps;\n}\n//# sourceMappingURL=prop-utils.js.map","import { CompositeLayer, AttributeManager, _compareProps as compareProps } from '@deck.gl/core';\nimport { cssToDeviceRatio } from '@luma.gl/core';\nimport { filterProps } from './utils/prop-utils';\nexport default class AggregationLayer extends CompositeLayer {\n  initializeState(dimensions) {\n    super.initializeState();\n    this.setState({\n      ignoreProps: filterProps(this.constructor._propTypes, dimensions.data.props),\n      dimensions\n    });\n  }\n\n  updateState(opts) {\n    super.updateState(opts);\n    const {\n      changeFlags\n    } = opts;\n\n    if (changeFlags.extensionsChanged) {\n      const shaders = this.getShaders({});\n\n      if (shaders && shaders.defines) {\n        shaders.defines.NON_INSTANCED_MODEL = 1;\n      }\n\n      this.updateShaders(shaders);\n    }\n\n    this._updateAttributes(opts.props);\n  }\n\n  updateAttributes(changedAttributes) {\n    this.setState({\n      changedAttributes\n    });\n  }\n\n  getAttributes() {\n    return this.getAttributeManager().getShaderAttributes();\n  }\n\n  getModuleSettings() {\n    const {\n      viewport,\n      mousePosition,\n      gl\n    } = this.context;\n    const moduleSettings = Object.assign(Object.create(this.props), {\n      viewport,\n      mousePosition,\n      pickingActive: 0,\n      devicePixelRatio: cssToDeviceRatio(gl)\n    });\n    return moduleSettings;\n  }\n\n  updateShaders(shaders) {}\n\n  isAggregationDirty(updateOpts, params = {}) {\n    const {\n      props,\n      oldProps,\n      changeFlags\n    } = updateOpts;\n    const {\n      compareAll = false,\n      dimension\n    } = params;\n    const {\n      ignoreProps\n    } = this.state;\n    const {\n      props: dataProps,\n      accessors = []\n    } = dimension;\n    const {\n      updateTriggersChanged\n    } = changeFlags;\n\n    if (changeFlags.dataChanged) {\n      return true;\n    }\n\n    if (updateTriggersChanged) {\n      if (updateTriggersChanged.all) {\n        return true;\n      }\n\n      for (const accessor of accessors) {\n        if (updateTriggersChanged[accessor]) {\n          return true;\n        }\n      }\n    }\n\n    if (compareAll) {\n      if (changeFlags.extensionsChanged) {\n        return true;\n      }\n\n      return compareProps({\n        oldProps,\n        newProps: props,\n        ignoreProps,\n        propTypes: this.constructor._propTypes\n      });\n    }\n\n    for (const name of dataProps) {\n      if (props[name] !== oldProps[name]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  isAttributeChanged(name) {\n    const {\n      changedAttributes\n    } = this.state;\n\n    if (!name) {\n      return !isObjectEmpty(changedAttributes);\n    }\n\n    return changedAttributes && changedAttributes[name] !== undefined;\n  }\n\n  _getAttributeManager() {\n    return new AttributeManager(this.context.gl, {\n      id: this.props.id,\n      stats: this.context.stats\n    });\n  }\n\n}\n\nfunction isObjectEmpty(obj) {\n  let isEmpty = true;\n\n  for (const key in obj) {\n    isEmpty = false;\n    break;\n  }\n\n  return isEmpty;\n}\n\nAggregationLayer.layerName = 'AggregationLayer';\n//# sourceMappingURL=aggregation-layer.js.map","export const defaultColorRange = [[255, 255, 178], [254, 217, 118], [254, 178, 76], [253, 141, 60], [240, 59, 32], [189, 0, 38]];\nexport function colorRangeToFlatArray(colorRange, normalize = false, ArrayType = Float32Array) {\n  let flatArray;\n\n  if (Number.isFinite(colorRange[0])) {\n    flatArray = new ArrayType(colorRange);\n  } else {\n    flatArray = new ArrayType(colorRange.length * 4);\n    let index = 0;\n\n    for (let i = 0; i < colorRange.length; i++) {\n      const color = colorRange[i];\n      flatArray[index++] = color[0];\n      flatArray[index++] = color[1];\n      flatArray[index++] = color[2];\n      flatArray[index++] = Number.isFinite(color[3]) ? color[3] : 255;\n    }\n  }\n\n  if (normalize) {\n    for (let i = 0; i < flatArray.length; i++) {\n      flatArray[i] /= 255;\n    }\n  }\n\n  return flatArray;\n}\n//# sourceMappingURL=color-utils.js.map","import Layer from './layer';\nimport debug from '../debug';\nimport { flatten } from '../utils/flatten';\nconst TRACE_RENDER_LAYERS = 'compositeLayer.renderLayers';\nexport default class CompositeLayer extends Layer {\n  get isComposite() {\n    return true;\n  }\n\n  get isLoaded() {\n    return super.isLoaded && this.getSubLayers().every(layer => layer.isLoaded);\n  }\n\n  getSubLayers() {\n    return this.internalState && this.internalState.subLayers || [];\n  }\n\n  initializeState() {}\n\n  setState(updateObject) {\n    super.setState(updateObject);\n    this.setNeedsUpdate();\n  }\n\n  getPickingInfo({\n    info\n  }) {\n    const {\n      object\n    } = info;\n    const isDataWrapped = object && object.__source && object.__source.parent && object.__source.parent.id === this.id;\n\n    if (!isDataWrapped) {\n      return info;\n    }\n\n    info.object = object.__source.object;\n    info.index = object.__source.index;\n    return info;\n  }\n\n  renderLayers() {\n    return null;\n  }\n\n  filterSubLayer(context) {\n    return true;\n  }\n\n  shouldRenderSubLayer(id, data) {\n    const {\n      _subLayerProps: overridingProps\n    } = this.props;\n    return data && data.length || overridingProps && overridingProps[id];\n  }\n\n  getSubLayerClass(id, DefaultLayerClass) {\n    const {\n      _subLayerProps: overridingProps\n    } = this.props;\n    return overridingProps && overridingProps[id] && overridingProps[id].type || DefaultLayerClass;\n  }\n\n  getSubLayerRow(row, sourceObject, sourceObjectIndex) {\n    row.__source = {\n      parent: this,\n      object: sourceObject,\n      index: sourceObjectIndex\n    };\n    return row;\n  }\n\n  getSubLayerAccessor(accessor) {\n    if (typeof accessor === 'function') {\n      const objectInfo = {\n        data: this.props.data,\n        target: []\n      };\n      return (x, i) => {\n        if (x && x.__source) {\n          objectInfo.index = x.__source.index;\n          return accessor(x.__source.object, objectInfo);\n        }\n\n        return accessor(x, i);\n      };\n    }\n\n    return accessor;\n  }\n\n  getSubLayerProps(sublayerProps = {}) {\n    const {\n      opacity,\n      pickable,\n      visible,\n      parameters,\n      getPolygonOffset,\n      highlightedObjectIndex,\n      autoHighlight,\n      highlightColor,\n      coordinateSystem,\n      coordinateOrigin,\n      wrapLongitude,\n      positionFormat,\n      modelMatrix,\n      extensions,\n      fetch,\n      _subLayerProps: overridingProps\n    } = this.props;\n    const newProps = {\n      opacity,\n      pickable,\n      visible,\n      parameters,\n      getPolygonOffset,\n      highlightedObjectIndex,\n      autoHighlight,\n      highlightColor,\n      coordinateSystem,\n      coordinateOrigin,\n      wrapLongitude,\n      positionFormat,\n      modelMatrix,\n      extensions,\n      fetch\n    };\n    const overridingSublayerProps = overridingProps && overridingProps[sublayerProps.id];\n    const overridingSublayerTriggers = overridingSublayerProps && overridingSublayerProps.updateTriggers;\n    const sublayerId = sublayerProps.id || 'sublayer';\n\n    if (overridingSublayerProps) {\n      const propTypes = this.constructor._propTypes;\n      const subLayerPropTypes = sublayerProps.type ? sublayerProps.type._propTypes : {};\n\n      for (const key in overridingSublayerProps) {\n        const propType = subLayerPropTypes[key] || propTypes[key];\n\n        if (propType && propType.type === 'accessor') {\n          overridingSublayerProps[key] = this.getSubLayerAccessor(overridingSublayerProps[key]);\n        }\n      }\n    }\n\n    Object.assign(newProps, sublayerProps, overridingSublayerProps);\n    newProps.id = \"\".concat(this.props.id, \"-\").concat(sublayerId);\n    newProps.updateTriggers = {\n      all: this.props.updateTriggers.all,\n      ...sublayerProps.updateTriggers,\n      ...overridingSublayerTriggers\n    };\n\n    for (const extension of extensions) {\n      const passThroughProps = extension.getSubLayerProps.call(this, extension);\n\n      if (passThroughProps) {\n        Object.assign(newProps, passThroughProps, {\n          updateTriggers: Object.assign(newProps.updateTriggers, passThroughProps.updateTriggers)\n        });\n      }\n    }\n\n    return newProps;\n  }\n\n  _updateAutoHighlight(info) {\n    for (const layer of this.getSubLayers()) {\n      layer.updateAutoHighlight(info);\n    }\n  }\n\n  _getAttributeManager() {\n    return null;\n  }\n\n  _renderLayers() {\n    let {\n      subLayers\n    } = this.internalState;\n    const shouldUpdate = !subLayers || this.needsUpdate();\n\n    if (shouldUpdate) {\n      subLayers = this.renderLayers();\n      subLayers = flatten(subLayers, Boolean);\n      this.internalState.subLayers = subLayers;\n    }\n\n    debug(TRACE_RENDER_LAYERS, this, shouldUpdate, subLayers);\n\n    for (const layer of subLayers) {\n      layer.parent = this;\n    }\n  }\n\n}\nCompositeLayer.layerName = 'CompositeLayer';\n//# sourceMappingURL=composite-layer.js.map","/* eslint-disable react/jsx-sort-default-props */\n/* eslint-disable react/sort-prop-types */\n/* eslint-disable jsx-a11y/anchor-is-valid */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { formatNumber, styled } from '@superset-ui/core';\n\nconst StyledLegend = styled.div`\n  ${({ theme }) => `\n    font-size: ${theme.typography.sizes.s}px;\n    position: absolute;\n    background: ${theme.colors.grayscale.light5};\n    box-shadow: 0 0 ${theme.gridUnit}px ${theme.colors.grayscale.light2};\n    margin: ${theme.gridUnit * 6}px;\n    padding: ${theme.gridUnit * 3}px ${theme.gridUnit * 5}px;\n    outline: none;\n    overflow-y: scroll;\n    max-height: 200px;\n\n    & ul {\n      list-style: none;\n      padding-left: 0;\n      margin: 0;\n\n      & li a {\n        color: ${theme.colors.grayscale.base};\n        text-decoration: none;\n\n        & span {\n          margin-right: ${theme.gridUnit * 3}px;\n        }\n      }\n    }\n  `}\n`;\n\nconst categoryDelimiter = ' - ';\n\nconst propTypes = {\n  categories: PropTypes.object,\n  forceCategorical: PropTypes.bool,\n  format: PropTypes.string,\n  position: PropTypes.oneOf([null, 'tl', 'tr', 'bl', 'br']),\n  showSingleCategory: PropTypes.func,\n  toggleCategory: PropTypes.func,\n};\n\nconst defaultProps = {\n  categories: {},\n  forceCategorical: false,\n  format: null,\n  position: 'tr',\n  showSingleCategory: () => {},\n  toggleCategory: () => {},\n};\n\nexport default class Legend extends React.PureComponent {\n  format(value) {\n    if (!this.props.format || this.props.forceCategorical) {\n      return value;\n    }\n\n    const numValue = parseFloat(value);\n\n    return formatNumber(this.props.format, numValue);\n  }\n\n  formatCategoryLabel(k) {\n    if (!this.props.format) {\n      return k;\n    }\n\n    if (k.includes(categoryDelimiter)) {\n      const values = k.split(categoryDelimiter);\n\n      return (\n        this.format(values[0]) + categoryDelimiter + this.format(values[1])\n      );\n    }\n\n    return this.format(k);\n  }\n\n  render() {\n    if (\n      Object.keys(this.props.categories).length === 0 ||\n      this.props.position === null\n    ) {\n      return null;\n    }\n\n    const categories = Object.entries(this.props.categories).map(([k, v]) => {\n      const style = { color: `rgba(${v.color.join(', ')})` };\n      const icon = v.enabled ? '\\u25FC' : '\\u25FB';\n\n      return (\n        <li key={k}>\n          <a\n            href=\"#\"\n            onClick={() => this.props.toggleCategory(k)}\n            onDoubleClick={() => this.props.showSingleCategory(k)}\n          >\n            <span style={style}>{icon}</span> {this.formatCategoryLabel(k)}\n          </a>\n        </li>\n      );\n    });\n\n    const vertical = this.props.position.charAt(0) === 't' ? 'top' : 'bottom';\n    const horizontal = this.props.position.charAt(1) === 'r' ? 'right' : 'left';\n    const style = {\n      position: 'absolute',\n      [vertical]: '0px',\n      [horizontal]: '10px',\n    };\n\n    return (\n      <StyledLegend style={style}>\n        <ul>{categories}</ul>\n      </StyledLegend>\n    );\n  }\n}\n\nLegend.propTypes = propTypes;\nLegend.defaultProps = defaultProps;\n","/* eslint-disable react/sort-prop-types */\n/* eslint-disable react/require-default-props */\n/* eslint-disable react/no-unused-prop-types */\n/* eslint-disable react/no-access-state-in-setstate */\n/* eslint-disable camelcase */\n/* eslint-disable no-prototype-builtins */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"\", \"__timestamp\"] }] */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { CategoricalColorNamespace } from '@superset-ui/core';\nimport AnimatableDeckGLContainer from './AnimatableDeckGLContainer';\nimport Legend from './components/Legend';\nimport { hexToRGB } from './utils/colors';\nimport { getPlaySliderParams } from './utils/time';\nimport sandboxedEval from './utils/sandbox';\n// eslint-disable-next-line import/extensions\nimport fitViewport from './utils/fitViewport';\n\nconst { getScale } = CategoricalColorNamespace;\n\nfunction getCategories(fd, data) {\n  const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n  const fixedColor = [c.r, c.g, c.b, 255 * c.a];\n  const colorFn = getScale(fd.color_scheme);\n  const categories = {};\n  data.forEach(d => {\n    if (d.cat_color != null && !categories.hasOwnProperty(d.cat_color)) {\n      let color;\n      if (fd.dimension) {\n        color = hexToRGB(colorFn(d.cat_color, fd.sliceId), c.a * 255);\n      } else {\n        color = fixedColor;\n      }\n      categories[d.cat_color] = { color, enabled: true };\n    }\n  });\n\n  return categories;\n}\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  formData: PropTypes.object.isRequired,\n  getLayer: PropTypes.func.isRequired,\n  getPoints: PropTypes.func.isRequired,\n  height: PropTypes.number.isRequired,\n  mapboxApiKey: PropTypes.string.isRequired,\n  onAddFilter: PropTypes.func,\n  payload: PropTypes.object.isRequired,\n  setControlValue: PropTypes.func.isRequired,\n  viewport: PropTypes.object.isRequired,\n  width: PropTypes.number.isRequired,\n};\n\nexport default class CategoricalDeckGLContainer extends React.PureComponent {\n  containerRef = React.createRef();\n\n  /*\n   * A Deck.gl container that handles categories.\n   *\n   * The container will have an interactive legend, populated from the\n   * categories present in the data.\n   */\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProps(props);\n\n    this.getLayers = this.getLayers.bind(this);\n    this.onValuesChange = this.onValuesChange.bind(this);\n    this.toggleCategory = this.toggleCategory.bind(this);\n    this.showSingleCategory = this.showSingleCategory.bind(this);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.payload.form_data !== this.state.formData) {\n      this.setState({ ...this.getStateFromProps(nextProps) });\n    }\n  }\n\n  onValuesChange(values) {\n    this.setState({\n      values: Array.isArray(values)\n        ? values\n        : [values, values + this.state.getStep(values)],\n    });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  getStateFromProps(props, state) {\n    const features = props.payload.data.features || [];\n    const timestamps = features.map(f => f.__timestamp);\n    const categories = getCategories(props.formData, features);\n\n    // the state is computed only from the payload; if it hasn't changed, do\n    // not recompute state since this would reset selections and/or the play\n    // slider position due to changes in form controls\n    if (state && props.payload.form_data === state.formData) {\n      return { ...state, categories };\n    }\n\n    // the granularity has to be read from the payload form_data, not the\n    // props formData which comes from the instantaneous controls state\n    const granularity =\n      props.payload.form_data.time_grain_sqla ||\n      props.payload.form_data.granularity ||\n      'P1D';\n\n    const { start, end, getStep, values, disabled } = getPlaySliderParams(\n      timestamps,\n      granularity,\n    );\n\n    const { width, height, formData } = props;\n    let { viewport } = props;\n    if (formData.autozoom) {\n      viewport = fitViewport(viewport, {\n        width,\n        height,\n        points: props.getPoints(features),\n      });\n    }\n    if (viewport.zoom < 0) {\n      viewport.zoom = 0;\n    }\n\n    return {\n      start,\n      end,\n      getStep,\n      values,\n      disabled,\n      viewport,\n      selected: [],\n      lastClick: 0,\n      formData: props.payload.form_data,\n      categories,\n    };\n  }\n\n  getLayers(values) {\n    const { getLayer, payload, formData: fd, onAddFilter } = this.props;\n    let features = payload.data.features ? [...payload.data.features] : [];\n\n    // Add colors from categories or fixed color\n    features = this.addColor(features, fd);\n\n    // Apply user defined data mutator if defined\n    if (fd.js_data_mutator) {\n      const jsFnMutator = sandboxedEval(fd.js_data_mutator);\n      features = jsFnMutator(features);\n    }\n\n    // Filter by time\n    if (values[0] === values[1] || values[1] === this.end) {\n      features = features.filter(\n        d => d.__timestamp >= values[0] && d.__timestamp <= values[1],\n      );\n    } else {\n      features = features.filter(\n        d => d.__timestamp >= values[0] && d.__timestamp < values[1],\n      );\n    }\n\n    // Show only categories selected in the legend\n    const cats = this.state.categories;\n    if (fd.dimension) {\n      features = features.filter(\n        d => cats[d.cat_color] && cats[d.cat_color].enabled,\n      );\n    }\n\n    const filteredPayload = {\n      ...payload,\n      data: { ...payload.data, features },\n    };\n\n    return [\n      getLayer(\n        fd,\n        filteredPayload,\n        onAddFilter,\n        this.setTooltip,\n        this.props.datasource,\n      ),\n    ];\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  addColor(data, fd) {\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const colorFn = getScale(fd.color_scheme);\n\n    return data.map(d => {\n      let color;\n      if (fd.dimension) {\n        color = hexToRGB(colorFn(d.cat_color, fd.sliceId), c.a * 255);\n\n        return { ...d, color };\n      }\n\n      return d;\n    });\n  }\n\n  toggleCategory(category) {\n    const categoryState = this.state.categories[category];\n    const categories = {\n      ...this.state.categories,\n      [category]: {\n        ...categoryState,\n        enabled: !categoryState.enabled,\n      },\n    };\n\n    // if all categories are disabled, enable all -- similar to nvd3\n    if (Object.values(categories).every(v => !v.enabled)) {\n      /* eslint-disable no-param-reassign */\n      Object.values(categories).forEach(v => {\n        v.enabled = true;\n      });\n    }\n    this.setState({ categories });\n  }\n\n  showSingleCategory(category) {\n    const categories = { ...this.state.categories };\n    /* eslint-disable no-param-reassign */\n    Object.values(categories).forEach(v => {\n      v.enabled = false;\n    });\n    categories[category].enabled = true;\n    this.setState({ categories });\n  }\n\n  setTooltip = tooltip => {\n    const { current } = this.containerRef;\n    if (current) {\n      current.setTooltip(tooltip);\n    }\n  };\n\n  render() {\n    return (\n      <div style={{ position: 'relative' }}>\n        <AnimatableDeckGLContainer\n          ref={this.containerRef}\n          getLayers={this.getLayers}\n          start={this.state.start}\n          end={this.state.end}\n          getStep={this.state.getStep}\n          values={this.state.values}\n          disabled={this.state.disabled}\n          viewport={this.state.viewport}\n          mapboxApiAccessToken={this.props.mapboxApiKey}\n          mapStyle={this.props.formData.mapbox_style}\n          setControlValue={this.props.setControlValue}\n          width={this.props.width}\n          height={this.props.height}\n        >\n          <Legend\n            forceCategorical\n            categories={this.state.categories}\n            format={this.props.formData.legend_format}\n            position={this.props.formData.legend_position}\n            showSingleCategory={this.showSingleCategory}\n            toggleCategory={this.toggleCategory}\n          />\n        </AnimatableDeckGLContainer>\n      </div>\n    );\n  }\n}\n\nCategoricalDeckGLContainer.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { isEqual } from 'lodash';\nimport { Datasource, QueryFormData, JsonObject } from '@superset-ui/core';\n\nimport {\n  DeckGLContainerStyledWrapper,\n  DeckGLContainer,\n} from './DeckGLContainer';\nimport CategoricalDeckGLContainer from './CategoricalDeckGLContainer';\nimport fitViewport, { Viewport } from './utils/fitViewport';\nimport { Point } from './types';\n\ntype deckGLComponentProps = {\n  datasource: Datasource;\n  formData: QueryFormData;\n  height: number;\n  onAddFilter: () => void;\n  payload: JsonObject;\n  setControlValue: () => void;\n  viewport: Viewport;\n  width: number;\n};\nexport interface getLayerType<T> {\n  (\n    formData: QueryFormData,\n    payload: JsonObject,\n    onAddFilter: () => void,\n    setTooltip: (tooltip: string) => void,\n  ): T;\n}\ninterface getPointsType<T> {\n  (point: number[]): T;\n}\ntype deckGLComponentState = {\n  viewport: Viewport;\n  layer: unknown;\n};\n\nexport function createDeckGLComponent(\n  getLayer: getLayerType<unknown>,\n  getPoints: getPointsType<Point[]>,\n): React.ComponentClass<deckGLComponentProps> {\n  // Higher order component\n  class Component extends React.PureComponent<\n    deckGLComponentProps,\n    deckGLComponentState\n  > {\n    containerRef: React.RefObject<DeckGLContainer> = React.createRef();\n\n    constructor(props: deckGLComponentProps) {\n      super(props);\n\n      const { width, height, formData } = props;\n      let { viewport } = props;\n      if (formData.autozoom) {\n        viewport = fitViewport(viewport, {\n          width,\n          height,\n          points: getPoints(props.payload.data.features),\n        }) as Viewport;\n      }\n\n      this.state = {\n        viewport,\n        layer: this.computeLayer(props),\n      };\n      this.onViewportChange = this.onViewportChange.bind(this);\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps: deckGLComponentProps) {\n      // Only recompute the layer if anything BUT the viewport has changed\n      const nextFdNoVP = { ...nextProps.formData, viewport: null };\n      const currFdNoVP = { ...this.props.formData, viewport: null };\n      if (\n        !isEqual(nextFdNoVP, currFdNoVP) ||\n        nextProps.payload !== this.props.payload\n      ) {\n        this.setState({ layer: this.computeLayer(nextProps) });\n      }\n    }\n\n    onViewportChange(viewport: Viewport) {\n      this.setState({ viewport });\n    }\n\n    computeLayer(props: deckGLComponentProps) {\n      const { formData, payload, onAddFilter } = props;\n\n      return getLayer(formData, payload, onAddFilter, this.setTooltip);\n    }\n\n    setTooltip = (tooltip: string) => {\n      const { current } = this.containerRef;\n      if (current) {\n        current?.setTooltip(tooltip);\n      }\n    };\n\n    render() {\n      const { formData, payload, setControlValue, height, width } = this.props;\n      const { layer, viewport } = this.state;\n\n      return (\n        <DeckGLContainerStyledWrapper\n          ref={this.containerRef}\n          mapboxApiAccessToken={payload.data.mapboxApiKey}\n          viewport={viewport}\n          layers={[layer]}\n          mapStyle={formData.mapbox_style}\n          setControlValue={setControlValue}\n          width={width}\n          height={height}\n          onViewportChange={this.onViewportChange}\n        />\n      );\n    }\n  }\n  return Component;\n}\n\nexport function createCategoricalDeckGLComponent(\n  getLayer: getLayerType<unknown>,\n  getPoints: getPointsType<Point[]>,\n) {\n  return function Component(props: deckGLComponentProps) {\n    const {\n      datasource,\n      formData,\n      height,\n      payload,\n      setControlValue,\n      viewport,\n      width,\n    } = props;\n\n    return (\n      <CategoricalDeckGLContainer\n        datasource={datasource}\n        formData={formData}\n        mapboxApiKey={payload.data.mapboxApiKey}\n        setControlValue={setControlValue}\n        viewport={viewport}\n        getLayer={getLayer}\n        payload={payload}\n        getPoints={getPoints}\n        width={width}\n        height={height}\n      />\n    );\n  };\n}\n","import { isWebGL2 } from '@luma.gl/core';\nexport function getBounds(points) {\n  const x = points.map(p => p[0]);\n  const y = points.map(p => p[1]);\n  const xMin = Math.min.apply(null, x);\n  const xMax = Math.max.apply(null, x);\n  const yMin = Math.min.apply(null, y);\n  const yMax = Math.max.apply(null, y);\n  return [xMin, yMin, xMax, yMax];\n}\nexport function boundsContain(currentBounds, targetBounds) {\n  if (targetBounds[0] >= currentBounds[0] && targetBounds[2] <= currentBounds[2] && targetBounds[1] >= currentBounds[1] && targetBounds[3] <= currentBounds[3]) {\n    return true;\n  }\n\n  return false;\n}\nconst scratchArray = new Float32Array(12);\nexport function packVertices(points, dimensions = 2) {\n  let index = 0;\n\n  for (const point of points) {\n    for (let i = 0; i < dimensions; i++) {\n      scratchArray[index++] = point[i] || 0;\n    }\n  }\n\n  return scratchArray;\n}\nexport function scaleToAspectRatio(boundingBox, width, height) {\n  const [xMin, yMin, xMax, yMax] = boundingBox;\n  const currentWidth = xMax - xMin;\n  const currentHeight = yMax - yMin;\n  let newWidth = currentWidth;\n  let newHeight = currentHeight;\n\n  if (currentWidth / currentHeight < width / height) {\n    newWidth = width / height * currentHeight;\n  } else {\n    newHeight = height / width * currentWidth;\n  }\n\n  if (newWidth < width) {\n    newWidth = width;\n    newHeight = height;\n  }\n\n  const xCenter = (xMax + xMin) / 2;\n  const yCenter = (yMax + yMin) / 2;\n  return [xCenter - newWidth / 2, yCenter - newHeight / 2, xCenter + newWidth / 2, yCenter + newHeight / 2];\n}\nexport function getTextureCoordinates(point, bounds) {\n  const [xMin, yMin, xMax, yMax] = bounds;\n  return [(point[0] - xMin) / (xMax - xMin), (point[1] - yMin) / (yMax - yMin)];\n}\nexport function getTextureParams({\n  gl,\n  floatTargetSupport\n}) {\n  return {\n    format: isWebGL2(gl) ? 34836 : 6408,\n    type: floatTargetSupport ? 5126 : 5121\n  };\n}\n//# sourceMappingURL=heatmap-layer-utils.js.map","import { Model, Geometry } from '@luma.gl/core';\nimport { Layer, project32 } from '@deck.gl/core';\nimport vs from './triangle-layer-vertex.glsl';\nimport fs from './triangle-layer-fragment.glsl';\nexport default class TriangleLayer extends Layer {\n  getShaders() {\n    return {\n      vs,\n      fs,\n      modules: [project32]\n    };\n  }\n\n  initializeState() {\n    const {\n      gl\n    } = this.context;\n    const attributeManager = this.getAttributeManager();\n    attributeManager.add({\n      positions: {\n        size: 3,\n        noAlloc: true\n      },\n      texCoords: {\n        size: 2,\n        noAlloc: true\n      }\n    });\n    this.setState({\n      model: this._getModel(gl)\n    });\n  }\n\n  _getModel(gl) {\n    const {\n      vertexCount\n    } = this.props;\n    return new Model(gl, { ...this.getShaders(),\n      id: this.props.id,\n      geometry: new Geometry({\n        drawMode: 6,\n        vertexCount\n      })\n    });\n  }\n\n  draw({\n    uniforms\n  }) {\n    const {\n      model\n    } = this.state;\n    const {\n      texture,\n      maxTexture,\n      colorTexture,\n      intensity,\n      threshold,\n      aggregationMode,\n      colorDomain\n    } = this.props;\n    model.setUniforms({ ...uniforms,\n      texture,\n      maxTexture,\n      colorTexture,\n      intensity,\n      threshold,\n      aggregationMode,\n      colorDomain\n    }).draw();\n  }\n\n}\nTriangleLayer.layerName = 'TriangleLayer';\n//# sourceMappingURL=triangle-layer.js.map","export default \"#define SHADER_NAME heatp-map-layer-vertex-shader\\n\\nuniform sampler2D maxTexture;\\nuniform float intensity;\\nuniform vec2 colorDomain;\\nuniform float threshold;\\nuniform float aggregationMode;\\n\\nattribute vec3 positions;\\nattribute vec2 texCoords;\\n\\nvarying vec2 vTexCoords;\\nvarying float vIntensityMin;\\nvarying float vIntensityMax;\\n\\nvoid main(void) {\\n  gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));\\n  vTexCoords = texCoords;\\n  vec4 maxTexture = texture2D(maxTexture, vec2(0.5));\\n  float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;\\n  float minValue = maxValue * threshold;\\n  if (colorDomain[1] > 0.) {\\n    maxValue = colorDomain[1];\\n    minValue = colorDomain[0];\\n  }\\n  vIntensityMax = intensity / maxValue;\\n  vIntensityMin = intensity / minValue;\\n}\\n\";\n//# sourceMappingURL=triangle-layer-vertex.glsl.js.map","export default \"#define SHADER_NAME triangle-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform float opacity;\\nuniform sampler2D texture;\\nuniform sampler2D colorTexture;\\nuniform float aggregationMode;\\n\\nvarying vec2 vTexCoords;\\nvarying float vIntensityMin;\\nvarying float vIntensityMax;\\n\\nvec4 getLinearColor(float value) {\\n  float factor = clamp(value * vIntensityMax, 0., 1.);\\n  vec4 color = texture2D(colorTexture, vec2(factor, 0.5));\\n  color.a *= min(value * vIntensityMin, 1.0);\\n  return color;\\n}\\n\\nvoid main(void) {\\n  vec4 weights = texture2D(texture, vTexCoords);\\n  float weight = weights.r;\\n\\n  if (aggregationMode > 0.5) {\\n    weight /= max(1.0, weights.a);\\n  }\\n  if (weight <= 0.) {\\n     discard;\\n  }\\n\\n  vec4 linearColor = getLinearColor(weight);\\n  linearColor.a *= opacity;\\n  gl_FragColor =linearColor;\\n}\\n\";\n//# sourceMappingURL=triangle-layer-fragment.glsl.js.map","export default \"attribute vec3 positions;\\nattribute vec3 positions64Low;\\nattribute float weights;\\nvarying vec4 weightsTexture;\\nuniform float radiusPixels;\\nuniform float textureWidth;\\nuniform vec4 commonBounds;\\nuniform float weightsScale;\\nvoid main()\\n{\\n  weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);\\n\\n  float radiusTexels  = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);\\n  gl_PointSize = radiusTexels * 2.;\\n\\n  vec3 commonPosition = project_position(positions, positions64Low);\\n  gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;\\n  gl_Position.xy = (gl_Position.xy * 2.) - (1.);\\n}\\n\";\n//# sourceMappingURL=weights-vs.glsl.js.map","import { getBounds, boundsContain, packVertices, scaleToAspectRatio, getTextureCoordinates, getTextureParams } from './heatmap-layer-utils';\nimport { Buffer, Texture2D, Transform, getParameters, FEATURES, hasFeatures } from '@luma.gl/core';\nimport { AttributeManager, COORDINATE_SYSTEM, log, _mergeShaders as mergeShaders } from '@deck.gl/core';\nimport TriangleLayer from './triangle-layer';\nimport AggregationLayer from '../aggregation-layer';\nimport { defaultColorRange, colorRangeToFlatArray } from '../utils/color-utils';\nimport weights_vs from './weights-vs.glsl';\nimport weights_fs from './weights-fs.glsl';\nimport vs_max from './max-vs.glsl';\nimport fs_max from './max-fs.glsl';\nconst RESOLUTION = 2;\nconst SIZE_2K = 2048;\nconst ZOOM_DEBOUNCE = 500;\nconst TEXTURE_OPTIONS = {\n  mipmaps: false,\n  parameters: {\n    [10240]: 9729,\n    [10241]: 9729,\n    [10242]: 33071,\n    [10243]: 33071\n  },\n  dataFormat: 6408\n};\nconst DEFAULT_COLOR_DOMAIN = [0, 0];\nconst AGGREGATION_MODE = {\n  SUM: 0,\n  MEAN: 1\n};\nconst defaultProps = {\n  getPosition: {\n    type: 'accessor',\n    value: x => x.position\n  },\n  getWeight: {\n    type: 'accessor',\n    value: 1\n  },\n  intensity: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  radiusPixels: {\n    type: 'number',\n    min: 1,\n    max: 100,\n    value: 50\n  },\n  colorRange: defaultColorRange,\n  threshold: {\n    type: 'number',\n    min: 0,\n    max: 1,\n    value: 0.05\n  },\n  colorDomain: {\n    type: 'array',\n    value: null,\n    optional: true\n  },\n  aggregation: 'SUM'\n};\nconst REQUIRED_FEATURES = [FEATURES.BLEND_EQUATION_MINMAX, FEATURES.TEXTURE_FLOAT];\nconst DIMENSIONS = {\n  data: {\n    props: ['radiusPixels']\n  }\n};\nexport default class HeatmapLayer extends AggregationLayer {\n  initializeState() {\n    const {\n      gl\n    } = this.context;\n\n    if (!hasFeatures(gl, REQUIRED_FEATURES)) {\n      this.setState({\n        supported: false\n      });\n      log.error(\"HeatmapLayer: \".concat(this.id, \" is not supported on this browser\"))();\n      return;\n    }\n\n    super.initializeState(DIMENSIONS);\n    this.setState({\n      supported: true,\n      colorDomain: DEFAULT_COLOR_DOMAIN\n    });\n\n    this._setupTextureParams();\n\n    this._setupAttributes();\n\n    this._setupResources();\n  }\n\n  shouldUpdateState({\n    changeFlags\n  }) {\n    return changeFlags.somethingChanged;\n  }\n\n  updateState(opts) {\n    if (!this.state.supported) {\n      return;\n    }\n\n    super.updateState(opts);\n    const {\n      props,\n      oldProps\n    } = opts;\n\n    const changeFlags = this._getChangeFlags(opts);\n\n    if (changeFlags.viewportChanged) {\n      changeFlags.boundsChanged = this._updateBounds();\n\n      this._updateTextureRenderingBounds();\n    }\n\n    if (changeFlags.dataChanged || changeFlags.boundsChanged) {\n      clearTimeout(this.state.updateTimer);\n      this.setState({\n        isWeightMapDirty: true\n      });\n    } else if (changeFlags.viewportZoomChanged) {\n      this._debouncedUpdateWeightmap();\n    }\n\n    if (props.colorRange !== oldProps.colorRange) {\n      this._updateColorTexture(opts);\n    }\n\n    if (this.state.isWeightMapDirty) {\n      this._updateWeightmap();\n    }\n\n    this.setState({\n      zoom: opts.context.viewport.zoom\n    });\n  }\n\n  renderLayers() {\n    if (!this.state.supported) {\n      return [];\n    }\n\n    const {\n      weightsTexture,\n      triPositionBuffer,\n      triTexCoordBuffer,\n      maxWeightsTexture,\n      colorTexture,\n      colorDomain\n    } = this.state;\n    const {\n      updateTriggers,\n      intensity,\n      threshold,\n      aggregation\n    } = this.props;\n    const TriangleLayerClass = this.getSubLayerClass('triangle', TriangleLayer);\n    return new TriangleLayerClass(this.getSubLayerProps({\n      id: 'triangle-layer',\n      updateTriggers\n    }), {\n      coordinateSystem: COORDINATE_SYSTEM.DEFAULT,\n      data: {\n        attributes: {\n          positions: triPositionBuffer,\n          texCoords: triTexCoordBuffer\n        }\n      },\n      vertexCount: 4,\n      maxTexture: maxWeightsTexture,\n      colorTexture,\n      aggregationMode: AGGREGATION_MODE[aggregation] || 0,\n      texture: weightsTexture,\n      intensity,\n      threshold,\n      colorDomain\n    });\n  }\n\n  finalizeState() {\n    super.finalizeState();\n    const {\n      weightsTransform,\n      weightsTexture,\n      maxWeightTransform,\n      maxWeightsTexture,\n      triPositionBuffer,\n      triTexCoordBuffer,\n      colorTexture,\n      updateTimer\n    } = this.state;\n    weightsTransform === null || weightsTransform === void 0 ? void 0 : weightsTransform.delete();\n    weightsTexture === null || weightsTexture === void 0 ? void 0 : weightsTexture.delete();\n    maxWeightTransform === null || maxWeightTransform === void 0 ? void 0 : maxWeightTransform.delete();\n    maxWeightsTexture === null || maxWeightsTexture === void 0 ? void 0 : maxWeightsTexture.delete();\n    triPositionBuffer === null || triPositionBuffer === void 0 ? void 0 : triPositionBuffer.delete();\n    triTexCoordBuffer === null || triTexCoordBuffer === void 0 ? void 0 : triTexCoordBuffer.delete();\n    colorTexture === null || colorTexture === void 0 ? void 0 : colorTexture.delete();\n    updateTimer && clearTimeout(updateTimer);\n  }\n\n  _getAttributeManager() {\n    return new AttributeManager(this.context.gl, {\n      id: this.props.id,\n      stats: this.context.stats\n    });\n  }\n\n  _getChangeFlags(opts) {\n    const changeFlags = {};\n    const {\n      dimensions\n    } = this.state;\n    changeFlags.dataChanged = this.isAttributeChanged() || this.isAggregationDirty(opts, {\n      compareAll: true,\n      dimension: dimensions.data\n    });\n    changeFlags.viewportChanged = opts.changeFlags.viewportChanged;\n    const {\n      zoom\n    } = this.state;\n\n    if (!opts.context.viewport || opts.context.viewport.zoom !== zoom) {\n      changeFlags.viewportZoomChanged = true;\n    }\n\n    return changeFlags;\n  }\n\n  _createTextures() {\n    const {\n      gl\n    } = this.context;\n    const {\n      textureSize,\n      format,\n      type\n    } = this.state;\n    this.setState({\n      weightsTexture: new Texture2D(gl, {\n        width: textureSize,\n        height: textureSize,\n        format,\n        type,\n        ...TEXTURE_OPTIONS\n      }),\n      maxWeightsTexture: new Texture2D(gl, {\n        format,\n        type,\n        ...TEXTURE_OPTIONS\n      })\n    });\n  }\n\n  _setupAttributes() {\n    const attributeManager = this.getAttributeManager();\n    attributeManager.add({\n      positions: {\n        size: 3,\n        type: 5130,\n        accessor: 'getPosition'\n      },\n      weights: {\n        size: 1,\n        accessor: 'getWeight'\n      }\n    });\n    this.setState({\n      positionAttributeName: 'positions'\n    });\n  }\n\n  _setupTextureParams() {\n    const {\n      gl\n    } = this.context;\n    const textureSize = Math.min(SIZE_2K, getParameters(gl, 3379));\n    const floatTargetSupport = hasFeatures(gl, FEATURES.COLOR_ATTACHMENT_RGBA32F);\n    const {\n      format,\n      type\n    } = getTextureParams({\n      gl,\n      floatTargetSupport\n    });\n    const weightsScale = floatTargetSupport ? 1 : 1 / 255;\n    this.setState({\n      textureSize,\n      format,\n      type,\n      weightsScale\n    });\n\n    if (!floatTargetSupport) {\n      log.warn(\"HeatmapLayer: \".concat(this.id, \" rendering to float texture not supported, fallingback to low precession format\"))();\n    }\n  }\n\n  _createWeightsTransform(shaderOptions = {}) {\n    var _weightsTransform;\n\n    const {\n      gl\n    } = this.context;\n    let {\n      weightsTransform\n    } = this.state;\n    const {\n      weightsTexture\n    } = this.state;\n    (_weightsTransform = weightsTransform) === null || _weightsTransform === void 0 ? void 0 : _weightsTransform.delete();\n    const shaders = mergeShaders({\n      vs: weights_vs,\n      _fs: weights_fs\n    }, shaderOptions);\n    weightsTransform = new Transform(gl, {\n      id: \"\".concat(this.id, \"-weights-transform\"),\n      elementCount: 1,\n      _targetTexture: weightsTexture,\n      _targetTextureVarying: 'weightsTexture',\n      ...shaders\n    });\n    this.setState({\n      weightsTransform\n    });\n  }\n\n  _setupResources() {\n    const {\n      gl\n    } = this.context;\n\n    this._createTextures();\n\n    const {\n      textureSize,\n      weightsTexture,\n      maxWeightsTexture\n    } = this.state;\n\n    this._createWeightsTransform();\n\n    const maxWeightTransform = new Transform(gl, {\n      id: \"\".concat(this.id, \"-max-weights-transform\"),\n      _sourceTextures: {\n        inTexture: weightsTexture\n      },\n      _targetTexture: maxWeightsTexture,\n      _targetTextureVarying: 'outTexture',\n      vs: vs_max,\n      _fs: fs_max,\n      elementCount: textureSize * textureSize\n    });\n    this.setState({\n      weightsTexture,\n      maxWeightsTexture,\n      maxWeightTransform,\n      zoom: null,\n      triPositionBuffer: new Buffer(gl, {\n        byteLength: 48,\n        accessor: {\n          size: 3\n        }\n      }),\n      triTexCoordBuffer: new Buffer(gl, {\n        byteLength: 48,\n        accessor: {\n          size: 2\n        }\n      })\n    });\n  }\n\n  updateShaders(shaderOptions) {\n    this._createWeightsTransform(shaderOptions);\n  }\n\n  _updateMaxWeightValue() {\n    const {\n      maxWeightTransform\n    } = this.state;\n    maxWeightTransform.run({\n      parameters: {\n        blend: true,\n        depthTest: false,\n        blendFunc: [1, 1],\n        blendEquation: 32776\n      }\n    });\n  }\n\n  _updateBounds(forceUpdate = false) {\n    const {\n      viewport\n    } = this.context;\n    const viewportCorners = [viewport.unproject([0, 0]), viewport.unproject([viewport.width, 0]), viewport.unproject([viewport.width, viewport.height]), viewport.unproject([0, viewport.height])].map(p => p.map(Math.fround));\n    const visibleWorldBounds = getBounds(viewportCorners);\n    const newState = {\n      visibleWorldBounds,\n      viewportCorners\n    };\n    let boundsChanged = false;\n\n    if (forceUpdate || !this.state.worldBounds || !boundsContain(this.state.worldBounds, visibleWorldBounds)) {\n      const scaledCommonBounds = this._worldToCommonBounds(visibleWorldBounds);\n\n      const worldBounds = this._commonToWorldBounds(scaledCommonBounds);\n\n      if (this.props.coordinateSystem === COORDINATE_SYSTEM.LNGLAT) {\n        worldBounds[1] = Math.max(worldBounds[1], -85.051129);\n        worldBounds[3] = Math.min(worldBounds[3], 85.051129);\n        worldBounds[0] = Math.max(worldBounds[0], -360);\n        worldBounds[2] = Math.min(worldBounds[2], 360);\n      }\n\n      const normalizedCommonBounds = this._worldToCommonBounds(worldBounds);\n\n      newState.worldBounds = worldBounds;\n      newState.normalizedCommonBounds = normalizedCommonBounds;\n      boundsChanged = true;\n    }\n\n    this.setState(newState);\n    return boundsChanged;\n  }\n\n  _updateTextureRenderingBounds() {\n    const {\n      triPositionBuffer,\n      triTexCoordBuffer,\n      normalizedCommonBounds,\n      viewportCorners\n    } = this.state;\n    const {\n      viewport\n    } = this.context;\n    triPositionBuffer.subData(packVertices(viewportCorners, 3));\n    const textureBounds = viewportCorners.map(p => getTextureCoordinates(viewport.projectPosition(p), normalizedCommonBounds));\n    triTexCoordBuffer.subData(packVertices(textureBounds, 2));\n  }\n\n  _updateColorTexture(opts) {\n    const {\n      colorRange\n    } = opts.props;\n    let {\n      colorTexture\n    } = this.state;\n    const colors = colorRangeToFlatArray(colorRange, false, Uint8Array);\n\n    if (colorTexture) {\n      colorTexture.setImageData({\n        data: colors,\n        width: colorRange.length\n      });\n    } else {\n      colorTexture = new Texture2D(this.context.gl, {\n        data: colors,\n        width: colorRange.length,\n        height: 1,\n        ...TEXTURE_OPTIONS\n      });\n    }\n\n    this.setState({\n      colorTexture\n    });\n  }\n\n  _updateWeightmap() {\n    const {\n      radiusPixels,\n      colorDomain,\n      aggregation\n    } = this.props;\n    const {\n      weightsTransform,\n      worldBounds,\n      textureSize,\n      weightsTexture,\n      weightsScale\n    } = this.state;\n    this.state.isWeightMapDirty = false;\n\n    const commonBounds = this._worldToCommonBounds(worldBounds, {\n      useLayerCoordinateSystem: true\n    });\n\n    if (colorDomain && aggregation === 'SUM') {\n      const {\n        viewport\n      } = this.context;\n      const metersPerPixel = viewport.distanceScales.metersPerUnit[2] * (commonBounds[2] - commonBounds[0]) / textureSize;\n      this.state.colorDomain = colorDomain.map(x => x * metersPerPixel * weightsScale);\n    } else {\n      this.state.colorDomain = colorDomain || DEFAULT_COLOR_DOMAIN;\n    }\n\n    const uniforms = {\n      radiusPixels,\n      commonBounds,\n      textureWidth: textureSize,\n      weightsScale\n    };\n    weightsTransform.update({\n      elementCount: this.getNumInstances()\n    });\n    weightsTransform.run({\n      uniforms,\n      parameters: {\n        blend: true,\n        depthTest: false,\n        blendFunc: [1, 1],\n        blendEquation: 32774\n      },\n      clearRenderTarget: true,\n      attributes: this.getAttributes(),\n      moduleSettings: this.getModuleSettings()\n    });\n\n    this._updateMaxWeightValue();\n\n    weightsTexture.setParameters({\n      [10240]: 9729,\n      [10241]: 9729\n    });\n  }\n\n  _debouncedUpdateWeightmap(fromTimer = false) {\n    let {\n      updateTimer\n    } = this.state;\n\n    if (fromTimer) {\n      updateTimer = null;\n\n      this._updateBounds(true);\n\n      this._updateTextureRenderingBounds();\n\n      this.setState({\n        isWeightMapDirty: true\n      });\n    } else {\n      this.setState({\n        isWeightMapDirty: false\n      });\n      clearTimeout(updateTimer);\n      updateTimer = setTimeout(this._debouncedUpdateWeightmap.bind(this, true), ZOOM_DEBOUNCE);\n    }\n\n    this.setState({\n      updateTimer\n    });\n  }\n\n  _worldToCommonBounds(worldBounds, opts = {}) {\n    const {\n      useLayerCoordinateSystem = false\n    } = opts;\n    const [minLong, minLat, maxLong, maxLat] = worldBounds;\n    const {\n      viewport\n    } = this.context;\n    const {\n      textureSize\n    } = this.state;\n    const {\n      coordinateSystem\n    } = this.props;\n    const offsetMode = useLayerCoordinateSystem && (coordinateSystem === COORDINATE_SYSTEM.LNGLAT_OFFSETS || coordinateSystem === COORDINATE_SYSTEM.METER_OFFSETS);\n    const offsetOriginCommon = offsetMode ? viewport.projectPosition(this.props.coordinateOrigin) : [0, 0];\n    const size = textureSize * RESOLUTION / viewport.scale;\n    let bottomLeftCommon;\n    let topRightCommon;\n\n    if (useLayerCoordinateSystem && !offsetMode) {\n      bottomLeftCommon = this.projectPosition([minLong, minLat, 0]);\n      topRightCommon = this.projectPosition([maxLong, maxLat, 0]);\n    } else {\n      bottomLeftCommon = viewport.projectPosition([minLong, minLat, 0]);\n      topRightCommon = viewport.projectPosition([maxLong, maxLat, 0]);\n    }\n\n    return scaleToAspectRatio([bottomLeftCommon[0] - offsetOriginCommon[0], bottomLeftCommon[1] - offsetOriginCommon[1], topRightCommon[0] - offsetOriginCommon[0], topRightCommon[1] - offsetOriginCommon[1]], size, size);\n  }\n\n  _commonToWorldBounds(commonBounds) {\n    const [xMin, yMin, xMax, yMax] = commonBounds;\n    const {\n      viewport\n    } = this.context;\n    const bottomLeftWorld = viewport.unprojectPosition([xMin, yMin]);\n    const topRightWorld = viewport.unprojectPosition([xMax, yMax]);\n    return bottomLeftWorld.slice(0, 2).concat(topRightWorld.slice(0, 2));\n  }\n\n}\nHeatmapLayer.layerName = 'HeatmapLayer';\nHeatmapLayer.defaultProps = defaultProps;\n//# sourceMappingURL=heatmap-layer.js.map","export default \"varying vec4 weightsTexture;\\nfloat gaussianKDE(float u){\\n  return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);\\n}\\nvoid main()\\n{\\n  float dist = length(gl_PointCoord - vec2(0.5, 0.5));\\n  if (dist > 0.5) {\\n    discard;\\n  }\\n  gl_FragColor = weightsTexture * gaussianKDE(2. * dist);\\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\\n}\\n\";\n//# sourceMappingURL=weights-fs.glsl.js.map","export default \"attribute vec4 inTexture;\\nvarying vec4 outTexture;\\n\\nvoid main()\\n{\\noutTexture = inTexture;\\ngl_Position = vec4(0, 0, 0, 1.);\\ngl_PointSize = 1.0;\\n}\\n\";\n//# sourceMappingURL=max-vs.glsl.js.map","export default \"varying vec4 outTexture;\\nvoid main() {\\n  gl_FragColor = outTexture;\\n  gl_FragColor.g = outTexture.r / max(1.0, outTexture.a);\\n}\\n\";\n//# sourceMappingURL=max-fs.glsl.js.map","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { HeatmapLayer } from 'deck.gl';\nimport React from 'react';\nimport { t, getSequentialSchemeRegistry } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { hexToRGB } from '../../utils/colors';\nimport { createDeckGLComponent, getLayerType } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\n\nfunction setTooltipContent(o: any) {\n  return (\n    <div className=\"deckgl-tooltip\">\n      <TooltipRow\n        label={t('Centroid (Longitude and Latitude): ')}\n        value={`(${o.coordinate[0]}, ${o.coordinate[1]})`}\n      />\n    </div>\n  );\n}\nexport const getLayer: getLayerType<unknown> = (\n  formData,\n  payload,\n  onAddFilter,\n  setTooltip,\n) => {\n  const fd = formData;\n  const {\n    intensity = 1,\n    radius_pixels: radiusPixels = 30,\n    aggregation = 'SUM',\n    js_data_mutator: jsFnMutator,\n    linear_color_scheme: colorScheme,\n  } = fd;\n  let data = payload.data.features;\n\n  if (jsFnMutator) {\n    // Applying user defined data mutator if defined\n    const jsFnMutatorFunction = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutatorFunction(data);\n  }\n\n  const colorScale = getSequentialSchemeRegistry()\n    ?.get(colorScheme)\n    ?.createLinearScale([0, 6]);\n  const colorRange = colorScale\n    ?.range()\n    ?.map(color => hexToRGB(color))\n    ?.reverse();\n\n  return new HeatmapLayer({\n    id: `heatmp-layer-${fd.slice_id}`,\n    data,\n    intensity,\n    radiusPixels,\n    colorRange,\n    aggregation: aggregation.toUpperCase(),\n    getPosition: (d: { position: number[]; weight: number }) => d.position,\n    getWeight: (d: { position: number[]; weight: number }) =>\n      d.weight ? d.weight : 1,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent),\n  });\n};\n\nfunction getPoints(data: any[]) {\n  return data.map(d => d.position);\n}\n\nexport default createDeckGLComponent(getLayer, getPoints);\n"],"names":["filterProps","props","filterKeys","filteredProps","key","includes","AggregationLayer","initializeState","dimensions","super","this","setState","ignoreProps","constructor","_propTypes","data","updateState","opts","changeFlags","extensionsChanged","shaders","getShaders","defines","NON_INSTANCED_MODEL","updateShaders","_updateAttributes","updateAttributes","changedAttributes","getAttributes","getAttributeManager","getShaderAttributes","getModuleSettings","viewport","mousePosition","gl","context","Object","assign","create","pickingActive","devicePixelRatio","isAggregationDirty","updateOpts","params","oldProps","compareAll","dimension","state","dataProps","accessors","updateTriggersChanged","dataChanged","all","accessor","newProps","propTypes","name","isAttributeChanged","undefined","obj","isEmpty","isObjectEmpty","_getAttributeManager","id","stats","layerName","defaultColorRange","colorRangeToFlatArray","colorRange","normalize","ArrayType","Float32Array","flatArray","Number","isFinite","length","index","i","color","CompositeLayer","isComposite","isLoaded","getSubLayers","every","layer","internalState","subLayers","updateObject","setNeedsUpdate","getPickingInfo","info","object","__source","parent","renderLayers","filterSubLayer","shouldRenderSubLayer","_subLayerProps","overridingProps","getSubLayerClass","DefaultLayerClass","type","getSubLayerRow","row","sourceObject","sourceObjectIndex","getSubLayerAccessor","objectInfo","target","x","getSubLayerProps","sublayerProps","opacity","pickable","visible","parameters","getPolygonOffset","highlightedObjectIndex","autoHighlight","highlightColor","coordinateSystem","coordinateOrigin","wrapLongitude","positionFormat","modelMatrix","extensions","fetch","overridingSublayerProps","overridingSublayerTriggers","updateTriggers","sublayerId","subLayerPropTypes","propType","concat","extension","passThroughProps","call","_updateAutoHighlight","updateAutoHighlight","_renderLayers","shouldUpdate","needsUpdate","Boolean","StyledLegend","styled","theme","typography","sizes","s","colors","grayscale","light5","gridUnit","light2","base","categoryDelimiter","categories","PropTypes","forceCategorical","format","position","showSingleCategory","toggleCategory","Legend","React","value","numValue","parseFloat","formatNumber","formatCategoryLabel","k","values","split","render","keys","entries","map","v","style","join","icon","enabled","href","onClick","onDoubleClick","charAt","defaultProps","getScale","CategoricalColorNamespace","datasource","formData","getLayer","getPoints","height","mapboxApiKey","onAddFilter","payload","setControlValue","width","CategoricalDeckGLContainer","containerRef","setTooltip","tooltip","current","getStateFromProps","getLayers","bind","onValuesChange","UNSAFE_componentWillReceiveProps","nextProps","form_data","Array","isArray","getStep","features","timestamps","f","__timestamp","fd","c","color_picker","r","g","b","a","fixedColor","colorFn","color_scheme","forEach","d","cat_color","hasOwnProperty","hexToRGB","sliceId","getCategories","granularity","time_grain_sqla","start","end","disabled","getPlaySliderParams","autozoom","fitViewport","points","zoom","selected","lastClick","addColor","js_data_mutator","sandboxedEval","jsFnMutator","filter","cats","category","categoryState","AnimatableDeckGLContainer","ref","mapboxApiAccessToken","mapStyle","mapbox_style","legend_format","legend_position","createDeckGLComponent","Component","computeLayer","onViewportChange","nextFdNoVP","currFdNoVP","DeckGLContainer","layers","createCategoricalDeckGLComponent","scratchArray","packVertices","point","TriangleLayer","vs","fs","modules","project32","add","positions","size","noAlloc","texCoords","model","_getModel","vertexCount","geometry","drawMode","draw","uniforms","texture","maxTexture","colorTexture","intensity","threshold","aggregationMode","colorDomain","setUniforms","TEXTURE_OPTIONS","mipmaps","dataFormat","DEFAULT_COLOR_DOMAIN","AGGREGATION_MODE","SUM","MEAN","getPosition","getWeight","min","radiusPixels","max","optional","aggregation","REQUIRED_FEATURES","DIMENSIONS","HeatmapLayer","supported","log","_setupTextureParams","_setupAttributes","_setupResources","shouldUpdateState","somethingChanged","_getChangeFlags","viewportChanged","boundsChanged","_updateBounds","_updateTextureRenderingBounds","clearTimeout","updateTimer","isWeightMapDirty","viewportZoomChanged","_debouncedUpdateWeightmap","_updateColorTexture","_updateWeightmap","weightsTexture","triPositionBuffer","triTexCoordBuffer","maxWeightsTexture","attributes","finalizeState","weightsTransform","maxWeightTransform","delete","_createTextures","textureSize","weights","positionAttributeName","Math","floatTargetSupport","getTextureParams","weightsScale","_createWeightsTransform","shaderOptions","_weightsTransform","_fs","elementCount","_targetTexture","_targetTextureVarying","_sourceTextures","inTexture","byteLength","_updateMaxWeightValue","run","blend","depthTest","blendFunc","blendEquation","forceUpdate","viewportCorners","unproject","p","fround","visibleWorldBounds","y","xMin","apply","xMax","getBounds","newState","worldBounds","currentBounds","targetBounds","scaledCommonBounds","_worldToCommonBounds","_commonToWorldBounds","normalizedCommonBounds","subData","textureBounds","bounds","yMin","yMax","getTextureCoordinates","projectPosition","Uint8Array","setImageData","commonBounds","useLayerCoordinateSystem","metersPerPixel","distanceScales","metersPerUnit","textureWidth","update","getNumInstances","clearRenderTarget","moduleSettings","setParameters","fromTimer","setTimeout","minLong","minLat","maxLong","maxLat","offsetMode","offsetOriginCommon","scale","bottomLeftCommon","topRightCommon","boundingBox","currentWidth","currentHeight","newWidth","newHeight","xCenter","yCenter","scaleToAspectRatio","bottomLeftWorld","unprojectPosition","topRightWorld","slice","setTooltipContent","o","className","TooltipRow","label","t","coordinate","radius_pixels","linear_color_scheme","colorScheme","jsFnMutatorFunction","colorScale","getSequentialSchemeRegistry","get","createLinearScale","range","reverse","slice_id","toUpperCase","weight","commonLayerProps"],"sourceRoot":""}