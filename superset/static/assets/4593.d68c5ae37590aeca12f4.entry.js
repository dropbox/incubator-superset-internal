"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4593],{82607:(e,t,a)=>{a.d(t,{Z:()=>s}),a(67294);var n=a(51995),l=a(62529),o=a(11965);const s=(0,n.iK)((({textColor:e,...t})=>(0,o.tZ)(l.Z,t)))`
  & > sup {
    padding: 0 ${({theme:e})=>2*e.gridUnit}px;
    background: ${({theme:e,color:t})=>t||e.colors.primary.base};
    color: ${({theme:e,textColor:t})=>t||e.colors.grayscale.light5};
  }
`},57011:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(5872),l=a.n(n),o=(a(67294),a(70302)),s=a(11965);const i=({padded:e,...t})=>(0,s.tZ)(o.Z,l()({},t,{css:t=>({backgroundColor:t.colors.grayscale.light4,borderRadius:t.borderRadius,".ant-card-body":{padding:e?4*t.gridUnit:t.gridUnit}})}))},79789:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(67294),l=a(51995),o=a(61988),s=a(70163),i=a(58593),r=a(11965);const d=function({certifiedBy:e,details:t,size:a="l"}){const d=(0,l.Fg)();return(0,r.tZ)(i.u,{id:"certified-details-tooltip",title:(0,r.tZ)(n.Fragment,null,e&&(0,r.tZ)("div",null,(0,r.tZ)("strong",null,(0,o.t)("Certified by %s",e))),(0,r.tZ)("div",null,t))},(0,r.tZ)(s.Z.Certified,{iconColor:d.colors.primary.base,iconSize:a}))}},73995:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(67294),l=a(51995),o=a(31069),s=a(61988),i=a(15926),r=a.n(i),d=a(4715),c=a(37921),u=a(49238),m=a(40277),b=a(14114),h=a(11965);const p=l.iK.div`
  ${({theme:e})=>`\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${e.gridUnit}px;\n      margin-top: ${5*e.gridUnit}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .select {\n      width: calc(100% - 30px - ${e.gridUnit}px);\n      flex: 1;\n    }\n\n    & > div {\n      margin-bottom: ${4*e.gridUnit}px;\n    }\n  `}
`,g=l.iK.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-left: ${({theme:e})=>e.gridUnit-2}px;

  .backend {
    overflow: visible;
  }

  .name {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,f=({backend:e,databaseName:t})=>(0,h.tZ)(g,null,(0,h.tZ)(c.Z,{className:"backend"},e),(0,h.tZ)("span",{className:"name",title:t},t));function v({db:e,formMode:t=!1,emptyState:a,getDbList:l,handleError:i,isDatabaseSelectEnabled:c=!0,onDbChange:g,onEmptyResults:v,onSchemaChange:Z,onSchemasLoad:y,readOnly:S=!1,schema:x,sqlLabMode:w=!1}){const[C,_]=(0,n.useState)(!1),[k,$]=(0,n.useState)([]),[L,E]=(0,n.useState)(e?{label:(0,h.tZ)(f,{backend:e.backend,databaseName:e.database_name}),value:e.id,...e}:void 0),[U,N]=(0,n.useState)(x?{label:x,value:x}:void 0),[M,z]=(0,n.useState)(0),{addSuccessToast:D}=(0,b.e1)(),T=(0,n.useMemo)((()=>async(e,a,n)=>{const s=`/api/v1/database/?q=${r().encode({order_columns:"database_name",order_direction:"asc",page:a,page_size:n,...t||!w?{filters:[{col:"database_name",opr:"ct",value:e}]}:{filters:[{col:"database_name",opr:"ct",value:e},{col:"expose_in_sqllab",opr:"eq",value:!0}]}})}`;return o.Z.get({endpoint:s}).then((({json:t})=>{const{result:a}=t;l&&l(a),0===a.length&&v&&v(e);const n=a.map((e=>({label:(0,h.tZ)(f,{backend:e.backend,databaseName:e.database_name}),value:e.id,id:e.id,database_name:e.database_name,backend:e.backend,allow_multi_schema_metadata_fetch:e.allow_multi_schema_metadata_fetch})));return{data:n,totalCount:n.length}}))}),[t,l,w]);function R(e,t){return(0,h.tZ)("div",{className:"section"},(0,h.tZ)("span",{className:"select"},e),(0,h.tZ)("span",{className:"refresh"},t))}return(0,n.useEffect)((()=>{if(L){_(!0);const e=r().encode({force:M>0}),t=`/api/v1/database/${L.value}/schemas/?q=${e}`;o.Z.get({endpoint:t}).then((({json:e})=>{const t=e.result.map((e=>({value:e,label:e,title:e})));y&&y(t),$(t),_(!1),M>0&&D("List refreshed")})).catch((()=>{_(!1),i((0,s.t)("There was an error loading the schemas"))}))}}),[L,y,M]),(0,h.tZ)(p,null,R((0,h.tZ)(d.Ph,{ariaLabel:(0,s.t)("Select database or type database name"),optionFilterProps:["database_name","value"],header:(0,h.tZ)(u.lX,null,(0,s.t)("Database")),lazyLoading:!1,notFoundContent:a,onChange:function(e,t){E(t),N(void 0),g&&g(t),Z&&Z(void 0)},value:L,placeholder:(0,s.t)("Select database or type database name"),disabled:!c||S,options:T}),null),function(){const e=!t&&!S&&(0,h.tZ)(m.Z,{onClick:()=>z(M+1),tooltipContent:(0,s.t)("Force refresh schema list")});return R((0,h.tZ)(d.Ph,{ariaLabel:(0,s.t)("Select schema or type schema name"),disabled:!L||S,header:(0,h.tZ)(u.lX,null,(0,s.t)("Schema")),labelInValue:!0,lazyLoading:!1,loading:C,name:"select-schema",placeholder:(0,s.t)("Select schema or type schema name"),onChange:e=>function(e){N(e),Z&&Z(e.value)}(e),options:k,showSearch:!0,value:U}),e)}())}},40277:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),l=a(58593),o=a(70163),s=a(11965);const i=({onClick:e,tooltipContent:t})=>{const a=(0,n.forwardRef)(((e,t)=>(0,s.tZ)(o.Z.Refresh,e)));return(0,s.tZ)(l.u,{title:t},(0,s.tZ)(a,{role:"button",onClick:e,css:e=>({cursor:"pointer",color:e.colors.grayscale.base,"&:hover":{color:e.colors.primary.base}})}))}},17982:(e,t,a)=>{a.d(t,{P:()=>x,Z:()=>w});var n=a(5872),l=a.n(n),o=a(67294),s=a(51995),i=a(31069),r=a(61988),d=a(4715),c=a(49238),u=a(70163),m=a(73995),b=a(40277),h=a(79789),p=a(86057),g=a(14114),f=a(11965);const v=s.iK.div`
  ${({theme:e})=>`\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${e.gridUnit}px;\n      margin-top: ${5*e.gridUnit}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .divider {\n      border-bottom: 1px solid ${e.colors.secondary.light5};\n      margin: 15px 0;\n    }\n\n    .table-length {\n      color: ${e.colors.grayscale.light1};\n    }\n\n    .select {\n      flex: 1;\n    }\n  `}
`,Z=s.iK.span`
  align-items: center;
  display: flex;
  white-space: nowrap;

  svg,
  small {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,y=({table:e})=>{const{label:t,type:a,extra:n}=e;return(0,f.tZ)(Z,{title:t},"view"===a?(0,f.tZ)(u.Z.Eye,{iconSize:"m"}):(0,f.tZ)(u.Z.Table,{iconSize:"m"}),(null==n?void 0:n.certification)&&(0,f.tZ)(h.Z,{certifiedBy:n.certification.certified_by,details:n.certification.details,size:"l"}),(null==n?void 0:n.warning_markdown)&&(0,f.tZ)(p.Z,{warningMarkdown:n.warning_markdown,size:"l"}),t)},S=({database:e,emptyState:t,formMode:a=!1,getDbList:n,handleError:l,isDatabaseSelectEnabled:s=!0,onDbChange:u,onSchemaChange:h,onSchemasLoad:p,onTablesLoad:Z,readOnly:S=!1,onEmptyResults:x,schema:w,sqlLabMode:C=!0,tableSelectMode:_="single",tableValue:k,onTableSelectChange:$})=>{const[L,E]=(0,o.useState)(e),[U,N]=(0,o.useState)(w),[M,z]=(0,o.useState)([]),[D,T]=(0,o.useState)(void 0),[R,q]=(0,o.useState)(0),[F,K]=(0,o.useState)(0),[P,I]=(0,o.useState)(!1),{addSuccessToast:O}=(0,g.e1)();(0,o.useEffect)((()=>{void 0===e&&(E(void 0),N(void 0),T(void 0))}),[e,_]),(0,o.useEffect)((()=>{T("single"===_?M.find((e=>e.value===k)):(null==M?void 0:M.filter((e=>e&&(null==k?void 0:k.includes(e.value)))))||[])}),[M,k,_]),(0,o.useEffect)((()=>{if(L&&U){I(!0);const e=encodeURIComponent(U),t=R!==F,a=encodeURI(`/superset/tables/${L.id}/${e}/undefined/${t}/`);F!==R&&K(R),i.Z.get({endpoint:a}).then((({json:e})=>{const a=e.options.map((e=>({value:e.value,label:(0,f.tZ)(y,{table:e}),text:e.label})));null==Z||Z(e.options),z(a),I(!1),t&&O("List updated")})).catch((()=>{I(!1),l((0,r.t)("There was an error loading the tables"))}))}}),[L,U,Z,z,R]);const X=e=>{U?null==$||$(Array.isArray(e)?e.map((e=>null==e?void 0:e.value)):null==e?void 0:e.value,U):T(e)},j=(0,o.useMemo)((()=>(e,t)=>{const a=e.trim().toLowerCase(),{text:n}=t;return n.toLowerCase().includes(a)}),[]);return(0,f.tZ)(v,null,(0,f.tZ)(m.Z,{key:null==L?void 0:L.id,db:L,emptyState:t,formMode:a,getDbList:n,handleError:l,onDbChange:S?void 0:e=>{E(e),u&&u(e)},onEmptyResults:x,onSchemaChange:S?void 0:e=>{N(e),h&&h(e),X(void 0)},onSchemasLoad:p,schema:U,sqlLabMode:C,isDatabaseSelectEnabled:s&&!S,readOnly:S}),C&&!a&&(0,f.tZ)("div",{className:"divider"}),function(){const t=U&&!a&&S||!U&&!(null!=e&&e.allow_multi_schema_metadata_fetch),n=C?(0,f.tZ)(c.lX,null,(0,r.t)("See table schema")):(0,f.tZ)(c.lX,null,(0,r.t)("Table"));return l=(0,f.tZ)(d.Ph,{ariaLabel:(0,r.t)("Select table or type table name"),disabled:t,filterOption:j,header:n,labelInValue:!0,lazyLoading:!1,loading:P,name:"select-table",onChange:e=>X(e),options:M,placeholder:(0,r.t)("Select table or type table name"),showSearch:!0,mode:_,value:D,allowClear:"multiple"===_}),o=!a&&!S&&(0,f.tZ)(b.Z,{onClick:()=>q(R+1),tooltipContent:(0,r.t)("Force refresh table list")}),(0,f.tZ)("div",{className:"section"},(0,f.tZ)("span",{className:"select"},l),(0,f.tZ)("span",{className:"refresh"},o));var l,o}())},x=e=>(0,f.tZ)(S,l()({tableSelectMode:"multiple"},e)),w=S}}]);
//# sourceMappingURL=4593.d68c5ae37590aeca12f4.entry.js.map