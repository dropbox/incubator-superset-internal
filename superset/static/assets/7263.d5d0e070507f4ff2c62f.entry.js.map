{"version":3,"file":"7263.d5d0e070507f4ff2c62f.entry.js","mappings":"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","sources":["webpack://superset/./packages/superset-ui-core/src/chart/models/ChartMetadata.ts","webpack://superset/./packages/superset-ui-core/src/chart/models/ChartPlugin.ts","webpack://superset/./packages/superset-ui-core/src/chart/registries/ChartComponentRegistrySingleton.ts","webpack://superset/./packages/superset-ui-core/src/chart/registries/ChartTransformPropsRegistrySingleton.ts","webpack://superset/./packages/superset-ui-core/src/currency-format/utils.ts","webpack://superset/./packages/superset-ui-core/src/hooks/useComponentDidMount/useComponentDidMount.ts","webpack://superset/./packages/superset-ui-core/src/math-expression/index.ts","webpack://superset/./packages/superset-ui-core/src/models/Plugin.ts","webpack://superset/./packages/superset-ui-core/src/models/Preset.ts","webpack://superset/./packages/superset-ui-core/src/query/extractTimegrain.ts","webpack://superset/./packages/superset-ui-core/src/query/normalizeOrderBy.ts","webpack://superset/./packages/superset-ui-core/src/query/types/AnnotationLayer.ts","webpack://superset/./packages/superset-ui-core/src/time-format/formatters/smartDateDetailed.ts","webpack://superset/./packages/superset-ui-core/src/validator/validateMapboxStylesUrl.ts"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Behavior, ChartLabel } from '../types/Base';\nimport { ParseMethod } from '../../connection';\n\ninterface LookupTable {\n  [key: string]: boolean;\n}\n\nexport interface ExampleImage {\n  url: string;\n  caption?: string;\n}\n\nexport interface ChartMetadataConfig {\n  name: string;\n  canBeAnnotationTypes?: string[];\n  credits?: string[];\n  description?: string;\n  datasourceCount?: number;\n  enableNoResults?: boolean;\n  supportedAnnotationTypes?: string[];\n  thumbnail: string;\n  useLegacyApi?: boolean;\n  behaviors?: Behavior[];\n  exampleGallery?: ExampleImage[];\n  tags?: string[];\n  category?: string | null;\n  // deprecated: true hides a chart from all viz picker interactions.\n  deprecated?: boolean;\n  // label: ChartLabel.DEPRECATED which will display a \"deprecated\" label on the chart.\n  label?: ChartLabel | null;\n  labelExplanation?: string | null;\n  queryObjectCount?: number;\n  parseMethod?: ParseMethod;\n}\n\nexport default class ChartMetadata {\n  name: string;\n\n  canBeAnnotationTypes?: string[];\n\n  canBeAnnotationTypesLookup: LookupTable;\n\n  credits: string[];\n\n  description: string;\n\n  supportedAnnotationTypes: string[];\n\n  thumbnail: string;\n\n  useLegacyApi: boolean;\n\n  behaviors: Behavior[];\n\n  datasourceCount: number;\n\n  enableNoResults: boolean;\n\n  exampleGallery: ExampleImage[];\n\n  tags: string[];\n\n  category: string | null;\n\n  deprecated?: boolean;\n\n  label?: ChartLabel | null;\n\n  labelExplanation?: string | null;\n\n  queryObjectCount: number;\n\n  parseMethod: ParseMethod;\n\n  constructor(config: ChartMetadataConfig) {\n    const {\n      name,\n      canBeAnnotationTypes = [],\n      credits = [],\n      description = '',\n      supportedAnnotationTypes = [],\n      thumbnail,\n      useLegacyApi = false,\n      behaviors = [],\n      datasourceCount = 1,\n      enableNoResults = true,\n      exampleGallery = [],\n      tags = [],\n      category = null,\n      deprecated = false,\n      label = null,\n      labelExplanation = null,\n      queryObjectCount = 1,\n      parseMethod = 'json-bigint',\n    } = config;\n\n    this.name = name;\n    this.credits = credits;\n    this.description = description;\n    this.canBeAnnotationTypes = canBeAnnotationTypes;\n    this.canBeAnnotationTypesLookup = canBeAnnotationTypes.reduce(\n      (prev: LookupTable, type: string) => {\n        const lookup = prev;\n        lookup[type] = true;\n\n        return lookup;\n      },\n      {},\n    );\n    this.supportedAnnotationTypes = supportedAnnotationTypes;\n    this.thumbnail = thumbnail;\n    this.useLegacyApi = useLegacyApi;\n    this.behaviors = behaviors;\n    this.datasourceCount = datasourceCount;\n    this.enableNoResults = enableNoResults;\n    this.exampleGallery = exampleGallery;\n    this.tags = tags;\n    this.category = category;\n    this.deprecated = deprecated;\n    this.label = label;\n    this.labelExplanation = labelExplanation;\n    this.queryObjectCount = queryObjectCount;\n    this.parseMethod = parseMethod;\n  }\n\n  canBeAnnotationType(type: string): boolean {\n    return this.canBeAnnotationTypesLookup[type] || false;\n  }\n\n  clone() {\n    return new ChartMetadata(this);\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ComponentType } from 'react';\nimport { isRequired, Plugin, QueryFormData } from '../..';\nimport ChartMetadata from './ChartMetadata';\nimport getChartMetadataRegistry from '../registries/ChartMetadataRegistrySingleton';\nimport getChartBuildQueryRegistry from '../registries/ChartBuildQueryRegistrySingleton';\nimport getChartComponentRegistry from '../registries/ChartComponentRegistrySingleton';\nimport getChartControlPanelRegistry from '../registries/ChartControlPanelRegistrySingleton';\nimport getChartTransformPropsRegistry from '../registries/ChartTransformPropsRegistrySingleton';\nimport { BuildQueryFunction, TransformProps } from '../types/TransformFunction';\nimport { ChartControlPanel } from './ChartControlPanel';\nimport { ChartProps } from '..';\n\nfunction IDENTITY<T>(x: T) {\n  return x;\n}\n\nconst EMPTY = {};\n\nexport type PromiseOrValue<T> = Promise<T> | T;\nexport type PromiseOrValueLoader<T> = () => PromiseOrValue<T>;\nexport type ChartType = ComponentType<any>;\ntype ValueOrModuleWithValue<T> = T | { default: T };\n\ninterface ChartPluginConfig<\n  FormData extends QueryFormData = QueryFormData,\n  Props extends ChartProps = ChartProps,\n> {\n  metadata: ChartMetadata;\n  /** Use buildQuery for immediate value. For lazy-loading, use loadBuildQuery. */\n  buildQuery?: BuildQueryFunction<FormData>;\n  /** Use loadBuildQuery for dynamic import (lazy-loading) */\n  loadBuildQuery?: PromiseOrValueLoader<\n    ValueOrModuleWithValue<BuildQueryFunction<FormData>>\n  >;\n  /** Use transformProps for immediate value. For lazy-loading, use loadTransformProps.  */\n  transformProps?: TransformProps<Props>;\n  /** Use loadTransformProps for dynamic import (lazy-loading) */\n  loadTransformProps?: PromiseOrValueLoader<\n    ValueOrModuleWithValue<TransformProps<Props>>\n  >;\n  /** Use Chart for immediate value. For lazy-loading, use loadChart. */\n  Chart?: ChartType;\n  /** Use loadChart for dynamic import (lazy-loading) */\n  loadChart?: PromiseOrValueLoader<ValueOrModuleWithValue<ChartType>>;\n  /** Control panel configuration object */\n  controlPanel?: ChartControlPanel;\n}\n\n/**\n * Loaders of the form `() => import('foo')` may return esmodules\n * which require the value to be extracted as `module.default`\n * */\nfunction sanitizeLoader<T>(\n  loader: PromiseOrValueLoader<ValueOrModuleWithValue<T>>,\n): PromiseOrValueLoader<T> {\n  return () => {\n    const loaded = loader();\n\n    return loaded instanceof Promise\n      ? (loaded.then(\n          module => ('default' in module && module.default) || module,\n        ) as Promise<T>)\n      : (loaded as T);\n  };\n}\n\nexport default class ChartPlugin<\n  FormData extends QueryFormData = QueryFormData,\n  Props extends ChartProps = ChartProps,\n> extends Plugin {\n  controlPanel: ChartControlPanel;\n\n  metadata: ChartMetadata;\n\n  loadBuildQuery?: PromiseOrValueLoader<BuildQueryFunction<FormData>>;\n\n  loadTransformProps: PromiseOrValueLoader<TransformProps<Props>>;\n\n  loadChart: PromiseOrValueLoader<ChartType>;\n\n  constructor(config: ChartPluginConfig<FormData, Props>) {\n    super();\n    const {\n      metadata,\n      buildQuery,\n      loadBuildQuery,\n      transformProps = IDENTITY,\n      loadTransformProps,\n      Chart,\n      loadChart,\n      controlPanel = EMPTY,\n    } = config;\n    this.controlPanel = controlPanel;\n    this.metadata = metadata;\n    this.loadBuildQuery =\n      (loadBuildQuery && sanitizeLoader(loadBuildQuery)) ||\n      (buildQuery && sanitizeLoader(() => buildQuery)) ||\n      undefined;\n    this.loadTransformProps = sanitizeLoader(\n      loadTransformProps ?? (() => transformProps),\n    );\n\n    if (loadChart) {\n      this.loadChart = sanitizeLoader<ChartType>(loadChart);\n    } else if (Chart) {\n      this.loadChart = () => Chart;\n    } else {\n      throw new Error('Chart or loadChart is required');\n    }\n  }\n\n  register() {\n    const key: string = this.config.key || isRequired('config.key');\n    getChartMetadataRegistry().registerValue(key, this.metadata);\n    getChartComponentRegistry().registerLoader(key, this.loadChart);\n    getChartControlPanelRegistry().registerValue(key, this.controlPanel);\n    getChartTransformPropsRegistry().registerLoader(\n      key,\n      this.loadTransformProps,\n    );\n    if (this.loadBuildQuery) {\n      getChartBuildQueryRegistry().registerLoader(key, this.loadBuildQuery);\n    }\n    return this;\n  }\n\n  unregister() {\n    const key: string = this.config.key || isRequired('config.key');\n    getChartMetadataRegistry().remove(key);\n    getChartComponentRegistry().remove(key);\n    getChartControlPanelRegistry().remove(key);\n    getChartTransformPropsRegistry().remove(key);\n    getChartBuildQueryRegistry().remove(key);\n    return this;\n  }\n\n  configure(config: { [key: string]: unknown }, replace?: boolean) {\n    super.configure(config, replace);\n\n    return this;\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Registry, makeSingleton, OverwritePolicy } from '../..';\nimport { ChartType } from '../models/ChartPlugin';\n\nclass ChartComponentRegistry extends Registry<ChartType> {\n  constructor() {\n    super({ name: 'ChartComponent', overwritePolicy: OverwritePolicy.WARN });\n  }\n}\n\nconst getInstance = makeSingleton(ChartComponentRegistry);\n\nexport default getInstance;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Registry, makeSingleton, OverwritePolicy } from '../..';\nimport { TransformProps } from '../types/TransformFunction';\n\nclass ChartTransformPropsRegistry extends Registry<TransformProps<any>> {\n  constructor() {\n    super({\n      name: 'ChartTransformProps',\n      overwritePolicy: OverwritePolicy.WARN,\n    });\n  }\n}\n\nconst getInstance = makeSingleton(ChartTransformPropsRegistry);\n\nexport default getInstance;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Currency,\n  CurrencyFormatter,\n  ensureIsArray,\n  getNumberFormatter,\n  isSavedMetric,\n  QueryFormMetric,\n  ValueFormatter,\n} from '@superset-ui/core';\n\nexport const buildCustomFormatters = (\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  savedCurrencyFormats: Record<string, Currency>,\n  savedColumnFormats: Record<string, string>,\n  d3Format: string | undefined,\n  currencyFormat: Currency | undefined,\n) => {\n  const metricsArray = ensureIsArray(metrics);\n  return metricsArray.reduce((acc, metric) => {\n    if (isSavedMetric(metric)) {\n      const actualD3Format = d3Format ?? savedColumnFormats[metric];\n      const actualCurrencyFormat = currencyFormat?.symbol\n        ? currencyFormat\n        : savedCurrencyFormats[metric];\n      return actualCurrencyFormat\n        ? {\n            ...acc,\n            [metric]: new CurrencyFormatter({\n              d3Format: actualD3Format,\n              currency: actualCurrencyFormat,\n            }),\n          }\n        : {\n            ...acc,\n            [metric]: getNumberFormatter(actualD3Format),\n          };\n    }\n    return acc;\n  }, {});\n};\n\nexport const getCustomFormatter = (\n  customFormatters: Record<string, ValueFormatter>,\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  key?: string,\n) => {\n  const metricsArray = ensureIsArray(metrics);\n  if (metricsArray.length === 1 && isSavedMetric(metricsArray[0])) {\n    return customFormatters[metricsArray[0]];\n  }\n  return key ? customFormatters[key] : undefined;\n};\n\nexport const getValueFormatter = (\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  savedCurrencyFormats: Record<string, Currency>,\n  savedColumnFormats: Record<string, string>,\n  d3Format: string | undefined,\n  currencyFormat: Currency | undefined,\n  key?: string,\n) => {\n  const customFormatter = getCustomFormatter(\n    buildCustomFormatters(\n      metrics,\n      savedCurrencyFormats,\n      savedColumnFormats,\n      d3Format,\n      currencyFormat,\n    ),\n    metrics,\n    key,\n  );\n\n  if (customFormatter) {\n    return customFormatter;\n  }\n  if (currencyFormat?.symbol) {\n    return new CurrencyFormatter({ currency: currencyFormat, d3Format });\n  }\n  return getNumberFormatter(d3Format);\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { EffectCallback, useEffect } from 'react';\n\nexport const useComponentDidMount = (effect: EffectCallback) => {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(effect, []);\n};\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport mexp from 'math-expression-evaluator';\n\nconst REPLACE_OPERATORS: [RegExp, string][] = [\n  [new RegExp(/==/g), 'Eq'],\n  [new RegExp(/>=/g), 'Gte'],\n  [new RegExp(/<=/g), 'Lte'],\n  [new RegExp(/>/g), 'Gt'],\n  [new RegExp(/</g), 'Lt'],\n];\n\nconst TOKENS = [\n  {\n    type: 3,\n    token: 'x',\n    show: 'x',\n    value: 'x',\n  },\n  {\n    type: 2,\n    token: '&',\n    show: '&',\n    value: (a: number, b: number): number => a & b,\n  },\n  {\n    type: 2,\n    token: '|',\n    show: '|',\n    value: (a: number, b: number): number => a | b,\n  },\n  {\n    type: 2,\n    token: 'and',\n    show: 'and',\n    value: (a: number, b: number): number => a && b,\n  },\n  {\n    type: 2,\n    token: 'xor',\n    show: 'xor',\n    value: (a: number, b: number): number => a ^ b,\n  },\n  {\n    type: 2,\n    token: 'or',\n    show: 'or',\n    value: (a: number, b: number): number => Number(a || b),\n  },\n  {\n    type: 2,\n    token: 'Eq',\n    show: 'Eq',\n    value: (a: number, b: number): number => Number(a === b),\n  },\n  {\n    type: 2,\n    token: 'Lt',\n    show: 'Lt',\n    value: (a: number, b: number): number => Number(a < b),\n  },\n  {\n    type: 2,\n    token: 'Lte',\n    show: 'Lte',\n    value: (a: number, b: number): number => Number(a <= b),\n  },\n  {\n    type: 2,\n    token: 'Gt',\n    show: 'Gt',\n    value: (a: number, b: number): number => Number(a > b),\n  },\n  {\n    type: 2,\n    token: 'Gte',\n    show: 'Gte',\n    value: (a: number, b: number): number => Number(a >= b),\n  },\n];\n\nexport function evalExpression(expression: string, value: number): number {\n  let parsedExpression = expression;\n  // replace `<` with `Lt` (and others) to avoid clashes with builtin function operators\n  // that are not needed in Superset.\n  REPLACE_OPERATORS.forEach(([key, value]) => {\n    parsedExpression = parsedExpression.replace(key, value);\n  });\n  const subExpressions = String(parsedExpression).split('=');\n  parsedExpression = subExpressions[1] ?? subExpressions[0];\n  // we can ignore the type requirement on `TOKENS`, as value is always `number`\n  // and doesn't need to consider `number | undefined`.\n  // @ts-ignore\n  return Number(mexp.eval(parsedExpression, TOKENS, { x: value }));\n}\n\nexport function isValidExpression(expression: string): boolean {\n  try {\n    evalExpression(expression, 0);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\ninterface PlainObject {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\nexport default class Plugin {\n  config: PlainObject;\n\n  constructor() {\n    this.config = {};\n  }\n\n  resetConfig() {\n    // The child class can set default config\n    // by overriding this function.\n    this.config = {};\n\n    return this;\n  }\n\n  configure(config: PlainObject, replace = false) {\n    this.config = replace ? config : { ...this.config, ...config };\n\n    return this;\n  }\n\n  register() {\n    return this;\n  }\n\n  unregister() {\n    return this;\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Plugin from './Plugin';\n\nexport default class Preset {\n  name: string;\n\n  description: string;\n\n  presets: Preset[];\n\n  plugins: Plugin[];\n\n  constructor(\n    config: {\n      name?: string;\n      description?: string;\n      presets?: Preset[];\n      plugins?: Plugin[];\n    } = {},\n  ) {\n    const { name = '', description = '', presets = [], plugins = [] } = config;\n    this.name = name;\n    this.description = description;\n    this.presets = presets;\n    this.plugins = plugins;\n  }\n\n  register() {\n    this.presets.forEach(preset => {\n      preset.register();\n    });\n    this.plugins.forEach(plugin => {\n      plugin.register();\n    });\n\n    return this;\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-underscore-dangle */\n\nimport { QueryFormData } from '@superset-ui/core';\nimport { TimeGranularity } from '../time-format';\n\nexport default function extractTimegrain(\n  formData: QueryFormData,\n): TimeGranularity | undefined {\n  const { time_grain_sqla, extra_filters, extra_form_data } = formData;\n  if (extra_form_data?.time_grain_sqla) {\n    return extra_form_data.time_grain_sqla;\n  }\n  const extra_grain = (extra_filters || []).filter(\n    filter => filter.col === '__time_grain',\n  );\n  if (extra_grain.length) {\n    return extra_grain[0].val as TimeGranularity;\n  }\n  return time_grain_sqla;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport isEmpty from 'lodash/isEmpty';\nimport isBoolean from 'lodash/isBoolean';\n\nimport { QueryObject } from './types';\n\nexport default function normalizeOrderBy(\n  queryObject: QueryObject,\n): QueryObject {\n  if (Array.isArray(queryObject.orderby) && queryObject.orderby.length > 0) {\n    // ensure a valid orderby clause\n    const orderbyClause = queryObject.orderby[0];\n    if (\n      Array.isArray(orderbyClause) &&\n      orderbyClause.length === 2 &&\n      !isEmpty(orderbyClause[0]) &&\n      isBoolean(orderbyClause[1])\n    ) {\n      return queryObject;\n    }\n  }\n\n  // ensure that remove invalid orderby clause\n  const cloneQueryObject = { ...queryObject };\n  delete cloneQueryObject.series_limit_metric;\n  delete cloneQueryObject.legacy_order_by;\n  delete cloneQueryObject.order_desc;\n  delete cloneQueryObject.orderby;\n\n  const isAsc = !queryObject.order_desc;\n  if (\n    queryObject.series_limit_metric !== undefined &&\n    queryObject.series_limit_metric !== null &&\n    !isEmpty(queryObject.series_limit_metric)\n  ) {\n    return {\n      ...cloneQueryObject,\n      orderby: [[queryObject.series_limit_metric, isAsc]],\n    };\n  }\n\n  // todo: Removed `legacy_order_by` after refactoring\n  if (\n    queryObject.legacy_order_by !== undefined &&\n    queryObject.legacy_order_by !== null &&\n    !isEmpty(queryObject.legacy_order_by)\n  ) {\n    return {\n      ...cloneQueryObject,\n      // @ts-ignore\n      orderby: [[queryObject.legacy_order_by, isAsc]],\n    };\n  }\n\n  if (Array.isArray(queryObject.metrics) && queryObject.metrics.length > 0) {\n    return {\n      ...cloneQueryObject,\n      orderby: [[queryObject.metrics[0], isAsc]],\n    };\n  }\n\n  return cloneQueryObject;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/* eslint camelcase: 0 */\nimport { DataRecord } from './QueryResponse';\nimport { TimeGranularity } from '../../time-format';\n\nexport enum AnnotationType {\n  Event = 'EVENT',\n  Formula = 'FORMULA',\n  Interval = 'INTERVAL',\n  Timeseries = 'TIME_SERIES',\n}\n\nexport enum AnnotationSourceType {\n  Line = 'line',\n  Native = 'NATIVE',\n  Table = 'table',\n  Undefined = '',\n}\n\nexport enum AnnotationOpacity {\n  High = 'opacityHigh',\n  Low = 'opacityLow',\n  Medium = 'opacityMedium',\n  Undefined = '',\n}\n\nexport enum AnnotationStyle {\n  Dashed = 'dashed',\n  Dotted = 'dotted',\n  Solid = 'solid',\n  LongDashed = 'longDashed',\n}\n\ntype BaseAnnotationLayer = {\n  color?: string | null;\n  name: string;\n  opacity?: AnnotationOpacity;\n  show: boolean;\n  showLabel: boolean;\n  style: AnnotationStyle;\n  width?: number;\n};\n\ntype AnnotationOverrides = {\n  granularity?: string | null;\n  time_grain_sqla?: TimeGranularity | null;\n  time_range?: string | null;\n  time_shift?: string | null;\n};\n\ntype LineSourceAnnotationLayer = {\n  hideLine?: boolean;\n  overrides?: AnnotationOverrides;\n  sourceType: AnnotationSourceType.Line;\n  titleColumn?: string;\n  // viz id\n  value: number;\n};\n\ntype NativeSourceAnnotationLayer = {\n  sourceType: AnnotationSourceType.Native;\n  // annotation id\n  value: number;\n};\n\ntype TableSourceAnnotationLayer = {\n  descriptionColumns?: string[];\n  timeColumn?: string;\n  intervalEndColumn?: string;\n  overrides?: AnnotationOverrides;\n  sourceType: AnnotationSourceType.Table;\n  titleColumn?: string;\n  // viz id\n  value: number;\n};\n\nexport type EventAnnotationLayer = BaseAnnotationLayer &\n  (TableSourceAnnotationLayer | NativeSourceAnnotationLayer) & {\n    annotationType: AnnotationType.Event;\n  };\n\nexport type IntervalAnnotationLayer = BaseAnnotationLayer &\n  (TableSourceAnnotationLayer | NativeSourceAnnotationLayer) & {\n    annotationType: AnnotationType.Interval;\n  };\n\nexport type TableAnnotationLayer = BaseAnnotationLayer &\n  TableSourceAnnotationLayer & {\n    annotationType: AnnotationType.Event | AnnotationType.Interval;\n  };\n\nexport type FormulaAnnotationLayer = BaseAnnotationLayer & {\n  annotationType: AnnotationType.Formula;\n  // the mathjs parseable formula\n  sourceType?: AnnotationSourceType.Undefined;\n  value: string;\n};\n\nexport type TimeseriesAnnotationLayer = BaseAnnotationLayer &\n  LineSourceAnnotationLayer & {\n    annotationType: AnnotationType.Timeseries;\n    showMarkers?: boolean;\n    value: number;\n  };\n\nexport type AnnotationLayer =\n  | EventAnnotationLayer\n  | IntervalAnnotationLayer\n  | FormulaAnnotationLayer\n  | TimeseriesAnnotationLayer\n  | TableAnnotationLayer;\n\nexport function isFormulaAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is FormulaAnnotationLayer {\n  return layer.annotationType === AnnotationType.Formula;\n}\n\nexport function isEventAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is EventAnnotationLayer {\n  return layer.annotationType === AnnotationType.Event;\n}\n\nexport function isIntervalAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is IntervalAnnotationLayer {\n  return layer.annotationType === AnnotationType.Interval;\n}\n\nexport function isTimeseriesAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is TimeseriesAnnotationLayer {\n  return layer.annotationType === AnnotationType.Timeseries;\n}\n\nexport function isTableAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is TableAnnotationLayer {\n  return layer.sourceType === AnnotationSourceType.Table;\n}\n\nexport type RecordAnnotationResult = {\n  records: DataRecord[];\n};\n\nexport type TimeseriesAnnotationResult = {\n  key: string;\n  values: { x: string | number; y?: number }[];\n}[];\n\nexport type AnnotationResult =\n  | RecordAnnotationResult\n  | TimeseriesAnnotationResult;\n\nexport function isTimeseriesAnnotationResult(\n  result: AnnotationResult,\n): result is TimeseriesAnnotationResult {\n  return Array.isArray(result);\n}\n\nexport function isRecordAnnotationResult(\n  result: any,\n): result is RecordAnnotationResult {\n  return Array.isArray(result?.records);\n}\n\nexport type AnnotationData = { [key: string]: AnnotationResult };\n\nexport type Annotation = {\n  descriptions?: string[];\n  intervalEnd?: string;\n  time?: string;\n  title?: string;\n};\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport createMultiFormatter from '../factories/createMultiFormatter';\n\nconst smartDateDetailedFormatter = createMultiFormatter({\n  id: 'smart_date_detailed',\n  label: 'Detailed adaptive formatter',\n  formats: {\n    millisecond: '%Y-%m-%d %H:%M:%S.%L',\n    second: '%Y-%m-%d %H:%M:%S',\n    minute: '%Y-%m-%d %H:%M',\n    hour: '%Y-%m-%d %H:%M',\n    day: '%Y-%m-%d',\n    week: '%Y-%m-%d',\n    month: '%Y-%m-%d',\n    year: '%Y',\n  },\n});\n\nexport default smartDateDetailedFormatter;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '../translation';\n\n/**\n * Validate a [Mapbox styles URL](https://docs.mapbox.com/help/glossary/style-url/)\n * @param v\n */\nexport default function validateMapboxStylesUrl(v: unknown) {\n  if (\n    typeof v === 'string' &&\n    v.trim().length > 0 &&\n    v.trim().startsWith('mapbox://styles/')\n  ) {\n    return false;\n  }\n\n  return t('is expected to be a Mapbox URL');\n}\n"],"names":["ChartMetadata","constructor","config","name","canBeAnnotationTypes","canBeAnnotationTypesLookup","credits","description","supportedAnnotationTypes","thumbnail","useLegacyApi","behaviors","datasourceCount","enableNoResults","exampleGallery","tags","category","deprecated","label","labelExplanation","queryObjectCount","parseMethod","this","reduce","prev","type","lookup","canBeAnnotationType","clone","IDENTITY","x","EMPTY","sanitizeLoader","loader","loaded","Promise","then","module","default","ChartPlugin","Plugin","super","controlPanel","metadata","loadBuildQuery","loadTransformProps","loadChart","buildQuery","transformProps","Chart","undefined","Error","register","key","isRequired","getChartMetadataRegistry","registerValue","getChartComponentRegistry","registerLoader","getChartControlPanelRegistry","getChartTransformPropsRegistry","getChartBuildQueryRegistry","unregister","remove","configure","replace","ChartComponentRegistry","Registry","overwritePolicy","OverwritePolicy","WARN","makeSingleton","ChartTransformPropsRegistry","buildCustomFormatters","metrics","savedCurrencyFormats","savedColumnFormats","d3Format","currencyFormat","ensureIsArray","acc","metric","isSavedMetric","actualD3Format","actualCurrencyFormat","symbol","CurrencyFormatter","currency","getNumberFormatter","getCustomFormatter","customFormatters","metricsArray","length","getValueFormatter","useComponentDidMount","effect","useEffect","REPLACE_OPERATORS","RegExp","TOKENS","token","show","value","a","b","Number","evalExpression","expression","_subExpressions$","parsedExpression","forEach","_ref","subExpressions","String","split","mexp","isValidExpression","err","resetConfig","Preset","presets","plugins","preset","plugin","extractTimegrain","formData","time_grain_sqla","extra_filters","extra_form_data","extra_grain","filter","col","val","normalizeOrderBy","queryObject","Array","isArray","orderby","orderbyClause","isEmpty","isBoolean","cloneQueryObject","series_limit_metric","legacy_order_by","order_desc","isAsc","AnnotationType","AnnotationSourceType","AnnotationOpacity","AnnotationStyle","isFormulaAnnotationLayer","layer","annotationType","Formula","isEventAnnotationLayer","Event","isIntervalAnnotationLayer","Interval","isTimeseriesAnnotationLayer","Timeseries","isTableAnnotationLayer","sourceType","Table","isTimeseriesAnnotationResult","result","isRecordAnnotationResult","records","createMultiFormatter","id","formats","millisecond","second","minute","hour","day","week","month","year","validateMapboxStylesUrl","v","trim","startsWith","t"],"sourceRoot":""}