{"version":3,"file":"4654e4012283402e221d.chunk.js","mappings":"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","sources":["webpack://superset/./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack://superset/./node_modules/babel-runtime/node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack://superset/./node_modules/babel-runtime/node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack://superset/./node_modules/dom-helpers/util/inDOM.js","webpack://superset/./node_modules/dom-helpers/util/scrollbarSize.js","webpack://superset/./node_modules/lodash/_baseOrderBy.js","webpack://superset/./node_modules/lodash/_baseSortBy.js","webpack://superset/./node_modules/lodash/_compareAscending.js","webpack://superset/./node_modules/lodash/_compareMultiple.js","webpack://superset/./node_modules/lodash/flatMap.js","webpack://superset/./node_modules/lodash/flatMapDeep.js","webpack://superset/./node_modules/lodash/isEqualWith.js","webpack://superset/./node_modules/lodash/sortBy.js","webpack://superset/./node_modules/lodash/uniq.js","webpack://superset/./node_modules/lodash/uniqWith.js","webpack://superset/./node_modules/performance-now/lib/performance-now.js","webpack://superset/./node_modules/raf/index.js","webpack://superset/./node_modules/react-checkbox-tree/lib/index.browser.js","webpack://superset/./node_modules/react-dnd/dist/esm/utils/js_utils.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/utils.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/disposables.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/decorateHandler.js","webpack://superset/./node_modules/react-dnd/dist/esm/utils/isValidType.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/createSourceFactory.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/DragSource.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/createTargetFactory.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/DropTarget.js","webpack://superset/./node_modules/react-dnd/dist/esm/decorators/DragLayer.js","webpack://superset/./node_modules/react-lifecycles-compat/react-lifecycles-compat.es.js","webpack://superset/./node_modules/react-search-input/lib/index.js","webpack://superset/./node_modules/react-search-input/lib/util.js","webpack://superset/./node_modules/react-search-input/node_modules/fuse.js/dist/fuse.js","webpack://superset/./node_modules/react-sticky/lib/Container.js","webpack://superset/./node_modules/react-sticky/lib/Sticky.js","webpack://superset/./node_modules/react-sticky/lib/index.js","webpack://superset/./packages/superset-ui-core/src/models/TypedRegistry.ts","webpack://superset/./packages/superset-ui-core/src/ui-overrides/UiOverrideRegistry.ts","webpack://superset/./src/components/EditableTitle/index.tsx","webpack://superset/./src/dashboard/util/getChartIdsFromLayout.js","webpack://superset/./node_modules/@vx/responsive/esm/components/ParentSize.js","webpack://superset/./node_modules/react-virtualized/dist/es/List/List.js","webpack://superset/./src/dashboard/components/AddSliceCard.jsx","webpack://superset/./src/dashboard/components/dnd/AddSliceDragPreview.jsx","webpack://superset/./node_modules/react-dnd-html5-backend/dist/esm/getEmptyImage.js","webpack://superset/./src/dashboard/util/isValidChild.ts","webpack://superset/./src/dashboard/util/getDropPosition.js","webpack://superset/./src/dashboard/components/dnd/handleScroll/index.ts","webpack://superset/./src/dashboard/components/dnd/handleHover.js","webpack://superset/./src/dashboard/components/dnd/dragDroppableConfig.js","webpack://superset/./src/dashboard/components/dnd/handleDrop.js","webpack://superset/./src/dashboard/components/dnd/DragDroppable.jsx","webpack://superset/./src/dashboard/components/SliceAdder.jsx","webpack://superset/./src/dashboard/containers/SliceAdder.jsx","webpack://superset/./src/utils/functionalRegistry.ts","webpack://superset/./src/visualizations/presets/dashboardComponents.ts","webpack://superset/./src/visualizations/dashboardComponents/DashboardComponentsRegistry.ts","webpack://superset/./src/dashboard/components/gridComponents/new/DraggableNewComponent.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewColumn.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewDivider.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewHeader.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewRow.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewTabs.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewMarkdown.jsx","webpack://superset/./src/dashboard/components/gridComponents/new/NewDynamicComponent.tsx","webpack://superset/./src/dashboard/components/BuilderComponentPane/index.tsx","webpack://superset/./src/dashboard/components/menu/ShareMenuItems/index.tsx","webpack://superset/./src/dashboard/components/CssEditor/index.jsx","webpack://superset/./src/dashboard/components/RefreshIntervalModal.tsx","webpack://superset/./src/dashboard/components/SaveModal.tsx","webpack://superset/./src/dashboard/util/getFilterScopeNodesTree.js","webpack://superset/./src/dashboard/util/getFilterScopeParentNodes.js","webpack://superset/./src/dashboard/util/getKeyForFilterScopeTree.js","webpack://superset/./src/dashboard/util/getSelectedChartIdForFilterScopeTree.js","webpack://superset/./src/dashboard/util/buildFilterScopeTreeEntry.js","webpack://superset/./src/dashboard/util/getFilterScopeFromNodesTree.js","webpack://superset/./src/dashboard/components/filterscope/renderFilterScopeTreeNodes.jsx","webpack://superset/./src/dashboard/components/filterscope/treeIcons.jsx","webpack://superset/./src/dashboard/components/filterscope/FilterScopeTree.jsx","webpack://superset/./src/dashboard/components/filterscope/FilterFieldItem.jsx","webpack://superset/./src/dashboard/components/filterscope/renderFilterFieldTreeNodes.jsx","webpack://superset/./src/dashboard/components/filterscope/FilterFieldTree.jsx","webpack://superset/./src/dashboard/components/filterscope/FilterScopeSelector.jsx","webpack://superset/./src/dashboard/util/getFilterFieldNodesTree.js","webpack://superset/./src/dashboard/util/getRevertedFilterScope.ts","webpack://superset/./src/dashboard/containers/FilterScope.jsx","webpack://superset/./src/dashboard/components/filterscope/FilterScopeModal.tsx","webpack://superset/./src/dashboard/util/getDashboardUrl.ts","webpack://superset/./src/dashboard/components/Header/HeaderActionsDropdown/index.jsx","webpack://superset/./src/dashboard/components/PublishedStatus/index.jsx","webpack://superset/./src/dashboard/components/UndoRedoKeyListeners/index.jsx","webpack://superset/./src/dashboard/util/setPeriodicRunner.ts","webpack://superset/./src/dashboard/components/DashboardEmbedControls.tsx","webpack://superset/./src/dashboard/components/Header/index.jsx","webpack://superset/./src/dashboard/util/isDashboardLoading.js","webpack://superset/./src/dashboard/containers/DashboardHeader.jsx","webpack://superset/./src/dashboard/components/IconButton.tsx","webpack://superset/./src/dashboard/util/charts/getEffectiveExtraFilters.ts","webpack://superset/./src/dashboard/util/activeAllDashboardFilters.ts","webpack://superset/./src/dashboard/util/charts/getFormDataWithExtraFilters.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/types.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/utils.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/ScopingTree.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/utils.ts","webpack://superset/./src/dashboard/components/CrossFilterScopingModal/CrossFilterScopingForm/index.tsx","webpack://superset/./src/dashboard/components/CrossFilterScopingModal/utils/index.ts","webpack://superset/./src/dashboard/components/nativeFilters/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/DraggableFilter.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FilterTitleContainer.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FilterTitlePane.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FilterConfigurePane.tsx","webpack://superset/./src/components/ErrorMessage/BasicErrorAlert.tsx","webpack://superset/./src/utils/cacheWrapper.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/CollapsibleControl.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/ColumnSelect.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DatasetSelect.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DefaultValue.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/getControlItemsMap.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/RemovedFilter.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DependencyList.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FiltersConfigForm.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/Footer/CancelConfirmationAlert.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/Footer/Footer.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/DividerConfigForm.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigModal.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FiltersConfigModal/state.ts","webpack://superset/./src/dashboard/components/CrossFilterScopingModal/CrossFilterScopingModal.tsx","webpack://superset/./src/dashboard/components/SliceHeaderControls/index.tsx","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/CheckCircleFilled.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/ExclamationCircleFilled.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/MinusCircleFilled.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/MinusCircleFilled.js","webpack://superset/./src/dashboard/components/FiltersBadge/Styles.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/utils/index.ts","webpack://superset/./src/dashboard/components/FiltersBadge/FilterIndicator/index.tsx","webpack://superset/./src/dashboard/components/FiltersBadge/DetailsPanel/index.tsx","webpack://superset/./src/dashboard/components/FiltersBadge/selectors.ts","webpack://superset/./src/dashboard/components/FiltersBadge/index.tsx","webpack://superset/./src/dashboard/components/SliceHeader/index.tsx","webpack://superset/./src/dashboard/components/MissingChart.jsx","webpack://superset/./src/dashboard/components/gridComponents/Chart.jsx","webpack://superset/./src/dashboard/util/getFilterValuesByFilterId.js","webpack://superset/./src/dashboard/containers/Chart.jsx","webpack://superset/./src/dashboard/components/URLShortLinkButton/index.tsx","webpack://superset/./src/dashboard/components/AnchorLink/index.tsx","webpack://superset/./src/dashboard/components/DeleteComponentButton.tsx","webpack://superset/./src/dashboard/components/menu/HoverMenu.tsx","webpack://superset/./src/dashboard/components/resizable/ResizableHandle.jsx","webpack://superset/./src/dashboard/util/resizableConfig.ts","webpack://superset/./src/dashboard/components/resizable/ResizableContainer.jsx","webpack://superset/./src/dashboard/components/gridComponents/ChartHolder.jsx","webpack://superset/./src/dashboard/util/getChartAndLabelComponentIdFromPath.js","webpack://superset/./src/components/PopoverDropdown/index.tsx","webpack://superset/./src/dashboard/components/menu/MarkdownModeDropdown.tsx","webpack://superset/./src/dashboard/components/menu/WithPopoverMenu.tsx","webpack://superset/./src/dashboard/components/gridComponents/Markdown.jsx","webpack://superset/./src/dashboard/components/dnd/DragHandle.tsx","webpack://superset/./src/dashboard/components/menu/BackgroundStyleDropdown.tsx","webpack://superset/./src/dashboard/components/gridComponents/Column.jsx","webpack://superset/./src/dashboard/components/gridComponents/Divider.jsx","webpack://superset/./src/dashboard/components/gridComponents/Header.jsx","webpack://superset/./src/dashboard/components/gridComponents/Row.jsx","webpack://superset/./src/dashboard/components/gridComponents/Tab.jsx","webpack://superset/./src/dashboard/util/findTabIndexByComponentId.js","webpack://superset/./src/dashboard/util/getDirectPathToTabIndex.js","webpack://superset/./src/dashboard/util/getLeafComponentIdFromPath.js","webpack://superset/./src/dashboard/components/gridComponents/Tabs.jsx","webpack://superset/./src/dashboard/components/gridComponents/index.js","webpack://superset/./src/dashboard/components/gridComponents/DynamicComponent.tsx","webpack://superset/./src/dashboard/containers/DashboardComponent.jsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/utils.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/Footer.tsx","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/CheckOutlined.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/CheckOutlined.js","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/EllipsisOutlined.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/FiltersHeader.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/FilterSetUnit.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/index.tsx","webpack://superset/./node_modules/@ant-design/icons-svg/es/asn/WarningOutlined.js","webpack://superset/./node_modules/@ant-design/icons/es/icons/WarningOutlined.js","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterSets/EditSection.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterConfigurationLink/index.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/Header/index.tsx","webpack://superset/./node_modules/react-reverse-portal/dist/web/index.js","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterControls/utils.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterValue.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterControls/state.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/useFilterScope.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/Styles.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/useTruncation.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/TooltipWithTruncation.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/ScopeRow.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/DependenciesRow.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/useFilterDependencies.ts","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/NameRow.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/TypeRow.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/FilterCardContent.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterCard/index.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControl.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControls.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/ActionButtons/index.tsx","webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/index.tsx","webpack://superset/./src/dashboard/components/DashboardBuilder/utils.ts","webpack://superset/./src/dashboard/components/DashboardGrid.jsx","webpack://superset/./src/dashboard/containers/DashboardGrid.jsx","webpack://superset/./src/dashboard/components/DashboardBuilder/DashboardContainer.tsx","webpack://superset/./src/dashboard/util/getChartIdsInFilterScope.ts","webpack://superset/./src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx","webpack://superset/./src/dashboard/components/DashboardBuilder/state.ts","webpack://superset/./src/hooks/useElementOnScreen/index.ts","webpack://superset/./src/dashboard/util/isDashboardEmpty.ts","webpack://superset/./src/dashboard/util/charts/getOwnDataCharts.ts","webpack://superset/./src/dashboard/components/Dashboard.jsx","webpack://superset/./src/dashboard/util/getLayoutComponentFromChartId.js","webpack://superset/./src/dashboard/containers/Dashboard.ts","webpack://superset/./node_modules/use-immer/dist/use-immer.module.js"],"sourcesContent":["module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n","\"use strict\";\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _default = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n\nexports.default = _default;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = scrollbarSize;\n\nvar _inDOM = _interopRequireDefault(require(\"./inDOM\"));\n\nvar size;\n\nfunction scrollbarSize(recalc) {\n  if (!size && size !== 0 || recalc) {\n    if (_inDOM.default) {\n      var scrollDiv = document.createElement('div');\n      scrollDiv.style.position = 'absolute';\n      scrollDiv.style.top = '-9999px';\n      scrollDiv.style.width = '50px';\n      scrollDiv.style.height = '50px';\n      scrollDiv.style.overflow = 'scroll';\n      document.body.appendChild(scrollDiv);\n      size = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n      document.body.removeChild(scrollDiv);\n    }\n  }\n\n  return size;\n}\n\nmodule.exports = exports[\"default\"];","var arrayMap = require('./_arrayMap'),\n    baseGet = require('./_baseGet'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    baseSortBy = require('./_baseSortBy'),\n    baseUnary = require('./_baseUnary'),\n    compareMultiple = require('./_compareMultiple'),\n    identity = require('./identity'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `_.orderBy` without param guards.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n * @param {string[]} orders The sort orders of `iteratees`.\n * @returns {Array} Returns the new sorted array.\n */\nfunction baseOrderBy(collection, iteratees, orders) {\n  if (iteratees.length) {\n    iteratees = arrayMap(iteratees, function(iteratee) {\n      if (isArray(iteratee)) {\n        return function(value) {\n          return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n        }\n      }\n      return iteratee;\n    });\n  } else {\n    iteratees = [identity];\n  }\n\n  var index = -1;\n  iteratees = arrayMap(iteratees, baseUnary(baseIteratee));\n\n  var result = baseMap(collection, function(value, key, collection) {\n    var criteria = arrayMap(iteratees, function(iteratee) {\n      return iteratee(value);\n    });\n    return { 'criteria': criteria, 'index': ++index, 'value': value };\n  });\n\n  return baseSortBy(result, function(object, other) {\n    return compareMultiple(object, other, orders);\n  });\n}\n\nmodule.exports = baseOrderBy;\n","/**\n * The base implementation of `_.sortBy` which uses `comparer` to define the\n * sort order of `array` and replaces criteria objects with their corresponding\n * values.\n *\n * @private\n * @param {Array} array The array to sort.\n * @param {Function} comparer The function to define sort order.\n * @returns {Array} Returns `array`.\n */\nfunction baseSortBy(array, comparer) {\n  var length = array.length;\n\n  array.sort(comparer);\n  while (length--) {\n    array[length] = array[length].value;\n  }\n  return array;\n}\n\nmodule.exports = baseSortBy;\n","var isSymbol = require('./isSymbol');\n\n/**\n * Compares values to sort them in ascending order.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {number} Returns the sort order indicator for `value`.\n */\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined,\n        valIsNull = value === null,\n        valIsReflexive = value === value,\n        valIsSymbol = isSymbol(value);\n\n    var othIsDefined = other !== undefined,\n        othIsNull = other === null,\n        othIsReflexive = other === other,\n        othIsSymbol = isSymbol(other);\n\n    if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n        (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n        (valIsNull && othIsDefined && othIsReflexive) ||\n        (!valIsDefined && othIsReflexive) ||\n        !valIsReflexive) {\n      return 1;\n    }\n    if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n        (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n        (othIsNull && valIsDefined && valIsReflexive) ||\n        (!othIsDefined && valIsReflexive) ||\n        !othIsReflexive) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\nmodule.exports = compareAscending;\n","var compareAscending = require('./_compareAscending');\n\n/**\n * Used by `_.orderBy` to compare multiple properties of a value to another\n * and stable sort them.\n *\n * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n * of corresponding values.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {boolean[]|string[]} orders The order to sort by for each property.\n * @returns {number} Returns the sort order indicator for `object`.\n */\nfunction compareMultiple(object, other, orders) {\n  var index = -1,\n      objCriteria = object.criteria,\n      othCriteria = other.criteria,\n      length = objCriteria.length,\n      ordersLength = orders.length;\n\n  while (++index < length) {\n    var result = compareAscending(objCriteria[index], othCriteria[index]);\n    if (result) {\n      if (index >= ordersLength) {\n        return result;\n      }\n      var order = orders[index];\n      return result * (order == 'desc' ? -1 : 1);\n    }\n  }\n  // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n  // that causes it, under certain circumstances, to provide the same value for\n  // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n  // for more details.\n  //\n  // This also ensures a stable sort in V8 and other engines.\n  // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n  return object.index - other.index;\n}\n\nmodule.exports = compareMultiple;\n","var baseFlatten = require('./_baseFlatten'),\n    map = require('./map');\n\n/**\n * Creates a flattened array of values by running each element in `collection`\n * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n * with three arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * function duplicate(n) {\n *   return [n, n];\n * }\n *\n * _.flatMap([1, 2], duplicate);\n * // => [1, 1, 2, 2]\n */\nfunction flatMap(collection, iteratee) {\n  return baseFlatten(map(collection, iteratee), 1);\n}\n\nmodule.exports = flatMap;\n","var baseFlatten = require('./_baseFlatten'),\n    map = require('./map');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * This method is like `_.flatMap` except that it recursively flattens the\n * mapped results.\n *\n * @static\n * @memberOf _\n * @since 4.7.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * function duplicate(n) {\n *   return [[[n, n]]];\n * }\n *\n * _.flatMapDeep([1, 2], duplicate);\n * // => [1, 1, 2, 2]\n */\nfunction flatMapDeep(collection, iteratee) {\n  return baseFlatten(map(collection, iteratee), INFINITY);\n}\n\nmodule.exports = flatMapDeep;\n","var baseIsEqual = require('./_baseIsEqual');\n\n/**\n * This method is like `_.isEqual` except that it accepts `customizer` which\n * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n * are handled by the method instead. The `customizer` is invoked with up to\n * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * function isGreeting(value) {\n *   return /^h(?:i|ello)$/.test(value);\n * }\n *\n * function customizer(objValue, othValue) {\n *   if (isGreeting(objValue) && isGreeting(othValue)) {\n *     return true;\n *   }\n * }\n *\n * var array = ['hello', 'goodbye'];\n * var other = ['hi', 'goodbye'];\n *\n * _.isEqualWith(array, other, customizer);\n * // => true\n */\nfunction isEqualWith(value, other, customizer) {\n  customizer = typeof customizer == 'function' ? customizer : undefined;\n  var result = customizer ? customizer(value, other) : undefined;\n  return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n}\n\nmodule.exports = isEqualWith;\n","var baseFlatten = require('./_baseFlatten'),\n    baseOrderBy = require('./_baseOrderBy'),\n    baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates an array of elements, sorted in ascending order by the results of\n * running each element in a collection thru each iteratee. This method\n * performs a stable sort, that is, it preserves the original sort order of\n * equal elements. The iteratees are invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {...(Function|Function[])} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 36 },\n *   { 'user': 'fred',   'age': 30 },\n *   { 'user': 'barney', 'age': 34 }\n * ];\n *\n * _.sortBy(users, [function(o) { return o.user; }]);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n *\n * _.sortBy(users, ['user', 'age']);\n * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n */\nvar sortBy = baseRest(function(collection, iteratees) {\n  if (collection == null) {\n    return [];\n  }\n  var length = iteratees.length;\n  if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n    iteratees = [];\n  } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n    iteratees = [iteratees[0]];\n  }\n  return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n});\n\nmodule.exports = sortBy;\n","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n","var baseUniq = require('./_baseUniq');\n\n/**\n * This method is like `_.uniq` except that it accepts `comparator` which\n * is invoked to compare elements of `array`. The order of result values is\n * determined by the order they occur in the array.The comparator is invoked\n * with two arguments: (arrVal, othVal).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n *\n * _.uniqWith(objects, _.isEqual);\n * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n */\nfunction uniqWith(array, comparator) {\n  comparator = typeof comparator == 'function' ? comparator : undefined;\n  return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n}\n\nmodule.exports = uniqWith;\n","// Generated by CoffeeScript 1.12.2\n(function() {\n  var getNanoSeconds, hrtime, loadTime, moduleLoadTime, nodeLoadTime, upTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - nodeLoadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    moduleLoadTime = getNanoSeconds();\n    upTime = process.uptime() * 1e9;\n    nodeLoadTime = moduleLoadTime - upTime;\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n//# sourceMappingURL=performance-now.js.map\n","var now = require('performance-now')\n  , root = typeof window === 'undefined' ? global : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = root['request' + suffix]\n  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\nfor(var i = 0; !raf && i < vendors.length; i++) {\n  raf = root[vendors[i] + 'Request' + suffix]\n  caf = root[vendors[i] + 'Cancel' + suffix]\n      || root[vendors[i] + 'CancelRequest' + suffix]\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  var last = 0\n    , id = 0\n    , queue = []\n    , frameDuration = 1000 / 60\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = now()\n        , next = Math.max(0, frameDuration - (_now - last))\n      last = next + _now\n      setTimeout(function() {\n        var cp = queue.slice(0)\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last)\n            } catch(e) {\n              setTimeout(function() { throw e }, 0)\n            }\n          }\n        }\n      }, Math.round(next))\n    }\n    queue.push({\n      handle: ++id,\n      callback: callback,\n      cancelled: false\n    })\n    return id\n  }\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true\n      }\n    }\n  }\n}\n\nmodule.exports = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  return raf.call(root, fn)\n}\nmodule.exports.cancel = function() {\n  caf.apply(root, arguments)\n}\nmodule.exports.polyfill = function(object) {\n  if (!object) {\n    object = root;\n  }\n  object.requestAnimationFrame = raf\n  object.cancelAnimationFrame = caf\n}\n","/*! react-checkbox-tree - v1.5.1 | 2019 */\n!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t(require(\"react\")):\"function\"==typeof define&&define.amd?define([\"react\"],t):\"object\"==typeof exports?exports.ReactCheckboxTree=t(require(\"react\")):e.ReactCheckboxTree=t(e.React)}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=27)}([function(e,t,n){e.exports=n(96)()},function(t,n){t.exports=e},function(e,t,n){var r=n(16),o=\"object\"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function(\"return this\")();e.exports=a},function(e,t,n){var r=n(41),o=n(47);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(31),o=n(32),a=n(33),i=n(34),c=n(35);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=c,e.exports=l},function(e,t,n){var r=n(14);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(12),o=n(43),a=n(44),i=\"[object Null]\",c=\"[object Undefined]\",l=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?c:i:l&&l in Object(e)?o(e):a(e)}},function(e,t,n){var r=n(3)(Object,\"create\");e.exports=r},function(e,t,n){var r=n(56);e.exports=function(e,t){var n=e.__data__;return r(t)?n[\"string\"==typeof t?\"string\":\"hash\"]:n.map}},function(e,t){e.exports=function(e){return null!=e&&\"object\"==typeof e}},function(e,t,n){var r;\n/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n!function(){\"use strict\";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if(\"string\"===a||\"number\"===a)e.push(r);else if(Array.isArray(r)&&r.length){var i=o.apply(null,r);i&&e.push(i)}else if(\"object\"===a)for(var c in r)n.call(r,c)&&r[c]&&e.push(c)}}return e.join(\" \")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r=n(3)(n(2),\"Map\");e.exports=r},function(e,t,n){var r=n(2).Symbol;e.exports=r},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(6),o=n(17),a=\"[object AsyncFunction]\",i=\"[object Function]\",c=\"[object GeneratorFunction]\",l=\"[object Proxy]\";e.exports=function(e){if(!o(e))return!1;var t=r(e);return t==i||t==c||t==a||t==l}},function(e,t,n){(function(t){var n=\"object\"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(42))},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&(\"object\"==t||\"function\"==t)}},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+\"\"}catch(e){}}return\"\"}},function(e,t,n){var r=n(48),o=n(55),a=n(57),i=n(58),c=n(59);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=c,e.exports=l},function(e,t,n){var r=n(60),o=n(63),a=n(64),i=1,c=2;e.exports=function(e,t,n,l,u,s){var p=n&i,f=e.length,d=t.length;if(f!=d&&!(p&&d>f))return!1;var h=s.get(e);if(h&&s.get(t))return h==t;var b=-1,y=!0,v=n&c?new r:void 0;for(s.set(e,t),s.set(t,e);++b<f;){var x=e[b],m=t[b];if(l)var g=p?l(m,x,b,t,e,s):l(x,m,b,e,t,s);if(void 0!==g){if(g)continue;y=!1;break}if(v){if(!o(t,function(e,t){if(!a(v,t)&&(x===e||u(x,e,n,l,s)))return v.push(t)})){y=!1;break}}else if(x!==m&&!u(x,m,n,l,s)){y=!1;break}}return s.delete(e),s.delete(t),y}},function(e,t,n){(function(e){var r=n(2),o=n(81),a=t&&!t.nodeType&&t,i=a&&\"object\"==typeof e&&e&&!e.nodeType&&e,c=i&&i.exports===a?r.Buffer:void 0,l=(c?c.isBuffer:void 0)||o;e.exports=l}).call(this,n(22)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,\"loaded\",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,\"id\",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(83),o=n(84),a=n(85),i=a&&a.isTypedArray,c=i?o(i):r;e.exports=c},function(e,t){var n=9007199254740991;e.exports=function(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=n}},function(e,t,n){var r=n(28);e.exports=function(e,t){return r(e,t)}},function(e,t,n){var r=self.crypto||self.msCrypto;e.exports=function(e){e=e||21;for(var t=\"\",n=r.getRandomValues(new Uint8Array(e));0<e--;)t+=\"Uint8ArdomValuesObj012345679BCDEFGHIJKLMNPQRSTWXYZ_cfghkpqvwxyz-\"[63&n[e]];return t}},function(e,t,n){e.exports=n(98).default},function(e,t,n){var r=n(29),o=n(9);e.exports=function e(t,n,a,i,c){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,a,i,e,c))}},function(e,t,n){var r=n(30),o=n(20),a=n(65),i=n(69),c=n(91),l=n(13),u=n(21),s=n(23),p=1,f=\"[object Arguments]\",d=\"[object Array]\",h=\"[object Object]\",b=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,y,v,x){var m=l(e),g=l(t),k=m?d:c(e),_=g?d:c(t),O=(k=k==f?h:k)==h,j=(_=_==f?h:_)==h,w=k==_;if(w&&u(e)){if(!u(t))return!1;m=!0,O=!1}if(w&&!O)return x||(x=new r),m||s(e)?o(e,t,n,y,v,x):a(e,t,k,n,y,v,x);if(!(n&p)){var C=O&&b.call(e,\"__wrapped__\"),E=j&&b.call(t,\"__wrapped__\");if(C||E){var P=C?e.value():e,N=E?t.value():t;return x||(x=new r),v(P,N,n,y,x)}}return!!w&&(x||(x=new r),i(e,t,n,y,v,x))}},function(e,t,n){var r=n(4),o=n(36),a=n(37),i=n(38),c=n(39),l=n(40);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=c,u.prototype.set=l,e.exports=u},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(5),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(5);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(5);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(5);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(4);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(4),o=n(11),a=n(19),i=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var c=n.__data__;if(!o||c.length<i-1)return c.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(c)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(15),o=n(45),a=n(17),i=n(18),c=/^\\[object .+?Constructor\\]$/,l=Function.prototype,u=Object.prototype,s=l.toString,p=u.hasOwnProperty,f=RegExp(\"^\"+s.call(p).replace(/[\\\\^$.*+?()[\\]{}|]/g,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\");e.exports=function(e){return!(!a(e)||o(e))&&(r(e)?f:c).test(i(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(12),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,c=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[c]=n:delete e[c]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(46),a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||\"\"))?\"Symbol(src)_1.\"+r:\"\";e.exports=function(e){return!!a&&a in e}},function(e,t,n){var r=n(2)[\"__core-js_shared__\"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(49),o=n(4),a=n(11);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||o),string:new r}}},function(e,t,n){var r=n(50),o=n(51),a=n(52),i=n(53),c=n(54);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=c,e.exports=l},function(e,t,n){var r=n(7);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(7),o=\"__lodash_hash_undefined__\",a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===o?void 0:n}return a.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(7),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(7),o=\"__lodash_hash_undefined__\";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?o:t,this}},function(e,t,n){var r=n(8);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return\"string\"==t||\"number\"==t||\"symbol\"==t||\"boolean\"==t?\"__proto__\"!==e:null===e}},function(e,t,n){var r=n(8);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(8);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(8);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(19),o=n(61),a=n(62);function i(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}i.prototype.add=i.prototype.push=o,i.prototype.has=a,e.exports=i},function(e,t){var n=\"__lodash_hash_undefined__\";e.exports=function(e){return this.__data__.set(e,n),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(12),o=n(66),a=n(14),i=n(20),c=n(67),l=n(68),u=1,s=2,p=\"[object Boolean]\",f=\"[object Date]\",d=\"[object Error]\",h=\"[object Map]\",b=\"[object Number]\",y=\"[object RegExp]\",v=\"[object Set]\",x=\"[object String]\",m=\"[object Symbol]\",g=\"[object ArrayBuffer]\",k=\"[object DataView]\",_=r?r.prototype:void 0,O=_?_.valueOf:void 0;e.exports=function(e,t,n,r,_,j,w){switch(n){case k:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case g:return!(e.byteLength!=t.byteLength||!j(new o(e),new o(t)));case p:case f:case b:return a(+e,+t);case d:return e.name==t.name&&e.message==t.message;case y:case x:return e==t+\"\";case h:var C=c;case v:var E=r&u;if(C||(C=l),e.size!=t.size&&!E)return!1;var P=w.get(e);if(P)return P==t;r|=s,w.set(e,t);var N=i(C(e),C(t),r,_,j,w);return w.delete(e),N;case m:if(O)return O.call(e)==O.call(t)}return!1}},function(e,t,n){var r=n(2).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},function(e,t,n){var r=n(70),o=1,a=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,c,l){var u=n&o,s=r(e),p=s.length;if(p!=r(t).length&&!u)return!1;for(var f=p;f--;){var d=s[f];if(!(u?d in t:a.call(t,d)))return!1}var h=l.get(e);if(h&&l.get(t))return h==t;var b=!0;l.set(e,t),l.set(t,e);for(var y=u;++f<p;){var v=e[d=s[f]],x=t[d];if(i)var m=u?i(x,v,d,t,e,l):i(v,x,d,e,t,l);if(!(void 0===m?v===x||c(v,x,n,i,l):m)){b=!1;break}y||(y=\"constructor\"==d)}if(b&&!y){var g=e.constructor,k=t.constructor;g!=k&&\"constructor\"in e&&\"constructor\"in t&&!(\"function\"==typeof g&&g instanceof g&&\"function\"==typeof k&&k instanceof k)&&(b=!1)}return l.delete(e),l.delete(t),b}},function(e,t,n){var r=n(71),o=n(73),a=n(76);e.exports=function(e){return r(e,a,o)}},function(e,t,n){var r=n(72),o=n(13);e.exports=function(e,t,n){var a=t(e);return o(e)?a:r(a,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(74),o=n(75),a=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,c=i?function(e){return null==e?[]:(e=Object(e),r(i(e),function(t){return a.call(e,t)}))}:o;e.exports=c},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(77),o=n(86),a=n(90);e.exports=function(e){return a(e)?r(e):o(e)}},function(e,t,n){var r=n(78),o=n(79),a=n(13),i=n(21),c=n(82),l=n(23),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),s=!n&&o(e),p=!n&&!s&&i(e),f=!n&&!s&&!p&&l(e),d=n||s||p||f,h=d?r(e.length,String):[],b=h.length;for(var y in e)!t&&!u.call(e,y)||d&&(\"length\"==y||p&&(\"offset\"==y||\"parent\"==y)||f&&(\"buffer\"==y||\"byteLength\"==y||\"byteOffset\"==y)||c(y,b))||h.push(y);return h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(80),o=n(9),a=Object.prototype,i=a.hasOwnProperty,c=a.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,\"callee\")&&!c.call(e,\"callee\")};e.exports=l},function(e,t,n){var r=n(6),o=n(9),a=\"[object Arguments]\";e.exports=function(e){return o(e)&&r(e)==a}},function(e,t){e.exports=function(){return!1}},function(e,t){var n=9007199254740991,r=/^(?:0|[1-9]\\d*)$/;e.exports=function(e,t){var o=typeof e;return!!(t=null==t?n:t)&&(\"number\"==o||\"symbol\"!=o&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(6),o=n(24),a=n(9),i={};i[\"[object Float32Array]\"]=i[\"[object Float64Array]\"]=i[\"[object Int8Array]\"]=i[\"[object Int16Array]\"]=i[\"[object Int32Array]\"]=i[\"[object Uint8Array]\"]=i[\"[object Uint8ClampedArray]\"]=i[\"[object Uint16Array]\"]=i[\"[object Uint32Array]\"]=!0,i[\"[object Arguments]\"]=i[\"[object Array]\"]=i[\"[object ArrayBuffer]\"]=i[\"[object Boolean]\"]=i[\"[object DataView]\"]=i[\"[object Date]\"]=i[\"[object Error]\"]=i[\"[object Function]\"]=i[\"[object Map]\"]=i[\"[object Number]\"]=i[\"[object Object]\"]=i[\"[object RegExp]\"]=i[\"[object Set]\"]=i[\"[object String]\"]=i[\"[object WeakMap]\"]=!1,e.exports=function(e){return a(e)&&o(e.length)&&!!i[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(16),o=t&&!t.nodeType&&t,a=o&&\"object\"==typeof e&&e&&!e.nodeType&&e,i=a&&a.exports===o&&r.process,c=function(){try{var e=a&&a.require&&a.require(\"util\").types;return e||i&&i.binding&&i.binding(\"util\")}catch(e){}}();e.exports=c}).call(this,n(22)(e))},function(e,t,n){var r=n(87),o=n(88),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))a.call(e,n)&&\"constructor\"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===(\"function\"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(89)(Object.keys,Object);e.exports=r},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(15),o=n(24);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){var r=n(92),o=n(11),a=n(93),i=n(94),c=n(95),l=n(6),u=n(18),s=u(r),p=u(o),f=u(a),d=u(i),h=u(c),b=l;(r&&\"[object DataView]\"!=b(new r(new ArrayBuffer(1)))||o&&\"[object Map]\"!=b(new o)||a&&\"[object Promise]\"!=b(a.resolve())||i&&\"[object Set]\"!=b(new i)||c&&\"[object WeakMap]\"!=b(new c))&&(b=function(e){var t=l(e),n=\"[object Object]\"==t?e.constructor:void 0,r=n?u(n):\"\";if(r)switch(r){case s:return\"[object DataView]\";case p:return\"[object Map]\";case f:return\"[object Promise]\";case d:return\"[object Set]\";case h:return\"[object WeakMap]\"}return t}),e.exports=b},function(e,t,n){var r=n(3)(n(2),\"DataView\");e.exports=r},function(e,t,n){var r=n(3)(n(2),\"Promise\");e.exports=r},function(e,t,n){var r=n(3)(n(2),\"Set\");e.exports=r},function(e,t,n){var r=n(3)(n(2),\"WeakMap\");e.exports=r},function(e,t,n){\"use strict\";var r=n(97);function o(){}e.exports=function(){function e(e,t,n,o,a,i){if(i!==r){var c=new Error(\"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types\");throw c.name=\"Invariant Violation\",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=o,n.PropTypes=n,n}},function(e,t,n){\"use strict\";e.exports=\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\"},function(e,t,n){\"use strict\";n.r(t);var r=n(10),o=n.n(r),a=n(25),i=n.n(a),c=n(26),l=n.n(c),u=n(0),s=n.n(u),p=n(1),f=n.n(p);function d(e){return(d=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return!t||\"object\"!==d(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),v(this,x(t).apply(this,arguments))}var n,r,o;return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,f.a.PureComponent),n=t,(r=[{key:\"render\",value:function(){var e=this.props,t=e.children,n=e.title,r=b(e,[\"children\",\"title\"]);return f.a.createElement(\"button\",h({\"aria-label\":n,title:n,type:\"button\"},r),t)}}])&&y(n.prototype,r),o&&y(n,o),t}();g(k,\"propTypes\",{children:s.a.node.isRequired,title:s.a.string}),g(k,\"defaultProps\",{title:null});var _=k;function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.props=t,this.flatNodes=n}var t,n,r;return t=e,(n=[{key:\"setProps\",value:function(e){this.props=e}},{key:\"clone\",value:function(){var t=this,n={};return Object.keys(this.flatNodes).forEach(function(e){var r=t.flatNodes[e];n[e]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){O(e,t,n[t])})}return e}({},r)}),new e(this.props,n)}},{key:\"getNode\",value:function(e){return this.flatNodes[e]}},{key:\"flattenNodes\",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(Array.isArray(e)&&0!==e.length){var o=this.props,a=o.disabled,i=o.noCascade;e.forEach(function(e,o){var c=t.nodeHasChildren(e);t.flatNodes[e.value]={label:e.label,value:e.value,children:e.children,parent:n,isParent:c,isLeaf:!c,showCheckbox:void 0===e.showCheckbox||e.showCheckbox,disabled:t.getDisabledState(e,n,a,i),treeDepth:r,index:o},t.flattenNodes(e.children,e,r+1)})}}},{key:\"nodeHasChildren\",value:function(e){return Array.isArray(e.children)&&e.children.length>0}},{key:\"getDisabledState\",value:function(e,t,n,r){return!!n||(!(r||!t.disabled)||Boolean(e.disabled))}},{key:\"deserializeLists\",value:function(e){var t=this,n=[\"checked\",\"expanded\"];Object.keys(this.flatNodes).forEach(function(e){n.forEach(function(n){t.flatNodes[e][n]=!1})}),n.forEach(function(n){e[n].forEach(function(e){void 0!==t.flatNodes[e]&&(t.flatNodes[e][n]=!0)})})}},{key:\"serializeList\",value:function(e){var t=this,n=[];return Object.keys(this.flatNodes).forEach(function(r){t.flatNodes[r][e]&&n.push(r)}),n}},{key:\"expandAllNodes\",value:function(e){var t=this;return Object.keys(this.flatNodes).forEach(function(n){t.flatNodes[n].isParent&&(t.flatNodes[n].expanded=e)}),this}},{key:\"toggleChecked\",value:function(e,t,n){var r=this,o=this.flatNodes[e.value];if(o.isLeaf||n){if(e.disabled)return this;this.toggleNode(e.value,\"checked\",t)}else o.children.forEach(function(e){r.toggleChecked(e,t,n)});return this}},{key:\"toggleNode\",value:function(e,t,n){return this.flatNodes[e][t]=n,this}}])&&j(t.prototype,n),r&&j(t,r),e}();function C(e){return(C=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return!t||\"object\"!==C(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),N(this,S(t).apply(this,arguments))}var n,r,o;return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,f.a.PureComponent),n=t,(r=[{key:\"componentDidMount\",value:function(){this.updateDeterminateProperty()}},{key:\"componentDidUpdate\",value:function(){this.updateDeterminateProperty()}},{key:\"updateDeterminateProperty\",value:function(){var e=this.props.indeterminate;this.checkbox.indeterminate=e}},{key:\"render\",value:function(){var e=this,t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){T(e,t,n[t])})}return e}({},this.props);return delete t.indeterminate,f.a.createElement(\"input\",E({},t,{ref:function(t){e.checkbox=t},type:\"checkbox\"}))}}])&&P(n.prototype,r),o&&P(n,o),t}();T(R,\"propTypes\",{indeterminate:s.a.bool}),T(R,\"defaultProps\",{indeterminate:!1});var I=R,L=s.a.shape({check:s.a.node,uncheck:s.a.node,halfCheck:s.a.node,expandClose:s.a.node,expandOpen:s.a.node,expandAll:s.a.node,collapseAll:s.a.node,parentClose:s.a.node,parentOpen:s.a.node,leaf:s.a.node}),z=s.a.shape({collapseAll:s.a.string.isRequired,expandAll:s.a.string.isRequired,toggle:s.a.string.isRequired});function q(e){return(q=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),r=this,(n=!(o=M(t).call(this,e))||\"object\"!==q(o)&&\"function\"!=typeof o?F(r):o).onCheck=n.onCheck.bind(F(F(n))),n.onClick=n.onClick.bind(F(F(n))),n.onExpand=n.onExpand.bind(F(F(n))),n}var n,r,a;return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,f.a.Component),n=t,(r=[{key:\"onCheck\",value:function(){var e=this.props,t=e.value,n=e.onCheck;n({value:t,checked:this.getCheckState({toggle:!0})})}},{key:\"onClick\",value:function(){var e=this.props,t=e.expandOnClick,n=e.isParent,r=e.value,o=e.onClick;n&&t&&this.onExpand(),o({value:r,checked:this.getCheckState({toggle:!1})})}},{key:\"onExpand\",value:function(){var e=this.props,t=e.expanded,n=e.value,r=e.onExpand;r({value:n,expanded:!t})}},{key:\"getCheckState\",value:function(e){var t=e.toggle,n=this.props,r=n.checked,o=n.optimisticToggle;return!(0!==r||!t)||(1===r&&!t||2===r&&o)}},{key:\"renderCollapseButton\",value:function(){var e=this.props,t=e.expandDisabled,n=e.isLeaf,r=e.lang;return n?f.a.createElement(\"span\",{className:\"rct-collapse\"},f.a.createElement(\"span\",{className:\"rct-icon\"})):f.a.createElement(_,{className:\"rct-collapse rct-collapse-btn\",disabled:t,title:r.toggle,onClick:this.onExpand},this.renderCollapseIcon())}},{key:\"renderCollapseIcon\",value:function(){var e=this.props,t=e.expanded,n=e.icons,r=n.expandClose,o=n.expandOpen;return t?o:r}},{key:\"renderCheckboxIcon\",value:function(){var e=this.props,t=e.checked,n=e.icons,r=n.uncheck,o=n.check,a=n.halfCheck;return 0===t?r:1===t?o:a}},{key:\"renderNodeIcon\",value:function(){var e=this.props,t=e.expanded,n=e.icon,r=e.icons,o=r.leaf,a=r.parentClose,i=r.parentOpen,c=e.isLeaf;return null!==n?n:c?o:t?i:a}},{key:\"renderBareLabel\",value:function(e){var t=this.props,n=t.onClick,r=t.title,o=null!==n;return f.a.createElement(\"span\",{className:\"rct-bare-label\",title:r},o?f.a.createElement(\"span\",{className:\"rct-node-clickable\",onClick:this.onClick,onKeyPress:this.onClick,role:\"button\",tabIndex:0},e):e)}},{key:\"renderCheckboxLabel\",value:function(e){var t=this.props,n=t.checked,r=t.disabled,o=t.title,a=t.treeId,i=t.value,c=null!==t.onClick,l=\"\".concat(a,\"-\").concat(String(i).split(\" \").join(\"_\")),u=[f.a.createElement(\"label\",{key:0,htmlFor:l,title:o},f.a.createElement(I,{checked:1===n,disabled:r,id:l,indeterminate:2===n,onClick:this.onCheck,onChange:function(){}}),f.a.createElement(\"span\",{className:\"rct-checkbox\"},this.renderCheckboxIcon()),c?null:e)];return c&&u.push(f.a.createElement(\"span\",{key:1,className:\"rct-node-clickable\",onClick:this.onClick,onKeyPress:this.onClick,role:\"link\",tabIndex:0},e)),u}},{key:\"renderLabel\",value:function(){var e=this.props,t=e.label,n=e.showCheckbox,r=[e.showNodeIcon?f.a.createElement(\"span\",{key:0,className:\"rct-node-icon\"},this.renderNodeIcon()):null,f.a.createElement(\"span\",{key:1,className:\"rct-title\"},t)];return n?this.renderCheckboxLabel(r):this.renderBareLabel(r)}},{key:\"renderChildren\",value:function(){return this.props.expanded?this.props.children:null}},{key:\"render\",value:function(){var e=this.props,t=e.className,n=e.disabled,r=e.expanded,a=e.isLeaf,i=o()({\"rct-node\":!0,\"rct-node-leaf\":a,\"rct-node-parent\":!a,\"rct-node-expanded\":!a&&r,\"rct-node-collapsed\":!a&&!r,\"rct-disabled\":n},t);return f.a.createElement(\"li\",{className:i},f.a.createElement(\"span\",{className:\"rct-text\"},this.renderCollapseButton(),this.renderLabel()),this.renderChildren())}}])&&D(n.prototype,r),a&&D(n,a),t}();U(H,\"propTypes\",{checked:s.a.number.isRequired,disabled:s.a.bool.isRequired,expandDisabled:s.a.bool.isRequired,expanded:s.a.bool.isRequired,icons:L.isRequired,isLeaf:s.a.bool.isRequired,isParent:s.a.bool.isRequired,label:s.a.node.isRequired,lang:z.isRequired,optimisticToggle:s.a.bool.isRequired,showNodeIcon:s.a.bool.isRequired,treeId:s.a.string.isRequired,value:s.a.oneOfType([s.a.string,s.a.number]).isRequired,onCheck:s.a.func.isRequired,onExpand:s.a.func.isRequired,children:s.a.node,className:s.a.string,expandOnClick:s.a.bool,icon:s.a.node,showCheckbox:s.a.bool,title:s.a.string,onClick:s.a.func}),U(H,\"defaultProps\",{children:null,className:null,expandOnClick:!1,icon:null,showCheckbox:!0,title:null,onClick:function(){}});var V=H,$=s.a.oneOfType([s.a.arrayOf(s.a.string),s.a.arrayOf(s.a.number)]);function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J={label:s.a.node.isRequired,value:s.a.oneOfType([s.a.string,s.a.number]).isRequired,disabled:s.a.bool,icon:s.a.node,showCheckbox:s.a.bool,title:s.a.string},K=s.a.oneOfType([s.a.shape(J),s.a.shape(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){W(e,t,n[t])})}return e}({},J,{children:s.a.arrayOf(J).isRequired}))]);function G(e){return(G=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){te(e,t,n[t])})}return e}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),r=this,n=!(o=X(t).call(this,e))||\"object\"!==G(o)&&\"function\"!=typeof o?ee(r):o;var a=new w(e);return a.flattenNodes(e.nodes),a.deserializeLists({checked:e.checked,expanded:e.expanded}),n.state={id:e.id||\"rct-\".concat(l()(7)),model:a,prevProps:e},n.onCheck=n.onCheck.bind(ee(ee(n))),n.onExpand=n.onExpand.bind(ee(ee(n))),n.onNodeClick=n.onNodeClick.bind(ee(ee(n))),n.onExpandAll=n.onExpandAll.bind(ee(ee(n))),n.onCollapseAll=n.onCollapseAll.bind(ee(ee(n))),n}var n,r,a;return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,f.a.Component),n=t,a=[{key:\"getDerivedStateFromProps\",value:function(e,t){var n=t.model,r=t.prevProps,o=e.disabled,a=e.id,c=e.nodes,l=Y({},t,{prevProps:e});return n.setProps(e),i()(r.nodes,c)&&r.disabled===o||n.flattenNodes(c),null!==a&&(l=Y({},l,{id:a})),n.deserializeLists({checked:e.checked,expanded:e.expanded}),l}}],(r=[{key:\"onCheck\",value:function(e){var t=this.props,n=t.noCascade,r=t.onCheck,o=this.state.model.clone(),a=o.getNode(e.value);o.toggleChecked(e,e.checked,n),r(o.serializeList(\"checked\"),Y({},a,e))}},{key:\"onExpand\",value:function(e){var t=this.props.onExpand,n=this.state.model.clone(),r=n.getNode(e.value);n.toggleNode(e.value,\"expanded\",e.expanded),t(n.serializeList(\"expanded\"),Y({},r,e))}},{key:\"onNodeClick\",value:function(e){(0,this.props.onClick)(Y({},this.state.model.getNode(e.value),e))}},{key:\"onExpandAll\",value:function(){this.expandAllNodes()}},{key:\"onCollapseAll\",value:function(){this.expandAllNodes(!1)}},{key:\"expandAllNodes\",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,this.props.onExpand)(this.state.model.clone().expandAllNodes(e).serializeList(\"expanded\"))}},{key:\"determineShallowCheckState\",value:function(e,t){var n=this.state.model.getNode(e.value);return n.isLeaf||t?n.checked?1:0:this.isEveryChildChecked(e)?1:this.isSomeChildChecked(e)?2:0}},{key:\"isEveryChildChecked\",value:function(e){var t=this;return e.children.every(function(e){return 1===t.state.model.getNode(e.value).checkState})}},{key:\"isSomeChildChecked\",value:function(e){var t=this;return e.children.some(function(e){return t.state.model.getNode(e.value).checkState>0})}},{key:\"renderTreeNodes\",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.props,a=o.expandDisabled,i=o.expandOnClick,c=o.icons,l=o.lang,u=o.noCascade,s=o.onClick,p=o.onlyLeafCheckboxes,d=o.optimisticToggle,h=o.showNodeTitle,b=o.showNodeIcon,y=this.state,v=y.id,x=y.model,m=t.defaultProps.icons,g=e.map(function(e){var t=e.value,o=x.getNode(e.value),y=o.isParent?n.renderTreeNodes(e.children,e):null;o.checkState=n.determineShallowCheckState(e,u);var g=p?o.isLeaf:o.showCheckbox;return!r.value||x.getNode(r.value).expanded?f.a.createElement(V,{key:t,checked:o.checkState,className:e.className,disabled:o.disabled,expandDisabled:a,expandOnClick:i,expanded:o.expanded,icon:e.icon,icons:Y({},m,c),label:e.label,lang:l,optimisticToggle:d,isLeaf:o.isLeaf,isParent:o.isParent,showCheckbox:g,showNodeIcon:b,title:h?e.title||e.label:e.title,treeId:v,value:e.value,onCheck:n.onCheck,onClick:s&&n.onNodeClick,onExpand:n.onExpand},y):null});return f.a.createElement(\"ol\",null,g)}},{key:\"renderExpandAll\",value:function(){var e=this.props,t=e.icons,n=t.expandAll,r=t.collapseAll,o=e.lang;return e.showExpandAll?f.a.createElement(\"div\",{className:\"rct-options\"},f.a.createElement(_,{className:\"rct-option rct-option-expand-all\",title:o.expandAll,onClick:this.onExpandAll},n),f.a.createElement(_,{className:\"rct-option rct-option-collapse-all\",title:o.collapseAll,onClick:this.onCollapseAll},r)):null}},{key:\"renderHiddenInput\",value:function(){var e=this.props,t=e.name,n=e.nameAsArray;return void 0===t?null:n?this.renderArrayHiddenInput():this.renderJoinedHiddenInput()}},{key:\"renderArrayHiddenInput\",value:function(){var e=this.props,t=e.checked,n=e.name;return t.map(function(e){var t=\"\".concat(n,\"[]\");return f.a.createElement(\"input\",{key:e,name:t,type:\"hidden\",value:e})})}},{key:\"renderJoinedHiddenInput\",value:function(){var e=this.props,t=e.checked,n=e.name,r=t.join(\",\");return f.a.createElement(\"input\",{name:n,type:\"hidden\",value:r})}},{key:\"render\",value:function(){var e=this.props,t=e.disabled,n=e.nodes,r=e.nativeCheckboxes,a=this.renderTreeNodes(n),i=o()({\"react-checkbox-tree\":!0,\"rct-disabled\":t,\"rct-native-display\":r});return f.a.createElement(\"div\",{className:i},this.renderExpandAll(),this.renderHiddenInput(),a)}}])&&Q(n.prototype,r),a&&Q(n,a),t}();te(ne,\"propTypes\",{nodes:s.a.arrayOf(K).isRequired,checked:$,disabled:s.a.bool,expandDisabled:s.a.bool,expandOnClick:s.a.bool,expanded:$,icons:L,id:s.a.string,lang:z,name:s.a.string,nameAsArray:s.a.bool,nativeCheckboxes:s.a.bool,noCascade:s.a.bool,onlyLeafCheckboxes:s.a.bool,optimisticToggle:s.a.bool,showExpandAll:s.a.bool,showNodeIcon:s.a.bool,showNodeTitle:s.a.bool,onCheck:s.a.func,onClick:s.a.func,onExpand:s.a.func}),te(ne,\"defaultProps\",{checked:[],disabled:!1,expandDisabled:!1,expandOnClick:!1,expanded:[],icons:{check:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-check\"}),uncheck:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-uncheck\"}),halfCheck:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-half-check\"}),expandClose:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-expand-close\"}),expandOpen:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-expand-open\"}),expandAll:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-expand-all\"}),collapseAll:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-collapse-all\"}),parentClose:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-parent-close\"}),parentOpen:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-parent-open\"}),leaf:f.a.createElement(\"span\",{className:\"rct-icon rct-icon-leaf\"})},id:null,lang:{collapseAll:\"Collapse all\",expandAll:\"Expand all\",toggle:\"Toggle\"},name:void 0,nameAsArray:!1,nativeCheckboxes:!1,noCascade:!1,onlyLeafCheckboxes:!1,optimisticToggle:!0,showExpandAll:!1,showNodeIcon:!0,showNodeTitle:!1,onCheck:function(){},onClick:null,onExpand:function(){}});t.default=ne}])});","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// cheap lodash replacements\nexport function isFunction(input) {\n  return typeof input === 'function';\n}\nexport function noop() {// noop\n}\n\nfunction isObjectLike(input) {\n  return _typeof(input) === 'object' && input !== null;\n}\n\nexport function isPlainObject(input) {\n  if (!isObjectLike(input)) {\n    return false;\n  }\n\n  if (Object.getPrototypeOf(input) === null) {\n    return true;\n  }\n\n  var proto = input;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(input) === proto;\n}","export function getDecoratedComponent(instanceRef) {\n  var currentRef = instanceRef.current;\n\n  if (currentRef == null) {\n    return null;\n  } else if (currentRef.decoratedRef) {\n    // go through the private field in decorateHandler to avoid the invariant hit\n    return currentRef.decoratedRef.current;\n  } else {\n    return currentRef;\n  }\n}\nexport function isClassComponent(Component) {\n  return Component && Component.prototype && typeof Component.prototype.render === 'function';\n}\nexport function isRefForwardingComponent(C) {\n  var _item$$$typeof;\n\n  var item = C;\n  return (item === null || item === void 0 ? void 0 : (_item$$$typeof = item.$$typeof) === null || _item$$$typeof === void 0 ? void 0 : _item$$$typeof.toString()) === 'Symbol(react.forward_ref)';\n}\nexport function isRefable(C) {\n  return isClassComponent(C) || isRefForwardingComponent(C);\n}\nexport function checkDecoratorArguments(functionName, signature) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var i = 0; i < (arguments.length <= 2 ? 0 : arguments.length - 2); i++) {\n      var arg = i + 2 < 2 || arguments.length <= i + 2 ? undefined : arguments[i + 2];\n\n      if (arg && arg.prototype && arg.prototype.render) {\n        // eslint-disable-next-line no-console\n        console.error('You seem to be applying the arguments in the wrong order. ' + \"It should be \".concat(functionName, \"(\").concat(signature, \")(Component), not the other way around. \") + 'Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#you-seem-to-be-applying-the-arguments-in-the-wrong-order');\n        return;\n      }\n    }\n  }\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport { isFunction, noop } from '../utils/js_utils';\n/**\n * Provides a set of static methods for creating Disposables.\n * @param {Function} action Action to run during the first call to dispose.\n * The action is guaranteed to be run at most once.\n */\n\nvar Disposable =\n/** @class */\nfunction () {\n  var Disposable = /*#__PURE__*/function () {\n    function Disposable(action) {\n      _classCallCheck(this, Disposable);\n\n      this.isDisposed = false;\n      this.action = isFunction(action) ? action : noop;\n    }\n    /**\n     * Validates whether the given object is a disposable\n     * @param {Object} Object to test whether it has a dispose method\n     * @returns {Boolean} true if a disposable object, else false.\n     */\n\n\n    _createClass(Disposable, [{\n      key: \"dispose\",\n\n      /** Performs the task of cleaning up resources. */\n      value: function dispose() {\n        if (!this.isDisposed) {\n          this.action();\n          this.isDisposed = true;\n        }\n      }\n    }], [{\n      key: \"isDisposable\",\n      value: function isDisposable(d) {\n        return Boolean(d && isFunction(d.dispose));\n      }\n    }, {\n      key: \"_fixup\",\n      value: function _fixup(result) {\n        return Disposable.isDisposable(result) ? result : Disposable.empty;\n      }\n      /**\n       * Creates a disposable object that invokes the specified action when disposed.\n       * @param {Function} dispose Action to run during the first call to dispose.\n       * The action is guaranteed to be run at most once.\n       * @return {Disposable} The disposable object that runs the given action upon disposal.\n       */\n\n    }, {\n      key: \"create\",\n      value: function create(action) {\n        return new Disposable(action);\n      }\n    }]);\n\n    return Disposable;\n  }();\n  /**\n   * Gets the disposable that does nothing when disposed.\n   */\n\n\n  Disposable.empty = {\n    dispose: noop\n  };\n  return Disposable;\n}();\n\nexport { Disposable };\n/**\n * Represents a group of disposable resources that are disposed together.\n * @constructor\n */\n\nexport var CompositeDisposable = /*#__PURE__*/function () {\n  function CompositeDisposable() {\n    _classCallCheck(this, CompositeDisposable);\n\n    this.isDisposed = false;\n\n    for (var _len = arguments.length, disposables = new Array(_len), _key = 0; _key < _len; _key++) {\n      disposables[_key] = arguments[_key];\n    }\n\n    this.disposables = disposables;\n  }\n  /**\n   * Adds a disposable to the CompositeDisposable or disposes the disposable if the CompositeDisposable is disposed.\n   * @param {Any} item Disposable to add.\n   */\n\n\n  _createClass(CompositeDisposable, [{\n    key: \"add\",\n    value: function add(item) {\n      if (this.isDisposed) {\n        item.dispose();\n      } else {\n        this.disposables.push(item);\n      }\n    }\n    /**\n     * Removes and disposes the first occurrence of a disposable from the CompositeDisposable.\n     * @param {Any} item Disposable to remove.\n     * @returns {Boolean} true if found; false otherwise.\n     */\n\n  }, {\n    key: \"remove\",\n    value: function remove(item) {\n      var shouldDispose = false;\n\n      if (!this.isDisposed) {\n        var idx = this.disposables.indexOf(item);\n\n        if (idx !== -1) {\n          shouldDispose = true;\n          this.disposables.splice(idx, 1);\n          item.dispose();\n        }\n      }\n\n      return shouldDispose;\n    }\n    /**\n     *  Disposes all disposables in the group and removes them from the group but\n     *  does not dispose the CompositeDisposable.\n     */\n\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (!this.isDisposed) {\n        var len = this.disposables.length;\n        var currentDisposables = new Array(len);\n\n        for (var i = 0; i < len; i++) {\n          currentDisposables[i] = this.disposables[i];\n        }\n\n        this.disposables = [];\n\n        for (var _i = 0; _i < len; _i++) {\n          currentDisposables[_i].dispose();\n        }\n      }\n    }\n    /**\n     *  Disposes all disposables in the group and removes them from the group.\n     */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        var len = this.disposables.length;\n        var currentDisposables = new Array(len);\n\n        for (var i = 0; i < len; i++) {\n          currentDisposables[i] = this.disposables[i];\n        }\n\n        this.disposables = [];\n\n        for (var _i2 = 0; _i2 < len; _i2++) {\n          currentDisposables[_i2].dispose();\n        }\n      }\n    }\n  }]);\n\n  return CompositeDisposable;\n}();\n/**\n * Represents a disposable resource whose underlying disposable resource can\n * be replaced by another disposable resource, causing automatic disposal of\n * the previous underlying disposable resource.\n */\n\nexport var SerialDisposable = /*#__PURE__*/function () {\n  function SerialDisposable() {\n    _classCallCheck(this, SerialDisposable);\n\n    this.isDisposed = false;\n  }\n  /**\n   * Gets the underlying disposable.\n   * @returns {Any} the underlying disposable.\n   */\n\n\n  _createClass(SerialDisposable, [{\n    key: \"getDisposable\",\n    value: function getDisposable() {\n      return this.current;\n    }\n  }, {\n    key: \"setDisposable\",\n    value: function setDisposable(value) {\n      var shouldDispose = this.isDisposed;\n\n      if (!shouldDispose) {\n        var old = this.current;\n        this.current = value;\n\n        if (old) {\n          old.dispose();\n        }\n      }\n\n      if (shouldDispose && value) {\n        value.dispose();\n      }\n    }\n    /** Performs the task of cleaning up resources. */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        var old = this.current;\n        this.current = undefined;\n\n        if (old) {\n          old.dispose();\n        }\n      }\n    }\n  }]);\n\n  return SerialDisposable;\n}();","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport * as React from 'react';\nimport { shallowEqual } from '@react-dnd/shallowequal';\nimport { invariant } from '@react-dnd/invariant';\nimport hoistStatics from 'hoist-non-react-statics';\nimport { DndContext } from '../common/DndContext';\nimport { isPlainObject } from '../utils/js_utils';\nimport { Disposable, CompositeDisposable, SerialDisposable } from './disposables';\nimport { isRefable } from './utils';\nexport function decorateHandler(_ref) {\n  var DecoratedComponent = _ref.DecoratedComponent,\n      createHandler = _ref.createHandler,\n      createMonitor = _ref.createMonitor,\n      createConnector = _ref.createConnector,\n      registerHandler = _ref.registerHandler,\n      containerDisplayName = _ref.containerDisplayName,\n      getType = _ref.getType,\n      collect = _ref.collect,\n      options = _ref.options;\n  var _options$arePropsEqua = options.arePropsEqual,\n      arePropsEqual = _options$arePropsEqua === void 0 ? shallowEqual : _options$arePropsEqua;\n  var Decorated = DecoratedComponent;\n  var displayName = DecoratedComponent.displayName || DecoratedComponent.name || 'Component';\n\n  var DragDropContainer =\n  /** @class */\n  function () {\n    var DragDropContainer = /*#__PURE__*/function (_React$Component) {\n      _inherits(DragDropContainer, _React$Component);\n\n      var _super = _createSuper(DragDropContainer);\n\n      function DragDropContainer(props) {\n        var _this;\n\n        _classCallCheck(this, DragDropContainer);\n\n        _this = _super.call(this, props);\n        _this.decoratedRef = React.createRef();\n\n        _this.handleChange = function () {\n          var nextState = _this.getCurrentState();\n\n          if (!shallowEqual(nextState, _this.state)) {\n            _this.setState(nextState);\n          }\n        };\n\n        _this.disposable = new SerialDisposable();\n\n        _this.receiveProps(props);\n\n        _this.dispose();\n\n        return _this;\n      }\n\n      _createClass(DragDropContainer, [{\n        key: \"getHandlerId\",\n        value: function getHandlerId() {\n          return this.handlerId;\n        }\n      }, {\n        key: \"getDecoratedComponentInstance\",\n        value: function getDecoratedComponentInstance() {\n          invariant(this.decoratedRef.current, 'In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()');\n          return this.decoratedRef.current;\n        }\n      }, {\n        key: \"shouldComponentUpdate\",\n        value: function shouldComponentUpdate(nextProps, nextState) {\n          return !arePropsEqual(nextProps, this.props) || !shallowEqual(nextState, this.state);\n        }\n      }, {\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n          this.disposable = new SerialDisposable();\n          this.currentType = undefined;\n          this.receiveProps(this.props);\n          this.handleChange();\n        }\n      }, {\n        key: \"componentDidUpdate\",\n        value: function componentDidUpdate(prevProps) {\n          if (!arePropsEqual(this.props, prevProps)) {\n            this.receiveProps(this.props);\n            this.handleChange();\n          }\n        }\n      }, {\n        key: \"componentWillUnmount\",\n        value: function componentWillUnmount() {\n          this.dispose();\n        }\n      }, {\n        key: \"receiveProps\",\n        value: function receiveProps(props) {\n          if (!this.handler) {\n            return;\n          }\n\n          this.handler.receiveProps(props);\n          this.receiveType(getType(props));\n        }\n      }, {\n        key: \"receiveType\",\n        value: function receiveType(type) {\n          if (!this.handlerMonitor || !this.manager || !this.handlerConnector) {\n            return;\n          }\n\n          if (type === this.currentType) {\n            return;\n          }\n\n          this.currentType = type;\n\n          var _registerHandler = registerHandler(type, this.handler, this.manager),\n              _registerHandler2 = _slicedToArray(_registerHandler, 2),\n              handlerId = _registerHandler2[0],\n              unregister = _registerHandler2[1];\n\n          this.handlerId = handlerId;\n          this.handlerMonitor.receiveHandlerId(handlerId);\n          this.handlerConnector.receiveHandlerId(handlerId);\n          var globalMonitor = this.manager.getMonitor();\n          var unsubscribe = globalMonitor.subscribeToStateChange(this.handleChange, {\n            handlerIds: [handlerId]\n          });\n          this.disposable.setDisposable(new CompositeDisposable(new Disposable(unsubscribe), new Disposable(unregister)));\n        }\n      }, {\n        key: \"dispose\",\n        value: function dispose() {\n          this.disposable.dispose();\n\n          if (this.handlerConnector) {\n            this.handlerConnector.receiveHandlerId(null);\n          }\n        }\n      }, {\n        key: \"getCurrentState\",\n        value: function getCurrentState() {\n          if (!this.handlerConnector) {\n            return {};\n          }\n\n          var nextState = collect(this.handlerConnector.hooks, this.handlerMonitor, this.props);\n\n          if (process.env.NODE_ENV !== 'production') {\n            invariant(isPlainObject(nextState), 'Expected `collect` specified as the second argument to ' + '%s for %s to return a plain object of props to inject. ' + 'Instead, received %s.', containerDisplayName, displayName, nextState);\n          }\n\n          return nextState;\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          var _this2 = this;\n\n          return React.createElement(DndContext.Consumer, null, function (_ref2) {\n            var dragDropManager = _ref2.dragDropManager;\n\n            _this2.receiveDragDropManager(dragDropManager);\n\n            if (typeof requestAnimationFrame !== 'undefined') {\n              requestAnimationFrame(function () {\n                var _this2$handlerConnect;\n\n                return (_this2$handlerConnect = _this2.handlerConnector) === null || _this2$handlerConnect === void 0 ? void 0 : _this2$handlerConnect.reconnect();\n              });\n            }\n\n            return React.createElement(Decorated, Object.assign({}, _this2.props, _this2.getCurrentState(), {\n              // NOTE: if Decorated is a Function Component, decoratedRef will not be populated unless it's a refforwarding component.\n              ref: isRefable(Decorated) ? _this2.decoratedRef : null\n            }));\n          });\n        }\n      }, {\n        key: \"receiveDragDropManager\",\n        value: function receiveDragDropManager(dragDropManager) {\n          if (this.manager !== undefined) {\n            return;\n          }\n\n          invariant(dragDropManager !== undefined, 'Could not find the drag and drop manager in the context of %s. ' + 'Make sure to render a DndProvider component in your top-level component. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context', displayName, displayName);\n\n          if (dragDropManager === undefined) {\n            return;\n          }\n\n          this.manager = dragDropManager;\n          this.handlerMonitor = createMonitor(dragDropManager);\n          this.handlerConnector = createConnector(dragDropManager.getBackend());\n          this.handler = createHandler(this.handlerMonitor, this.decoratedRef);\n        }\n      }]);\n\n      return DragDropContainer;\n    }(React.Component);\n\n    DragDropContainer.DecoratedComponent = DecoratedComponent;\n    DragDropContainer.displayName = \"\".concat(containerDisplayName, \"(\").concat(displayName, \")\");\n    return DragDropContainer;\n  }();\n\n  return hoistStatics(DragDropContainer, DecoratedComponent);\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nexport function isValidType(type, allowArray) {\n  return typeof type === 'string' || _typeof(type) === 'symbol' || !!allowArray && Array.isArray(type) && type.every(function (t) {\n    return isValidType(t, false);\n  });\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport { invariant } from '@react-dnd/invariant';\nimport { isPlainObject } from '../utils/js_utils';\nimport { getDecoratedComponent } from './utils';\nvar ALLOWED_SPEC_METHODS = ['canDrag', 'beginDrag', 'isDragging', 'endDrag'];\nvar REQUIRED_SPEC_METHODS = ['beginDrag'];\n\nvar SourceImpl = /*#__PURE__*/function () {\n  function SourceImpl(spec, monitor, ref) {\n    var _this = this;\n\n    _classCallCheck(this, SourceImpl);\n\n    this.props = null;\n\n    this.beginDrag = function () {\n      if (!_this.props) {\n        return;\n      }\n\n      var item = _this.spec.beginDrag(_this.props, _this.monitor, _this.ref.current);\n\n      if (process.env.NODE_ENV !== 'production') {\n        invariant(isPlainObject(item), 'beginDrag() must return a plain object that represents the dragged item. ' + 'Instead received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', item);\n      }\n\n      return item;\n    };\n\n    this.spec = spec;\n    this.monitor = monitor;\n    this.ref = ref;\n  }\n\n  _createClass(SourceImpl, [{\n    key: \"receiveProps\",\n    value: function receiveProps(props) {\n      this.props = props;\n    }\n  }, {\n    key: \"canDrag\",\n    value: function canDrag() {\n      if (!this.props) {\n        return false;\n      }\n\n      if (!this.spec.canDrag) {\n        return true;\n      }\n\n      return this.spec.canDrag(this.props, this.monitor);\n    }\n  }, {\n    key: \"isDragging\",\n    value: function isDragging(globalMonitor, sourceId) {\n      if (!this.props) {\n        return false;\n      }\n\n      if (!this.spec.isDragging) {\n        return sourceId === globalMonitor.getSourceId();\n      }\n\n      return this.spec.isDragging(this.props, this.monitor);\n    }\n  }, {\n    key: \"endDrag\",\n    value: function endDrag() {\n      if (!this.props) {\n        return;\n      }\n\n      if (!this.spec.endDrag) {\n        return;\n      }\n\n      this.spec.endDrag(this.props, this.monitor, getDecoratedComponent(this.ref));\n    }\n  }]);\n\n  return SourceImpl;\n}();\n\nexport function createSourceFactory(spec) {\n  Object.keys(spec).forEach(function (key) {\n    invariant(ALLOWED_SPEC_METHODS.indexOf(key) > -1, 'Expected the drag source specification to only have ' + 'some of the following keys: %s. ' + 'Instead received a specification with an unexpected \"%s\" key. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', ALLOWED_SPEC_METHODS.join(', '), key);\n    invariant(typeof spec[key] === 'function', 'Expected %s in the drag source specification to be a function. ' + 'Instead received a specification with %s: %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', key, key, spec[key]);\n  });\n  REQUIRED_SPEC_METHODS.forEach(function (key) {\n    invariant(typeof spec[key] === 'function', 'Expected %s in the drag source specification to be a function. ' + 'Instead received a specification with %s: %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', key, key, spec[key]);\n  });\n  return function createSource(monitor, ref) {\n    return new SourceImpl(spec, monitor, ref);\n  };\n}","import { invariant } from '@react-dnd/invariant';\nimport { isPlainObject } from '../utils/js_utils';\nimport { checkDecoratorArguments } from './utils';\nimport { decorateHandler } from './decorateHandler';\nimport { registerSource } from '../common/registration';\nimport { DragSourceMonitorImpl } from '../common/DragSourceMonitorImpl';\nimport { SourceConnector } from '../common/SourceConnector';\nimport { isValidType } from '../utils/isValidType';\nimport { createSourceFactory } from './createSourceFactory';\n/**\n * Decorates a component as a dragsource\n * @param type The dragsource type\n * @param spec The drag source specification\n * @param collect The props collector function\n * @param options DnD options\n */\n\nexport function DragSource(type, spec, collect) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  checkDecoratorArguments('DragSource', 'type, spec, collect[, options]', type, spec, collect, options);\n  var getType = type;\n\n  if (typeof type !== 'function') {\n    invariant(isValidType(type), 'Expected \"type\" provided as the first argument to DragSource to be ' + 'a string, or a function that returns a string given the current props. ' + 'Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', type);\n\n    getType = function getType() {\n      return type;\n    };\n  }\n\n  invariant(isPlainObject(spec), 'Expected \"spec\" provided as the second argument to DragSource to be ' + 'a plain object. Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', spec);\n  var createSource = createSourceFactory(spec);\n  invariant(typeof collect === 'function', 'Expected \"collect\" provided as the third argument to DragSource to be ' + 'a function that returns a plain object of props to inject. ' + 'Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', collect);\n  invariant(isPlainObject(options), 'Expected \"options\" provided as the fourth argument to DragSource to be ' + 'a plain object when specified. ' + 'Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source', collect);\n  return function decorateSource(DecoratedComponent) {\n    return decorateHandler({\n      containerDisplayName: 'DragSource',\n      createHandler: createSource,\n      registerHandler: registerSource,\n      createConnector: function createConnector(backend) {\n        return new SourceConnector(backend);\n      },\n      createMonitor: function createMonitor(manager) {\n        return new DragSourceMonitorImpl(manager);\n      },\n      DecoratedComponent: DecoratedComponent,\n      getType: getType,\n      collect: collect,\n      options: options\n    });\n  };\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport { invariant } from '@react-dnd/invariant';\nimport { isPlainObject } from '../utils/js_utils';\nimport { getDecoratedComponent } from './utils';\nvar ALLOWED_SPEC_METHODS = ['canDrop', 'hover', 'drop'];\n\nvar TargetImpl = /*#__PURE__*/function () {\n  function TargetImpl(spec, monitor, ref) {\n    _classCallCheck(this, TargetImpl);\n\n    this.props = null;\n    this.spec = spec;\n    this.monitor = monitor;\n    this.ref = ref;\n  }\n\n  _createClass(TargetImpl, [{\n    key: \"receiveProps\",\n    value: function receiveProps(props) {\n      this.props = props;\n    }\n  }, {\n    key: \"receiveMonitor\",\n    value: function receiveMonitor(monitor) {\n      this.monitor = monitor;\n    }\n  }, {\n    key: \"canDrop\",\n    value: function canDrop() {\n      if (!this.spec.canDrop) {\n        return true;\n      }\n\n      return this.spec.canDrop(this.props, this.monitor);\n    }\n  }, {\n    key: \"hover\",\n    value: function hover() {\n      if (!this.spec.hover || !this.props) {\n        return;\n      }\n\n      this.spec.hover(this.props, this.monitor, getDecoratedComponent(this.ref));\n    }\n  }, {\n    key: \"drop\",\n    value: function drop() {\n      if (!this.spec.drop) {\n        return undefined;\n      }\n\n      var dropResult = this.spec.drop(this.props, this.monitor, this.ref.current);\n\n      if (process.env.NODE_ENV !== 'production') {\n        invariant(typeof dropResult === 'undefined' || isPlainObject(dropResult), 'drop() must either return undefined, or an object that represents the drop result. ' + 'Instead received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', dropResult);\n      }\n\n      return dropResult;\n    }\n  }]);\n\n  return TargetImpl;\n}();\n\nexport function createTargetFactory(spec) {\n  Object.keys(spec).forEach(function (key) {\n    invariant(ALLOWED_SPEC_METHODS.indexOf(key) > -1, 'Expected the drop target specification to only have ' + 'some of the following keys: %s. ' + 'Instead received a specification with an unexpected \"%s\" key. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', ALLOWED_SPEC_METHODS.join(', '), key);\n    invariant(typeof spec[key] === 'function', 'Expected %s in the drop target specification to be a function. ' + 'Instead received a specification with %s: %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', key, key, spec[key]);\n  });\n  return function createTarget(monitor, ref) {\n    return new TargetImpl(spec, monitor, ref);\n  };\n}","import { invariant } from '@react-dnd/invariant';\nimport { isPlainObject } from '../utils/js_utils';\nimport { registerTarget } from '../common/registration';\nimport { isValidType } from '../utils/isValidType';\nimport { TargetConnector } from '../common/TargetConnector';\nimport { DropTargetMonitorImpl } from '../common/DropTargetMonitorImpl';\nimport { checkDecoratorArguments } from './utils';\nimport { decorateHandler } from './decorateHandler';\nimport { createTargetFactory } from './createTargetFactory';\nexport function DropTarget(type, spec, collect) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  checkDecoratorArguments('DropTarget', 'type, spec, collect[, options]', type, spec, collect, options);\n  var getType = type;\n\n  if (typeof type !== 'function') {\n    invariant(isValidType(type, true), 'Expected \"type\" provided as the first argument to DropTarget to be ' + 'a string, an array of strings, or a function that returns either given ' + 'the current props. Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', type);\n\n    getType = function getType() {\n      return type;\n    };\n  }\n\n  invariant(isPlainObject(spec), 'Expected \"spec\" provided as the second argument to DropTarget to be ' + 'a plain object. Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', spec);\n  var createTarget = createTargetFactory(spec);\n  invariant(typeof collect === 'function', 'Expected \"collect\" provided as the third argument to DropTarget to be ' + 'a function that returns a plain object of props to inject. ' + 'Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', collect);\n  invariant(isPlainObject(options), 'Expected \"options\" provided as the fourth argument to DropTarget to be ' + 'a plain object when specified. ' + 'Instead, received %s. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target', collect);\n  return function decorateTarget(DecoratedComponent) {\n    return decorateHandler({\n      containerDisplayName: 'DropTarget',\n      createHandler: createTarget,\n      registerHandler: registerTarget,\n      createMonitor: function createMonitor(manager) {\n        return new DropTargetMonitorImpl(manager);\n      },\n      createConnector: function createConnector(backend) {\n        return new TargetConnector(backend);\n      },\n      DecoratedComponent: DecoratedComponent,\n      getType: getType,\n      collect: collect,\n      options: options\n    });\n  };\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport * as React from 'react';\nimport { shallowEqual } from '@react-dnd/shallowequal';\nimport hoistStatics from 'hoist-non-react-statics';\nimport { invariant } from '@react-dnd/invariant';\nimport { DndContext } from '../common/DndContext';\nimport { isPlainObject } from '../utils/js_utils';\nimport { isRefable, checkDecoratorArguments } from './utils';\nexport function DragLayer(collect) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  checkDecoratorArguments('DragLayer', 'collect[, options]', collect, options);\n  invariant(typeof collect === 'function', 'Expected \"collect\" provided as the first argument to DragLayer to be a function that collects props to inject into the component. ', 'Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer', collect);\n  invariant(isPlainObject(options), 'Expected \"options\" provided as the second argument to DragLayer to be a plain object when specified. ' + 'Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer', options);\n  return function decorateLayer(DecoratedComponent) {\n    var Decorated = DecoratedComponent;\n    var _options$arePropsEqua = options.arePropsEqual,\n        arePropsEqual = _options$arePropsEqua === void 0 ? shallowEqual : _options$arePropsEqua;\n    var displayName = Decorated.displayName || Decorated.name || 'Component';\n\n    var DragLayerContainer =\n    /** @class */\n    function () {\n      var DragLayerContainer = /*#__PURE__*/function (_React$Component) {\n        _inherits(DragLayerContainer, _React$Component);\n\n        var _super = _createSuper(DragLayerContainer);\n\n        function DragLayerContainer() {\n          var _this;\n\n          _classCallCheck(this, DragLayerContainer);\n\n          _this = _super.apply(this, arguments);\n          _this.isCurrentlyMounted = false;\n          _this.ref = React.createRef();\n\n          _this.handleChange = function () {\n            if (!_this.isCurrentlyMounted) {\n              return;\n            }\n\n            var nextState = _this.getCurrentState();\n\n            if (!shallowEqual(nextState, _this.state)) {\n              _this.setState(nextState);\n            }\n          };\n\n          return _this;\n        }\n\n        _createClass(DragLayerContainer, [{\n          key: \"getDecoratedComponentInstance\",\n          value: function getDecoratedComponentInstance() {\n            invariant(this.ref.current, 'In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()');\n            return this.ref.current;\n          }\n        }, {\n          key: \"shouldComponentUpdate\",\n          value: function shouldComponentUpdate(nextProps, nextState) {\n            return !arePropsEqual(nextProps, this.props) || !shallowEqual(nextState, this.state);\n          }\n        }, {\n          key: \"componentDidMount\",\n          value: function componentDidMount() {\n            this.isCurrentlyMounted = true;\n            this.handleChange();\n          }\n        }, {\n          key: \"componentWillUnmount\",\n          value: function componentWillUnmount() {\n            this.isCurrentlyMounted = false;\n\n            if (this.unsubscribeFromOffsetChange) {\n              this.unsubscribeFromOffsetChange();\n              this.unsubscribeFromOffsetChange = undefined;\n            }\n\n            if (this.unsubscribeFromStateChange) {\n              this.unsubscribeFromStateChange();\n              this.unsubscribeFromStateChange = undefined;\n            }\n          }\n        }, {\n          key: \"render\",\n          value: function render() {\n            var _this2 = this;\n\n            return React.createElement(DndContext.Consumer, null, function (_ref) {\n              var dragDropManager = _ref.dragDropManager;\n\n              if (dragDropManager === undefined) {\n                return null;\n              }\n\n              _this2.receiveDragDropManager(dragDropManager); // Let componentDidMount fire to initialize the collected state\n\n\n              if (!_this2.isCurrentlyMounted) {\n                return null;\n              }\n\n              return React.createElement(Decorated, Object.assign({}, _this2.props, _this2.state, {\n                ref: isRefable(Decorated) ? _this2.ref : null\n              }));\n            });\n          }\n        }, {\n          key: \"receiveDragDropManager\",\n          value: function receiveDragDropManager(dragDropManager) {\n            if (this.manager !== undefined) {\n              return;\n            }\n\n            this.manager = dragDropManager;\n            invariant(_typeof(dragDropManager) === 'object', 'Could not find the drag and drop manager in the context of %s. ' + 'Make sure to render a DndProvider component in your top-level component. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context', displayName, displayName);\n            var monitor = this.manager.getMonitor();\n            this.unsubscribeFromOffsetChange = monitor.subscribeToOffsetChange(this.handleChange);\n            this.unsubscribeFromStateChange = monitor.subscribeToStateChange(this.handleChange);\n          }\n        }, {\n          key: \"getCurrentState\",\n          value: function getCurrentState() {\n            if (!this.manager) {\n              return {};\n            }\n\n            var monitor = this.manager.getMonitor();\n            return collect(monitor, this.props);\n          }\n        }]);\n\n        return DragLayerContainer;\n      }(React.Component);\n\n      DragLayerContainer.displayName = \"DragLayer(\".concat(displayName, \")\");\n      DragLayerContainer.DecoratedComponent = DecoratedComponent;\n      return DragLayerContainer;\n    }();\n\n    return hoistStatics(DragLayerContainer, DecoratedComponent);\n  };\n}","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction componentWillMount() {\n  // Call this.constructor.gDSFP to support sub-classes.\n  var state = this.constructor.getDerivedStateFromProps(this.props, this.state);\n  if (state !== null && state !== undefined) {\n    this.setState(state);\n  }\n}\n\nfunction componentWillReceiveProps(nextProps) {\n  // Call this.constructor.gDSFP to support sub-classes.\n  // Use the setState() updater to ensure state isn't stale in certain edge cases.\n  function updater(prevState) {\n    var state = this.constructor.getDerivedStateFromProps(nextProps, prevState);\n    return state !== null && state !== undefined ? state : null;\n  }\n  // Binding \"this\" is important for shallow renderer support.\n  this.setState(updater.bind(this));\n}\n\nfunction componentWillUpdate(nextProps, nextState) {\n  try {\n    var prevProps = this.props;\n    var prevState = this.state;\n    this.props = nextProps;\n    this.state = nextState;\n    this.__reactInternalSnapshotFlag = true;\n    this.__reactInternalSnapshot = this.getSnapshotBeforeUpdate(\n      prevProps,\n      prevState\n    );\n  } finally {\n    this.props = prevProps;\n    this.state = prevState;\n  }\n}\n\n// React may warn about cWM/cWRP/cWU methods being deprecated.\n// Add a flag to suppress these warnings for this special case.\ncomponentWillMount.__suppressDeprecationWarning = true;\ncomponentWillReceiveProps.__suppressDeprecationWarning = true;\ncomponentWillUpdate.__suppressDeprecationWarning = true;\n\nfunction polyfill(Component) {\n  var prototype = Component.prototype;\n\n  if (!prototype || !prototype.isReactComponent) {\n    throw new Error('Can only polyfill class components');\n  }\n\n  if (\n    typeof Component.getDerivedStateFromProps !== 'function' &&\n    typeof prototype.getSnapshotBeforeUpdate !== 'function'\n  ) {\n    return Component;\n  }\n\n  // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\n  // Error if any of these lifecycles are present,\n  // Because they would work differently between older and newer (16.3+) versions of React.\n  var foundWillMountName = null;\n  var foundWillReceivePropsName = null;\n  var foundWillUpdateName = null;\n  if (typeof prototype.componentWillMount === 'function') {\n    foundWillMountName = 'componentWillMount';\n  } else if (typeof prototype.UNSAFE_componentWillMount === 'function') {\n    foundWillMountName = 'UNSAFE_componentWillMount';\n  }\n  if (typeof prototype.componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'componentWillReceiveProps';\n  } else if (typeof prototype.UNSAFE_componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\n  }\n  if (typeof prototype.componentWillUpdate === 'function') {\n    foundWillUpdateName = 'componentWillUpdate';\n  } else if (typeof prototype.UNSAFE_componentWillUpdate === 'function') {\n    foundWillUpdateName = 'UNSAFE_componentWillUpdate';\n  }\n  if (\n    foundWillMountName !== null ||\n    foundWillReceivePropsName !== null ||\n    foundWillUpdateName !== null\n  ) {\n    var componentName = Component.displayName || Component.name;\n    var newApiName =\n      typeof Component.getDerivedStateFromProps === 'function'\n        ? 'getDerivedStateFromProps()'\n        : 'getSnapshotBeforeUpdate()';\n\n    throw Error(\n      'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\n        componentName +\n        ' uses ' +\n        newApiName +\n        ' but also contains the following legacy lifecycles:' +\n        (foundWillMountName !== null ? '\\n  ' + foundWillMountName : '') +\n        (foundWillReceivePropsName !== null\n          ? '\\n  ' + foundWillReceivePropsName\n          : '') +\n        (foundWillUpdateName !== null ? '\\n  ' + foundWillUpdateName : '') +\n        '\\n\\nThe above lifecycles should be removed. Learn more about this warning here:\\n' +\n        'https://fb.me/react-async-component-lifecycle-hooks'\n    );\n  }\n\n  // React <= 16.2 does not support static getDerivedStateFromProps.\n  // As a workaround, use cWM and cWRP to invoke the new static lifecycle.\n  // Newer versions of React will ignore these lifecycles if gDSFP exists.\n  if (typeof Component.getDerivedStateFromProps === 'function') {\n    prototype.componentWillMount = componentWillMount;\n    prototype.componentWillReceiveProps = componentWillReceiveProps;\n  }\n\n  // React <= 16.2 does not support getSnapshotBeforeUpdate.\n  // As a workaround, use cWU to invoke the new lifecycle.\n  // Newer versions of React will ignore that lifecycle if gSBU exists.\n  if (typeof prototype.getSnapshotBeforeUpdate === 'function') {\n    if (typeof prototype.componentDidUpdate !== 'function') {\n      throw new Error(\n        'Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype'\n      );\n    }\n\n    prototype.componentWillUpdate = componentWillUpdate;\n\n    var componentDidUpdate = prototype.componentDidUpdate;\n\n    prototype.componentDidUpdate = function componentDidUpdatePolyfill(\n      prevProps,\n      prevState,\n      maybeSnapshot\n    ) {\n      // 16.3+ will not execute our will-update method;\n      // It will pass a snapshot value to did-update though.\n      // Older versions will require our polyfilled will-update value.\n      // We need to handle both cases, but can't just check for the presence of \"maybeSnapshot\",\n      // Because for <= 15.x versions this might be a \"prevContext\" object.\n      // We also can't just check \"__reactInternalSnapshot\",\n      // Because get-snapshot might return a falsy value.\n      // So check for the explicit __reactInternalSnapshotFlag flag to determine behavior.\n      var snapshot = this.__reactInternalSnapshotFlag\n        ? this.__reactInternalSnapshot\n        : maybeSnapshot;\n\n      componentDidUpdate.call(this, prevProps, prevState, snapshot);\n    };\n  }\n\n  return Component;\n}\n\nexport { polyfill };\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createFilter = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _util = require('./util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Search = function (_Component) {\n  _inherits(Search, _Component);\n\n  function Search(props) {\n    _classCallCheck(this, Search);\n\n    var _this = _possibleConstructorReturn(this, (Search.__proto__ || Object.getPrototypeOf(Search)).call(this, props));\n\n    _this.state = {\n      searchTerm: _this.props.value || ''\n    };\n    _this.updateSearch = _this.updateSearch.bind(_this);\n    _this.filter = _this.filter.bind(_this);\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (typeof nextProps.value !== 'undefined' && nextProps.value !== this.props.value) {\n        var e = {\n          target: {\n            value: nextProps.value\n          }\n        };\n        this.updateSearch(e);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          onChange = _props.onChange,\n          caseSensitive = _props.caseSensitive,\n          sortResults = _props.sortResults,\n          throttle = _props.throttle,\n          filterKeys = _props.filterKeys,\n          value = _props.value,\n          fuzzy = _props.fuzzy,\n          inputClassName = _props.inputClassName,\n          inputProps = _objectWithoutProperties(_props, ['className', 'onChange', 'caseSensitive', 'sortResults', 'throttle', 'filterKeys', 'value', 'fuzzy', 'inputClassName']); // eslint-disable-line no-unused-vars\n\n\n      inputProps.type = inputProps.type || 'search';\n      inputProps.value = this.state.searchTerm;\n      inputProps.onChange = this.updateSearch;\n      inputProps.className = inputClassName;\n      inputProps.placeholder = inputProps.placeholder || 'Search';\n      return _react2.default.createElement(\n        'div',\n        { className: className },\n        _react2.default.createElement('input', inputProps)\n      );\n    }\n  }, {\n    key: 'updateSearch',\n    value: function updateSearch(e) {\n      var _this2 = this;\n\n      var searchTerm = e.target.value;\n      this.setState({\n        searchTerm: searchTerm\n      }, function () {\n        if (_this2._throttleTimeout) {\n          clearTimeout(_this2._throttleTimeout);\n        }\n\n        _this2._throttleTimeout = setTimeout(function () {\n          return _this2.props.onChange(searchTerm);\n        }, _this2.props.throttle);\n      });\n    }\n  }, {\n    key: 'filter',\n    value: function filter(keys) {\n      var _props2 = this.props,\n          filterKeys = _props2.filterKeys,\n          caseSensitive = _props2.caseSensitive,\n          fuzzy = _props2.fuzzy,\n          sortResults = _props2.sortResults;\n\n      return (0, _util.createFilter)(this.state.searchTerm, keys || filterKeys, {\n        caseSensitive: caseSensitive,\n        fuzzy: fuzzy,\n        sortResults: sortResults\n      });\n    }\n  }]);\n\n  return Search;\n}(_react.Component);\n\nSearch.defaultProps = {\n  className: '',\n  onChange: function onChange() {},\n\n  caseSensitive: false,\n  fuzzy: false,\n  throttle: 200\n};\n\nSearch.propTypes = {\n  className: _propTypes2.default.string,\n  inputClassName: _propTypes2.default.string,\n  onChange: _propTypes2.default.func,\n  caseSensitive: _propTypes2.default.bool,\n  sortResults: _propTypes2.default.bool,\n  fuzzy: _propTypes2.default.bool,\n  throttle: _propTypes2.default.number,\n  filterKeys: _propTypes2.default.oneOf([_propTypes2.default.string, _propTypes2.default.arrayOf(_propTypes2.default.string)]),\n  value: _propTypes2.default.string\n};\n\nexports.default = Search;\nexports.createFilter = _util.createFilter;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getValuesForKey = getValuesForKey;\nexports.searchStrings = searchStrings;\nexports.createFilter = createFilter;\n\nvar _fuse = require('fuse.js');\n\nvar _fuse2 = _interopRequireDefault(_fuse);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction flatten(array) {\n  return array.reduce(function (flat, toFlatten) {\n    return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n  }, []);\n}\n\nfunction getValuesForKey(key, item) {\n  var keys = key.split('.');\n  var results = [item];\n  keys.forEach(function (_key) {\n    var tmp = [];\n    results.forEach(function (result) {\n      if (result) {\n        if (result instanceof Array) {\n          var index = parseInt(_key, 10);\n          if (!isNaN(index)) {\n            return tmp.push(result[index]);\n          }\n          result.forEach(function (res) {\n            tmp.push(res[_key]);\n          });\n        } else if (result && typeof result.get === 'function') {\n          tmp.push(result.get(_key));\n        } else {\n          tmp.push(result[_key]);\n        }\n      }\n    });\n\n    results = tmp;\n  });\n\n  // Support arrays and Immutable lists.\n  results = results.map(function (r) {\n    return r && r.push && r.toArray ? r.toArray() : r;\n  });\n  results = flatten(results);\n\n  return results.filter(function (r) {\n    return typeof r === 'string' || typeof r === 'number';\n  });\n}\n\nfunction searchStrings(strings, term) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      caseSensitive = _ref.caseSensitive,\n      fuzzy = _ref.fuzzy,\n      sortResults = _ref.sortResults,\n      exactMatch = _ref.exactMatch;\n\n  strings = strings.map(function (e) {\n    return e.toString();\n  });\n\n  try {\n    if (fuzzy) {\n      if (typeof strings.toJS === 'function') {\n        strings = strings.toJS();\n      }\n      var fuse = new _fuse2.default(strings.map(function (s) {\n        return { id: s };\n      }), { keys: ['id'], id: 'id', caseSensitive: caseSensitive, shouldSort: sortResults });\n      return fuse.search(term).length;\n    }\n    return strings.some(function (value) {\n      try {\n        if (!caseSensitive) {\n          value = value.toLowerCase();\n        }\n        if (exactMatch) {\n          term = new RegExp('^' + term + '$', 'i');\n        }\n        if (value && value.search(term) !== -1) {\n          return true;\n        }\n        return false;\n      } catch (e) {\n        return false;\n      }\n    });\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction createFilter(term, keys) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return function (item) {\n    if (term === '') {\n      return true;\n    }\n\n    if (!options.caseSensitive) {\n      term = term.toLowerCase();\n    }\n\n    var terms = term.split(' ');\n\n    if (!keys) {\n      return terms.every(function (term) {\n        return searchStrings([item], term, options);\n      });\n    }\n\n    if (typeof keys === 'string') {\n      keys = [keys];\n    }\n\n    return terms.every(function (term) {\n      // allow search in specific fields with the syntax `field:search`\n      var currentKeys = void 0;\n      if (term.indexOf(':') !== -1) {\n        var searchedField = term.split(':')[0];\n        term = term.split(':')[1];\n        currentKeys = keys.filter(function (key) {\n          return key.toLowerCase().indexOf(searchedField) > -1;\n        });\n      } else {\n        currentKeys = keys;\n      }\n\n      return currentKeys.some(function (key) {\n        var values = getValuesForKey(key, item);\n        return searchStrings(values, term, options);\n      });\n    });\n  };\n}","/*!\n * Fuse.js v3.6.1 - Lightweight fuzzy-search (http://fusejs.io)\n * \n * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)\n * All Rights Reserved. Apache Software License 2.0\n * \n * http://www.apache.org/licenses/LICENSE-2.0\n */\n!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"Fuse\",[],t):\"object\"==typeof exports?exports.Fuse=t():e.Fuse=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){function n(e){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(1),a=r(7),s=a.get,c=(a.deepValue,a.isArray),h=function(){function e(t,r){var n=r.location,o=void 0===n?0:n,i=r.distance,a=void 0===i?100:i,c=r.threshold,h=void 0===c?.6:c,l=r.maxPatternLength,u=void 0===l?32:l,f=r.caseSensitive,v=void 0!==f&&f,p=r.tokenSeparator,d=void 0===p?/ +/g:p,g=r.findAllMatches,y=void 0!==g&&g,m=r.minMatchCharLength,k=void 0===m?1:m,b=r.id,S=void 0===b?null:b,x=r.keys,M=void 0===x?[]:x,_=r.shouldSort,w=void 0===_||_,L=r.getFn,A=void 0===L?s:L,O=r.sortFn,C=void 0===O?function(e,t){return e.score-t.score}:O,j=r.tokenize,P=void 0!==j&&j,I=r.matchAllTokens,F=void 0!==I&&I,T=r.includeMatches,N=void 0!==T&&T,z=r.includeScore,E=void 0!==z&&z,W=r.verbose,K=void 0!==W&&W;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:a,threshold:h,maxPatternLength:u,isCaseSensitive:v,tokenSeparator:d,findAllMatches:y,minMatchCharLength:k,id:S,keys:M,includeMatches:N,includeScore:E,shouldSort:w,getFn:A,sortFn:C,verbose:K,tokenize:P,matchAllTokens:F},this.setCollection(t),this._processKeys(M)}var t,r,a;return t=e,(r=[{key:\"setCollection\",value:function(e){return this.list=e,e}},{key:\"_processKeys\",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&\"string\"==typeof e[0])for(var t=0,r=e.length;t<r;t+=1){var n=e[t];this._keyWeights[n]=1,this._keyNames.push(n)}else{for(var o=null,i=null,a=0,s=0,c=e.length;s<c;s+=1){var h=e[s];if(!h.hasOwnProperty(\"name\"))throw new Error('Missing \"name\" property in key object');var l=h.name;if(this._keyNames.push(l),!h.hasOwnProperty(\"weight\"))throw new Error('Missing \"weight\" property in key object');var u=h.weight;if(u<0||u>1)throw new Error('\"weight\" property in key must bein the range of [0, 1)');i=null==i?u:Math.max(i,u),o=null==o?u:Math.min(o,u),this._keyWeights[l]=u,a+=u}if(a>1)throw new Error(\"Total of weights cannot exceed 1\")}}},{key:\"search\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\\nSearch pattern: \"'.concat(e,'\"'));var r=this._prepareSearchers(e),n=r.tokenSearchers,o=r.fullSearcher,i=this._search(n,o);return this._computeScore(i),this.options.shouldSort&&this._sort(i),t.limit&&\"number\"==typeof t.limit&&(i=i.slice(0,t.limit)),this._format(i)}},{key:\"_prepareSearchers\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",t=[];if(this.options.tokenize)for(var r=e.split(this.options.tokenSeparator),n=0,o=r.length;n<o;n+=1)t.push(new i(r[n],this.options));return{tokenSearchers:t,fullSearcher:new i(e,this.options)}}},{key:\"_search\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=this.list,n={},o=[];if(\"string\"==typeof r[0]){for(var i=0,a=r.length;i<a;i+=1)this._analyze({key:\"\",value:r[i],record:i,index:i},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t});return o}for(var s=0,c=r.length;s<c;s+=1)for(var h=r[s],l=0,u=this._keyNames.length;l<u;l+=1){var f=this._keyNames[l];this._analyze({key:f,value:this.options.getFn(h,f),record:h,index:s},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t})}return o}},{key:\"_analyze\",value:function(e,t){var r=this,n=e.key,o=e.arrayIndex,i=void 0===o?-1:o,a=e.value,s=e.record,h=e.index,l=t.tokenSearchers,u=void 0===l?[]:l,f=t.fullSearcher,v=t.resultMap,p=void 0===v?{}:v,d=t.results,g=void 0===d?[]:d;!function e(t,o,i,a){if(null!=o)if(\"string\"==typeof o){var s=!1,h=-1,l=0;r._log(\"\\nKey: \".concat(\"\"===n?\"--\":n));var v=f.search(o);if(r._log('Full text: \"'.concat(o,'\", score: ').concat(v.score)),r.options.tokenize){for(var d=o.split(r.options.tokenSeparator),y=d.length,m=[],k=0,b=u.length;k<b;k+=1){var S=u[k];r._log('\\nPattern: \"'.concat(S.pattern,'\"'));for(var x=!1,M=0;M<y;M+=1){var _=d[M],w=S.search(_),L={};w.isMatch?(L[_]=w.score,s=!0,x=!0,m.push(w.score)):(L[_]=1,r.options.matchAllTokens||m.push(1)),r._log('Token: \"'.concat(_,'\", score: ').concat(L[_]))}x&&(l+=1)}h=m[0];for(var A=m.length,O=1;O<A;O+=1)h+=m[O];h/=A,r._log(\"Token score average:\",h)}var C=v.score;h>-1&&(C=(C+h)/2),r._log(\"Score average:\",C);var j=!r.options.tokenize||!r.options.matchAllTokens||l>=u.length;if(r._log(\"\\nCheck Matches: \".concat(j)),(s||v.isMatch)&&j){var P={key:n,arrayIndex:t,value:o,score:C};r.options.includeMatches&&(P.matchedIndices=v.matchedIndices);var I=p[a];I?I.output.push(P):(p[a]={item:i,output:[P]},g.push(p[a]))}}else if(c(o))for(var F=0,T=o.length;F<T;F+=1)e(F,o[F],i,a)}(i,a,s,h)}},{key:\"_computeScore\",value:function(e){this._log(\"\\n\\nComputing score:\\n\");for(var t=this._keyWeights,r=!!Object.keys(t).length,n=0,o=e.length;n<o;n+=1){for(var i=e[n],a=i.output,s=a.length,c=1,h=0;h<s;h+=1){var l=a[h],u=l.key,f=r?t[u]:1,v=0===l.score&&t&&t[u]>0?Number.EPSILON:l.score;c*=Math.pow(v,f)}i.score=c,this._log(i)}}},{key:\"_sort\",value:function(e){this._log(\"\\n\\nSorting....\"),e.sort(this.options.sortFn)}},{key:\"_format\",value:function(e){var t=[];if(this.options.verbose){var r=[];this._log(\"\\n\\nOutput:\\n\\n\",JSON.stringify(e,function(e,t){if(\"object\"===n(t)&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t},2)),r=null}var o=[];this.options.includeMatches&&o.push(function(e,t){var r=e.output;t.matches=[];for(var n=0,o=r.length;n<o;n+=1){var i=r[n];if(0!==i.matchedIndices.length){var a={indices:i.matchedIndices,value:i.value};i.key&&(a.key=i.key),i.hasOwnProperty(\"arrayIndex\")&&i.arrayIndex>-1&&(a.arrayIndex=i.arrayIndex),t.matches.push(a)}}}),this.options.includeScore&&o.push(function(e,t){t.score=e.score});for(var i=0,a=e.length;i<a;i+=1){var s=e[i];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),o.length){for(var c={item:s.item},h=0,l=o.length;h<l;h+=1)o[h](s,c);t.push(c)}else t.push(s.item)}return t}},{key:\"_log\",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(t.prototype,r),a&&o(t,a),e}();e.exports=h},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),i=r(3),a=r(6),s=function(){function e(t,r){var n=r.location,o=void 0===n?0:n,i=r.distance,s=void 0===i?100:i,c=r.threshold,h=void 0===c?.6:c,l=r.maxPatternLength,u=void 0===l?32:l,f=r.isCaseSensitive,v=void 0!==f&&f,p=r.tokenSeparator,d=void 0===p?/ +/g:p,g=r.findAllMatches,y=void 0!==g&&g,m=r.minMatchCharLength,k=void 0===m?1:m,b=r.includeMatches,S=void 0!==b&&b;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:v,tokenSeparator:d,findAllMatches:y,includeMatches:S,minMatchCharLength:k},this.pattern=v?t:t.toLowerCase(),this.pattern.length<=u&&(this.patternAlphabet=a(this.pattern))}var t,r,s;return t=e,(r=[{key:\"search\",value:function(e){var t=this.options,r=t.isCaseSensitive,n=t.includeMatches;if(r||(e=e.toLowerCase()),this.pattern===e){var a={isMatch:!0,score:0};return n&&(a.matchedIndices=[[0,e.length-1]]),a}var s=this.options,c=s.maxPatternLength,h=s.tokenSeparator;if(this.pattern.length>c)return o(e,this.pattern,h);var l=this.options,u=l.location,f=l.distance,v=l.threshold,p=l.findAllMatches,d=l.minMatchCharLength;return i(e,this.pattern,this.patternAlphabet,{location:u,distance:f,threshold:v,findAllMatches:p,minMatchCharLength:d,includeMatches:n})}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},function(e,t){var r=/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g;e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(r,\"\\\\$&\").replace(n,\"|\")),i=e.match(o),a=!!i,s=[];if(a)for(var c=0,h=i.length;c<h;c+=1){var l=i[c];s.push([e.indexOf(l),l.length-1])}return{score:a?.5:1,isMatch:a,matchedIndices:s}}},function(e,t,r){var n=r(4),o=r(5);e.exports=function(e,t,r,i){for(var a=i.location,s=void 0===a?0:a,c=i.distance,h=void 0===c?100:c,l=i.threshold,u=void 0===l?.6:l,f=i.findAllMatches,v=void 0!==f&&f,p=i.minMatchCharLength,d=void 0===p?1:p,g=i.includeMatches,y=void 0!==g&&g,m=s,k=e.length,b=u,S=e.indexOf(t,m),x=t.length,M=[],_=0;_<k;_+=1)M[_]=0;if(-1!==S){var w=n(t,{errors:0,currentLocation:S,expectedLocation:m,distance:h});if(b=Math.min(w,b),-1!==(S=e.lastIndexOf(t,m+x))){var L=n(t,{errors:0,currentLocation:S,expectedLocation:m,distance:h});b=Math.min(L,b)}}S=-1;for(var A=[],O=1,C=x+k,j=1<<(x<=31?x-1:30),P=0;P<x;P+=1){for(var I=0,F=C;I<F;){n(t,{errors:P,currentLocation:m+F,expectedLocation:m,distance:h})<=b?I=F:C=F,F=Math.floor((C-I)/2+I)}C=F;var T=Math.max(1,m-F+1),N=v?k:Math.min(m+F,k)+x,z=Array(N+2);z[N+1]=(1<<P)-1;for(var E=N;E>=T;E-=1){var W=E-1,K=r[e.charAt(W)];if(K&&(M[W]=1),z[E]=(z[E+1]<<1|1)&K,0!==P&&(z[E]|=(A[E+1]|A[E])<<1|1|A[E+1]),z[E]&j&&(O=n(t,{errors:P,currentLocation:W,expectedLocation:m,distance:h}))<=b){if(b=O,(S=W)<=m)break;T=Math.max(1,2*m-S)}}if(n(t,{errors:P+1,currentLocation:m,expectedLocation:m,distance:h})>b)break;A=z}var $={isMatch:S>=0,score:0===O?.001:O};return y&&($.matchedIndices=o(M,d)),$}},function(e,t){e.exports=function(e,t){var r=t.errors,n=void 0===r?0:r,o=t.currentLocation,i=void 0===o?0:o,a=t.expectedLocation,s=void 0===a?0:a,c=t.distance,h=void 0===c?100:c,l=n/e.length,u=Math.abs(s-i);return h?l+u/h:u?1:l}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[],n=-1,o=-1,i=0,a=e.length;i<a;i+=1){var s=e[i];s&&-1===n?n=i:s||-1===n||((o=i-1)-n+1>=t&&r.push([n,o]),n=-1)}return e[i-1]&&i-n>=t&&r.push([n,i-1]),r}},function(e,t){e.exports=function(e){for(var t={},r=e.length,n=0;n<r;n+=1)t[e.charAt(n)]=0;for(var o=0;o<r;o+=1)t[e.charAt(o)]|=1<<r-o-1;return t}},function(e,t){var r=function(e){return Array.isArray?Array.isArray(e):\"[object Array]\"===Object.prototype.toString.call(e)},n=function(e){return null==e?\"\":function(e){if(\"string\"==typeof e)return e;var t=e+\"\";return\"0\"==t&&1/e==-1/0?\"-0\":t}(e)},o=function(e){return\"string\"==typeof e},i=function(e){return\"number\"==typeof e};e.exports={get:function(e,t){var a=[];return function e(t,s){if(s){var c=s.indexOf(\".\"),h=s,l=null;-1!==c&&(h=s.slice(0,c),l=s.slice(c+1));var u=t[h];if(null!=u)if(l||!o(u)&&!i(u))if(r(u))for(var f=0,v=u.length;f<v;f+=1)e(u[f],l);else l&&e(u,l);else a.push(n(u))}else a.push(t)}(e,t),a},isArray:r,isString:o,isNum:i,toString:n}}])});","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _raf = require(\"raf\");\n\nvar _raf2 = _interopRequireDefault(_raf);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Container = function (_PureComponent) {\n  _inherits(Container, _PureComponent);\n\n  function Container() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Container);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Container.__proto__ || Object.getPrototypeOf(Container)).call.apply(_ref, [this].concat(args))), _this), _this.events = [\"resize\", \"scroll\", \"touchstart\", \"touchmove\", \"touchend\", \"pageshow\", \"load\"], _this.subscribers = [], _this.rafHandle = null, _this.subscribe = function (handler) {\n      _this.subscribers = _this.subscribers.concat(handler);\n    }, _this.unsubscribe = function (handler) {\n      _this.subscribers = _this.subscribers.filter(function (current) {\n        return current !== handler;\n      });\n    }, _this.notifySubscribers = function (evt) {\n      if (!_this.framePending) {\n        var currentTarget = evt.currentTarget;\n\n\n        _this.rafHandle = (0, _raf2.default)(function () {\n          _this.framePending = false;\n\n          var _this$node$getBoundin = _this.node.getBoundingClientRect(),\n              top = _this$node$getBoundin.top,\n              bottom = _this$node$getBoundin.bottom;\n\n          _this.subscribers.forEach(function (handler) {\n            return handler({\n              distanceFromTop: top,\n              distanceFromBottom: bottom,\n              eventSource: currentTarget === window ? document.body : _this.node\n            });\n          });\n        });\n        _this.framePending = true;\n      }\n    }, _this.getParent = function () {\n      return _this.node;\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Container, [{\n    key: \"getChildContext\",\n    value: function getChildContext() {\n      return {\n        subscribe: this.subscribe,\n        unsubscribe: this.unsubscribe,\n        getParent: this.getParent\n      };\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.events.forEach(function (event) {\n        return window.addEventListener(event, _this2.notifySubscribers);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this3 = this;\n\n      if (this.rafHandle) {\n        _raf2.default.cancel(this.rafHandle);\n        this.rafHandle = null;\n      }\n\n      this.events.forEach(function (event) {\n        return window.removeEventListener(event, _this3.notifySubscribers);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return _react2.default.createElement(\"div\", _extends({}, this.props, {\n        ref: function ref(node) {\n          return _this4.node = node;\n        },\n        onScroll: this.notifySubscribers,\n        onTouchStart: this.notifySubscribers,\n        onTouchMove: this.notifySubscribers,\n        onTouchEnd: this.notifySubscribers\n      }));\n    }\n  }]);\n\n  return Container;\n}(_react.PureComponent);\n\nContainer.childContextTypes = {\n  subscribe: _propTypes2.default.func,\n  unsubscribe: _propTypes2.default.func,\n  getParent: _propTypes2.default.func\n};\nexports.default = Container;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Sticky = function (_Component) {\n  _inherits(Sticky, _Component);\n\n  function Sticky() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Sticky);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Sticky.__proto__ || Object.getPrototypeOf(Sticky)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      isSticky: false,\n      wasSticky: false,\n      style: {}\n    }, _this.handleContainerEvent = function (_ref2) {\n      var distanceFromTop = _ref2.distanceFromTop,\n          distanceFromBottom = _ref2.distanceFromBottom,\n          eventSource = _ref2.eventSource;\n\n      var parent = _this.context.getParent();\n\n      var preventingStickyStateChanges = false;\n      if (_this.props.relative) {\n        preventingStickyStateChanges = eventSource !== parent;\n        distanceFromTop = -(eventSource.scrollTop + eventSource.offsetTop) + _this.placeholder.offsetTop;\n      }\n\n      var placeholderClientRect = _this.placeholder.getBoundingClientRect();\n      var contentClientRect = _this.content.getBoundingClientRect();\n      var calculatedHeight = contentClientRect.height;\n\n      var bottomDifference = distanceFromBottom - _this.props.bottomOffset - calculatedHeight;\n\n      var wasSticky = !!_this.state.isSticky;\n      var isSticky = preventingStickyStateChanges ? wasSticky : distanceFromTop <= -_this.props.topOffset && distanceFromBottom > -_this.props.bottomOffset;\n\n      distanceFromBottom = (_this.props.relative ? parent.scrollHeight - parent.scrollTop : distanceFromBottom) - calculatedHeight;\n\n      var style = !isSticky ? {} : {\n        position: \"fixed\",\n        top: bottomDifference > 0 ? _this.props.relative ? parent.offsetTop - parent.offsetParent.scrollTop : 0 : bottomDifference,\n        left: placeholderClientRect.left,\n        width: placeholderClientRect.width\n      };\n\n      if (!_this.props.disableHardwareAcceleration) {\n        style.transform = \"translateZ(0)\";\n      }\n\n      _this.setState({\n        isSticky: isSticky,\n        wasSticky: wasSticky,\n        distanceFromTop: distanceFromTop,\n        distanceFromBottom: distanceFromBottom,\n        calculatedHeight: calculatedHeight,\n        style: style\n      });\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Sticky, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      if (!this.context.subscribe) throw new TypeError(\"Expected Sticky to be mounted within StickyContainer\");\n\n      this.context.subscribe(this.handleContainerEvent);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.context.unsubscribe(this.handleContainerEvent);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.placeholder.style.paddingBottom = this.props.disableCompensation ? 0 : (this.state.isSticky ? this.state.calculatedHeight : 0) + \"px\";\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var element = _react2.default.cloneElement(this.props.children({\n        isSticky: this.state.isSticky,\n        wasSticky: this.state.wasSticky,\n        distanceFromTop: this.state.distanceFromTop,\n        distanceFromBottom: this.state.distanceFromBottom,\n        calculatedHeight: this.state.calculatedHeight,\n        style: this.state.style\n      }), {\n        ref: function ref(content) {\n          _this2.content = _reactDom2.default.findDOMNode(content);\n        }\n      });\n\n      return _react2.default.createElement(\n        \"div\",\n        null,\n        _react2.default.createElement(\"div\", { ref: function ref(placeholder) {\n            return _this2.placeholder = placeholder;\n          } }),\n        element\n      );\n    }\n  }]);\n\n  return Sticky;\n}(_react.Component);\n\nSticky.propTypes = {\n  topOffset: _propTypes2.default.number,\n  bottomOffset: _propTypes2.default.number,\n  relative: _propTypes2.default.bool,\n  children: _propTypes2.default.func.isRequired\n};\nSticky.defaultProps = {\n  relative: false,\n  topOffset: 0,\n  bottomOffset: 0,\n  disableCompensation: false,\n  disableHardwareAcceleration: false\n};\nSticky.contextTypes = {\n  subscribe: _propTypes2.default.func,\n  unsubscribe: _propTypes2.default.func,\n  getParent: _propTypes2.default.func\n};\nexports.default = Sticky;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.StickyContainer = exports.Sticky = undefined;\n\nvar _Sticky = require(\"./Sticky\");\n\nvar _Sticky2 = _interopRequireDefault(_Sticky);\n\nvar _Container = require(\"./Container\");\n\nvar _Container2 = _interopRequireDefault(_Container);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.Sticky = _Sticky2.default;\nexports.StickyContainer = _Container2.default;\nexports.default = _Sticky2.default;","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * A Registry which serves as a typed key:value store for Superset and for Plugins.\n *\n * Differences from the older Registry class:\n *\n * 1. The keys and values stored in this class are individually typed by TYPEMAP parameter.\n *    In the old Registry, all values are of the same type and keys are not enumerated.\n *    Though you can also use indexed or mapped types in a TYPEMAP.\n *\n * 2. This class does not have a separate async get and set methods or use loaders.\n *    Instead, TYPEMAP should specify async values and loaders explicitly when needed.\n *    The value can be anything! A string, a class, a function, an async function... anything!\n *\n * 3. This class does not implement Policies, that is a separate concern to be handled elsewhere.\n *\n *\n * Removing or altering types in a type map could be a potential breaking change, be careful!\n *\n * Listener methods have not been added because there isn't a use case yet.\n */\nclass TypedRegistry<TYPEMAP extends {}> {\n  name = 'TypedRegistry';\n\n  private records: TYPEMAP;\n\n  constructor(initialRecords: TYPEMAP) {\n    this.records = initialRecords;\n  }\n\n  get<K extends keyof TYPEMAP>(key: K): TYPEMAP[K] {\n    // The type construction above means that when you call this function,\n    // you get a really specific type back.\n    return this.records[key];\n  }\n\n  set<K extends keyof TYPEMAP>(key: K, value: TYPEMAP[K]) {\n    this.records[key] = value;\n  }\n}\n\nexport default TypedRegistry;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { TypedRegistry } from '../models';\nimport { makeSingleton } from '../utils';\n\n/** A function (or component) which returns text (or marked-up text) */\ntype UiGeneratorText<P = void> = (props: P) => string | React.ReactElement;\n\n/**\n * This type defines all the UI override options which replace elements of Superset's default UI.\n * Idea with the keys here is generally to namespace following the form of 'domain.functonality.item'\n *\n * When defining a new option here, take care to keep any parameters to functions (or components) minimal.\n * Any removal or alteration to a parameter will be considered a breaking change.\n */\nexport type UiOverrides = Partial<{\n  'embedded.documentation.description': UiGeneratorText;\n  'embedded.documentation.url': string;\n}>;\n\n/**\n * A registry containing UI customizations to replace elements of Superset's default UI.\n */\nclass UiOverrideRegistry extends TypedRegistry<UiOverrides> {\n  name = 'UiOverrideRegistry';\n}\n\nexport const getUiOverrideRegistry = makeSingleton(UiOverrideRegistry, {});\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState, useRef } from 'react';\nimport cx from 'classnames';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Tooltip } from 'src/components/Tooltip';\nimport CertifiedBadge from '../CertifiedBadge';\n\nexport interface EditableTitleProps {\n  canEdit?: boolean;\n  editing?: boolean;\n  emptyText?: string;\n  extraClasses?: Array<string> | string;\n  multiLine?: boolean;\n  noPermitTooltip?: string;\n  onSaveTitle: (arg0: string) => void;\n  showTooltip?: boolean;\n  style?: object;\n  title?: string;\n  defaultTitle?: string;\n  placeholder?: string;\n  certifiedBy?: string;\n  certificationDetails?: string;\n  onClickTitle?: () => void;\n}\n\nconst StyledCertifiedBadge = styled(CertifiedBadge)`\n  vertical-align: middle;\n`;\n\nexport default function EditableTitle({\n  canEdit = false,\n  editing = false,\n  extraClasses,\n  multiLine = false,\n  noPermitTooltip,\n  onSaveTitle,\n  showTooltip = true,\n  style,\n  title = '',\n  defaultTitle = '',\n  placeholder = '',\n  certifiedBy,\n  certificationDetails,\n  onClickTitle,\n  // rest is related to title tooltip\n  ...rest\n}: EditableTitleProps) {\n  const [isEditing, setIsEditing] = useState(editing);\n  const [currentTitle, setCurrentTitle] = useState(title);\n  const [lastTitle, setLastTitle] = useState(title);\n  const [contentBoundingRect, setContentBoundingRect] =\n    useState<DOMRect | null>(null);\n  // Used so we can access the DOM element if a user clicks on this component.\n\n  const contentRef = useRef<any | HTMLInputElement | HTMLTextAreaElement>();\n\n  useEffect(() => {\n    if (title !== currentTitle) {\n      setLastTitle(currentTitle);\n      setCurrentTitle(title);\n    }\n  }, [title]);\n\n  useEffect(() => {\n    if (isEditing) {\n      contentRef.current.focus();\n      // move cursor and scroll to the end\n      if (contentRef.current.setSelectionRange) {\n        const { length } = contentRef.current.value;\n        contentRef.current.setSelectionRange(length, length);\n        contentRef.current.scrollLeft = contentRef.current.scrollWidth;\n        contentRef.current.scrollTop = contentRef.current.scrollHeight;\n      }\n    }\n  }, [isEditing]);\n\n  function handleClick() {\n    if (!canEdit || isEditing) {\n      return;\n    }\n\n    // For multi-line values, save the actual rendered size of the displayed text.\n    // Later, if a textarea is constructed for editing the value, we'll need this.\n    const contentBounding = contentRef.current\n      ? contentRef.current.getBoundingClientRect()\n      : null;\n    setIsEditing(true);\n    setContentBoundingRect(contentBounding);\n  }\n\n  function handleBlur() {\n    const formattedTitle = currentTitle.trim();\n\n    if (!canEdit) {\n      return;\n    }\n\n    setIsEditing(false);\n\n    if (!formattedTitle.length) {\n      setCurrentTitle(lastTitle);\n      return;\n    }\n\n    if (lastTitle !== formattedTitle) {\n      setLastTitle(formattedTitle);\n    }\n\n    if (title !== formattedTitle) {\n      onSaveTitle(formattedTitle);\n    }\n  }\n\n  // tl;dr when a EditableTitle is being edited, typically the Tab that wraps it has been\n  // clicked and is focused/active. For accessibility, when the focused tab anchor intercepts\n  // the ' ' key (among others, including all arrows) the onChange() doesn't fire. Somehow\n  // keydown is still called so we can detect this and manually add a ' ' to the current title\n  function handleKeyDown(event: any) {\n    if (event.key === ' ') {\n      event.stopPropagation();\n    }\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      handleBlur();\n    }\n  }\n\n  function handleChange(ev: any) {\n    if (!canEdit) {\n      return;\n    }\n    setCurrentTitle(ev.target.value);\n  }\n\n  function handleKeyPress(ev: any) {\n    if (ev.key === 'Enter') {\n      ev.preventDefault();\n      handleBlur();\n    }\n  }\n\n  let value: string | undefined;\n  value = currentTitle;\n  if (!isEditing && !currentTitle) {\n    value = defaultTitle || title;\n  }\n\n  // Construct an inline style based on previously-saved height of the rendered label. Only\n  // used in multi-line contexts.\n  const editStyle =\n    isEditing && contentBoundingRect\n      ? { height: `${contentBoundingRect.height}px` }\n      : undefined;\n\n  // Create a textarea when we're editing a multi-line value, otherwise create an input (which may\n  // be text or a button).\n  let titleComponent =\n    multiLine && isEditing ? (\n      <textarea\n        data-test=\"editable-title-input\"\n        ref={contentRef}\n        value={value}\n        className={!title ? 'text-muted' : undefined}\n        onKeyDown={handleKeyDown}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        onClick={handleClick}\n        onKeyPress={handleKeyPress}\n        placeholder={placeholder}\n        style={editStyle}\n      />\n    ) : (\n      <input\n        data-test=\"editable-title-input\"\n        ref={contentRef}\n        type={isEditing ? 'text' : 'button'}\n        value={value}\n        className={!title ? 'text-muted' : undefined}\n        onKeyDown={handleKeyDown}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        onClick={handleClick}\n        onKeyPress={handleKeyPress}\n        placeholder={placeholder}\n      />\n    );\n  if (showTooltip && !isEditing) {\n    titleComponent = (\n      <Tooltip\n        id=\"title-tooltip\"\n        title={\n          canEdit\n            ? t('Click to edit')\n            : noPermitTooltip ||\n              t(\"You don't have the rights to alter this title.\")\n        }\n      >\n        {titleComponent}\n      </Tooltip>\n    );\n  }\n  if (!canEdit) {\n    // don't actually want an input in this case\n    titleComponent = onClickTitle ? (\n      <span\n        role=\"button\"\n        onClick={onClickTitle}\n        tabIndex={0}\n        data-test=\"editable-title-input\"\n        css={css`\n          :hover {\n            text-decoration: underline;\n          }\n        `}\n      >\n        {value}\n      </span>\n    ) : (\n      <span data-test=\"editable-title-input\">{value}</span>\n    );\n  }\n  return (\n    <span\n      data-test=\"editable-title\"\n      className={cx(\n        'editable-title',\n        extraClasses,\n        canEdit && 'editable-title--editable',\n        isEditing && 'editable-title--editing',\n      )}\n      style={style}\n      {...rest}\n    >\n      {certifiedBy && (\n        <>\n          <StyledCertifiedBadge\n            certifiedBy={certifiedBy}\n            details={certificationDetails}\n            size=\"xl\"\n          />{' '}\n        </>\n      )}\n      {titleComponent}\n    </span>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { CHART_TYPE } from './componentTypes';\n\nexport default function getChartIdsFromLayout(layout) {\n  return Object.values(layout).reduce((chartIds, currentComponent) => {\n    if (\n      currentComponent &&\n      currentComponent.type === CHART_TYPE &&\n      currentComponent.meta &&\n      currentComponent.meta.chartId\n    ) {\n      chartIds.push(currentComponent.meta.chartId);\n    }\n    return chartIds;\n  }, []);\n}\n","import _pt from \"prop-types\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport debounce from 'lodash/debounce';\nimport React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nvar ParentSize =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(ParentSize, _React$Component);\n\n  function ParentSize(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"animationFrameID\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"resizeObserver\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"target\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"resize\", function (_ref) {\n      var width = _ref.width,\n          height = _ref.height,\n          top = _ref.top,\n          left = _ref.left;\n\n      _this.setState(function () {\n        return {\n          width: width,\n          height: height,\n          top: top,\n          left: left\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setTarget\", function (ref) {\n      _this.target = ref;\n    });\n\n    _this.state = {\n      width: 0,\n      height: 0,\n      top: 0,\n      left: 0\n    };\n    _this.resize = debounce(_this.resize, props.debounceTime);\n    _this.animationFrameID = null;\n    return _this;\n  }\n\n  var _proto = ParentSize.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    this.resizeObserver = new ResizeObserver(function (entries\n    /** , observer */\n    ) {\n      if (entries === void 0) {\n        entries = [];\n      }\n\n      entries.forEach(function (entry) {\n        var _entry$contentRect = entry.contentRect,\n            left = _entry$contentRect.left,\n            top = _entry$contentRect.top,\n            width = _entry$contentRect.width,\n            height = _entry$contentRect.height;\n        _this2.animationFrameID = window.requestAnimationFrame(function () {\n          _this2.resize({\n            width: width,\n            height: height,\n            top: top,\n            left: left\n          });\n        });\n      });\n    });\n    if (this.target) this.resizeObserver.observe(this.target);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.animationFrameID) window.cancelAnimationFrame(this.animationFrameID);\n    if (this.resizeObserver) this.resizeObserver.disconnect();\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        className = _this$props.className,\n        children = _this$props.children,\n        debounceTime = _this$props.debounceTime,\n        parentSizeStyles = _this$props.parentSizeStyles,\n        restProps = _objectWithoutPropertiesLoose(_this$props, [\"className\", \"children\", \"debounceTime\", \"parentSizeStyles\"]);\n\n    return React.createElement(\"div\", _extends({\n      style: parentSizeStyles,\n      ref: this.setTarget,\n      className: className\n    }, restProps), children(_extends({}, this.state, {\n      ref: this.target,\n      resize: this.resize\n    })));\n  };\n\n  return ParentSize;\n}(React.Component);\n\n_defineProperty(ParentSize, \"propTypes\", {\n  className: _pt.string,\n  debounceTime: _pt.number,\n  children: _pt.func.isRequired\n});\n\n_defineProperty(ParentSize, \"defaultProps\", {\n  debounceTime: 300,\n  parentSizeStyles: {\n    width: '100%',\n    height: '100%'\n  }\n});\n\nexport { ParentSize as default };","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getOwnPropertyDescriptor from 'babel-runtime/core-js/object/get-own-property-descriptor';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport Grid, { accessibilityOverscanIndicesGetter } from '../Grid';\nimport * as React from 'react';\nimport cn from 'classnames';\n\n/**\n * It is inefficient to create and manage a large list of DOM elements within a scrolling container\n * if only a few of those elements are visible. The primary purpose of this component is to improve\n * performance by only rendering the DOM nodes that a user is able to see based on their current\n * scroll position.\n *\n * This component renders a virtualized list of elements with either fixed or dynamic heights.\n */\n\nvar List = function (_React$PureComponent) {\n  _inherits(List, _React$PureComponent);\n\n  function List() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, List);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = List.__proto__ || _Object$getPrototypeOf(List)).call.apply(_ref, [this].concat(args))), _this), _this._cellRenderer = function (_ref2) {\n      var parent = _ref2.parent,\n          rowIndex = _ref2.rowIndex,\n          style = _ref2.style,\n          isScrolling = _ref2.isScrolling,\n          isVisible = _ref2.isVisible,\n          key = _ref2.key;\n      var rowRenderer = _this.props.rowRenderer;\n\n      // TRICKY The style object is sometimes cached by Grid.\n      // This prevents new style objects from bypassing shallowCompare().\n      // However as of React 16, style props are auto-frozen (at least in dev mode)\n      // Check to make sure we can still modify the style before proceeding.\n      // https://github.com/facebook/react/commit/977357765b44af8ff0cfea327866861073095c12#commitcomment-20648713\n\n      var _Object$getOwnPropert = _Object$getOwnPropertyDescriptor(style, 'width'),\n          writable = _Object$getOwnPropert.writable;\n\n      if (writable) {\n        // By default, List cells should be 100% width.\n        // This prevents them from flowing under a scrollbar (if present).\n        style.width = '100%';\n      }\n\n      return rowRenderer({\n        index: rowIndex,\n        style: style,\n        isScrolling: isScrolling,\n        isVisible: isVisible,\n        key: key,\n        parent: parent\n      });\n    }, _this._setRef = function (ref) {\n      _this.Grid = ref;\n    }, _this._onScroll = function (_ref3) {\n      var clientHeight = _ref3.clientHeight,\n          scrollHeight = _ref3.scrollHeight,\n          scrollTop = _ref3.scrollTop;\n      var onScroll = _this.props.onScroll;\n\n\n      onScroll({ clientHeight: clientHeight, scrollHeight: scrollHeight, scrollTop: scrollTop });\n    }, _this._onSectionRendered = function (_ref4) {\n      var rowOverscanStartIndex = _ref4.rowOverscanStartIndex,\n          rowOverscanStopIndex = _ref4.rowOverscanStopIndex,\n          rowStartIndex = _ref4.rowStartIndex,\n          rowStopIndex = _ref4.rowStopIndex;\n      var onRowsRendered = _this.props.onRowsRendered;\n\n\n      onRowsRendered({\n        overscanStartIndex: rowOverscanStartIndex,\n        overscanStopIndex: rowOverscanStopIndex,\n        startIndex: rowStartIndex,\n        stopIndex: rowStopIndex\n      });\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(List, [{\n    key: 'forceUpdateGrid',\n    value: function forceUpdateGrid() {\n      if (this.Grid) {\n        this.Grid.forceUpdate();\n      }\n    }\n\n    /** See Grid#getOffsetForCell */\n\n  }, {\n    key: 'getOffsetForRow',\n    value: function getOffsetForRow(_ref5) {\n      var alignment = _ref5.alignment,\n          index = _ref5.index;\n\n      if (this.Grid) {\n        var _Grid$getOffsetForCel = this.Grid.getOffsetForCell({\n          alignment: alignment,\n          rowIndex: index,\n          columnIndex: 0\n        }),\n            _scrollTop = _Grid$getOffsetForCel.scrollTop;\n\n        return _scrollTop;\n      }\n      return 0;\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender(_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex;\n\n      if (this.Grid) {\n        this.Grid.invalidateCellSizeAfterRender({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#measureAllCells */\n\n  }, {\n    key: 'measureAllRows',\n    value: function measureAllRows() {\n      if (this.Grid) {\n        this.Grid.measureAllCells();\n      }\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'recomputeGridSize',\n    value: function recomputeGridSize() {\n      var _ref7 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref7$columnIndex = _ref7.columnIndex,\n          columnIndex = _ref7$columnIndex === undefined ? 0 : _ref7$columnIndex,\n          _ref7$rowIndex = _ref7.rowIndex,\n          rowIndex = _ref7$rowIndex === undefined ? 0 : _ref7$rowIndex;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#recomputeGridSize */\n\n  }, {\n    key: 'recomputeRowHeights',\n    value: function recomputeRowHeights() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: index,\n          columnIndex: 0\n        });\n      }\n    }\n\n    /** See Grid#scrollToPosition */\n\n  }, {\n    key: 'scrollToPosition',\n    value: function scrollToPosition() {\n      var scrollTop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToPosition({ scrollTop: scrollTop });\n      }\n    }\n\n    /** See Grid#scrollToCell */\n\n  }, {\n    key: 'scrollToRow',\n    value: function scrollToRow() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToCell({\n          columnIndex: 0,\n          rowIndex: index\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          noRowsRenderer = _props.noRowsRenderer,\n          scrollToIndex = _props.scrollToIndex,\n          width = _props.width;\n\n\n      var classNames = cn('ReactVirtualized__List', className);\n\n      return React.createElement(Grid, _extends({}, this.props, {\n        autoContainerWidth: true,\n        cellRenderer: this._cellRenderer,\n        className: classNames,\n        columnWidth: width,\n        columnCount: 1,\n        noContentRenderer: noRowsRenderer,\n        onScroll: this._onScroll,\n        onSectionRendered: this._onSectionRendered,\n        ref: this._setRef,\n        scrollToRow: scrollToIndex\n      }));\n    }\n  }]);\n\n  return List;\n}(React.PureComponent);\n\nList.defaultProps = {\n  autoHeight: false,\n  estimatedRowSize: 30,\n  onScroll: function onScroll() {},\n  noRowsRenderer: function noRowsRenderer() {\n    return null;\n  },\n  onRowsRendered: function onRowsRendered() {},\n  overscanIndicesGetter: accessibilityOverscanIndicesGetter,\n  overscanRowCount: 10,\n  scrollToAlignment: 'auto',\n  scrollToIndex: -1,\n  style: {}\n};\nList.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  \"aria-label\": PropTypes.string,\n\n\n  /**\n   * Removes fixed height from the scrollingContainer so that the total height\n   * of rows can stretch the window. Intended for use with WindowScroller\n   */\n  autoHeight: PropTypes.bool.isRequired,\n\n\n  /** Optional CSS class name */\n  className: PropTypes.string,\n\n\n  /**\n   * Used to estimate the total height of a List before all of its rows have actually been measured.\n   * The estimated total height is adjusted as rows are rendered.\n   */\n  estimatedRowSize: PropTypes.number.isRequired,\n\n\n  /** Height constraint for list (determines how many actual rows are rendered) */\n  height: PropTypes.number.isRequired,\n\n\n  /** Optional renderer to be used in place of rows when rowCount is 0 */\n  noRowsRenderer: function noRowsRenderer() {\n    return (typeof bpfrpt_proptype_NoContentRenderer === 'function' ? bpfrpt_proptype_NoContentRenderer.isRequired ? bpfrpt_proptype_NoContentRenderer.isRequired : bpfrpt_proptype_NoContentRenderer : PropTypes.shape(bpfrpt_proptype_NoContentRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Callback invoked with information about the slice of rows that were just rendered.  */\n\n  onRowsRendered: PropTypes.func.isRequired,\n\n\n  /**\n   * Callback invoked whenever the scroll offset changes within the inner scrollable region.\n   * This callback can be used to sync scrolling between lists, tables, or grids.\n   */\n  onScroll: PropTypes.func.isRequired,\n\n\n  /** See Grid#overscanIndicesGetter */\n  overscanIndicesGetter: function overscanIndicesGetter() {\n    return (typeof bpfrpt_proptype_OverscanIndicesGetter === 'function' ? bpfrpt_proptype_OverscanIndicesGetter.isRequired ? bpfrpt_proptype_OverscanIndicesGetter.isRequired : bpfrpt_proptype_OverscanIndicesGetter : PropTypes.shape(bpfrpt_proptype_OverscanIndicesGetter).isRequired).apply(this, arguments);\n  },\n\n\n  /**\n   * Number of rows to render above/below the visible bounds of the list.\n   * These rows can help for smoother scrolling on touch devices.\n   */\n  overscanRowCount: PropTypes.number.isRequired,\n\n\n  /** Either a fixed row height (number) or a function that returns the height of a row given its index.  */\n  rowHeight: function rowHeight() {\n    return (typeof bpfrpt_proptype_CellSize === 'function' ? bpfrpt_proptype_CellSize.isRequired ? bpfrpt_proptype_CellSize.isRequired : bpfrpt_proptype_CellSize : PropTypes.shape(bpfrpt_proptype_CellSize).isRequired).apply(this, arguments);\n  },\n\n\n  /** Responsible for rendering a row given an index; ({ index: number }): node */\n  rowRenderer: function rowRenderer() {\n    return (typeof bpfrpt_proptype_RowRenderer === 'function' ? bpfrpt_proptype_RowRenderer.isRequired ? bpfrpt_proptype_RowRenderer.isRequired : bpfrpt_proptype_RowRenderer : PropTypes.shape(bpfrpt_proptype_RowRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Number of rows in list. */\n  rowCount: PropTypes.number.isRequired,\n\n\n  /** See Grid#scrollToAlignment */\n  scrollToAlignment: function scrollToAlignment() {\n    return (typeof bpfrpt_proptype_Alignment === 'function' ? bpfrpt_proptype_Alignment.isRequired ? bpfrpt_proptype_Alignment.isRequired : bpfrpt_proptype_Alignment : PropTypes.shape(bpfrpt_proptype_Alignment).isRequired).apply(this, arguments);\n  },\n\n\n  /** Row index to ensure visible (by forcefully scrolling if necessary) */\n  scrollToIndex: PropTypes.number.isRequired,\n\n\n  /** Vertical offset. */\n  scrollTop: PropTypes.number,\n\n\n  /** Optional inline style */\n  style: PropTypes.object.isRequired,\n\n\n  /** Tab index for focus */\n  tabIndex: PropTypes.number,\n\n\n  /** Width of list */\n  width: PropTypes.number.isRequired\n};\nexport default List;\nimport { bpfrpt_proptype_NoContentRenderer } from '../Grid';\nimport { bpfrpt_proptype_Alignment } from '../Grid';\nimport { bpfrpt_proptype_CellSize } from '../Grid';\nimport { bpfrpt_proptype_CellPosition } from '../Grid';\nimport { bpfrpt_proptype_OverscanIndicesGetter } from '../Grid';\nimport { bpfrpt_proptype_RenderedSection } from '../Grid';\nimport { bpfrpt_proptype_CellRendererParams } from '../Grid';\nimport { bpfrpt_proptype_Scroll as bpfrpt_proptype_GridScroll } from '../Grid';\nimport { bpfrpt_proptype_RowRenderer } from './types';\nimport { bpfrpt_proptype_RenderedRows } from './types';\nimport { bpfrpt_proptype_Scroll } from './types';\nimport PropTypes from 'prop-types';","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport cx from 'classnames';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { t, styled } from '@superset-ui/core';\n\nconst propTypes = {\n  datasourceUrl: PropTypes.string,\n  datasourceName: PropTypes.string,\n  innerRef: PropTypes.func,\n  isSelected: PropTypes.bool,\n  lastModified: PropTypes.string,\n  sliceName: PropTypes.string.isRequired,\n  style: PropTypes.object,\n  visType: PropTypes.string.isRequired,\n};\n\nconst defaultProps = {\n  datasourceUrl: null,\n  datasourceName: '-',\n  innerRef: null,\n  isSelected: false,\n  style: null,\n  lastModified: null,\n};\n\nconst Styled = styled.div`\n  ${({ theme }) => `\n    .chart-card {\n      border: 1px solid ${theme.colors.grayscale.light2};\n      border-radius: ${theme.gridUnit}px;\n      background: ${theme.colors.grayscale.light5};\n      padding: ${theme.gridUnit * 2}px;\n      margin: 0 ${theme.gridUnit * 3}px\n        ${theme.gridUnit * 3}px\n        ${theme.gridUnit * 3}px;\n      position: relative;\n      cursor: move;\n      white-space: nowrap;\n      overflow: hidden;\n\n      &:hover {\n        background: ${theme.colors.grayscale.light4};\n      }\n    }\n\n    .chart-card.is-selected {\n      cursor: not-allowed;\n      opacity: 0.4;\n    }\n\n    .card-title {\n      margin-right: 60px;\n      margin-bottom: ${theme.gridUnit * 2}px;\n      font-weight: ${theme.typography.weights.bold};\n    }\n\n    .card-body {\n      display: flex;\n      flex-direction: column;\n\n      .item {\n        span {\n          word-break: break-all;\n\n          &:first-child {\n            font-weight: ${theme.typography.weights.normal};\n          }\n        }\n      }\n    }\n\n    .is-added-label {\n      background: ${theme.colors.grayscale.base};\n      border-radius: ${theme.gridUnit}px;\n      color: ${theme.colors.grayscale.light5};\n      font-size: ${theme.typography.sizes.s}px;\n      text-transform: uppercase;\n      position: absolute;\n      padding: ${theme.gridUnit}px\n        ${theme.gridUnit * 2}px;\n      top: ${theme.gridUnit * 8}px;\n      right: ${theme.gridUnit * 8}px;\n      pointer-events: none;\n    }\n  `}\n`;\n\nfunction AddSliceCard({\n  datasourceUrl,\n  datasourceName,\n  innerRef,\n  isSelected,\n  lastModified,\n  sliceName,\n  style,\n  visType,\n}) {\n  return (\n    <Styled ref={innerRef} style={style}>\n      <div\n        className={cx('chart-card', isSelected && 'is-selected')}\n        data-test=\"chart-card\"\n      >\n        <div className=\"card-title\" data-test=\"card-title\">\n          {sliceName}\n        </div>\n        <div className=\"card-body\">\n          <div className=\"item\">\n            <span>{t('Modified')} </span>\n            <span>{lastModified}</span>\n          </div>\n          <div className=\"item\">\n            <span>{t('Visualization')} </span>\n            <span>{visType}</span>\n          </div>\n          <div className=\"item\">\n            <span>{t('Data source')} </span>\n            <a href={datasourceUrl}>{datasourceName}</a>\n          </div>\n        </div>\n      </div>\n      {isSelected && <div className=\"is-added-label\">{t('Added')}</div>}\n    </Styled>\n  );\n}\n\nAddSliceCard.propTypes = propTypes;\nAddSliceCard.defaultProps = defaultProps;\n\nexport default AddSliceCard;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { DragLayer } from 'react-dnd';\n\nimport AddSliceCard from '../AddSliceCard';\nimport { slicePropShape } from '../../util/propShapes';\nimport {\n  NEW_COMPONENT_SOURCE_TYPE,\n  CHART_TYPE,\n} from '../../util/componentTypes';\n\nconst staticCardStyles = {\n  position: 'fixed',\n  pointerEvents: 'none',\n  top: 0,\n  left: 0,\n  zIndex: 101, // this should be higher than top-level tabs\n  width: 376 - 2 * 16,\n};\n\nconst propTypes = {\n  dragItem: PropTypes.shape({\n    index: PropTypes.number.isRequired,\n  }),\n  slices: PropTypes.arrayOf(slicePropShape),\n  isDragging: PropTypes.bool.isRequired,\n  currentOffset: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n  }),\n};\n\nconst defaultProps = {\n  currentOffset: null,\n  dragItem: null,\n  slices: null,\n};\n\nfunction AddSliceDragPreview({ dragItem, slices, isDragging, currentOffset }) {\n  if (!isDragging || !currentOffset || !dragItem || !slices) return null;\n\n  const slice = slices[dragItem.index];\n\n  // make sure it's a new component and a chart\n  const shouldRender =\n    slice &&\n    dragItem.parentType === NEW_COMPONENT_SOURCE_TYPE &&\n    dragItem.type === CHART_TYPE;\n\n  return !shouldRender ? null : (\n    <AddSliceCard\n      style={{\n        ...staticCardStyles,\n        transform: `translate(${currentOffset.x}px, ${currentOffset.y}px)`,\n      }}\n      sliceName={slice.slice_name}\n      lastModified={slice.changed_on_humanized}\n      visType={slice.viz_type}\n      datasourceUrl={slice.datasource_url}\n      datasourceName={slice.datasource_name}\n    />\n  );\n}\n\nAddSliceDragPreview.propTypes = propTypes;\nAddSliceDragPreview.defaultProps = defaultProps;\n\n// This injects these props into the component\nexport default DragLayer(monitor => ({\n  dragItem: monitor.getItem(),\n  currentOffset: monitor.getSourceClientOffset(),\n  isDragging: monitor.isDragging(),\n}))(AddSliceDragPreview);\n","var emptyImage;\nexport function getEmptyImage() {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    emptyImage.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  return emptyImage;\n}","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint max-len: 0 */\n/**\n * When determining if a component is a valid child of another component we must consider both\n *   - parent + child component types\n *   - component depth, or depth of nesting of container components\n *\n * We consider types because some components aren't containers (e.g. a heading) and we consider\n * depth to prevent infinite nesting of container components.\n *\n * The following example container nestings should be valid, which means that some containers\n * don't increase the (depth) of their children, namely tabs and tab:\n *   (a) root (0) > grid (1) >                         row (2) > column (3) > row (4) > non-container (5)\n *   (b) root (0) > grid (1) >    tabs (2) > tab (2) > row (2) > column (3) > row (4) > non-container (5)\n *   (c) root (0) > top-tab (1) >                      row (2) > column (3) > row (4) > non-container (5)\n *   (d) root (0) > top-tab (1) > tabs (2) > tab (2) > row (2) > column (3) > row (4) > non-container (5)\n */\nimport {\n  CHART_TYPE,\n  COLUMN_TYPE,\n  DASHBOARD_GRID_TYPE,\n  DASHBOARD_ROOT_TYPE,\n  DIVIDER_TYPE,\n  HEADER_TYPE,\n  MARKDOWN_TYPE,\n  ROW_TYPE,\n  TABS_TYPE,\n  TAB_TYPE,\n  DYNAMIC_TYPE,\n} from './componentTypes';\n\nimport { DASHBOARD_ROOT_DEPTH as rootDepth } from './constants';\n\nconst depthOne = rootDepth + 1;\n// const depthTwo = rootDepth + 2; // Meantime no need\nconst depthThree = rootDepth + 3;\nconst depthFour = rootDepth + 4;\nconst depthFive = rootDepth + 5;\n\n// when moving components around the depth of child is irrelevant, note these are parent depths\nconst parentMaxDepthLookup = {\n  [DASHBOARD_ROOT_TYPE]: {\n    [TABS_TYPE]: rootDepth,\n    [DASHBOARD_GRID_TYPE]: rootDepth,\n  },\n\n  [DASHBOARD_GRID_TYPE]: {\n    [CHART_TYPE]: depthOne,\n    [DYNAMIC_TYPE]: depthOne,\n    [MARKDOWN_TYPE]: depthOne,\n    [COLUMN_TYPE]: depthOne,\n    [DIVIDER_TYPE]: depthOne,\n    [HEADER_TYPE]: depthOne,\n    [ROW_TYPE]: depthOne,\n    [TABS_TYPE]: depthOne,\n  },\n\n  [ROW_TYPE]: {\n    [CHART_TYPE]: depthFour,\n    [DYNAMIC_TYPE]: depthFour,\n    [MARKDOWN_TYPE]: depthFour,\n    [COLUMN_TYPE]: depthFour,\n  },\n\n  [TABS_TYPE]: {\n    [TAB_TYPE]: depthThree,\n  },\n\n  [TAB_TYPE]: {\n    [CHART_TYPE]: depthFive,\n    [DYNAMIC_TYPE]: depthFive,\n    [MARKDOWN_TYPE]: depthFive,\n    [COLUMN_TYPE]: depthThree,\n    [DIVIDER_TYPE]: depthFive,\n    [HEADER_TYPE]: depthFive,\n    [ROW_TYPE]: depthThree,\n    [TABS_TYPE]: depthThree,\n  },\n\n  [COLUMN_TYPE]: {\n    [CHART_TYPE]: depthFive,\n    [HEADER_TYPE]: depthFive,\n    [MARKDOWN_TYPE]: depthFive,\n    [ROW_TYPE]: depthThree,\n    [DIVIDER_TYPE]: depthThree,\n    [TABS_TYPE]: depthThree,\n  },\n\n  // these have no valid children\n  [CHART_TYPE]: {},\n  [DYNAMIC_TYPE]: {},\n  [DIVIDER_TYPE]: {},\n  [HEADER_TYPE]: {},\n  [MARKDOWN_TYPE]: {},\n};\n\ninterface IsValidChildProps {\n  parentType?: string;\n  childType?: string;\n  parentDepth?: unknown;\n}\n\nexport default function isValidChild(child: IsValidChildProps): boolean {\n  const { parentType, childType, parentDepth } = child;\n  if (!parentType || !childType || typeof parentDepth !== 'number') {\n    return false;\n  }\n\n  const maxParentDepth: number | undefined = (parentMaxDepthLookup[\n    parentType\n  ] || {})[childType];\n\n  return typeof maxParentDepth === 'number' && parentDepth <= maxParentDepth;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport isValidChild from './isValidChild';\nimport { TAB_TYPE, TABS_TYPE } from './componentTypes';\n\nexport const DROP_TOP = 'DROP_TOP';\nexport const DROP_RIGHT = 'DROP_RIGHT';\nexport const DROP_BOTTOM = 'DROP_BOTTOM';\nexport const DROP_LEFT = 'DROP_LEFT';\n\n// this defines how close the mouse must be to the edge of a component to display\n// a sibling type drop indicator\nconst SIBLING_DROP_THRESHOLD = 20;\nconst NON_SHALLOW_DROP_THRESHOLD = 20;\n\n// We cache the last recorded clientOffset per component in order to\n// have access to it beyond the handleHover phase and into the handleDrop phase\n// of drag-and-drop. we do not have access to it during drop because react-dnd's\n// monitor.getClientOffset() returns null at this point\nlet CACHED_CLIENT_OFFSET = {};\nexport function clearDropCache() {\n  CACHED_CLIENT_OFFSET = {};\n}\n\nexport default function getDropPosition(monitor, Component) {\n  const {\n    depth: componentDepth,\n    parentComponent,\n    component,\n    orientation,\n    isDraggingOverShallow,\n  } = Component.props;\n\n  const draggingItem = monitor.getItem();\n\n  // if dropped self on self, do nothing\n  if (!draggingItem || draggingItem.id === component.id) {\n    return null;\n  }\n\n  const validChild = isValidChild({\n    parentType: component.type,\n    parentDepth: componentDepth,\n    childType: draggingItem.type,\n  });\n\n  const parentType = parentComponent && parentComponent.type;\n  const parentDepth = // see isValidChild.js for why tabs don't increment child depth\n    componentDepth +\n    (parentType === TAB_TYPE || parentType === TABS_TYPE ? 0 : -1);\n\n  const validSibling = isValidChild({\n    parentType,\n    parentDepth,\n    childType: draggingItem.type,\n  });\n\n  if (!validChild && !validSibling) {\n    return null;\n  }\n\n  const hasChildren = (component.children || []).length > 0;\n  const childDropOrientation =\n    orientation === 'row' ? 'vertical' : 'horizontal';\n  const siblingDropOrientation =\n    orientation === 'row' ? 'horizontal' : 'vertical';\n\n  if (isDraggingOverShallow && validChild && !validSibling) {\n    // easiest case, insert as child\n    if (childDropOrientation === 'vertical') {\n      return hasChildren ? DROP_RIGHT : DROP_LEFT;\n    }\n    return hasChildren ? DROP_BOTTOM : DROP_TOP;\n  }\n\n  const refBoundingRect = Component.ref.getBoundingClientRect();\n  const clientOffset =\n    monitor.getClientOffset() || CACHED_CLIENT_OFFSET[component.id];\n\n  if (!clientOffset || !refBoundingRect) {\n    return null;\n  }\n\n  CACHED_CLIENT_OFFSET[component.id] = clientOffset;\n  const deltaTop = Math.abs(clientOffset.y - refBoundingRect.top);\n  const deltaBottom = Math.abs(clientOffset.y - refBoundingRect.bottom);\n  const deltaLeft = Math.abs(clientOffset.x - refBoundingRect.left);\n  const deltaRight = Math.abs(clientOffset.x - refBoundingRect.right);\n\n  // Most of the time we only want a drop indicator for shallow (top-level, non-nested) drop targets\n  // However there are some cases where considering only shallow targets would result in NO drop\n  // indicators which is a bad UX.\n  // e.g.,\n  //    when dragging row-a over a chart that's in another row-b, the chart is the shallow droptarget\n  //    but row-a is not a valid child or sibling. in this case we want to show a sibling drop\n  //    indicator for row-b, which is NOT a shallow drop target.\n  // BUT if we ALWAYS consider non-shallow drop targets we may get multiple indicators shown at the\n  // same time, which is also a bad UX. to prevent this we can enforce a threshold proximity of the\n  // mouse to the edge of a non-shallow target\n  if (\n    !isDraggingOverShallow &&\n    [deltaTop, deltaBottom, deltaLeft, deltaRight].every(\n      delta => delta > NON_SHALLOW_DROP_THRESHOLD,\n    )\n  ) {\n    return null;\n  }\n\n  // Drop based on mouse position relative to component center\n  if (validSibling && !validChild) {\n    if (siblingDropOrientation === 'vertical') {\n      const refMiddleX =\n        refBoundingRect.left +\n        (refBoundingRect.right - refBoundingRect.left) / 2;\n      return clientOffset.x < refMiddleX ? DROP_LEFT : DROP_RIGHT;\n    }\n    const refMiddleY =\n      refBoundingRect.top + (refBoundingRect.bottom - refBoundingRect.top) / 2;\n    return clientOffset.y < refMiddleY ? DROP_TOP : DROP_BOTTOM;\n  }\n\n  // either is valid, so choose location based on boundary deltas\n  if (validSibling && validChild) {\n    // if near enough to a sibling boundary, drop there\n    if (siblingDropOrientation === 'vertical') {\n      if (deltaLeft < SIBLING_DROP_THRESHOLD) return DROP_LEFT;\n      if (deltaRight < SIBLING_DROP_THRESHOLD) return DROP_RIGHT;\n    } else {\n      if (deltaTop < SIBLING_DROP_THRESHOLD) return DROP_TOP;\n      if (deltaBottom < SIBLING_DROP_THRESHOLD) return DROP_BOTTOM;\n    }\n\n    // drop as child\n    if (childDropOrientation === 'vertical') {\n      return hasChildren ? DROP_RIGHT : DROP_LEFT;\n    }\n    return hasChildren ? DROP_BOTTOM : DROP_TOP;\n  }\n\n  return null;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nlet scrollTopDashboardInterval: any;\nconst SCROLL_STEP = 120;\nconst INTERVAL_DELAY = 50;\n\nexport default function handleScroll(scroll: string) {\n  const setupScroll =\n    scroll === 'SCROLL_TOP' &&\n    !scrollTopDashboardInterval &&\n    document.documentElement.scrollTop !== 0;\n\n  const clearScroll =\n    scrollTopDashboardInterval &&\n    (scroll !== 'SCROLL_TOP' || document.documentElement.scrollTop === 0);\n\n  if (setupScroll) {\n    scrollTopDashboardInterval = setInterval(() => {\n      if (document.documentElement.scrollTop === 0) {\n        clearInterval(scrollTopDashboardInterval);\n        scrollTopDashboardInterval = null;\n        return;\n      }\n\n      let scrollTop = document.documentElement.scrollTop - SCROLL_STEP;\n      if (scrollTop < 0) {\n        scrollTop = 0;\n      }\n      window.scroll({\n        top: scrollTop,\n        behavior: 'smooth',\n      });\n    }, INTERVAL_DELAY);\n  } else if (clearScroll) {\n    clearInterval(scrollTopDashboardInterval);\n    scrollTopDashboardInterval = null;\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { throttle } from 'lodash';\nimport { DASHBOARD_ROOT_TYPE } from 'src/dashboard/util/componentTypes';\nimport getDropPosition from 'src/dashboard/util/getDropPosition';\nimport handleScroll from './handleScroll';\n\nconst HOVER_THROTTLE_MS = 100;\n\nfunction handleHover(props, monitor, Component) {\n  // this may happen due to throttling\n  if (!Component.mounted) return;\n\n  const dropPosition = getDropPosition(monitor, Component);\n\n  const isDashboardRoot =\n    Component?.props?.component?.type === DASHBOARD_ROOT_TYPE;\n  const scroll = isDashboardRoot ? 'SCROLL_TOP' : null;\n\n  handleScroll(scroll);\n\n  if (!dropPosition) {\n    Component.setState(() => ({ dropIndicator: null }));\n    return;\n  }\n\n  Component.setState(() => ({\n    dropIndicator: dropPosition,\n  }));\n}\n\n// this is called very frequently by react-dnd\nexport default throttle(handleHover, HOVER_THROTTLE_MS);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport handleHover from './handleHover';\nimport handleDrop from './handleDrop';\n\n// note: the 'type' hook is not useful for us as dropping is contigent on other properties\nconst TYPE = 'DRAG_DROPPABLE';\n\nexport const dragConfig = [\n  TYPE,\n  {\n    canDrag(props) {\n      return !props.disableDragDrop;\n    },\n\n    // this defines the dragging item object returned by monitor.getItem()\n    beginDrag(props /* , monitor, component */) {\n      const { component, index, parentComponent = {} } = props;\n      return {\n        type: component.type,\n        id: component.id,\n        meta: component.meta,\n        index,\n        parentId: parentComponent.id,\n        parentType: parentComponent.type,\n      };\n    },\n  },\n  function dragStateToProps(connect, monitor) {\n    return {\n      dragSourceRef: connect.dragSource(),\n      dragPreviewRef: connect.dragPreview(),\n      isDragging: monitor.isDragging(),\n    };\n  },\n];\n\nexport const dropConfig = [\n  TYPE,\n  {\n    canDrop(props) {\n      return !props.disableDragDrop;\n    },\n    hover(props, monitor, component) {\n      if (component && component.mounted) {\n        handleHover(props, monitor, component);\n      }\n    },\n    // note:\n    //  the react-dnd api requires that the drop() method return a result or undefined\n    //  monitor.didDrop() cannot be used because it returns true only for the most-nested target\n    drop(props, monitor, component) {\n      const dropResult = monitor.getDropResult();\n      if ((!dropResult || !dropResult.destination) && component.mounted) {\n        return handleDrop(props, monitor, component);\n      }\n      return undefined;\n    },\n  },\n  function dropStateToProps(connect, monitor) {\n    return {\n      droppableRef: connect.dropTarget(),\n      isDraggingOver: monitor.isOver(),\n      isDraggingOverShallow: monitor.isOver({ shallow: true }),\n    };\n  },\n];\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport getDropPosition, {\n  clearDropCache,\n  DROP_TOP,\n  DROP_RIGHT,\n  DROP_BOTTOM,\n  DROP_LEFT,\n} from '../../util/getDropPosition';\n\nexport default function handleDrop(props, monitor, Component) {\n  // this may happen due to throttling\n  if (!Component.mounted) return undefined;\n\n  Component.setState(() => ({ dropIndicator: null }));\n  const dropPosition = getDropPosition(monitor, Component);\n\n  if (!dropPosition) {\n    return undefined;\n  }\n\n  const {\n    parentComponent,\n    component,\n    index: componentIndex,\n    onDrop,\n    orientation,\n  } = Component.props;\n\n  const draggingItem = monitor.getItem();\n\n  const dropAsChildOrSibling =\n    (orientation === 'row' &&\n      (dropPosition === DROP_TOP || dropPosition === DROP_BOTTOM)) ||\n    (orientation === 'column' &&\n      (dropPosition === DROP_LEFT || dropPosition === DROP_RIGHT))\n      ? 'sibling'\n      : 'child';\n\n  const dropResult = {\n    source: {\n      id: draggingItem.parentId,\n      type: draggingItem.parentType,\n      index: draggingItem.index,\n    },\n    dragging: {\n      id: draggingItem.id,\n      type: draggingItem.type,\n      meta: draggingItem.meta,\n    },\n  };\n\n  // simplest case, append as child\n  if (dropAsChildOrSibling === 'child') {\n    dropResult.destination = {\n      id: component.id,\n      type: component.type,\n      index: component.children.length,\n    };\n  } else {\n    // if the item is in the same list with a smaller index, you must account for the\n    // \"missing\" index upon movement within the list\n    const sameParent =\n      parentComponent && draggingItem.parentId === parentComponent.id;\n    const sameParentLowerIndex =\n      sameParent && draggingItem.index < componentIndex;\n\n    let nextIndex = sameParentLowerIndex ? componentIndex - 1 : componentIndex;\n    if (dropPosition === DROP_BOTTOM || dropPosition === DROP_RIGHT) {\n      nextIndex += 1;\n    }\n\n    dropResult.destination = {\n      id: parentComponent.id,\n      type: parentComponent.type,\n      index: nextIndex,\n    };\n  }\n\n  onDrop(dropResult);\n  clearDropCache();\n\n  return dropResult;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { DragSource, DropTarget } from 'react-dnd';\nimport cx from 'classnames';\n\nimport { componentShape } from '../../util/propShapes';\nimport { dragConfig, dropConfig } from './dragDroppableConfig';\nimport {\n  DROP_TOP,\n  DROP_RIGHT,\n  DROP_BOTTOM,\n  DROP_LEFT,\n} from '../../util/getDropPosition';\n\nconst propTypes = {\n  children: PropTypes.func,\n  className: PropTypes.string,\n  component: componentShape.isRequired,\n  parentComponent: componentShape,\n  depth: PropTypes.number.isRequired,\n  disableDragDrop: PropTypes.bool,\n  orientation: PropTypes.oneOf(['row', 'column']),\n  index: PropTypes.number.isRequired,\n  style: PropTypes.object,\n  onDrop: PropTypes.func,\n  editMode: PropTypes.bool.isRequired,\n  useEmptyDragPreview: PropTypes.bool,\n\n  // from react-dnd\n  isDragging: PropTypes.bool.isRequired,\n  isDraggingOver: PropTypes.bool.isRequired,\n  isDraggingOverShallow: PropTypes.bool.isRequired,\n  droppableRef: PropTypes.func.isRequired,\n  dragSourceRef: PropTypes.func.isRequired,\n  dragPreviewRef: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  className: null,\n  style: null,\n  parentComponent: null,\n  disableDragDrop: false,\n  children() {},\n  onDrop() {},\n  orientation: 'row',\n  useEmptyDragPreview: false,\n};\n\n// export unwrapped component for testing\nexport class UnwrappedDragDroppable extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dropIndicator: null, // this gets set/modified by the react-dnd HOCs\n    };\n    this.setRef = this.setRef.bind(this);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  setRef(ref) {\n    this.ref = ref;\n    // this is needed for a custom drag preview\n    if (this.props.useEmptyDragPreview) {\n      this.props.dragPreviewRef(getEmptyImage(), {\n        // IE fallback: specify that we'd rather screenshot the node\n        // when it already knows it's being dragged so we can hide it with CSS.\n        captureDraggingState: true,\n      });\n    } else {\n      this.props.dragPreviewRef(ref);\n    }\n    this.props.droppableRef(ref);\n  }\n\n  render() {\n    const {\n      children,\n      className,\n      orientation,\n      dragSourceRef,\n      disableDragDrop,\n      isDragging,\n      isDraggingOver,\n      style,\n      editMode,\n    } = this.props;\n\n    const { dropIndicator } = this.state;\n    const dropIndicatorProps =\n      isDraggingOver && dropIndicator && !disableDragDrop\n        ? {\n            className: cx(\n              'drop-indicator',\n              dropIndicator === DROP_TOP && 'drop-indicator--top',\n              dropIndicator === DROP_BOTTOM && 'drop-indicator--bottom',\n              dropIndicator === DROP_LEFT && 'drop-indicator--left',\n              dropIndicator === DROP_RIGHT && 'drop-indicator--right',\n            ),\n          }\n        : null;\n\n    const childProps = editMode\n      ? {\n          dragSourceRef,\n          dropIndicatorProps,\n        }\n      : {};\n\n    return (\n      <div\n        style={style}\n        ref={this.setRef}\n        data-test=\"dragdroppable-object\"\n        className={cx(\n          'dragdroppable',\n          orientation === 'row' && 'dragdroppable-row',\n          orientation === 'column' && 'dragdroppable-column',\n          isDragging && 'dragdroppable--dragging',\n          className,\n        )}\n      >\n        {children(childProps)}\n      </div>\n    );\n  }\n}\n\nUnwrappedDragDroppable.propTypes = propTypes;\nUnwrappedDragDroppable.defaultProps = defaultProps;\n\n// note that the composition order here determines using\n// component.method() vs decoratedComponentInstance.method() in the drag/drop config\nexport default DragSource(...dragConfig)(\n  DropTarget(...dropConfig)(UnwrappedDragDroppable),\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { List } from 'react-virtualized';\nimport { createFilter } from 'react-search-input';\nimport {\n  t,\n  styled,\n  isFeatureEnabled,\n  FeatureFlag,\n  css,\n} from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport { Select } from 'src/components';\nimport Loading from 'src/components/Loading';\nimport Button from 'src/components/Button';\nimport Icons from 'src/components/Icons';\nimport {\n  CHART_TYPE,\n  NEW_COMPONENT_SOURCE_TYPE,\n} from 'src/dashboard/util/componentTypes';\nimport {\n  NEW_CHART_ID,\n  NEW_COMPONENTS_SOURCE_ID,\n} from 'src/dashboard/util/constants';\nimport { slicePropShape } from 'src/dashboard/util/propShapes';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\nimport AddSliceCard from './AddSliceCard';\nimport AddSliceDragPreview from './dnd/AddSliceDragPreview';\nimport DragDroppable from './dnd/DragDroppable';\n\nconst propTypes = {\n  fetchAllSlices: PropTypes.func.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  slices: PropTypes.objectOf(slicePropShape).isRequired,\n  lastUpdated: PropTypes.number.isRequired,\n  errorMessage: PropTypes.string,\n  userId: PropTypes.string.isRequired,\n  selectedSliceIds: PropTypes.arrayOf(PropTypes.number),\n  editMode: PropTypes.bool,\n  height: PropTypes.number,\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES,\n  dashboardId: PropTypes.number,\n};\n\nconst defaultProps = {\n  selectedSliceIds: [],\n  editMode: false,\n  errorMessage: '',\n  height: window.innerHeight,\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES.NOOP,\n};\n\nconst KEYS_TO_FILTERS = ['slice_name', 'viz_type', 'datasource_name'];\nconst KEYS_TO_SORT = {\n  slice_name: 'name',\n  viz_type: 'viz type',\n  datasource_name: 'dataset',\n  changed_on: 'recent',\n};\n\nconst DEFAULT_SORT_KEY = 'changed_on';\n\nconst MARGIN_BOTTOM = 16;\nconst SIDEPANE_HEADER_HEIGHT = 30;\nconst SLICE_ADDER_CONTROL_HEIGHT = 64;\nconst DEFAULT_CELL_HEIGHT = 112;\n\nconst Controls = styled.div`\n  display: flex;\n  flex-direction: row;\n  padding: ${({ theme }) => theme.gridUnit * 3}px;\n  padding-top: ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nconst StyledSelect = styled(Select)`\n  margin-left: ${({ theme }) => theme.gridUnit * 2}px;\n  min-width: 150px;\n`;\n\nconst NewChartButtonContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    justify-content: flex-end;\n    padding-right: ${theme.gridUnit * 2}px;\n  `}\n`;\n\nconst NewChartButton = styled(Button)`\n  ${({ theme }) => css`\n    height: auto;\n    & > .anticon + span {\n      margin-left: 0;\n    }\n    & > [role='img']:first-of-type {\n      margin-right: ${theme.gridUnit}px;\n      padding-bottom: 1px;\n      line-height: 0;\n    }\n  `}\n`;\n\nclass SliceAdder extends React.Component {\n  static sortByComparator(attr) {\n    const desc = attr === 'changed_on' ? -1 : 1;\n\n    return (a, b) => {\n      if (a[attr] < b[attr]) {\n        return -1 * desc;\n      }\n      if (a[attr] > b[attr]) {\n        return 1 * desc;\n      }\n      return 0;\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      filteredSlices: [],\n      searchTerm: '',\n      sortBy: DEFAULT_SORT_KEY,\n      selectedSliceIdsSet: new Set(props.selectedSliceIds),\n    };\n    this.rowRenderer = this.rowRenderer.bind(this);\n    this.searchUpdated = this.searchUpdated.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n  }\n\n  componentDidMount() {\n    const { userId, filterboxMigrationState } = this.props;\n    this.slicesRequest = this.props.fetchAllSlices(\n      userId,\n      isFeatureEnabled(FeatureFlag.ENABLE_FILTER_BOX_MIGRATION) &&\n        filterboxMigrationState !== FILTER_BOX_MIGRATION_STATES.SNOOZED,\n    );\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const nextState = {};\n    if (nextProps.lastUpdated !== this.props.lastUpdated) {\n      nextState.filteredSlices = Object.values(nextProps.slices)\n        .filter(createFilter(this.state.searchTerm, KEYS_TO_FILTERS))\n        .sort(SliceAdder.sortByComparator(this.state.sortBy));\n    }\n\n    if (nextProps.selectedSliceIds !== this.props.selectedSliceIds) {\n      nextState.selectedSliceIdsSet = new Set(nextProps.selectedSliceIds);\n    }\n\n    if (Object.keys(nextState).length) {\n      this.setState(nextState);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.slicesRequest && this.slicesRequest.abort) {\n      this.slicesRequest.abort();\n    }\n  }\n\n  getFilteredSortedSlices(searchTerm, sortBy) {\n    return Object.values(this.props.slices)\n      .filter(createFilter(searchTerm, KEYS_TO_FILTERS))\n      .sort(SliceAdder.sortByComparator(sortBy));\n  }\n\n  handleKeyPress(ev) {\n    if (ev.key === 'Enter') {\n      ev.preventDefault();\n\n      this.searchUpdated(ev.target.value);\n    }\n  }\n\n  handleChange(ev) {\n    this.searchUpdated(ev.target.value);\n  }\n\n  searchUpdated(searchTerm) {\n    this.setState(prevState => ({\n      searchTerm,\n      filteredSlices: this.getFilteredSortedSlices(\n        searchTerm,\n        prevState.sortBy,\n      ),\n    }));\n  }\n\n  handleSelect(sortBy) {\n    this.setState(prevState => ({\n      sortBy,\n      filteredSlices: this.getFilteredSortedSlices(\n        prevState.searchTerm,\n        sortBy,\n      ),\n    }));\n  }\n\n  rowRenderer({ key, index, style }) {\n    const { filteredSlices, selectedSliceIdsSet } = this.state;\n    const cellData = filteredSlices[index];\n    const isSelected = selectedSliceIdsSet.has(cellData.slice_id);\n    const type = CHART_TYPE;\n    const id = NEW_CHART_ID;\n\n    const meta = {\n      chartId: cellData.slice_id,\n      sliceName: cellData.slice_name,\n    };\n    return (\n      <DragDroppable\n        key={key}\n        component={{ type, id, meta }}\n        parentComponent={{\n          id: NEW_COMPONENTS_SOURCE_ID,\n          type: NEW_COMPONENT_SOURCE_TYPE,\n        }}\n        index={index}\n        depth={0}\n        disableDragDrop={isSelected}\n        editMode={this.props.editMode}\n        // we must use a custom drag preview within the List because\n        // it does not seem to work within a fixed-position container\n        useEmptyDragPreview\n        // List library expect style props here\n        // actual style should be applied to nested AddSliceCard component\n        style={{}}\n      >\n        {({ dragSourceRef }) => (\n          <AddSliceCard\n            innerRef={dragSourceRef}\n            style={style}\n            sliceName={cellData.slice_name}\n            lastModified={cellData.changed_on_humanized}\n            visType={cellData.viz_type}\n            datasourceUrl={cellData.datasource_url}\n            datasourceName={cellData.datasource_name}\n            isSelected={isSelected}\n          />\n        )}\n      </DragDroppable>\n    );\n  }\n\n  render() {\n    const slicesListHeight =\n      this.props.height -\n      SIDEPANE_HEADER_HEIGHT -\n      SLICE_ADDER_CONTROL_HEIGHT -\n      MARGIN_BOTTOM;\n    return (\n      <div className=\"slice-adder-container\">\n        <NewChartButtonContainer>\n          <NewChartButton\n            buttonStyle=\"link\"\n            buttonSize=\"xsmall\"\n            onClick={() =>\n              window.open(\n                `/chart/add?dashboard_id=${this.props.dashboardId}`,\n                '_blank',\n                'noopener noreferrer',\n              )\n            }\n          >\n            <Icons.PlusSmall />\n            {t('Create new chart')}\n          </NewChartButton>\n        </NewChartButtonContainer>\n        <Controls>\n          <Input\n            placeholder={t('Filter your charts')}\n            className=\"search-input\"\n            onChange={this.handleChange}\n            onKeyPress={this.handleKeyPress}\n            data-test=\"dashboard-charts-filter-search-input\"\n          />\n          <StyledSelect\n            id=\"slice-adder-sortby\"\n            value={this.state.sortBy}\n            onChange={this.handleSelect}\n            options={Object.entries(KEYS_TO_SORT).map(([key, label]) => ({\n              label: t('Sort by %s', label),\n              value: key,\n            }))}\n            placeholder={t('Sort by')}\n          />\n        </Controls>\n        {this.props.isLoading && <Loading />}\n        {!this.props.isLoading && this.state.filteredSlices.length > 0 && (\n          <List\n            width={376}\n            height={slicesListHeight}\n            rowCount={this.state.filteredSlices.length}\n            rowHeight={DEFAULT_CELL_HEIGHT}\n            rowRenderer={this.rowRenderer}\n            searchTerm={this.state.searchTerm}\n            sortBy={this.state.sortBy}\n            selectedSliceIds={this.props.selectedSliceIds}\n          />\n        )}\n        {this.props.errorMessage && (\n          <div className=\"error-message\">{this.props.errorMessage}</div>\n        )}\n        {/* Drag preview is just a single fixed-position element */}\n        <AddSliceDragPreview slices={this.state.filteredSlices} />\n      </div>\n    );\n  }\n}\n\nSliceAdder.propTypes = propTypes;\nSliceAdder.defaultProps = defaultProps;\n\nexport default SliceAdder;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { fetchAllSlices } from '../actions/sliceEntities';\nimport SliceAdder from '../components/SliceAdder';\n\nfunction mapStateToProps(\n  { sliceEntities, dashboardInfo, dashboardState },\n  ownProps,\n) {\n  return {\n    height: ownProps.height,\n    userId: dashboardInfo.userId,\n    dashboardId: dashboardInfo.id,\n    selectedSliceIds: dashboardState.sliceIds,\n    slices: sliceEntities.slices,\n    isLoading: sliceEntities.isLoading,\n    errorMessage: sliceEntities.errorMessage,\n    lastUpdated: sliceEntities.lastUpdated,\n    editMode: dashboardState.editMode,\n    filterboxMigrationState: dashboardState.filterboxMigrationState,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      fetchAllSlices,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SliceAdder);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ComponentType } from 'react';\nimport { JsonObject } from '@superset-ui/core';\n\nexport interface RegistryMetadata {\n  description: string;\n  name: string;\n}\n\nexport interface ComponentItem<Metadata = RegistryMetadata> {\n  metadata: Metadata;\n  loadComponent: () => Promise<{ default: ComponentType<any> }>;\n}\n\nexport interface ComponentRegistry<Metadata = RegistryMetadata> {\n  metadata: Metadata;\n  Component: ComponentType<any>;\n}\n\nexport type FunctionalRegistryState<RegistryT> = {\n  registry: { [key: string]: RegistryT & { key: string } };\n  registryKeys: string[];\n};\n\nexport const registryGetAll =\n  <RegistryT>({ registryKeys, registry }: FunctionalRegistryState<RegistryT>) =>\n  () =>\n    registryKeys.map(key => registry[key]);\n\nexport const registryDelete =\n  <RegistryT>({ registryKeys, registry }: FunctionalRegistryState<RegistryT>) =>\n  (keyToDelete: string) => {\n    // eslint-disable-next-line no-param-reassign\n    registryKeys = registryKeys.filter(key => key !== keyToDelete);\n    // eslint-disable-next-line no-param-reassign\n    delete registry[keyToDelete];\n  };\n\nexport const registryGet =\n  <RegistryT>({ registry }: FunctionalRegistryState<RegistryT>) =>\n  (key: string) =>\n    registry[key];\n\nexport const registrySet =\n  ({ registryKeys, registry }: FunctionalRegistryState<JsonObject>) =>\n  (key: string, item: JsonObject) => {\n    registryKeys.push(key);\n    // eslint-disable-next-line no-param-reassign\n    registry[key] = {\n      key,\n      ...item,\n    };\n  };\n\nexport const registrySetComponent =\n  ({ registryKeys, registry }: FunctionalRegistryState<ComponentRegistry>) =>\n  (key: string, item: ComponentItem) => {\n    registryKeys.push(key);\n    // eslint-disable-next-line no-param-reassign\n    registry[key] = {\n      key,\n      metadata: item.metadata,\n      Component: React.lazy(item.loadComponent),\n    };\n  };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/*\n  Preset dashboard components (in addition to basic components like row, column, chart, etc...)\n */\n\nimport DashboardComponentsRegistry from '../dashboardComponents/DashboardComponentsRegistry';\n\nconst dashboardComponents = DashboardComponentsRegistry([\n  // Here can be added default dashboard components\n]);\n\nexport default dashboardComponents;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ComponentItem,\n  ComponentRegistry,\n  FunctionalRegistryState,\n  registryDelete,\n  registryGet,\n  registryGetAll,\n  RegistryMetadata,\n  registrySetComponent,\n} from '../../utils/functionalRegistry';\n\nexport interface DashboardComponentsRegistryMetadata extends RegistryMetadata {\n  iconName: string;\n}\n\n/*\n  This is registry that contains list of dynamic dashboard components that can be added in addition to main components\n */\n\nconst DashboardComponentsRegistry = (\n  initComponents: { key: string; item: ComponentItem }[] = [],\n) => {\n  const state: FunctionalRegistryState<\n    ComponentRegistry<DashboardComponentsRegistryMetadata>\n  > = {\n    registry: {},\n    registryKeys: [],\n  };\n\n  const set = registrySetComponent(state);\n\n  initComponents.forEach(({ key, item }) => {\n    set(key, item);\n  });\n\n  return {\n    set,\n    get: registryGet(state),\n    delete: registryDelete(state),\n    getAll: registryGetAll(state),\n  };\n};\n\nexport default DashboardComponentsRegistry;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport DragDroppable from '../../dnd/DragDroppable';\nimport { NEW_COMPONENTS_SOURCE_ID } from '../../../util/constants';\nimport { NEW_COMPONENT_SOURCE_TYPE } from '../../../util/componentTypes';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  className: PropTypes.string,\n};\n\nconst defaultProps = {\n  className: null,\n};\n\nexport default class DraggableNewComponent extends React.PureComponent {\n  render() {\n    const { label, id, type, className, meta } = this.props;\n    return (\n      <DragDroppable\n        component={{ type, id, meta }}\n        parentComponent={{\n          id: NEW_COMPONENTS_SOURCE_ID,\n          type: NEW_COMPONENT_SOURCE_TYPE,\n        }}\n        index={0}\n        depth={0}\n        editMode\n      >\n        {({ dragSourceRef }) => (\n          <div\n            ref={dragSourceRef}\n            className=\"new-component\"\n            data-test=\"new-component\"\n          >\n            <div className={cx('new-component-placeholder', className)} />\n            {label}\n          </div>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nDraggableNewComponent.propTypes = propTypes;\nDraggableNewComponent.defaultProps = defaultProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { COLUMN_TYPE } from '../../../util/componentTypes';\nimport { NEW_COLUMN_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewColumn() {\n  return (\n    <DraggableNewComponent\n      id={NEW_COLUMN_ID}\n      type={COLUMN_TYPE}\n      label={t('Column')}\n      className=\"fa fa-long-arrow-down\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { DIVIDER_TYPE } from '../../../util/componentTypes';\nimport { NEW_DIVIDER_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewDivider() {\n  return (\n    <DraggableNewComponent\n      id={NEW_DIVIDER_ID}\n      type={DIVIDER_TYPE}\n      label={t('Divider')}\n      className=\"divider-placeholder\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { HEADER_TYPE } from '../../../util/componentTypes';\nimport { NEW_HEADER_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewHeader() {\n  return (\n    <DraggableNewComponent\n      id={NEW_HEADER_ID}\n      type={HEADER_TYPE}\n      label={t('Header')}\n      className=\"fa fa-header\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { ROW_TYPE } from '../../../util/componentTypes';\nimport { NEW_ROW_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewRow() {\n  return (\n    <DraggableNewComponent\n      id={NEW_ROW_ID}\n      type={ROW_TYPE}\n      label={t('Row')}\n      className=\"fa fa-long-arrow-right\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { TABS_TYPE } from '../../../util/componentTypes';\nimport { NEW_TABS_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewTabs() {\n  return (\n    <DraggableNewComponent\n      id={NEW_TABS_ID}\n      type={TABS_TYPE}\n      label={t('Tabs')}\n      className=\"fa fa-window-restore\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\n\nimport { MARKDOWN_TYPE } from '../../../util/componentTypes';\nimport { NEW_MARKDOWN_ID } from '../../../util/constants';\nimport DraggableNewComponent from './DraggableNewComponent';\n\nexport default function DraggableNewDivider() {\n  return (\n    <DraggableNewComponent\n      id={NEW_MARKDOWN_ID}\n      type={MARKDOWN_TYPE}\n      label=\"Markdown\"\n      className=\"fa fa-code\"\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC } from 'react';\nimport DraggableNewComponent from './DraggableNewComponent';\nimport { DYNAMIC_TYPE } from '../../../util/componentTypes';\nimport { NEW_DYNAMIC_COMPONENT } from '../../../util/constants';\nimport { DashboardComponentsRegistryMetadata } from '../../../../visualizations/dashboardComponents/DashboardComponentsRegistry';\n\ntype DraggableNewDynamicComponent = {\n  componentKey: string;\n  metadata: DashboardComponentsRegistryMetadata;\n};\n\nconst DraggableNewDynamicComponent: FC<DraggableNewDynamicComponent> = ({\n  componentKey,\n  metadata,\n}) => (\n  <DraggableNewComponent\n    id={NEW_DYNAMIC_COMPONENT}\n    type={DYNAMIC_TYPE}\n    label={metadata.name}\n    meta={{ metadata, componentKey }}\n    className={`fa fa-${metadata.iconName}`}\n  />\n);\n\nexport default DraggableNewDynamicComponent;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport React from 'react';\nimport Tabs from 'src/components/Tabs';\nimport { StickyContainer, Sticky } from 'react-sticky';\nimport { ParentSize } from '@vx/responsive';\n\nimport { t, styled } from '@superset-ui/core';\n\nimport SliceAdder from 'src/dashboard/containers/SliceAdder';\nimport dashboardComponents from 'src/visualizations/presets/dashboardComponents';\nimport NewColumn from '../gridComponents/new/NewColumn';\nimport NewDivider from '../gridComponents/new/NewDivider';\nimport NewHeader from '../gridComponents/new/NewHeader';\nimport NewRow from '../gridComponents/new/NewRow';\nimport NewTabs from '../gridComponents/new/NewTabs';\nimport NewMarkdown from '../gridComponents/new/NewMarkdown';\nimport NewDynamicComponent from '../gridComponents/new/NewDynamicComponent';\n\nexport interface BCPProps {\n  isStandalone: boolean;\n  topOffset: number;\n}\n\nconst SUPERSET_HEADER_HEIGHT = 59;\nconst SIDEPANE_ADJUST_OFFSET = 4;\nconst SIDEPANE_HEADER_HEIGHT = 64; // including margins\nconst SIDEPANE_FILTERBAR_HEIGHT = 56;\n\nconst BuilderComponentPaneTabs = styled(Tabs)`\n  line-height: inherit;\n  margin-top: ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\nconst DashboardBuilderSidepane = styled.div<{\n  topOffset: number;\n}>`\n  height: 100%;\n  position: fixed;\n  right: 0;\n  top: 0;\n\n  .ReactVirtualized__List {\n    padding-bottom: ${({ topOffset }) =>\n      `${\n        SIDEPANE_HEADER_HEIGHT +\n        SIDEPANE_FILTERBAR_HEIGHT +\n        SIDEPANE_ADJUST_OFFSET +\n        topOffset\n      }px`};\n  }\n`;\n\nconst BuilderComponentPane: React.FC<BCPProps> = ({\n  isStandalone,\n  topOffset = 0,\n}) => (\n  <DashboardBuilderSidepane\n    topOffset={topOffset}\n    className=\"dashboard-builder-sidepane\"\n  >\n    <ParentSize>\n      {({ height }) => (\n        <StickyContainer>\n          <Sticky topOffset={-topOffset} bottomOffset={Infinity}>\n            {({ style, isSticky }: { style: any; isSticky: boolean }) => {\n              const { pageYOffset } = window;\n              const hasHeader =\n                pageYOffset < SUPERSET_HEADER_HEIGHT && !isStandalone;\n              const withHeaderTopOffset =\n                topOffset +\n                (SUPERSET_HEADER_HEIGHT - pageYOffset - SIDEPANE_ADJUST_OFFSET);\n\n              return (\n                <div\n                  className=\"viewport\"\n                  style={{\n                    ...style,\n                    top: hasHeader ? withHeaderTopOffset : topOffset,\n                  }}\n                >\n                  <BuilderComponentPaneTabs\n                    id=\"tabs\"\n                    className=\"tabs-components\"\n                    data-test=\"dashboard-builder-component-pane-tabs-navigation\"\n                  >\n                    <Tabs.TabPane\n                      key={1}\n                      tab={t('Charts')}\n                      className=\"tab-charts\"\n                    >\n                      <SliceAdder\n                        height={\n                          height + (isSticky ? SUPERSET_HEADER_HEIGHT : 0)\n                        }\n                      />\n                    </Tabs.TabPane>\n                    <Tabs.TabPane key={2} tab={t('Layout elements')}>\n                      <NewTabs />\n                      <NewRow />\n                      <NewColumn />\n                      <NewHeader />\n                      <NewMarkdown />\n                      <NewDivider />\n                      {dashboardComponents\n                        .getAll()\n                        .map(({ key: componentKey, metadata }) => (\n                          <NewDynamicComponent\n                            metadata={metadata}\n                            componentKey={componentKey}\n                          />\n                        ))}\n                    </Tabs.TabPane>\n                  </BuilderComponentPaneTabs>\n                </div>\n              );\n            }}\n          </Sticky>\n        </StickyContainer>\n      )}\n    </ParentSize>\n  </DashboardBuilderSidepane>\n);\n\nexport default BuilderComponentPane;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport copyTextToClipboard from 'src/utils/copy';\nimport { t, logging } from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport { getDashboardPermalink, getUrlParam } from 'src/utils/urlUtils';\nimport { URL_PARAMS } from 'src/constants';\nimport { getFilterValue } from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\n\ninterface ShareMenuItemProps {\n  url?: string;\n  copyMenuItemTitle: string;\n  emailMenuItemTitle: string;\n  emailSubject: string;\n  emailBody: string;\n  addDangerToast: Function;\n  addSuccessToast: Function;\n  dashboardId: string | number;\n  dashboardComponentId?: string;\n}\n\nconst ShareMenuItems = (props: ShareMenuItemProps) => {\n  const {\n    copyMenuItemTitle,\n    emailMenuItemTitle,\n    emailSubject,\n    emailBody,\n    addDangerToast,\n    addSuccessToast,\n    dashboardId,\n    dashboardComponentId,\n    ...rest\n  } = props;\n\n  async function generateUrl() {\n    const nativeFiltersKey = getUrlParam(URL_PARAMS.nativeFiltersKey);\n    let filterState = {};\n    if (nativeFiltersKey && dashboardId) {\n      filterState = await getFilterValue(dashboardId, nativeFiltersKey);\n    }\n    return getDashboardPermalink({\n      dashboardId,\n      filterState,\n      hash: dashboardComponentId,\n    });\n  }\n\n  async function onCopyLink() {\n    try {\n      await copyTextToClipboard(generateUrl);\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      logging.error(error);\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }\n\n  async function onShareByEmail() {\n    try {\n      const encodedBody = encodeURIComponent(\n        `${emailBody}${await generateUrl()}`,\n      );\n      const encodedSubject = encodeURIComponent(emailSubject);\n      window.location.href = `mailto:?Subject=${encodedSubject}%20&Body=${encodedBody}`;\n    } catch (error) {\n      logging.error(error);\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }\n\n  return (\n    <Menu selectable={false}>\n      <Menu.Item key=\"copy-url\" {...rest}>\n        <div onClick={onCopyLink} role=\"button\" tabIndex={0}>\n          {copyMenuItemTitle}\n        </div>\n      </Menu.Item>\n      <Menu.Item key=\"share-by-email\" {...rest}>\n        <div onClick={onShareByEmail} role=\"button\" tabIndex={0}>\n          {emailMenuItemTitle}\n        </div>\n      </Menu.Item>\n    </Menu>\n  );\n};\n\nexport default ShareMenuItems;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { AntdDropdown } from 'src/components';\nimport { Menu } from 'src/components/Menu';\nimport Button from 'src/components/Button';\nimport { t, styled } from '@superset-ui/core';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { CssEditor as AceCssEditor } from 'src/components/AsyncAceEditor';\n\nconst StyledWrapper = styled.div`\n  ${({ theme }) => `\n    .css-editor-header {\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      margin-bottom: ${theme.gridUnit * 2}px;\n\n      h5 {\n        margin-top: ${theme.gridUnit}px;\n      }\n    }\n    .css-editor {\n      border: 1px solid ${theme.colors.grayscale.light1};\n    }\n  `}\n`;\n\nconst propTypes = {\n  initialCss: PropTypes.string,\n  triggerNode: PropTypes.node.isRequired,\n  onChange: PropTypes.func,\n  templates: PropTypes.array,\n};\n\nconst defaultProps = {\n  initialCss: '',\n  onChange: () => {},\n};\n\nclass CssEditor extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      css: props.initialCss,\n    };\n    this.changeCss = this.changeCss.bind(this);\n    this.changeCssTemplate = this.changeCssTemplate.bind(this);\n  }\n\n  componentDidMount() {\n    AceCssEditor.preload();\n  }\n\n  changeCss(css) {\n    this.setState({ css }, () => {\n      this.props.onChange(css);\n    });\n  }\n\n  changeCssTemplate({ key }) {\n    this.changeCss(key);\n  }\n\n  renderTemplateSelector() {\n    if (this.props.templates) {\n      const menu = (\n        <Menu onClick={this.changeCssTemplate}>\n          {this.props.templates.map(template => (\n            <Menu.Item key={template.css}>{template.label}</Menu.Item>\n          ))}\n        </Menu>\n      );\n\n      return (\n        <AntdDropdown overlay={menu} placement=\"bottomRight\">\n          <Button>{t('Load a CSS template')}</Button>\n        </AntdDropdown>\n      );\n    }\n    return null;\n  }\n\n  render() {\n    return (\n      <ModalTrigger\n        triggerNode={this.props.triggerNode}\n        modalTitle={t('CSS')}\n        modalBody={\n          <StyledWrapper>\n            <div className=\"css-editor-header\">\n              <h5>{t('Live CSS editor')}</h5>\n              {this.renderTemplateSelector()}\n            </div>\n            <AceCssEditor\n              className=\"css-editor\"\n              minLines={12}\n              maxLines={30}\n              onChange={this.changeCss}\n              height=\"200px\"\n              width=\"100%\"\n              editorProps={{ $blockScrolling: true }}\n              enableLiveAutocompletion\n              value={this.state.css || ''}\n            />\n          </StyledWrapper>\n        }\n      />\n    );\n  }\n}\n\nCssEditor.propTypes = propTypes;\nCssEditor.defaultProps = defaultProps;\n\nexport default CssEditor;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport Select, { propertyComparator } from 'src/components/Select/Select';\nimport { t, styled } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport Button from 'src/components/Button';\n\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { FormLabel } from 'src/components/Form';\n\nconst StyledModalTrigger = styled(ModalTrigger)`\n  .ant-modal-body {\n    overflow: visible;\n  }\n`;\n\nconst RefreshWarningContainer = styled.div`\n  margin-top: ${({ theme }) => theme.gridUnit * 6}px;\n`;\n\ntype RefreshIntervalModalProps = {\n  addSuccessToast: (msg: string) => void;\n  triggerNode: JSX.Element;\n  refreshFrequency: number;\n  onChange: (refreshLimit: number, editMode: boolean) => void;\n  editMode: boolean;\n  refreshLimit?: number;\n  refreshWarning: string | null;\n  refreshIntervalOptions: [number, string][];\n};\n\ntype RefreshIntervalModalState = {\n  refreshFrequency: number;\n};\n\nclass RefreshIntervalModal extends React.PureComponent<\n  RefreshIntervalModalProps,\n  RefreshIntervalModalState\n> {\n  static defaultProps = {\n    refreshLimit: 0,\n    refreshWarning: null,\n  };\n\n  modalRef: RefObject<ModalTrigger>;\n\n  constructor(props: RefreshIntervalModalProps) {\n    super(props);\n    this.modalRef = React.createRef();\n    this.state = {\n      refreshFrequency: props.refreshFrequency,\n    };\n    this.handleFrequencyChange = this.handleFrequencyChange.bind(this);\n    this.onSave = this.onSave.bind(this);\n    this.onCancel = this.onCancel.bind(this);\n  }\n\n  onSave() {\n    this.props.onChange(this.state.refreshFrequency, this.props.editMode);\n    this.modalRef.current?.close();\n    this.props.addSuccessToast(t('Refresh interval saved'));\n  }\n\n  onCancel() {\n    this.setState({\n      refreshFrequency: this.props.refreshFrequency,\n    });\n    this.modalRef.current?.close();\n  }\n\n  handleFrequencyChange(value: number) {\n    const { refreshIntervalOptions } = this.props;\n    this.setState({\n      refreshFrequency: value || refreshIntervalOptions[0][0],\n    });\n  }\n\n  render() {\n    const {\n      refreshLimit = 0,\n      refreshWarning,\n      editMode,\n      refreshIntervalOptions,\n    } = this.props;\n    const { refreshFrequency = 0 } = this.state;\n    const showRefreshWarning =\n      !!refreshFrequency && !!refreshWarning && refreshFrequency < refreshLimit;\n\n    return (\n      <StyledModalTrigger\n        ref={this.modalRef}\n        triggerNode={this.props.triggerNode}\n        modalTitle={t('Refresh interval')}\n        modalBody={\n          <div>\n            <FormLabel>{t('Refresh frequency')}</FormLabel>\n            <Select\n              ariaLabel={t('Refresh interval')}\n              options={refreshIntervalOptions.map(option => ({\n                value: option[0],\n                label: t(option[1]),\n              }))}\n              value={refreshFrequency}\n              onChange={this.handleFrequencyChange}\n              sortComparator={propertyComparator('value')}\n            />\n            {showRefreshWarning && (\n              <RefreshWarningContainer>\n                <Alert\n                  type=\"warning\"\n                  message={\n                    <>\n                      <div>{refreshWarning}</div>\n                      <br />\n                      <strong>{t('Are you sure you want to proceed?')}</strong>\n                    </>\n                  }\n                />\n              </RefreshWarningContainer>\n            )}\n          </div>\n        }\n        modalFooter={\n          <>\n            <Button\n              buttonStyle=\"primary\"\n              buttonSize=\"small\"\n              onClick={this.onSave}\n            >\n              {editMode ? t('Save') : t('Save for this session')}\n            </Button>\n            <Button onClick={this.onCancel} buttonSize=\"small\">\n              {t('Cancel')}\n            </Button>\n          </>\n        }\n      />\n    );\n  }\n}\n\nexport default RefreshIntervalModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport React from 'react';\nimport { Radio } from 'src/components/Radio';\nimport { RadioChangeEvent } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport Button from 'src/components/Button';\nimport { t, JsonResponse } from '@superset-ui/core';\n\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Checkbox from 'src/components/Checkbox';\nimport {\n  SAVE_TYPE_OVERWRITE,\n  SAVE_TYPE_NEWDASHBOARD,\n} from 'src/dashboard/util/constants';\n\ntype SaveType = typeof SAVE_TYPE_OVERWRITE | typeof SAVE_TYPE_NEWDASHBOARD;\n\ntype SaveModalProps = {\n  addSuccessToast: (arg: string) => void;\n  addDangerToast: (arg: string) => void;\n  dashboardId: number;\n  dashboardTitle: string;\n  dashboardInfo: Record<string, any>;\n  expandedSlices: Record<string, any>;\n  layout: Record<string, any>;\n  saveType: SaveType;\n  triggerNode: JSX.Element;\n  customCss: string;\n  colorNamespace?: string;\n  colorScheme?: string;\n  onSave: (data: any, id: number | string, saveType: SaveType) => void;\n  canOverwrite: boolean;\n  shouldPersistRefreshFrequency: boolean;\n  refreshFrequency: number;\n  lastModifiedTime: number;\n};\n\ntype SaveModalState = {\n  saveType: SaveType;\n  newDashName: string;\n  duplicateSlices: boolean;\n};\n\nconst defaultProps = {\n  saveType: SAVE_TYPE_OVERWRITE,\n  colorNamespace: undefined,\n  colorScheme: undefined,\n  shouldPersistRefreshFrequency: false,\n};\n\nclass SaveModal extends React.PureComponent<SaveModalProps, SaveModalState> {\n  static defaultProps = defaultProps;\n\n  modal: ModalTrigger | null;\n\n  onSave: (\n    data: Record<string, any>,\n    dashboardId: number | string,\n    saveType: SaveType,\n  ) => Promise<JsonResponse>;\n\n  constructor(props: SaveModalProps) {\n    super(props);\n    this.state = {\n      saveType: props.saveType,\n      newDashName: `${props.dashboardTitle} [copy]`,\n      duplicateSlices: false,\n    };\n    this.modal = null;\n    this.handleSaveTypeChange = this.handleSaveTypeChange.bind(this);\n    this.handleNameChange = this.handleNameChange.bind(this);\n    this.saveDashboard = this.saveDashboard.bind(this);\n    this.setModalRef = this.setModalRef.bind(this);\n    this.toggleDuplicateSlices = this.toggleDuplicateSlices.bind(this);\n    this.onSave = this.props.onSave.bind(this);\n  }\n\n  setModalRef(ref: ModalTrigger | null) {\n    this.modal = ref;\n  }\n\n  toggleDuplicateSlices(): void {\n    this.setState(prevState => ({\n      duplicateSlices: !prevState.duplicateSlices,\n    }));\n  }\n\n  handleSaveTypeChange(event: RadioChangeEvent) {\n    this.setState({\n      saveType: (event.target as HTMLInputElement).value as SaveType,\n    });\n  }\n\n  handleNameChange(name: string) {\n    this.setState({\n      newDashName: name,\n      saveType: SAVE_TYPE_NEWDASHBOARD,\n    });\n  }\n\n  saveDashboard() {\n    const { saveType, newDashName } = this.state;\n    const {\n      dashboardTitle,\n      dashboardInfo,\n      layout: positions,\n      customCss,\n      dashboardId,\n      refreshFrequency: currentRefreshFrequency,\n      shouldPersistRefreshFrequency,\n      lastModifiedTime,\n    } = this.props;\n\n    // check refresh frequency is for current session or persist\n    const refreshFrequency = shouldPersistRefreshFrequency\n      ? currentRefreshFrequency\n      : dashboardInfo.metadata?.refresh_frequency; // eslint-disable camelcase\n\n    const data = {\n      certified_by: dashboardInfo.certified_by,\n      certification_details: dashboardInfo.certification_details,\n      css: customCss,\n      dashboard_title:\n        saveType === SAVE_TYPE_NEWDASHBOARD ? newDashName : dashboardTitle,\n      duplicate_slices: this.state.duplicateSlices,\n      last_modified_time: lastModifiedTime,\n      owners: dashboardInfo.owners,\n      roles: dashboardInfo.roles,\n      metadata: {\n        ...dashboardInfo?.metadata,\n        positions,\n        refresh_frequency: refreshFrequency,\n      },\n    };\n\n    if (saveType === SAVE_TYPE_NEWDASHBOARD && !newDashName) {\n      this.props.addDangerToast(\n        t('You must pick a name for the new dashboard'),\n      );\n    } else {\n      this.onSave(data, dashboardId, saveType).then((resp: JsonResponse) => {\n        if (\n          saveType === SAVE_TYPE_NEWDASHBOARD &&\n          resp &&\n          resp.json &&\n          resp.json.id\n        ) {\n          window.location.href = `/superset/dashboard/${resp.json.id}/`;\n        }\n      });\n      this.modal?.close();\n    }\n  }\n\n  render() {\n    return (\n      <ModalTrigger\n        ref={this.setModalRef}\n        triggerNode={this.props.triggerNode}\n        modalTitle={t('Save dashboard')}\n        modalBody={\n          <div>\n            <Radio\n              value={SAVE_TYPE_OVERWRITE}\n              onChange={this.handleSaveTypeChange}\n              checked={this.state.saveType === SAVE_TYPE_OVERWRITE}\n              disabled={!this.props.canOverwrite}\n            >\n              {t('Overwrite Dashboard [%s]', this.props.dashboardTitle)}\n            </Radio>\n            <hr />\n            <Radio\n              value={SAVE_TYPE_NEWDASHBOARD}\n              onChange={this.handleSaveTypeChange}\n              checked={this.state.saveType === SAVE_TYPE_NEWDASHBOARD}\n            >\n              {t('Save as:')}\n            </Radio>\n            <Input\n              type=\"text\"\n              placeholder={t('[dashboard name]')}\n              value={this.state.newDashName}\n              onFocus={e => this.handleNameChange(e.target.value)}\n              onChange={e => this.handleNameChange(e.target.value)}\n            />\n            <div className=\"m-l-25 m-t-5\">\n              <Checkbox\n                checked={this.state.duplicateSlices}\n                onChange={() => this.toggleDuplicateSlices()}\n              />\n              <span className=\"m-l-5\">{t('also copy (duplicate) charts')}</span>\n            </div>\n          </div>\n        }\n        modalFooter={\n          <div>\n            <Button\n              data-test=\"modal-save-dashboard-button\"\n              buttonStyle=\"primary\"\n              onClick={this.saveDashboard}\n            >\n              {t('Save')}\n            </Button>\n          </div>\n        }\n      />\n    );\n  }\n}\n\nexport default SaveModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isEmpty } from 'lodash';\nimport { t } from '@superset-ui/core';\n\nimport { DASHBOARD_ROOT_ID } from './constants';\nimport { CHART_TYPE, DASHBOARD_ROOT_TYPE, TAB_TYPE } from './componentTypes';\n\nconst FILTER_SCOPE_CONTAINER_TYPES = [TAB_TYPE, DASHBOARD_ROOT_TYPE];\n\nfunction traverse({\n  currentNode = {},\n  components = {},\n  filterFields = [],\n  selectedChartId,\n}) {\n  if (!currentNode) {\n    return null;\n  }\n\n  const { type } = currentNode;\n  if (\n    CHART_TYPE === type &&\n    currentNode &&\n    currentNode.meta &&\n    currentNode.meta.chartId\n  ) {\n    const chartNode = {\n      value: currentNode.meta.chartId,\n      label:\n        currentNode.meta.sliceName || `${type} ${currentNode.meta.chartId}`,\n      type,\n      showCheckbox: selectedChartId !== currentNode.meta.chartId,\n    };\n\n    return {\n      ...chartNode,\n      children: filterFields.map(filterField => ({\n        value: `${currentNode.meta.chartId}:${filterField}`,\n        label: `${chartNode.label}`,\n        type: 'filter_box',\n        showCheckbox: false,\n      })),\n    };\n  }\n\n  let children = [];\n  if (currentNode.children && currentNode.children.length) {\n    currentNode.children.forEach(child => {\n      const childNodeTree = traverse({\n        currentNode: components[child],\n        components,\n        filterFields,\n        selectedChartId,\n      });\n\n      const childType = components[child].type;\n      if (FILTER_SCOPE_CONTAINER_TYPES.includes(childType)) {\n        children.push(childNodeTree);\n      } else {\n        children = children.concat(childNodeTree);\n      }\n    });\n  }\n\n  if (FILTER_SCOPE_CONTAINER_TYPES.includes(type)) {\n    let label = null;\n    if (type === DASHBOARD_ROOT_TYPE) {\n      label = t('All charts');\n    } else {\n      label =\n        currentNode.meta && currentNode.meta.text\n          ? currentNode.meta.text\n          : `${type} ${currentNode.id}`;\n    }\n\n    return {\n      value: currentNode.id,\n      label,\n      type,\n      children,\n    };\n  }\n\n  return children;\n}\n\nexport default function getFilterScopeNodesTree({\n  components = {},\n  filterFields = [],\n  selectedChartId,\n}) {\n  if (isEmpty(components)) {\n    return [];\n  }\n\n  const root = traverse({\n    currentNode: components[DASHBOARD_ROOT_ID],\n    components,\n    filterFields,\n    selectedChartId,\n  });\n  return [\n    {\n      ...root,\n    },\n  ];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function getFilterScopeParentNodes(nodes = [], depthLimit = -1) {\n  const parentNodes = [];\n  const traverse = (currentNode, depth) => {\n    if (!currentNode) {\n      return;\n    }\n\n    if (currentNode.children && (depthLimit === -1 || depth < depthLimit)) {\n      parentNodes.push(currentNode.value);\n      currentNode.children.forEach(child => traverse(child, depth + 1));\n    }\n  };\n\n  if (nodes.length > 0) {\n    nodes.forEach(node => {\n      traverse(node, 0);\n    });\n  }\n\n  return parentNodes;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { safeStringify } from '../../utils/safeStringify';\n\nexport default function getKeyForFilterScopeTree({\n  activeFilterField,\n  checkedFilterFields,\n}) {\n  return safeStringify(\n    activeFilterField ? [activeFilterField] : checkedFilterFields,\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getChartIdAndColumnFromFilterKey } from './getDashboardFilterKey';\n\nexport default function getSelectedChartIdForFilterScopeTree({\n  activeFilterField,\n  checkedFilterFields,\n}) {\n  // we don't apply filter on filter_box itself, so we will disable\n  // checkbox in filter scope selector.\n  // this function returns chart id based on current filter scope selector local state:\n  // 1. if in single-edit mode, return the chart id for selected filter field.\n  // 2. if in multi-edit mode, if all filter fields are from same chart id,\n  // return the single chart id.\n  // otherwise, there is no chart to disable.\n  if (activeFilterField) {\n    return getChartIdAndColumnFromFilterKey(activeFilterField).chartId;\n  }\n\n  if (checkedFilterFields.length) {\n    const { chartId } = getChartIdAndColumnFromFilterKey(\n      checkedFilterFields[0],\n    );\n\n    if (\n      checkedFilterFields.some(\n        filterKey =>\n          getChartIdAndColumnFromFilterKey(filterKey).chartId !== chartId,\n      )\n    ) {\n      return null;\n    }\n    return chartId;\n  }\n\n  return null;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport getFilterScopeNodesTree from './getFilterScopeNodesTree';\nimport getFilterScopeParentNodes from './getFilterScopeParentNodes';\nimport getKeyForFilterScopeTree from './getKeyForFilterScopeTree';\nimport getSelectedChartIdForFilterScopeTree from './getSelectedChartIdForFilterScopeTree';\n\nexport default function buildFilterScopeTreeEntry({\n  checkedFilterFields = [],\n  activeFilterField,\n  filterScopeMap = {},\n  layout = {},\n}) {\n  const key = getKeyForFilterScopeTree({\n    checkedFilterFields,\n    activeFilterField,\n  });\n  const editingList = activeFilterField\n    ? [activeFilterField]\n    : checkedFilterFields;\n  const selectedChartId = getSelectedChartIdForFilterScopeTree({\n    checkedFilterFields,\n    activeFilterField,\n  });\n  const nodes = getFilterScopeNodesTree({\n    components: layout,\n    filterFields: editingList,\n    selectedChartId,\n  });\n  const checkedChartIdSet = new Set();\n  editingList.forEach(filterField => {\n    (filterScopeMap[filterField].checked || []).forEach(chartId => {\n      checkedChartIdSet.add(`${chartId}:${filterField}`);\n    });\n  });\n  const checked = [...checkedChartIdSet];\n  const expanded = filterScopeMap[key]\n    ? filterScopeMap[key].expanded\n    : getFilterScopeParentNodes(nodes, 1);\n\n  return {\n    [key]: {\n      nodes,\n      nodesFiltered: [...nodes],\n      checked,\n      expanded,\n    },\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { flow, keyBy, mapValues } from 'lodash/fp';\nimport { flatMap, isEmpty } from 'lodash';\n\nimport { CHART_TYPE, TAB_TYPE } from './componentTypes';\nimport { getChartIdAndColumnFromFilterKey } from './getDashboardFilterKey';\n\nfunction getImmuneChartIdsFromTabsNotInScope({ tabs = [], tabsInScope = [] }) {\n  const chartsNotInScope = [];\n  tabs.forEach(({ value: tab, children: tabChildren }) => {\n    if (tabChildren && !tabsInScope.includes(tab)) {\n      tabChildren.forEach(({ value: subTab, children: subTabChildren }) => {\n        if (subTabChildren && !tabsInScope.includes(subTab)) {\n          chartsNotInScope.push(\n            ...subTabChildren.filter(({ type }) => type === CHART_TYPE),\n          );\n        }\n      });\n    }\n  });\n\n  // return chartId only\n  return chartsNotInScope.map(({ value }) => value);\n}\nfunction getTabChildrenScope({\n  tabScopes,\n  parentNodeValue,\n  forceAggregate = false,\n  hasChartSiblings = false,\n  tabChildren = [],\n  immuneChartSiblings = [],\n}) {\n  // if all sub-tabs are in scope, or forceAggregate =  true\n  // aggregate scope to parentNodeValue\n  if (\n    forceAggregate ||\n    (!hasChartSiblings &&\n      Object.entries(tabScopes).every(\n        ([key, { scope }]) => scope && scope.length && key === scope[0],\n      ))\n  ) {\n    // get all charts from tabChildren that is not in scope\n    const immuneChartIdsFromTabsNotInScope =\n      getImmuneChartIdsFromTabsNotInScope({\n        tabs: tabChildren,\n        tabsInScope: flatMap(tabScopes, ({ scope }) => scope),\n      });\n    const immuneChartIdsFromTabsInScope = flatMap(\n      Object.values(tabScopes),\n      ({ immune }) => immune,\n    );\n    const immuneCharts = [\n      ...new Set([\n        ...immuneChartIdsFromTabsNotInScope,\n        ...immuneChartIdsFromTabsInScope,\n      ]),\n    ];\n    return {\n      scope: [parentNodeValue],\n      immune: immuneCharts,\n    };\n  }\n\n  const componentsInScope = Object.values(tabScopes).filter(\n    ({ scope }) => scope && scope.length,\n  );\n  return {\n    scope: flatMap(componentsInScope, ({ scope }) => scope),\n    immune: componentsInScope.length\n      ? flatMap(componentsInScope, ({ immune }) => immune)\n      : flatMap(Object.values(tabScopes), ({ immune }) => immune).concat(\n          immuneChartSiblings,\n        ),\n  };\n}\n\nfunction traverse({ currentNode = {}, filterId, checkedChartIds = [] }) {\n  if (!currentNode) {\n    return {};\n  }\n\n  const { value: currentValue, children } = currentNode;\n  const chartChildren = children.filter(({ type }) => type === CHART_TYPE);\n  const tabChildren = children.filter(({ type }) => type === TAB_TYPE);\n\n  const chartsImmune = chartChildren\n    .filter(\n      ({ value }) => filterId !== value && !checkedChartIds.includes(value),\n    )\n    .map(({ value }) => value);\n  const tabScopes = flow(\n    keyBy(child => child.value),\n    mapValues(child =>\n      traverse({\n        currentNode: child,\n        filterId,\n        checkedChartIds,\n      }),\n    ),\n  )(tabChildren);\n\n  // if any chart type child is in scope,\n  // no matter has tab children or not, current node should be scope\n  if (\n    !isEmpty(chartChildren) &&\n    chartChildren.some(({ value }) => checkedChartIds.includes(value))\n  ) {\n    if (isEmpty(tabChildren)) {\n      return { scope: [currentValue], immune: chartsImmune };\n    }\n\n    const { scope, immune } = getTabChildrenScope({\n      tabScopes,\n      parentNodeValue: currentValue,\n      forceAggregate: true,\n      tabChildren,\n    });\n    return {\n      scope,\n      immune: chartsImmune.concat(immune),\n    };\n  }\n\n  // has tab children but only some sub-tab in scope\n  if (tabChildren.length) {\n    return getTabChildrenScope({\n      tabScopes,\n      parentNodeValue: currentValue,\n      hasChartSiblings: !isEmpty(chartChildren),\n      tabChildren,\n      immuneChartSiblings: chartsImmune,\n    });\n  }\n\n  // no tab children and no chart children in scope\n  return {\n    scope: [],\n    immune: chartsImmune,\n  };\n}\n\nexport default function getFilterScopeFromNodesTree({\n  filterKey,\n  nodes = [],\n  checkedChartIds = [],\n}) {\n  if (nodes.length) {\n    const { chartId } = getChartIdAndColumnFromFilterKey(filterKey);\n    return traverse({\n      currentNode: nodes[0],\n      filterId: chartId,\n      checkedChartIds,\n    });\n  }\n\n  return {};\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport cx from 'classnames';\nimport { styled } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { CHART_TYPE } from 'src/dashboard/util/componentTypes';\n\nconst ChartIcon = styled(Icons.BarChartOutlined)`\n  ${({ theme }) => `\n    position: relative;\n    top: ${theme.gridUnit - 1}px;\n    color: ${theme.colors.primary.base};\n    margin-right: ${theme.gridUnit * 2}px;\n  `}\n`;\n\nfunction traverse({ currentNode = {}, selectedChartId }) {\n  if (!currentNode) {\n    return null;\n  }\n\n  const { label, value, type, children } = currentNode;\n  if (children && children.length) {\n    const updatedChildren = children.map(child =>\n      traverse({ currentNode: child, selectedChartId }),\n    );\n    return {\n      ...currentNode,\n      label: (\n        <span\n          className={cx(`filter-scope-type ${type.toLowerCase()}`, {\n            'selected-filter': selectedChartId === value,\n          })}\n        >\n          {type === CHART_TYPE && <ChartIcon />}\n          {label}\n        </span>\n      ),\n      children: updatedChildren,\n    };\n  }\n  return {\n    ...currentNode,\n    label: (\n      <span\n        className={cx(`filter-scope-type ${type.toLowerCase()}`, {\n          'selected-filter': selectedChartId === value,\n        })}\n      >\n        {label}\n      </span>\n    ),\n  };\n}\n\nexport default function renderFilterScopeTreeNodes({ nodes, selectedChartId }) {\n  if (!nodes) {\n    return [];\n  }\n\n  return nodes.map(node => traverse({ currentNode: node, selectedChartId }));\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport 'react-checkbox-tree/lib/react-checkbox-tree.css';\n\nimport {\n  CheckboxChecked,\n  CheckboxUnchecked,\n  CheckboxHalfChecked,\n} from 'src/components/Checkbox/CheckboxIcons';\n\nconst treeIcons = {\n  check: <CheckboxChecked />,\n  uncheck: <CheckboxUnchecked />,\n  halfCheck: <CheckboxHalfChecked />,\n  expandClose: <span className=\"rct-icon rct-icon-expand-close\" />,\n  expandOpen: <span className=\"rct-icon rct-icon-expand-open\" />,\n  expandAll: (\n    <span className=\"rct-icon rct-icon-expand-all\">{t('Expand all')}</span>\n  ),\n  collapseAll: (\n    <span className=\"rct-icon rct-icon-collapse-all\">{t('Collapse all')}</span>\n  ),\n  parentClose: <span className=\"rct-icon rct-icon-parent-close\" />,\n  parentOpen: <span className=\"rct-icon rct-icon-parent-open\" />,\n  leaf: <span className=\"rct-icon rct-icon-leaf\" />,\n};\n\nexport default treeIcons;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport CheckboxTree from 'react-checkbox-tree';\nimport { filterScopeSelectorTreeNodePropShape } from 'src/dashboard/util/propShapes';\nimport renderFilterScopeTreeNodes from './renderFilterScopeTreeNodes';\nimport treeIcons from './treeIcons';\n\nconst propTypes = {\n  nodes: PropTypes.arrayOf(filterScopeSelectorTreeNodePropShape).isRequired,\n  checked: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  ).isRequired,\n  expanded: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  ).isRequired,\n  onCheck: PropTypes.func.isRequired,\n  onExpand: PropTypes.func.isRequired,\n  selectedChartId: PropTypes.number,\n};\n\nconst defaultProps = {\n  selectedChartId: null,\n};\n\nconst NOOP = () => {};\n\nexport default function FilterScopeTree({\n  nodes = [],\n  checked = [],\n  expanded = [],\n  onCheck,\n  onExpand,\n  selectedChartId,\n}) {\n  return (\n    <CheckboxTree\n      showExpandAll\n      expandOnClick\n      showNodeIcon={false}\n      nodes={renderFilterScopeTreeNodes({ nodes, selectedChartId })}\n      checked={checked}\n      expanded={expanded}\n      onCheck={onCheck}\n      onExpand={onExpand}\n      onClick={NOOP}\n      icons={treeIcons}\n    />\n  );\n}\n\nFilterScopeTree.propTypes = propTypes;\nFilterScopeTree.defaultProps = defaultProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { FormLabel } from 'src/components/Form';\n\nconst propTypes = {\n  label: PropTypes.string.isRequired,\n  isSelected: PropTypes.bool.isRequired,\n};\n\nexport default function FilterFieldItem({ label, isSelected }) {\n  return (\n    <span\n      className={cx('filter-field-item filter-container', {\n        'is-selected': isSelected,\n      })}\n    >\n      <FormLabel htmlFor={label}>{label}</FormLabel>\n    </span>\n  );\n}\n\nFilterFieldItem.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport FilterFieldItem from './FilterFieldItem';\n\nexport default function renderFilterFieldTreeNodes({ nodes, activeKey }) {\n  if (!nodes) {\n    return [];\n  }\n\n  const root = nodes[0];\n  const allFilterNodes = root.children;\n  const children = allFilterNodes.map(node => ({\n    ...node,\n    children: node.children.map(child => {\n      const { label, value } = child;\n      return {\n        ...child,\n        label: (\n          <FilterFieldItem isSelected={value === activeKey} label={label} />\n        ),\n      };\n    }),\n  }));\n\n  return [\n    {\n      ...root,\n      label: <span className=\"root\">{root.label}</span>,\n      children,\n    },\n  ];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport CheckboxTree from 'react-checkbox-tree';\nimport { filterScopeSelectorTreeNodePropShape } from 'src/dashboard/util/propShapes';\nimport treeIcons from './treeIcons';\nimport renderFilterFieldTreeNodes from './renderFilterFieldTreeNodes';\n\nconst propTypes = {\n  activeKey: PropTypes.string,\n  nodes: PropTypes.arrayOf(filterScopeSelectorTreeNodePropShape).isRequired,\n  checked: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  ).isRequired,\n  expanded: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  ).isRequired,\n  onCheck: PropTypes.func.isRequired,\n  onExpand: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  activeKey: null,\n};\n\nexport default function FilterFieldTree({\n  activeKey,\n  nodes = [],\n  checked = [],\n  expanded = [],\n  onClick,\n  onCheck,\n  onExpand,\n}) {\n  return (\n    <CheckboxTree\n      showExpandAll\n      showNodeIcon={false}\n      expandOnClick\n      nodes={renderFilterFieldTreeNodes({ nodes, activeKey })}\n      checked={checked}\n      expanded={expanded}\n      onClick={onClick}\n      onCheck={onCheck}\n      onExpand={onExpand}\n      icons={treeIcons}\n    />\n  );\n}\n\nFilterFieldTree.propTypes = propTypes;\nFilterFieldTree.defaultProps = defaultProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Button from 'src/components/Button';\nimport { t, styled } from '@superset-ui/core';\n\nimport buildFilterScopeTreeEntry from 'src/dashboard/util/buildFilterScopeTreeEntry';\nimport getFilterScopeNodesTree from 'src/dashboard/util/getFilterScopeNodesTree';\nimport getFilterFieldNodesTree from 'src/dashboard/util/getFilterFieldNodesTree';\nimport getFilterScopeParentNodes from 'src/dashboard/util/getFilterScopeParentNodes';\nimport getKeyForFilterScopeTree from 'src/dashboard/util/getKeyForFilterScopeTree';\nimport getSelectedChartIdForFilterScopeTree from 'src/dashboard/util/getSelectedChartIdForFilterScopeTree';\nimport getFilterScopeFromNodesTree from 'src/dashboard/util/getFilterScopeFromNodesTree';\nimport getRevertedFilterScope from 'src/dashboard/util/getRevertedFilterScope';\nimport { getChartIdsInFilterBoxScope } from 'src/dashboard/util/activeDashboardFilters';\nimport {\n  getChartIdAndColumnFromFilterKey,\n  getDashboardFilterKey,\n} from 'src/dashboard/util/getDashboardFilterKey';\nimport { ALL_FILTERS_ROOT } from 'src/dashboard/util/constants';\nimport { dashboardFilterPropShape } from 'src/dashboard/util/propShapes';\nimport FilterScopeTree from './FilterScopeTree';\nimport FilterFieldTree from './FilterFieldTree';\n\nconst propTypes = {\n  dashboardFilters: PropTypes.objectOf(dashboardFilterPropShape).isRequired,\n  layout: PropTypes.object.isRequired,\n\n  updateDashboardFiltersScope: PropTypes.func.isRequired,\n  setUnsavedChanges: PropTypes.func.isRequired,\n  onCloseModal: PropTypes.func.isRequired,\n};\n\nconst ActionsContainer = styled.div`\n  ${({ theme }) => `\n    height: ${theme.gridUnit * 16}px;\n\n    border-top: ${theme.gridUnit / 4}px solid ${theme.colors.primary.light3};\n    padding: ${theme.gridUnit * 6}px;\n    margin: 0 0 0 ${-theme.gridUnit * 6}px;\n    text-align: right;\n\n    .btn {\n      margin-right: ${theme.gridUnit * 4}px;\n\n      &:last-child {\n        margin-right: 0;\n      }\n    }\n  `}\n`;\n\nexport default class FilterScopeSelector extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    const { dashboardFilters, layout } = props;\n\n    if (Object.keys(dashboardFilters).length > 0) {\n      // display filter fields in tree structure\n      const filterFieldNodes = getFilterFieldNodesTree({\n        dashboardFilters,\n      });\n      // filterFieldNodes root node is dashboard_root component,\n      // so that we can offer a select/deselect all link\n      const filtersNodes = filterFieldNodes[0].children;\n      this.allfilterFields = [];\n      filtersNodes.forEach(({ children }) => {\n        children.forEach(child => {\n          this.allfilterFields.push(child.value);\n        });\n      });\n      this.defaultFilterKey = filtersNodes[0].children[0].value;\n\n      // build FilterScopeTree object for each filterKey\n      const filterScopeMap = Object.values(dashboardFilters).reduce(\n        (map, { chartId: filterId, columns }) => {\n          const filterScopeByChartId = Object.keys(columns).reduce(\n            (mapByChartId, columnName) => {\n              const filterKey = getDashboardFilterKey({\n                chartId: filterId,\n                column: columnName,\n              });\n              const nodes = getFilterScopeNodesTree({\n                components: layout,\n                filterFields: [filterKey],\n                selectedChartId: filterId,\n              });\n              const expanded = getFilterScopeParentNodes(nodes, 1);\n              // force display filter_box chart as unchecked, but show checkbox as disabled\n              const chartIdsInFilterScope = (\n                getChartIdsInFilterBoxScope({\n                  filterScope: dashboardFilters[filterId].scopes[columnName],\n                }) || []\n              ).filter(id => id !== filterId);\n\n              return {\n                ...mapByChartId,\n                [filterKey]: {\n                  // unfiltered nodes\n                  nodes,\n                  // filtered nodes in display if searchText is not empty\n                  nodesFiltered: [...nodes],\n                  checked: chartIdsInFilterScope,\n                  expanded,\n                },\n              };\n            },\n            {},\n          );\n\n          return {\n            ...map,\n            ...filterScopeByChartId,\n          };\n        },\n        {},\n      );\n\n      // initial state: active defaultFilerKey\n      const { chartId } = getChartIdAndColumnFromFilterKey(\n        this.defaultFilterKey,\n      );\n      const checkedFilterFields = [];\n      const activeFilterField = this.defaultFilterKey;\n      // expand defaultFilterKey in filter field tree\n      const expandedFilterIds = [ALL_FILTERS_ROOT].concat(chartId);\n\n      const filterScopeTreeEntry = buildFilterScopeTreeEntry({\n        checkedFilterFields,\n        activeFilterField,\n        filterScopeMap,\n        layout,\n      });\n      this.state = {\n        showSelector: true,\n        activeFilterField,\n        searchText: '',\n        filterScopeMap: {\n          ...filterScopeMap,\n          ...filterScopeTreeEntry,\n        },\n        filterFieldNodes,\n        checkedFilterFields,\n        expandedFilterIds,\n      };\n    } else {\n      this.state = {\n        showSelector: false,\n      };\n    }\n\n    this.filterNodes = this.filterNodes.bind(this);\n    this.onChangeFilterField = this.onChangeFilterField.bind(this);\n    this.onCheckFilterScope = this.onCheckFilterScope.bind(this);\n    this.onExpandFilterScope = this.onExpandFilterScope.bind(this);\n    this.onSearchInputChange = this.onSearchInputChange.bind(this);\n    this.onCheckFilterField = this.onCheckFilterField.bind(this);\n    this.onExpandFilterField = this.onExpandFilterField.bind(this);\n    this.onClose = this.onClose.bind(this);\n    this.onSave = this.onSave.bind(this);\n  }\n\n  onCheckFilterScope(checked = []) {\n    const { activeFilterField, filterScopeMap, checkedFilterFields } =\n      this.state;\n\n    const key = getKeyForFilterScopeTree({\n      activeFilterField,\n      checkedFilterFields,\n    });\n    const editingList = activeFilterField\n      ? [activeFilterField]\n      : checkedFilterFields;\n    const updatedEntry = {\n      ...filterScopeMap[key],\n      checked,\n    };\n\n    const updatedFilterScopeMap = getRevertedFilterScope({\n      checked,\n      filterFields: editingList,\n      filterScopeMap,\n    });\n\n    this.setState(() => ({\n      filterScopeMap: {\n        ...filterScopeMap,\n        ...updatedFilterScopeMap,\n        [key]: updatedEntry,\n      },\n    }));\n  }\n\n  onExpandFilterScope(expanded = []) {\n    const { activeFilterField, checkedFilterFields, filterScopeMap } =\n      this.state;\n    const key = getKeyForFilterScopeTree({\n      activeFilterField,\n      checkedFilterFields,\n    });\n    const updatedEntry = {\n      ...filterScopeMap[key],\n      expanded,\n    };\n    this.setState(() => ({\n      filterScopeMap: {\n        ...filterScopeMap,\n        [key]: updatedEntry,\n      },\n    }));\n  }\n\n  onCheckFilterField(checkedFilterFields = []) {\n    const { layout } = this.props;\n    const { filterScopeMap } = this.state;\n    const filterScopeTreeEntry = buildFilterScopeTreeEntry({\n      checkedFilterFields,\n      activeFilterField: null,\n      filterScopeMap,\n      layout,\n    });\n\n    this.setState(() => ({\n      activeFilterField: null,\n      checkedFilterFields,\n      filterScopeMap: {\n        ...filterScopeMap,\n        ...filterScopeTreeEntry,\n      },\n    }));\n  }\n\n  onExpandFilterField(expandedFilterIds = []) {\n    this.setState(() => ({\n      expandedFilterIds,\n    }));\n  }\n\n  onChangeFilterField(filterField = {}) {\n    const { layout } = this.props;\n    const nextActiveFilterField = filterField.value;\n    const {\n      activeFilterField: currentActiveFilterField,\n      checkedFilterFields,\n      filterScopeMap,\n    } = this.state;\n\n    // we allow single edit and multiple edit in the same view.\n    // if user click on the single filter field,\n    // will show filter scope for the single field.\n    // if user click on the same filter filed again,\n    // will toggle off the single filter field,\n    // and allow multi-edit all checked filter fields.\n    if (nextActiveFilterField === currentActiveFilterField) {\n      const filterScopeTreeEntry = buildFilterScopeTreeEntry({\n        checkedFilterFields,\n        activeFilterField: null,\n        filterScopeMap,\n        layout,\n      });\n\n      this.setState({\n        activeFilterField: null,\n        filterScopeMap: {\n          ...filterScopeMap,\n          ...filterScopeTreeEntry,\n        },\n      });\n    } else if (this.allfilterFields.includes(nextActiveFilterField)) {\n      const filterScopeTreeEntry = buildFilterScopeTreeEntry({\n        checkedFilterFields,\n        activeFilterField: nextActiveFilterField,\n        filterScopeMap,\n        layout,\n      });\n\n      this.setState({\n        activeFilterField: nextActiveFilterField,\n        filterScopeMap: {\n          ...filterScopeMap,\n          ...filterScopeTreeEntry,\n        },\n      });\n    }\n  }\n\n  onSearchInputChange(e) {\n    this.setState({ searchText: e.target.value }, this.filterTree);\n  }\n\n  onClose() {\n    this.props.onCloseModal();\n  }\n\n  onSave() {\n    const { filterScopeMap } = this.state;\n\n    const allFilterFieldScopes = this.allfilterFields.reduce(\n      (map, filterKey) => {\n        const { nodes } = filterScopeMap[filterKey];\n        const checkedChartIds = filterScopeMap[filterKey].checked;\n\n        return {\n          ...map,\n          [filterKey]: getFilterScopeFromNodesTree({\n            filterKey,\n            nodes,\n            checkedChartIds,\n          }),\n        };\n      },\n      {},\n    );\n\n    this.props.updateDashboardFiltersScope(allFilterFieldScopes);\n    this.props.setUnsavedChanges(true);\n\n    // click Save button will do save and close modal\n    this.props.onCloseModal();\n  }\n\n  filterTree() {\n    // Reset nodes back to unfiltered state\n    if (!this.state.searchText) {\n      this.setState(prevState => {\n        const { activeFilterField, checkedFilterFields, filterScopeMap } =\n          prevState;\n        const key = getKeyForFilterScopeTree({\n          activeFilterField,\n          checkedFilterFields,\n        });\n\n        const updatedEntry = {\n          ...filterScopeMap[key],\n          nodesFiltered: filterScopeMap[key].nodes,\n        };\n        return {\n          filterScopeMap: {\n            ...filterScopeMap,\n            [key]: updatedEntry,\n          },\n        };\n      });\n    } else {\n      const updater = prevState => {\n        const { activeFilterField, checkedFilterFields, filterScopeMap } =\n          prevState;\n        const key = getKeyForFilterScopeTree({\n          activeFilterField,\n          checkedFilterFields,\n        });\n\n        const nodesFiltered = filterScopeMap[key].nodes.reduce(\n          this.filterNodes,\n          [],\n        );\n        const expanded = getFilterScopeParentNodes([...nodesFiltered]);\n        const updatedEntry = {\n          ...filterScopeMap[key],\n          nodesFiltered,\n          expanded,\n        };\n\n        return {\n          filterScopeMap: {\n            ...filterScopeMap,\n            [key]: updatedEntry,\n          },\n        };\n      };\n\n      this.setState(updater);\n    }\n  }\n\n  filterNodes(filtered = [], node = {}) {\n    const { searchText } = this.state;\n    const children = (node.children || []).reduce(this.filterNodes, []);\n\n    if (\n      // Node's label matches the search string\n      node.label.toLocaleLowerCase().indexOf(searchText.toLocaleLowerCase()) >\n        -1 ||\n      // Or a children has a matching node\n      children.length\n    ) {\n      filtered.push({ ...node, children });\n    }\n\n    return filtered;\n  }\n\n  renderFilterFieldList() {\n    const {\n      activeFilterField,\n      filterFieldNodes,\n      checkedFilterFields,\n      expandedFilterIds,\n    } = this.state;\n    return (\n      <FilterFieldTree\n        activeKey={activeFilterField}\n        nodes={filterFieldNodes}\n        checked={checkedFilterFields}\n        expanded={expandedFilterIds}\n        onClick={this.onChangeFilterField}\n        onCheck={this.onCheckFilterField}\n        onExpand={this.onExpandFilterField}\n      />\n    );\n  }\n\n  renderFilterScopeTree() {\n    const {\n      filterScopeMap,\n      activeFilterField,\n      checkedFilterFields,\n      searchText,\n    } = this.state;\n\n    const key = getKeyForFilterScopeTree({\n      activeFilterField,\n      checkedFilterFields,\n    });\n\n    const selectedChartId = getSelectedChartIdForFilterScopeTree({\n      activeFilterField,\n      checkedFilterFields,\n    });\n    return (\n      <>\n        <input\n          className=\"filter-text scope-search multi-edit-mode\"\n          placeholder={t('Search...')}\n          type=\"text\"\n          value={searchText}\n          onChange={this.onSearchInputChange}\n        />\n        <FilterScopeTree\n          nodes={filterScopeMap[key].nodesFiltered}\n          checked={filterScopeMap[key].checked}\n          expanded={filterScopeMap[key].expanded}\n          onCheck={this.onCheckFilterScope}\n          onExpand={this.onExpandFilterScope}\n          // pass selectedFilterId prop to FilterScopeTree component,\n          // to hide checkbox for selected filter field itself\n          selectedChartId={selectedChartId}\n        />\n      </>\n    );\n  }\n\n  renderEditingFiltersName() {\n    const { dashboardFilters } = this.props;\n    const { activeFilterField, checkedFilterFields } = this.state;\n    const currentFilterLabels = []\n      .concat(activeFilterField || checkedFilterFields)\n      .map(key => {\n        const { chartId, column } = getChartIdAndColumnFromFilterKey(key);\n        return dashboardFilters[chartId].labels[column] || column;\n      });\n\n    return (\n      <div className=\"selected-fields multi-edit-mode\">\n        {currentFilterLabels.length === 0 && t('No filter is selected.')}\n        {currentFilterLabels.length === 1 && t('Editing 1 filter:')}\n        {currentFilterLabels.length > 1 &&\n          t('Batch editing %d filters:', currentFilterLabels.length)}\n        <span className=\"selected-scopes\">\n          {currentFilterLabels.join(', ')}\n        </span>\n      </div>\n    );\n  }\n\n  render() {\n    const { showSelector } = this.state;\n\n    return (\n      <div className=\"filter-scope-container\">\n        <div className=\"filter-scope-header\">\n          <h4>{t('Configure filter scopes')}</h4>\n          {showSelector && this.renderEditingFiltersName()}\n        </div>\n\n        <div className=\"filter-scope-body\">\n          {!showSelector ? (\n            <div className=\"warning-message\">\n              {t('There are no filters in this dashboard.')}\n            </div>\n          ) : (\n            <div className=\"filters-scope-selector\">\n              <div className={cx('filter-field-pane multi-edit-mode')}>\n                {this.renderFilterFieldList()}\n              </div>\n              <div className=\"filter-scope-pane multi-edit-mode\">\n                {this.renderFilterScopeTree()}\n              </div>\n            </div>\n          )}\n        </div>\n\n        <ActionsContainer>\n          <Button buttonSize=\"small\" onClick={this.onClose}>\n            {t('Close')}\n          </Button>\n          {showSelector && (\n            <Button\n              buttonSize=\"small\"\n              buttonStyle=\"primary\"\n              onClick={this.onSave}\n            >\n              {t('Save')}\n            </Button>\n          )}\n        </ActionsContainer>\n      </div>\n    );\n  }\n}\n\nFilterScopeSelector.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\n\nimport { getDashboardFilterKey } from './getDashboardFilterKey';\nimport { ALL_FILTERS_ROOT } from './constants';\nimport { DASHBOARD_ROOT_TYPE } from './componentTypes';\n\nexport default function getFilterFieldNodesTree({ dashboardFilters = {} }) {\n  const allFilters = Object.values(dashboardFilters).map(dashboardFilter => {\n    const { chartId, filterName, columns, labels } = dashboardFilter;\n    const children = Object.keys(columns).map(column => ({\n      value: getDashboardFilterKey({ chartId, column }),\n      label: labels[column] || column,\n    }));\n    return {\n      value: chartId,\n      label: filterName,\n      children,\n      showCheckbox: true,\n    };\n  });\n\n  return [\n    {\n      value: ALL_FILTERS_ROOT,\n      type: DASHBOARD_ROOT_TYPE,\n      label: t('All filters'),\n      children: allFilters,\n    },\n  ];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getChartIdAndColumnFromFilterKey } from './getDashboardFilterKey';\n\ninterface FilterScopeMap {\n  [key: string]: number[];\n}\n\ninterface GetRevertFilterScopeProps {\n  checked: string[];\n  filterFields: string[];\n  filterScopeMap: FilterScopeMap;\n}\n\nexport default function getRevertedFilterScope({\n  checked = [],\n  filterFields = [],\n  filterScopeMap = {},\n}: GetRevertFilterScopeProps) {\n  const checkedChartIdsByFilterField = checked.reduce<FilterScopeMap>(\n    (map, value) => {\n      const [chartId, filterField] = value.split(':');\n      return {\n        ...map,\n        [filterField]: (map[filterField] || []).concat(parseInt(chartId, 10)),\n      };\n    },\n    {},\n  );\n\n  return filterFields.reduce<FilterScopeMap>((map, filterField) => {\n    const { chartId } = getChartIdAndColumnFromFilterKey(filterField);\n    // force display filter_box chart as unchecked, but show checkbox as disabled\n    const updatedCheckedIds = (\n      checkedChartIdsByFilterField[filterField] || []\n    ).filter(id => id !== chartId);\n\n    return {\n      ...map,\n      [filterField]: {\n        ...filterScopeMap[filterField],\n        checked: updatedCheckedIds,\n      },\n    };\n  }, {});\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { updateDashboardFiltersScope } from '../actions/dashboardFilters';\nimport { setUnsavedChanges } from '../actions/dashboardState';\nimport FilterScopeSelector from '../components/filterscope/FilterScopeSelector';\n\nfunction mapStateToProps({ dashboardLayout, dashboardFilters }) {\n  return {\n    dashboardFilters,\n    layout: dashboardLayout.present,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      updateDashboardFiltersScope,\n      setUnsavedChanges,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(FilterScopeSelector);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport { styled } from '@superset-ui/core';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport FilterScope from 'src/dashboard/containers/FilterScope';\n\ntype FilterScopeModalProps = {\n  triggerNode: JSX.Element;\n};\n\nconst FilterScopeModalBody = styled.div(({ theme: { gridUnit } }) => ({\n  padding: gridUnit * 2,\n  paddingBottom: gridUnit * 3,\n}));\n\nexport default class FilterScopeModal extends React.PureComponent<\n  FilterScopeModalProps,\n  {}\n> {\n  modal: RefObject<ModalTrigger>;\n\n  constructor(props: FilterScopeModalProps) {\n    super(props);\n\n    this.modal = React.createRef();\n    this.handleCloseModal = this.handleCloseModal.bind(this);\n  }\n\n  handleCloseModal(): void {\n    if (this.modal.current) {\n      this.modal.current.close();\n    }\n  }\n\n  render() {\n    const filterScopeProps = {\n      onCloseModal: this.handleCloseModal,\n    };\n\n    return (\n      <ModalTrigger\n        ref={this.modal}\n        triggerNode={this.props.triggerNode}\n        modalBody={\n          <FilterScopeModalBody>\n            <FilterScope {...filterScopeProps} />\n          </FilterScopeModalBody>\n        }\n        width=\"80%\"\n      />\n    );\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { JsonObject } from '@superset-ui/core';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport serializeActiveFilterValues from './serializeActiveFilterValues';\n\nexport default function getDashboardUrl({\n  pathname,\n  filters = {},\n  hash = '',\n  standalone,\n}: {\n  pathname: string;\n  filters: JsonObject;\n  hash: string;\n  standalone?: number | null;\n}) {\n  const newSearchParams = new URLSearchParams();\n\n  // convert flattened { [id_column]: values } object\n  // to nested filter object\n  newSearchParams.set(\n    URL_PARAMS.preselectFilters.name,\n    JSON.stringify(serializeActiveFilterValues(filters)),\n  );\n\n  if (standalone) {\n    newSearchParams.set(URL_PARAMS.standalone.name, standalone.toString());\n  }\n  const dataMaskKey = getUrlParam(URL_PARAMS.nativeFiltersKey);\n  if (dataMaskKey) {\n    newSearchParams.set(\n      URL_PARAMS.nativeFiltersKey.name,\n      dataMaskKey as string,\n    );\n  }\n\n  const hashSection = hash ? `#${hash}` : '';\n  return `${pathname}?${newSearchParams.toString()}${hashSection}`;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { SupersetClient, t } from '@superset-ui/core';\n\nimport { Menu } from 'src/components/Menu';\nimport { URL_PARAMS } from 'src/constants';\nimport ShareMenuItems from 'src/dashboard/components/menu/ShareMenuItems';\nimport CssEditor from 'src/dashboard/components/CssEditor';\nimport RefreshIntervalModal from 'src/dashboard/components/RefreshIntervalModal';\nimport SaveModal from 'src/dashboard/components/SaveModal';\nimport HeaderReportDropdown from 'src/components/ReportModal/HeaderReportDropdown';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\nimport { SAVE_TYPE_NEWDASHBOARD } from 'src/dashboard/util/constants';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport getDashboardUrl from 'src/dashboard/util/getDashboardUrl';\nimport { getActiveFilters } from 'src/dashboard/util/activeDashboardFilters';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\n\nconst propTypes = {\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  dashboardInfo: PropTypes.object.isRequired,\n  dashboardId: PropTypes.number.isRequired,\n  dashboardTitle: PropTypes.string.isRequired,\n  dataMask: PropTypes.object.isRequired,\n  customCss: PropTypes.string.isRequired,\n  colorNamespace: PropTypes.string,\n  colorScheme: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  updateCss: PropTypes.func.isRequired,\n  forceRefreshAllCharts: PropTypes.func.isRequired,\n  refreshFrequency: PropTypes.number.isRequired,\n  shouldPersistRefreshFrequency: PropTypes.bool.isRequired,\n  setRefreshFrequency: PropTypes.func.isRequired,\n  startPeriodicRender: PropTypes.func.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  userCanEdit: PropTypes.bool.isRequired,\n  userCanShare: PropTypes.bool.isRequired,\n  userCanSave: PropTypes.bool.isRequired,\n  userCanCurate: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  layout: PropTypes.object.isRequired,\n  expandedSlices: PropTypes.object.isRequired,\n  onSave: PropTypes.func.isRequired,\n  showPropertiesModal: PropTypes.func.isRequired,\n  manageEmbedded: PropTypes.func.isRequired,\n  refreshLimit: PropTypes.number,\n  refreshWarning: PropTypes.string,\n  lastModifiedTime: PropTypes.number.isRequired,\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES,\n};\n\nconst defaultProps = {\n  colorNamespace: undefined,\n  colorScheme: undefined,\n  refreshLimit: 0,\n  refreshWarning: null,\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES.NOOP,\n};\n\nconst MENU_KEYS = {\n  SAVE_MODAL: 'save-modal',\n  SHARE_DASHBOARD: 'share-dashboard',\n  REFRESH_DASHBOARD: 'refresh-dashboard',\n  AUTOREFRESH_MODAL: 'autorefresh-modal',\n  SET_FILTER_MAPPING: 'set-filter-mapping',\n  EDIT_PROPERTIES: 'edit-properties',\n  EDIT_CSS: 'edit-css',\n  DOWNLOAD_AS_IMAGE: 'download-as-image',\n  TOGGLE_FULLSCREEN: 'toggle-fullscreen',\n  MANAGE_EMBEDDED: 'manage-embedded',\n  MANAGE_EMAIL_REPORT: 'manage-email-report',\n};\n\nconst SCREENSHOT_NODE_SELECTOR = '.dashboard';\n\nclass HeaderActionsDropdown extends React.PureComponent {\n  static discardChanges() {\n    window.location.reload();\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      css: props.customCss,\n      cssTemplates: [],\n      showReportSubMenu: null,\n    };\n\n    this.changeCss = this.changeCss.bind(this);\n    this.changeRefreshInterval = this.changeRefreshInterval.bind(this);\n    this.handleMenuClick = this.handleMenuClick.bind(this);\n    this.setShowReportSubMenu = this.setShowReportSubMenu.bind(this);\n  }\n\n  UNSAFE_componentWillMount() {\n    SupersetClient.get({ endpoint: '/csstemplateasyncmodelview/api/read' })\n      .then(({ json }) => {\n        const cssTemplates = json.result.map(row => ({\n          value: row.template_name,\n          css: row.css,\n          label: row.template_name,\n        }));\n        this.setState({ cssTemplates });\n      })\n      .catch(() => {\n        this.props.addDangerToast(\n          t('An error occurred while fetching available CSS templates'),\n        );\n      });\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.customCss !== nextProps.customCss) {\n      this.setState({ css: nextProps.customCss }, () => {\n        injectCustomCss(nextProps.customCss);\n      });\n    }\n  }\n\n  setShowReportSubMenu(show) {\n    this.setState({\n      showReportSubMenu: show,\n    });\n  }\n\n  changeCss(css) {\n    this.props.onChange();\n    this.props.updateCss(css);\n  }\n\n  changeRefreshInterval(refreshInterval, isPersistent) {\n    this.props.setRefreshFrequency(refreshInterval, isPersistent);\n    this.props.startPeriodicRender(refreshInterval * 1000);\n  }\n\n  handleMenuClick({ key, domEvent }) {\n    switch (key) {\n      case MENU_KEYS.REFRESH_DASHBOARD:\n        this.props.forceRefreshAllCharts();\n        this.props.addSuccessToast(t('Refreshing charts'));\n        break;\n      case MENU_KEYS.EDIT_PROPERTIES:\n        this.props.showPropertiesModal();\n        break;\n      case MENU_KEYS.DOWNLOAD_AS_IMAGE: {\n        // menu closes with a delay, we need to hide it manually,\n        // so that we don't capture it on the screenshot\n        const menu = document.querySelector(\n          '.ant-dropdown:not(.ant-dropdown-hidden)',\n        );\n        menu.style.visibility = 'hidden';\n        downloadAsImage(\n          SCREENSHOT_NODE_SELECTOR,\n          this.props.dashboardTitle,\n          true,\n        )(domEvent).then(() => {\n          menu.style.visibility = 'visible';\n        });\n        break;\n      }\n      case MENU_KEYS.TOGGLE_FULLSCREEN: {\n        const url = getDashboardUrl({\n          pathname: window.location.pathname,\n          filters: getActiveFilters(),\n          hash: window.location.hash,\n          standalone: !getUrlParam(URL_PARAMS.standalone),\n        });\n        window.location.replace(url);\n        break;\n      }\n      case MENU_KEYS.MANAGE_EMBEDDED: {\n        this.props.manageEmbedded();\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const {\n      dashboardTitle,\n      dashboardId,\n      dashboardInfo,\n      refreshFrequency,\n      shouldPersistRefreshFrequency,\n      editMode,\n      customCss,\n      colorNamespace,\n      colorScheme,\n      layout,\n      expandedSlices,\n      onSave,\n      userCanEdit,\n      userCanShare,\n      userCanSave,\n      userCanCurate,\n      isLoading,\n      refreshLimit,\n      refreshWarning,\n      lastModifiedTime,\n      addSuccessToast,\n      addDangerToast,\n      filterboxMigrationState,\n      setIsDropdownVisible,\n      isDropdownVisible,\n      ...rest\n    } = this.props;\n\n    const emailTitle = t('Superset dashboard');\n    const emailSubject = `${emailTitle} ${dashboardTitle}`;\n    const emailBody = t('Check out this dashboard: ');\n\n    const url = getDashboardUrl({\n      pathname: window.location.pathname,\n      filters: getActiveFilters(),\n      hash: window.location.hash,\n    });\n\n    const refreshIntervalOptions =\n      dashboardInfo.common?.conf?.DASHBOARD_AUTO_REFRESH_INTERVALS;\n\n    return (\n      <Menu selectable={false} data-test=\"header-actions-menu\" {...rest}>\n        {!editMode && (\n          <Menu.Item\n            key={MENU_KEYS.REFRESH_DASHBOARD}\n            data-test=\"refresh-dashboard-menu-item\"\n            disabled={isLoading}\n            onClick={this.handleMenuClick}\n          >\n            {t('Refresh dashboard')}\n          </Menu.Item>\n        )}\n        {!editMode && (\n          <Menu.Item\n            key={MENU_KEYS.TOGGLE_FULLSCREEN}\n            onClick={this.handleMenuClick}\n          >\n            {getUrlParam(URL_PARAMS.standalone)\n              ? t('Exit fullscreen')\n              : t('Enter fullscreen')}\n          </Menu.Item>\n        )}\n        {editMode && (\n          <Menu.Item\n            key={MENU_KEYS.EDIT_PROPERTIES}\n            onClick={this.handleMenuClick}\n          >\n            {t('Edit properties')}\n          </Menu.Item>\n        )}\n        {editMode && (\n          <Menu.Item key={MENU_KEYS.EDIT_CSS}>\n            <CssEditor\n              triggerNode={<span>{t('Edit CSS')}</span>}\n              initialCss={this.state.css}\n              templates={this.state.cssTemplates}\n              onChange={this.changeCss}\n            />\n          </Menu.Item>\n        )}\n        <Menu.Divider />\n        {userCanSave && (\n          <Menu.Item key={MENU_KEYS.SAVE_MODAL}>\n            <SaveModal\n              addSuccessToast={this.props.addSuccessToast}\n              addDangerToast={this.props.addDangerToast}\n              dashboardId={dashboardId}\n              dashboardTitle={dashboardTitle}\n              dashboardInfo={dashboardInfo}\n              saveType={SAVE_TYPE_NEWDASHBOARD}\n              layout={layout}\n              expandedSlices={expandedSlices}\n              refreshFrequency={refreshFrequency}\n              shouldPersistRefreshFrequency={shouldPersistRefreshFrequency}\n              lastModifiedTime={lastModifiedTime}\n              customCss={customCss}\n              colorNamespace={colorNamespace}\n              colorScheme={colorScheme}\n              onSave={onSave}\n              triggerNode={\n                <span data-test=\"save-as-menu-item\">{t('Save as')}</span>\n              }\n              canOverwrite={userCanEdit}\n            />\n          </Menu.Item>\n        )}\n        {!editMode && (\n          <Menu.Item\n            key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n            onClick={this.handleMenuClick}\n          >\n            {t('Download as image')}\n          </Menu.Item>\n        )}\n        {userCanShare && (\n          <Menu.SubMenu\n            key={MENU_KEYS.SHARE_DASHBOARD}\n            data-test=\"share-dashboard-menu-item\"\n            disabled={isLoading}\n            title={t('Share')}\n          >\n            <ShareMenuItems\n              url={url}\n              copyMenuItemTitle={t('Copy permalink to clipboard')}\n              emailMenuItemTitle={t('Share permalink by email')}\n              emailSubject={emailSubject}\n              emailBody={emailBody}\n              addSuccessToast={addSuccessToast}\n              addDangerToast={addDangerToast}\n              dashboardId={dashboardId}\n            />\n          </Menu.SubMenu>\n        )}\n        {!editMode && userCanCurate && (\n          <Menu.Item\n            key={MENU_KEYS.MANAGE_EMBEDDED}\n            onClick={this.handleMenuClick}\n          >\n            {t('Embed dashboard')}\n          </Menu.Item>\n        )}\n        <Menu.Divider />\n        {!editMode ? (\n          this.state.showReportSubMenu ? (\n            <>\n              <Menu.SubMenu title={t('Manage email report')}>\n                <HeaderReportDropdown\n                  dashboardId={dashboardInfo.id}\n                  setShowReportSubMenu={this.setShowReportSubMenu}\n                  showReportSubMenu={this.state.showReportSubMenu}\n                  setIsDropdownVisible={setIsDropdownVisible}\n                  isDropdownVisible={isDropdownVisible}\n                  useTextMenu\n                />\n              </Menu.SubMenu>\n              <Menu.Divider />\n            </>\n          ) : (\n            <Menu>\n              <HeaderReportDropdown\n                dashboardId={dashboardInfo.id}\n                setShowReportSubMenu={this.setShowReportSubMenu}\n                setIsDropdownVisible={setIsDropdownVisible}\n                isDropdownVisible={isDropdownVisible}\n                useTextMenu\n              />\n            </Menu>\n          )\n        ) : null}\n        {editMode &&\n          filterboxMigrationState !== FILTER_BOX_MIGRATION_STATES.CONVERTED && (\n            <Menu.Item key={MENU_KEYS.SET_FILTER_MAPPING}>\n              <FilterScopeModal\n                className=\"m-r-5\"\n                triggerNode={t('Set filter mapping')}\n              />\n            </Menu.Item>\n          )}\n\n        <Menu.Item key={MENU_KEYS.AUTOREFRESH_MODAL}>\n          <RefreshIntervalModal\n            addSuccessToast={this.props.addSuccessToast}\n            refreshFrequency={refreshFrequency}\n            refreshLimit={refreshLimit}\n            refreshWarning={refreshWarning}\n            onChange={this.changeRefreshInterval}\n            editMode={editMode}\n            refreshIntervalOptions={refreshIntervalOptions}\n            triggerNode={<span>{t('Set auto-refresh interval')}</span>}\n          />\n        </Menu.Item>\n      </Menu>\n    );\n  }\n}\n\nHeaderActionsDropdown.propTypes = propTypes;\nHeaderActionsDropdown.defaultProps = defaultProps;\n\nexport default HeaderActionsDropdown;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { t } from '@superset-ui/core';\nimport { Tooltip } from 'src/components/Tooltip';\nimport Label from 'src/components/Label';\n\nconst propTypes = {\n  dashboardId: PropTypes.number.isRequired,\n  isPublished: PropTypes.bool.isRequired,\n  savePublished: PropTypes.func.isRequired,\n  canEdit: PropTypes.bool.isRequired,\n  canSave: PropTypes.bool.isRequired,\n};\n\nconst draftButtonTooltip = t(\n  'This dashboard is not published, it will not show up in the list of dashboards. ' +\n    'Click here to publish this dashboard.',\n);\n\nconst draftDivTooltip = t(\n  'This dashboard is not published which means it will not show up in the list of dashboards.' +\n    ' Favorite it to see it there or access it by using the URL directly.',\n);\n\nconst publishedTooltip = t(\n  'This dashboard is published. Click to make it a draft.',\n);\n\nexport default class PublishedStatus extends React.Component {\n  componentDidMount() {\n    this.togglePublished = this.togglePublished.bind(this);\n  }\n\n  togglePublished() {\n    this.props.savePublished(this.props.dashboardId, !this.props.isPublished);\n  }\n\n  render() {\n    // Show everybody the draft badge\n    if (!this.props.isPublished) {\n      // if they can edit the dash, make the badge a button\n      if (this.props.canEdit && this.props.canSave) {\n        return (\n          <Tooltip\n            id=\"unpublished-dashboard-tooltip\"\n            placement=\"bottom\"\n            title={draftButtonTooltip}\n          >\n            <Label\n              onClick={() => {\n                this.togglePublished();\n              }}\n            >\n              {t('Draft')}\n            </Label>\n          </Tooltip>\n        );\n      }\n      return (\n        <Tooltip\n          id=\"unpublished-dashboard-tooltip\"\n          placement=\"bottom\"\n          title={draftDivTooltip}\n        >\n          <Label>{t('Draft')}</Label>\n        </Tooltip>\n      );\n    }\n\n    // Show the published badge for the owner of the dashboard to toggle\n    if (this.props.canEdit && this.props.canSave) {\n      return (\n        <Tooltip\n          id=\"published-dashboard-tooltip\"\n          placement=\"bottom\"\n          title={publishedTooltip}\n        >\n          <Label\n            onClick={() => {\n              this.togglePublished();\n            }}\n          >\n            {t('Published')}\n          </Label>\n        </Tooltip>\n      );\n    }\n\n    // Don't show anything if one doesn't own the dashboard and it is published\n    return null;\n  }\n}\n\nPublishedStatus.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nconst propTypes = {\n  onUndo: PropTypes.func.isRequired,\n  onRedo: PropTypes.func.isRequired,\n};\n\nclass UndoRedoKeyListeners extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleKeydown = this.handleKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown);\n  }\n\n  handleKeydown(event) {\n    const controlOrCommand = event.ctrlKey || event.metaKey;\n    if (controlOrCommand) {\n      const isZChar = event.key === 'z' || event.keyCode === 90;\n      const isYChar = event.key === 'y' || event.keyCode === 89;\n      const isEditingMarkdown =\n        document && document.querySelector('.dashboard-markdown--editing');\n      const isEditingTitle =\n        document && document.querySelector('.editable-title--editing');\n\n      if (!isEditingMarkdown && !isEditingTitle && (isZChar || isYChar)) {\n        event.preventDefault();\n        const func = isZChar ? this.props.onUndo : this.props.onRedo;\n        func();\n      }\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nUndoRedoKeyListeners.propTypes = propTypes;\n\nexport default UndoRedoKeyListeners;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport const stopPeriodicRender = (refreshTimer?: number) => {\n  if (refreshTimer) {\n    clearInterval(refreshTimer);\n  }\n};\n\ninterface SetPeriodicRunnerProps {\n  interval?: number;\n  periodicRender: TimerHandler;\n  refreshTimer?: number;\n}\n\nexport default function setPeriodicRunner({\n  interval = 0,\n  periodicRender,\n  refreshTimer,\n}: SetPeriodicRunnerProps) {\n  stopPeriodicRender(refreshTimer);\n\n  if (interval > 0) {\n    return setInterval(periodicRender, interval);\n  }\n  return 0;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport {\n  makeApi,\n  styled,\n  SupersetApiError,\n  t,\n  getUiOverrideRegistry,\n} from '@superset-ui/core';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport Modal from 'src/components/Modal';\nimport Loading from 'src/components/Loading';\nimport Button from 'src/components/Button';\nimport { Input } from 'src/components/Input';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { FormItem } from 'src/components/Form';\nimport { EmbeddedDashboard } from '../types';\n\nconst uiOverrideRegistry = getUiOverrideRegistry();\n\ntype Props = {\n  dashboardId: string;\n  show: boolean;\n  onHide: () => void;\n};\n\ntype EmbeddedApiPayload = { allowed_domains: string[] };\n\nconst stringToList = (stringyList: string): string[] =>\n  stringyList.split(/(?:\\s|,)+/).filter(x => x);\n\nconst ButtonRow = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n`;\n\nexport const DashboardEmbedControls = ({ dashboardId, onHide }: Props) => {\n  const { addInfoToast, addDangerToast } = useToasts();\n  const [ready, setReady] = useState(true); // whether we have initialized yet\n  const [loading, setLoading] = useState(false); // whether we are currently doing an async thing\n  const [embedded, setEmbedded] = useState<EmbeddedDashboard | null>(null); // the embedded dashboard config\n  const [allowedDomains, setAllowedDomains] = useState<string>('');\n\n  const endpoint = `/api/v1/dashboard/${dashboardId}/embedded`;\n  // whether saveable changes have been made to the config\n  const isDirty =\n    !embedded ||\n    stringToList(allowedDomains).join() !== embedded.allowed_domains.join();\n\n  const enableEmbedded = useCallback(() => {\n    setLoading(true);\n    makeApi<EmbeddedApiPayload, { result: EmbeddedDashboard }>({\n      method: 'POST',\n      endpoint,\n    })({\n      allowed_domains: stringToList(allowedDomains),\n    })\n      .then(\n        ({ result }) => {\n          setEmbedded(result);\n          setAllowedDomains(result.allowed_domains.join(', '));\n          addInfoToast(t('Changes saved.'));\n        },\n        err => {\n          console.error(err);\n          addDangerToast(\n            t(\n              t('Sorry, something went wrong. The changes could not be saved.'),\n            ),\n          );\n        },\n      )\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [endpoint, allowedDomains]);\n\n  const disableEmbedded = useCallback(() => {\n    Modal.confirm({\n      title: t('Disable embedding?'),\n      content: t('This will remove your current embed configuration.'),\n      okType: 'danger',\n      onOk: () => {\n        setLoading(true);\n        makeApi<{}>({ method: 'DELETE', endpoint })({})\n          .then(\n            () => {\n              setEmbedded(null);\n              setAllowedDomains('');\n              addInfoToast(t('Embedding deactivated.'));\n              onHide();\n            },\n            err => {\n              console.error(err);\n              addDangerToast(\n                t(\n                  'Sorry, something went wrong. Embedding could not be deactivated.',\n                ),\n              );\n            },\n          )\n          .finally(() => {\n            setLoading(false);\n          });\n      },\n    });\n  }, [endpoint]);\n\n  useEffect(() => {\n    setReady(false);\n    makeApi<{}, { result: EmbeddedDashboard }>({\n      method: 'GET',\n      endpoint,\n    })({})\n      .catch(err => {\n        if ((err as SupersetApiError).status === 404) {\n          // 404 just means the dashboard isn't currently embedded\n          return { result: null };\n        }\n        throw err;\n      })\n      .then(({ result }) => {\n        setReady(true);\n        setEmbedded(result);\n        setAllowedDomains(result ? result.allowed_domains.join(', ') : '');\n      });\n  }, [dashboardId]);\n\n  if (!ready) {\n    return <Loading />;\n  }\n\n  const docsDescription = uiOverrideRegistry.get(\n    'embedded.documentation.description',\n  );\n  const docsUrl =\n    uiOverrideRegistry.get('embedded.documentation.url') ??\n    'https://www.npmjs.com/package/@superset-ui/embedded-sdk';\n\n  return (\n    <>\n      <p>\n        {embedded ? (\n          <>\n            {t(\n              'This dashboard is ready to embed. In your application, pass the following id to the SDK:',\n            )}\n            <br />\n            <code>{embedded.uuid}</code>\n          </>\n        ) : (\n          t(\n            'Configure this dashboard to embed it into an external web application.',\n          )\n        )}\n      </p>\n      <p>\n        {t('For further instructions, consult the')}{' '}\n        <a href={docsUrl} target=\"_blank\" rel=\"noreferrer\">\n          {docsDescription\n            ? docsDescription()\n            : t('Superset Embedded SDK documentation.')}\n        </a>\n      </p>\n      <h3>Settings</h3>\n      <FormItem>\n        <label htmlFor=\"allowed-domains\">\n          {t('Allowed Domains (comma separated)')}{' '}\n          <InfoTooltipWithTrigger\n            tooltip={t(\n              'A list of domain names that can embed this dashboard. Leaving this field empty will allow embedding from any domain.',\n            )}\n          />\n        </label>\n        <Input\n          name=\"allowed-domains\"\n          value={allowedDomains}\n          placeholder=\"superset.example.com\"\n          onChange={event => setAllowedDomains(event.target.value)}\n        />\n      </FormItem>\n      <ButtonRow>\n        {embedded ? (\n          <>\n            <Button\n              onClick={disableEmbedded}\n              buttonStyle=\"secondary\"\n              loading={loading}\n            >\n              {t('Deactivate')}\n            </Button>\n            <Button\n              onClick={enableEmbedded}\n              buttonStyle=\"primary\"\n              disabled={!isDirty}\n              loading={loading}\n            >\n              {t('Save changes')}\n            </Button>\n          </>\n        ) : (\n          <Button\n            onClick={enableEmbedded}\n            buttonStyle=\"primary\"\n            loading={loading}\n          >\n            {t('Enable embedding')}\n          </Button>\n        )}\n      </ButtonRow>\n    </>\n  );\n};\n\nexport const DashboardEmbedModal = (props: Props) => {\n  const { show, onHide } = props;\n\n  return (\n    <Modal show={show} onHide={onHide} title={t('Embed')} hideFooter>\n      <DashboardEmbedControls {...props} />\n    </Modal>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport moment from 'moment';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, css, t, getSharedLabelColor } from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\nimport {\n  LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD,\n  LOG_ACTIONS_FORCE_REFRESH_DASHBOARD,\n  LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD,\n} from 'src/logger/LogUtils';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport { AntdButton } from 'src/components/';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { safeStringify } from 'src/utils/safeStringify';\nimport HeaderActionsDropdown from 'src/dashboard/components/Header/HeaderActionsDropdown';\nimport PublishedStatus from 'src/dashboard/components/PublishedStatus';\nimport UndoRedoKeyListeners from 'src/dashboard/components/UndoRedoKeyListeners';\nimport PropertiesModal from 'src/dashboard/components/PropertiesModal';\nimport { chartPropShape } from 'src/dashboard/util/propShapes';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport {\n  UNDO_LIMIT,\n  SAVE_TYPE_OVERWRITE,\n  DASHBOARD_POSITION_DATA_LIMIT,\n} from 'src/dashboard/util/constants';\nimport setPeriodicRunner, {\n  stopPeriodicRender,\n} from 'src/dashboard/util/setPeriodicRunner';\nimport findPermission from 'src/dashboard/util/findPermission';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\nimport { PageHeaderWithActions } from 'src/components/PageHeaderWithActions';\nimport { DashboardEmbedModal } from '../DashboardEmbedControls';\n\nconst propTypes = {\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  addWarningToast: PropTypes.func.isRequired,\n  user: UserWithPermissionsAndRoles,\n  dashboardInfo: PropTypes.object.isRequired,\n  dashboardTitle: PropTypes.string.isRequired,\n  dataMask: PropTypes.object.isRequired,\n  charts: PropTypes.objectOf(chartPropShape).isRequired,\n  layout: PropTypes.object.isRequired,\n  expandedSlices: PropTypes.object.isRequired,\n  customCss: PropTypes.string.isRequired,\n  colorNamespace: PropTypes.string,\n  colorScheme: PropTypes.string,\n  setColorSchemeAndUnsavedChanges: PropTypes.func.isRequired,\n  isStarred: PropTypes.bool.isRequired,\n  isPublished: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  onSave: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  fetchFaveStar: PropTypes.func.isRequired,\n  fetchCharts: PropTypes.func.isRequired,\n  saveFaveStar: PropTypes.func.isRequired,\n  savePublished: PropTypes.func.isRequired,\n  updateDashboardTitle: PropTypes.func.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  setEditMode: PropTypes.func.isRequired,\n  showBuilderPane: PropTypes.func.isRequired,\n  updateCss: PropTypes.func.isRequired,\n  logEvent: PropTypes.func.isRequired,\n  hasUnsavedChanges: PropTypes.bool.isRequired,\n  maxUndoHistoryExceeded: PropTypes.bool.isRequired,\n  lastModifiedTime: PropTypes.number.isRequired,\n\n  // redux\n  onRefresh: PropTypes.func.isRequired,\n  onUndo: PropTypes.func.isRequired,\n  onRedo: PropTypes.func.isRequired,\n  undoLength: PropTypes.number.isRequired,\n  redoLength: PropTypes.number.isRequired,\n  setMaxUndoHistoryExceeded: PropTypes.func.isRequired,\n  maxUndoHistoryToast: PropTypes.func.isRequired,\n  refreshFrequency: PropTypes.number.isRequired,\n  shouldPersistRefreshFrequency: PropTypes.bool.isRequired,\n  setRefreshFrequency: PropTypes.func.isRequired,\n  dashboardInfoChanged: PropTypes.func.isRequired,\n  dashboardTitleChanged: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  colorNamespace: undefined,\n  colorScheme: undefined,\n};\n\nconst headerContainerStyle = theme => css`\n  border-bottom: 1px solid ${theme.colors.grayscale.light2};\n`;\n\nconst editButtonStyle = theme => css`\n  color: ${theme.colors.primary.dark2};\n`;\n\nconst actionButtonsStyle = theme => css`\n  display: flex;\n  align-items: center;\n\n  .action-schedule-report {\n    margin-left: ${theme.gridUnit * 2}px;\n  }\n\n  .undoRedo {\n    margin-right: ${theme.gridUnit * 2}px;\n  }\n`;\n\nconst StyledUndoRedoButton = styled(AntdButton)`\n  padding: 0;\n  &:hover {\n    background: transparent;\n  }\n`;\n\nconst undoRedoStyle = theme => css`\n  color: ${theme.colors.grayscale.light1};\n  &:hover {\n    color: ${theme.colors.grayscale.base};\n  }\n`;\n\nconst undoRedoEmphasized = theme => css`\n  color: ${theme.colors.grayscale.base};\n`;\n\nconst undoRedoDisabled = theme => css`\n  color: ${theme.colors.grayscale.light2};\n`;\n\nconst saveBtnStyle = theme => css`\n  min-width: ${theme.gridUnit * 17}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nconst discardBtnStyle = theme => css`\n  min-width: ${theme.gridUnit * 22}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nclass Header extends React.PureComponent {\n  static discardChanges() {\n    const url = new URL(window.location.href);\n\n    url.searchParams.delete('edit');\n    window.location.assign(url);\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      didNotifyMaxUndoHistoryToast: false,\n      emphasizeUndo: false,\n      emphasizeRedo: false,\n      showingPropertiesModal: false,\n      isDropdownVisible: false,\n    };\n\n    this.handleChangeText = this.handleChangeText.bind(this);\n    this.handleCtrlZ = this.handleCtrlZ.bind(this);\n    this.handleCtrlY = this.handleCtrlY.bind(this);\n    this.toggleEditMode = this.toggleEditMode.bind(this);\n    this.forceRefresh = this.forceRefresh.bind(this);\n    this.startPeriodicRender = this.startPeriodicRender.bind(this);\n    this.overwriteDashboard = this.overwriteDashboard.bind(this);\n    this.showPropertiesModal = this.showPropertiesModal.bind(this);\n    this.hidePropertiesModal = this.hidePropertiesModal.bind(this);\n    this.setIsDropdownVisible = this.setIsDropdownVisible.bind(this);\n  }\n\n  componentDidMount() {\n    const { refreshFrequency } = this.props;\n    this.startPeriodicRender(refreshFrequency * 1000);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.refreshFrequency !== prevProps.refreshFrequency) {\n      const { refreshFrequency } = this.props;\n      this.startPeriodicRender(refreshFrequency * 1000);\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (\n      UNDO_LIMIT - nextProps.undoLength <= 0 &&\n      !this.state.didNotifyMaxUndoHistoryToast\n    ) {\n      this.setState(() => ({ didNotifyMaxUndoHistoryToast: true }));\n      this.props.maxUndoHistoryToast();\n    }\n    if (\n      nextProps.undoLength > UNDO_LIMIT &&\n      !this.props.maxUndoHistoryExceeded\n    ) {\n      this.props.setMaxUndoHistoryExceeded();\n    }\n  }\n\n  componentWillUnmount() {\n    stopPeriodicRender(this.refreshTimer);\n    this.props.setRefreshFrequency(0);\n    clearTimeout(this.ctrlYTimeout);\n    clearTimeout(this.ctrlZTimeout);\n  }\n\n  handleChangeText(nextText) {\n    const { updateDashboardTitle, onChange } = this.props;\n    if (nextText && this.props.dashboardTitle !== nextText) {\n      updateDashboardTitle(nextText);\n      onChange();\n    }\n  }\n\n  setIsDropdownVisible(visible) {\n    this.setState({\n      isDropdownVisible: visible,\n    });\n  }\n\n  handleCtrlY() {\n    this.props.onRedo();\n    this.setState({ emphasizeRedo: true }, () => {\n      if (this.ctrlYTimeout) clearTimeout(this.ctrlYTimeout);\n      this.ctrlYTimeout = setTimeout(() => {\n        this.setState({ emphasizeRedo: false });\n      }, 100);\n    });\n  }\n\n  handleCtrlZ() {\n    this.props.onUndo();\n    this.setState({ emphasizeUndo: true }, () => {\n      if (this.ctrlZTimeout) clearTimeout(this.ctrlZTimeout);\n      this.ctrlZTimeout = setTimeout(() => {\n        this.setState({ emphasizeUndo: false });\n      }, 100);\n    });\n  }\n\n  forceRefresh() {\n    if (!this.props.isLoading) {\n      const chartList = Object.keys(this.props.charts);\n      this.props.logEvent(LOG_ACTIONS_FORCE_REFRESH_DASHBOARD, {\n        force: true,\n        interval: 0,\n        chartCount: chartList.length,\n      });\n      return this.props.onRefresh(\n        chartList,\n        true,\n        0,\n        this.props.dashboardInfo.id,\n      );\n    }\n    return false;\n  }\n\n  startPeriodicRender(interval) {\n    let intervalMessage;\n\n    if (interval) {\n      const { dashboardInfo } = this.props;\n      const periodicRefreshOptions =\n        dashboardInfo.common?.conf?.DASHBOARD_AUTO_REFRESH_INTERVALS;\n      const predefinedValue = periodicRefreshOptions.find(\n        option => Number(option[0]) === interval / 1000,\n      );\n\n      if (predefinedValue) {\n        intervalMessage = t(predefinedValue[1]);\n      } else {\n        intervalMessage = moment.duration(interval, 'millisecond').humanize();\n      }\n    }\n\n    const periodicRender = () => {\n      const { fetchCharts, logEvent, charts, dashboardInfo } = this.props;\n      const { metadata } = dashboardInfo;\n      const immune = metadata.timed_refresh_immune_slices || [];\n      const affectedCharts = Object.values(charts)\n        .filter(chart => immune.indexOf(chart.id) === -1)\n        .map(chart => chart.id);\n\n      logEvent(LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD, {\n        interval,\n        chartCount: affectedCharts.length,\n      });\n      this.props.addWarningToast(\n        t(\n          `This dashboard is currently auto refreshing; the next auto refresh will be in %s.`,\n          intervalMessage,\n        ),\n      );\n      if (dashboardInfo.common.conf.DASHBOARD_AUTO_REFRESH_MODE === 'fetch') {\n        // force-refresh while auto-refresh in dashboard\n        return fetchCharts(\n          affectedCharts,\n          false,\n          interval * 0.2,\n          dashboardInfo.id,\n        );\n      }\n      return fetchCharts(\n        affectedCharts,\n        true,\n        interval * 0.2,\n        dashboardInfo.id,\n      );\n    };\n\n    this.refreshTimer = setPeriodicRunner({\n      interval,\n      periodicRender,\n      refreshTimer: this.refreshTimer,\n    });\n  }\n\n  toggleEditMode() {\n    this.props.logEvent(LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD, {\n      edit_mode: !this.props.editMode,\n    });\n    this.props.setEditMode(!this.props.editMode);\n  }\n\n  overwriteDashboard() {\n    const {\n      dashboardTitle,\n      layout: positions,\n      colorScheme,\n      colorNamespace,\n      customCss,\n      dashboardInfo,\n      refreshFrequency: currentRefreshFrequency,\n      shouldPersistRefreshFrequency,\n      lastModifiedTime,\n      slug,\n    } = this.props;\n\n    // check refresh frequency is for current session or persist\n    const refreshFrequency = shouldPersistRefreshFrequency\n      ? currentRefreshFrequency\n      : dashboardInfo.metadata?.refresh_frequency;\n\n    const currentColorScheme =\n      dashboardInfo?.metadata?.color_scheme || colorScheme;\n    const currentColorNamespace =\n      dashboardInfo?.metadata?.color_namespace || colorNamespace;\n    const currentSharedLabelColors = getSharedLabelColor().getColorMap(\n      currentColorNamespace,\n      currentColorScheme,\n    );\n\n    const data = {\n      certified_by: dashboardInfo.certified_by,\n      certification_details: dashboardInfo.certification_details,\n      css: customCss,\n      dashboard_title: dashboardTitle,\n      last_modified_time: lastModifiedTime,\n      owners: dashboardInfo.owners,\n      roles: dashboardInfo.roles,\n      slug,\n      metadata: {\n        ...dashboardInfo?.metadata,\n        color_namespace: currentColorNamespace,\n        color_scheme: currentColorScheme,\n        positions,\n        refresh_frequency: refreshFrequency,\n        shared_label_colors: currentSharedLabelColors,\n      },\n    };\n\n    // make sure positions data less than DB storage limitation:\n    const positionJSONLength = safeStringify(positions).length;\n    const limit =\n      dashboardInfo.common.conf.SUPERSET_DASHBOARD_POSITION_DATA_LIMIT ||\n      DASHBOARD_POSITION_DATA_LIMIT;\n    if (positionJSONLength >= limit) {\n      this.props.addDangerToast(\n        t(\n          'Your dashboard is too large. Please reduce its size before saving it.',\n        ),\n      );\n    } else {\n      if (positionJSONLength >= limit * 0.9) {\n        this.props.addWarningToast('Your dashboard is near the size limit.');\n      }\n\n      this.props.onSave(data, dashboardInfo.id, SAVE_TYPE_OVERWRITE);\n    }\n  }\n\n  showPropertiesModal() {\n    this.setState({ showingPropertiesModal: true });\n  }\n\n  hidePropertiesModal() {\n    this.setState({ showingPropertiesModal: false });\n  }\n\n  showEmbedModal = () => {\n    this.setState({ showingEmbedModal: true });\n  };\n\n  hideEmbedModal = () => {\n    this.setState({ showingEmbedModal: false });\n  };\n\n  render() {\n    const {\n      dashboardTitle,\n      layout,\n      expandedSlices,\n      customCss,\n      colorNamespace,\n      dataMask,\n      setColorSchemeAndUnsavedChanges,\n      colorScheme,\n      onUndo,\n      onRedo,\n      undoLength,\n      redoLength,\n      onChange,\n      onSave,\n      updateCss,\n      editMode,\n      isPublished,\n      user,\n      dashboardInfo,\n      hasUnsavedChanges,\n      isLoading,\n      refreshFrequency,\n      shouldPersistRefreshFrequency,\n      setRefreshFrequency,\n      lastModifiedTime,\n      filterboxMigrationState,\n    } = this.props;\n\n    const userCanEdit =\n      dashboardInfo.dash_edit_perm &&\n      filterboxMigrationState !== FILTER_BOX_MIGRATION_STATES.REVIEWING &&\n      !dashboardInfo.is_managed_externally;\n    const userCanShare = dashboardInfo.dash_share_perm;\n    const userCanSaveAs =\n      dashboardInfo.dash_save_perm &&\n      filterboxMigrationState !== FILTER_BOX_MIGRATION_STATES.REVIEWING;\n    const userCanCurate =\n      isFeatureEnabled(FeatureFlag.EMBEDDED_SUPERSET) &&\n      findPermission('can_set_embedded', 'Dashboard', user.roles);\n    const refreshLimit =\n      dashboardInfo.common?.conf?.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT;\n    const refreshWarning =\n      dashboardInfo.common?.conf\n        ?.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE;\n\n    const handleOnPropertiesChange = updates => {\n      const { dashboardInfoChanged, dashboardTitleChanged } = this.props;\n      dashboardInfoChanged({\n        slug: updates.slug,\n        metadata: JSON.parse(updates.jsonMetadata || '{}'),\n        certified_by: updates.certifiedBy,\n        certification_details: updates.certificationDetails,\n        owners: updates.owners,\n        roles: updates.roles,\n      });\n      setColorSchemeAndUnsavedChanges(updates.colorScheme);\n      dashboardTitleChanged(updates.title);\n    };\n\n    return (\n      <div\n        css={headerContainerStyle}\n        data-test-id={dashboardInfo.id}\n        className=\"dashboard-header-container\"\n      >\n        <PageHeaderWithActions\n          editableTitleProps={{\n            title: dashboardTitle,\n            canEdit: userCanEdit && editMode,\n            onSave: this.handleChangeText,\n            placeholder: t('Add the name of the dashboard'),\n            label: t('Dashboard title'),\n            showTooltip: false,\n          }}\n          certificatiedBadgeProps={{\n            certifiedBy: dashboardInfo.certified_by,\n            details: dashboardInfo.certification_details,\n          }}\n          faveStarProps={{\n            itemId: dashboardInfo.id,\n            fetchFaveStar: this.props.fetchFaveStar,\n            saveFaveStar: this.props.saveFaveStar,\n            isStarred: this.props.isStarred,\n            showTooltip: true,\n          }}\n          titlePanelAdditionalItems={\n            <PublishedStatus\n              dashboardId={dashboardInfo.id}\n              isPublished={isPublished}\n              savePublished={this.props.savePublished}\n              canEdit={userCanEdit}\n              canSave={userCanSaveAs}\n            />\n          }\n          rightPanelAdditionalItems={\n            <div className=\"button-container\">\n              {userCanSaveAs && (\n                <div\n                  className=\"button-container\"\n                  data-test=\"dashboard-edit-actions\"\n                >\n                  {editMode && (\n                    <div css={actionButtonsStyle}>\n                      <div className=\"undoRedo\">\n                        <Tooltip\n                          id=\"dashboard-undo-tooltip\"\n                          title={t('Undo the action')}\n                        >\n                          <StyledUndoRedoButton\n                            type=\"text\"\n                            disabled={undoLength < 1}\n                          >\n                            <Icons.Undo\n                              css={[\n                                undoRedoStyle,\n                                this.state.emphasizeUndo && undoRedoEmphasized,\n                                undoLength < 1 && undoRedoDisabled,\n                              ]}\n                              onClick={undoLength && onUndo}\n                              data-test=\"undo-action\"\n                              iconSize=\"xl\"\n                            />\n                          </StyledUndoRedoButton>\n                        </Tooltip>\n                        <Tooltip\n                          id=\"dashboard-redo-tooltip\"\n                          title={t('Redo the action')}\n                        >\n                          <StyledUndoRedoButton\n                            type=\"text\"\n                            disabled={redoLength < 1}\n                          >\n                            <Icons.Redo\n                              css={[\n                                undoRedoStyle,\n                                this.state.emphasizeRedo && undoRedoEmphasized,\n                                redoLength < 1 && undoRedoDisabled,\n                              ]}\n                              onClick={redoLength && onRedo}\n                              data-test=\"redo-action\"\n                              iconSize=\"xl\"\n                            />\n                          </StyledUndoRedoButton>\n                        </Tooltip>\n                      </div>\n                      <Button\n                        css={discardBtnStyle}\n                        buttonSize=\"small\"\n                        onClick={this.constructor.discardChanges}\n                        buttonStyle=\"default\"\n                        data-test=\"discard-changes-button\"\n                        aria-label={t('Discard')}\n                      >\n                        {t('Discard')}\n                      </Button>\n                      <Button\n                        css={saveBtnStyle}\n                        buttonSize=\"small\"\n                        disabled={!hasUnsavedChanges}\n                        buttonStyle=\"primary\"\n                        onClick={this.overwriteDashboard}\n                        data-test=\"header-save-button\"\n                        aria-label={t('Save')}\n                      >\n                        {t('Save')}\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              )}\n              {editMode ? (\n                <UndoRedoKeyListeners\n                  onUndo={this.handleCtrlZ}\n                  onRedo={this.handleCtrlY}\n                />\n              ) : (\n                <div css={actionButtonsStyle}>\n                  {userCanEdit && (\n                    <Button\n                      buttonStyle=\"secondary\"\n                      onClick={this.toggleEditMode}\n                      data-test=\"query-save-button\"\n                      className=\"action-button\"\n                      css={editButtonStyle}\n                      aria-label={t('Edit dashboard')}\n                    >\n                      {t('Edit dashboard')}\n                    </Button>\n                  )}\n                </div>\n              )}\n            </div>\n          }\n          menuDropdownProps={{\n            getPopupContainer: triggerNode =>\n              triggerNode.closest('.header-with-actions'),\n            visible: this.state.isDropdownVisible,\n            onVisibleChange: this.setIsDropdownVisible,\n          }}\n          additionalActionsMenu={\n            <HeaderActionsDropdown\n              addSuccessToast={this.props.addSuccessToast}\n              addDangerToast={this.props.addDangerToast}\n              dashboardId={dashboardInfo.id}\n              dashboardTitle={dashboardTitle}\n              dashboardInfo={dashboardInfo}\n              dataMask={dataMask}\n              layout={layout}\n              expandedSlices={expandedSlices}\n              customCss={customCss}\n              colorNamespace={colorNamespace}\n              colorScheme={colorScheme}\n              onSave={onSave}\n              onChange={onChange}\n              forceRefreshAllCharts={this.forceRefresh}\n              startPeriodicRender={this.startPeriodicRender}\n              refreshFrequency={refreshFrequency}\n              shouldPersistRefreshFrequency={shouldPersistRefreshFrequency}\n              setRefreshFrequency={setRefreshFrequency}\n              updateCss={updateCss}\n              editMode={editMode}\n              hasUnsavedChanges={hasUnsavedChanges}\n              userCanEdit={userCanEdit}\n              userCanShare={userCanShare}\n              userCanSave={userCanSaveAs}\n              userCanCurate={userCanCurate}\n              isLoading={isLoading}\n              showPropertiesModal={this.showPropertiesModal}\n              manageEmbedded={this.showEmbedModal}\n              refreshLimit={refreshLimit}\n              refreshWarning={refreshWarning}\n              lastModifiedTime={lastModifiedTime}\n              filterboxMigrationState={filterboxMigrationState}\n              isDropdownVisible={this.state.isDropdownVisible}\n              setIsDropdownVisible={this.setIsDropdownVisible}\n            />\n          }\n          showFaveStar={user?.userId && dashboardInfo?.id}\n          showTitlePanelItems={!editMode}\n        />\n        {this.state.showingPropertiesModal && (\n          <PropertiesModal\n            dashboardId={dashboardInfo.id}\n            dashboardInfo={dashboardInfo}\n            dashboardTitle={dashboardTitle}\n            show={this.state.showingPropertiesModal}\n            onHide={this.hidePropertiesModal}\n            colorScheme={this.props.colorScheme}\n            onSubmit={handleOnPropertiesChange}\n            onlyApply\n          />\n        )}\n\n        {userCanCurate && (\n          <DashboardEmbedModal\n            show={this.state.showingEmbedModal}\n            onHide={this.hideEmbedModal}\n            dashboardId={dashboardInfo.id}\n          />\n        )}\n        <Global\n          styles={css`\n            .ant-menu-vertical {\n              border-right: none;\n            }\n          `}\n        />\n      </div>\n    );\n  }\n}\n\nHeader.propTypes = propTypes;\nHeader.defaultProps = defaultProps;\n\nexport default Header;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function isDashboardLoading(charts) {\n  return Object.values(charts).some(\n    chart => chart.chartUpdateStartTime > (chart.chartUpdateEndTime || 0),\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { updateDataMask } from 'src/dataMask/actions';\nimport DashboardHeader from 'src/dashboard/components/Header';\nimport isDashboardLoading from 'src/dashboard/util/isDashboardLoading';\n\nimport { dashboardInfoChanged } from 'src/dashboard/actions/dashboardInfo';\n\nimport {\n  setEditMode,\n  showBuilderPane,\n  fetchFaveStar,\n  saveFaveStar,\n  savePublished,\n  setColorSchemeAndUnsavedChanges,\n  fetchCharts,\n  updateCss,\n  onChange,\n  saveDashboardRequest,\n  setMaxUndoHistoryExceeded,\n  maxUndoHistoryToast,\n  setRefreshFrequency,\n  onRefresh,\n} from 'src/dashboard/actions/dashboardState';\n\nimport {\n  undoLayoutAction,\n  redoLayoutAction,\n  updateDashboardTitle,\n  dashboardTitleChanged,\n} from 'src/dashboard/actions/dashboardLayout';\nimport {\n  addSuccessToast,\n  addDangerToast,\n  addWarningToast,\n} from 'src/components/MessageToasts/actions';\n\nimport { logEvent } from 'src/logger/actions';\nimport { DASHBOARD_HEADER_ID } from 'src/dashboard/util/constants';\nimport { fetchUISpecificReport } from 'src/reports/actions/reports';\n\nfunction mapStateToProps({\n  dashboardLayout: undoableLayout,\n  dashboardState,\n  reports,\n  dashboardInfo,\n  charts,\n  dataMask,\n  user,\n}) {\n  return {\n    dashboardInfo,\n    undoLength: undoableLayout.past.length,\n    redoLength: undoableLayout.future.length,\n    layout: undoableLayout.present,\n    dashboardTitle: (\n      (undoableLayout.present[DASHBOARD_HEADER_ID] || {}).meta || {}\n    ).text,\n    expandedSlices: dashboardState.expandedSlices,\n    refreshFrequency: dashboardState.refreshFrequency,\n    shouldPersistRefreshFrequency:\n      !!dashboardState.shouldPersistRefreshFrequency,\n    customCss: dashboardState.css,\n    colorNamespace: dashboardState.colorNamespace,\n    colorScheme: dashboardState.colorScheme,\n    charts,\n    dataMask,\n    user,\n    isStarred: !!dashboardState.isStarred,\n    isPublished: !!dashboardState.isPublished,\n    isLoading: isDashboardLoading(charts),\n    hasUnsavedChanges: !!dashboardState.hasUnsavedChanges,\n    maxUndoHistoryExceeded: !!dashboardState.maxUndoHistoryExceeded,\n    lastModifiedTime: Math.max(\n      dashboardState.lastModifiedTime,\n      dashboardInfo.last_modified_time,\n    ),\n    editMode: !!dashboardState.editMode,\n    slug: dashboardInfo.slug,\n    metadata: dashboardInfo.metadata,\n    reports,\n    filterboxMigrationState: dashboardState.filterboxMigrationState,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      addSuccessToast,\n      addDangerToast,\n      addWarningToast,\n      onUndo: undoLayoutAction,\n      onRedo: redoLayoutAction,\n      setEditMode,\n      showBuilderPane,\n      setColorSchemeAndUnsavedChanges,\n      fetchFaveStar,\n      saveFaveStar,\n      savePublished,\n      fetchCharts,\n      updateDashboardTitle,\n      updateCss,\n      onChange,\n      onSave: saveDashboardRequest,\n      setMaxUndoHistoryExceeded,\n      maxUndoHistoryToast,\n      logEvent,\n      setRefreshFrequency,\n      onRefresh,\n      dashboardInfoChanged,\n      dashboardTitleChanged,\n      updateDataMask,\n      fetchUISpecificReport,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DashboardHeader);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { MouseEventHandler } from 'react';\nimport { styled } from '@superset-ui/core';\n\ninterface IconButtonProps {\n  icon: JSX.Element;\n  label?: string;\n  onClick: MouseEventHandler<HTMLDivElement>;\n}\n\nconst StyledDiv = styled.div`\n  display: flex;\n  align-items: center;\n  color: ${({ theme }) => theme.colors.grayscale.base};\n  &:hover {\n    color: ${({ theme }) => theme.colors.primary.base};\n  }\n`;\n\nconst StyledSpan = styled.span`\n  margin-left: ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\nconst IconButton = ({ icon, label, onClick }: IconButtonProps) => (\n  <StyledDiv\n    tabIndex={0}\n    role=\"button\"\n    onClick={e => {\n      e.preventDefault();\n      onClick(e);\n    }}\n  >\n    {icon}\n    {label && <StyledSpan>{label}</StyledSpan>}\n  </StyledDiv>\n);\n\nexport default IconButton;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DataRecordFilters } from '@superset-ui/core';\n\nexport default function getEffectiveExtraFilters(filters: DataRecordFilters) {\n  return Object.entries(filters)\n    .map(([column, values]) => ({\n      col: column,\n      op: Array.isArray(values) ? 'IN' : '==',\n      val: values,\n    }))\n    .filter(filter => filter.val !== null);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  Filters,\n  JsonObject,\n  NativeFilterScope,\n} from '@superset-ui/core';\nimport { CHART_TYPE } from './componentTypes';\nimport { ActiveFilters, Layout, LayoutItem } from '../types';\nimport { ChartConfiguration } from '../reducers/types';\nimport { DASHBOARD_ROOT_ID } from './constants';\n\n// Looking for affected chart scopes and values\nexport const findAffectedCharts = ({\n  child,\n  layout,\n  scope,\n  activeFilters,\n  filterId,\n  extraFormData,\n}: {\n  child: string;\n  layout: { [key: string]: LayoutItem };\n  scope: NativeFilterScope;\n  activeFilters: ActiveFilters;\n  filterId: string;\n  extraFormData: any;\n}) => {\n  const chartId = layout[child]?.meta?.chartId;\n  if (layout[child].type === CHART_TYPE) {\n    // Ignore excluded charts\n    if (scope.excluded.includes(chartId)) {\n      return;\n    }\n    if (!activeFilters[filterId]) {\n      // Small mutation but simplify logic\n      // eslint-disable-next-line no-param-reassign\n      activeFilters[filterId] = {\n        scope: [],\n        values: extraFormData,\n      };\n    }\n    // Add not excluded chart scopes(to know what charts refresh) and values(refresh only if its value changed)\n    activeFilters[filterId].scope.push(chartId);\n    return;\n  }\n  // If child is not chart, recursive iterate over its children\n  layout[child].children.forEach((child: string) =>\n    findAffectedCharts({\n      child,\n      layout,\n      scope,\n      activeFilters,\n      filterId,\n      extraFormData,\n    }),\n  );\n};\n\nexport const getRelevantDataMask = (\n  dataMask: DataMaskStateWithId,\n  prop: string,\n): JsonObject | DataMaskStateWithId =>\n  Object.values(dataMask)\n    .filter(item => item[prop])\n    .reduce(\n      (prev, next) => ({ ...prev, [next.id]: prop ? next[prop] : next }),\n      {},\n    );\n\nexport const getAllActiveFilters = ({\n  chartConfiguration,\n  nativeFilters,\n  dataMask,\n  layout,\n}: {\n  chartConfiguration: ChartConfiguration;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: Filters;\n  layout: Layout;\n}): ActiveFilters => {\n  const activeFilters = {};\n\n  // Combine native filters with cross filters, because they have similar logic\n  Object.values(dataMask).forEach(({ id: filterId, extraFormData }) => {\n    const scope = nativeFilters?.[filterId]?.scope ??\n      chartConfiguration?.[filterId]?.crossFilters?.scope ?? {\n        rootPath: [DASHBOARD_ROOT_ID],\n        excluded: [filterId],\n      };\n    // Iterate over all roots to find all affected charts\n    scope.rootPath.forEach((layoutItemId: string | number) => {\n      layout[layoutItemId]?.children?.forEach((child: string) => {\n        // Need exclude from affected charts, charts that located in scope `excluded`\n        findAffectedCharts({\n          child,\n          layout,\n          scope,\n          activeFilters,\n          filterId,\n          extraFormData,\n        });\n      });\n    });\n  });\n  return activeFilters;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  DataRecordFilters,\n  JsonObject,\n  NativeFiltersState,\n} from '@superset-ui/core';\nimport { ChartQueryPayload, Charts, LayoutItem } from 'src/dashboard/types';\nimport { getExtraFormData } from 'src/dashboard/components/nativeFilters/utils';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport getEffectiveExtraFilters from './getEffectiveExtraFilters';\nimport { ChartConfiguration } from '../../reducers/types';\nimport { getAllActiveFilters } from '../activeAllDashboardFilters';\n\n// We cache formData objects so that our connected container components don't always trigger\n// render cascades. we cannot leverage the reselect library because our cache size is >1\nconst cachedFiltersByChart = {};\nconst cachedFormdataByChart = {};\n\nexport interface GetFormDataWithExtraFiltersArguments {\n  chartConfiguration: ChartConfiguration;\n  chart: ChartQueryPayload;\n  charts: Charts;\n  filters: DataRecordFilters;\n  layout: { [key: string]: LayoutItem };\n  colorScheme?: string;\n  colorNamespace?: string;\n  sliceId: number;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: NativeFiltersState;\n  extraControls: Record<string, string | boolean | null>;\n  labelColors?: Record<string, string>;\n  sharedLabelColors?: Record<string, string>;\n}\n\n// this function merge chart's formData with dashboard filters value,\n// and generate a new formData which will be used in the new query.\n// filters param only contains those applicable to this chart.\nexport default function getFormDataWithExtraFilters({\n  chart,\n  charts,\n  filters,\n  nativeFilters,\n  chartConfiguration,\n  colorScheme,\n  colorNamespace,\n  sliceId,\n  layout,\n  dataMask,\n  extraControls,\n  labelColors,\n  sharedLabelColors,\n}: GetFormDataWithExtraFiltersArguments) {\n  // if dashboard metadata + filters have not changed, use cache if possible\n  const cachedFormData = cachedFormdataByChart[sliceId];\n  if (\n    cachedFiltersByChart[sliceId] === filters &&\n    areObjectsEqual(cachedFormData?.color_scheme, colorScheme, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.color_namespace, colorNamespace, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.label_colors, labelColors, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.shared_label_colors, sharedLabelColors, {\n      ignoreUndefined: true,\n    }) &&\n    !!cachedFormData &&\n    areObjectsEqual(cachedFormData?.dataMask, dataMask, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.extraControls, extraControls, {\n      ignoreUndefined: true,\n    })\n  ) {\n    return cachedFormData;\n  }\n\n  let extraData: { extra_form_data?: JsonObject } = {};\n  const activeFilters = getAllActiveFilters({\n    chartConfiguration,\n    dataMask,\n    layout,\n    nativeFilters: nativeFilters.filters,\n  });\n  const filterIdsAppliedOnChart = Object.entries(activeFilters)\n    .filter(([, { scope }]) => scope.includes(chart.id))\n    .map(([filterId]) => filterId);\n  if (filterIdsAppliedOnChart.length) {\n    extraData = {\n      extra_form_data: getExtraFormData(\n        dataMask,\n        charts,\n        filterIdsAppliedOnChart,\n      ),\n    };\n  }\n\n  const formData = {\n    ...chart.formData,\n    label_colors: labelColors,\n    shared_label_colors: sharedLabelColors,\n    ...(colorScheme && { color_scheme: colorScheme }),\n    extra_filters: getEffectiveExtraFilters(filters),\n    ...extraData,\n    ...extraControls,\n  };\n\n  cachedFiltersByChart[sliceId] = filters;\n  cachedFormdataByChart[sliceId] = { ...formData, dataMask, extraControls };\n\n  return formData;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ReactNode } from 'react';\n\nexport enum ScopingType {\n  all,\n  specific,\n}\n\n/** UI Ant tree type */\nexport type TreeItem = {\n  children: TreeItem[];\n  key: string;\n  title: ReactNode;\n};\n\nexport type BuildTreeLeafTitle = (\n  label: string,\n  hasTooltip: boolean,\n  tooltipTitle?: string,\n) => ReactNode;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Charts, Layout, LayoutItem } from 'src/dashboard/types';\nimport {\n  CHART_TYPE,\n  DASHBOARD_ROOT_TYPE,\n  TAB_TYPE,\n} from 'src/dashboard/util/componentTypes';\nimport { DASHBOARD_ROOT_ID } from 'src/dashboard/util/constants';\nimport { NativeFilterScope, t } from '@superset-ui/core';\nimport { BuildTreeLeafTitle, TreeItem } from './types';\n\nexport const isShowTypeInTree = ({ type, meta }: LayoutItem, charts?: Charts) =>\n  (type === TAB_TYPE || type === CHART_TYPE || type === DASHBOARD_ROOT_TYPE) &&\n  (!charts || charts[meta?.chartId]?.formData?.viz_type !== 'filter_box');\n\nexport const buildTree = (\n  node: LayoutItem,\n  treeItem: TreeItem,\n  layout: Layout,\n  charts: Charts,\n  validNodes: string[],\n  initiallyExcludedCharts: number[],\n  buildTreeLeafTitle: BuildTreeLeafTitle,\n) => {\n  let itemToPass: TreeItem = treeItem;\n  if (\n    isShowTypeInTree(node, charts) &&\n    node.type !== DASHBOARD_ROOT_TYPE &&\n    validNodes.includes(node.id)\n  ) {\n    const title = buildTreeLeafTitle(\n      node.meta.sliceNameOverride ||\n        node.meta.sliceName ||\n        node.meta.text ||\n        node.meta.defaultText ||\n        node.id.toString(),\n      initiallyExcludedCharts.includes(node.meta?.chartId),\n      t(\n        \"This chart might be incompatible with the filter (datasets don't match)\",\n      ),\n    );\n\n    const currentTreeItem = {\n      key: node.id,\n      title,\n      children: [],\n    };\n    treeItem.children.push(currentTreeItem);\n    itemToPass = currentTreeItem;\n  }\n  node.children.forEach(child =>\n    buildTree(\n      layout[child],\n      itemToPass,\n      layout,\n      charts,\n      validNodes,\n      initiallyExcludedCharts,\n      buildTreeLeafTitle,\n    ),\n  );\n};\n\nconst addInvisibleParents = (layout: Layout, item: string) => [\n  ...(layout[item]?.children || []),\n  ...Object.values(layout)\n    .filter(\n      val =>\n        val.parents &&\n        val.parents[val.parents.length - 1] === item &&\n        !isShowTypeInTree(layout[val.parents[val.parents.length - 1]]),\n    )\n    .map(({ id }) => id),\n];\n\n// Generate checked options for Ant tree from redux scope\nconst checkTreeItem = (\n  checkedItems: string[],\n  layout: Layout,\n  items: string[],\n  excluded: number[],\n) => {\n  items.forEach(item => {\n    checkTreeItem(\n      checkedItems,\n      layout,\n      addInvisibleParents(layout, item),\n      excluded,\n    );\n    if (\n      layout[item]?.type === CHART_TYPE &&\n      !excluded.includes(layout[item]?.meta.chartId)\n    ) {\n      checkedItems.push(item);\n    }\n  });\n};\n\nexport const getTreeCheckedItems = (\n  scope: NativeFilterScope,\n  layout: Layout,\n) => {\n  const checkedItems: string[] = [];\n  checkTreeItem(checkedItems, layout, [...scope.rootPath], [...scope.excluded]);\n  return [...new Set(checkedItems)];\n};\n\n// Looking for first common parent for selected charts/tabs/tab\nexport const findFilterScope = (\n  checkedKeys: string[],\n  layout: Layout,\n): NativeFilterScope => {\n  if (!checkedKeys.length) {\n    return {\n      rootPath: [],\n      excluded: [],\n    };\n  }\n\n  // Get arrays of parents for selected charts\n  const checkedItemParents = checkedKeys\n    .filter(item => layout[item]?.type === CHART_TYPE)\n    .map(key => {\n      const parents = [DASHBOARD_ROOT_ID, ...(layout[key]?.parents || [])];\n      return parents.filter(parent => isShowTypeInTree(layout[parent]));\n    });\n  // Sort arrays of parents to get first shortest array of parents,\n  // that means on it's level of parents located common parent, from this place parents start be different\n  checkedItemParents.sort((p1, p2) => p1.length - p2.length);\n  const rootPath = checkedItemParents.map(\n    parents => parents[checkedItemParents[0].length - 1],\n  );\n\n  const excluded: number[] = [];\n  const isExcluded = (parent: string, item: string) =>\n    rootPath.includes(parent) && !checkedKeys.includes(item);\n  // looking for charts to be excluded: iterate over all charts\n  // and looking for charts that have one of their parents in `rootPath` and not in selected items\n  Object.entries(layout).forEach(([key, value]) => {\n    const parents = value.parents || [];\n    if (\n      value.type === CHART_TYPE &&\n      [DASHBOARD_ROOT_ID, ...parents]?.find(parent => isExcluded(parent, key))\n    ) {\n      excluded.push(value.meta.chartId);\n    }\n  });\n\n  return {\n    rootPath: [...new Set(rootPath)],\n    excluded,\n  };\n};\n\nexport const getDefaultScopeValue = (\n  chartId?: number,\n  initiallyExcludedCharts: number[] = [],\n): NativeFilterScope => ({\n  rootPath: [DASHBOARD_ROOT_ID],\n  excluded: chartId\n    ? [chartId, ...initiallyExcludedCharts]\n    : initiallyExcludedCharts,\n});\n\nexport const isScopingAll = (scope: NativeFilterScope, chartId?: number) =>\n  !scope ||\n  (scope.rootPath[0] === DASHBOARD_ROOT_ID &&\n    !scope.excluded.filter(item => item !== chartId).length);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { FC, useMemo, useState } from 'react';\nimport { NativeFilterScope } from '@superset-ui/core';\nimport { Tree } from 'src/components';\nimport { DASHBOARD_ROOT_ID } from 'src/dashboard/util/constants';\nimport { Tooltip } from 'src/components/Tooltip';\nimport Icons from 'src/components/Icons';\nimport { useFilterScopeTree } from './state';\nimport { findFilterScope, getTreeCheckedItems } from './utils';\n\ntype ScopingTreeProps = {\n  forceUpdate: Function;\n  updateFormValues: (values: any) => void;\n  formScope?: NativeFilterScope;\n  initialScope: NativeFilterScope;\n  chartId?: number;\n  initiallyExcludedCharts?: number[];\n};\n\nconst buildTreeLeafTitle = (\n  label: string,\n  hasTooltip: boolean,\n  tooltipTitle?: string,\n) => {\n  let title = <span>{label}</span>;\n  if (hasTooltip) {\n    title = (\n      <>\n        {title}&nbsp;\n        <Tooltip title={tooltipTitle}>\n          <Icons.Info iconSize=\"m\" />\n        </Tooltip>\n      </>\n    );\n  }\n  return title;\n};\n\nconst ScopingTree: FC<ScopingTreeProps> = ({\n  formScope,\n  initialScope,\n  forceUpdate,\n  updateFormValues,\n  chartId,\n  initiallyExcludedCharts = [],\n}) => {\n  const [expandedKeys, setExpandedKeys] = useState<string[]>([\n    DASHBOARD_ROOT_ID,\n  ]);\n\n  const { treeData, layout } = useFilterScopeTree(\n    chartId,\n    initiallyExcludedCharts,\n    buildTreeLeafTitle,\n  );\n  const [autoExpandParent, setAutoExpandParent] = useState<boolean>(true);\n\n  const handleExpand = (expandedKeys: string[]) => {\n    setExpandedKeys(expandedKeys);\n    setAutoExpandParent(false);\n  };\n\n  const handleCheck = (checkedKeys: string[]) => {\n    forceUpdate();\n    const scope = findFilterScope(checkedKeys, layout);\n    if (chartId !== undefined) {\n      scope.excluded = [...new Set([...scope.excluded, chartId])];\n    }\n    updateFormValues({\n      scope,\n    });\n  };\n\n  const checkedKeys = useMemo(\n    () => getTreeCheckedItems({ ...(formScope || initialScope) }, layout),\n    [formScope, initialScope, layout],\n  );\n\n  return (\n    <Tree\n      checkable\n      selectable={false}\n      onExpand={handleExpand}\n      expandedKeys={expandedKeys}\n      autoExpandParent={autoExpandParent}\n      onCheck={handleCheck}\n      checkedKeys={checkedKeys}\n      treeData={treeData}\n    />\n  );\n};\n\nexport default ScopingTree;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { t } from '@superset-ui/core';\nimport { Charts, Layout, RootState } from 'src/dashboard/types';\nimport { DASHBOARD_ROOT_ID } from 'src/dashboard/util/constants';\nimport {\n  CHART_TYPE,\n  DASHBOARD_ROOT_TYPE,\n} from 'src/dashboard/util/componentTypes';\nimport { BuildTreeLeafTitle, TreeItem } from './types';\nimport { buildTree } from './utils';\n\n// eslint-disable-next-line import/prefer-default-export\nexport function useFilterScopeTree(\n  currentChartId?: number,\n  initiallyExcludedCharts: number[] = [],\n  buildTreeLeafTitle: BuildTreeLeafTitle = label => label,\n): {\n  treeData: [TreeItem];\n  layout: Layout;\n} {\n  const layout = useSelector<RootState, Layout>(\n    ({ dashboardLayout: { present } }) => present,\n  );\n\n  const charts = useSelector<RootState, Charts>(({ charts }) => charts);\n  const tree = {\n    children: [],\n    key: DASHBOARD_ROOT_ID,\n    type: DASHBOARD_ROOT_TYPE,\n    title: t('All panels'),\n  };\n\n  // We need to get only nodes that have charts as children or grandchildren\n  const validNodes = useMemo(\n    () =>\n      Object.values(layout).reduce<string[]>((acc, cur) => {\n        const { id, parents = [], type, meta } = cur;\n        if (type === CHART_TYPE && currentChartId !== meta?.chartId) {\n          return [...new Set([...acc, ...parents, id])];\n        }\n        return acc;\n      }, []),\n    [layout, currentChartId],\n  );\n\n  useMemo(() => {\n    buildTree(\n      layout[DASHBOARD_ROOT_ID],\n      tree,\n      layout,\n      charts,\n      validNodes,\n      initiallyExcludedCharts,\n      buildTreeLeafTitle,\n    );\n  }, [layout, tree, charts, initiallyExcludedCharts, buildTreeLeafTitle]);\n\n  return { treeData: [tree], layout };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { FC, useCallback, useState } from 'react';\nimport { NativeFilterScope, styled, t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { AntdForm, Typography } from 'src/components';\nimport { useComponentDidUpdate } from 'src/hooks/useComponentDidUpdate/useComponentDidUpdate';\nimport { ScopingType } from './types';\nimport ScopingTree from './ScopingTree';\nimport { getDefaultScopeValue, isScopingAll } from './utils';\n\ntype FilterScopeProps = {\n  pathToFormValue?: string[];\n  updateFormValues: (values: any) => void;\n  formFilterScope?: NativeFilterScope;\n  forceUpdate: Function;\n  filterScope?: NativeFilterScope;\n  formScopingType?: ScopingType;\n  chartId?: number;\n  initiallyExcludedCharts?: number[];\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  & > * {\n    margin-bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n  padding: 0px ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nconst CleanFormItem = styled(AntdForm.Item)`\n  margin-bottom: 0;\n`;\n\nconst FilterScope: FC<FilterScopeProps> = ({\n  pathToFormValue = [],\n  formScopingType,\n  formFilterScope,\n  forceUpdate,\n  filterScope,\n  updateFormValues,\n  chartId,\n  initiallyExcludedCharts,\n}) => {\n  const [initialFilterScope] = useState(\n    filterScope || getDefaultScopeValue(chartId, initiallyExcludedCharts),\n  );\n  const [initialScopingType] = useState(\n    isScopingAll(initialFilterScope, chartId)\n      ? ScopingType.all\n      : ScopingType.specific,\n  );\n  const [hasScopeBeenModified, setHasScopeBeenModified] = useState(\n    !!filterScope,\n  );\n\n  const onUpdateFormValues = useCallback(\n    (formValues: any) => {\n      updateFormValues(formValues);\n      setHasScopeBeenModified(true);\n    },\n    [updateFormValues],\n  );\n\n  const updateScopes = useCallback(() => {\n    if (filterScope || hasScopeBeenModified) {\n      return;\n    }\n\n    const newScope = getDefaultScopeValue(chartId, initiallyExcludedCharts);\n    updateFormValues({\n      scope: newScope,\n      scoping: isScopingAll(newScope, chartId)\n        ? ScopingType.all\n        : ScopingType.specific,\n    });\n  }, [\n    chartId,\n    filterScope,\n    hasScopeBeenModified,\n    initiallyExcludedCharts,\n    updateFormValues,\n  ]);\n  useComponentDidUpdate(updateScopes);\n\n  return (\n    <Wrapper>\n      <CleanFormItem\n        name={[...pathToFormValue, 'scoping']}\n        initialValue={initialScopingType}\n      >\n        <Radio.Group\n          onChange={({ target: { value } }) => {\n            if (value === ScopingType.all) {\n              const scope = getDefaultScopeValue(chartId);\n              updateFormValues({\n                scope,\n              });\n            }\n            setHasScopeBeenModified(true);\n            forceUpdate();\n          }}\n        >\n          <Radio value={ScopingType.all}>{t('Apply to all panels')}</Radio>\n          <Radio value={ScopingType.specific}>\n            {t('Apply to specific panels')}\n          </Radio>\n        </Radio.Group>\n      </CleanFormItem>\n      <Typography.Text type=\"secondary\">\n        {(formScopingType ?? initialScopingType) === ScopingType.specific\n          ? t('Only selected panels will be affected by this filter')\n          : t('All panels with this column will be affected by this filter')}\n      </Typography.Text>\n      {(formScopingType ?? initialScopingType) === ScopingType.specific && (\n        <ScopingTree\n          updateFormValues={onUpdateFormValues}\n          initialScope={initialFilterScope}\n          formScope={formFilterScope}\n          forceUpdate={forceUpdate}\n          chartId={chartId}\n          initiallyExcludedCharts={initiallyExcludedCharts}\n        />\n      )}\n      <CleanFormItem\n        name={[...pathToFormValue, 'scope']}\n        hidden\n        initialValue={initialFilterScope}\n      />\n    </Wrapper>\n  );\n};\n\nexport default FilterScope;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { flatMapDeep } from 'lodash';\nimport { FormInstance } from 'src/components';\nimport React from 'react';\nimport { CustomControlItem, Dataset } from '@superset-ui/chart-controls';\nimport { Column, ensureIsArray, GenericDataType } from '@superset-ui/core';\nimport { DatasourcesState, ChartsState } from 'src/dashboard/types';\n\nconst FILTERS_FIELD_NAME = 'filters';\n\nexport const FILTER_SUPPORTED_TYPES = {\n  filter_time: [GenericDataType.TEMPORAL],\n  filter_timegrain: [GenericDataType.TEMPORAL],\n  filter_timecolumn: [GenericDataType.TEMPORAL],\n  filter_select: [\n    GenericDataType.BOOLEAN,\n    GenericDataType.STRING,\n    GenericDataType.NUMERIC,\n    GenericDataType.TEMPORAL,\n  ],\n  filter_range: [GenericDataType.NUMERIC],\n};\n\nexport const useForceUpdate = () => {\n  const [, updateState] = React.useState({});\n  return React.useCallback(() => updateState({}), []);\n};\n\nexport const setNativeFilterFieldValues = (\n  form: FormInstance,\n  filterId: string,\n  values: object,\n) => {\n  const formFilters = form.getFieldValue(FILTERS_FIELD_NAME) || {};\n  form.setFields([\n    {\n      name: FILTERS_FIELD_NAME,\n      value: {\n        ...formFilters,\n        [filterId]: {\n          ...formFilters[filterId],\n          ...values,\n        },\n      },\n    },\n  ]);\n};\n\nexport const getControlItems = (\n  controlConfig: { [key: string]: any } = {},\n): CustomControlItem[] =>\n  (flatMapDeep(controlConfig.controlPanelSections)?.reduce(\n    (acc: any, { controlSetRows = [] }: any) => [\n      ...acc,\n      ...flatMapDeep(controlSetRows),\n    ],\n    [],\n  ) as CustomControlItem[]) ?? [];\n\ntype DatasetSelectValue = {\n  value: number;\n  label: string;\n};\n\nexport const datasetToSelectOption = (\n  item: Dataset & { table_name: string },\n): DatasetSelectValue => ({\n  value: item.id,\n  label: item.table_name,\n});\n\n// TODO: add column_types field to Dataset\n// We return true if column_types is undefined or empty as a precaution against backend failing to return column_types\nexport const hasTemporalColumns = (\n  dataset: Dataset & { column_types: GenericDataType[] },\n) => {\n  const columnTypes = ensureIsArray(dataset?.column_types);\n  return (\n    columnTypes.length === 0 || columnTypes.includes(GenericDataType.TEMPORAL)\n  );\n};\n\nexport const doesColumnMatchFilterType = (filterType: string, column: Column) =>\n  !column.type_generic ||\n  !(filterType in FILTER_SUPPORTED_TYPES) ||\n  FILTER_SUPPORTED_TYPES[filterType]?.includes(column.type_generic);\n\nexport const mostUsedDataset = (\n  datasets: DatasourcesState,\n  charts: ChartsState,\n) => {\n  const map = new Map<string, number>();\n  let mostUsedDataset = '';\n  let maxCount = 0;\n\n  Object.values(charts).forEach(chart => {\n    const { formData } = chart;\n    if (formData) {\n      const { datasource } = formData;\n      const count = (map.get(datasource) || 0) + 1;\n      map.set(datasource, count);\n\n      if (count > maxCount) {\n        maxCount = count;\n        mostUsedDataset = datasource;\n      }\n    }\n  });\n\n  return datasets[mostUsedDataset]?.id;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC } from 'react';\nimport { FormInstance } from 'src/components';\nimport { NativeFilterScope } from '@superset-ui/core';\nimport FilterScope from 'src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope';\nimport { setCrossFilterFieldValues } from 'src/dashboard/components/CrossFilterScopingModal/utils';\nimport { useForceUpdate } from 'src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/utils';\nimport { CrossFilterScopingFormType } from 'src/dashboard/components/CrossFilterScopingModal/types';\n\ntype CrossFilterScopingFormProps = {\n  chartId: number;\n  scope: NativeFilterScope;\n  form: FormInstance<CrossFilterScopingFormType>;\n};\n\nconst CrossFilterScopingForm: FC<CrossFilterScopingFormProps> = ({\n  form,\n  scope,\n  chartId,\n}) => {\n  const forceUpdate = useForceUpdate();\n  const formScope = form.getFieldValue('scope');\n  const formScoping = form.getFieldValue('scoping');\n  return (\n    <FilterScope\n      updateFormValues={(values: any) => {\n        setCrossFilterFieldValues(form, {\n          ...values,\n        });\n      }}\n      filterScope={scope}\n      chartId={chartId}\n      formFilterScope={formScope}\n      forceUpdate={forceUpdate}\n      formScopingType={formScoping}\n    />\n  );\n};\n\nexport default CrossFilterScopingForm;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FormInstance } from 'src/components';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const setCrossFilterFieldValues = (\n  form: FormInstance,\n  values: object,\n) => {\n  form.setFieldsValue({\n    ...values,\n  });\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useSelector } from 'react-redux';\nimport { useMemo } from 'react';\nimport {\n  Filter,\n  FilterConfiguration,\n  Divider,\n  isFilterDivider,\n} from '@superset-ui/core';\nimport { ActiveTabs, DashboardLayout, RootState } from '../../types';\nimport { TAB_TYPE } from '../../util/componentTypes';\n\nconst defaultFilterConfiguration: Filter[] = [];\n\nexport function useFilterConfiguration() {\n  return useSelector<any, FilterConfiguration>(\n    state =>\n      state.dashboardInfo?.metadata?.native_filter_configuration ||\n      defaultFilterConfiguration,\n  );\n}\n\n/**\n * returns the dashboard's filter configuration,\n * converted into a map of id -> filter\n */\nexport function useFilterConfigMap() {\n  const filterConfig = useFilterConfiguration();\n  return useMemo(\n    () =>\n      filterConfig.reduce(\n        (acc: Record<string, Filter | Divider>, filter: Filter) => {\n          acc[filter.id] = filter;\n          return acc;\n        },\n        {} as Record<string, Filter | Divider>,\n      ),\n    [filterConfig],\n  );\n}\n\nexport function useDashboardLayout() {\n  return useSelector<any, DashboardLayout>(\n    state => state.dashboardLayout?.present,\n  );\n}\n\nexport function useDashboardHasTabs() {\n  const dashboardLayout = useDashboardLayout();\n  return useMemo(\n    () =>\n      Object.values(dashboardLayout).some(element => element.type === TAB_TYPE),\n    [dashboardLayout],\n  );\n}\n\nfunction useActiveDashboardTabs() {\n  return useSelector<RootState, ActiveTabs>(\n    state => state.dashboardState?.activeTabs,\n  );\n}\n\nfunction useSelectChartTabParents() {\n  const dashboardLayout = useDashboardLayout();\n  return (chartId: number) => {\n    const chartLayoutItem = Object.values(dashboardLayout).find(\n      layoutItem => layoutItem.meta?.chartId === chartId,\n    );\n    return chartLayoutItem?.parents.filter(\n      (parent: string) => dashboardLayout[parent].type === TAB_TYPE,\n    );\n  };\n}\n\nfunction useIsFilterInScope() {\n  const activeTabs = useActiveDashboardTabs();\n  const selectChartTabParents = useSelectChartTabParents();\n\n  // Filter is in scope if any of it's charts is visible.\n  // Chart is visible if it's placed in an active tab tree or if it's not attached to any tab.\n  // Chart is in an active tab tree if all of it's ancestors of type TAB are active\n  // Dividers are always in scope\n  return (filter: Filter | Divider) =>\n    isFilterDivider(filter) ||\n    ('chartsInScope' in filter &&\n      filter.chartsInScope?.some((chartId: number) => {\n        const tabParents = selectChartTabParents(chartId);\n        return (\n          tabParents?.length === 0 ||\n          tabParents?.every(tab => activeTabs.includes(tab))\n        );\n      }));\n}\n\nexport function useSelectFiltersInScope(filters: (Filter | Divider)[]) {\n  const dashboardHasTabs = useDashboardHasTabs();\n  const isFilterInScope = useIsFilterInScope();\n\n  return useMemo(() => {\n    let filtersInScope: (Filter | Divider)[] = [];\n    const filtersOutOfScope: (Filter | Divider)[] = [];\n\n    // we check native filters scopes only on dashboards with tabs\n    if (!dashboardHasTabs) {\n      filtersInScope = filters;\n    } else {\n      filters.forEach(filter => {\n        const filterInScope = isFilterInScope(filter);\n\n        if (filterInScope) {\n          filtersInScope.push(filter);\n        } else {\n          filtersOutOfScope.push(filter);\n        }\n      });\n    }\n    return [filtersInScope, filtersOutOfScope];\n  }, [filters, dashboardHasTabs, isFilterInScope]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { styled } from '@superset-ui/core';\nimport React, { useRef } from 'react';\nimport {\n  DragSourceMonitor,\n  DropTargetMonitor,\n  useDrag,\n  useDrop,\n  XYCoord,\n} from 'react-dnd';\nimport Icons, { IconType } from 'src/components/Icons';\n\ninterface TitleContainerProps {\n  readonly isDragging: boolean;\n}\n\nconst FILTER_TYPE = 'FILTER';\n\nconst Container = styled.div<TitleContainerProps>`\n  ${({ isDragging, theme }) => `\n    opacity: ${isDragging ? 0.3 : 1};\n    cursor: ${isDragging ? 'grabbing' : 'pointer'};\n    width: 100%;\n    display: flex;\n    padding:  ${theme.gridUnit}px;\n  `}\n`;\n\nconst DragIcon = styled(Icons.Drag, {\n  shouldForwardProp: propName => propName !== 'isDragging',\n})<IconType & { isDragging: boolean }>`\n  ${({ isDragging, theme }) => `\n    font-size: ${theme.typography.sizes.m}px;\n    margin-top: 15px;\n    cursor: ${isDragging ? 'grabbing' : 'grab'};\n    padding-left: ${theme.gridUnit}px;\n  `}\n`;\n\ninterface FilterTabTitleProps {\n  index: number;\n  filterIds: string[];\n  onRearrange: (dragItemIndex: number, targetIndex: number) => void;\n}\n\ninterface DragItem {\n  index: number;\n  filterIds: string[];\n  type: string;\n}\n\nexport const DraggableFilter: React.FC<FilterTabTitleProps> = ({\n  index,\n  onRearrange,\n  filterIds,\n  children,\n}) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const [{ isDragging }, drag] = useDrag({\n    item: { filterIds, type: FILTER_TYPE, index },\n    collect: (monitor: DragSourceMonitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n  const [, drop] = useDrop({\n    accept: FILTER_TYPE,\n    hover: (item: DragItem, monitor: DropTargetMonitor) => {\n      if (!ref.current) {\n        return;\n      }\n\n      const dragIndex = item.index;\n      const hoverIndex = index;\n\n      // Don't replace items with themselves\n      if (dragIndex === hoverIndex) {\n        return;\n      }\n      // Determine rectangle on screen\n      const hoverBoundingRect = ref.current?.getBoundingClientRect();\n\n      // Get vertical middle\n      const hoverMiddleY =\n        (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n\n      // Determine mouse position\n      const clientOffset = monitor.getClientOffset();\n\n      // Get pixels to the top\n      const hoverClientY = (clientOffset as XYCoord).y - hoverBoundingRect.top;\n\n      // Only perform the move when the mouse has crossed half of the items height\n      // When dragging downwards, only move when the cursor is below 50%\n      // When dragging upwards, only move when the cursor is above 50%\n\n      // Dragging downwards\n      if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n        return;\n      }\n\n      // Dragging upwards\n      if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n        return;\n      }\n\n      onRearrange(dragIndex, hoverIndex);\n      // Note: we're mutating the monitor item here.\n      // Generally it's better to avoid mutations,\n      // but it's good here for the sake of performance\n      // to avoid expensive index searches.\n      // eslint-disable-next-line no-param-reassign\n      item.index = hoverIndex;\n    },\n  });\n  drag(drop(ref));\n  return (\n    <Container ref={ref} isDragging={isDragging}>\n      <DragIcon\n        isDragging={isDragging}\n        alt=\"Move icon\"\n        className=\"dragIcon\"\n        viewBox=\"4 4 16 16\"\n      />\n      <div css={{ flex: 1 }}>{children}</div>\n    </Container>\n  );\n};\n\nexport default DraggableFilter;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { forwardRef } from 'react';\nimport { styled, t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { FilterRemoval } from './types';\nimport DraggableFilter from './DraggableFilter';\n\nconst FilterTitle = styled.div`\n  ${({ theme }) => `\n      display: flex;\n      align-items: center;\n      padding: ${theme.gridUnit * 2}px;\n      width: 100%;\n      border-radius: ${theme.borderRadius}px;\n      &.active {\n        color: ${theme.colors.grayscale.dark1};\n        border-radius: ${theme.borderRadius}px;\n        background-color: ${theme.colors.secondary.light4};\n        span, .anticon {\n          color: ${theme.colors.grayscale.dark1};\n        }\n      }\n      &:hover {\n        color: ${theme.colors.primary.light1};\n        span, .anticon {\n          color: ${theme.colors.primary.light1};\n        }\n      }\n      &.errored div, &.errored .warning {\n        color: ${theme.colors.error.base};\n      }\n  `}\n`;\n\nconst StyledTrashIcon = styled(Icons.Trash)`\n  color: ${({ theme }) => theme.colors.grayscale.light3};\n`;\n\nconst StyledWarning = styled(Icons.Warning)`\n  color: ${({ theme }) => theme.colors.error.base};\n  &.anticon {\n    margin-left: auto;\n  }\n`;\n\nconst Container = styled.div`\n  height: 100%;\n  overflow-y: auto;\n`;\n\ninterface Props {\n  getFilterTitle: (filterId: string) => string;\n  onChange: (filterId: string) => void;\n  currentFilterId: string;\n  removedFilters: Record<string, FilterRemoval>;\n  onRemove: (id: string) => void;\n  restoreFilter: (id: string) => void;\n  onRearrange: (dragIndex: number, targetIndex: number) => void;\n  filters: string[];\n  erroredFilters: string[];\n}\n\nconst FilterTitleContainer = forwardRef<HTMLDivElement, Props>(\n  (\n    {\n      getFilterTitle,\n      onChange,\n      onRemove,\n      restoreFilter,\n      onRearrange,\n      currentFilterId,\n      removedFilters,\n      filters,\n      erroredFilters = [],\n    },\n    ref,\n  ) => {\n    const renderComponent = (id: string) => {\n      const isRemoved = !!removedFilters[id];\n      const isErrored = erroredFilters.includes(id);\n      const isActive = currentFilterId === id;\n      const classNames = [];\n      if (isErrored) {\n        classNames.push('errored');\n      }\n      if (isActive) {\n        classNames.push('active');\n      }\n      return (\n        <FilterTitle\n          role=\"tab\"\n          key={`filter-title-tab-${id}`}\n          onClick={() => onChange(id)}\n          className={classNames.join(' ')}\n        >\n          <div css={{ display: 'flex', width: '100%' }}>\n            <div css={{ alignItems: 'center', display: 'flex' }}>\n              {isRemoved ? t('(Removed)') : getFilterTitle(id)}\n            </div>\n            {!removedFilters[id] && isErrored && (\n              <StyledWarning className=\"warning\" />\n            )}\n            {isRemoved && (\n              <span\n                css={{ alignSelf: 'flex-end', marginLeft: 'auto' }}\n                role=\"button\"\n                data-test=\"undo-button\"\n                tabIndex={0}\n                onClick={e => {\n                  e.preventDefault();\n                  restoreFilter(id);\n                }}\n              >\n                {t('Undo?')}\n              </span>\n            )}\n          </div>\n          <div css={{ alignSelf: 'flex-start', marginLeft: 'auto' }}>\n            {isRemoved ? null : (\n              <StyledTrashIcon\n                onClick={event => {\n                  event.stopPropagation();\n                  onRemove(id);\n                }}\n                alt=\"RemoveFilter\"\n              />\n            )}\n          </div>\n        </FilterTitle>\n      );\n    };\n\n    const renderFilterGroups = () => {\n      const items: React.ReactNode[] = [];\n      filters.forEach((item, index) => {\n        items.push(\n          <DraggableFilter\n            key={index}\n            onRearrange={onRearrange}\n            index={index}\n            filterIds={[item]}\n          >\n            {renderComponent(item)}\n          </DraggableFilter>,\n        );\n      });\n      return items;\n    };\n\n    return (\n      <Container data-test=\"filter-title-container\" ref={ref}>\n        {renderFilterGroups()}\n      </Container>\n    );\n  },\n);\n\nexport default FilterTitleContainer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useRef } from 'react';\nimport { NativeFilterType, styled, t, useTheme } from '@superset-ui/core';\nimport { AntdDropdown } from 'src/components';\nimport { MainNav as Menu } from 'src/components/Menu';\nimport FilterTitleContainer from './FilterTitleContainer';\nimport { FilterRemoval } from './types';\n\ninterface Props {\n  restoreFilter: (id: string) => void;\n  getFilterTitle: (id: string) => string;\n  onRearrange: (dragIndex: number, targetIndex: number) => void;\n  onRemove: (id: string) => void;\n  onChange: (id: string) => void;\n  onAdd: (type: NativeFilterType) => void;\n  removedFilters: Record<string, FilterRemoval>;\n  currentFilterId: string;\n  filters: string[];\n  erroredFilters: string[];\n}\n\nconst StyledAddBox = styled.div`\n  ${({ theme }) => `\n  cursor: pointer;\n  margin: ${theme.gridUnit * 4}px;\n  color: ${theme.colors.primary.base};\n  &:hover {\n    color: ${theme.colors.primary.dark1};\n  }\n`}\n`;\nconst TabsContainer = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst options = [\n  { label: 'Filter', type: NativeFilterType.NATIVE_FILTER },\n  { label: 'Divider', type: NativeFilterType.DIVIDER },\n];\n\nconst FilterTitlePane: React.FC<Props> = ({\n  getFilterTitle,\n  onChange,\n  onAdd,\n  onRemove,\n  onRearrange,\n  restoreFilter,\n  currentFilterId,\n  filters,\n  removedFilters,\n  erroredFilters,\n}) => {\n  const filtersContainerRef = useRef<HTMLDivElement>(null);\n  const theme = useTheme();\n\n  const handleOnAdd = (type: NativeFilterType) => {\n    onAdd(type);\n    setTimeout(() => {\n      const element = document.getElementById('native-filters-tabs');\n      if (element) {\n        const navList = element.getElementsByClassName('ant-tabs-nav-list')[0];\n        navList.scrollTop = navList.scrollHeight;\n      }\n\n      filtersContainerRef?.current?.scroll?.({\n        top: filtersContainerRef.current.scrollHeight,\n        behavior: 'smooth',\n      });\n    }, 0);\n  };\n  const menu = (\n    <Menu mode=\"horizontal\">\n      {options.map(item => (\n        <Menu.Item onClick={() => handleOnAdd(item.type)}>\n          {item.label}\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n  return (\n    <TabsContainer>\n      <AntdDropdown\n        overlay={menu}\n        arrow\n        placement=\"topLeft\"\n        trigger={['hover']}\n      >\n        <StyledAddBox>\n          <div data-test=\"new-dropdown-icon\" className=\"fa fa-plus\" />{' '}\n          <span>{t('Add filters and dividers')}</span>\n        </StyledAddBox>\n      </AntdDropdown>\n      <div\n        css={{\n          height: '100%',\n          overflowY: 'auto',\n          marginLeft: theme.gridUnit * 3,\n        }}\n      >\n        <FilterTitleContainer\n          ref={filtersContainerRef}\n          filters={filters}\n          currentFilterId={currentFilterId}\n          removedFilters={removedFilters}\n          getFilterTitle={getFilterTitle}\n          erroredFilters={erroredFilters}\n          onChange={onChange}\n          onRemove={onRemove}\n          onRearrange={onRearrange}\n          restoreFilter={restoreFilter}\n        />\n      </div>\n    </TabsContainer>\n  );\n};\n\nexport default FilterTitlePane;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { NativeFilterType, styled } from '@superset-ui/core';\nimport React from 'react';\nimport FilterTitlePane from './FilterTitlePane';\nimport { FilterRemoval } from './types';\n\ninterface Props {\n  children: (filterId: string) => React.ReactNode;\n  getFilterTitle: (filterId: string) => string;\n  onChange: (activeKey: string) => void;\n  onAdd: (type: NativeFilterType) => void;\n  onRemove: (id: string) => void;\n  onRearrange: (dragIndex: number, targetIndex: number) => void;\n  erroredFilters: string[];\n  restoreFilter: (id: string) => void;\n  currentFilterId: string;\n  filters: string[];\n  removedFilters: Record<string, FilterRemoval>;\n}\n\nconst Container = styled.div`\n  display: flex;\n  height: 100%;\n`;\n\nconst ContentHolder = styled.div`\n  flex-grow: 3;\n  margin-left: ${({ theme }) => theme.gridUnit * -1 - 1};\n`;\n\nconst TitlesContainer = styled.div`\n  width: 270px;\n  border-right: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n`;\n\nconst FilterConfigurePane: React.FC<Props> = ({\n  getFilterTitle,\n  onChange,\n  onRemove,\n  onRearrange,\n  restoreFilter,\n  onAdd,\n  erroredFilters,\n  children,\n  currentFilterId,\n  filters,\n  removedFilters,\n}) => {\n  const active = filters.filter(id => id === currentFilterId)[0];\n  return (\n    <Container>\n      <TitlesContainer>\n        <FilterTitlePane\n          currentFilterId={currentFilterId}\n          filters={filters}\n          removedFilters={removedFilters}\n          erroredFilters={erroredFilters}\n          getFilterTitle={getFilterTitle}\n          onChange={onChange}\n          onAdd={(type: NativeFilterType) => onAdd(type)}\n          onRearrange={onRearrange}\n          onRemove={(id: string) => onRemove(id)}\n          restoreFilter={restoreFilter}\n        />\n      </TitlesContainer>\n      <ContentHolder>\n        {filters.map(id => (\n          <div\n            key={id}\n            style={{\n              height: '100%',\n              overflowY: 'auto',\n              display: id === active ? '' : 'none',\n            }}\n          >\n            {children(id)}\n          </div>\n        ))}\n      </ContentHolder>\n    </Container>\n  );\n};\n\nexport default FilterConfigurePane;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { styled, useTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { ErrorLevel } from './types';\n\nconst StyledContainer = styled.div<{ level: ErrorLevel }>`\n  display: flex;\n  flex-direction: row;\n  background-color: ${({ level, theme }) => theme.colors[level].light2};\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ level, theme }) => theme.colors[level].base};\n  color: ${({ level, theme }) => theme.colors[level].dark2};\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n  margin-bottom: ${({ theme }) => theme.gridUnit}px;\n  width: 100%;\n`;\n\nconst StyledContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-left: ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\nconst StyledTitle = styled.span`\n  font-weight: ${({ theme }) => theme.typography.weights.bold};\n`;\n\ninterface BasicErrorAlertProps {\n  title: string;\n  body: string;\n  level: ErrorLevel;\n}\n\nexport default function BasicErrorAlert({\n  body,\n  level = 'error',\n  title,\n}: BasicErrorAlertProps) {\n  const theme = useTheme();\n  const iconColor = theme.colors[level].base;\n\n  return (\n    <StyledContainer level={level} role=\"alert\">\n      {level === 'error' ? (\n        <Icons.ErrorSolid iconColor={iconColor} />\n      ) : (\n        <Icons.WarningSolid iconColor={iconColor} />\n      )}\n      <StyledContent>\n        <StyledTitle>{title}</StyledTitle>\n        <p>{body}</p>\n      </StyledContent>\n    </StyledContainer>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const cacheWrapper =\n  <T extends Array<any>, U>(\n    fn: (...args: T) => U,\n    cache: Map<string, any>,\n    keyFn: (...args: T) => string = (...args: T) => JSON.stringify([...args]),\n  ) =>\n  (...args: T): U => {\n    const key = keyFn(...args);\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    const result = fn(...args);\n    cache.set(key, result);\n    return result;\n  };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { ReactNode, useEffect, useState } from 'react';\nimport { styled } from '@superset-ui/core';\nimport { AntdCheckbox } from 'src/components';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\n\ninterface CollapsibleControlProps {\n  initialValue?: boolean;\n  disabled?: boolean;\n  checked?: boolean;\n  title: string;\n  tooltip?: string;\n  children: ReactNode;\n  onChange?: (checked: boolean) => void;\n}\n\nconst StyledContainer = styled.div<{ checked: boolean }>`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  min-height: ${({ theme }) => theme.gridUnit * 10}px;\n  padding-top: ${({ theme }) => theme.gridUnit * 2 + 2}px;\n\n  .checkbox {\n    margin-bottom: ${({ theme, checked }) => (checked ? theme.gridUnit : 0)}px;\n  }\n\n  & > div {\n    margin-bottom: ${({ theme }) => theme.gridUnit * 2}px;\n  }\n`;\n\nconst ChildrenContainer = styled.div`\n  margin-left: ${({ theme }) => theme.gridUnit * 6}px;\n`;\n\nconst CollapsibleControl = (props: CollapsibleControlProps) => {\n  const {\n    checked,\n    disabled,\n    title,\n    tooltip,\n    children,\n    onChange = () => {},\n    initialValue = false,\n  } = props;\n  const [isChecked, setIsChecked] = useState(initialValue);\n\n  useEffect(() => {\n    // if external `checked` changed to `undefined`, it means that we work now in uncontrolled mode with local state\n    // and we need ignore external value\n    if (checked !== undefined) {\n      setIsChecked(checked);\n    }\n  }, [checked]);\n\n  return (\n    <StyledContainer checked={isChecked}>\n      <AntdCheckbox\n        className=\"checkbox\"\n        checked={isChecked}\n        disabled={disabled}\n        onChange={e => {\n          const value = e.target.checked;\n          // external `checked` value has more priority then local state\n          if (checked === undefined) {\n            // uncontrolled mode\n            setIsChecked(value);\n          }\n          onChange(value);\n        }}\n      >\n        <>\n          {title}&nbsp;\n          {tooltip && (\n            <InfoTooltipWithTrigger placement=\"top\" tooltip={tooltip} />\n          )}\n        </>\n      </AntdCheckbox>\n      {isChecked && <ChildrenContainer>{children}</ChildrenContainer>}\n    </StyledContainer>\n  );\n};\n\nexport { CollapsibleControl, CollapsibleControlProps };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useState, useMemo, useEffect } from 'react';\nimport { Column, ensureIsArray, SupersetClient, t } from '@superset-ui/core';\nimport { useChangeEffect } from 'src/hooks/useChangeEffect';\nimport { Select, FormInstance } from 'src/components';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { cacheWrapper } from 'src/utils/cacheWrapper';\nimport { NativeFiltersForm } from '../types';\nimport { doesColumnMatchFilterType } from './utils';\n\ninterface ColumnSelectProps {\n  allowClear?: boolean;\n  filterValues?: (column: Column) => boolean;\n  form: FormInstance<NativeFiltersForm>;\n  formField?: string;\n  filterId: string;\n  datasetId?: number;\n  value?: string | string[];\n  onChange?: (value: string) => void;\n  mode?: 'multiple';\n}\n\nconst localCache = new Map<string, any>();\n\nconst cachedSupersetGet = cacheWrapper(\n  SupersetClient.get,\n  localCache,\n  ({ endpoint }) => endpoint || '',\n);\n\n/** Special purpose AsyncSelect that selects a column from a dataset */\n// eslint-disable-next-line import/prefer-default-export\nexport function ColumnSelect({\n  allowClear = false,\n  filterValues = () => true,\n  form,\n  formField = 'column',\n  filterId,\n  datasetId,\n  value,\n  onChange,\n  mode,\n}: ColumnSelectProps) {\n  const [columns, setColumns] = useState<Column[]>();\n  const { addDangerToast } = useToasts();\n  const resetColumnField = useCallback(() => {\n    form.setFields([\n      { name: ['filters', filterId, formField], touched: false, value: null },\n    ]);\n  }, [form, filterId, formField]);\n\n  const options = useMemo(\n    () =>\n      ensureIsArray(columns)\n        .filter(filterValues)\n        .map((col: Column) => col.column_name)\n        .map((column: string) => ({ label: column, value: column })),\n    [columns, filterValues],\n  );\n\n  const currentFilterType =\n    form.getFieldValue('filters')?.[filterId].filterType;\n  const currentColumn = useMemo(\n    () => columns?.find(column => column.column_name === value),\n    [columns, value],\n  );\n\n  useEffect(() => {\n    if (\n      currentColumn &&\n      !doesColumnMatchFilterType(currentFilterType, currentColumn)\n    ) {\n      resetColumnField();\n    }\n  }, [currentColumn, currentFilterType, resetColumnField]);\n\n  useChangeEffect(datasetId, previous => {\n    if (previous != null) {\n      resetColumnField();\n    }\n    if (datasetId != null) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      }).then(\n        ({ json: { result } }) => {\n          const lookupValue = Array.isArray(value) ? value : [value];\n          const valueExists = result.columns.some((column: Column) =>\n            lookupValue?.includes(column.column_name),\n          );\n          if (!valueExists) {\n            resetColumnField();\n          }\n          setColumns(result.columns);\n        },\n        async badResponse => {\n          const { error, message } = await getClientErrorObject(badResponse);\n          let errorText = message || error || t('An error has occurred');\n          if (message === 'Forbidden') {\n            errorText = t('You do not have permission to edit this dashboard');\n          }\n          addDangerToast(errorText);\n        },\n      );\n    }\n  });\n\n  return (\n    <Select\n      mode={mode}\n      value={mode === 'multiple' ? value || [] : value}\n      ariaLabel={t('Column select')}\n      onChange={onChange}\n      options={options}\n      placeholder={t('Select a column')}\n      notFoundContent={t('No compatible columns found')}\n      showSearch\n      allowClear={allowClear}\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo } from 'react';\nimport rison from 'rison';\nimport { t, SupersetClient } from '@superset-ui/core';\nimport { Select } from 'src/components';\nimport { cacheWrapper } from 'src/utils/cacheWrapper';\nimport {\n  ClientErrorObject,\n  getClientErrorObject,\n} from 'src/utils/getClientErrorObject';\nimport { datasetToSelectOption } from './utils';\n\nconst localCache = new Map<string, any>();\n\nconst cachedSupersetGet = cacheWrapper(\n  SupersetClient.get,\n  localCache,\n  ({ endpoint }) => endpoint || '',\n);\n\ninterface DatasetSelectProps {\n  onChange: (value: { label: string; value: number }) => void;\n  value?: { label: string; value: number };\n}\n\nconst DatasetSelect = ({ onChange, value }: DatasetSelectProps) => {\n  const getErrorMessage = useCallback(\n    ({ error, message }: ClientErrorObject) => {\n      let errorText = message || error || t('An error has occurred');\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n      return errorText;\n    },\n    [],\n  );\n\n  const loadDatasetOptions = async (\n    search: string,\n    page: number,\n    pageSize: number,\n  ) => {\n    const searchColumn = 'table_name';\n    const query = rison.encode({\n      filters: [{ col: searchColumn, opr: 'ct', value: search }],\n      page,\n      page_size: pageSize,\n      order_column: searchColumn,\n      order_direction: 'asc',\n    });\n    return cachedSupersetGet({\n      endpoint: `/api/v1/dataset/?q=${query}`,\n    })\n      .then(response => {\n        const data: {\n          label: string;\n          value: string | number;\n        }[] = response.json.result.map(datasetToSelectOption);\n        return {\n          data,\n          totalCount: response.json.count,\n        };\n      })\n      .catch(async error => {\n        const errorMessage = getErrorMessage(await getClientErrorObject(error));\n        throw new Error(errorMessage);\n      });\n  };\n\n  return (\n    <Select\n      ariaLabel={t('Dataset')}\n      value={value}\n      options={loadDatasetOptions}\n      onChange={onChange}\n    />\n  );\n};\n\nconst MemoizedSelect = (props: DatasetSelectProps) =>\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useMemo(() => <DatasetSelect {...props} />, []);\n\nexport default MemoizedSelect;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC } from 'react';\nimport {\n  Behavior,\n  SetDataMaskHook,\n  SuperChart,\n  AppSection,\n  t,\n} from '@superset-ui/core';\nimport { FormInstance } from 'src/components';\nimport Loading from 'src/components/Loading';\nimport { NativeFiltersForm } from '../types';\nimport { getFormData } from '../../utils';\n\ntype DefaultValueProps = {\n  hasDefaultValue: boolean;\n  filterId: string;\n  setDataMask: SetDataMaskHook;\n  hasDataset: boolean;\n  form: FormInstance<NativeFiltersForm>;\n  formData: ReturnType<typeof getFormData>;\n  enableNoResults: boolean;\n};\n\nconst DefaultValue: FC<DefaultValueProps> = ({\n  hasDefaultValue,\n  filterId,\n  hasDataset,\n  form,\n  setDataMask,\n  formData,\n  enableNoResults,\n}) => {\n  const formFilter = (form.getFieldValue('filters') || {})[filterId];\n  const queriesData = formFilter?.defaultValueQueriesData;\n  const loading = hasDataset && queriesData === null;\n  const value = formFilter.defaultDataMask?.filterState?.value;\n  const isMissingRequiredValue =\n    hasDefaultValue && (value === null || value === undefined);\n  return loading ? (\n    <Loading position=\"inline-centered\" />\n  ) : (\n    <SuperChart\n      height={32}\n      width={formFilter?.filterType === 'filter_time' ? 350 : 250}\n      appSection={AppSection.FILTER_CONFIG_MODAL}\n      behaviors={[Behavior.NATIVE_FILTER]}\n      formData={formData}\n      // For charts that don't have datasource we need workaround for empty placeholder\n      queriesData={\n        hasDataset ? formFilter?.defaultValueQueriesData : [{ data: [{}] }]\n      }\n      chartType={formFilter?.filterType}\n      hooks={{ setDataMask }}\n      enableNoResults={enableNoResults}\n      filterState={{\n        ...formFilter.defaultDataMask?.filterState,\n        validateMessage: isMissingRequiredValue && t('Value is required'),\n        validateStatus: isMissingRequiredValue && 'error',\n      }}\n    />\n  );\n};\n\nexport default DefaultValue;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CustomControlItem,\n  InfoTooltipWithTrigger,\n} from '@superset-ui/chart-controls';\nimport React from 'react';\nimport { AntdCheckbox, FormInstance } from 'src/components';\nimport {\n  Filter,\n  getChartControlPanelRegistry,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { FormItem } from 'src/components/Form';\nimport {\n  doesColumnMatchFilterType,\n  getControlItems,\n  setNativeFilterFieldValues,\n} from './utils';\nimport { NativeFiltersForm, NativeFiltersFormItem } from '../types';\nimport {\n  StyledFormItem,\n  StyledLabel,\n  StyledRowFormItem,\n} from './FiltersConfigForm';\nimport { ColumnSelect } from './ColumnSelect';\n\nexport interface ControlItemsProps {\n  datasetId: number;\n  disabled: boolean;\n  forceUpdate: Function;\n  form: FormInstance<NativeFiltersForm>;\n  filterId: string;\n  filterType: string;\n  filterToEdit?: Filter;\n  formFilter?: NativeFiltersFormItem;\n  removed?: boolean;\n}\n\nconst CleanFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\n\nexport default function getControlItemsMap({\n  datasetId,\n  disabled,\n  forceUpdate,\n  form,\n  filterId,\n  filterType,\n  filterToEdit,\n  formFilter,\n  removed,\n}: ControlItemsProps) {\n  const controlPanelRegistry = getChartControlPanelRegistry();\n  const controlItems =\n    getControlItems(controlPanelRegistry.get(filterType)) ?? [];\n  const mapControlItems: Record<\n    string,\n    { element: React.ReactNode; checked: boolean }\n  > = {};\n  const mapMainControlItems: Record<\n    string,\n    { element: React.ReactNode; checked: boolean }\n  > = {};\n\n  controlItems\n    .filter(\n      (mainControlItem: CustomControlItem) =>\n        mainControlItem?.name === 'groupby',\n    )\n    .forEach(mainControlItem => {\n      const initialValue =\n        filterToEdit?.controlValues?.[mainControlItem.name] ??\n        mainControlItem?.config?.default;\n      const initColumn = filterToEdit?.targets[0]?.column?.name;\n\n      const element = (\n        <>\n          <CleanFormItem\n            name={['filters', filterId, 'requiredFirst', mainControlItem.name]}\n            hidden\n            initialValue={\n              mainControlItem?.config?.requiredFirst &&\n              filterToEdit?.requiredFirst\n            }\n          />\n          <StyledFormItem\n            // don't show the column select unless we have a dataset\n            name={['filters', filterId, 'column']}\n            initialValue={initColumn}\n            label={\n              <StyledLabel>\n                {mainControlItem.config?.label || t('Column')}\n              </StyledLabel>\n            }\n            rules={[\n              {\n                required: mainControlItem.config?.required && !removed, // TODO: need to move ColumnSelect settings to controlPanel for all filters\n                message: t('Column is required'),\n              },\n            ]}\n            data-test=\"field-input\"\n          >\n            <ColumnSelect\n              mode={mainControlItem.config?.multiple && 'multiple'}\n              form={form}\n              filterId={filterId}\n              datasetId={datasetId}\n              filterValues={column =>\n                doesColumnMatchFilterType(formFilter?.filterType || '', column)\n              }\n              onChange={() => {\n                // We need reset default value when when column changed\n                setNativeFilterFieldValues(form, filterId, {\n                  defaultDataMask: null,\n                });\n                forceUpdate();\n              }}\n            />\n          </StyledFormItem>\n        </>\n      );\n      mapMainControlItems[mainControlItem.name] = {\n        element,\n        checked: initialValue,\n      };\n    });\n  controlItems\n    .filter(\n      (controlItem: CustomControlItem) =>\n        controlItem?.config?.renderTrigger &&\n        controlItem.name !== 'sortAscending' &&\n        controlItem.name !== 'enableSingleValue',\n    )\n    .forEach(controlItem => {\n      const initialValue =\n        filterToEdit?.controlValues?.[controlItem.name] ??\n        controlItem?.config?.default;\n      const element = (\n        <>\n          <CleanFormItem\n            name={['filters', filterId, 'requiredFirst', controlItem.name]}\n            hidden\n            initialValue={\n              controlItem?.config?.requiredFirst && filterToEdit?.requiredFirst\n            }\n          />\n          <Tooltip\n            key={controlItem.name}\n            placement=\"left\"\n            title={\n              controlItem.config.affectsDataMask &&\n              disabled &&\n              t('Populate \"Default value\" to enable this control')\n            }\n          >\n            <StyledRowFormItem\n              key={controlItem.name}\n              name={['filters', filterId, 'controlValues', controlItem.name]}\n              initialValue={initialValue}\n              valuePropName=\"checked\"\n              colon={false}\n            >\n              <AntdCheckbox\n                disabled={controlItem.config.affectsDataMask && disabled}\n                onChange={({ target: { checked } }) => {\n                  if (controlItem.config.requiredFirst) {\n                    setNativeFilterFieldValues(form, filterId, {\n                      requiredFirst: {\n                        ...formFilter?.requiredFirst,\n                        [controlItem.name]: checked,\n                      },\n                    });\n                  }\n                  if (controlItem.config.resetConfig) {\n                    setNativeFilterFieldValues(form, filterId, {\n                      defaultDataMask: null,\n                    });\n                  }\n                  forceUpdate();\n                }}\n              >\n                {controlItem.config.label}&nbsp;\n                {controlItem.config.description && (\n                  <InfoTooltipWithTrigger\n                    placement=\"top\"\n                    label={controlItem.config.name}\n                    tooltip={controlItem.config.description}\n                  />\n                )}\n              </AntdCheckbox>\n            </StyledRowFormItem>\n          </Tooltip>\n        </>\n      );\n      mapControlItems[controlItem.name] = { element, checked: initialValue };\n    });\n  return {\n    controlItems: mapControlItems,\n    mainControlItems: mapMainControlItems,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport Button, { OnClickHandler } from 'src/components/Button';\nimport React, { FC } from 'react';\nimport { styled, t } from '@superset-ui/core';\n\nconst RemovedContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 400px; // arbitrary\n  text-align: center;\n  justify-content: center;\n  align-items: center;\n  color: ${({ theme }) => theme.colors.grayscale.base};\n`;\n\ntype RemovedFilterProps = {\n  onClick: OnClickHandler;\n};\n\nconst RemovedFilter: FC<RemovedFilterProps> = ({ onClick }) => (\n  <RemovedContent>\n    <p>{t('You have removed this filter.')}</p>\n    <div>\n      <Button\n        data-test=\"restore-filter-button\"\n        buttonStyle=\"primary\"\n        onClick={onClick}\n      >\n        {t('Restore Filter')}\n      </Button>\n    </div>\n  </RemovedContent>\n);\n\nexport default RemovedFilter;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { styled, t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Select } from 'src/components';\nimport { CollapsibleControl } from './CollapsibleControl';\n\ninterface DependencyListProps {\n  availableFilters: { label: string; value: string }[];\n  dependencies: string[];\n  onDependenciesChange: (dependencies: string[]) => void;\n  getDependencySuggestion: () => string;\n}\n\nconst MainPanel = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst AddFilter = styled.div`\n  ${({ theme }) => `\n    display: inline-flex;\n    flex-direction: row;\n    align-items: center;\n    cursor: pointer;\n    color: ${theme.colors.primary.base};\n    &:hover {\n      color: ${theme.colors.primary.dark1};\n    }\n  `}\n`;\n\nconst DeleteFilter = styled(Icons.Trash)`\n  ${({ theme }) => `\n    cursor: pointer;\n    margin-left: ${theme.gridUnit * 2}px;\n    color: ${theme.colors.grayscale.base};\n    &:hover {\n      color: ${theme.colors.grayscale.dark1};\n    }\n  `}\n`;\n\nconst RowPanel = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    width: 220px;\n    flex-direction: row;\n    align-items: center;\n    margin-bottom: ${theme.gridUnit}px;\n  `}\n`;\n\nconst Label = styled.div`\n  text-transform: uppercase;\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  color: ${({ theme }) => theme.colors.grayscale.base};\n  margin-bottom: ${({ theme }) => theme.gridUnit}px;\n`;\n\nconst Row = ({\n  availableFilters,\n  selection,\n  onChange,\n  onDelete,\n}: {\n  availableFilters: { label: string; value: string }[];\n  selection: string;\n  onChange: (id: string, value: string) => void;\n  onDelete: (id: string) => void;\n}) => {\n  let value = availableFilters.find(e => e.value === selection);\n  let options = availableFilters;\n  if (!value) {\n    value = { label: t('(deleted or invalid type)'), value: selection };\n    options = [value, ...options];\n  }\n  return (\n    <RowPanel>\n      <Select\n        ariaLabel={t('Limit type')}\n        labelInValue\n        options={options}\n        onChange={option =>\n          onChange(selection, (option as { value: string }).value)\n        }\n        value={value}\n      />\n      <DeleteFilter iconSize=\"xl\" onClick={() => onDelete(selection)} />\n    </RowPanel>\n  );\n};\n\nconst List = ({\n  availableFilters = [],\n  dependencies = [],\n  onDependenciesChange,\n}: DependencyListProps) => {\n  const [rows, setRows] = useState<string[]>(dependencies);\n\n  const updateRows = (newRows: string[]) => {\n    setRows(newRows);\n    onDependenciesChange(newRows);\n  };\n\n  const onAdd = () => {\n    const filter = availableFilters.find(\n      availableFilter => !rows.includes(availableFilter.value),\n    );\n    if (filter) {\n      const newRows = [...rows];\n      newRows.push(filter.value);\n      updateRows(newRows);\n    }\n  };\n\n  const onChange = (id: string, value: string) => {\n    const indexOf = rows.findIndex(row => row === id);\n    const newRows = [...rows];\n    newRows[indexOf] = value;\n    updateRows(newRows);\n  };\n\n  const onDelete = (id: string) => {\n    const newRows = [...rows];\n    newRows.splice(rows.indexOf(id), 1);\n    updateRows(newRows);\n  };\n\n  if (availableFilters.length === 0) {\n    return <span>{t('No available filters.')}</span>;\n  }\n\n  return (\n    <>\n      {rows.map(row => (\n        <Row\n          key={row}\n          selection={row}\n          availableFilters={availableFilters.filter(\n            e => e.value === row || !rows.includes(e.value),\n          )}\n          onChange={onChange}\n          onDelete={onDelete}\n        />\n      ))}\n      {availableFilters.length > rows.length && (\n        <AddFilter onClick={onAdd}>\n          <Icons.PlusSmall />\n          {t('Add filter')}\n        </AddFilter>\n      )}\n    </>\n  );\n};\n\nconst DependencyList = ({\n  availableFilters = [],\n  dependencies = [],\n  onDependenciesChange,\n  getDependencySuggestion,\n}: DependencyListProps) => {\n  const hasAvailableFilters = availableFilters.length > 0;\n  const hasDependencies = dependencies.length > 0;\n\n  const onCheckChanged = (value: boolean) => {\n    const newDependencies: string[] = [];\n    if (value && !hasDependencies && hasAvailableFilters) {\n      newDependencies.push(getDependencySuggestion());\n    }\n    onDependenciesChange(newDependencies);\n  };\n\n  return (\n    <MainPanel>\n      <CollapsibleControl\n        title={t('Values are dependent on other filters')}\n        initialValue={hasDependencies}\n        onChange={onCheckChanged}\n        tooltip={t(\n          'Values selected in other filters will affect the filter options to only show relevant values',\n        )}\n      >\n        {hasDependencies && <Label>{t('Values dependent on')}</Label>}\n        <List\n          availableFilters={availableFilters}\n          dependencies={dependencies}\n          onDependenciesChange={onDependenciesChange}\n          getDependencySuggestion={getDependencySuggestion}\n        />\n      </CollapsibleControl>\n    </MainPanel>\n  );\n};\n\nexport default DependencyList;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable react-hooks/rules-of-hooks */\nimport {\n  ColumnMeta,\n  InfoTooltipWithTrigger,\n  Metric,\n} from '@superset-ui/chart-controls';\nimport {\n  AdhocFilter,\n  Behavior,\n  ChartDataResponseResult,\n  Column,\n  Filter,\n  GenericDataType,\n  getChartMetadataRegistry,\n  JsonResponse,\n  NativeFilterType,\n  styled,\n  SupersetApiError,\n  SupersetClient,\n  t,\n} from '@superset-ui/core';\nimport { isEqual } from 'lodash';\nimport React, {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useState,\n} from 'react';\nimport { PluginFilterSelectCustomizeProps } from 'src/filters/components/Select/types';\nimport { useSelector } from 'react-redux';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport { Input, TextArea } from 'src/components/Input';\nimport { Select, FormInstance } from 'src/components';\nimport Collapse from 'src/components/Collapse';\nimport BasicErrorAlert from 'src/components/ErrorMessage/BasicErrorAlert';\nimport { FormItem } from 'src/components/Form';\nimport Icons from 'src/components/Icons';\nimport Loading from 'src/components/Loading';\nimport { addDangerToast } from 'src/components/MessageToasts/actions';\nimport { Radio } from 'src/components/Radio';\nimport Tabs from 'src/components/Tabs';\nimport { Tooltip } from 'src/components/Tooltip';\nimport {\n  Chart,\n  ChartsState,\n  DatasourcesState,\n  RootState,\n} from 'src/dashboard/types';\nimport DateFilterControl from 'src/explore/components/controls/DateFilterControl';\nimport AdhocFilterControl from 'src/explore/components/controls/FilterControl/AdhocFilterControl';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { waitForAsyncData } from 'src/middleware/asyncEvent';\nimport { cacheWrapper } from 'src/utils/cacheWrapper';\nimport { ClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { SingleValueType } from 'src/filters/components/Range/SingleValueType';\nimport {\n  getFormData,\n  mergeExtraFormData,\n} from 'src/dashboard/components/nativeFilters/utils';\nimport {\n  ALLOW_DEPENDENCIES as TYPES_SUPPORT_DEPENDENCIES,\n  getFiltersConfigModalTestId,\n} from '../FiltersConfigModal';\nimport { FilterRemoval, NativeFiltersForm } from '../types';\nimport { CollapsibleControl } from './CollapsibleControl';\nimport { ColumnSelect } from './ColumnSelect';\nimport DatasetSelect from './DatasetSelect';\nimport DefaultValue from './DefaultValue';\nimport FilterScope from './FilterScope/FilterScope';\nimport getControlItemsMap from './getControlItemsMap';\nimport RemovedFilter from './RemovedFilter';\nimport { useBackendFormUpdate, useDefaultValue } from './state';\nimport {\n  FILTER_SUPPORTED_TYPES,\n  hasTemporalColumns,\n  mostUsedDataset,\n  setNativeFilterFieldValues,\n  useForceUpdate,\n} from './utils';\nimport DependencyList from './DependencyList';\n\nconst TabPane = styled(Tabs.TabPane)`\n  padding: ${({ theme }) => theme.gridUnit * 4}px 0px;\n`;\n\nconst StyledContainer = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    flex-direction: row-reverse;\n    justify-content: space-between;\n    padding: 0px ${theme.gridUnit * 4}px;\n  `}\n`;\n\nconst StyledRowContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  width: 100%;\n  padding: 0px ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\ntype ControlKey = keyof PluginFilterSelectCustomizeProps;\n\nconst controlsOrder: ControlKey[] = [\n  'enableEmptyFilter',\n  'defaultToFirstItem',\n  'multiSelect',\n  'searchAllOptions',\n  'inverseSelection',\n];\n\nexport const StyledFormItem = styled(FormItem)`\n  width: 49%;\n  margin-bottom: ${({ theme }) => theme.gridUnit * 4}px;\n\n  & .ant-form-item-label {\n    padding-bottom: 0;\n  }\n\n  & .ant-form-item-control-input {\n    min-height: ${({ theme }) => theme.gridUnit * 10}px;\n  }\n`;\n\nexport const StyledRowFormItem = styled(FormItem)`\n  margin-bottom: 0;\n  padding-bottom: 0;\n  min-width: 50%;\n\n  & .ant-form-item-label {\n    padding-bottom: 0;\n  }\n\n  .ant-form-item-control-input-content > div > div {\n    height: auto;\n  }\n\n  & .ant-form-item-control-input {\n    min-height: ${({ theme }) => theme.gridUnit * 10}px;\n  }\n`;\n\nexport const StyledRowSubFormItem = styled(FormItem)`\n  min-width: 50%;\n\n  & .ant-form-item-label {\n    padding-bottom: 0;\n  }\n\n  .ant-form-item {\n    margin-bottom: 0;\n  }\n\n  .ant-form-item-control-input-content > div > div {\n    height: auto;\n  }\n\n  .ant-form-item-extra {\n    display: none;\n  }\n\n  & .ant-form-item-control-input {\n    height: auto;\n  }\n`;\n\nexport const StyledLabel = styled.span`\n  color: ${({ theme }) => theme.colors.grayscale.base};\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  text-transform: uppercase;\n`;\n\nconst CleanFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\n\nconst DefaultValueContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst RefreshIcon = styled(Icons.Refresh)`\n  margin-left: ${({ theme }) => theme.gridUnit * 2}px;\n  color: ${({ theme }) => theme.colors.primary.base};\n`;\n\nconst StyledCollapse = styled(Collapse)`\n  border-left: 0;\n  border-top: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  border-radius: 0;\n\n  .ant-collapse-header {\n    border-bottom: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n    border-top: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n    margin-top: -1px;\n    border-radius: 0;\n  }\n\n  .ant-collapse-content {\n    border: 0;\n  }\n\n  .ant-collapse-content-box {\n    padding-top: ${({ theme }) => theme.gridUnit * 2}px;\n  }\n\n  &.ant-collapse > .ant-collapse-item {\n    border: 0;\n    border-radius: 0;\n  }\n`;\n\nconst StyledTabs = styled(Tabs)`\n  .ant-tabs-nav {\n    position: sticky;\n    top: 0;\n    background: ${({ theme }) => theme.colors.grayscale.light5};\n    z-index: 1;\n  }\n\n  .ant-tabs-nav-list {\n    padding: 0;\n  }\n\n  .ant-form-item-label {\n    padding-bottom: 0;\n  }\n`;\n\nconst StyledAsterisk = styled.span`\n  color: ${({ theme }) => theme.colors.error.base};\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  margin-left: ${({ theme }) => theme.gridUnit - 1}px;\n  &:before {\n    content: '*';\n  }\n`;\n\nconst FilterTabs = {\n  configuration: {\n    key: 'configuration',\n    name: t('Settings'),\n  },\n  scoping: {\n    key: 'scoping',\n    name: t('Scoping'),\n  },\n};\n\nexport const FilterPanels = {\n  configuration: {\n    key: 'configuration',\n    name: t('Filter Configuration'),\n  },\n  settings: {\n    key: 'settings',\n    name: t('Filter Settings'),\n  },\n};\n\nexport interface FiltersConfigFormProps {\n  filterId: string;\n  filterToEdit?: Filter;\n  removedFilters: Record<string, FilterRemoval>;\n  restoreFilter: (filterId: string) => void;\n  form: FormInstance<NativeFiltersForm>;\n  getAvailableFilters: (filterId: string) => { label: string; value: string }[];\n  handleActiveFilterPanelChange: (activeFilterPanel: string | string[]) => void;\n  activeFilterPanelKeys: string | string[];\n  isActive: boolean;\n  setErroredFilters: (f: (filters: string[]) => string[]) => void;\n  validateDependencies: () => void;\n  getDependencySuggestion: (filterId: string) => string;\n}\n\nconst FILTERS_WITH_ADHOC_FILTERS = ['filter_select', 'filter_range'];\n\n// TODO: Rename the filter plugins and remove this mapping\nconst FILTER_TYPE_NAME_MAPPING = {\n  [t('Select filter')]: t('Value'),\n  [t('Range filter')]: t('Numerical range'),\n  [t('Time filter')]: t('Time range'),\n  [t('Time column')]: t('Time column'),\n  [t('Time grain')]: t('Time grain'),\n  [t('Group By')]: t('Group by'),\n};\n\nconst localCache = new Map<string, any>();\n\nconst cachedSupersetGet = cacheWrapper(\n  SupersetClient.get,\n  localCache,\n  ({ endpoint }) => endpoint || '',\n);\n\n/**\n * The configuration form for a specific filter.\n * Assigns field values to `filters[filterId]` in the form.\n */\nconst FiltersConfigForm = (\n  {\n    filterId,\n    filterToEdit,\n    removedFilters,\n    form,\n    getAvailableFilters,\n    activeFilterPanelKeys,\n    restoreFilter,\n    handleActiveFilterPanelChange,\n    setErroredFilters,\n    validateDependencies,\n    getDependencySuggestion,\n  }: FiltersConfigFormProps,\n  ref: React.RefObject<any>,\n) => {\n  const isRemoved = !!removedFilters[filterId];\n  const [error, setError] = useState<string>('');\n  const [metrics, setMetrics] = useState<Metric[]>([]);\n  const [activeTabKey, setActiveTabKey] = useState<string>(\n    FilterTabs.configuration.key,\n  );\n\n  const [undoFormValues, setUndoFormValues] = useState<Record<\n    string,\n    any\n  > | null>(null);\n  const forceUpdate = useForceUpdate();\n  const [datasetDetails, setDatasetDetails] = useState<Record<string, any>>();\n  const defaultFormFilter = useMemo(() => ({}), []);\n  const filters = form.getFieldValue('filters');\n  const formValues = filters?.[filterId];\n  const formFilter = formValues || undoFormValues || defaultFormFilter;\n\n  const dependencies: string[] =\n    formFilter?.dependencies || filterToEdit?.cascadeParentIds;\n\n  const nativeFilterItems = getChartMetadataRegistry().items;\n  const nativeFilterVizTypes = Object.entries(nativeFilterItems)\n    // @ts-ignore\n    .filter(([, { value }]) =>\n      value.behaviors?.includes(Behavior.NATIVE_FILTER),\n    )\n    .map(([key]) => key);\n\n  const loadedDatasets = useSelector<RootState, DatasourcesState>(\n    ({ datasources }) => datasources,\n  );\n\n  const charts = useSelector<RootState, ChartsState>(({ charts }) => charts);\n\n  const doLoadedDatasetsHaveTemporalColumns = useMemo(\n    () =>\n      Object.values(loadedDatasets).some(dataset =>\n        hasTemporalColumns(dataset),\n      ),\n    [loadedDatasets],\n  );\n\n  const showTimeRangePicker = useMemo(() => {\n    const currentDataset = Object.values(loadedDatasets).find(\n      dataset => dataset.id === formFilter?.dataset?.value,\n    );\n\n    return currentDataset ? hasTemporalColumns(currentDataset) : true;\n  }, [formFilter?.dataset?.value, loadedDatasets]);\n\n  const hasDataset =\n    // @ts-ignore\n    !!nativeFilterItems[formFilter?.filterType]?.value?.datasourceCount;\n\n  const datasetId =\n    formFilter?.dataset?.value ??\n    filterToEdit?.targets[0]?.datasetId ??\n    mostUsedDataset(loadedDatasets, charts);\n\n  const { controlItems = {}, mainControlItems = {} } = formFilter\n    ? getControlItemsMap({\n        datasetId,\n        disabled: false,\n        forceUpdate,\n        form,\n        filterId,\n        filterType: formFilter?.filterType,\n        filterToEdit,\n        formFilter,\n        removed: isRemoved,\n      })\n    : {};\n  const hasColumn = !!mainControlItems.groupby;\n\n  const nativeFilterItem = nativeFilterItems[formFilter?.filterType] ?? {};\n  // @ts-ignore\n  const enableNoResults = !!nativeFilterItem.value?.enableNoResults;\n\n  const hasMetrics = hasColumn && !!metrics.length;\n\n  const hasFilledDataset =\n    !hasDataset || (datasetId && (formFilter?.column || !hasColumn));\n\n  const hasAdditionalFilters = FILTERS_WITH_ADHOC_FILTERS.includes(\n    formFilter?.filterType,\n  );\n\n  const canDependOnOtherFilters = TYPES_SUPPORT_DEPENDENCIES.includes(\n    formFilter?.filterType,\n  );\n\n  const isDataDirty = formFilter?.isDataDirty ?? true;\n\n  const setNativeFilterFieldValuesWrapper = (values: object) => {\n    setNativeFilterFieldValues(form, filterId, values);\n    setError('');\n    forceUpdate();\n  };\n\n  const setErrorWrapper = (error: string) => {\n    setNativeFilterFieldValues(form, filterId, {\n      defaultValueQueriesData: null,\n    });\n    setError(error);\n    forceUpdate();\n  };\n\n  // Calculates the dependencies default values to be used\n  // to extract the available values to the filter\n  let dependenciesDefaultValues = {};\n  if (dependencies && dependencies.length > 0 && filters) {\n    dependencies.forEach(dependency => {\n      const extraFormData = filters[dependency]?.defaultDataMask?.extraFormData;\n      dependenciesDefaultValues = mergeExtraFormData(\n        dependenciesDefaultValues,\n        extraFormData,\n      );\n    });\n  }\n\n  const dependenciesText = JSON.stringify(dependenciesDefaultValues);\n\n  const refreshHandler = useCallback(\n    (force = false) => {\n      if (!hasDataset || !formFilter?.dataset?.value) {\n        forceUpdate();\n        return;\n      }\n      const formData = getFormData({\n        datasetId: formFilter?.dataset?.value,\n        groupby: formFilter?.column,\n        ...formFilter,\n      });\n\n      formData.extra_form_data = dependenciesDefaultValues;\n\n      setNativeFilterFieldValuesWrapper({\n        defaultValueQueriesData: null,\n        isDataDirty: false,\n      });\n      getChartDataRequest({\n        formData,\n        force,\n        requestParams: { dashboardId: 0 },\n      })\n        .then(({ response, json }) => {\n          if (isFeatureEnabled(FeatureFlag.GLOBAL_ASYNC_QUERIES)) {\n            // deal with getChartDataRequest transforming the response data\n            const result = 'result' in json ? json.result[0] : json;\n\n            if (response.status === 200) {\n              setNativeFilterFieldValuesWrapper({\n                defaultValueQueriesData: [result],\n              });\n            } else if (response.status === 202) {\n              waitForAsyncData(result)\n                .then((asyncResult: ChartDataResponseResult[]) => {\n                  setNativeFilterFieldValuesWrapper({\n                    defaultValueQueriesData: asyncResult,\n                  });\n                })\n                .catch((error: ClientErrorObject) => {\n                  setError(\n                    error.message || error.error || t('Check configuration'),\n                  );\n                });\n            } else {\n              throw new Error(\n                `Received unexpected response status (${response.status}) while fetching chart data`,\n              );\n            }\n          } else {\n            setNativeFilterFieldValuesWrapper({\n              defaultValueQueriesData: json.result,\n            });\n          }\n        })\n        .catch((error: Response) => {\n          error.json().then(body => {\n            setErrorWrapper(\n              body.message || error.statusText || t('Check configuration'),\n            );\n          });\n        });\n    },\n    [filterId, forceUpdate, form, formFilter, hasDataset, dependenciesText],\n  );\n\n  // TODO: refreshHandler changes itself because of the dependencies. Needs refactor.\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => refreshHandler(), [dependenciesText]);\n\n  const newFormData = getFormData({\n    datasetId,\n    groupby: hasColumn ? formFilter?.column : undefined,\n    ...formFilter,\n  });\n  newFormData.extra_form_data = dependenciesDefaultValues;\n\n  const [hasDefaultValue, isRequired, defaultValueTooltip, setHasDefaultValue] =\n    useDefaultValue(formFilter, filterToEdit);\n\n  const showDataset =\n    !datasetId || datasetDetails || formFilter?.dataset?.label;\n\n  const formChanged = useCallback(() => {\n    form.setFields([\n      {\n        name: 'changed',\n        value: true,\n      },\n    ]);\n  }, [form]);\n\n  const updateFormValues = useCallback(\n    (values: any) => {\n      setNativeFilterFieldValues(form, filterId, values);\n      formChanged();\n    },\n    [filterId, form, formChanged],\n  );\n\n  const hasPreFilter =\n    !!formFilter?.adhoc_filters ||\n    !!formFilter?.time_range ||\n    !!filterToEdit?.adhoc_filters?.length ||\n    !!filterToEdit?.time_range;\n\n  const hasEnableSingleValue =\n    formFilter?.controlValues?.enableSingleValue !== undefined ||\n    filterToEdit?.controlValues?.enableSingleValue !== undefined;\n\n  let enableSingleValue = filterToEdit?.controlValues?.enableSingleValue;\n  if (formFilter?.controlValues?.enableSingleMaxValue !== undefined) {\n    ({ enableSingleValue } = formFilter.controlValues);\n  }\n\n  const hasSorting =\n    typeof formFilter?.controlValues?.sortAscending === 'boolean' ||\n    typeof filterToEdit?.controlValues?.sortAscending === 'boolean';\n\n  let sort = filterToEdit?.controlValues?.sortAscending;\n  if (typeof formFilter?.controlValues?.sortAscending === 'boolean') {\n    sort = formFilter.controlValues.sortAscending;\n  }\n\n  const showDefaultValue =\n    !hasDataset ||\n    (!isDataDirty && hasFilledDataset) ||\n    !mainControlItems.groupby;\n\n  const onSortChanged = (value: boolean | undefined) => {\n    const previous = form.getFieldValue('filters')?.[filterId].controlValues;\n    setNativeFilterFieldValues(form, filterId, {\n      controlValues: {\n        ...previous,\n        sortAscending: value,\n      },\n    });\n    forceUpdate();\n  };\n\n  const onEnableSingleValueChanged = (value: SingleValueType | undefined) => {\n    const previous = form.getFieldValue('filters')?.[filterId].controlValues;\n    setNativeFilterFieldValues(form, filterId, {\n      controlValues: {\n        ...previous,\n        enableSingleValue: value,\n      },\n    });\n    forceUpdate();\n  };\n\n  const validatePreFilter = () =>\n    setTimeout(\n      () =>\n        form.validateFields([\n          ['filters', filterId, 'adhoc_filters'],\n          ['filters', filterId, 'time_range'],\n        ]),\n      0,\n    );\n\n  const hasTimeRange =\n    formFilter?.time_range && formFilter.time_range !== 'No filter';\n\n  const hasAdhoc = formFilter?.adhoc_filters?.length > 0;\n\n  const defaultToFirstItem = formFilter?.controlValues?.defaultToFirstItem;\n\n  const initialDefaultValue =\n    formFilter?.filterType === filterToEdit?.filterType\n      ? filterToEdit?.defaultDataMask\n      : null;\n\n  const preFilterValidator = () => {\n    if (hasTimeRange || hasAdhoc) {\n      return Promise.resolve();\n    }\n    return Promise.reject(new Error(t('Pre-filter is required')));\n  };\n\n  const availableFilters = getAvailableFilters(filterId);\n  const hasAvailableFilters = availableFilters.length > 0;\n\n  useEffect(() => {\n    if (datasetId) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then((response: JsonResponse) => {\n          setMetrics(response.json?.result?.metrics);\n          const dataset = response.json?.result;\n          // modify the response to fit structure expected by AdhocFilterControl\n          dataset.type = dataset.datasource_type;\n          dataset.filter_select = true;\n          setDatasetDetails(dataset);\n        })\n        .catch((response: SupersetApiError) => {\n          addDangerToast(response.message);\n        });\n    }\n  }, [datasetId]);\n\n  useImperativeHandle(ref, () => ({\n    changeTab(tab: 'configuration' | 'scoping') {\n      setActiveTabKey(tab);\n    },\n  }));\n\n  useBackendFormUpdate(form, filterId);\n\n  useEffect(() => {\n    if (hasDataset && hasFilledDataset && hasDefaultValue && isDataDirty) {\n      refreshHandler();\n    }\n  }, [\n    hasDataset,\n    hasFilledDataset,\n    hasDefaultValue,\n    isDataDirty,\n    refreshHandler,\n    showDataset,\n  ]);\n\n  const initiallyExcludedCharts = useMemo(() => {\n    const excluded: number[] = [];\n    if (formFilter?.dataset?.value === undefined) {\n      return [];\n    }\n\n    Object.values(charts).forEach((chart: Chart) => {\n      const chartDatasetUid = chart.formData?.datasource;\n      if (chartDatasetUid === undefined) {\n        return;\n      }\n      if (loadedDatasets[chartDatasetUid]?.id !== formFilter?.dataset?.value) {\n        excluded.push(chart.id);\n      }\n    });\n    return excluded;\n  }, [\n    JSON.stringify(charts),\n    formFilter?.dataset?.value,\n    JSON.stringify(loadedDatasets),\n  ]);\n\n  useEffect(() => {\n    // just removed, saving current form items for eventual undo\n    if (isRemoved) {\n      setUndoFormValues(formValues);\n    }\n  }, [isRemoved]);\n\n  useEffect(() => {\n    // the filter was just restored after undo\n    if (undoFormValues && !isRemoved) {\n      setNativeFilterFieldValues(form, filterId, undoFormValues);\n      setUndoFormValues(null);\n    }\n  }, [formValues, filterId, form, isRemoved, undoFormValues]);\n\n  if (isRemoved) {\n    return <RemovedFilter onClick={() => restoreFilter(filterId)} />;\n  }\n\n  return (\n    <StyledTabs\n      activeKey={activeTabKey}\n      onChange={activeKey => setActiveTabKey(activeKey)}\n      centered\n    >\n      <TabPane\n        tab={FilterTabs.configuration.name}\n        key={FilterTabs.configuration.key}\n        forceRender\n      >\n        <StyledContainer>\n          <StyledFormItem\n            name={['filters', filterId, 'type']}\n            hidden\n            initialValue={NativeFilterType.NATIVE_FILTER}\n          >\n            <Input />\n          </StyledFormItem>\n          <StyledFormItem\n            name={['filters', filterId, 'name']}\n            label={<StyledLabel>{t('Filter name')}</StyledLabel>}\n            initialValue={filterToEdit?.name}\n            rules={[{ required: !isRemoved, message: t('Name is required') }]}\n          >\n            <Input {...getFiltersConfigModalTestId('name-input')} />\n          </StyledFormItem>\n          <StyledFormItem\n            name={['filters', filterId, 'filterType']}\n            rules={[{ required: !isRemoved, message: t('Name is required') }]}\n            initialValue={filterToEdit?.filterType || 'filter_select'}\n            label={<StyledLabel>{t('Filter Type')}</StyledLabel>}\n            {...getFiltersConfigModalTestId('filter-type')}\n          >\n            <Select\n              ariaLabel={t('Filter type')}\n              options={nativeFilterVizTypes.map(filterType => {\n                // @ts-ignore\n                const name = nativeFilterItems[filterType]?.value.name;\n                const mappedName = name\n                  ? FILTER_TYPE_NAME_MAPPING[name]\n                  : undefined;\n                const isDisabled =\n                  FILTER_SUPPORTED_TYPES[filterType]?.length === 1 &&\n                  FILTER_SUPPORTED_TYPES[filterType]?.includes(\n                    GenericDataType.TEMPORAL,\n                  ) &&\n                  !doLoadedDatasetsHaveTemporalColumns;\n                return {\n                  value: filterType,\n                  label: mappedName || name,\n                  customLabel: isDisabled ? (\n                    <Tooltip\n                      title={t('Datasets do not contain a temporal column')}\n                    >\n                      {mappedName || name}\n                    </Tooltip>\n                  ) : undefined,\n                  disabled: isDisabled,\n                };\n              })}\n              onChange={value => {\n                setNativeFilterFieldValues(form, filterId, {\n                  filterType: value,\n                  defaultDataMask: null,\n                  column: null,\n                });\n                forceUpdate();\n              }}\n            />\n          </StyledFormItem>\n        </StyledContainer>\n        {hasDataset && (\n          <StyledRowContainer>\n            {showDataset ? (\n              <StyledFormItem\n                name={['filters', filterId, 'dataset']}\n                label={<StyledLabel>{t('Dataset')}</StyledLabel>}\n                initialValue={\n                  datasetDetails\n                    ? {\n                        label: datasetDetails.table_name,\n                        value: datasetDetails.id,\n                      }\n                    : undefined\n                }\n                rules={[\n                  { required: !isRemoved, message: t('Dataset is required') },\n                ]}\n                {...getFiltersConfigModalTestId('datasource-input')}\n              >\n                <DatasetSelect\n                  onChange={(value: { label: string; value: number }) => {\n                    // We need to reset the column when the dataset has changed\n                    if (value.value !== datasetId) {\n                      setNativeFilterFieldValues(form, filterId, {\n                        dataset: value,\n                        defaultDataMask: null,\n                        column: null,\n                      });\n                    }\n                    forceUpdate();\n                  }}\n                />\n              </StyledFormItem>\n            ) : (\n              <StyledFormItem label={<StyledLabel>{t('Dataset')}</StyledLabel>}>\n                <Loading position=\"inline-centered\" />\n              </StyledFormItem>\n            )}\n            {hasDataset &&\n              Object.keys(mainControlItems).map(\n                key => mainControlItems[key].element,\n              )}\n          </StyledRowContainer>\n        )}\n        <StyledCollapse\n          activeKey={activeFilterPanelKeys}\n          onChange={key => {\n            handleActiveFilterPanelChange(key);\n          }}\n          expandIconPosition=\"right\"\n          key={`native-filter-config-${filterId}`}\n        >\n          {formFilter?.filterType !== 'filter_time' && (\n            <Collapse.Panel\n              forceRender\n              header={FilterPanels.configuration.name}\n              key={`${filterId}-${FilterPanels.configuration.key}`}\n            >\n              {canDependOnOtherFilters && hasAvailableFilters && (\n                <StyledRowFormItem\n                  name={['filters', filterId, 'dependencies']}\n                  initialValue={dependencies}\n                >\n                  <DependencyList\n                    availableFilters={availableFilters}\n                    dependencies={dependencies}\n                    onDependenciesChange={dependencies => {\n                      setNativeFilterFieldValues(form, filterId, {\n                        dependencies,\n                      });\n                      forceUpdate();\n                      validateDependencies();\n                      formChanged();\n                    }}\n                    getDependencySuggestion={() =>\n                      getDependencySuggestion(filterId)\n                    }\n                  />\n                </StyledRowFormItem>\n              )}\n              {hasDataset && hasAdditionalFilters && (\n                <CleanFormItem name={['filters', filterId, 'preFilter']}>\n                  <CollapsibleControl\n                    initialValue={hasPreFilter}\n                    title={t('Pre-filter available values')}\n                    onChange={checked => {\n                      formChanged();\n                      if (checked) {\n                        validatePreFilter();\n                      }\n                    }}\n                  >\n                    <StyledRowSubFormItem\n                      name={['filters', filterId, 'adhoc_filters']}\n                      initialValue={filterToEdit?.adhoc_filters}\n                      required\n                      rules={[\n                        {\n                          validator: preFilterValidator,\n                        },\n                      ]}\n                    >\n                      <AdhocFilterControl\n                        columns={\n                          datasetDetails?.columns?.filter(\n                            (c: ColumnMeta) => c.filterable,\n                          ) || []\n                        }\n                        savedMetrics={datasetDetails?.metrics || []}\n                        datasource={datasetDetails}\n                        onChange={(filters: AdhocFilter[]) => {\n                          setNativeFilterFieldValues(form, filterId, {\n                            adhoc_filters: filters,\n                          });\n                          forceUpdate();\n                          validatePreFilter();\n                        }}\n                        label={\n                          <span>\n                            <StyledLabel>{t('Pre-filter')}</StyledLabel>\n                            {!hasTimeRange && <StyledAsterisk />}\n                          </span>\n                        }\n                      />\n                    </StyledRowSubFormItem>\n                    {showTimeRangePicker && (\n                      <StyledRowFormItem\n                        name={['filters', filterId, 'time_range']}\n                        label={<StyledLabel>{t('Time range')}</StyledLabel>}\n                        initialValue={filterToEdit?.time_range || 'No filter'}\n                        required={!hasAdhoc}\n                        rules={[\n                          {\n                            validator: preFilterValidator,\n                          },\n                        ]}\n                      >\n                        <DateFilterControl\n                          name=\"time_range\"\n                          onChange={timeRange => {\n                            setNativeFilterFieldValues(form, filterId, {\n                              time_range: timeRange,\n                            });\n                            forceUpdate();\n                            validatePreFilter();\n                          }}\n                        />\n                      </StyledRowFormItem>\n                    )}\n                    {hasTimeRange && (\n                      <StyledRowFormItem\n                        name={['filters', filterId, 'granularity_sqla']}\n                        label={\n                          <>\n                            <StyledLabel>{t('Time column')}</StyledLabel>&nbsp;\n                            <InfoTooltipWithTrigger\n                              placement=\"top\"\n                              tooltip={t(\n                                'Optional time column if time range should apply to another column than the default time column',\n                              )}\n                            />\n                          </>\n                        }\n                        initialValue={filterToEdit?.granularity_sqla}\n                      >\n                        <ColumnSelect\n                          allowClear\n                          form={form}\n                          formField=\"granularity_sqla\"\n                          filterId={filterId}\n                          filterValues={(column: Column) => !!column.is_dttm}\n                          datasetId={datasetId}\n                          onChange={column => {\n                            // We need reset default value when when column changed\n                            setNativeFilterFieldValues(form, filterId, {\n                              granularity_sqla: column,\n                            });\n                            forceUpdate();\n                          }}\n                        />\n                      </StyledRowFormItem>\n                    )}\n                  </CollapsibleControl>\n                </CleanFormItem>\n              )}\n              {formFilter?.filterType !== 'filter_range' ? (\n                <CleanFormItem name={['filters', filterId, 'sortFilter']}>\n                  <CollapsibleControl\n                    initialValue={hasSorting}\n                    title={t('Sort filter values')}\n                    onChange={checked => {\n                      onSortChanged(checked || undefined);\n                      formChanged();\n                    }}\n                  >\n                    <StyledRowFormItem\n                      name={[\n                        'filters',\n                        filterId,\n                        'controlValues',\n                        'sortAscending',\n                      ]}\n                      initialValue={sort}\n                      label={<StyledLabel>{t('Sort type')}</StyledLabel>}\n                    >\n                      <Radio.Group\n                        onChange={value => {\n                          onSortChanged(value.target.value);\n                        }}\n                      >\n                        <Radio value>{t('Sort ascending')}</Radio>\n                        <Radio value={false}>{t('Sort descending')}</Radio>\n                      </Radio.Group>\n                    </StyledRowFormItem>\n                    {hasMetrics && (\n                      <StyledRowSubFormItem\n                        name={['filters', filterId, 'sortMetric']}\n                        initialValue={filterToEdit?.sortMetric}\n                        label={\n                          <>\n                            <StyledLabel>{t('Sort Metric')}</StyledLabel>&nbsp;\n                            <InfoTooltipWithTrigger\n                              placement=\"top\"\n                              tooltip={t(\n                                'If a metric is specified, sorting will be done based on the metric value',\n                              )}\n                            />\n                          </>\n                        }\n                        data-test=\"field-input\"\n                      >\n                        <Select\n                          allowClear\n                          ariaLabel={t('Sort metric')}\n                          name=\"sortMetric\"\n                          options={metrics.map((metric: Metric) => ({\n                            value: metric.metric_name,\n                            label: metric.verbose_name ?? metric.metric_name,\n                          }))}\n                          onChange={value => {\n                            if (value !== undefined) {\n                              setNativeFilterFieldValues(form, filterId, {\n                                sortMetric: value,\n                              });\n                              forceUpdate();\n                            }\n                          }}\n                        />\n                      </StyledRowSubFormItem>\n                    )}\n                  </CollapsibleControl>\n                </CleanFormItem>\n              ) : (\n                <CleanFormItem name={['filters', filterId, 'rangeFilter']}>\n                  <CollapsibleControl\n                    initialValue={hasEnableSingleValue}\n                    title={t('Single Value')}\n                    onChange={checked => {\n                      onEnableSingleValueChanged(\n                        checked ? SingleValueType.Exact : undefined,\n                      );\n                      formChanged();\n                    }}\n                  >\n                    <StyledRowFormItem\n                      name={[\n                        'filters',\n                        filterId,\n                        'controlValues',\n                        'enableSingleValue',\n                      ]}\n                      initialValue={enableSingleValue}\n                      label={\n                        <StyledLabel>{t('Single value type')}</StyledLabel>\n                      }\n                    >\n                      <Radio.Group\n                        onChange={value =>\n                          onEnableSingleValueChanged(value.target.value)\n                        }\n                      >\n                        <Radio value={SingleValueType.Minimum}>\n                          {t('Minimum')}\n                        </Radio>\n                        <Radio value={SingleValueType.Exact}>\n                          {t('Exact')}\n                        </Radio>\n                        <Radio value={SingleValueType.Maximum}>\n                          {t('Maximum')}\n                        </Radio>\n                      </Radio.Group>\n                    </StyledRowFormItem>\n                  </CollapsibleControl>\n                </CleanFormItem>\n              )}\n            </Collapse.Panel>\n          )}\n          <Collapse.Panel\n            forceRender\n            header={FilterPanels.settings.name}\n            key={`${filterId}-${FilterPanels.settings.key}`}\n          >\n            <StyledFormItem\n              name={['filters', filterId, 'description']}\n              initialValue={filterToEdit?.description}\n              label={<StyledLabel>{t('Description')}</StyledLabel>}\n            >\n              <TextArea />\n            </StyledFormItem>\n            <CleanFormItem\n              name={['filters', filterId, 'defaultValueQueriesData']}\n              hidden\n              initialValue={null}\n            />\n            <CleanFormItem name={['filters', filterId, 'defaultValue']}>\n              <CollapsibleControl\n                checked={hasDefaultValue}\n                disabled={isRequired || defaultToFirstItem}\n                initialValue={hasDefaultValue}\n                title={t('Filter has default value')}\n                tooltip={defaultValueTooltip}\n                onChange={value => {\n                  setHasDefaultValue(value);\n                  if (!value) {\n                    setNativeFilterFieldValues(form, filterId, {\n                      defaultDataMask: null,\n                    });\n                  }\n                  formChanged();\n                }}\n              >\n                {!isRemoved && (\n                  <StyledRowSubFormItem\n                    name={['filters', filterId, 'defaultDataMask']}\n                    initialValue={initialDefaultValue}\n                    data-test=\"default-input\"\n                    label={<StyledLabel>{t('Default Value')}</StyledLabel>}\n                    required={hasDefaultValue}\n                    rules={[\n                      {\n                        validator: () => {\n                          if (formFilter?.defaultDataMask?.filterState?.value) {\n                            // requires managing the error as the DefaultValue\n                            // component does not use an Antdesign compatible input\n                            const formValidationFields = form.getFieldsError();\n                            setErroredFilters(prevErroredFilters => {\n                              if (\n                                prevErroredFilters.length &&\n                                !formValidationFields.find(\n                                  f => f.errors.length > 0,\n                                )\n                              ) {\n                                return [];\n                              }\n                              return prevErroredFilters;\n                            });\n                            return Promise.resolve();\n                          }\n                          setErroredFilters(prevErroredFilters => {\n                            if (prevErroredFilters.includes(filterId)) {\n                              return prevErroredFilters;\n                            }\n                            return [...prevErroredFilters, filterId];\n                          });\n                          return Promise.reject(\n                            new Error(t('Default value is required')),\n                          );\n                        },\n                      },\n                    ]}\n                  >\n                    {error ? (\n                      <BasicErrorAlert\n                        title={t('Cannot load filter')}\n                        body={error}\n                        level=\"error\"\n                      />\n                    ) : showDefaultValue ? (\n                      <DefaultValueContainer>\n                        <DefaultValue\n                          setDataMask={dataMask => {\n                            if (\n                              !isEqual(\n                                initialDefaultValue?.filterState?.value,\n                                dataMask?.filterState?.value,\n                              )\n                            ) {\n                              formChanged();\n                            }\n                            setNativeFilterFieldValues(form, filterId, {\n                              defaultDataMask: dataMask,\n                            });\n                            form.validateFields([\n                              ['filters', filterId, 'defaultDataMask'],\n                            ]);\n                            forceUpdate();\n                          }}\n                          hasDefaultValue={hasDefaultValue}\n                          filterId={filterId}\n                          hasDataset={hasDataset}\n                          form={form}\n                          formData={newFormData}\n                          enableNoResults={enableNoResults}\n                        />\n                        {hasDataset && datasetId && (\n                          <Tooltip title={t('Refresh the default values')}>\n                            <RefreshIcon onClick={() => refreshHandler(true)} />\n                          </Tooltip>\n                        )}\n                      </DefaultValueContainer>\n                    ) : (\n                      t('Fill all required fields to enable \"Default Value\"')\n                    )}\n                  </StyledRowSubFormItem>\n                )}\n              </CollapsibleControl>\n            </CleanFormItem>\n            {Object.keys(controlItems)\n              .sort(\n                (a, b) =>\n                  controlsOrder.indexOf(a as ControlKey) -\n                  controlsOrder.indexOf(b as ControlKey),\n              )\n              .map(key => controlItems[key].element)}\n          </Collapse.Panel>\n        </StyledCollapse>\n      </TabPane>\n      <TabPane\n        tab={FilterTabs.scoping.name}\n        key={FilterTabs.scoping.key}\n        forceRender\n      >\n        <FilterScope\n          updateFormValues={updateFormValues}\n          pathToFormValue={['filters', filterId]}\n          forceUpdate={forceUpdate}\n          filterScope={filterToEdit?.scope}\n          formFilterScope={formFilter?.scope}\n          formScopingType={formFilter?.scoping}\n          initiallyExcludedCharts={initiallyExcludedCharts}\n        />\n      </TabPane>\n    </StyledTabs>\n  );\n};\n\nexport default forwardRef<typeof FiltersConfigForm, FiltersConfigFormProps>(\n  FiltersConfigForm,\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport { FormInstance } from 'src/components';\nimport { Filter, t } from '@superset-ui/core';\nimport { NativeFiltersForm, NativeFiltersFormItem } from '../types';\nimport { setNativeFilterFieldValues, useForceUpdate } from './utils';\n\n// When some fields in form changed we need re-fetch data for Filter defaultValue\n// eslint-disable-next-line import/prefer-default-export\nexport const useBackendFormUpdate = (\n  form: FormInstance<NativeFiltersForm>,\n  filterId: string,\n) => {\n  const forceUpdate = useForceUpdate();\n  const formFilter = (form.getFieldValue('filters') || {})[filterId];\n  useEffect(() => {\n    setNativeFilterFieldValues(form, filterId, {\n      isDataDirty: true,\n      defaultValueQueriesData: null,\n    });\n    forceUpdate();\n  }, [\n    form,\n    formFilter?.filterType,\n    formFilter?.column,\n    formFilter?.dataset?.value,\n    JSON.stringify(formFilter?.adhoc_filters),\n    formFilter?.time_range,\n    forceUpdate,\n    filterId,\n  ]);\n};\n\nexport const useDefaultValue = (\n  formFilter?: NativeFiltersFormItem,\n  filterToEdit?: Filter,\n): [boolean, boolean, string, Function] => {\n  const enableEmptyFilter = !!formFilter?.controlValues?.enableEmptyFilter;\n  const defaultToFirstItem = !!formFilter?.controlValues?.defaultToFirstItem;\n\n  const [hasDefaultValue, setHasPartialDefaultValue] = useState(false);\n  const [isRequired, setIsRequired] = useState(enableEmptyFilter);\n  const [defaultValueTooltip, setDefaultValueTooltip] = useState('');\n\n  const setHasDefaultValue = (value = false) => {\n    const required = enableEmptyFilter && !defaultToFirstItem;\n    setIsRequired(required);\n    setHasPartialDefaultValue(required ? true : value);\n  };\n\n  useEffect(() => {\n    setHasDefaultValue(\n      defaultToFirstItem\n        ? false\n        : !!formFilter?.defaultDataMask?.filterState?.value,\n    );\n    // TODO: this logic should be unhardcoded\n  }, [defaultToFirstItem, enableEmptyFilter]);\n\n  useEffect(() => {\n    setHasDefaultValue(\n      defaultToFirstItem\n        ? false\n        : !!filterToEdit?.defaultDataMask?.filterState?.value,\n    );\n  }, []);\n\n  useEffect(() => {\n    let tooltip = '';\n    if (defaultToFirstItem) {\n      tooltip = t(\n        'Default value set automatically when \"Select first filter value by default\" is checked',\n      );\n    } else if (isRequired) {\n      tooltip = t(\n        'Default value must be set when \"Filter value is required\" is checked',\n      );\n    } else if (hasDefaultValue) {\n      tooltip = t(\n        'Default value must be set when \"Filter has default value\" is checked',\n      );\n    }\n    setDefaultValueTooltip(tooltip);\n  }, [hasDefaultValue, isRequired, defaultToFirstItem]);\n\n  return [hasDefaultValue, isRequired, defaultValueTooltip, setHasDefaultValue];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport Button, { OnClickHandler } from 'src/components/Button';\n\nexport interface ConfirmationAlertProps {\n  title: string;\n  children: React.ReactNode;\n  onConfirm: OnClickHandler;\n  onDismiss: OnClickHandler;\n}\n\nexport function CancelConfirmationAlert({\n  title,\n  onConfirm,\n  onDismiss,\n  children,\n}: ConfirmationAlertProps) {\n  return (\n    <Alert\n      closable={false}\n      type=\"warning\"\n      key=\"alert\"\n      message={title}\n      css={{\n        textAlign: 'left',\n        '& .ant-alert-action': { alignSelf: 'center' },\n      }}\n      description={children}\n      action={\n        <div css={{ display: 'flex' }}>\n          <Button\n            key=\"cancel\"\n            buttonSize=\"small\"\n            buttonStyle=\"secondary\"\n            onClick={onDismiss}\n          >\n            {t('Keep editing')}\n          </Button>\n          <Button\n            key=\"submit\"\n            buttonSize=\"small\"\n            buttonStyle=\"primary\"\n            onClick={onConfirm}\n          >\n            {t('Yes, cancel')}\n          </Button>\n        </div>\n      }\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC } from 'react';\nimport Button, { OnClickHandler } from 'src/components/Button';\nimport { t } from '@superset-ui/core';\nimport { CancelConfirmationAlert } from './CancelConfirmationAlert';\n\ntype FooterProps = {\n  onCancel: OnClickHandler;\n  handleSave: OnClickHandler;\n  onConfirmCancel: OnClickHandler;\n  onDismiss: OnClickHandler;\n  saveAlertVisible: boolean;\n  canSave?: boolean;\n};\n\nconst Footer: FC<FooterProps> = ({\n  canSave = true,\n  onCancel,\n  handleSave,\n  onDismiss,\n  onConfirmCancel,\n  saveAlertVisible,\n}) => {\n  if (saveAlertVisible) {\n    return (\n      <CancelConfirmationAlert\n        key=\"cancel-confirm\"\n        title={t('There are unsaved changes.')}\n        onConfirm={onConfirmCancel}\n        onDismiss={onDismiss}\n      >\n        {t('Are you sure you want to cancel?')}\n      </CancelConfirmationAlert>\n    );\n  }\n\n  return (\n    <>\n      <Button\n        key=\"cancel\"\n        buttonStyle=\"secondary\"\n        data-test=\"native-filter-modal-cancel-button\"\n        onClick={onCancel}\n      >\n        {t('Cancel')}\n      </Button>\n      <Button\n        disabled={!canSave}\n        key=\"submit\"\n        buttonStyle=\"primary\"\n        onClick={handleSave}\n        data-test=\"native-filter-modal-save-button\"\n      >\n        {t('Save')}\n      </Button>\n    </>\n  );\n};\n\nexport default Footer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { FormItem } from 'src/components/Form';\nimport { Input, TextArea } from 'src/components/Input';\nimport { NativeFilterType, styled, t } from '@superset-ui/core';\n\ninterface Props {\n  componentId: string;\n  divider?: {\n    title: string;\n    description: string;\n  };\n}\nconst Container = styled.div`\n  ${({ theme }) => `\n    padding: ${theme.gridUnit * 4}px;\n  `}\n`;\n\nconst DividerConfigForm: React.FC<Props> = ({ componentId, divider }) => (\n  <Container>\n    <FormItem\n      initialValue={divider ? divider.title : ''}\n      label={t('Title')}\n      name={['filters', componentId, 'title']}\n      rules={[\n        { required: true, message: t('Title is required'), whitespace: true },\n      ]}\n    >\n      <Input />\n    </FormItem>\n    <FormItem\n      initialValue={divider ? divider.description : ''}\n      label={t('Description')}\n      name={['filters', componentId, 'description']}\n    >\n      <TextArea rows={4} />\n    </FormItem>\n    <FormItem\n      hidden\n      name={['filters', componentId, 'type']}\n      initialValue={NativeFilterType.DIVIDER}\n    />\n  </Container>\n);\n\nexport default DividerConfigForm;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useEffect,\n  useCallback,\n  useMemo,\n  useState,\n  useRef,\n} from 'react';\nimport { uniq, isEqual, sortBy, debounce } from 'lodash';\nimport {\n  Filter,\n  FilterConfiguration,\n  NativeFilterType,\n  Divider,\n  styled,\n  SLOW_DEBOUNCE,\n  t,\n} from '@superset-ui/core';\nimport { AntdForm } from 'src/components';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport { StyledModal } from 'src/components/Modal';\nimport { testWithId } from 'src/utils/testUtils';\nimport { useFilterConfigMap, useFilterConfiguration } from '../state';\nimport FilterConfigurePane from './FilterConfigurePane';\nimport FiltersConfigForm, {\n  FilterPanels,\n} from './FiltersConfigForm/FiltersConfigForm';\nimport Footer from './Footer/Footer';\nimport { useOpenModal, useRemoveCurrentFilter } from './state';\nimport { FilterRemoval, NativeFiltersForm } from './types';\nimport {\n  createHandleSave,\n  createHandleRemoveItem,\n  generateFilterId,\n  getFilterIds,\n  validateForm,\n  NATIVE_FILTER_DIVIDER_PREFIX,\n  hasCircularDependency,\n} from './utils';\nimport DividerConfigForm from './DividerConfigForm';\n\nconst StyledModalWrapper = styled(StyledModal)`\n  min-width: 700px;\n  .ant-modal-body {\n    padding: 0px;\n  }\n`;\n\nexport const StyledModalBody = styled.div`\n  display: flex;\n  height: 700px;\n  flex-direction: row;\n  .filters-list {\n    width: ${({ theme }) => theme.gridUnit * 50}px;\n    overflow: auto;\n  }\n`;\n\nexport const StyledForm = styled(AntdForm)`\n  width: 100%;\n`;\n\nexport const FILTERS_CONFIG_MODAL_TEST_ID = 'filters-config-modal';\nexport const getFiltersConfigModalTestId = testWithId(\n  FILTERS_CONFIG_MODAL_TEST_ID,\n);\n\nexport interface FiltersConfigModalProps {\n  isOpen: boolean;\n  initialFilterId?: string;\n  createNewOnOpen?: boolean;\n  onSave: (filterConfig: FilterConfiguration) => Promise<void>;\n  onCancel: () => void;\n}\nexport const ALLOW_DEPENDENCIES = ['filter_select'];\n\n/**\n * This is the modal to configure all the dashboard-native filters.\n * Manages modal-level state, such as what filters are in the list,\n * and which filter is currently being edited.\n *\n * Calls the `save` callback with the new FilterConfiguration object\n * when the user saves the filters.\n */\nexport function FiltersConfigModal({\n  isOpen,\n  initialFilterId,\n  createNewOnOpen,\n  onSave,\n  onCancel,\n}: FiltersConfigModalProps) {\n  const [form] = AntdForm.useForm<NativeFiltersForm>();\n\n  const configFormRef = useRef<any>();\n\n  // the filter config from redux state, this does not change until modal is closed.\n  const filterConfig = useFilterConfiguration();\n  const filterConfigMap = useFilterConfigMap();\n\n  // new filter ids belong to filters have been added during\n  // this configuration session, and only exist in the form state until we submit.\n  const [newFilterIds, setNewFilterIds] = useState<string[]>([]);\n\n  // store ids of filters that have been removed with the time they were removed\n  // so that we can disappear them after a few secs.\n  // filters are still kept in state until form is submitted.\n  const [removedFilters, setRemovedFilters] = useState<\n    Record<string, FilterRemoval>\n  >({});\n\n  const [saveAlertVisible, setSaveAlertVisible] = useState<boolean>(false);\n\n  // The full ordered set of ((original + new) - completely removed) filter ids\n  // Use this as the canonical list of what filters are being configured!\n  // This includes filter ids that are pending removal, so check for that.\n  const filterIds = useMemo(\n    () =>\n      uniq([...getFilterIds(filterConfig), ...newFilterIds]).filter(\n        id => !removedFilters[id] || removedFilters[id]?.isPending,\n      ),\n    [filterConfig, newFilterIds, removedFilters],\n  );\n\n  // open the first filter in the list to start\n  const initialCurrentFilterId = initialFilterId ?? filterIds[0];\n  const [currentFilterId, setCurrentFilterId] = useState(\n    initialCurrentFilterId,\n  );\n  const [erroredFilters, setErroredFilters] = useState<string[]>([]);\n\n  // the form values are managed by the antd form, but we copy them to here\n  // so that we can display them (e.g. filter titles in the tab headers)\n  const [formValues, setFormValues] = useState<NativeFiltersForm>({\n    filters: {},\n  });\n\n  const unsavedFiltersIds = newFilterIds.filter(id => !removedFilters[id]);\n  // brings back a filter that was previously removed (\"Undo\")\n  const restoreFilter = (id: string) => {\n    const removal = removedFilters[id];\n    // gotta clear the removal timeout to prevent the filter from getting deleted\n    if (removal?.isPending) clearTimeout(removal.timerId);\n    setRemovedFilters(current => ({ ...current, [id]: null }));\n  };\n  const getInitialFilterOrder = () => Object.keys(filterConfigMap);\n\n  // State for tracking the re-ordering of filters\n  const [orderedFilters, setOrderedFilters] = useState<string[]>(\n    getInitialFilterOrder(),\n  );\n\n  const getActiveFilterPanelKey = (filterId: string) => [\n    `${filterId}-${FilterPanels.configuration.key}`,\n    `${filterId}-${FilterPanels.settings.key}`,\n  ];\n\n  const [activeFilterPanelKey, setActiveFilterPanelKey] = useState<\n    string | string[]\n  >(getActiveFilterPanelKey(initialCurrentFilterId));\n\n  const onTabChange = (filterId: string) => {\n    setCurrentFilterId(filterId);\n    setActiveFilterPanelKey(getActiveFilterPanelKey(filterId));\n  };\n\n  // generates a new filter id and appends it to the newFilterIds\n  const addFilter = useCallback(\n    (type: NativeFilterType) => {\n      const newFilterId = generateFilterId(type);\n      setNewFilterIds([...newFilterIds, newFilterId]);\n      setCurrentFilterId(newFilterId);\n      setSaveAlertVisible(false);\n      setOrderedFilters([...orderedFilters, newFilterId]);\n      setActiveFilterPanelKey(getActiveFilterPanelKey(newFilterId));\n    },\n    [\n      newFilterIds,\n      orderedFilters,\n      setCurrentFilterId,\n      setOrderedFilters,\n      setNewFilterIds,\n    ],\n  );\n\n  useOpenModal(isOpen, addFilter, createNewOnOpen);\n\n  useRemoveCurrentFilter(\n    removedFilters,\n    currentFilterId,\n    orderedFilters,\n    setCurrentFilterId,\n  );\n\n  const handleRemoveItem = createHandleRemoveItem(\n    setRemovedFilters,\n    setOrderedFilters,\n    setSaveAlertVisible,\n  );\n\n  // After this, it should be as if the modal was just opened fresh.\n  // Called when the modal is closed.\n  const resetForm = (isSaving = false) => {\n    setNewFilterIds([]);\n    setCurrentFilterId(initialCurrentFilterId);\n    setRemovedFilters({});\n    setSaveAlertVisible(false);\n    setFormValues({ filters: {} });\n    setErroredFilters([]);\n    if (filterIds.length > 0) {\n      setActiveFilterPanelKey(getActiveFilterPanelKey(filterIds[0]));\n    }\n    if (!isSaving) {\n      setOrderedFilters(getInitialFilterOrder());\n    }\n    form.resetFields(['filters']);\n    form.setFieldsValue({ changed: false });\n  };\n\n  const getFilterTitle = useCallback(\n    (id: string) => {\n      const formValue = formValues.filters[id];\n      const config = filterConfigMap[id];\n      return (\n        (formValue && 'name' in formValue && formValue.name) ||\n        (formValue && 'title' in formValue && formValue.title) ||\n        (config && 'name' in config && config.name) ||\n        (config && 'title' in config && config.title) ||\n        t('[untitled]')\n      );\n    },\n    [filterConfigMap, formValues.filters],\n  );\n\n  const canBeUsedAsDependency = useCallback(\n    (filterId: string) => {\n      if (removedFilters[filterId]) {\n        return false;\n      }\n      const component =\n        form.getFieldValue('filters')?.[filterId] || filterConfigMap[filterId];\n      return (\n        component &&\n        'filterType' in component &&\n        ALLOW_DEPENDENCIES.includes(component.filterType)\n      );\n    },\n    [filterConfigMap, form, removedFilters],\n  );\n\n  const getAvailableFilters = useCallback(\n    (filterId: string) =>\n      filterIds\n        .filter(key => key !== filterId)\n        .filter(filterId => canBeUsedAsDependency(filterId))\n        .map(key => ({\n          label: getFilterTitle(key),\n          value: key,\n        })),\n    [canBeUsedAsDependency, filterIds, getFilterTitle],\n  );\n\n  const cleanDeletedParents = (values: NativeFiltersForm | null) => {\n    Object.keys(filterConfigMap).forEach(key => {\n      const filter = filterConfigMap[key];\n      if (!('cascadeParentIds' in filter)) {\n        return;\n      }\n      const { cascadeParentIds } = filter;\n      if (cascadeParentIds) {\n        filter.cascadeParentIds = cascadeParentIds.filter(id =>\n          canBeUsedAsDependency(id),\n        );\n      }\n    });\n\n    const filters = values?.filters;\n    if (filters) {\n      Object.keys(filters).forEach(key => {\n        const filter = filters[key];\n        if (!('dependencies' in filter)) {\n          return;\n        }\n        const { dependencies } = filter;\n        if (dependencies) {\n          filter.dependencies = dependencies.filter(id =>\n            canBeUsedAsDependency(id),\n          );\n        }\n      });\n    }\n  };\n\n  const handleErroredFilters = useCallback(() => {\n    // managing left pane errored filters indicators\n    const formValidationFields = form.getFieldsError();\n    const erroredFiltersIds: string[] = [];\n\n    formValidationFields.forEach(field => {\n      const filterId = field.name[1] as string;\n      if (field.errors.length > 0 && !erroredFiltersIds.includes(filterId)) {\n        erroredFiltersIds.push(filterId);\n      }\n    });\n\n    // no form validation issues found, resets errored filters\n    if (!erroredFiltersIds.length && erroredFilters.length > 0) {\n      setErroredFilters([]);\n      return;\n    }\n    // form validation issues found, sets errored filters\n    if (\n      erroredFiltersIds.length > 0 &&\n      !isEqual(sortBy(erroredFilters), sortBy(erroredFiltersIds))\n    ) {\n      setErroredFilters(erroredFiltersIds);\n    }\n  }, [form, erroredFilters]);\n\n  const handleSave = async () => {\n    const values: NativeFiltersForm | null = await validateForm(\n      form,\n      currentFilterId,\n      setCurrentFilterId,\n    );\n\n    handleErroredFilters();\n\n    if (values) {\n      cleanDeletedParents(values);\n      createHandleSave(\n        filterConfigMap,\n        orderedFilters,\n        removedFilters,\n        onSave,\n        values,\n      )();\n      resetForm(true);\n    } else {\n      configFormRef.current.changeTab('configuration');\n    }\n  };\n\n  const handleConfirmCancel = () => {\n    resetForm();\n    onCancel();\n  };\n\n  const handleCancel = () => {\n    const changed = form.getFieldValue('changed');\n    const initialOrder = getInitialFilterOrder();\n    const didChangeOrder =\n      orderedFilters.length !== initialOrder.length ||\n      orderedFilters.some((val, index) => val !== initialOrder[index]);\n    if (\n      unsavedFiltersIds.length > 0 ||\n      form.isFieldsTouched() ||\n      changed ||\n      didChangeOrder\n    ) {\n      setSaveAlertVisible(true);\n    } else {\n      handleConfirmCancel();\n    }\n  };\n  const onRearrange = (dragIndex: number, targetIndex: number) => {\n    const newOrderedFilter = [...orderedFilters];\n    const removed = newOrderedFilter.splice(dragIndex, 1)[0];\n    newOrderedFilter.splice(targetIndex, 0, removed);\n    setOrderedFilters(newOrderedFilter);\n  };\n\n  const buildDependencyMap = useCallback(() => {\n    const dependencyMap = new Map<string, string[]>();\n    const filters = form.getFieldValue('filters');\n    if (filters) {\n      Object.keys(filters).forEach(key => {\n        const formItem = filters[key];\n        const configItem = filterConfigMap[key];\n        let array: string[] = [];\n        if (formItem && 'dependencies' in formItem) {\n          array = [...formItem.dependencies];\n        } else if (configItem && configItem.cascadeParentIds) {\n          array = [...configItem.cascadeParentIds];\n        }\n        dependencyMap.set(key, array);\n      });\n    }\n    return dependencyMap;\n  }, [filterConfigMap, form]);\n\n  const validateDependencies = () => {\n    const dependencyMap = buildDependencyMap();\n    filterIds\n      .filter(id => !removedFilters[id])\n      .forEach(filterId => {\n        const result = hasCircularDependency(dependencyMap, filterId);\n        const field = {\n          name: ['filters', filterId, 'dependencies'],\n          errors: result ? [t('Cyclic dependency detected')] : [],\n        };\n        form.setFields([field]);\n      });\n    handleErroredFilters();\n  };\n\n  const getDependencySuggestion = (filterId: string) => {\n    const dependencyMap = buildDependencyMap();\n    const possibleDependencies = orderedFilters.filter(\n      key => key !== filterId && canBeUsedAsDependency(key),\n    );\n    const found = possibleDependencies.find(filter => {\n      const dependencies = dependencyMap.get(filterId) || [];\n      dependencies.push(filter);\n      if (hasCircularDependency(dependencyMap, filterId)) {\n        dependencies.pop();\n        return false;\n      }\n      return true;\n    });\n    return found || possibleDependencies[0];\n  };\n\n  const onValuesChange = useMemo(\n    () =>\n      debounce((changes: any, values: NativeFiltersForm) => {\n        const didChangeFilterName =\n          changes.filters &&\n          Object.values(changes.filters).some(\n            (filter: any) => filter.name && filter.name !== null,\n          );\n        const didChangeSectionTitle =\n          changes.filters &&\n          Object.values(changes.filters).some(\n            (filter: any) => filter.title && filter.title !== null,\n          );\n        if (didChangeFilterName || didChangeSectionTitle) {\n          // we only need to set this if a name/title changed\n          setFormValues(values);\n        }\n        setSaveAlertVisible(false);\n        handleErroredFilters();\n      }, SLOW_DEBOUNCE),\n    [handleErroredFilters],\n  );\n\n  useEffect(() => {\n    setErroredFilters(prevErroredFilters =>\n      prevErroredFilters.filter(f => !removedFilters[f]),\n    );\n  }, [removedFilters]);\n\n  const getForm = (id: string) => {\n    const isDivider = id.startsWith(NATIVE_FILTER_DIVIDER_PREFIX);\n    return isDivider ? (\n      <DividerConfigForm\n        componentId={id}\n        divider={filterConfigMap[id] as Divider}\n      />\n    ) : (\n      <FiltersConfigForm\n        ref={configFormRef}\n        form={form}\n        filterId={id}\n        filterToEdit={filterConfigMap[id] as Filter}\n        removedFilters={removedFilters}\n        restoreFilter={restoreFilter}\n        getAvailableFilters={getAvailableFilters}\n        key={id}\n        activeFilterPanelKeys={activeFilterPanelKey}\n        handleActiveFilterPanelChange={key => setActiveFilterPanelKey(key)}\n        isActive={currentFilterId === id}\n        setErroredFilters={setErroredFilters}\n        validateDependencies={validateDependencies}\n        getDependencySuggestion={getDependencySuggestion}\n      />\n    );\n  };\n\n  return (\n    <StyledModalWrapper\n      visible={isOpen}\n      maskClosable={false}\n      title={t('Add and edit filters')}\n      width=\"50%\"\n      destroyOnClose\n      onCancel={handleCancel}\n      onOk={handleSave}\n      centered\n      data-test=\"filter-modal\"\n      footer={\n        <Footer\n          onDismiss={() => setSaveAlertVisible(false)}\n          onCancel={handleCancel}\n          handleSave={handleSave}\n          canSave={!erroredFilters.length}\n          saveAlertVisible={saveAlertVisible}\n          onConfirmCancel={handleConfirmCancel}\n        />\n      }\n    >\n      <ErrorBoundary>\n        <StyledModalBody>\n          <StyledForm\n            form={form}\n            onValuesChange={onValuesChange}\n            layout=\"vertical\"\n          >\n            <FilterConfigurePane\n              erroredFilters={erroredFilters}\n              onRemove={handleRemoveItem}\n              onAdd={addFilter}\n              onChange={onTabChange}\n              getFilterTitle={getFilterTitle}\n              currentFilterId={currentFilterId}\n              removedFilters={removedFilters}\n              restoreFilter={restoreFilter}\n              onRearrange={onRearrange}\n              filters={orderedFilters}\n            >\n              {(id: string) => getForm(id)}\n            </FilterConfigurePane>\n          </StyledForm>\n        </StyledModalBody>\n      </ErrorBoundary>\n    </StyledModalWrapper>\n  );\n}\n","import { useEffect } from 'react';\nimport { usePrevious } from 'src/hooks/usePrevious';\nimport { NativeFilterType } from '@superset-ui/core';\nimport { FilterRemoval } from './types';\n\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const useRemoveCurrentFilter = (\n  removedFilters: Record<string, FilterRemoval>,\n  currentFilterId: string,\n  orderedFilters: string[],\n  setCurrentFilterId: Function,\n) => {\n  useEffect(() => {\n    // if the currently viewed filter is fully removed, change to another tab\n    const currentFilterRemoved = removedFilters[currentFilterId];\n    if (currentFilterRemoved && !currentFilterRemoved.isPending) {\n      const nextFilterId = orderedFilters\n        .flat()\n        .find(\n          filterId => !removedFilters[filterId] && filterId !== currentFilterId,\n        );\n\n      if (nextFilterId) setCurrentFilterId(nextFilterId);\n    }\n  }, [currentFilterId, removedFilters, orderedFilters, setCurrentFilterId]);\n};\n\nexport const useOpenModal = (\n  isOpen: boolean,\n  addFilter: Function,\n  createNewOnOpen?: boolean,\n) => {\n  const wasOpen = usePrevious(isOpen);\n  // if this is a \"create\" modal rather than an \"edit\" modal,\n  // add a filter on modal open\n  useEffect(() => {\n    if (createNewOnOpen && isOpen && !wasOpen) {\n      addFilter(NativeFilterType.NATIVE_FILTER);\n    }\n  }, [createNewOnOpen, isOpen, wasOpen, addFilter]);\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport React, { FC } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { StyledModal } from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { AntdForm } from 'src/components';\nimport { setChartConfiguration } from 'src/dashboard/actions/dashboardInfo';\nimport { ChartConfiguration } from 'src/dashboard/reducers/types';\nimport CrossFilterScopingForm from './CrossFilterScopingForm';\nimport { CrossFilterScopingFormType } from './types';\nimport { StyledForm } from '../nativeFilters/FiltersConfigModal/FiltersConfigModal';\n\ntype CrossFilterScopingModalProps = {\n  chartId: number;\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nconst CrossFilterScopingModal: FC<CrossFilterScopingModalProps> = ({\n  isOpen,\n  chartId,\n  onClose,\n}) => {\n  const dispatch = useDispatch();\n  const [form] = AntdForm.useForm<CrossFilterScopingFormType>();\n  const chartConfig = useSelector<any, ChartConfiguration>(\n    ({ dashboardInfo }) => dashboardInfo?.metadata?.chart_configuration,\n  );\n  const scope = chartConfig?.[chartId]?.crossFilters?.scope;\n  const handleSave = () => {\n    dispatch(\n      setChartConfiguration({\n        ...chartConfig,\n        [chartId]: {\n          id: chartId,\n          crossFilters: { scope: form.getFieldValue('scope') },\n        },\n      }),\n    );\n    onClose();\n  };\n\n  return (\n    <StyledModal\n      visible={isOpen}\n      maskClosable={false}\n      title={t('Cross Filter Scoping')}\n      width=\"55%\"\n      destroyOnClose\n      onCancel={onClose}\n      onOk={handleSave}\n      centered\n      data-test=\"cross-filter-scoping-modal\"\n      footer={\n        <>\n          <Button\n            key=\"cancel\"\n            buttonStyle=\"secondary\"\n            data-test=\"cross-filter-scoping-modal-cancel-button\"\n            onClick={onClose}\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            key=\"submit\"\n            buttonStyle=\"primary\"\n            onClick={handleSave}\n            data-test=\"cross-filter-scoping-modal-save-button\"\n          >\n            {t('Save')}\n          </Button>\n        </>\n      }\n    >\n      <StyledForm preserve={false} form={form} layout=\"vertical\">\n        <CrossFilterScopingForm form={form} scope={scope} chartId={chartId} />\n      </StyledForm>\n    </StyledModal>\n  );\n};\n\nexport default CrossFilterScopingModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport moment from 'moment';\nimport {\n  Behavior,\n  css,\n  getChartMetadataRegistry,\n  QueryFormData,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport { NoAnimationDropdown } from 'src/components/Dropdown';\nimport ShareMenuItems from 'src/dashboard/components/menu/ShareMenuItems';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport CrossFilterScopingModal from 'src/dashboard/components/CrossFilterScopingModal/CrossFilterScopingModal';\nimport Icons from 'src/components/Icons';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport ViewQueryModal from 'src/explore/components/controls/ViewQueryModal';\nimport { ResultsPaneOnDashboard } from 'src/explore/components/DataTablesPane';\n\nconst MENU_KEYS = {\n  CROSS_FILTER_SCOPING: 'cross_filter_scoping',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  EXPLORE_CHART: 'explore_chart',\n  EXPORT_CSV: 'export_csv',\n  EXPORT_FULL_CSV: 'export_full_csv',\n  FORCE_REFRESH: 'force_refresh',\n  FULLSCREEN: 'fullscreen',\n  TOGGLE_CHART_DESCRIPTION: 'toggle_chart_description',\n  VIEW_QUERY: 'view_query',\n  VIEW_RESULTS: 'view_results',\n};\n\nconst VerticalDotsContainer = styled.div`\n  padding: ${({ theme }) => theme.gridUnit / 4}px\n    ${({ theme }) => theme.gridUnit * 1.5}px;\n\n  .dot {\n    display: block;\n  }\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst RefreshTooltip = styled.div`\n  height: auto;\n  margin: ${({ theme }) => theme.gridUnit}px 0;\n  color: ${({ theme }) => theme.colors.grayscale.base};\n  line-height: 21px;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n`;\n\nconst getScreenshotNodeSelector = (chartId: string | number) =>\n  `.dashboard-chart-id-${chartId}`;\n\nconst VerticalDotsTrigger = () => (\n  <VerticalDotsContainer>\n    <span className=\"dot\" />\n    <span className=\"dot\" />\n    <span className=\"dot\" />\n  </VerticalDotsContainer>\n);\n\nexport interface SliceHeaderControlsProps {\n  slice: {\n    description: string;\n    viz_type: string;\n    slice_name: string;\n    slice_id: number;\n    slice_description: string;\n    form_data?: { emit_filter?: boolean };\n  };\n\n  componentId: string;\n  dashboardId: number;\n  chartStatus: string;\n  isCached: boolean[];\n  cachedDttm: string[] | null;\n  isExpanded?: boolean;\n  updatedDttm: number | null;\n  isFullSize?: boolean;\n  isDescriptionExpanded?: boolean;\n  formData: QueryFormData;\n  onExploreChart: () => void;\n\n  forceRefresh: (sliceId: number, dashboardId: number) => void;\n  logExploreChart?: (sliceId: number) => void;\n  toggleExpandSlice?: (sliceId: number) => void;\n  exportCSV?: (sliceId: number) => void;\n  exportFullCSV?: (sliceId: number) => void;\n  handleToggleFullSize: () => void;\n\n  addDangerToast: (message: string) => void;\n  addSuccessToast: (message: string) => void;\n\n  supersetCanExplore?: boolean;\n  supersetCanShare?: boolean;\n  supersetCanCSV?: boolean;\n  sliceCanEdit?: boolean;\n}\ninterface State {\n  showControls: boolean;\n  showCrossFilterScopingModal: boolean;\n}\n\nconst dropdownIconsStyles = css`\n  &&.anticon > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nclass SliceHeaderControls extends React.PureComponent<\n  SliceHeaderControlsProps,\n  State\n> {\n  constructor(props: SliceHeaderControlsProps) {\n    super(props);\n    this.toggleControls = this.toggleControls.bind(this);\n    this.refreshChart = this.refreshChart.bind(this);\n    this.handleMenuClick = this.handleMenuClick.bind(this);\n\n    this.state = {\n      showControls: false,\n      showCrossFilterScopingModal: false,\n    };\n  }\n\n  refreshChart() {\n    if (this.props.updatedDttm) {\n      this.props.forceRefresh(\n        this.props.slice.slice_id,\n        this.props.dashboardId,\n      );\n    }\n  }\n\n  toggleControls() {\n    this.setState(prevState => ({\n      showControls: !prevState.showControls,\n    }));\n  }\n\n  handleMenuClick({\n    key,\n    domEvent,\n  }: {\n    key: React.Key;\n    domEvent: React.MouseEvent<HTMLElement>;\n  }) {\n    switch (key) {\n      case MENU_KEYS.FORCE_REFRESH:\n        this.refreshChart();\n        this.props.addSuccessToast(t('Data refreshed'));\n        break;\n      case MENU_KEYS.CROSS_FILTER_SCOPING:\n        this.setState({ showCrossFilterScopingModal: true });\n        break;\n      case MENU_KEYS.TOGGLE_CHART_DESCRIPTION:\n        // eslint-disable-next-line no-unused-expressions\n        this.props.toggleExpandSlice &&\n          this.props.toggleExpandSlice(this.props.slice.slice_id);\n        break;\n      case MENU_KEYS.EXPLORE_CHART:\n        // eslint-disable-next-line no-unused-expressions\n        this.props.logExploreChart &&\n          this.props.logExploreChart(this.props.slice.slice_id);\n        break;\n      case MENU_KEYS.EXPORT_CSV:\n        // eslint-disable-next-line no-unused-expressions\n        this.props.exportCSV && this.props.exportCSV(this.props.slice.slice_id);\n        break;\n      case MENU_KEYS.FULLSCREEN:\n        this.props.handleToggleFullSize();\n        break;\n      case MENU_KEYS.EXPORT_FULL_CSV:\n        // eslint-disable-next-line no-unused-expressions\n        this.props.exportFullCSV &&\n          this.props.exportFullCSV(this.props.slice.slice_id);\n        break;\n      case MENU_KEYS.DOWNLOAD_AS_IMAGE: {\n        // menu closes with a delay, we need to hide it manually,\n        // so that we don't capture it on the screenshot\n        const menu = document.querySelector(\n          '.ant-dropdown:not(.ant-dropdown-hidden)',\n        ) as HTMLElement;\n        menu.style.visibility = 'hidden';\n        downloadAsImage(\n          getScreenshotNodeSelector(this.props.slice.slice_id),\n          this.props.slice.slice_name,\n          true,\n          // @ts-ignore\n        )(domEvent).then(() => {\n          menu.style.visibility = 'visible';\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const {\n      componentId,\n      dashboardId,\n      slice,\n      isFullSize,\n      cachedDttm = [],\n      updatedDttm = null,\n      addSuccessToast = () => {},\n      addDangerToast = () => {},\n      supersetCanShare = false,\n      isCached = [],\n    } = this.props;\n    const crossFilterItems = getChartMetadataRegistry().items;\n    const isTable = slice.viz_type === 'table';\n    const isCrossFilter = Object.entries(crossFilterItems)\n      // @ts-ignore\n      .filter(([, { value }]) =>\n        value.behaviors?.includes(Behavior.INTERACTIVE_CHART),\n      )\n      .find(([key]) => key === slice.viz_type);\n    const canEmitCrossFilter = slice.form_data?.emit_filter;\n\n    const cachedWhen = (cachedDttm || []).map(itemCachedDttm =>\n      moment.utc(itemCachedDttm).fromNow(),\n    );\n    const updatedWhen = updatedDttm ? moment.utc(updatedDttm).fromNow() : '';\n    const getCachedTitle = (itemCached: boolean) => {\n      if (itemCached) {\n        return t('Cached %s', cachedWhen);\n      }\n      if (updatedWhen) {\n        return t('Fetched %s', updatedWhen);\n      }\n      return '';\n    };\n    const refreshTooltipData = [...new Set(isCached.map(getCachedTitle) || '')];\n    // If all queries have same cache time we can unit them to one\n    const refreshTooltip = refreshTooltipData.map((item, index) => (\n      <div key={`tooltip-${index}`}>\n        {refreshTooltipData.length > 1\n          ? t('Query %s: %s', index + 1, item)\n          : item}\n      </div>\n    ));\n    const fullscreenLabel = isFullSize\n      ? t('Exit fullscreen')\n      : t('Enter fullscreen');\n    const menu = (\n      <Menu\n        onClick={this.handleMenuClick}\n        selectable={false}\n        data-test={`slice_${slice.slice_id}-menu`}\n      >\n        <Menu.Item\n          key={MENU_KEYS.FORCE_REFRESH}\n          disabled={this.props.chartStatus === 'loading'}\n          style={{ height: 'auto', lineHeight: 'initial' }}\n          data-test=\"refresh-chart-menu-item\"\n        >\n          {t('Force refresh')}\n          <RefreshTooltip data-test=\"dashboard-slice-refresh-tooltip\">\n            {refreshTooltip}\n          </RefreshTooltip>\n        </Menu.Item>\n\n        <Menu.Item key={MENU_KEYS.FULLSCREEN}>{fullscreenLabel}</Menu.Item>\n\n        <Menu.Divider />\n\n        {slice.description && (\n          <Menu.Item key={MENU_KEYS.TOGGLE_CHART_DESCRIPTION}>\n            {this.props.isDescriptionExpanded\n              ? t('Hide chart description')\n              : t('Show chart description')}\n          </Menu.Item>\n        )}\n\n        {this.props.supersetCanExplore && (\n          <Menu.Item\n            key={MENU_KEYS.EXPLORE_CHART}\n            onClick={this.props.onExploreChart}\n          >\n            {t('Edit chart')}\n          </Menu.Item>\n        )}\n\n        {this.props.supersetCanExplore && (\n          <Menu.Item key={MENU_KEYS.VIEW_QUERY}>\n            <ModalTrigger\n              triggerNode={\n                <span data-test=\"view-query-menu-item\">{t('View query')}</span>\n              }\n              modalTitle={t('View query')}\n              modalBody={\n                <ViewQueryModal latestQueryFormData={this.props.formData} />\n              }\n              draggable\n              resizable\n              responsive\n            />\n          </Menu.Item>\n        )}\n\n        {this.props.supersetCanExplore && (\n          <Menu.Item key={MENU_KEYS.VIEW_RESULTS}>\n            <ModalTrigger\n              triggerNode={\n                <span data-test=\"view-query-menu-item\">\n                  {t('View as table')}\n                </span>\n              }\n              modalTitle={t('Chart Data: %s', slice.slice_name)}\n              modalBody={\n                <ResultsPaneOnDashboard\n                  queryFormData={this.props.formData}\n                  queryForce={false}\n                  dataSize={20}\n                  isRequest\n                  isVisible\n                />\n              }\n              modalFooter={\n                <Button\n                  buttonStyle=\"secondary\"\n                  buttonSize=\"small\"\n                  onClick={this.props.onExploreChart}\n                >\n                  {t('Edit chart')}\n                </Button>\n              }\n              draggable\n              resizable\n              responsive\n            />\n          </Menu.Item>\n        )}\n\n        {(slice.description || this.props.supersetCanExplore) && (\n          <Menu.Divider />\n        )}\n\n        {isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS) &&\n          isCrossFilter &&\n          canEmitCrossFilter && (\n            <>\n              <Menu.Item key={MENU_KEYS.CROSS_FILTER_SCOPING}>\n                {t('Cross-filter scoping')}\n              </Menu.Item>\n              <Menu.Divider />\n            </>\n          )}\n\n        {supersetCanShare && (\n          <Menu.SubMenu title={t('Share')}>\n            <ShareMenuItems\n              dashboardId={dashboardId}\n              dashboardComponentId={componentId}\n              copyMenuItemTitle={t('Copy permalink to clipboard')}\n              emailMenuItemTitle={t('Share chart by email')}\n              emailSubject={t('Superset chart')}\n              emailBody={t('Check out this chart: ')}\n              addSuccessToast={addSuccessToast}\n              addDangerToast={addDangerToast}\n            />\n          </Menu.SubMenu>\n        )}\n\n        {this.props.slice.viz_type !== 'filter_box' &&\n          this.props.supersetCanCSV && (\n            <Menu.SubMenu title={t('Download')}>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_CSV}\n                icon={<Icons.FileOutlined css={dropdownIconsStyles} />}\n              >\n                {t('Export to .CSV')}\n              </Menu.Item>\n\n              {this.props.slice.viz_type !== 'filter_box' &&\n                isFeatureEnabled(FeatureFlag.ALLOW_FULL_CSV_EXPORT) &&\n                this.props.supersetCanCSV &&\n                isTable && (\n                  <Menu.Item\n                    key={MENU_KEYS.EXPORT_FULL_CSV}\n                    icon={<Icons.FileOutlined css={dropdownIconsStyles} />}\n                  >\n                    {t('Export to full .CSV')}\n                  </Menu.Item>\n                )}\n\n              <Menu.Item\n                key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n                icon={<Icons.FileImageOutlined css={dropdownIconsStyles} />}\n              >\n                {t('Download as image')}\n              </Menu.Item>\n            </Menu.SubMenu>\n          )}\n      </Menu>\n    );\n\n    return (\n      <>\n        <CrossFilterScopingModal\n          chartId={slice.slice_id}\n          isOpen={this.state.showCrossFilterScopingModal}\n          onClose={() => this.setState({ showCrossFilterScopingModal: false })}\n        />\n        {isFullSize && (\n          <Icons.FullscreenExitOutlined\n            style={{ fontSize: 22 }}\n            onClick={() => {\n              this.props.handleToggleFullSize();\n            }}\n          />\n        )}\n        <NoAnimationDropdown\n          overlay={menu}\n          trigger={['click']}\n          placement=\"bottomRight\"\n        >\n          <span\n            id={`slice_${slice.slice_id}-controls`}\n            role=\"button\"\n            aria-label=\"More Options\"\n          >\n            <VerticalDotsTrigger />\n          </span>\n        </NoAnimationDropdown>\n      </>\n    );\n  }\n}\n\nexport default SliceHeaderControls;\n","// This icon file is generated automatically.\nvar CheckCircleFilled = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z\" } }] }, \"name\": \"check-circle\", \"theme\": \"filled\" };\nexport default CheckCircleFilled;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport CheckCircleFilledSvg from \"@ant-design/icons-svg/es/asn/CheckCircleFilled\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CheckCircleFilled = function CheckCircleFilled(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: CheckCircleFilledSvg\n  }));\n};\n\nCheckCircleFilled.displayName = 'CheckCircleFilled';\nexport default React.forwardRef(CheckCircleFilled);","// This icon file is generated automatically.\nvar ExclamationCircleFilled = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z\" } }] }, \"name\": \"exclamation-circle\", \"theme\": \"filled\" };\nexport default ExclamationCircleFilled;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ExclamationCircleFilledSvg from \"@ant-design/icons-svg/es/asn/ExclamationCircleFilled\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar ExclamationCircleFilled = function ExclamationCircleFilled(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: ExclamationCircleFilledSvg\n  }));\n};\n\nExclamationCircleFilled.displayName = 'ExclamationCircleFilled';\nexport default React.forwardRef(ExclamationCircleFilled);","// This icon file is generated automatically.\nvar MinusCircleFilled = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z\" } }] }, \"name\": \"minus-circle\", \"theme\": \"filled\" };\nexport default MinusCircleFilled;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport MinusCircleFilledSvg from \"@ant-design/icons-svg/es/asn/MinusCircleFilled\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar MinusCircleFilled = function MinusCircleFilled(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: MinusCircleFilledSvg\n  }));\n};\n\nMinusCircleFilled.displayName = 'MinusCircleFilled';\nexport default React.forwardRef(MinusCircleFilled);","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { css, styled } from '@superset-ui/core';\n\nexport const Pill = styled.div`\n  ${({ theme }) => css`\n    display: inline-block;\n    color: ${theme.colors.grayscale.light5};\n    background: ${theme.colors.grayscale.base};\n    border-radius: 1em;\n    vertical-align: text-top;\n    padding: ${theme.gridUnit}px ${theme.gridUnit * 2}px;\n    font-size: ${theme.typography.sizes.m}px;\n    font-weight: ${theme.typography.weights.bold};\n    min-width: 1em;\n    min-height: 1em;\n    line-height: 1em;\n    vertical-align: middle;\n    white-space: nowrap;\n\n    svg {\n      position: relative;\n      top: -2px;\n      color: ${theme.colors.grayscale.light5};\n      width: 1em;\n      height: 1em;\n      display: inline-block;\n      vertical-align: middle;\n    }\n\n    &:hover {\n      cursor: pointer;\n      background: ${theme.colors.grayscale.dark1};\n    }\n\n    &.has-cross-filters {\n      background: ${theme.colors.primary.base};\n      &:hover {\n        background: ${theme.colors.primary.dark1};\n      }\n    }\n\n    &.has-incompatible-filters {\n      color: ${theme.colors.grayscale.dark2};\n      background: ${theme.colors.alert.base};\n      &:hover {\n        background: ${theme.colors.alert.dark1};\n      }\n      svg {\n        color: ${theme.colors.grayscale.dark2};\n      }\n    }\n\n    &.filters-inactive {\n      color: ${theme.colors.grayscale.light5};\n      background: ${theme.colors.grayscale.light1};\n      padding: ${theme.gridUnit}px;\n      text-align: center;\n      height: 22px;\n      width: 22px;\n\n      &:hover {\n        background: ${theme.colors.grayscale.base};\n      }\n    }\n  `}\n`;\n\nexport interface TitleProps {\n  bold?: boolean;\n  color?: string;\n}\n\nexport const Title = styled.span<TitleProps>`\n  position: relative;\n  margin-right: ${({ theme }) => theme.gridUnit}px;\n  font-weight: ${({ bold, theme }) => {\n    if (bold) return theme.typography.weights.bold;\n    return 'auto';\n  }};\n  color: ${({ color, theme }) => color || theme.colors.grayscale.light5};\n  display: flex;\n  align-items: center;\n  & > * {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nexport const ItemIcon = styled.i`\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  left: -${({ theme }) => theme.gridUnit * 5}px;\n`;\n\nexport const Item = styled.button`\n  cursor: pointer;\n  display: flex;\n  flex-wrap: wrap;\n  text-align: left;\n  padding: 0;\n  border: none;\n  background: none;\n  outline: none;\n  width: 100%;\n\n  &::-moz-focus-inner {\n    border: 0;\n  }\n\n  & i svg {\n    color: transparent;\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  &:hover i svg {\n    color: inherit;\n  }\n`;\n\nexport const Reset = styled.div`\n  margin: 0 -${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nexport const Indent = styled.div`\n  padding-left: ${({ theme }) => theme.gridUnit * 6}px;\n  margin: -${({ theme }) => theme.gridUnit * 3}px 0;\n`;\n\nexport const Panel = styled.div`\n  min-width: 200px;\n  max-width: 300px;\n  overflow-x: hidden;\n`;\n\nexport const FilterValue = styled.div`\n  max-width: 100%;\n  flex-grow: 1;\n  overflow: auto;\n  color: ${({ theme }) => theme.colors.grayscale.light5};\n`;\n\nexport const FilterIndicatorText = styled.div`\n  ${({ theme }) => `\n  padding-top: ${theme.gridUnit * 3}px;\n  max-width: 100%;\n  flex-grow: 1;\n  overflow: auto;\n  color: ${theme.colors.grayscale.light5};\n  `}\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport shortid from 'shortid';\nimport { DataMaskState, FilterSet, t } from '@superset-ui/core';\nimport { areObjectsEqual } from 'src/reduxUtils';\n\nexport const generateFiltersSetId = () => `FILTERS_SET-${shortid.generate()}`;\n\nexport const APPLY_FILTERS_HINT = t('Please apply filter changes');\n\nexport const getFilterValueForDisplay = (\n  value?: string[] | null | string | number | object,\n): string => {\n  if (value === null || value === undefined) {\n    return '';\n  }\n  if (typeof value === 'string' || typeof value === 'number') {\n    return `${value}`;\n  }\n  if (Array.isArray(value)) {\n    return value.join(', ');\n  }\n  if (typeof value === 'object') {\n    return JSON.stringify(value);\n  }\n  return t('Unknown value');\n};\n\nexport const findExistingFilterSet = ({\n  filterSetFilterValues,\n  dataMaskSelected,\n}: {\n  filterSetFilterValues: FilterSet[];\n  dataMaskSelected: DataMaskState;\n}) =>\n  filterSetFilterValues.find(({ dataMask: dataMaskFromFilterSet = {} }) => {\n    const dataMaskSelectedEntries = Object.entries(dataMaskSelected);\n    return dataMaskSelectedEntries.every(([id, filterFromSelectedFilters]) => {\n      const isEqual = areObjectsEqual(\n        filterFromSelectedFilters.filterState,\n        dataMaskFromFilterSet?.[id]?.filterState,\n        { ignoreUndefined: true, ignoreNull: true },\n      );\n      const hasSamePropsNumber =\n        dataMaskSelectedEntries.length ===\n        Object.keys(dataMaskFromFilterSet ?? {}).length;\n      return isEqual && hasSamePropsNumber;\n    });\n  });\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SearchOutlined } from '@ant-design/icons';\nimport React, { FC } from 'react';\nimport { getFilterValueForDisplay } from 'src/dashboard/components/nativeFilters/FilterBar/FilterSets/utils';\nimport {\n  FilterIndicatorText,\n  FilterValue,\n  Item,\n  ItemIcon,\n  Title,\n} from 'src/dashboard/components/FiltersBadge/Styles';\nimport { Indicator } from 'src/dashboard/components/FiltersBadge/selectors';\n\nexport interface IndicatorProps {\n  indicator: Indicator;\n  onClick?: (path: string[]) => void;\n  text?: string;\n}\n\nconst FilterIndicator: FC<IndicatorProps> = ({\n  indicator: { column, name, value, path = [] },\n  onClick = () => {},\n  text,\n}) => {\n  const resultValue = getFilterValueForDisplay(value);\n  return (\n    <>\n      <Item onClick={() => onClick([...path, `LABEL-${column}`])}>\n        <Title bold>\n          <ItemIcon>\n            <SearchOutlined />\n          </ItemIcon>\n          {name}\n          {resultValue ? ': ' : ''}\n        </Title>\n        <FilterValue>{resultValue}</FilterValue>\n      </Item>\n      {text && <FilterIndicatorText>{text}</FilterIndicatorText>}\n    </>\n  );\n};\n\nexport default FilterIndicator;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Global, css } from '@emotion/react';\nimport { t, useTheme } from '@superset-ui/core';\nimport {\n  MinusCircleFilled,\n  CheckCircleFilled,\n  ExclamationCircleFilled,\n} from '@ant-design/icons';\nimport Popover from 'src/components/Popover';\nimport Collapse from 'src/components/Collapse';\nimport Icons from 'src/components/Icons';\nimport {\n  Indent,\n  Panel,\n  Reset,\n  Title,\n} from 'src/dashboard/components/FiltersBadge/Styles';\nimport { Indicator } from 'src/dashboard/components/FiltersBadge/selectors';\nimport FilterIndicator from 'src/dashboard/components/FiltersBadge/FilterIndicator';\nimport { RootState } from 'src/dashboard/types';\n\nexport interface DetailsPanelProps {\n  appliedCrossFilterIndicators: Indicator[];\n  appliedIndicators: Indicator[];\n  incompatibleIndicators: Indicator[];\n  unsetIndicators: Indicator[];\n  onHighlightFilterSource: (path: string[]) => void;\n  children: JSX.Element;\n}\n\nconst DetailsPanelPopover = ({\n  appliedCrossFilterIndicators = [],\n  appliedIndicators = [],\n  incompatibleIndicators = [],\n  unsetIndicators = [],\n  onHighlightFilterSource,\n  children,\n}: DetailsPanelProps) => {\n  const [visible, setVisible] = useState(false);\n  const theme = useTheme();\n  const activeTabs = useSelector<RootState>(\n    state => state.dashboardState?.activeTabs,\n  );\n\n  // we don't need to clean up useEffect, setting { once: true } removes the event listener after handle function is called\n  useEffect(() => {\n    if (visible) {\n      window.addEventListener('resize', () => setVisible(false), {\n        once: true,\n      });\n    }\n  }, [visible]);\n\n  // if tabs change, popover doesn't close automatically\n  useEffect(() => {\n    setVisible(false);\n  }, [activeTabs]);\n\n  const getDefaultActivePanel = () => {\n    const result = [];\n    if (appliedCrossFilterIndicators.length) {\n      result.push('appliedCrossFilters');\n    }\n    if (appliedIndicators.length) {\n      result.push('applied');\n    }\n    if (incompatibleIndicators.length) {\n      result.push('incompatible');\n    }\n    if (result.length) {\n      return result;\n    }\n    return ['unset'];\n  };\n\n  const [activePanels, setActivePanels] = useState<string[]>(() => [\n    ...getDefaultActivePanel(),\n  ]);\n\n  function handlePopoverStatus(isOpen: boolean) {\n    setVisible(isOpen);\n    // every time the popover opens, make sure the most relevant panel is active\n    if (isOpen) {\n      setActivePanels(getDefaultActivePanel());\n    }\n  }\n\n  function handleActivePanelChange(panels: string | string[]) {\n    // need to convert to an array so that handlePopoverStatus will work\n    if (typeof panels === 'string') {\n      setActivePanels([panels]);\n    } else {\n      setActivePanels(panels);\n    }\n  }\n\n  const indicatorKey = (indicator: Indicator): string =>\n    `${indicator.column} - ${indicator.name}`;\n\n  const content = (\n    <Panel>\n      <Global\n        styles={css`\n          .filterStatusPopover {\n            .ant-popover-inner {\n              background-color: ${theme.colors.grayscale.dark2}cc;\n              .ant-popover-inner-content {\n                padding-top: 0;\n                padding-bottom: 0;\n              }\n            }\n            &.ant-popover-placement-bottom,\n            &.ant-popover-placement-bottomLeft,\n            &.ant-popover-placement-bottomRight {\n              & > .ant-popover-content > .ant-popover-arrow {\n                border-top-color: ${theme.colors.grayscale.dark2}cc;\n                border-left-color: ${theme.colors.grayscale.dark2}cc;\n              }\n            }\n            &.ant-popover-placement-top,\n            &.ant-popover-placement-topLeft,\n            &.ant-popover-placement-topRight {\n              & > .ant-popover-content > .ant-popover-arrow {\n                border-bottom-color: ${theme.colors.grayscale.dark2}cc;\n                border-right-color: ${theme.colors.grayscale.dark2}cc;\n              }\n            }\n            &.ant-popover-placement-left,\n            &.ant-popover-placement-leftTop,\n            &.ant-popover-placement-leftBottom {\n              & > .ant-popover-content > .ant-popover-arrow {\n                border-top-color: ${theme.colors.grayscale.dark2}cc;\n                border-right-color: ${theme.colors.grayscale.dark2}cc;\n              }\n            }\n            &.ant-popover-placement-right,\n            &.ant-popover-placement-rightTop,\n            &.ant-popover-placement-rightBottom {\n              & > .ant-popover-content > .ant-popover-arrow {\n                border-bottom-color: ${theme.colors.grayscale.dark2}cc;\n                border-left-color: ${theme.colors.grayscale.dark2}cc;\n              }\n            }\n            &.ant-popover {\n              color: ${theme.colors.grayscale.light4};\n              z-index: 99;\n            }\n          }\n        `}\n      />\n      <Reset>\n        <Collapse\n          ghost\n          light\n          activeKey={activePanels}\n          onChange={handleActivePanelChange}\n        >\n          {appliedCrossFilterIndicators.length ? (\n            <Collapse.Panel\n              key=\"appliedCrossFilters\"\n              header={\n                <Title bold color={theme.colors.primary.light1}>\n                  <Icons.CursorTarget\n                    css={{ fill: theme.colors.primary.light1 }}\n                    iconSize=\"xl\"\n                  />\n                  {t(\n                    'Applied Cross Filters (%d)',\n                    appliedCrossFilterIndicators.length,\n                  )}\n                </Title>\n              }\n            >\n              <Indent css={{ paddingBottom: theme.gridUnit * 3 }}>\n                {appliedCrossFilterIndicators.map(indicator => (\n                  <FilterIndicator\n                    key={indicatorKey(indicator)}\n                    indicator={indicator}\n                    onClick={onHighlightFilterSource}\n                  />\n                ))}\n              </Indent>\n            </Collapse.Panel>\n          ) : null}\n          {appliedIndicators.length ? (\n            <Collapse.Panel\n              key=\"applied\"\n              header={\n                <Title bold color={theme.colors.success.base}>\n                  <CheckCircleFilled />{' '}\n                  {t('Applied Filters (%d)', appliedIndicators.length)}\n                </Title>\n              }\n            >\n              <Indent css={{ paddingBottom: theme.gridUnit * 3 }}>\n                {appliedIndicators.map(indicator => (\n                  <FilterIndicator\n                    key={indicatorKey(indicator)}\n                    indicator={indicator}\n                    onClick={onHighlightFilterSource}\n                  />\n                ))}\n              </Indent>\n            </Collapse.Panel>\n          ) : null}\n          {incompatibleIndicators.length ? (\n            <Collapse.Panel\n              key=\"incompatible\"\n              header={\n                <Title bold color={theme.colors.alert.base}>\n                  <ExclamationCircleFilled />{' '}\n                  {t(\n                    'Incompatible Filters (%d)',\n                    incompatibleIndicators.length,\n                  )}\n                </Title>\n              }\n            >\n              <Indent css={{ paddingBottom: theme.gridUnit * 3 }}>\n                {incompatibleIndicators.map(indicator => (\n                  <FilterIndicator\n                    key={indicatorKey(indicator)}\n                    indicator={indicator}\n                    onClick={onHighlightFilterSource}\n                  />\n                ))}\n              </Indent>\n            </Collapse.Panel>\n          ) : null}\n          {unsetIndicators.length ? (\n            <Collapse.Panel\n              key=\"unset\"\n              header={\n                <Title bold color={theme.colors.grayscale.light1}>\n                  <MinusCircleFilled />{' '}\n                  {t('Unset Filters (%d)', unsetIndicators.length)}\n                </Title>\n              }\n              disabled={!unsetIndicators.length}\n            >\n              <Indent css={{ paddingBottom: theme.gridUnit * 3 }}>\n                {unsetIndicators.map(indicator => (\n                  <FilterIndicator\n                    key={indicatorKey(indicator)}\n                    indicator={indicator}\n                    onClick={onHighlightFilterSource}\n                  />\n                ))}\n              </Indent>\n            </Collapse.Panel>\n          ) : null}\n        </Collapse>\n      </Reset>\n    </Panel>\n  );\n\n  return (\n    <Popover\n      overlayClassName=\"filterStatusPopover\"\n      content={content}\n      visible={visible}\n      onVisibleChange={handlePopoverStatus}\n      placement=\"bottomRight\"\n      trigger=\"click\"\n    >\n      {children}\n    </Popover>\n  );\n};\n\nexport default DetailsPanelPopover;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  DataMaskType,\n  ensureIsArray,\n  FeatureFlag,\n  Filters,\n  FilterState,\n  isFeatureEnabled,\n  NativeFilterType,\n} from '@superset-ui/core';\nimport { NO_TIME_RANGE, TIME_FILTER_MAP } from 'src/explore/constants';\nimport { getChartIdsInFilterBoxScope } from 'src/dashboard/util/activeDashboardFilters';\nimport { CHART_TYPE } from 'src/dashboard/util/componentTypes';\nimport { ChartConfiguration } from 'src/dashboard/reducers/types';\nimport { Layout } from 'src/dashboard/types';\nimport { areObjectsEqual } from 'src/reduxUtils';\n\nexport enum IndicatorStatus {\n  Unset = 'UNSET',\n  Applied = 'APPLIED',\n  Incompatible = 'INCOMPATIBLE',\n  CrossFilterApplied = 'CROSS_FILTER_APPLIED',\n}\n\nconst TIME_GRANULARITY_FIELDS = new Set(Object.values(TIME_FILTER_MAP));\n\n// As of 2020-09-28, the Dataset type in superset-ui is incorrect.\n// Should patch it here until the Dataset type is updated.\ntype Datasource = {\n  time_grain_sqla?: [string, string][];\n  granularity?: [string, string][];\n};\n\ntype Filter = {\n  chartId: number;\n  columns: { [key: string]: string | string[] };\n  scopes: { [key: string]: any };\n  labels: { [key: string]: string };\n  isDateFilter: boolean;\n  directPathToFilter: string[];\n  datasourceId: string;\n};\n\nconst extractLabel = (filter?: FilterState): string | null => {\n  if (filter?.label) {\n    return filter.label;\n  }\n  if (filter?.value) {\n    return ensureIsArray(filter?.value).join(', ');\n  }\n  return null;\n};\n\nconst selectIndicatorValue = (\n  columnKey: string,\n  filter: Filter,\n  datasource: Datasource,\n): any => {\n  const values = filter.columns[columnKey];\n  const arrValues = Array.isArray(values) ? values : [values];\n\n  if (\n    values == null ||\n    (filter.isDateFilter && values === NO_TIME_RANGE) ||\n    arrValues.length === 0\n  ) {\n    return [];\n  }\n\n  if (filter.isDateFilter && TIME_GRANULARITY_FIELDS.has(columnKey)) {\n    const timeGranularityMap = (\n      (columnKey === TIME_FILTER_MAP.time_grain_sqla\n        ? datasource.time_grain_sqla\n        : datasource.granularity) || []\n    ).reduce(\n      (map, [key, value]) => ({\n        ...map,\n        [key]: value,\n      }),\n      {},\n    );\n\n    return arrValues.map(value => timeGranularityMap[value] || value);\n  }\n\n  return arrValues;\n};\n\nconst selectIndicatorsForChartFromFilter = (\n  chartId: number,\n  filter: Filter,\n  filterDataSource: Datasource,\n  appliedColumns: Set<string>,\n  rejectedColumns: Set<string>,\n): Indicator[] => {\n  // filters can be applied (if the filter is compatible with the datasource)\n  // or rejected (if the filter is incompatible)\n  // or the status can be unknown (if the filter has calculated parameters that we can't analyze)\n  const getStatus = (column: string, filter: Filter) => {\n    if (appliedColumns.has(column) && filter.columns[column])\n      return IndicatorStatus.Applied;\n    if (rejectedColumns.has(column)) return IndicatorStatus.Incompatible;\n    return IndicatorStatus.Unset;\n  };\n\n  return Object.keys(filter.columns)\n    .filter(column =>\n      getChartIdsInFilterBoxScope({\n        filterScope: filter.scopes[column],\n      }).includes(chartId),\n    )\n    .map(column => ({\n      column,\n      name: filter.labels[column] || column,\n      value: selectIndicatorValue(column, filter, filterDataSource),\n      status: getStatus(column, filter),\n      path: filter.directPathToFilter,\n    }));\n};\n\nconst getAppliedColumns = (chart: any): Set<string> =>\n  new Set(\n    (chart?.queriesResponse?.[0]?.applied_filters || []).map(\n      (filter: any) => filter.column,\n    ),\n  );\n\nconst getRejectedColumns = (chart: any): Set<string> =>\n  new Set(\n    (chart?.queriesResponse?.[0]?.rejected_filters || []).map(\n      (filter: any) => filter.column,\n    ),\n  );\n\nexport type Indicator = {\n  column?: string;\n  name: string;\n  value?: any;\n  status?: IndicatorStatus;\n  path?: string[];\n};\n\nconst cachedIndicatorsForChart = {};\nconst cachedDashboardFilterDataForChart = {};\n// inspects redux state to find what the filter indicators should be shown for a given chart\nexport const selectIndicatorsForChart = (\n  chartId: number,\n  filters: { [key: number]: Filter },\n  datasources: { [key: string]: Datasource },\n  chart: any,\n): Indicator[] => {\n  // for now we only need to know which columns are compatible/incompatible,\n  // so grab the columns from the applied/rejected filters\n  const appliedColumns = getAppliedColumns(chart);\n  const rejectedColumns = getRejectedColumns(chart);\n  const matchingFilters = Object.values(filters).filter(\n    filter => filter.chartId !== chartId,\n  );\n  const matchingDatasources = Object.entries(datasources)\n    .filter(([key]) =>\n      matchingFilters.find(filter => filter.datasourceId === key),\n    )\n    .map(([, datasource]) => datasource);\n\n  const cachedFilterData = cachedDashboardFilterDataForChart[chartId];\n  if (\n    cachedIndicatorsForChart[chartId] &&\n    areObjectsEqual(cachedFilterData?.appliedColumns, appliedColumns) &&\n    areObjectsEqual(cachedFilterData?.rejectedColumns, rejectedColumns) &&\n    areObjectsEqual(cachedFilterData?.matchingFilters, matchingFilters) &&\n    areObjectsEqual(cachedFilterData?.matchingDatasources, matchingDatasources)\n  ) {\n    return cachedIndicatorsForChart[chartId];\n  }\n  const indicators = matchingFilters.reduce(\n    (acc, filter) =>\n      acc.concat(\n        selectIndicatorsForChartFromFilter(\n          chartId,\n          filter,\n          datasources[filter.datasourceId] || {},\n          appliedColumns,\n          rejectedColumns,\n        ),\n      ),\n    [] as Indicator[],\n  );\n  indicators.sort((a, b) => a.name.localeCompare(b.name));\n  cachedIndicatorsForChart[chartId] = indicators;\n  cachedDashboardFilterDataForChart[chartId] = {\n    appliedColumns,\n    rejectedColumns,\n    matchingFilters,\n    matchingDatasources,\n  };\n  return indicators;\n};\n\nconst cachedNativeIndicatorsForChart = {};\nconst cachedNativeFilterDataForChart: any = {};\nconst defaultChartConfig = {};\nexport const selectNativeIndicatorsForChart = (\n  nativeFilters: Filters,\n  dataMask: DataMaskStateWithId,\n  chartId: number,\n  chart: any,\n  dashboardLayout: Layout,\n  chartConfiguration: ChartConfiguration = defaultChartConfig,\n): Indicator[] => {\n  const appliedColumns = getAppliedColumns(chart);\n  const rejectedColumns = getRejectedColumns(chart);\n\n  const cachedFilterData = cachedNativeFilterDataForChart[chartId];\n  if (\n    cachedNativeIndicatorsForChart[chartId] &&\n    areObjectsEqual(cachedFilterData?.appliedColumns, appliedColumns) &&\n    areObjectsEqual(cachedFilterData?.rejectedColumns, rejectedColumns) &&\n    cachedFilterData?.nativeFilters === nativeFilters &&\n    cachedFilterData?.dashboardLayout === dashboardLayout &&\n    cachedFilterData?.chartConfiguration === chartConfiguration &&\n    cachedFilterData?.dataMask === dataMask\n  ) {\n    return cachedNativeIndicatorsForChart[chartId];\n  }\n  const getStatus = ({\n    label,\n    column,\n    type = DataMaskType.NativeFilters,\n  }: {\n    label: string | null;\n    column?: string;\n    type?: DataMaskType;\n  }): IndicatorStatus => {\n    // a filter is only considered unset if it's value is null\n    const hasValue = label !== null;\n    if (type === DataMaskType.CrossFilters && hasValue) {\n      return IndicatorStatus.CrossFilterApplied;\n    }\n    if (!column && hasValue) {\n      // Filter without datasource\n      return IndicatorStatus.Applied;\n    }\n    if (column && rejectedColumns.has(column))\n      return IndicatorStatus.Incompatible;\n    if (column && appliedColumns.has(column) && hasValue) {\n      return IndicatorStatus.Applied;\n    }\n    return IndicatorStatus.Unset;\n  };\n\n  let nativeFilterIndicators: any = [];\n  if (isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS)) {\n    nativeFilterIndicators =\n      nativeFilters &&\n      Object.values(nativeFilters)\n        .filter(\n          nativeFilter =>\n            nativeFilter.type === NativeFilterType.NATIVE_FILTER &&\n            nativeFilter.chartsInScope?.includes(chartId),\n        )\n        .map(nativeFilter => {\n          const column = nativeFilter.targets?.[0]?.column?.name;\n          const filterState = dataMask[nativeFilter.id]?.filterState;\n          const label = extractLabel(filterState);\n          return {\n            column,\n            name: nativeFilter.name,\n            path: [nativeFilter.id],\n            status: getStatus({ label, column }),\n            value: label,\n          };\n        });\n  }\n\n  let crossFilterIndicators: any = [];\n  if (isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)) {\n    const dashboardLayoutValues = Object.values(dashboardLayout);\n    const chartLayoutItem = dashboardLayoutValues.find(\n      layoutItem => layoutItem?.meta?.chartId === chartId,\n    );\n    crossFilterIndicators = Object.values(chartConfiguration)\n      .filter(\n        chartConfig =>\n          !chartConfig.crossFilters.scope.excluded.includes(chartId) &&\n          chartConfig.crossFilters.scope.rootPath.some(\n            elementId =>\n              chartLayoutItem?.type === CHART_TYPE &&\n              chartLayoutItem?.parents?.includes(elementId),\n          ),\n      )\n      .map(chartConfig => {\n        const filterState = dataMask[chartConfig.id]?.filterState;\n        const label = extractLabel(filterState);\n        const filtersState = filterState?.filters;\n        const column = filtersState && Object.keys(filtersState)[0];\n\n        const dashboardLayoutItem = dashboardLayoutValues.find(\n          layoutItem => layoutItem?.meta?.chartId === chartConfig.id,\n        );\n        return {\n          column,\n          name: dashboardLayoutItem?.meta?.sliceName as string,\n          path: [\n            ...(dashboardLayoutItem?.parents ?? []),\n            dashboardLayoutItem?.id,\n          ],\n          status: getStatus({\n            label,\n            type: DataMaskType.CrossFilters,\n          }),\n          value: label,\n        };\n      })\n      .filter(filter => filter.status === IndicatorStatus.CrossFilterApplied);\n  }\n  const indicators = crossFilterIndicators.concat(nativeFilterIndicators);\n  cachedNativeIndicatorsForChart[chartId] = indicators;\n  cachedNativeFilterDataForChart[chartId] = {\n    nativeFilters,\n    dashboardLayout,\n    chartConfiguration,\n    dataMask,\n    appliedColumns,\n    rejectedColumns,\n  };\n  return indicators;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { uniqWith } from 'lodash';\nimport cx from 'classnames';\nimport { DataMaskStateWithId, Filters } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { usePrevious } from 'src/hooks/usePrevious';\nimport DetailsPanelPopover from './DetailsPanel';\nimport { Pill } from './Styles';\nimport {\n  Indicator,\n  IndicatorStatus,\n  selectIndicatorsForChart,\n  selectNativeIndicatorsForChart,\n} from './selectors';\nimport { setDirectPathToChild } from '../../actions/dashboardState';\nimport {\n  ChartsState,\n  DashboardInfo,\n  DashboardLayout,\n  RootState,\n} from '../../types';\n\nexport interface FiltersBadgeProps {\n  chartId: number;\n}\n\nconst sortByStatus = (indicators: Indicator[]): Indicator[] => {\n  const statuses = [\n    IndicatorStatus.Applied,\n    IndicatorStatus.Unset,\n    IndicatorStatus.Incompatible,\n  ];\n  return indicators.sort(\n    (a, b) =>\n      statuses.indexOf(a.status as IndicatorStatus) -\n      statuses.indexOf(b.status as IndicatorStatus),\n  );\n};\n\nconst indicatorsInitialState: Indicator[] = [];\n\nexport const FiltersBadge = ({ chartId }: FiltersBadgeProps) => {\n  const dispatch = useDispatch();\n  const datasources = useSelector<RootState, any>(state => state.datasources);\n  const dashboardFilters = useSelector<RootState, any>(\n    state => state.dashboardFilters,\n  );\n  const nativeFilters = useSelector<RootState, Filters>(\n    state => state.nativeFilters?.filters,\n  );\n  const dashboardInfo = useSelector<RootState, DashboardInfo>(\n    state => state.dashboardInfo,\n  );\n  const charts = useSelector<RootState, ChartsState>(state => state.charts);\n  const present = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const dataMask = useSelector<RootState, DataMaskStateWithId>(\n    state => state.dataMask,\n  );\n\n  const [nativeIndicators, setNativeIndicators] = useState<Indicator[]>(\n    indicatorsInitialState,\n  );\n  const [dashboardIndicators, setDashboardIndicators] = useState<Indicator[]>(\n    indicatorsInitialState,\n  );\n\n  const onHighlightFilterSource = useCallback(\n    (path: string[]) => {\n      dispatch(setDirectPathToChild(path));\n    },\n    [dispatch],\n  );\n\n  const chart = charts[chartId];\n  const prevChart = usePrevious(chart);\n  const prevChartStatus = prevChart?.chartStatus;\n  const prevDashboardFilters = usePrevious(dashboardFilters);\n  const prevDatasources = usePrevious(datasources);\n  const showIndicators =\n    chart?.chartStatus && ['rendered', 'success'].includes(chart.chartStatus);\n\n  useEffect(() => {\n    if (!showIndicators && dashboardIndicators.length > 0) {\n      setDashboardIndicators(indicatorsInitialState);\n    } else if (prevChartStatus !== 'success') {\n      if (\n        chart?.queriesResponse?.[0]?.rejected_filters !==\n          prevChart?.queriesResponse?.[0]?.rejected_filters ||\n        chart?.queriesResponse?.[0]?.applied_filters !==\n          prevChart?.queriesResponse?.[0]?.applied_filters ||\n        dashboardFilters !== prevDashboardFilters ||\n        datasources !== prevDatasources\n      ) {\n        setDashboardIndicators(\n          selectIndicatorsForChart(\n            chartId,\n            dashboardFilters,\n            datasources,\n            chart,\n          ),\n        );\n      }\n    }\n  }, [\n    chart,\n    chartId,\n    dashboardFilters,\n    dashboardIndicators.length,\n    datasources,\n    prevChart?.queriesResponse,\n    prevChartStatus,\n    prevDashboardFilters,\n    prevDatasources,\n    showIndicators,\n  ]);\n\n  const prevNativeFilters = usePrevious(nativeFilters);\n  const prevDashboardLayout = usePrevious(present);\n  const prevDataMask = usePrevious(dataMask);\n  const prevChartConfig = usePrevious(\n    dashboardInfo.metadata?.chart_configuration,\n  );\n  useEffect(() => {\n    if (!showIndicators && nativeIndicators.length > 0) {\n      setNativeIndicators(indicatorsInitialState);\n    } else if (prevChartStatus !== 'success') {\n      if (\n        chart?.queriesResponse?.[0]?.rejected_filters !==\n          prevChart?.queriesResponse?.[0]?.rejected_filters ||\n        chart?.queriesResponse?.[0]?.applied_filters !==\n          prevChart?.queriesResponse?.[0]?.applied_filters ||\n        nativeFilters !== prevNativeFilters ||\n        present !== prevDashboardLayout ||\n        dataMask !== prevDataMask ||\n        prevChartConfig !== dashboardInfo.metadata?.chart_configuration\n      ) {\n        setNativeIndicators(\n          selectNativeIndicatorsForChart(\n            nativeFilters,\n            dataMask,\n            chartId,\n            chart,\n            present,\n            dashboardInfo.metadata?.chart_configuration,\n          ),\n        );\n      }\n    }\n  }, [\n    chart,\n    chartId,\n    dashboardInfo.metadata?.chart_configuration,\n    dataMask,\n    nativeFilters,\n    nativeIndicators.length,\n    present,\n    prevChart?.queriesResponse,\n    prevChartConfig,\n    prevChartStatus,\n    prevDashboardLayout,\n    prevDataMask,\n    prevNativeFilters,\n    showIndicators,\n  ]);\n\n  const indicators = useMemo(\n    () =>\n      uniqWith(\n        sortByStatus([...dashboardIndicators, ...nativeIndicators]),\n        (ind1, ind2) =>\n          ind1.column === ind2.column &&\n          ind1.name === ind2.name &&\n          (ind1.status !== IndicatorStatus.Applied ||\n            ind2.status !== IndicatorStatus.Applied),\n      ),\n    [dashboardIndicators, nativeIndicators],\n  );\n\n  const appliedCrossFilterIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.CrossFilterApplied,\n      ),\n    [indicators],\n  );\n  const appliedIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.Applied,\n      ),\n    [indicators],\n  );\n  const unsetIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.Unset,\n      ),\n    [indicators],\n  );\n  const incompatibleIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.Incompatible,\n      ),\n    [indicators],\n  );\n\n  if (\n    !appliedCrossFilterIndicators.length &&\n    !appliedIndicators.length &&\n    !incompatibleIndicators.length &&\n    !unsetIndicators.length\n  ) {\n    return null;\n  }\n\n  const isInactive =\n    !appliedCrossFilterIndicators.length &&\n    !appliedIndicators.length &&\n    !incompatibleIndicators.length;\n\n  return (\n    <DetailsPanelPopover\n      appliedCrossFilterIndicators={appliedCrossFilterIndicators}\n      appliedIndicators={appliedIndicators}\n      unsetIndicators={unsetIndicators}\n      incompatibleIndicators={incompatibleIndicators}\n      onHighlightFilterSource={onHighlightFilterSource}\n    >\n      <Pill\n        className={cx(\n          'filter-counts',\n          !!incompatibleIndicators.length && 'has-incompatible-filters',\n          !!appliedCrossFilterIndicators.length && 'has-cross-filters',\n          isInactive && 'filters-inactive',\n        )}\n      >\n        <Icons.Filter iconSize=\"m\" />\n        {!isInactive && (\n          <span data-test=\"applied-filter-count\">\n            {appliedIndicators.length + appliedCrossFilterIndicators.length}\n          </span>\n        )}\n        {incompatibleIndicators.length ? (\n          <>\n            {' '}\n            <Icons.AlertSolid />\n            <span data-test=\"incompatible-filter-count\">\n              {incompatibleIndicators.length}\n            </span>\n          </>\n        ) : null}\n      </Pill>\n    </DetailsPanelPopover>\n  );\n};\n\nexport default React.memo(FiltersBadge);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, useEffect, useMemo, useRef, useState } from 'react';\nimport { styled, t } from '@superset-ui/core';\nimport { useUiConfig } from 'src/components/UiConfigContext';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { useDispatch, useSelector } from 'react-redux';\nimport EditableTitle from 'src/components/EditableTitle';\nimport SliceHeaderControls, {\n  SliceHeaderControlsProps,\n} from 'src/dashboard/components/SliceHeaderControls';\nimport FiltersBadge from 'src/dashboard/components/FiltersBadge';\nimport Icons from 'src/components/Icons';\nimport { RootState } from 'src/dashboard/types';\nimport FilterIndicator from 'src/dashboard/components/FiltersBadge/FilterIndicator';\nimport { clearDataMask } from 'src/dataMask/actions';\n\ntype SliceHeaderProps = SliceHeaderControlsProps & {\n  innerRef?: string;\n  updateSliceName?: (arg0: string) => void;\n  editMode?: boolean;\n  annotationQuery?: object;\n  annotationError?: object;\n  sliceName?: string;\n  filters: object;\n  handleToggleFullSize: () => void;\n  formData: object;\n  width: number;\n  height: number;\n};\n\nconst annotationsLoading = t('Annotation layers are still loading.');\nconst annotationsError = t('One ore more annotation layers failed loading.');\nconst CrossFilterIcon = styled(Icons.CursorTarget)`\n  cursor: pointer;\n  color: ${({ theme }) => theme.colors.primary.base};\n  height: 22px;\n  width: 22px;\n`;\n\nconst SliceHeader: FC<SliceHeaderProps> = ({\n  innerRef = null,\n  forceRefresh = () => ({}),\n  updateSliceName = () => ({}),\n  toggleExpandSlice = () => ({}),\n  logExploreChart = () => ({}),\n  onExploreChart,\n  exportCSV = () => ({}),\n  editMode = false,\n  annotationQuery = {},\n  annotationError = {},\n  cachedDttm = null,\n  updatedDttm = null,\n  isCached = [],\n  isExpanded = false,\n  sliceName = '',\n  supersetCanExplore = false,\n  supersetCanShare = false,\n  supersetCanCSV = false,\n  sliceCanEdit = false,\n  exportFullCSV,\n  slice,\n  componentId,\n  dashboardId,\n  addSuccessToast,\n  addDangerToast,\n  handleToggleFullSize,\n  isFullSize,\n  chartStatus,\n  formData,\n  width,\n  height,\n}) => {\n  const dispatch = useDispatch();\n  const uiConfig = useUiConfig();\n  const [headerTooltip, setHeaderTooltip] = useState<string | null>(null);\n  const headerRef = useRef<HTMLDivElement>(null);\n  // TODO: change to indicator field after it will be implemented\n  const crossFilterValue = useSelector<RootState, any>(\n    state => state.dataMask[slice?.slice_id]?.filterState?.value,\n  );\n\n  const indicator = useMemo(\n    () => ({\n      value: crossFilterValue,\n      name: t('Emitted values'),\n    }),\n    [crossFilterValue],\n  );\n\n  const handleClickTitle =\n    !editMode && supersetCanExplore ? onExploreChart : undefined;\n\n  useEffect(() => {\n    const headerElement = headerRef.current;\n    if (handleClickTitle) {\n      setHeaderTooltip(\n        sliceName\n          ? t('Click to edit %s in a new tab', sliceName)\n          : t('Click to edit chart in a new tab'),\n      );\n    } else if (\n      headerElement &&\n      (headerElement.scrollWidth > headerElement.offsetWidth ||\n        headerElement.scrollHeight > headerElement.offsetHeight)\n    ) {\n      setHeaderTooltip(sliceName ?? null);\n    } else {\n      setHeaderTooltip(null);\n    }\n  }, [sliceName, width, height, handleClickTitle]);\n\n  return (\n    <div className=\"chart-header\" data-test=\"slice-header\" ref={innerRef}>\n      <div className=\"header-title\" ref={headerRef}>\n        <Tooltip title={headerTooltip}>\n          <EditableTitle\n            title={\n              sliceName ||\n              (editMode\n                ? '---' // this makes an empty title clickable\n                : '')\n            }\n            canEdit={editMode}\n            emptyText=\"\"\n            onSaveTitle={updateSliceName}\n            showTooltip={false}\n            onClickTitle={handleClickTitle}\n          />\n        </Tooltip>\n        {!!Object.values(annotationQuery).length && (\n          <Tooltip\n            id=\"annotations-loading-tooltip\"\n            placement=\"top\"\n            title={annotationsLoading}\n          >\n            <i\n              role=\"img\"\n              aria-label={annotationsLoading}\n              className=\"fa fa-refresh warning\"\n            />\n          </Tooltip>\n        )}\n        {!!Object.values(annotationError).length && (\n          <Tooltip\n            id=\"annoation-errors-tooltip\"\n            placement=\"top\"\n            title={annotationsError}\n          >\n            <i\n              role=\"img\"\n              aria-label={annotationsError}\n              className=\"fa fa-exclamation-circle danger\"\n            />\n          </Tooltip>\n        )}\n      </div>\n      <div className=\"header-controls\">\n        {!editMode && (\n          <>\n            {crossFilterValue && (\n              <Tooltip\n                placement=\"top\"\n                title={\n                  <FilterIndicator\n                    indicator={indicator}\n                    text={t('Click to clear emitted filters')}\n                  />\n                }\n              >\n                <CrossFilterIcon\n                  onClick={() => dispatch(clearDataMask(slice?.slice_id))}\n                />\n              </Tooltip>\n            )}\n            {!uiConfig.hideChartControls && (\n              <FiltersBadge chartId={slice.slice_id} />\n            )}\n            {!uiConfig.hideChartControls && (\n              <SliceHeaderControls\n                slice={slice}\n                isCached={isCached}\n                isExpanded={isExpanded}\n                cachedDttm={cachedDttm}\n                updatedDttm={updatedDttm}\n                toggleExpandSlice={toggleExpandSlice}\n                forceRefresh={forceRefresh}\n                logExploreChart={logExploreChart}\n                onExploreChart={onExploreChart}\n                exportCSV={exportCSV}\n                exportFullCSV={exportFullCSV}\n                supersetCanExplore={supersetCanExplore}\n                supersetCanShare={supersetCanShare}\n                supersetCanCSV={supersetCanCSV}\n                sliceCanEdit={sliceCanEdit}\n                componentId={componentId}\n                dashboardId={dashboardId}\n                addSuccessToast={addSuccessToast}\n                addDangerToast={addDangerToast}\n                handleToggleFullSize={handleToggleFullSize}\n                isFullSize={isFullSize}\n                isDescriptionExpanded={isExpanded}\n                chartStatus={chartStatus}\n                formData={formData}\n              />\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SliceHeader;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nconst propTypes = {\n  height: PropTypes.number.isRequired,\n};\n\nexport default function MissingChart({ height }) {\n  return (\n    <div className=\"missing-chart-container\" style={{ height: height + 20 }}>\n      <div className=\"missing-chart-body\">\n        {t(\n          'There is no chart definition associated with this component, could it have been deleted?',\n        )}\n        <br />\n        <br />\n        {t('Delete this container and save to remove this message.')}\n      </div>\n    </div>\n  );\n}\n\nMissingChart.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport cx from 'classnames';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, t, logging } from '@superset-ui/core';\nimport { isEqual } from 'lodash';\n\nimport { exportChart, mountExploreUrl } from 'src/explore/exploreUtils';\nimport ChartContainer from 'src/components/Chart/ChartContainer';\nimport {\n  LOG_ACTIONS_CHANGE_DASHBOARD_FILTER,\n  LOG_ACTIONS_EXPLORE_DASHBOARD_CHART,\n  LOG_ACTIONS_EXPORT_CSV_DASHBOARD_CHART,\n  LOG_ACTIONS_FORCE_REFRESH_CHART,\n} from 'src/logger/LogUtils';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\nimport { postFormData } from 'src/explore/exploreUtils/formData';\nimport { URL_PARAMS } from 'src/constants';\n\nimport SliceHeader from '../SliceHeader';\nimport MissingChart from '../MissingChart';\nimport { slicePropShape, chartPropShape } from '../../util/propShapes';\n\nimport { isFilterBox } from '../../util/activeDashboardFilters';\nimport getFilterValuesByFilterId from '../../util/getFilterValuesByFilterId';\n\nconst propTypes = {\n  id: PropTypes.number.isRequired,\n  componentId: PropTypes.string.isRequired,\n  dashboardId: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  updateSliceName: PropTypes.func.isRequired,\n  isComponentVisible: PropTypes.bool,\n  handleToggleFullSize: PropTypes.func.isRequired,\n  setControlValue: PropTypes.func,\n\n  // from redux\n  chart: chartPropShape.isRequired,\n  formData: PropTypes.object.isRequired,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  datasource: PropTypes.object,\n  slice: slicePropShape.isRequired,\n  sliceName: PropTypes.string.isRequired,\n  timeout: PropTypes.number.isRequired,\n  maxRows: PropTypes.number.isRequired,\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES,\n  // all active filter fields in dashboard\n  filters: PropTypes.object.isRequired,\n  refreshChart: PropTypes.func.isRequired,\n  logEvent: PropTypes.func.isRequired,\n  toggleExpandSlice: PropTypes.func.isRequired,\n  changeFilter: PropTypes.func.isRequired,\n  setFocusedFilterField: PropTypes.func.isRequired,\n  unsetFocusedFilterField: PropTypes.func.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  isExpanded: PropTypes.bool.isRequired,\n  isCached: PropTypes.bool,\n  supersetCanExplore: PropTypes.bool.isRequired,\n  supersetCanShare: PropTypes.bool.isRequired,\n  supersetCanCSV: PropTypes.bool.isRequired,\n  sliceCanEdit: PropTypes.bool.isRequired,\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  ownState: PropTypes.object,\n  filterState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  datasetsStatus: PropTypes.oneOf(['loading', 'error', 'complete']),\n};\n\nconst defaultProps = {\n  isCached: false,\n  isComponentVisible: true,\n};\n\n// we use state + shouldComponentUpdate() logic to prevent perf-wrecking\n// resizing across all slices on a dashboard on every update\nconst RESIZE_TIMEOUT = 350;\nconst SHOULD_UPDATE_ON_PROP_CHANGES = Object.keys(propTypes).filter(\n  prop =>\n    prop !== 'width' && prop !== 'height' && prop !== 'isComponentVisible',\n);\nconst OVERFLOWABLE_VIZ_TYPES = new Set(['filter_box']);\nconst DEFAULT_HEADER_HEIGHT = 22;\n\nconst ChartOverlay = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 5;\n\n  &.is-deactivated {\n    opacity: 0.5;\n    background-color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n`;\n\nconst SliceContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n`;\n\nexport default class Chart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      width: props.width,\n      height: props.height,\n      descriptionHeight: 0,\n    };\n\n    this.changeFilter = this.changeFilter.bind(this);\n    this.handleFilterMenuOpen = this.handleFilterMenuOpen.bind(this);\n    this.handleFilterMenuClose = this.handleFilterMenuClose.bind(this);\n    this.exportCSV = this.exportCSV.bind(this);\n    this.exportFullCSV = this.exportFullCSV.bind(this);\n    this.forceRefresh = this.forceRefresh.bind(this);\n    this.resize = this.resize.bind(this);\n    this.setDescriptionRef = this.setDescriptionRef.bind(this);\n    this.setHeaderRef = this.setHeaderRef.bind(this);\n    this.getChartHeight = this.getChartHeight.bind(this);\n    this.getDescriptionHeight = this.getDescriptionHeight.bind(this);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    // this logic mostly pertains to chart resizing. we keep a copy of the dimensions in\n    // state so that we can buffer component size updates and only update on the final call\n    // which improves performance significantly\n    if (\n      nextState.width !== this.state.width ||\n      nextState.height !== this.state.height ||\n      nextState.descriptionHeight !== this.state.descriptionHeight ||\n      !isEqual(nextProps.datasource, this.props.datasource)\n    ) {\n      return true;\n    }\n\n    // allow chart update/re-render only if visible:\n    // under selected tab or no tab layout\n    if (nextProps.isComponentVisible) {\n      if (nextProps.chart.triggerQuery) {\n        return true;\n      }\n\n      if (nextProps.isFullSize !== this.props.isFullSize) {\n        clearTimeout(this.resizeTimeout);\n        this.resizeTimeout = setTimeout(this.resize, RESIZE_TIMEOUT);\n        return false;\n      }\n\n      if (\n        nextProps.width !== this.props.width ||\n        nextProps.height !== this.props.height\n      ) {\n        clearTimeout(this.resizeTimeout);\n        this.resizeTimeout = setTimeout(this.resize, RESIZE_TIMEOUT);\n      }\n\n      for (let i = 0; i < SHOULD_UPDATE_ON_PROP_CHANGES.length; i += 1) {\n        const prop = SHOULD_UPDATE_ON_PROP_CHANGES[i];\n        // use deep objects equality comparison to prevent\n        // unneccessary updates when objects references change\n        if (!areObjectsEqual(nextProps[prop], this.props[prop])) {\n          return true;\n        }\n      }\n    }\n\n    // `cacheBusterProp` is jected by react-hot-loader\n    return this.props.cacheBusterProp !== nextProps.cacheBusterProp;\n  }\n\n  componentDidMount() {\n    if (this.props.isExpanded) {\n      const descriptionHeight = this.getDescriptionHeight();\n      this.setState({ descriptionHeight });\n    }\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.resizeTimeout);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.isExpanded !== prevProps.isExpanded) {\n      const descriptionHeight = this.getDescriptionHeight();\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ descriptionHeight });\n    }\n  }\n\n  getDescriptionHeight() {\n    return this.props.isExpanded && this.descriptionRef\n      ? this.descriptionRef.offsetHeight\n      : 0;\n  }\n\n  getChartHeight() {\n    const headerHeight = this.getHeaderHeight();\n    return Math.max(\n      this.state.height - headerHeight - this.state.descriptionHeight,\n      20,\n    );\n  }\n\n  getHeaderHeight() {\n    if (this.headerRef) {\n      const computedStyle = getComputedStyle(this.headerRef).getPropertyValue(\n        'margin-bottom',\n      );\n      const marginBottom = parseInt(computedStyle, 10) || 0;\n      return this.headerRef.offsetHeight + marginBottom;\n    }\n    return DEFAULT_HEADER_HEIGHT;\n  }\n\n  setDescriptionRef(ref) {\n    this.descriptionRef = ref;\n  }\n\n  setHeaderRef(ref) {\n    this.headerRef = ref;\n  }\n\n  resize() {\n    const { width, height } = this.props;\n    this.setState(() => ({ width, height }));\n  }\n\n  changeFilter(newSelectedValues = {}) {\n    this.props.logEvent(LOG_ACTIONS_CHANGE_DASHBOARD_FILTER, {\n      id: this.props.chart.id,\n      columns: Object.keys(newSelectedValues),\n    });\n    this.props.changeFilter(this.props.chart.id, newSelectedValues);\n  }\n\n  handleFilterMenuOpen(chartId, column) {\n    this.props.setFocusedFilterField(chartId, column);\n  }\n\n  handleFilterMenuClose(chartId, column) {\n    this.props.unsetFocusedFilterField(chartId, column);\n  }\n\n  logExploreChart = () => {\n    this.props.logEvent(LOG_ACTIONS_EXPLORE_DASHBOARD_CHART, {\n      slice_id: this.props.slice.slice_id,\n      is_cached: this.props.isCached,\n    });\n  };\n\n  onExploreChart = async () => {\n    try {\n      const lastTabId = window.localStorage.getItem('last_tab_id');\n      const nextTabId = lastTabId\n        ? String(Number.parseInt(lastTabId, 10) + 1)\n        : undefined;\n      const key = await postFormData(\n        this.props.datasource.id,\n        this.props.datasource.type,\n        this.props.formData,\n        this.props.slice.slice_id,\n        nextTabId,\n      );\n      const url = mountExploreUrl(null, {\n        [URL_PARAMS.formDataKey.name]: key,\n        [URL_PARAMS.sliceId.name]: this.props.slice.slice_id,\n      });\n      window.open(url, '_blank', 'noreferrer');\n    } catch (error) {\n      logging.error(error);\n      this.props.addDangerToast(t('An error occurred while opening Explore'));\n    }\n  };\n\n  exportCSV(isFullCSV = false) {\n    this.props.logEvent(LOG_ACTIONS_EXPORT_CSV_DASHBOARD_CHART, {\n      slice_id: this.props.slice.slice_id,\n      is_cached: this.props.isCached,\n    });\n    exportChart({\n      formData: isFullCSV\n        ? { ...this.props.formData, row_limit: this.props.maxRows }\n        : this.props.formData,\n      resultType: 'full',\n      resultFormat: 'csv',\n      force: true,\n      ownState: this.props.ownState,\n    });\n  }\n\n  exportFullCSV() {\n    this.exportCSV(true);\n  }\n\n  forceRefresh() {\n    this.props.logEvent(LOG_ACTIONS_FORCE_REFRESH_CHART, {\n      slice_id: this.props.slice.slice_id,\n      is_cached: this.props.isCached,\n    });\n    return this.props.refreshChart(\n      this.props.chart.id,\n      true,\n      this.props.dashboardId,\n    );\n  }\n\n  render() {\n    const {\n      id,\n      componentId,\n      dashboardId,\n      chart,\n      slice,\n      datasource,\n      isExpanded,\n      editMode,\n      filters,\n      formData,\n      labelColors,\n      sharedLabelColors,\n      updateSliceName,\n      sliceName,\n      toggleExpandSlice,\n      timeout,\n      supersetCanExplore,\n      supersetCanShare,\n      supersetCanCSV,\n      sliceCanEdit,\n      addSuccessToast,\n      addDangerToast,\n      ownState,\n      filterState,\n      handleToggleFullSize,\n      isFullSize,\n      setControlValue,\n      filterboxMigrationState,\n      postTransformProps,\n      datasetsStatus,\n    } = this.props;\n\n    const { width } = this.state;\n    // this prevents throwing in the case that a gridComponent\n    // references a chart that is not associated with the dashboard\n    if (!chart || !slice) {\n      return <MissingChart height={this.getChartHeight()} />;\n    }\n\n    const { queriesResponse, chartUpdateEndTime, chartStatus } = chart;\n    const isLoading = chartStatus === 'loading';\n    const isDeactivatedViz =\n      slice.viz_type === 'filter_box' &&\n      [\n        FILTER_BOX_MIGRATION_STATES.REVIEWING,\n        FILTER_BOX_MIGRATION_STATES.CONVERTED,\n      ].includes(filterboxMigrationState);\n    // eslint-disable-next-line camelcase\n    const isCached = queriesResponse?.map(({ is_cached }) => is_cached) || [];\n    const cachedDttm =\n      // eslint-disable-next-line camelcase\n      queriesResponse?.map(({ cached_dttm }) => cached_dttm) || [];\n    const isOverflowable = OVERFLOWABLE_VIZ_TYPES.has(slice.viz_type);\n    const initialValues = isFilterBox(id)\n      ? getFilterValuesByFilterId({\n          activeFilters: filters,\n          filterId: id,\n        })\n      : {};\n    return (\n      <SliceContainer\n        className=\"chart-slice\"\n        data-test=\"chart-grid-component\"\n        data-test-chart-id={id}\n        data-test-viz-type={slice.viz_type}\n        data-test-chart-name={slice.slice_name}\n      >\n        <SliceHeader\n          innerRef={this.setHeaderRef}\n          slice={slice}\n          isExpanded={isExpanded}\n          isCached={isCached}\n          cachedDttm={cachedDttm}\n          updatedDttm={chartUpdateEndTime}\n          toggleExpandSlice={toggleExpandSlice}\n          forceRefresh={this.forceRefresh}\n          editMode={editMode}\n          annotationQuery={chart.annotationQuery}\n          logExploreChart={this.logExploreChart}\n          onExploreChart={this.onExploreChart}\n          exportCSV={this.exportCSV}\n          exportFullCSV={this.exportFullCSV}\n          updateSliceName={updateSliceName}\n          sliceName={sliceName}\n          supersetCanExplore={supersetCanExplore}\n          supersetCanShare={supersetCanShare}\n          supersetCanCSV={supersetCanCSV}\n          sliceCanEdit={sliceCanEdit}\n          componentId={componentId}\n          dashboardId={dashboardId}\n          filters={filters}\n          addSuccessToast={addSuccessToast}\n          addDangerToast={addDangerToast}\n          handleToggleFullSize={handleToggleFullSize}\n          isFullSize={isFullSize}\n          chartStatus={chart.chartStatus}\n          formData={formData}\n          width={width}\n          height={this.getHeaderHeight()}\n        />\n\n        {/*\n          This usage of dangerouslySetInnerHTML is safe since it is being used to render\n          markdown that is sanitized with bleach. See:\n             https://github.com/apache/superset/pull/4390\n          and\n             https://github.com/apache/superset/commit/b6fcc22d5a2cb7a5e92599ed5795a0169385a825\n        */}\n        {isExpanded && slice.description_markeddown && (\n          <div\n            className=\"slice_description bs-callout bs-callout-default\"\n            ref={this.setDescriptionRef}\n            // eslint-disable-next-line react/no-danger\n            dangerouslySetInnerHTML={{ __html: slice.description_markeddown }}\n          />\n        )}\n\n        <div\n          className={cx(\n            'dashboard-chart',\n            isOverflowable && 'dashboard-chart--overflowable',\n          )}\n        >\n          {(isLoading || isDeactivatedViz) && (\n            <ChartOverlay\n              className={cx(isDeactivatedViz && 'is-deactivated')}\n              style={{\n                width,\n                height: this.getChartHeight(),\n              }}\n            />\n          )}\n          <ChartContainer\n            width={width}\n            height={this.getChartHeight()}\n            addFilter={this.changeFilter}\n            onFilterMenuOpen={this.handleFilterMenuOpen}\n            onFilterMenuClose={this.handleFilterMenuClose}\n            annotationData={chart.annotationData}\n            chartAlert={chart.chartAlert}\n            chartId={id}\n            chartStatus={chartStatus}\n            datasource={datasource}\n            dashboardId={dashboardId}\n            initialValues={initialValues}\n            formData={formData}\n            labelColors={labelColors}\n            sharedLabelColors={sharedLabelColors}\n            ownState={ownState}\n            filterState={filterState}\n            queriesResponse={chart.queriesResponse}\n            timeout={timeout}\n            triggerQuery={chart.triggerQuery}\n            vizType={slice.viz_type}\n            setControlValue={setControlValue}\n            isDeactivatedViz={isDeactivatedViz}\n            filterboxMigrationState={filterboxMigrationState}\n            postTransformProps={postTransformProps}\n            datasetsStatus={datasetsStatus}\n          />\n        </div>\n      </SliceContainer>\n    );\n  }\n}\n\nChart.propTypes = propTypes;\nChart.defaultProps = defaultProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getChartIdAndColumnFromFilterKey } from './getDashboardFilterKey';\n\n// input: { [id_column1]: values, [id_column2]: values }\n// output: { column1: values, column2: values }\nexport default function getFilterValuesByFilterId({\n  activeFilters = {},\n  filterId,\n}) {\n  return Object.entries(activeFilters).reduce((map, entry) => {\n    const [filterKey, { values }] = entry;\n    const { chartId, column } = getChartIdAndColumnFromFilterKey(filterKey);\n    if (chartId === filterId) {\n      return {\n        ...map,\n        [column]: values,\n      };\n    }\n    return map;\n  }, {});\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport {\n  toggleExpandSlice,\n  setFocusedFilterField,\n  unsetFocusedFilterField,\n} from 'src/dashboard/actions/dashboardState';\nimport { updateComponents } from 'src/dashboard/actions/dashboardLayout';\nimport { changeFilter } from 'src/dashboard/actions/dashboardFilters';\nimport {\n  addSuccessToast,\n  addDangerToast,\n} from 'src/components/MessageToasts/actions';\nimport { refreshChart } from 'src/components/Chart/chartAction';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  getActiveFilters,\n  getAppliedFilterValues,\n} from 'src/dashboard/util/activeDashboardFilters';\nimport getFormDataWithExtraFilters from 'src/dashboard/util/charts/getFormDataWithExtraFilters';\nimport Chart from 'src/dashboard/components/gridComponents/Chart';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\n\nconst EMPTY_OBJECT = {};\n\nfunction mapStateToProps(\n  {\n    charts: chartQueries,\n    dashboardInfo,\n    dashboardState,\n    dashboardLayout,\n    dataMask,\n    datasources,\n    sliceEntities,\n    nativeFilters,\n    common,\n  },\n  ownProps,\n) {\n  const { id, extraControls, setControlValue } = ownProps;\n  const chart = chartQueries[id] || EMPTY_OBJECT;\n  const datasource =\n    (chart && chart.form_data && datasources[chart.form_data.datasource]) ||\n    PLACEHOLDER_DATASOURCE;\n  const { colorScheme, colorNamespace, datasetsStatus } = dashboardState;\n  const labelColors = dashboardInfo?.metadata?.label_colors || {};\n  const sharedLabelColors = dashboardInfo?.metadata?.shared_label_colors || {};\n  // note: this method caches filters if possible to prevent render cascades\n  const formData = getFormDataWithExtraFilters({\n    layout: dashboardLayout.present,\n    chart,\n    // eslint-disable-next-line camelcase\n    chartConfiguration: dashboardInfo.metadata?.chart_configuration,\n    charts: chartQueries,\n    filters: getAppliedFilterValues(id),\n    colorScheme,\n    colorNamespace,\n    sliceId: id,\n    nativeFilters,\n    dataMask,\n    extraControls,\n    labelColors,\n    sharedLabelColors,\n  });\n\n  formData.dashboardId = dashboardInfo.id;\n\n  return {\n    chart,\n    datasource,\n    labelColors,\n    sharedLabelColors,\n    slice: sliceEntities.slices[id],\n    timeout: dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT,\n    filters: getActiveFilters() || EMPTY_OBJECT,\n    formData,\n    editMode: dashboardState.editMode,\n    isExpanded: !!dashboardState.expandedSlices[id],\n    supersetCanExplore: !!dashboardInfo.superset_can_explore,\n    supersetCanShare: !!dashboardInfo.superset_can_share,\n    supersetCanCSV: !!dashboardInfo.superset_can_csv,\n    sliceCanEdit: !!dashboardInfo.slice_can_edit,\n    ownState: dataMask[id]?.ownState,\n    filterState: dataMask[id]?.filterState,\n    maxRows: common.conf.SQL_MAX_ROW,\n    setControlValue,\n    filterboxMigrationState: dashboardState.filterboxMigrationState,\n    datasetsStatus,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      updateComponents,\n      addSuccessToast,\n      addDangerToast,\n      toggleExpandSlice,\n      changeFilter,\n      setFocusedFilterField,\n      unsetFocusedFilterField,\n      refreshChart,\n      logEvent,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chart);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { t } from '@superset-ui/core';\nimport Popover, { PopoverProps } from 'src/components/Popover';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { getDashboardPermalink, getUrlParam } from 'src/utils/urlUtils';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { URL_PARAMS } from 'src/constants';\nimport { getFilterValue } from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\n\nexport type URLShortLinkButtonProps = {\n  dashboardId: number;\n  anchorLinkId?: string;\n  emailSubject?: string;\n  emailContent?: string;\n  placement?: PopoverProps['placement'];\n};\n\nexport default function URLShortLinkButton({\n  dashboardId,\n  anchorLinkId,\n  placement = 'right',\n  emailContent = '',\n  emailSubject = '',\n}: URLShortLinkButtonProps) {\n  const [shortUrl, setShortUrl] = useState('');\n  const { addDangerToast } = useToasts();\n\n  const getCopyUrl = async () => {\n    const nativeFiltersKey = getUrlParam(URL_PARAMS.nativeFiltersKey);\n    try {\n      const filterState = await getFilterValue(dashboardId, nativeFiltersKey);\n      const url = await getDashboardPermalink({\n        dashboardId,\n        filterState,\n        hash: anchorLinkId,\n      });\n      setShortUrl(url);\n    } catch (error) {\n      addDangerToast(error);\n    }\n  };\n\n  const emailBody = `${emailContent}${shortUrl || ''}`;\n  const emailLink = `mailto:?Subject=${emailSubject}%20&Body=${emailBody}`;\n\n  return (\n    <Popover\n      trigger=\"click\"\n      placement={placement}\n      content={\n        <div id=\"shorturl-popover\" data-test=\"shorturl-popover\">\n          <CopyToClipboard\n            text={shortUrl}\n            copyNode={\n              <i className=\"fa fa-clipboard\" title={t('Copy to clipboard')} />\n            }\n          />\n          &nbsp;&nbsp;\n          <a href={emailLink}>\n            <i className=\"fa fa-envelope\" />\n          </a>\n        </div>\n      }\n    >\n      <span\n        className=\"short-link-trigger btn btn-default btn-sm\"\n        tabIndex={0}\n        role=\"button\"\n        onClick={e => {\n          e.stopPropagation();\n          getCopyUrl();\n        }}\n      >\n        <i className=\"short-link-trigger fa fa-link\" />\n        &nbsp;\n      </span>\n    </Popover>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect } from 'react';\nimport { t } from '@superset-ui/core';\n\nimport URLShortLinkButton, {\n  URLShortLinkButtonProps,\n} from 'src/dashboard/components/URLShortLinkButton';\nimport getLocationHash from 'src/dashboard/util/getLocationHash';\n\nexport type AnchorLinkProps = {\n  id: string;\n  scrollIntoView?: boolean;\n  showShortLinkButton?: boolean;\n} & Pick<URLShortLinkButtonProps, 'dashboardId' | 'placement'>;\n\nexport default function AnchorLink({\n  id,\n  dashboardId,\n  placement = 'right',\n  scrollIntoView = false,\n  showShortLinkButton = true,\n}: AnchorLinkProps) {\n  const scrollAnchorIntoView = (elementId: string) => {\n    const element = document.getElementById(elementId);\n    if (element) {\n      element.scrollIntoView({\n        block: 'center',\n        behavior: 'smooth',\n      });\n    }\n  };\n\n  // will always scroll element into view if element id and url hash match\n  const hash = getLocationHash();\n  useEffect(() => {\n    if (hash && id === hash) {\n      scrollAnchorIntoView(id);\n    }\n  }, [hash, id]);\n\n  // force scroll into view\n  useEffect(() => {\n    if (scrollIntoView) {\n      scrollAnchorIntoView(id);\n    }\n  }, [id, scrollIntoView]);\n\n  return (\n    <span className=\"anchor-link-container\" id={id}>\n      {showShortLinkButton && dashboardId && (\n        <URLShortLinkButton\n          anchorLinkId={id}\n          dashboardId={dashboardId}\n          emailSubject={t('Superset chart')}\n          emailContent={t('Check out this chart in dashboard:')}\n          placement={placement}\n        />\n      )}\n    </span>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { MouseEventHandler } from 'react';\nimport Icons from 'src/components/Icons';\nimport IconButton from './IconButton';\n\ntype DeleteComponentButtonProps = {\n  onDelete: MouseEventHandler<HTMLDivElement>;\n};\n\nconst DeleteComponentButton: React.FC<DeleteComponentButtonProps> = ({\n  onDelete,\n}) => <IconButton onClick={onDelete} icon={<Icons.Trash iconSize=\"xl\" />} />;\n\nexport default DeleteComponentButton;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport { styled } from '@superset-ui/core';\nimport cx from 'classnames';\n\ninterface HoverMenuProps {\n  position: 'left' | 'top';\n  innerRef: RefObject<HTMLDivElement>;\n  children: React.ReactNode;\n}\n\nconst HoverStyleOverrides = styled.div`\n  .hover-menu {\n    opacity: 0;\n    position: absolute;\n    z-index: 10;\n    font-size: ${({ theme }) => theme.typography.sizes.m};\n  }\n\n  .hover-menu--left {\n    width: ${({ theme }) => theme.gridUnit * 6}px;\n    top: 50%;\n    transform: translate(0, -50%);\n    left: ${({ theme }) => theme.gridUnit * -7}px;\n    padding: ${({ theme }) => theme.gridUnit * 2}px 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .hover-menu--left > :nth-child(n):not(:only-child):not(:last-child) {\n    margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  }\n\n  .hover-menu--top {\n    height: ${({ theme }) => theme.gridUnit * 6}px;\n    top: ${({ theme }) => theme.gridUnit * -6}px;\n    left: 50%;\n    transform: translate(-50%);\n    padding: 0 ${({ theme }) => theme.gridUnit * 2}px;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\nexport default class HoverMenu extends React.PureComponent<HoverMenuProps> {\n  static defaultProps = {\n    position: 'left',\n    innerRef: null,\n    children: null,\n  };\n\n  render() {\n    const { innerRef, position, children } = this.props;\n    return (\n      <HoverStyleOverrides className=\"hover-menu-container\">\n        <div\n          ref={innerRef}\n          className={cx(\n            'hover-menu',\n            position === 'left' && 'hover-menu--left',\n            position === 'top' && 'hover-menu--top',\n          )}\n        >\n          {children}\n        </div>\n      </HoverStyleOverrides>\n    );\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\n\nexport function BottomRightResizeHandle() {\n  return <div className=\"resize-handle resize-handle--bottom-right\" />;\n}\n\nexport function RightResizeHandle() {\n  return <div className=\"resize-handle resize-handle--right\" />;\n}\n\nexport function BottomResizeHandle() {\n  return <div className=\"resize-handle resize-handle--bottom\" />;\n}\n\nexport default {\n  right: RightResizeHandle,\n  bottom: BottomResizeHandle,\n  bottomRight: BottomRightResizeHandle,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n// config for a ResizableContainer\nconst adjustableWidthAndHeight = {\n  top: false,\n  right: true,\n  bottom: true,\n  left: false,\n  topRight: false,\n  bottomRight: true,\n  bottomLeft: false,\n  topLeft: false,\n};\n\nconst adjustableWidth = {\n  ...adjustableWidthAndHeight,\n  bottomRight: false,\n  bottom: false,\n};\n\nconst adjustableHeight = {\n  ...adjustableWidthAndHeight,\n  bottomRight: false,\n  right: false,\n};\n\nconst notAdjustable = {\n  ...adjustableWidthAndHeight,\n  bottomRight: false,\n  bottom: false,\n  right: false,\n};\n\nexport default {\n  widthAndHeight: adjustableWidthAndHeight,\n  widthOnly: adjustableWidth,\n  heightOnly: adjustableHeight,\n  notAdjustable,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Resizable } from 're-resizable';\nimport cx from 'classnames';\n\nimport ResizableHandle from './ResizableHandle';\nimport resizableConfig from '../../util/resizableConfig';\nimport { GRID_BASE_UNIT, GRID_GUTTER_SIZE } from '../../util/constants';\n\nconst proxyToInfinity = Number.MAX_VALUE;\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  children: PropTypes.node,\n  adjustableWidth: PropTypes.bool,\n  adjustableHeight: PropTypes.bool,\n  gutterWidth: PropTypes.number,\n  widthStep: PropTypes.number,\n  heightStep: PropTypes.number,\n  widthMultiple: PropTypes.number,\n  heightMultiple: PropTypes.number,\n  minWidthMultiple: PropTypes.number,\n  maxWidthMultiple: PropTypes.number,\n  minHeightMultiple: PropTypes.number,\n  maxHeightMultiple: PropTypes.number,\n  staticHeight: PropTypes.number,\n  staticHeightMultiple: PropTypes.number,\n  staticWidth: PropTypes.number,\n  staticWidthMultiple: PropTypes.number,\n  onResizeStop: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStart: PropTypes.func,\n  editMode: PropTypes.bool.isRequired,\n};\n\nconst defaultProps = {\n  children: null,\n  adjustableWidth: true,\n  adjustableHeight: true,\n  gutterWidth: GRID_GUTTER_SIZE,\n  widthStep: GRID_BASE_UNIT,\n  heightStep: GRID_BASE_UNIT,\n  widthMultiple: null,\n  heightMultiple: null,\n  minWidthMultiple: 1,\n  maxWidthMultiple: proxyToInfinity,\n  minHeightMultiple: 1,\n  maxHeightMultiple: proxyToInfinity,\n  staticHeight: null,\n  staticHeightMultiple: null,\n  staticWidth: null,\n  staticWidthMultiple: null,\n  onResizeStop: null,\n  onResize: null,\n  onResizeStart: null,\n};\n\n// because columns are not multiples of a single variable (width = n*cols + (n-1) * gutters)\n// we snap to the base unit and then snap to _actual_ column multiples on stop\nconst SNAP_TO_GRID = [GRID_BASE_UNIT, GRID_BASE_UNIT];\nconst HANDLE_CLASSES = {\n  right: 'resizable-container-handle--right',\n  bottom: 'resizable-container-handle--bottom',\n};\nclass ResizableContainer extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isResizing: false,\n    };\n\n    this.handleResizeStart = this.handleResizeStart.bind(this);\n    this.handleResize = this.handleResize.bind(this);\n    this.handleResizeStop = this.handleResizeStop.bind(this);\n  }\n\n  handleResizeStart(event, direction, ref) {\n    const { id, onResizeStart } = this.props;\n\n    if (onResizeStart) {\n      onResizeStart({ id, direction, ref });\n    }\n\n    this.setState(() => ({ isResizing: true }));\n  }\n\n  handleResize(event, direction, ref) {\n    const { onResize, id } = this.props;\n    if (onResize) {\n      onResize({ id, direction, ref });\n    }\n  }\n\n  handleResizeStop(event, direction, ref, delta) {\n    const {\n      id,\n      onResizeStop,\n      widthStep,\n      heightStep,\n      widthMultiple,\n      heightMultiple,\n      adjustableHeight,\n      adjustableWidth,\n      gutterWidth,\n    } = this.props;\n\n    if (onResizeStop) {\n      const nextWidthMultiple =\n        widthMultiple + Math.round(delta.width / (widthStep + gutterWidth));\n      const nextHeightMultiple =\n        heightMultiple + Math.round(delta.height / heightStep);\n\n      onResizeStop({\n        id,\n        widthMultiple: adjustableWidth ? nextWidthMultiple : null,\n        heightMultiple: adjustableHeight ? nextHeightMultiple : null,\n      });\n\n      this.setState(() => ({ isResizing: false }));\n    }\n  }\n\n  render() {\n    const {\n      children,\n      adjustableWidth,\n      adjustableHeight,\n      widthStep,\n      heightStep,\n      widthMultiple,\n      heightMultiple,\n      staticHeight,\n      staticHeightMultiple,\n      staticWidth,\n      staticWidthMultiple,\n      minWidthMultiple,\n      maxWidthMultiple,\n      minHeightMultiple,\n      maxHeightMultiple,\n      gutterWidth,\n      editMode,\n    } = this.props;\n\n    const size = {\n      width: adjustableWidth\n        ? (widthStep + gutterWidth) * widthMultiple - gutterWidth\n        : (staticWidthMultiple && staticWidthMultiple * widthStep) ||\n          staticWidth ||\n          undefined,\n      height: adjustableHeight\n        ? heightStep * heightMultiple\n        : (staticHeightMultiple && staticHeightMultiple * heightStep) ||\n          staticHeight ||\n          undefined,\n    };\n\n    let enableConfig = resizableConfig.notAdjustable;\n\n    if (editMode && adjustableWidth && adjustableHeight) {\n      enableConfig = resizableConfig.widthAndHeight;\n    } else if (editMode && adjustableWidth) {\n      enableConfig = resizableConfig.widthOnly;\n    } else if (editMode && adjustableHeight) {\n      enableConfig = resizableConfig.heightOnly;\n    }\n\n    const { isResizing } = this.state;\n\n    return (\n      <Resizable\n        enable={enableConfig}\n        grid={SNAP_TO_GRID}\n        minWidth={\n          adjustableWidth\n            ? minWidthMultiple * (widthStep + gutterWidth) - gutterWidth\n            : undefined\n        }\n        minHeight={\n          adjustableHeight ? minHeightMultiple * heightStep : undefined\n        }\n        maxWidth={\n          adjustableWidth\n            ? Math.max(\n                size.width,\n                Math.min(\n                  proxyToInfinity,\n                  maxWidthMultiple * (widthStep + gutterWidth) - gutterWidth,\n                ),\n              )\n            : undefined\n        }\n        maxHeight={\n          adjustableHeight\n            ? Math.max(\n                size.height,\n                Math.min(proxyToInfinity, maxHeightMultiple * heightStep),\n              )\n            : undefined\n        }\n        size={size}\n        onResizeStart={this.handleResizeStart}\n        onResize={this.handleResize}\n        onResizeStop={this.handleResizeStop}\n        handleComponent={ResizableHandle}\n        className={cx(\n          'resizable-container',\n          isResizing && 'resizable-container--resizing',\n        )}\n        handleClasses={HANDLE_CLASSES}\n      >\n        {children}\n      </Resizable>\n    );\n  }\n}\n\nResizableContainer.propTypes = propTypes;\nResizableContainer.defaultProps = defaultProps;\n\nexport default ResizableContainer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { useTheme } from '@superset-ui/core';\nimport { useSelector, connect } from 'react-redux';\n\nimport { getChartIdsInFilterBoxScope } from 'src/dashboard/util/activeDashboardFilters';\nimport Chart from 'src/dashboard/containers/Chart';\nimport AnchorLink from 'src/dashboard/components/AnchorLink';\nimport DeleteComponentButton from 'src/dashboard/components/DeleteComponentButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport HoverMenu from 'src/dashboard/components/menu/HoverMenu';\nimport ResizableContainer from 'src/dashboard/components/resizable/ResizableContainer';\nimport getChartAndLabelComponentIdFromPath from 'src/dashboard/util/getChartAndLabelComponentIdFromPath';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport { COLUMN_TYPE, ROW_TYPE } from 'src/dashboard/util/componentTypes';\nimport {\n  GRID_BASE_UNIT,\n  GRID_GUTTER_SIZE,\n  GRID_MIN_COLUMN_COUNT,\n  GRID_MIN_ROW_UNITS,\n} from 'src/dashboard/util/constants';\n\nconst CHART_MARGIN = 32;\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  dashboardId: PropTypes.number.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  getComponentById: PropTypes.func.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  directPathToChild: PropTypes.arrayOf(PropTypes.string),\n  directPathLastUpdated: PropTypes.number,\n  focusedFilterScope: PropTypes.object,\n  fullSizeChartId: PropTypes.oneOf([PropTypes.number, null]),\n\n  // grid related\n  availableColumnCount: PropTypes.number.isRequired,\n  columnWidth: PropTypes.number.isRequired,\n  onResizeStart: PropTypes.func.isRequired,\n  onResize: PropTypes.func.isRequired,\n  onResizeStop: PropTypes.func.isRequired,\n\n  // dnd\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  setFullSizeChartId: PropTypes.func.isRequired,\n  postAddSliceFromDashboard: PropTypes.func,\n};\n\nconst defaultProps = {\n  directPathToChild: [],\n  directPathLastUpdated: 0,\n};\n\n/**\n * Selects the chart scope of the filter input that has focus.\n *\n * @returns {{chartId: number, scope: { scope: string[], immune: string[] }} | null }\n * the scope of the currently focused filter, if any\n */\nfunction selectFocusedFilterScope(dashboardState, dashboardFilters) {\n  if (!dashboardState.focusedFilterField) return null;\n  const { chartId, column } = dashboardState.focusedFilterField;\n  return {\n    chartId,\n    scope: dashboardFilters[chartId].scopes[column],\n  };\n}\n\n/**\n * Renders any styles necessary to highlight the chart's relationship to the focused filter.\n *\n * If there is no focused filter scope (i.e. most of the time), this will be just a pass-through.\n *\n * If the chart is outside the scope of the focused filter, dims the chart.\n *\n * If the chart is in the scope of the focused filter,\n * renders a highlight around the chart.\n *\n * If ChartHolder were a function component, this could be implemented as a hook instead.\n */\nconst FilterFocusHighlight = React.forwardRef(\n  ({ chartId, ...otherProps }, ref) => {\n    const theme = useTheme();\n\n    const nativeFilters = useSelector(state => state.nativeFilters);\n    const dashboardState = useSelector(state => state.dashboardState);\n    const dashboardFilters = useSelector(state => state.dashboardFilters);\n    const focusedFilterScope = selectFocusedFilterScope(\n      dashboardState,\n      dashboardFilters,\n    );\n    const focusedNativeFilterId = nativeFilters.focusedFilterId;\n    if (!(focusedFilterScope || focusedNativeFilterId)) {\n      return <div ref={ref} {...otherProps} />;\n    }\n\n    // we use local styles here instead of a conditionally-applied class,\n    // because adding any conditional class to this container\n    // causes performance issues in Chrome.\n\n    // default to the \"de-emphasized\" state\n    const unfocusedChartStyles = { opacity: 0.3, pointerEvents: 'none' };\n    const focusedChartStyles = {\n      borderColor: theme.colors.primary.light2,\n      opacity: 1,\n      boxShadow: `0px 0px ${theme.gridUnit * 2}px ${theme.colors.primary.base}`,\n      pointerEvents: 'auto',\n    };\n\n    if (focusedNativeFilterId) {\n      if (\n        nativeFilters.filters[focusedNativeFilterId]?.chartsInScope?.includes(\n          chartId,\n        )\n      ) {\n        return <div ref={ref} style={focusedChartStyles} {...otherProps} />;\n      }\n    } else if (\n      chartId === focusedFilterScope.chartId ||\n      getChartIdsInFilterBoxScope({\n        filterScope: focusedFilterScope.scope,\n      }).includes(chartId)\n    ) {\n      return <div ref={ref} style={focusedChartStyles} {...otherProps} />;\n    }\n\n    // inline styles are used here due to a performance issue when adding/changing a class, which causes a reflow\n    return <div ref={ref} style={unfocusedChartStyles} {...otherProps} />;\n  },\n);\n\nclass ChartHolder extends React.Component {\n  static renderInFocusCSS(columnName) {\n    return (\n      <style>\n        {`label[for=${columnName}] + .Select .Select__control {\n                    border-color: #00736a;\n                    transition: border-color 1s ease-in-out;\n           }`}\n      </style>\n    );\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const { component, directPathToChild, directPathLastUpdated } = props;\n    const { label: columnName, chart: chartComponentId } =\n      getChartAndLabelComponentIdFromPath(directPathToChild);\n\n    if (\n      directPathLastUpdated !== state.directPathLastUpdated &&\n      component.id === chartComponentId\n    ) {\n      return {\n        outlinedComponentId: component.id,\n        outlinedColumnName: columnName,\n        directPathLastUpdated,\n      };\n    }\n    return null;\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n      outlinedComponentId: null,\n      outlinedColumnName: null,\n      directPathLastUpdated: 0,\n      extraControls: {},\n    };\n\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleUpdateSliceName = this.handleUpdateSliceName.bind(this);\n    this.handleToggleFullSize = this.handleToggleFullSize.bind(this);\n    this.handleExtraControl = this.handleExtraControl.bind(this);\n    this.handlePostTransformProps = this.handlePostTransformProps.bind(this);\n  }\n\n  componentDidMount() {\n    this.hideOutline({}, this.state);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    this.hideOutline(prevState, this.state);\n  }\n\n  hideOutline(prevState, state) {\n    const { outlinedComponentId: timerKey } = state;\n    const { outlinedComponentId: prevTimerKey } = prevState;\n\n    // because of timeout, there might be multiple charts showing outline\n    if (!!timerKey && !prevTimerKey) {\n      setTimeout(() => {\n        this.setState(() => ({\n          outlinedComponentId: null,\n          outlinedColumnName: null,\n        }));\n      }, 2000);\n    }\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: nextFocus }));\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleUpdateSliceName(nextName) {\n    const { component, updateComponents } = this.props;\n    updateComponents({\n      [component.id]: {\n        ...component,\n        meta: {\n          ...component.meta,\n          sliceNameOverride: nextName,\n        },\n      },\n    });\n  }\n\n  handleToggleFullSize() {\n    const { component, fullSizeChartId, setFullSizeChartId } = this.props;\n    const { chartId } = component.meta;\n    const isFullSize = fullSizeChartId === chartId;\n    setFullSizeChartId(isFullSize ? null : chartId);\n  }\n\n  handleExtraControl(name, value) {\n    this.setState(prevState => ({\n      extraControls: {\n        ...prevState.extraControls,\n        [name]: value,\n      },\n    }));\n  }\n\n  handlePostTransformProps(props) {\n    this.props.postAddSliceFromDashboard();\n    return props;\n  }\n\n  render() {\n    const { isFocused, extraControls } = this.state;\n    const {\n      component,\n      parentComponent,\n      index,\n      depth,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      editMode,\n      isComponentVisible,\n      dashboardId,\n      fullSizeChartId,\n      getComponentById = () => undefined,\n    } = this.props;\n\n    const { chartId } = component.meta;\n    const isFullSize = fullSizeChartId === chartId;\n\n    // inherit the size of parent columns\n    const columnParentWidth = getComponentById(\n      parentComponent.parents?.find(parent => parent.startsWith(COLUMN_TYPE)),\n    )?.meta?.width;\n    let widthMultiple = component.meta.width || GRID_MIN_COLUMN_COUNT;\n    if (parentComponent.type === COLUMN_TYPE) {\n      widthMultiple = parentComponent.meta.width || GRID_MIN_COLUMN_COUNT;\n    } else if (columnParentWidth && widthMultiple > columnParentWidth) {\n      widthMultiple = columnParentWidth;\n    }\n\n    let chartWidth = 0;\n    let chartHeight = 0;\n\n    if (isFullSize) {\n      chartWidth = window.innerWidth - CHART_MARGIN;\n      chartHeight = window.innerHeight - CHART_MARGIN;\n    } else {\n      chartWidth = Math.floor(\n        widthMultiple * columnWidth +\n          (widthMultiple - 1) * GRID_GUTTER_SIZE -\n          CHART_MARGIN,\n      );\n      chartHeight = Math.floor(\n        component.meta.height * GRID_BASE_UNIT - CHART_MARGIN,\n      );\n    }\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation={parentComponent.type === ROW_TYPE ? 'column' : 'row'}\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        disableDragDrop={isFocused}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <ResizableContainer\n            id={component.id}\n            adjustableWidth={parentComponent.type === ROW_TYPE}\n            adjustableHeight\n            widthStep={columnWidth}\n            widthMultiple={widthMultiple}\n            heightStep={GRID_BASE_UNIT}\n            heightMultiple={component.meta.height}\n            minWidthMultiple={GRID_MIN_COLUMN_COUNT}\n            minHeightMultiple={GRID_MIN_ROW_UNITS}\n            maxWidthMultiple={availableColumnCount + widthMultiple}\n            onResizeStart={onResizeStart}\n            onResize={onResize}\n            onResizeStop={onResizeStop}\n            editMode={editMode}\n          >\n            <FilterFocusHighlight\n              chartId={chartId}\n              ref={dragSourceRef}\n              data-test=\"dashboard-component-chart-holder\"\n              className={cx(\n                'dashboard-component',\n                'dashboard-component-chart-holder',\n                // The following class is added to support custom dashboard styling via the CSS editor\n                `dashboard-chart-id-${chartId}`,\n                this.state.outlinedComponentId ? 'fade-in' : 'fade-out',\n                isFullSize && 'full-size',\n              )}\n            >\n              {!editMode && (\n                <AnchorLink\n                  id={component.id}\n                  scrollIntoView={\n                    this.state.outlinedComponentId === component.id\n                  }\n                />\n              )}\n              {!!this.state.outlinedComponentId &&\n                ChartHolder.renderInFocusCSS(this.state.outlinedColumnName)}\n              <Chart\n                componentId={component.id}\n                id={component.meta.chartId}\n                dashboardId={dashboardId}\n                width={chartWidth}\n                height={chartHeight}\n                sliceName={\n                  component.meta.sliceNameOverride ||\n                  component.meta.sliceName ||\n                  ''\n                }\n                updateSliceName={this.handleUpdateSliceName}\n                isComponentVisible={isComponentVisible}\n                handleToggleFullSize={this.handleToggleFullSize}\n                isFullSize={isFullSize}\n                setControlValue={this.handleExtraControl}\n                extraControls={extraControls}\n                postTransformProps={this.handlePostTransformProps}\n              />\n              {editMode && (\n                <HoverMenu position=\"top\">\n                  <div data-test=\"dashboard-delete-component-button\">\n                    <DeleteComponentButton\n                      onDelete={this.handleDeleteComponent}\n                    />\n                  </div>\n                </HoverMenu>\n              )}\n            </FilterFocusHighlight>\n\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </ResizableContainer>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nChartHolder.propTypes = propTypes;\nChartHolder.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return {\n    directPathToChild: state.dashboardState.directPathToChild,\n    directPathLastUpdated: state.dashboardState.directPathLastUpdated,\n  };\n}\nexport default connect(mapStateToProps)(ChartHolder);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { IN_COMPONENT_ELEMENT_TYPES } from './constants';\n\nexport default function getChartAndLabelComponentIdFromPath(directPathToChild) {\n  const result = {};\n\n  if (directPathToChild.length > 0) {\n    const currentPath = directPathToChild.slice();\n\n    while (currentPath.length) {\n      const componentId = currentPath.pop();\n      const componentType = componentId.split('-')[0];\n\n      result[componentType.toLowerCase()] = componentId;\n      if (!IN_COMPONENT_ELEMENT_TYPES.includes(componentType)) {\n        break;\n      }\n    }\n  }\n\n  return result;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport cx from 'classnames';\nimport { styled, useTheme } from '@superset-ui/core';\nimport { AntdDropdown } from 'src/components';\nimport { Menu } from 'src/components/Menu';\nimport Icons from 'src/components/Icons';\n\nexport interface OptionProps {\n  value: string;\n  label: string;\n  className?: string;\n}\n\nexport type OnChangeHandler = (key: React.Key) => void;\nexport type RenderElementHandler = (option: OptionProps) => JSX.Element;\n\nexport interface PopoverDropdownProps {\n  id: string;\n  options: OptionProps[];\n  onChange: OnChangeHandler;\n  value: string;\n  renderButton?: RenderElementHandler;\n  renderOption?: RenderElementHandler;\n}\n\ninterface HandleSelectProps {\n  key: React.Key;\n}\n\nconst MenuItem = styled(Menu.Item)`\n  &.ant-menu-item {\n    height: auto;\n    line-height: 1.4;\n\n    padding-top: ${({ theme }) => theme.gridUnit}px;\n    padding-bottom: ${({ theme }) => theme.gridUnit}px;\n\n    margin-top: 0;\n    margin-bottom: 0;\n\n    &:not(:last-child) {\n      margin-bottom: 0;\n    }\n\n    &:hover {\n      background: ${({ theme }) => theme.colors.grayscale.light3};\n    }\n\n    &.active {\n      font-weight: ${({ theme }) => theme.typography.weights.bold};\n      background: ${({ theme }) => theme.colors.grayscale.light2};\n    }\n  }\n\n  &.ant-menu-item-selected {\n    color: unset;\n  }\n`;\n\nconst PopoverDropdown = (props: PopoverDropdownProps) => {\n  const {\n    value,\n    options,\n    onChange,\n    renderButton = (option: OptionProps) => option.label,\n    renderOption = (option: OptionProps) => (\n      <div className={option.className}>{option.label}</div>\n    ),\n  } = props;\n\n  const theme = useTheme();\n  const selected = options.find(opt => opt.value === value);\n  return (\n    <AntdDropdown\n      trigger={['click']}\n      overlayStyle={{ zIndex: theme.zIndex.max }}\n      overlay={\n        <Menu onClick={({ key }: HandleSelectProps) => onChange(key)}>\n          {options.map(option => (\n            <MenuItem\n              id=\"menu-item\"\n              key={option.value}\n              className={cx('dropdown-item', {\n                active: option.value === value,\n              })}\n            >\n              {renderOption(option)}\n            </MenuItem>\n          ))}\n        </Menu>\n      }\n    >\n      <div role=\"button\" css={{ display: 'flex', alignItems: 'center' }}>\n        {selected && renderButton(selected)}\n        <Icons.CaretDown\n          iconColor={theme.colors.grayscale.base}\n          css={{ marginTop: theme.gridUnit * 0.5 }}\n        />\n      </div>\n    </AntdDropdown>\n  );\n};\n\nexport default PopoverDropdown;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport PopoverDropdown, {\n  OnChangeHandler,\n} from 'src/components/PopoverDropdown';\n\ninterface MarkdownModeDropdownProps {\n  id: string;\n  value: string;\n  onChange: OnChangeHandler;\n}\n\nconst dropdownOptions = [\n  {\n    value: 'edit',\n    label: t('Edit'),\n  },\n  {\n    value: 'preview',\n    label: t('Preview'),\n  },\n];\n\nexport default class MarkdownModeDropdown extends React.PureComponent<MarkdownModeDropdownProps> {\n  render() {\n    const { id, value, onChange } = this.props;\n\n    return (\n      <PopoverDropdown\n        id={id}\n        options={dropdownOptions}\n        value={value}\n        onChange={onChange}\n      />\n    );\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport cx from 'classnames';\n\ntype ShouldFocusContainer = HTMLDivElement & {\n  contains: (event_target: EventTarget & HTMLElement) => Boolean;\n};\n\ninterface WithPopoverMenuProps {\n  children: React.ReactNode;\n  disableClick: Boolean;\n  menuItems: React.ReactNode[];\n  onChangeFocus: (focus: Boolean) => void;\n  isFocused: Boolean;\n  // Event argument is left as \"any\" because of the clash. In defaultProps it seems\n  // like it should be React.FocusEvent<>, however from handleClick() we can also\n  // derive that type is EventListenerOrEventListenerObject.\n  shouldFocus: (event: any, container: ShouldFocusContainer) => Boolean;\n  editMode: Boolean;\n  style: React.CSSProperties;\n}\n\ninterface WithPopoverMenuState {\n  isFocused: Boolean;\n}\n\nexport default class WithPopoverMenu extends React.PureComponent<\n  WithPopoverMenuProps,\n  WithPopoverMenuState\n> {\n  container: ShouldFocusContainer;\n\n  static defaultProps = {\n    children: null,\n    disableClick: false,\n    onChangeFocus: null,\n    menuItems: [],\n    isFocused: false,\n    shouldFocus: (event: any, container: ShouldFocusContainer) =>\n      container?.contains(event.target) ||\n      event.target.id === 'menu-item' ||\n      event.target.parentNode?.id === 'menu-item',\n    style: null,\n  };\n\n  constructor(props: WithPopoverMenuProps) {\n    super(props);\n    this.state = {\n      isFocused: props.isFocused!,\n    };\n    this.setRef = this.setRef.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: WithPopoverMenuProps) {\n    if (nextProps.editMode && nextProps.isFocused && !this.state.isFocused) {\n      document.addEventListener('click', this.handleClick);\n      document.addEventListener('drag', this.handleClick);\n      this.setState({ isFocused: true });\n    } else if (this.state.isFocused && !nextProps.editMode) {\n      document.removeEventListener('click', this.handleClick);\n      document.removeEventListener('drag', this.handleClick);\n      this.setState({ isFocused: false });\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.handleClick);\n    document.removeEventListener('drag', this.handleClick);\n  }\n\n  setRef(ref: ShouldFocusContainer) {\n    this.container = ref;\n  }\n\n  handleClick(event: any) {\n    if (!this.props.editMode) {\n      return;\n    }\n    const {\n      onChangeFocus,\n      shouldFocus: shouldFocusFunc,\n      disableClick,\n    } = this.props;\n\n    const shouldFocus = shouldFocusFunc(event, this.container);\n\n    if (!disableClick && shouldFocus && !this.state.isFocused) {\n      // if not focused, set focus and add a window event listener to capture outside clicks\n      // this enables us to not set a click listener for ever item on a dashboard\n      document.addEventListener('click', this.handleClick);\n      document.addEventListener('drag', this.handleClick);\n      this.setState(() => ({ isFocused: true }));\n      if (onChangeFocus) {\n        onChangeFocus(true);\n      }\n    } else if (!shouldFocus && this.state.isFocused) {\n      document.removeEventListener('click', this.handleClick);\n      document.removeEventListener('drag', this.handleClick);\n      this.setState(() => ({ isFocused: false }));\n      if (onChangeFocus) {\n        onChangeFocus(false);\n      }\n    }\n  }\n\n  render() {\n    const { children, menuItems, editMode, style } = this.props;\n    const { isFocused } = this.state;\n\n    return (\n      <div\n        ref={this.setRef}\n        onClick={this.handleClick}\n        role=\"none\"\n        className={cx(\n          'with-popover-menu',\n          editMode && isFocused && 'with-popover-menu--focused',\n        )}\n        style={style}\n      >\n        {children}\n        {editMode && isFocused && (menuItems?.length ?? 0) > 0 && (\n          <div className=\"popover-menu\">\n            {menuItems.map((node: React.ReactNode, i: Number) => (\n              <div className=\"menu-item\" key={`menu-item-${i}`}>\n                {node}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport cx from 'classnames';\n\nimport { t, SafeMarkdown } from '@superset-ui/core';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { MarkdownEditor } from 'src/components/AsyncAceEditor';\n\nimport DeleteComponentButton from 'src/dashboard/components/DeleteComponentButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport HoverMenu from 'src/dashboard/components/menu/HoverMenu';\nimport ResizableContainer from 'src/dashboard/components/resizable/ResizableContainer';\nimport MarkdownModeDropdown from 'src/dashboard/components/menu/MarkdownModeDropdown';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport { ROW_TYPE, COLUMN_TYPE } from 'src/dashboard/util/componentTypes';\nimport {\n  GRID_MIN_COLUMN_COUNT,\n  GRID_MIN_ROW_UNITS,\n  GRID_BASE_UNIT,\n} from 'src/dashboard/util/constants';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n\n  // from redux\n  logEvent: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  undoLength: PropTypes.number.isRequired,\n  redoLength: PropTypes.number.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number.isRequired,\n  columnWidth: PropTypes.number.isRequired,\n  onResizeStart: PropTypes.func.isRequired,\n  onResize: PropTypes.func.isRequired,\n  onResizeStop: PropTypes.func.isRequired,\n\n  // dnd\n  deleteComponent: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {};\n\nconst MARKDOWN_PLACE_HOLDER = `# ✨Markdown\n## ✨Markdown\n### ✨Markdown\n\n<br />\n\nClick here to edit [markdown](https://bit.ly/1dQOfRK)`;\n\nconst MARKDOWN_ERROR_MESSAGE = t('This markdown component has an error.');\n\nclass Markdown extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n      markdownSource: props.component.meta.code,\n      editor: null,\n      editorMode: 'preview',\n      undoLength: props.undoLength,\n      redoLength: props.redoLength,\n    };\n    this.renderStartTime = Logger.getTimestamp();\n\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n    this.handleChangeEditorMode = this.handleChangeEditorMode.bind(this);\n    this.handleMarkdownChange = this.handleMarkdownChange.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleResizeStart = this.handleResizeStart.bind(this);\n    this.setEditor = this.setEditor.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.logEvent(LOG_ACTIONS_RENDER_CHART, {\n      viz_type: 'markdown',\n      start_offset: this.renderStartTime,\n      ts: new Date().getTime(),\n      duration: Logger.getTimestamp() - this.renderStartTime,\n    });\n  }\n\n  static getDerivedStateFromProps(nextProps, state) {\n    const { hasError, editorMode, markdownSource, undoLength, redoLength } =\n      state;\n    const {\n      component: nextComponent,\n      undoLength: nextUndoLength,\n      redoLength: nextRedoLength,\n    } = nextProps;\n    // user click undo or redo ?\n    if (nextUndoLength !== undoLength || nextRedoLength !== redoLength) {\n      return {\n        ...state,\n        undoLength: nextUndoLength,\n        redoLength: nextRedoLength,\n        markdownSource: nextComponent.meta.code,\n        hasError: false,\n      };\n    }\n    if (\n      !hasError &&\n      editorMode === 'preview' &&\n      nextComponent.meta.code !== markdownSource\n    ) {\n      return {\n        ...state,\n        markdownSource: nextComponent.meta.code,\n      };\n    }\n\n    return state;\n  }\n\n  static getDerivedStateFromError() {\n    return {\n      hasError: true,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      this.state.editor &&\n      (prevProps.component.meta.width !== this.props.component.meta.width ||\n        prevProps.columnWidth !== this.props.columnWidth)\n    ) {\n      this.state.editor.resize(true);\n    }\n    // pre-load AceEditor when entering edit mode\n    if (this.props.editMode) {\n      MarkdownEditor.preload();\n    }\n  }\n\n  componentDidCatch() {\n    if (this.state.editor && this.state.editorMode === 'preview') {\n      this.props.addDangerToast(\n        t(\n          'This markdown component has an error. Please revert your recent changes.',\n        ),\n      );\n    }\n  }\n\n  setEditor(editor) {\n    editor.getSession().setUseWrapMode(true);\n    this.setState({\n      editor,\n    });\n  }\n\n  handleChangeFocus(nextFocus) {\n    const nextFocused = !!nextFocus;\n    const nextEditMode = nextFocused ? 'edit' : 'preview';\n    this.setState(() => ({ isFocused: nextFocused }));\n    this.handleChangeEditorMode(nextEditMode);\n  }\n\n  handleChangeEditorMode(mode) {\n    const nextState = {\n      ...this.state,\n      editorMode: mode,\n    };\n    if (mode === 'preview') {\n      this.updateMarkdownContent();\n      nextState.hasError = false;\n    }\n\n    this.setState(nextState);\n  }\n\n  updateMarkdownContent() {\n    const { updateComponents, component } = this.props;\n    if (component.meta.code !== this.state.markdownSource) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            code: this.state.markdownSource,\n          },\n        },\n      });\n    }\n  }\n\n  handleMarkdownChange(nextValue) {\n    this.setState({\n      markdownSource: nextValue,\n    });\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleResizeStart(e) {\n    const { editorMode } = this.state;\n    const { editMode, onResizeStart } = this.props;\n    const isEditing = editorMode === 'edit';\n    onResizeStart(e);\n    if (editMode && isEditing) {\n      this.updateMarkdownContent();\n    }\n  }\n\n  renderEditMode() {\n    return (\n      <MarkdownEditor\n        onChange={this.handleMarkdownChange}\n        width=\"100%\"\n        height=\"100%\"\n        showGutter={false}\n        editorProps={{ $blockScrolling: true }}\n        value={\n          // this allows \"select all => delete\" to give an empty editor\n          typeof this.state.markdownSource === 'string'\n            ? this.state.markdownSource\n            : MARKDOWN_PLACE_HOLDER\n        }\n        readOnly={false}\n        onLoad={this.setEditor}\n        data-test=\"editor\"\n      />\n    );\n  }\n\n  renderPreviewMode() {\n    const { hasError } = this.state;\n\n    return (\n      <SafeMarkdown\n        source={\n          hasError\n            ? MARKDOWN_ERROR_MESSAGE\n            : this.state.markdownSource || MARKDOWN_PLACE_HOLDER\n        }\n      />\n    );\n  }\n\n  render() {\n    const { isFocused, editorMode } = this.state;\n\n    const {\n      component,\n      parentComponent,\n      index,\n      depth,\n      availableColumnCount,\n      columnWidth,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      editMode,\n    } = this.props;\n\n    // inherit the size of parent columns\n    const widthMultiple =\n      parentComponent.type === COLUMN_TYPE\n        ? parentComponent.meta.width || GRID_MIN_COLUMN_COUNT\n        : component.meta.width || GRID_MIN_COLUMN_COUNT;\n\n    const isEditing = editorMode === 'edit';\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation={parentComponent.type === ROW_TYPE ? 'column' : 'row'}\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        disableDragDrop={isFocused}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <WithPopoverMenu\n            onChangeFocus={this.handleChangeFocus}\n            menuItems={[\n              <MarkdownModeDropdown\n                id={`${component.id}-mode`}\n                value={this.state.editorMode}\n                onChange={this.handleChangeEditorMode}\n              />,\n            ]}\n            editMode={editMode}\n          >\n            <div\n              data-test=\"dashboard-markdown-editor\"\n              className={cx(\n                'dashboard-markdown',\n                isEditing && 'dashboard-markdown--editing',\n              )}\n              id={component.id}\n            >\n              <ResizableContainer\n                id={component.id}\n                adjustableWidth={parentComponent.type === ROW_TYPE}\n                adjustableHeight\n                widthStep={columnWidth}\n                widthMultiple={widthMultiple}\n                heightStep={GRID_BASE_UNIT}\n                heightMultiple={component.meta.height}\n                minWidthMultiple={GRID_MIN_COLUMN_COUNT}\n                minHeightMultiple={GRID_MIN_ROW_UNITS}\n                maxWidthMultiple={availableColumnCount + widthMultiple}\n                onResizeStart={this.handleResizeStart}\n                onResize={onResize}\n                onResizeStop={onResizeStop}\n                editMode={isFocused ? false : editMode}\n              >\n                <div\n                  ref={dragSourceRef}\n                  className=\"dashboard-component dashboard-component-chart-holder\"\n                  data-test=\"dashboard-component-chart-holder\"\n                >\n                  {editMode && (\n                    <HoverMenu position=\"top\">\n                      <DeleteComponentButton\n                        onDelete={this.handleDeleteComponent}\n                      />\n                    </HoverMenu>\n                  )}\n                  {editMode && isEditing\n                    ? this.renderEditMode()\n                    : this.renderPreviewMode()}\n                </div>\n              </ResizableContainer>\n            </div>\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </WithPopoverMenu>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nMarkdown.propTypes = propTypes;\nMarkdown.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return {\n    undoLength: state.dashboardLayout.past.length,\n    redoLength: state.dashboardLayout.future.length,\n  };\n}\nexport default connect(mapStateToProps)(Markdown);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { LegacyRef } from 'react';\nimport { css, styled } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\n\ninterface DragHandleProps {\n  position: 'left' | 'top';\n  innerRef?: LegacyRef<HTMLDivElement> | undefined;\n}\n\nconst DragHandleContainer = styled.div<{ position: 'left' | 'top' }>`\n  ${({ theme, position }) => css`\n    height: ${theme.gridUnit * 5}px;\n    overflow: hidden;\n    cursor: move;\n    ${position === 'top' &&\n    css`\n      transform: rotate(90deg);\n    `}\n    & path {\n      fill: ${theme.colors.grayscale.base};\n    }\n  `}\n`;\nexport default function DragHandle({\n  position = 'left',\n  innerRef = null,\n}: DragHandleProps) {\n  return (\n    <DragHandleContainer ref={innerRef} position={position}>\n      <Icons.Drag />\n    </DragHandleContainer>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport cx from 'classnames';\n\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport PopoverDropdown, {\n  OptionProps,\n  OnChangeHandler,\n} from 'src/components/PopoverDropdown';\n\ninterface BackgroundStyleDropdownProps {\n  id: string;\n  value: string;\n  onChange: OnChangeHandler;\n}\n\nfunction renderButton(option: OptionProps) {\n  return (\n    <div className={cx('background-style-option', option.className)}>\n      {`${option.label} background`}\n    </div>\n  );\n}\n\nfunction renderOption(option: OptionProps) {\n  return (\n    <div className={cx('background-style-option', option.className)}>\n      {option.label}\n    </div>\n  );\n}\n\nexport default class BackgroundStyleDropdown extends React.PureComponent<BackgroundStyleDropdownProps> {\n  render() {\n    const { id, value, onChange } = this.props;\n    return (\n      <PopoverDropdown\n        id={id}\n        options={backgroundStyleOptions}\n        value={value}\n        onChange={onChange}\n        renderButton={renderButton}\n        renderOption={renderOption}\n      />\n    );\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Icons from 'src/components/Icons';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport DeleteComponentButton from 'src/dashboard/components/DeleteComponentButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DragHandle from 'src/dashboard/components/dnd/DragHandle';\nimport HoverMenu from 'src/dashboard/components/menu/HoverMenu';\nimport IconButton from 'src/dashboard/components/IconButton';\nimport ResizableContainer from 'src/dashboard/components/resizable/ResizableContainer';\nimport BackgroundStyleDropdown from 'src/dashboard/components/menu/BackgroundStyleDropdown';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport { BACKGROUND_TRANSPARENT } from 'src/dashboard/util/constants';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number.isRequired,\n  columnWidth: PropTypes.number.isRequired,\n  minColumnWidth: PropTypes.number.isRequired,\n  onResizeStart: PropTypes.func.isRequired,\n  onResize: PropTypes.func.isRequired,\n  onResizeStop: PropTypes.func.isRequired,\n\n  // dnd\n  deleteComponent: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {};\n\nclass Column extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n    };\n    this.handleChangeBackground = this.handleUpdateMeta.bind(\n      this,\n      'background',\n    );\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: Boolean(nextFocus) }));\n  }\n\n  handleUpdateMeta(metaKey, nextValue) {\n    const { updateComponents, component } = this.props;\n    if (nextValue && component.meta[metaKey] !== nextValue) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            [metaKey]: nextValue,\n          },\n        },\n      });\n    }\n  }\n\n  render() {\n    const {\n      component: columnComponent,\n      parentComponent,\n      index,\n      availableColumnCount,\n      columnWidth,\n      minColumnWidth,\n      depth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      editMode,\n      onChangeTab,\n      isComponentVisible,\n    } = this.props;\n\n    const columnItems = columnComponent.children || [];\n    const backgroundStyle = backgroundStyleOptions.find(\n      opt =>\n        opt.value ===\n        (columnComponent.meta.background || BACKGROUND_TRANSPARENT),\n    );\n\n    return (\n      <DragDroppable\n        component={columnComponent}\n        parentComponent={parentComponent}\n        orientation=\"column\"\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <ResizableContainer\n            id={columnComponent.id}\n            adjustableWidth\n            adjustableHeight={false}\n            widthStep={columnWidth}\n            widthMultiple={columnComponent.meta.width}\n            minWidthMultiple={minColumnWidth}\n            maxWidthMultiple={\n              availableColumnCount + (columnComponent.meta.width || 0)\n            }\n            onResizeStart={onResizeStart}\n            onResize={onResize}\n            onResizeStop={onResizeStop}\n            editMode={editMode}\n          >\n            <WithPopoverMenu\n              isFocused={this.state.isFocused}\n              onChangeFocus={this.handleChangeFocus}\n              disableClick\n              menuItems={[\n                <BackgroundStyleDropdown\n                  id={`${columnComponent.id}-background`}\n                  value={columnComponent.meta.background}\n                  onChange={this.handleChangeBackground}\n                />,\n              ]}\n              editMode={editMode}\n            >\n              {editMode && (\n                <HoverMenu innerRef={dragSourceRef} position=\"top\">\n                  <DragHandle position=\"top\" />\n                  <DeleteComponentButton\n                    onDelete={this.handleDeleteComponent}\n                  />\n                  <IconButton\n                    onClick={this.handleChangeFocus}\n                    icon={<Icons.Cog iconSize=\"xl\" />}\n                  />\n                </HoverMenu>\n              )}\n              <div\n                className={cx(\n                  'grid-column',\n                  columnItems.length === 0 && 'grid-column--empty',\n                  backgroundStyle.className,\n                )}\n              >\n                {columnItems.map((componentId, itemIndex) => (\n                  <DashboardComponent\n                    key={componentId}\n                    id={componentId}\n                    parentId={columnComponent.id}\n                    depth={depth + 1}\n                    index={itemIndex}\n                    availableColumnCount={columnComponent.meta.width}\n                    columnWidth={columnWidth}\n                    onResizeStart={onResizeStart}\n                    onResize={onResize}\n                    onResizeStop={onResizeStop}\n                    isComponentVisible={isComponentVisible}\n                    onChangeTab={onChangeTab}\n                  />\n                ))}\n\n                {dropIndicatorProps && <div {...dropIndicatorProps} />}\n              </div>\n            </WithPopoverMenu>\n          </ResizableContainer>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nColumn.propTypes = propTypes;\nColumn.defaultProps = defaultProps;\n\nexport default Column;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport DragDroppable from '../dnd/DragDroppable';\nimport HoverMenu from '../menu/HoverMenu';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport { componentShape } from '../../util/propShapes';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  depth: PropTypes.number.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n};\n\nclass Divider extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  render() {\n    const {\n      component,\n      depth,\n      parentComponent,\n      index,\n      handleComponentDrop,\n      editMode,\n    } = this.props;\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation=\"row\"\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <div ref={dragSourceRef}>\n            {editMode && (\n              <HoverMenu position=\"left\">\n                <DeleteComponentButton onDelete={this.handleDeleteComponent} />\n              </HoverMenu>\n            )}\n\n            <div className=\"dashboard-component dashboard-component-divider\" />\n\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </div>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nDivider.propTypes = propTypes;\n\nexport default Divider;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport PopoverDropdown from 'src/components/PopoverDropdown';\nimport EditableTitle from 'src/components/EditableTitle';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DragHandle from 'src/dashboard/components/dnd/DragHandle';\nimport AnchorLink from 'src/dashboard/components/AnchorLink';\nimport HoverMenu from 'src/dashboard/components/menu/HoverMenu';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport BackgroundStyleDropdown from 'src/dashboard/components/menu/BackgroundStyleDropdown';\nimport DeleteComponentButton from 'src/dashboard/components/DeleteComponentButton';\nimport headerStyleOptions from 'src/dashboard/util/headerStyleOptions';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport {\n  SMALL_HEADER,\n  BACKGROUND_TRANSPARENT,\n} from 'src/dashboard/util/constants';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  dashboardId: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  depth: PropTypes.number.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n\n  // redux\n  handleComponentDrop: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {};\n\nclass Header extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n    };\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n    this.handleUpdateMeta = this.handleUpdateMeta.bind(this);\n    this.handleChangeSize = this.handleUpdateMeta.bind(this, 'headerSize');\n    this.handleChangeBackground = this.handleUpdateMeta.bind(\n      this,\n      'background',\n    );\n    this.handleChangeText = this.handleUpdateMeta.bind(this, 'text');\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: nextFocus }));\n  }\n\n  handleUpdateMeta(metaKey, nextValue) {\n    const { updateComponents, component } = this.props;\n    if (nextValue && component.meta[metaKey] !== nextValue) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            [metaKey]: nextValue,\n          },\n        },\n      });\n    }\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  render() {\n    const { isFocused } = this.state;\n\n    const {\n      dashboardId,\n      component,\n      depth,\n      parentComponent,\n      index,\n      handleComponentDrop,\n      editMode,\n    } = this.props;\n\n    const headerStyle = headerStyleOptions.find(\n      opt => opt.value === (component.meta.headerSize || SMALL_HEADER),\n    );\n\n    const rowStyle = backgroundStyleOptions.find(\n      opt =>\n        opt.value === (component.meta.background || BACKGROUND_TRANSPARENT),\n    );\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation=\"row\"\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        disableDragDrop={isFocused}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <div ref={dragSourceRef}>\n            {editMode &&\n              depth <= 2 && ( // drag handle looks bad when nested\n                <HoverMenu position=\"left\">\n                  <DragHandle position=\"left\" />\n                </HoverMenu>\n              )}\n            <WithPopoverMenu\n              onChangeFocus={this.handleChangeFocus}\n              menuItems={[\n                <PopoverDropdown\n                  id={`${component.id}-header-style`}\n                  options={headerStyleOptions}\n                  value={component.meta.headerSize}\n                  onChange={this.handleChangeSize}\n                />,\n                <BackgroundStyleDropdown\n                  id={`${component.id}-background`}\n                  value={component.meta.background}\n                  onChange={this.handleChangeBackground}\n                />,\n              ]}\n              editMode={editMode}\n            >\n              <div\n                className={cx(\n                  'dashboard-component',\n                  'dashboard-component-header',\n                  headerStyle.className,\n                  rowStyle.className,\n                )}\n              >\n                {editMode && (\n                  <HoverMenu position=\"top\">\n                    <DeleteComponentButton\n                      onDelete={this.handleDeleteComponent}\n                    />\n                  </HoverMenu>\n                )}\n                <EditableTitle\n                  title={component.meta.text}\n                  canEdit={editMode}\n                  onSaveTitle={this.handleChangeText}\n                  showTooltip={false}\n                />\n                {!editMode && (\n                  <AnchorLink id={component.id} dashboardId={dashboardId} />\n                )}\n              </div>\n            </WithPopoverMenu>\n\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </div>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nHeader.propTypes = propTypes;\nHeader.defaultProps = defaultProps;\n\nexport default Header;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DragHandle from 'src/dashboard/components/dnd/DragHandle';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport DeleteComponentButton from 'src/dashboard/components/DeleteComponentButton';\nimport HoverMenu from 'src/dashboard/components/menu/HoverMenu';\nimport Icons from 'src/components/Icons';\nimport IconButton from 'src/dashboard/components/IconButton';\nimport BackgroundStyleDropdown from 'src/dashboard/components/menu/BackgroundStyleDropdown';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport { BACKGROUND_TRANSPARENT } from 'src/dashboard/util/constants';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number.isRequired,\n  columnWidth: PropTypes.number.isRequired,\n  occupiedColumnCount: PropTypes.number.isRequired,\n  onResizeStart: PropTypes.func.isRequired,\n  onResize: PropTypes.func.isRequired,\n  onResizeStop: PropTypes.func.isRequired,\n\n  // dnd\n  handleComponentDrop: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nclass Row extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n    };\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleUpdateMeta = this.handleUpdateMeta.bind(this);\n    this.handleChangeBackground = this.handleUpdateMeta.bind(\n      this,\n      'background',\n    );\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: Boolean(nextFocus) }));\n  }\n\n  handleUpdateMeta(metaKey, nextValue) {\n    const { updateComponents, component } = this.props;\n    if (nextValue && component.meta[metaKey] !== nextValue) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            [metaKey]: nextValue,\n          },\n        },\n      });\n    }\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, component, parentId } = this.props;\n    deleteComponent(component.id, parentId);\n  }\n\n  render() {\n    const {\n      component: rowComponent,\n      parentComponent,\n      index,\n      availableColumnCount,\n      columnWidth,\n      occupiedColumnCount,\n      depth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      editMode,\n      onChangeTab,\n      isComponentVisible,\n    } = this.props;\n\n    const rowItems = rowComponent.children || [];\n\n    const backgroundStyle = backgroundStyleOptions.find(\n      opt =>\n        opt.value === (rowComponent.meta.background || BACKGROUND_TRANSPARENT),\n    );\n\n    return (\n      <DragDroppable\n        component={rowComponent}\n        parentComponent={parentComponent}\n        orientation=\"row\"\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <WithPopoverMenu\n            isFocused={this.state.isFocused}\n            onChangeFocus={this.handleChangeFocus}\n            disableClick\n            menuItems={[\n              <BackgroundStyleDropdown\n                id={`${rowComponent.id}-background`}\n                value={backgroundStyle.value}\n                onChange={this.handleChangeBackground}\n              />,\n            ]}\n            editMode={editMode}\n          >\n            {editMode && (\n              <HoverMenu innerRef={dragSourceRef} position=\"left\">\n                <DragHandle position=\"left\" />\n                <DeleteComponentButton onDelete={this.handleDeleteComponent} />\n                <IconButton\n                  onClick={this.handleChangeFocus}\n                  icon={<Icons.Cog iconSize=\"xl\" />}\n                />\n              </HoverMenu>\n            )}\n            <div\n              className={cx(\n                'grid-row',\n                rowItems.length === 0 && 'grid-row--empty',\n                backgroundStyle.className,\n              )}\n              data-test={`grid-row-${backgroundStyle.className}`}\n            >\n              {rowItems.map((componentId, itemIndex) => (\n                <DashboardComponent\n                  key={componentId}\n                  id={componentId}\n                  parentId={rowComponent.id}\n                  depth={depth + 1}\n                  index={itemIndex}\n                  availableColumnCount={\n                    availableColumnCount - occupiedColumnCount\n                  }\n                  columnWidth={columnWidth}\n                  onResizeStart={onResizeStart}\n                  onResize={onResize}\n                  onResizeStop={onResizeStop}\n                  isComponentVisible={isComponentVisible}\n                  onChangeTab={onChangeTab}\n                />\n              ))}\n\n              {dropIndicatorProps && <div {...dropIndicatorProps} />}\n            </div>\n          </WithPopoverMenu>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nRow.propTypes = propTypes;\n\nexport default Row;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { styled, t } from '@superset-ui/core';\n\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport EditableTitle from 'src/components/EditableTitle';\nimport { setEditMode } from 'src/dashboard/actions/dashboardState';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport AnchorLink from 'src/dashboard/components/AnchorLink';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport { componentShape } from 'src/dashboard/util/propShapes';\n\nexport const RENDER_TAB = 'RENDER_TAB';\nexport const RENDER_TAB_CONTENT = 'RENDER_TAB_CONTENT';\n\nconst propTypes = {\n  dashboardId: PropTypes.number.isRequired,\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderType: PropTypes.oneOf([RENDER_TAB, RENDER_TAB_CONTENT]).isRequired,\n  onDropOnTab: PropTypes.func,\n  editMode: PropTypes.bool.isRequired,\n  canEdit: PropTypes.bool.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // redux\n  handleComponentDrop: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n  setDirectPathToChild: PropTypes.func.isRequired,\n  setEditMode: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  availableColumnCount: 0,\n  columnWidth: 0,\n  onDropOnTab() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {},\n};\n\nconst TabTitleContainer = styled.div`\n  ${({ isHighlighted, theme: { gridUnit, colors } }) => `\n    padding: ${gridUnit}px ${gridUnit * 2}px;\n    margin: ${-gridUnit}px ${gridUnit * -2}px;\n    transition: box-shadow 0.2s ease-in-out;\n    ${\n      isHighlighted && `box-shadow: 0 0 ${gridUnit}px ${colors.primary.light1};`\n    }\n  `}\n`;\n\nconst renderDraggableContentBottom = dropProps =>\n  dropProps.dropIndicatorProps && (\n    <div className=\"drop-indicator drop-indicator--bottom\" />\n  );\n\nconst renderDraggableContentTop = dropProps =>\n  dropProps.dropIndicatorProps && (\n    <div className=\"drop-indicator drop-indicator--top\" />\n  );\n\nclass Tab extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleChangeText = this.handleChangeText.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n    this.handleTopDropTargetDrop = this.handleTopDropTargetDrop.bind(this);\n    this.handleChangeTab = this.handleChangeTab.bind(this);\n  }\n\n  handleChangeTab({ pathToTabIndex }) {\n    this.props.setDirectPathToChild(pathToTabIndex);\n  }\n\n  handleChangeText(nextTabText) {\n    const { updateComponents, component } = this.props;\n    if (nextTabText && nextTabText !== component.meta.text) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            text: nextTabText,\n          },\n        },\n      });\n    }\n  }\n\n  handleDrop(dropResult) {\n    this.props.handleComponentDrop(dropResult);\n    this.props.onDropOnTab(dropResult);\n  }\n\n  handleTopDropTargetDrop(dropResult) {\n    if (dropResult) {\n      this.props.handleComponentDrop({\n        ...dropResult,\n        destination: {\n          ...dropResult.destination,\n          // force appending as the first child if top drop target\n          index: 0,\n        },\n      });\n    }\n  }\n\n  renderTabContent() {\n    const {\n      component: tabComponent,\n      parentComponent: tabParentComponent,\n      depth,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      editMode,\n      isComponentVisible,\n      canEdit,\n      setEditMode,\n      dashboardId,\n    } = this.props;\n\n    const shouldDisplayEmptyState = tabComponent.children.length === 0;\n    return (\n      <div className=\"dashboard-component-tabs-content\">\n        {/* Make top of tab droppable */}\n        {editMode && (\n          <DragDroppable\n            component={tabComponent}\n            parentComponent={tabParentComponent}\n            orientation=\"column\"\n            index={0}\n            depth={depth}\n            onDrop={this.handleTopDropTargetDrop}\n            editMode\n            className=\"empty-droptarget\"\n          >\n            {renderDraggableContentTop}\n          </DragDroppable>\n        )}\n        {shouldDisplayEmptyState && (\n          <EmptyStateMedium\n            title={\n              editMode\n                ? t('Drag and drop components to this tab')\n                : t('There are no components added to this tab')\n            }\n            description={\n              canEdit &&\n              (editMode ? (\n                <span>\n                  {t('You can')}{' '}\n                  <a\n                    href={`/chart/add?dashboard_id=${dashboardId}`}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                  >\n                    {t('create a new chart')}\n                  </a>{' '}\n                  {t('or use existing ones from the panel on the right')}\n                </span>\n              ) : (\n                <span>\n                  {t('You can add the components in the')}{' '}\n                  <span\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => setEditMode(true)}\n                  >\n                    {t('edit mode')}\n                  </span>\n                </span>\n              ))\n            }\n            image=\"chart.svg\"\n          />\n        )}\n        {tabComponent.children.map((componentId, componentIndex) => (\n          <DashboardComponent\n            key={componentId}\n            id={componentId}\n            parentId={tabComponent.id}\n            depth={depth} // see isValidChild.js for why tabs don't increment child depth\n            index={componentIndex}\n            onDrop={this.handleDrop}\n            availableColumnCount={availableColumnCount}\n            columnWidth={columnWidth}\n            onResizeStart={onResizeStart}\n            onResize={onResize}\n            onResizeStop={onResizeStop}\n            isComponentVisible={isComponentVisible}\n            onChangeTab={this.handleChangeTab}\n          />\n        ))}\n        {/* Make bottom of tab droppable */}\n        {editMode && (\n          <DragDroppable\n            component={tabComponent}\n            parentComponent={tabParentComponent}\n            orientation=\"column\"\n            index={tabComponent.children.length}\n            depth={depth}\n            onDrop={this.handleDrop}\n            editMode\n            className=\"empty-droptarget\"\n          >\n            {renderDraggableContentBottom}\n          </DragDroppable>\n        )}\n      </div>\n    );\n  }\n\n  renderTab() {\n    const {\n      component,\n      parentComponent,\n      index,\n      depth,\n      editMode,\n      isFocused,\n      isHighlighted,\n    } = this.props;\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation=\"column\"\n        index={index}\n        depth={depth}\n        onDrop={this.handleDrop}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <TabTitleContainer\n            isHighlighted={isHighlighted}\n            className=\"dragdroppable-tab\"\n            ref={dragSourceRef}\n          >\n            <EditableTitle\n              title={component.meta.text}\n              defaultTitle={component.meta.defaultText}\n              placeholder={component.meta.placeholder}\n              canEdit={editMode && isFocused}\n              onSaveTitle={this.handleChangeText}\n              showTooltip={false}\n              editing={editMode && isFocused}\n            />\n            {!editMode && (\n              <AnchorLink\n                id={component.id}\n                dashboardId={this.props.dashboardId}\n                placement={index >= 5 ? 'left' : 'right'}\n              />\n            )}\n\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </TabTitleContainer>\n        )}\n      </DragDroppable>\n    );\n  }\n\n  render() {\n    const { renderType } = this.props;\n    return renderType === RENDER_TAB\n      ? this.renderTab()\n      : this.renderTabContent();\n  }\n}\n\nTab.propTypes = propTypes;\nTab.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return {\n    canEdit: state.dashboardInfo.dash_edit_perm,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      setEditMode,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Tab);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function findTabIndexByComponentId({\n  currentComponent,\n  directPathToChild = [],\n}) {\n  if (\n    !currentComponent ||\n    directPathToChild.length === 0 ||\n    directPathToChild.indexOf(currentComponent.id) === -1\n  ) {\n    return -1;\n  }\n\n  const currentComponentIdx = directPathToChild.findIndex(\n    id => id === currentComponent.id,\n  );\n  const nextParentId = directPathToChild[currentComponentIdx + 1];\n  if (currentComponent.children.indexOf(nextParentId) >= 0) {\n    return currentComponent.children.findIndex(\n      childId => childId === nextParentId,\n    );\n  }\n  return -1;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function getDirectPathToTabIndex(tabsComponent, tabIndex) {\n  const directPathToFilter = (tabsComponent.parents || []).slice();\n  directPathToFilter.push(tabsComponent.id);\n  directPathToFilter.push(tabsComponent.children[tabIndex]);\n\n  return directPathToFilter;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { IN_COMPONENT_ELEMENT_TYPES } from './constants';\n\nexport default function getLeafComponentIdFromPath(directPathToChild = []) {\n  if (directPathToChild.length > 0) {\n    const currentPath = directPathToChild.slice();\n\n    while (currentPath.length) {\n      const componentId = currentPath.pop();\n      const componentType = componentId && componentId.split('-')[0];\n\n      if (!IN_COMPONENT_ELEMENT_TYPES.includes(componentType)) {\n        return componentId;\n      }\n    }\n  }\n\n  return null;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, t } from '@superset-ui/core';\nimport { connect } from 'react-redux';\nimport { LineEditableTabs } from 'src/components/Tabs';\nimport { LOG_ACTIONS_SELECT_DASHBOARD_TAB } from 'src/logger/LogUtils';\nimport { AntdModal } from 'src/components';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\nimport DragDroppable from '../dnd/DragDroppable';\nimport DragHandle from '../dnd/DragHandle';\nimport DashboardComponent from '../../containers/DashboardComponent';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport HoverMenu from '../menu/HoverMenu';\nimport findTabIndexByComponentId from '../../util/findTabIndexByComponentId';\nimport getDirectPathToTabIndex from '../../util/getDirectPathToTabIndex';\nimport getLeafComponentIdFromPath from '../../util/getLeafComponentIdFromPath';\nimport { componentShape } from '../../util/propShapes';\nimport { NEW_TAB_ID, DASHBOARD_ROOT_ID } from '../../util/constants';\nimport { RENDER_TAB, RENDER_TAB_CONTENT } from './Tab';\nimport { TABS_TYPE, TAB_TYPE } from '../../util/componentTypes';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderTabContent: PropTypes.bool, // whether to render tabs + content or just tabs\n  editMode: PropTypes.bool.isRequired,\n  renderHoverMenu: PropTypes.bool,\n  directPathToChild: PropTypes.arrayOf(PropTypes.string),\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES,\n\n  // actions (from DashboardComponent.jsx)\n  logEvent: PropTypes.func.isRequired,\n  setActiveTabs: PropTypes.func,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // dnd\n  createComponent: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  onChangeTab: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  renderTabContent: true,\n  renderHoverMenu: true,\n  availableColumnCount: 0,\n  columnWidth: 0,\n  directPathToChild: [],\n  filterboxMigrationState: FILTER_BOX_MIGRATION_STATES.NOOP,\n  setActiveTabs() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {},\n};\n\nconst StyledTabsContainer = styled.div`\n  width: 100%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light5};\n\n  .dashboard-component-tabs-content {\n    min-height: ${({ theme }) => theme.gridUnit * 12}px;\n    margin-top: ${({ theme }) => theme.gridUnit / 4}px;\n    position: relative;\n  }\n\n  .ant-tabs {\n    overflow: visible;\n\n    .ant-tabs-nav-wrap {\n      min-height: ${({ theme }) => theme.gridUnit * 12.5}px;\n    }\n\n    .ant-tabs-content-holder {\n      overflow: visible;\n    }\n  }\n\n  div .ant-tabs-tab-btn {\n    text-transform: none;\n  }\n`;\n\nexport class Tabs extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const tabIndex = Math.max(\n      0,\n      findTabIndexByComponentId({\n        currentComponent: props.component,\n        directPathToChild: props.directPathToChild,\n      }),\n    );\n    const { children: tabIds } = props.component;\n    const activeKey = tabIds[tabIndex];\n\n    this.state = {\n      tabIndex,\n      activeKey,\n    };\n    this.handleClickTab = this.handleClickTab.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleDeleteTab = this.handleDeleteTab.bind(this);\n    this.handleDropOnTab = this.handleDropOnTab.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.setActiveTabs(this.state.activeKey);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      prevState.activeKey !== this.state.activeKey ||\n      prevProps.filterboxMigrationState !== this.props.filterboxMigrationState\n    ) {\n      this.props.setActiveTabs(this.state.activeKey, prevState.activeKey);\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const maxIndex = Math.max(0, nextProps.component.children.length - 1);\n    const currTabsIds = this.props.component.children;\n    const nextTabsIds = nextProps.component.children;\n\n    if (this.state.tabIndex > maxIndex) {\n      this.setState(() => ({ tabIndex: maxIndex }));\n    }\n\n    if (nextProps.isComponentVisible) {\n      const nextFocusComponent = getLeafComponentIdFromPath(\n        nextProps.directPathToChild,\n      );\n      const currentFocusComponent = getLeafComponentIdFromPath(\n        this.props.directPathToChild,\n      );\n\n      // If the currently selected component is different than the new one,\n      // or the tab length/order changed, calculate the new tab index and\n      // replace it if it's different than the current one\n      if (\n        nextFocusComponent !== currentFocusComponent ||\n        (nextFocusComponent === currentFocusComponent &&\n          currTabsIds !== nextTabsIds)\n      ) {\n        const nextTabIndex = findTabIndexByComponentId({\n          currentComponent: nextProps.component,\n          directPathToChild: nextProps.directPathToChild,\n        });\n\n        // make sure nextFocusComponent is under this tabs component\n        if (nextTabIndex > -1 && nextTabIndex !== this.state.tabIndex) {\n          this.setState(() => ({\n            tabIndex: nextTabIndex,\n            activeKey: nextTabsIds[nextTabIndex],\n          }));\n        }\n      }\n    }\n  }\n\n  showDeleteConfirmModal = key => {\n    const { component, deleteComponent } = this.props;\n    AntdModal.confirm({\n      title: t('Delete dashboard tab?'),\n      content: (\n        <span>\n          Deleting a tab will remove all content within it. You may still\n          reverse this action with the <b>undo</b> button (cmd + z) until you\n          save your changes.\n        </span>\n      ),\n      onOk: () => {\n        deleteComponent(key, component.id);\n        const tabIndex = component.children.indexOf(key);\n        this.handleDeleteTab(tabIndex);\n      },\n      okType: 'danger',\n      okText: 'DELETE',\n      cancelText: 'CANCEL',\n      icon: null,\n    });\n  };\n\n  handleEdit = (event, action) => {\n    const { component, createComponent } = this.props;\n    if (action === 'add') {\n      // Prevent the tab container to be selected\n      event?.stopPropagation?.();\n\n      createComponent({\n        destination: {\n          id: component.id,\n          type: component.type,\n          index: component.children.length,\n        },\n        dragging: {\n          id: NEW_TAB_ID,\n          type: TAB_TYPE,\n        },\n      });\n    } else if (action === 'remove') {\n      this.showDeleteConfirmModal(event);\n    }\n  };\n\n  handleClickTab(tabIndex) {\n    const { component } = this.props;\n    const { children: tabIds } = component;\n\n    if (tabIndex !== this.state.tabIndex) {\n      const pathToTabIndex = getDirectPathToTabIndex(component, tabIndex);\n      const targetTabId = pathToTabIndex[pathToTabIndex.length - 1];\n      this.props.logEvent(LOG_ACTIONS_SELECT_DASHBOARD_TAB, {\n        target_id: targetTabId,\n        index: tabIndex,\n      });\n\n      this.props.onChangeTab({ pathToTabIndex });\n    }\n    this.setState(() => ({ activeKey: tabIds[tabIndex] }));\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleDeleteTab(tabIndex) {\n    // If we're removing the currently selected tab,\n    // select the previous one (if any)\n    if (this.state.tabIndex === tabIndex) {\n      this.handleClickTab(Math.max(0, tabIndex - 1));\n    }\n  }\n\n  handleDropOnTab(dropResult) {\n    const { component } = this.props;\n\n    // Ensure dropped tab is visible\n    const { destination } = dropResult;\n    if (destination) {\n      const dropTabIndex =\n        destination.id === component.id\n          ? destination.index // dropped ON tabs\n          : component.children.indexOf(destination.id); // dropped IN tab\n\n      if (dropTabIndex > -1) {\n        setTimeout(() => {\n          this.handleClickTab(dropTabIndex);\n        }, 30);\n      }\n    }\n  }\n\n  handleDrop(dropResult) {\n    if (dropResult.dragging.type !== TABS_TYPE) {\n      this.props.handleComponentDrop(dropResult);\n    }\n  }\n\n  render() {\n    const {\n      depth,\n      component: tabsComponent,\n      parentComponent,\n      index,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      renderTabContent,\n      renderHoverMenu,\n      isComponentVisible: isCurrentTabVisible,\n      editMode,\n      nativeFilters,\n    } = this.props;\n\n    const { children: tabIds } = tabsComponent;\n    const { tabIndex: selectedTabIndex, activeKey } = this.state;\n\n    let tabsToHighlight;\n    if (nativeFilters?.focusedFilterId) {\n      tabsToHighlight =\n        nativeFilters.filters[nativeFilters.focusedFilterId].tabsInScope;\n    }\n    return (\n      <DragDroppable\n        component={tabsComponent}\n        parentComponent={parentComponent}\n        orientation=\"row\"\n        index={index}\n        depth={depth}\n        onDrop={this.handleDrop}\n        editMode={editMode}\n      >\n        {({\n          dropIndicatorProps: tabsDropIndicatorProps,\n          dragSourceRef: tabsDragSourceRef,\n        }) => (\n          <StyledTabsContainer\n            className=\"dashboard-component dashboard-component-tabs\"\n            data-test=\"dashboard-component-tabs\"\n          >\n            {editMode && renderHoverMenu && (\n              <HoverMenu innerRef={tabsDragSourceRef} position=\"left\">\n                <DragHandle position=\"left\" />\n                <DeleteComponentButton onDelete={this.handleDeleteComponent} />\n              </HoverMenu>\n            )}\n\n            <LineEditableTabs\n              id={tabsComponent.id}\n              activeKey={activeKey}\n              onChange={key => {\n                this.handleClickTab(tabIds.indexOf(key));\n              }}\n              onEdit={this.handleEdit}\n              data-test=\"nav-list\"\n              type={editMode ? 'editable-card' : 'card'}\n            >\n              {tabIds.map((tabId, tabIndex) => (\n                <LineEditableTabs.TabPane\n                  key={tabId}\n                  tab={\n                    <DashboardComponent\n                      id={tabId}\n                      parentId={tabsComponent.id}\n                      depth={depth}\n                      index={tabIndex}\n                      renderType={RENDER_TAB}\n                      availableColumnCount={availableColumnCount}\n                      columnWidth={columnWidth}\n                      onDropOnTab={this.handleDropOnTab}\n                      isFocused={activeKey === tabId}\n                      isHighlighted={\n                        activeKey !== tabId && tabsToHighlight?.includes(tabId)\n                      }\n                    />\n                  }\n                >\n                  {renderTabContent && (\n                    <DashboardComponent\n                      id={tabId}\n                      parentId={tabsComponent.id}\n                      depth={depth} // see isValidChild.js for why tabs don't increment child depth\n                      index={tabIndex}\n                      renderType={RENDER_TAB_CONTENT}\n                      availableColumnCount={availableColumnCount}\n                      columnWidth={columnWidth}\n                      onResizeStart={onResizeStart}\n                      onResize={onResize}\n                      onResizeStop={onResizeStop}\n                      onDropOnTab={this.handleDropOnTab}\n                      isComponentVisible={\n                        selectedTabIndex === tabIndex && isCurrentTabVisible\n                      }\n                    />\n                  )}\n                </LineEditableTabs.TabPane>\n              ))}\n            </LineEditableTabs>\n\n            {/* don't indicate that a drop on root is allowed when tabs already exist */}\n            {tabsDropIndicatorProps &&\n              parentComponent.id !== DASHBOARD_ROOT_ID && (\n                <div {...tabsDropIndicatorProps} />\n              )}\n          </StyledTabsContainer>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nTabs.propTypes = propTypes;\nTabs.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return {\n    nativeFilters: state.nativeFilters,\n    directPathToChild: state.dashboardState.directPathToChild,\n    filterboxMigrationState: state.dashboardState.filterboxMigrationState,\n  };\n}\nexport default connect(mapStateToProps)(Tabs);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CHART_TYPE,\n  MARKDOWN_TYPE,\n  COLUMN_TYPE,\n  DIVIDER_TYPE,\n  HEADER_TYPE,\n  ROW_TYPE,\n  TAB_TYPE,\n  TABS_TYPE,\n  DYNAMIC_TYPE,\n} from '../../util/componentTypes';\n\nimport ChartHolder from './ChartHolder';\nimport Markdown from './Markdown';\nimport Column from './Column';\nimport Divider from './Divider';\nimport Header from './Header';\nimport Row from './Row';\nimport Tab from './Tab';\nimport TabsConnected from './Tabs';\nimport DynamicComponent from './DynamicComponent';\n\nexport { default as ChartHolder } from './ChartHolder';\nexport { default as Markdown } from './Markdown';\nexport { default as Column } from './Column';\nexport { default as Divider } from './Divider';\nexport { default as Header } from './Header';\nexport { default as Row } from './Row';\nexport { default as Tab } from './Tab';\nexport { default as Tabs } from './Tabs';\nexport { default as DynamicComponent } from './DynamicComponent';\n\nexport const componentLookup = {\n  [CHART_TYPE]: ChartHolder,\n  [MARKDOWN_TYPE]: Markdown,\n  [COLUMN_TYPE]: Column,\n  [DIVIDER_TYPE]: Divider,\n  [HEADER_TYPE]: Header,\n  [ROW_TYPE]: Row,\n  [TAB_TYPE]: Tab,\n  [TABS_TYPE]: TabsConnected,\n  [DYNAMIC_TYPE]: DynamicComponent,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, Suspense } from 'react';\nimport { DashboardComponentMetadata, JsonObject, t } from '@superset-ui/core';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport cx from 'classnames';\nimport { useSelector } from 'react-redux';\nimport DragDroppable from '../dnd/DragDroppable';\nimport { COLUMN_TYPE, ROW_TYPE } from '../../util/componentTypes';\nimport WithPopoverMenu from '../menu/WithPopoverMenu';\nimport ResizableContainer from '../resizable/ResizableContainer';\nimport {\n  BACKGROUND_TRANSPARENT,\n  GRID_BASE_UNIT,\n  GRID_MIN_COLUMN_COUNT,\n} from '../../util/constants';\nimport HoverMenu from '../menu/HoverMenu';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport BackgroundStyleDropdown from '../menu/BackgroundStyleDropdown';\nimport dashboardComponents from '../../../visualizations/presets/dashboardComponents';\nimport { RootState } from '../../types';\n\ntype FilterSummaryType = {\n  component: JsonObject;\n  parentComponent: JsonObject;\n  index: number;\n  depth: number;\n  handleComponentDrop: (...args: any[]) => any;\n  editMode: boolean;\n  columnWidth: number;\n  availableColumnCount: number;\n  onResizeStart: Function;\n  onResizeStop: Function;\n  onResize: Function;\n  deleteComponent: Function;\n  updateComponents: Function;\n  parentId: number;\n  id: number;\n};\n\nconst DynamicComponent: FC<FilterSummaryType> = ({\n  component,\n  parentComponent,\n  index,\n  depth,\n  handleComponentDrop,\n  editMode,\n  columnWidth,\n  availableColumnCount,\n  onResizeStart,\n  onResizeStop,\n  onResize,\n  deleteComponent,\n  parentId,\n  updateComponents,\n  id,\n}) => {\n  // inherit the size of parent columns\n  const widthMultiple =\n    parentComponent.type === COLUMN_TYPE\n      ? parentComponent.meta.width || GRID_MIN_COLUMN_COUNT\n      : component.meta.width || GRID_MIN_COLUMN_COUNT;\n\n  const handleDeleteComponent = () => {\n    deleteComponent(id, parentId);\n  };\n\n  const rowStyle = backgroundStyleOptions.find(\n    opt => opt.value === (component.meta.background || BACKGROUND_TRANSPARENT),\n  );\n\n  const updateMeta = (metaKey: string, nextValue: string | number) => {\n    updateComponents({\n      [component.id]: {\n        ...component,\n        meta: {\n          ...component.meta,\n          [metaKey]: nextValue,\n        },\n      },\n    });\n  };\n\n  const { Component } = dashboardComponents.get(component.meta.componentKey);\n  const dashboardData = useSelector<RootState, DashboardComponentMetadata>(\n    ({ nativeFilters, dataMask }) => ({\n      nativeFilters,\n      dataMask,\n    }),\n  );\n\n  return (\n    <DragDroppable\n      // @ts-ignore\n      component={component}\n      // @ts-ignore\n      parentComponent={parentComponent}\n      orientation={parentComponent.type === ROW_TYPE ? 'column' : 'row'}\n      index={index}\n      depth={depth}\n      onDrop={handleComponentDrop}\n      editMode={editMode}\n    >\n      {({ dropIndicatorProps, dragSourceRef }) => (\n        <WithPopoverMenu\n          menuItems={[\n            <BackgroundStyleDropdown\n              id={`${component.id}-background`}\n              value={component.meta.background}\n              onChange={value => updateMeta('background', value)}\n            />,\n          ]}\n          editMode={editMode}\n        >\n          <div\n            data-test={`dashboard-${component.componentKey}`}\n            className={cx(\n              'dashboard-component',\n              `dashboard-${component.componentKey}`,\n              rowStyle?.className,\n            )}\n            id={component.id}\n          >\n            <ResizableContainer\n              id={component.id}\n              adjustableWidth={parentComponent.type === ROW_TYPE}\n              widthStep={columnWidth}\n              widthMultiple={widthMultiple}\n              heightStep={GRID_BASE_UNIT}\n              adjustableHeight={false}\n              heightMultiple={component.meta.height}\n              minWidthMultiple={GRID_MIN_COLUMN_COUNT}\n              minHeightMultiple={GRID_MIN_COLUMN_COUNT}\n              maxWidthMultiple={availableColumnCount + widthMultiple}\n              onResizeStart={onResizeStart}\n              onResize={onResize}\n              onResizeStop={onResizeStop}\n            >\n              <div\n                ref={dragSourceRef}\n                className=\"dashboard-component\"\n                data-test=\"dashboard-component-chart-holder\"\n              >\n                {editMode && (\n                  <HoverMenu position=\"top\">\n                    <DeleteComponentButton onDelete={handleDeleteComponent} />\n                  </HoverMenu>\n                )}\n                <Suspense fallback={<div>{t('Loading...')}</div>}>\n                  <Component dashboardData={dashboardData} />\n                </Suspense>\n              </div>\n            </ResizableContainer>\n          </div>\n          {dropIndicatorProps && <div {...dropIndicatorProps} />}\n        </WithPopoverMenu>\n      )}\n    </DragDroppable>\n  );\n};\nexport default DynamicComponent;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { logEvent } from 'src/logger/actions';\nimport { addDangerToast } from 'src/components/MessageToasts/actions';\nimport { componentLookup } from 'src/dashboard/components/gridComponents';\nimport getDetailedComponentWidth from 'src/dashboard/util/getDetailedComponentWidth';\nimport { getActiveFilters } from 'src/dashboard/util/activeDashboardFilters';\nimport { componentShape } from 'src/dashboard/util/propShapes';\nimport { COLUMN_TYPE, ROW_TYPE } from 'src/dashboard/util/componentTypes';\nimport {\n  createComponent,\n  deleteComponent,\n  updateComponents,\n  handleComponentDrop,\n} from 'src/dashboard/actions/dashboardLayout';\nimport {\n  setDirectPathToChild,\n  setActiveTabs,\n  setFullSizeChartId,\n  postAddSliceFromDashboard,\n} from 'src/dashboard/actions/dashboardState';\n\nconst propTypes = {\n  id: PropTypes.string,\n  parentId: PropTypes.string,\n  depth: PropTypes.number,\n  index: PropTypes.number,\n  renderHoverMenu: PropTypes.bool,\n  renderTabContent: PropTypes.bool,\n  onChangeTab: PropTypes.func,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  createComponent: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  logEvent: PropTypes.func.isRequired,\n  directPathToChild: PropTypes.arrayOf(PropTypes.string),\n  directPathLastUpdated: PropTypes.number,\n  dashboardId: PropTypes.number.isRequired,\n  isComponentVisible: PropTypes.bool,\n};\n\nconst defaultProps = {\n  isComponentVisible: true,\n};\n\nfunction mapStateToProps(\n  { dashboardLayout: undoableLayout, dashboardState, dashboardInfo },\n  ownProps,\n) {\n  const dashboardLayout = undoableLayout.present;\n  const { id, parentId } = ownProps;\n  const component = dashboardLayout[id];\n  const props = {\n    component,\n    getComponentById: id => dashboardLayout[id],\n    parentComponent: dashboardLayout[parentId],\n    editMode: dashboardState.editMode,\n    filters: getActiveFilters(),\n    dashboardId: dashboardInfo.id,\n    fullSizeChartId: dashboardState.fullSizeChartId,\n  };\n\n  // rows and columns need more data about their child dimensions\n  // doing this allows us to not pass the entire component lookup to all Components\n  if (component) {\n    const componentType = component.type;\n    if (componentType === ROW_TYPE || componentType === COLUMN_TYPE) {\n      const { occupiedWidth, minimumWidth } = getDetailedComponentWidth({\n        id,\n        components: dashboardLayout,\n      });\n\n      if (componentType === ROW_TYPE) props.occupiedColumnCount = occupiedWidth;\n      if (componentType === COLUMN_TYPE) props.minColumnWidth = minimumWidth;\n    }\n  }\n\n  return props;\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      addDangerToast,\n      createComponent,\n      deleteComponent,\n      updateComponents,\n      handleComponentDrop,\n      setDirectPathToChild,\n      setFullSizeChartId,\n      setActiveTabs,\n      logEvent,\n      postAddSliceFromDashboard,\n    },\n    dispatch,\n  );\n}\n\nclass DashboardComponent extends React.PureComponent {\n  render() {\n    const { component } = this.props;\n    const Component = component ? componentLookup[component.type] : null;\n    return Component ? <Component {...this.props} /> : null;\n  }\n}\n\nDashboardComponent.propTypes = propTypes;\nDashboardComponent.defaultProps = defaultProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DashboardComponent);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport { DataMaskStateWithId, Filter, FilterState } from '@superset-ui/core';\n\nexport enum TabIds {\n  AllFilters = 'allFilters',\n  FilterSets = 'filterSets',\n}\n\nexport const getOnlyExtraFormData = (data: DataMaskStateWithId) =>\n  Object.values(data).reduce(\n    (prev, next) => ({ ...prev, [next.id]: next.extraFormData }),\n    {},\n  );\n\nexport const checkIsMissingRequiredValue = (\n  filter: Filter,\n  filterState?: FilterState,\n) => {\n  const value = filterState?.value;\n  // TODO: this property should be unhardcoded\n  return (\n    filter.controlValues?.enableEmptyFilter &&\n    (value === null || value === undefined)\n  );\n};\n\nexport const checkIsApplyDisabled = (\n  dataMaskSelected: DataMaskStateWithId,\n  dataMaskApplied: DataMaskStateWithId,\n  filters: Filter[],\n) => {\n  const dataSelectedValues = Object.values(dataMaskSelected);\n  const dataAppliedValues = Object.values(dataMaskApplied);\n  return (\n    areObjectsEqual(\n      getOnlyExtraFormData(dataMaskSelected),\n      getOnlyExtraFormData(dataMaskApplied),\n      { ignoreUndefined: true },\n    ) ||\n    dataSelectedValues.length !== dataAppliedValues.length ||\n    filters.some(filter =>\n      checkIsMissingRequiredValue(\n        filter,\n        dataMaskSelected?.[filter?.id]?.filterState,\n      ),\n    )\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport { useSelector } from 'react-redux';\nimport { filter, keyBy } from 'lodash';\nimport {\n  DataMaskState,\n  DataMaskStateWithId,\n  DataMaskWithId,\n  Filter,\n  Filters,\n  FilterSets as FilterSetsType,\n} from '@superset-ui/core';\nimport { useContext, useEffect, useMemo, useState } from 'react';\nimport { ChartsState, RootState } from 'src/dashboard/types';\nimport { MigrationContext } from 'src/dashboard/containers/DashboardPage';\nimport { FILTER_BOX_MIGRATION_STATES } from 'src/explore/constants';\nimport { NATIVE_FILTER_PREFIX } from '../FiltersConfigModal/utils';\n\nexport const useFilterSets = () =>\n  useSelector<any, FilterSetsType>(\n    state => state.nativeFilters.filterSets || {},\n  );\n\nexport const useFilters = () => {\n  const preselectedNativeFilters = useSelector<any, Filters>(\n    state => state.dashboardState?.preselectNativeFilters,\n  );\n  const nativeFilters = useSelector<RootState, Filters>(\n    state => state.nativeFilters.filters,\n  );\n  return useMemo(\n    () =>\n      Object.entries(nativeFilters).reduce(\n        (acc, [filterId, filter]: [string, Filter]) => ({\n          ...acc,\n          [filterId]: {\n            ...filter,\n            preselect: preselectedNativeFilters?.[filterId],\n          },\n        }),\n        {} as Filters,\n      ),\n    [nativeFilters, preselectedNativeFilters],\n  );\n};\n\nexport const useNativeFiltersDataMask = () => {\n  const dataMask = useSelector<RootState, DataMaskStateWithId>(\n    state => state.dataMask,\n  );\n\n  return useMemo(\n    () =>\n      Object.values(dataMask)\n        .filter((item: DataMaskWithId) =>\n          String(item.id).startsWith(NATIVE_FILTER_PREFIX),\n        )\n        .reduce(\n          (prev, next: DataMaskWithId) => ({ ...prev, [next.id]: next }),\n          {},\n        ) as DataMaskStateWithId,\n    [dataMask],\n  );\n};\n\nexport const useFilterUpdates = (\n  dataMaskSelected: DataMaskState,\n  setDataMaskSelected: (arg0: (arg0: DataMaskState) => void) => void,\n) => {\n  const filters = useFilters();\n  const dataMaskApplied = useNativeFiltersDataMask();\n  useEffect(() => {\n    // Remove deleted filters from local state\n    Object.keys(dataMaskSelected).forEach(selectedId => {\n      if (!filters[selectedId]) {\n        setDataMaskSelected(draft => {\n          delete draft[selectedId];\n        });\n      }\n    });\n  }, [dataMaskApplied, dataMaskSelected, filters, setDataMaskSelected]);\n};\n\n// Load filters after charts loaded\nexport const useInitialization = () => {\n  const [isInitialized, setIsInitialized] = useState<boolean>(false);\n  const filters = useFilters();\n  const filterboxMigrationState = useContext(MigrationContext);\n  let charts = useSelector<RootState, ChartsState>(state => state.charts);\n\n  // We need to know how much charts now shown on dashboard to know how many of all charts should be loaded\n  let numberOfLoadingCharts = 0;\n  if (!isInitialized) {\n    // do not load filter_box in reviewing\n    if (filterboxMigrationState === FILTER_BOX_MIGRATION_STATES.REVIEWING) {\n      charts = keyBy(\n        filter(charts, chart => chart.formData?.viz_type !== 'filter_box'),\n        'id',\n      );\n      const numberOfFilterbox = document.querySelectorAll(\n        '[data-test-viz-type=\"filter_box\"]',\n      ).length;\n\n      numberOfLoadingCharts =\n        document.querySelectorAll('[data-ui-anchor=\"chart\"]').length -\n        numberOfFilterbox;\n    } else {\n      numberOfLoadingCharts = document.querySelectorAll(\n        '[data-ui-anchor=\"chart\"]',\n      ).length;\n    }\n  }\n  useEffect(() => {\n    if (isInitialized) {\n      return;\n    }\n\n    if (Object.values(filters).find(({ requiredFirst }) => requiredFirst)) {\n      setIsInitialized(true);\n      return;\n    }\n\n    // For some dashboards may be there are no charts on first page,\n    // so we check up to 1 sec if there is at least on chart to load\n    let filterTimeout: NodeJS.Timeout;\n    if (numberOfLoadingCharts === 0) {\n      filterTimeout = setTimeout(() => {\n        setIsInitialized(true);\n      }, 1000);\n    }\n\n    // @ts-ignore\n    if (numberOfLoadingCharts > 0 && filterTimeout !== undefined) {\n      clearTimeout(filterTimeout);\n    }\n\n    const numberOfLoadedCharts = Object.values(charts).filter(\n      ({ chartStatus }) => chartStatus !== 'loading',\n    ).length;\n    if (\n      numberOfLoadingCharts > 0 &&\n      numberOfLoadedCharts >= numberOfLoadingCharts\n    ) {\n      setIsInitialized(true);\n    }\n  }, [charts, isInitialized, numberOfLoadingCharts]);\n\n  return isInitialized;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useMemo } from 'react';\nimport { useFilterSets } from '../state';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const useFilterSetNameDuplicated = (\n  filterSetName: string,\n  ignoreName?: string,\n) => {\n  const filterSets = useFilterSets();\n  const filterSetFilterValues = Object.values(filterSets);\n  const isFilterSetNameDuplicated = useMemo(\n    () => !!filterSetFilterValues.find(({ name }) => name === filterSetName),\n    [filterSetFilterValues, filterSetName],\n  );\n  if (ignoreName === filterSetName) {\n    return false;\n  }\n  return isFilterSetNameDuplicated;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, styled } from '@superset-ui/core';\nimport React, { FC } from 'react';\nimport Button from 'src/components/Button';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { APPLY_FILTERS_HINT } from './utils';\nimport { useFilterSetNameDuplicated } from './state';\nimport { getFilterBarTestId } from '..';\n\nexport type FooterProps = {\n  filterSetName: string;\n  disabled: boolean;\n  editMode: boolean;\n  onCancel: () => void;\n  onEdit: () => void;\n  onCreate: () => void;\n};\n\nconst ActionButton = styled.div<{ disabled: boolean }>`\n  display: flex;\n  & button {\n    ${({ disabled }) => `pointer-events: ${disabled ? 'none' : 'all'}`};\n    flex: 1;\n  }\n`;\n\nexport const ActionButtons = styled.div`\n  display: grid;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  grid-gap: 10px;\n  grid-template-columns: 1fr 1fr;\n`;\n\nconst Footer: FC<FooterProps> = ({\n  onCancel,\n  editMode,\n  onEdit,\n  onCreate,\n  disabled,\n  filterSetName,\n}) => {\n  const isFilterSetNameDuplicated = useFilterSetNameDuplicated(filterSetName);\n\n  const isCreateDisabled =\n    !filterSetName || isFilterSetNameDuplicated || disabled;\n\n  return (\n    <>\n      {editMode ? (\n        <ActionButtons>\n          <Button\n            buttonStyle=\"tertiary\"\n            buttonSize=\"small\"\n            onClick={onCancel}\n            data-test=\"filter-set-cancel-button\"\n          >\n            {t('Cancel')}\n          </Button>\n          <Tooltip\n            placement=\"right\"\n            title={\n              (!filterSetName && t('Please filter set name')) ||\n              (isFilterSetNameDuplicated &&\n                t('Filter set with this name already exists')) ||\n              (disabled && APPLY_FILTERS_HINT)\n            }\n          >\n            <ActionButton disabled={isCreateDisabled}>\n              <Button\n                disabled={isCreateDisabled}\n                buttonStyle=\"primary\"\n                htmlType=\"submit\"\n                buttonSize=\"small\"\n                onClick={onCreate}\n                {...getFilterBarTestId('create-filter-set-button')}\n              >\n                {t('Create')}\n              </Button>\n            </ActionButton>\n          </Tooltip>\n        </ActionButtons>\n      ) : (\n        <Tooltip placement=\"bottom\" title={disabled && APPLY_FILTERS_HINT}>\n          <ActionButton disabled={disabled}>\n            <Button\n              disabled={disabled}\n              buttonStyle=\"tertiary\"\n              buttonSize=\"small\"\n              onClick={onEdit}\n              {...getFilterBarTestId('new-filter-set-button')}\n            >\n              {t('Create new filter set')}\n            </Button>\n          </ActionButton>\n        </Tooltip>\n      )}\n    </>\n  );\n};\n\nexport default Footer;\n","// This icon file is generated automatically.\nvar CheckOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z\" } }] }, \"name\": \"check\", \"theme\": \"outlined\" };\nexport default CheckOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport CheckOutlinedSvg from \"@ant-design/icons-svg/es/asn/CheckOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CheckOutlined = function CheckOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: CheckOutlinedSvg\n  }));\n};\n\nCheckOutlined.displayName = 'CheckOutlined';\nexport default React.forwardRef(CheckOutlined);","// This icon file is generated automatically.\nvar EllipsisOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z\" } }] }, \"name\": \"ellipsis\", \"theme\": \"outlined\" };\nexport default EllipsisOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport EllipsisOutlinedSvg from \"@ant-design/icons-svg/es/asn/EllipsisOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar EllipsisOutlined = function EllipsisOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: EllipsisOutlinedSvg\n  }));\n};\n\nEllipsisOutlined.displayName = 'EllipsisOutlined';\nexport default React.forwardRef(EllipsisOutlined);","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC } from 'react';\nimport {\n  DataMaskState,\n  FilterSet,\n  isNativeFilter,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { Typography, AntdTooltip, AntdCollapse } from 'src/components';\nimport Icons from 'src/components/Icons';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport { getFilterValueForDisplay } from './utils';\nimport { useFilters } from '../state';\nimport { getFilterBarTestId } from '../index';\n\nconst FilterHeader = styled.div`\n  display: flex;\n  align-items: center;\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n`;\n\nconst StyledCollapse = styled(AntdCollapse)`\n  &.ant-collapse-ghost > .ant-collapse-item {\n    & > .ant-collapse-content > .ant-collapse-content-box {\n      padding: 0;\n      padding-top: 0;\n      padding-bottom: 0;\n      font-size: ${({ theme }) => theme.typography.sizes.s}px;\n    }\n    & > .ant-collapse-header {\n      padding: 0;\n      display: flex;\n      align-items: center;\n      flex-direction: row-reverse;\n      justify-content: flex-end;\n      max-width: max-content;\n      & .ant-collapse-arrow {\n        position: static;\n        padding-left: ${({ theme }) => theme.gridUnit}px;\n      }\n  }\n`;\n\nconst StyledFilterRow = styled.div`\n  padding-top: ${({ theme }) => theme.gridUnit}px;\n  padding-bottom: ${({ theme }) => theme.gridUnit}px;\n`;\n\nexport type FiltersHeaderProps = {\n  dataMask?: DataMaskState;\n  filterSet?: FilterSet;\n};\n\nconst FiltersHeader: FC<FiltersHeaderProps> = ({ dataMask, filterSet }) => {\n  const theme = useTheme();\n  const filters = useFilters();\n  const filterValues = Object.values(filters).filter(isNativeFilter);\n\n  let resultFilters = filterValues ?? [];\n  if (filterSet?.nativeFilters) {\n    resultFilters = Object.values(filterSet?.nativeFilters).filter(\n      isNativeFilter,\n    );\n  }\n\n  const getFiltersHeader = () => (\n    <FilterHeader>\n      <Typography.Text type=\"secondary\">\n        {t('Filters (%d)', resultFilters.length)}\n      </Typography.Text>\n    </FilterHeader>\n  );\n\n  const getFilterRow = ({ id, name }: { id: string; name: string }) => {\n    const changedFilter =\n      filterSet &&\n      !areObjectsEqual(\n        filters[id]?.controlValues,\n        filterSet?.nativeFilters?.[id]?.controlValues,\n        {\n          ignoreUndefined: true,\n        },\n      );\n    const removedFilter = !Object.keys(filters).includes(id);\n\n    return (\n      <AntdTooltip\n        title={\n          (removedFilter &&\n            t(\n              \"This filter doesn't exist in dashboard. It will not be applied.\",\n            )) ||\n          (changedFilter &&\n            t('Filter metadata changed in dashboard. It will not be applied.'))\n        }\n        placement=\"bottomLeft\"\n        key={id}\n      >\n        <StyledFilterRow data-test=\"filter-info\">\n          <Typography.Text strong delete={removedFilter} mark={changedFilter}>\n            {name}:&nbsp;\n          </Typography.Text>\n          <Typography.Text delete={removedFilter} mark={changedFilter}>\n            {getFilterValueForDisplay(dataMask?.[id]?.filterState?.value) || (\n              <Typography.Text type=\"secondary\">{t('None')}</Typography.Text>\n            )}\n          </Typography.Text>\n        </StyledFilterRow>\n      </AntdTooltip>\n    );\n  };\n\n  const getExpandIcon = ({ isActive }: { isActive: boolean }) => {\n    const color = theme.colors.grayscale.base;\n    const Icon = isActive ? Icons.CaretUpOutlined : Icons.CaretDownOutlined;\n    return <Icon iconColor={color} />;\n  };\n\n  return (\n    <StyledCollapse\n      ghost\n      expandIconPosition=\"right\"\n      defaultActiveKey={!filterSet ? ['filters'] : undefined}\n      expandIcon={getExpandIcon}\n    >\n      <AntdCollapse.Panel\n        {...getFilterBarTestId('collapse-filter-set-description')}\n        header={getFiltersHeader()}\n        key=\"filters\"\n      >\n        {resultFilters.map(getFilterRow)}\n      </AntdCollapse.Panel>\n    </StyledCollapse>\n  );\n};\n\nexport default FiltersHeader;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AntdDropdown, Typography } from 'src/components';\nimport { Menu } from 'src/components/Menu';\nimport React, { FC } from 'react';\nimport {\n  DataMaskState,\n  FilterSet,\n  HandlerFunction,\n  styled,\n  useTheme,\n  t,\n} from '@superset-ui/core';\nimport { CheckOutlined, EllipsisOutlined } from '@ant-design/icons';\nimport Button from 'src/components/Button';\nimport { Tooltip } from 'src/components/Tooltip';\nimport FiltersHeader from './FiltersHeader';\nimport { getFilterBarTestId } from '..';\n\nconst HeaderButton = styled(Button)`\n  padding: 0;\n`;\n\nconst TitleText = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst IconsBlock = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  & > *,\n  & > button.superset-button {\n    ${({ theme }) => `margin-left: ${theme.gridUnit * 2}px`};\n  }\n`;\n\nexport type FilterSetUnitProps = {\n  editMode?: boolean;\n  isApplied?: boolean;\n  filterSet?: FilterSet;\n  filterSetName?: string;\n  dataMaskSelected?: DataMaskState;\n  setFilterSetName?: (name: string) => void;\n  onDelete?: HandlerFunction;\n  onEdit?: HandlerFunction;\n  onRebuild?: HandlerFunction;\n};\n\nconst FilterSetUnit: FC<FilterSetUnitProps> = ({\n  editMode,\n  setFilterSetName,\n  onDelete,\n  onEdit,\n  filterSetName,\n  dataMaskSelected,\n  filterSet,\n  isApplied,\n  onRebuild,\n}) => {\n  const theme = useTheme();\n\n  const menu = (\n    <Menu>\n      <Menu.Item onClick={onEdit}>{t('Edit')}</Menu.Item>\n      <Menu.Item onClick={onRebuild}>\n        <Tooltip placement=\"right\" title={t('Remove invalid filters')}>\n          {t('Rebuild')}\n        </Tooltip>\n      </Menu.Item>\n      <Menu.Item onClick={onDelete} danger>\n        {t('Delete')}\n      </Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <>\n      <TitleText>\n        <Typography.Text\n          strong\n          editable={{\n            editing: editMode,\n            icon: <span />,\n            onChange: setFilterSetName,\n          }}\n        >\n          {filterSet?.name ?? filterSetName}\n        </Typography.Text>\n        <IconsBlock>\n          {isApplied && (\n            <CheckOutlined style={{ color: theme.colors.success.base }} />\n          )}\n          {onDelete && (\n            <AntdDropdown\n              overlay={menu}\n              placement=\"bottomRight\"\n              trigger={['click']}\n            >\n              <HeaderButton\n                onClick={e => {\n                  e.stopPropagation();\n                  e.preventDefault();\n                }}\n                {...getFilterBarTestId('filter-set-menu-button')}\n                buttonStyle=\"link\"\n                buttonSize=\"xsmall\"\n              >\n                <EllipsisOutlined />\n              </HeaderButton>\n            </AntdDropdown>\n          )}\n        </IconsBlock>\n      </TitleText>\n      <FiltersHeader\n        filterSet={filterSet}\n        dataMask={filterSet?.dataMask ?? dataMaskSelected}\n      />\n    </>\n  );\n};\n\nexport default FilterSetUnit;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport {\n  DataMask,\n  DataMaskState,\n  DataMaskWithId,\n  Filter,\n  Filters,\n  FilterSet,\n  HandlerFunction,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { useDispatch } from 'react-redux';\nimport {\n  createFilterSet,\n  deleteFilterSet,\n  updateFilterSet,\n} from 'src/dashboard/actions/nativeFilters';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport { findExistingFilterSet } from './utils';\nimport { useFilters, useNativeFiltersDataMask, useFilterSets } from '../state';\nimport Footer from './Footer';\nimport FilterSetUnit from './FilterSetUnit';\nimport { getFilterBarTestId } from '..';\nimport { TabIds } from '../utils';\n\nconst FilterSetsWrapper = styled.div`\n  display: grid;\n  align-items: center;\n  justify-content: center;\n  grid-template-columns: 1fr;\n  // 108px padding to make room for buttons with position: absolute\n  padding-bottom: ${({ theme }) => theme.gridUnit * 27}px;\n\n  & button.superset-button {\n    margin-left: 0;\n  }\n  & input {\n    width: 100%;\n  }\n`;\n\nconst FilterSetUnitWrapper = styled.div<{\n  onClick?: HandlerFunction;\n  'data-selected'?: boolean;\n}>`\n  ${({ theme, 'data-selected': selected, onClick }) => `\n    display: grid;\n    align-items: center;\n    justify-content: center;\n    grid-template-columns: 1fr;\n    grid-gap: ${theme.gridUnit}px;\n    border-bottom: 1px solid ${theme.colors.grayscale.light2};\n    padding: ${theme.gridUnit * 2}px ${theme.gridUnit * 4}px;\n    cursor: ${!onClick ? 'auto' : 'pointer'};\n    background: ${selected ? theme.colors.primary.light5 : 'transparent'};\n  `}\n`;\n\nexport type FilterSetsProps = {\n  disabled: boolean;\n  tab: TabIds;\n  dataMaskSelected: DataMaskState;\n  onEditFilterSet: (id: number) => void;\n  onFilterSelectionChange: (\n    filter: Pick<Filter, 'id'> & Partial<Filter>,\n    dataMask: Partial<DataMask>,\n  ) => void;\n};\n\nconst DEFAULT_FILTER_SET_NAME = t('New filter set');\n\nconst FilterSets: React.FC<FilterSetsProps> = ({\n  dataMaskSelected,\n  onEditFilterSet,\n  disabled,\n  onFilterSelectionChange,\n  tab,\n}) => {\n  const dispatch = useDispatch();\n  const [filterSetName, setFilterSetName] = useState(DEFAULT_FILTER_SET_NAME);\n  const [editMode, setEditMode] = useState(false);\n  const dataMaskApplied = useNativeFiltersDataMask();\n  const filterSets = useFilterSets();\n  const filterSetFilterValues = Object.values(filterSets);\n  const filters = useFilters();\n  const filterValues = Object.values(filters) as Filter[];\n  const [selectedFiltersSetId, setSelectedFiltersSetId] = useState<\n    number | null\n  >(null);\n\n  useEffect(() => {\n    if (tab === TabIds.AllFilters) {\n      return;\n    }\n    if (!filterSetFilterValues.length) {\n      setSelectedFiltersSetId(null);\n      return;\n    }\n\n    const foundFilterSet = findExistingFilterSet({\n      dataMaskSelected,\n      filterSetFilterValues,\n    });\n\n    setSelectedFiltersSetId(foundFilterSet?.id ?? null);\n  }, [tab, dataMaskSelected, filterSetFilterValues]);\n\n  const isFilterMissingOrContainsInvalidMetadata = (\n    id: string,\n    filterSet?: FilterSet,\n  ) =>\n    !filterValues.find(filter => filter?.id === id) ||\n    !areObjectsEqual(\n      filters[id]?.controlValues,\n      filterSet?.nativeFilters?.[id]?.controlValues,\n      {\n        ignoreUndefined: true,\n      },\n    );\n\n  const takeFilterSet = (id: number, event?: MouseEvent) => {\n    const localTarget = event?.target as HTMLDivElement;\n    if (localTarget) {\n      const parent = localTarget.closest(\n        `[data-anchor=${getFilterBarTestId('filter-set-wrapper', true)}]`,\n      );\n      if (\n        parent?.querySelector('.ant-collapse-header')?.contains(localTarget) ||\n        localTarget?.closest('.ant-dropdown')\n      ) {\n        return;\n      }\n    }\n    setSelectedFiltersSetId(id);\n    if (!id) {\n      return;\n    }\n\n    const filterSet = filterSets[id];\n\n    (Object.values(filterSet?.dataMask) ?? []).forEach(\n      (dataMask: DataMaskWithId) => {\n        const { extraFormData, filterState, id } = dataMask;\n        if (isFilterMissingOrContainsInvalidMetadata(id, filterSet)) {\n          return;\n        }\n        onFilterSelectionChange({ id }, { extraFormData, filterState });\n      },\n    );\n  };\n\n  const handleRebuild = (id: number) => {\n    const filterSet = filterSets[id];\n    // We need remove invalid filters from filter set\n    const newFilters = Object.values(filterSet?.dataMask ?? {})\n      .filter(dataMask => {\n        const { id } = dataMask as DataMaskWithId;\n        return !isFilterMissingOrContainsInvalidMetadata(id, filterSet);\n      })\n      .reduce(\n        (prev, next: DataMaskWithId) => ({\n          ...prev,\n          [next.id]: filters[next.id],\n        }),\n        {},\n      );\n\n    const updatedFilterSet: FilterSet = {\n      ...filterSet,\n      nativeFilters: newFilters as Filters,\n      dataMask: Object.keys(newFilters).reduce(\n        (prev, nextFilterId) => ({\n          ...prev,\n          [nextFilterId]: filterSet.dataMask?.[nextFilterId],\n        }),\n        {},\n      ),\n    };\n    dispatch(updateFilterSet(updatedFilterSet));\n  };\n\n  const handleEdit = (id: number) => {\n    takeFilterSet(id);\n    onEditFilterSet(id);\n  };\n\n  const handleDeleteFilterSet = (filterSetId: number) => {\n    dispatch(deleteFilterSet(filterSetId));\n    if (filterSetId === selectedFiltersSetId) {\n      setSelectedFiltersSetId(null);\n    }\n  };\n\n  const handleCancel = () => {\n    setEditMode(false);\n    setFilterSetName(DEFAULT_FILTER_SET_NAME);\n  };\n\n  const handleCreateFilterSet = () => {\n    const newFilterSet: Omit<FilterSet, 'id'> = {\n      name: filterSetName.trim(),\n      nativeFilters: filters,\n      dataMask: Object.keys(filters).reduce(\n        (prev, nextFilterId) => ({\n          ...prev,\n          [nextFilterId]: dataMaskApplied[nextFilterId],\n        }),\n        {},\n      ),\n    };\n    dispatch(createFilterSet(newFilterSet));\n    setEditMode(false);\n    setFilterSetName(DEFAULT_FILTER_SET_NAME);\n  };\n\n  return (\n    <FilterSetsWrapper>\n      {!selectedFiltersSetId && (\n        <FilterSetUnitWrapper>\n          <FilterSetUnit\n            dataMaskSelected={dataMaskSelected}\n            editMode={editMode}\n            setFilterSetName={setFilterSetName}\n            filterSetName={filterSetName}\n          />\n          <Footer\n            filterSetName={filterSetName.trim()}\n            disabled={disabled}\n            onCancel={handleCancel}\n            editMode={editMode}\n            onEdit={() => setEditMode(true)}\n            onCreate={handleCreateFilterSet}\n          />\n        </FilterSetUnitWrapper>\n      )}\n      {filterSetFilterValues.map(filterSet => (\n        <FilterSetUnitWrapper\n          {...getFilterBarTestId('filter-set-wrapper')}\n          data-anchor={getFilterBarTestId('filter-set-wrapper', true)}\n          data-selected={filterSet.id === selectedFiltersSetId}\n          onClick={\n            (e =>\n              takeFilterSet(filterSet.id, e as MouseEvent)) as HandlerFunction\n          }\n          key={filterSet.id}\n        >\n          <FilterSetUnit\n            isApplied={filterSet.id === selectedFiltersSetId && !disabled}\n            onDelete={() => handleDeleteFilterSet(filterSet.id)}\n            onEdit={() => handleEdit(filterSet.id)}\n            onRebuild={() => handleRebuild(filterSet.id)}\n            dataMaskSelected={dataMaskSelected}\n            filterSet={filterSet}\n          />\n        </FilterSetUnitWrapper>\n      ))}\n    </FilterSetsWrapper>\n  );\n};\n\nexport default FilterSets;\n","// This icon file is generated automatically.\nvar WarningOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z\" } }] }, \"name\": \"warning\", \"theme\": \"outlined\" };\nexport default WarningOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport WarningOutlinedSvg from \"@ant-design/icons-svg/es/asn/WarningOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar WarningOutlined = function WarningOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: WarningOutlinedSvg\n  }));\n};\n\nWarningOutlined.displayName = 'WarningOutlined';\nexport default React.forwardRef(WarningOutlined);","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, useMemo, useState } from 'react';\nimport { DataMaskState, HandlerFunction, styled, t } from '@superset-ui/core';\nimport { Typography, AntdTooltip } from 'src/components';\nimport { useDispatch } from 'react-redux';\nimport Button from 'src/components/Button';\nimport { updateFilterSet } from 'src/dashboard/actions/nativeFilters';\nimport { WarningOutlined } from '@ant-design/icons';\nimport { ActionButtons } from './Footer';\nimport { useNativeFiltersDataMask, useFilters, useFilterSets } from '../state';\nimport { APPLY_FILTERS_HINT, findExistingFilterSet } from './utils';\nimport { useFilterSetNameDuplicated } from './state';\nimport { getFilterBarTestId } from '../index';\n\nconst Wrapper = styled.div`\n  display: grid;\n  grid-template-columns: 1fr;\n  align-items: flex-start;\n  justify-content: flex-start;\n  grid-gap: ${({ theme }) => theme.gridUnit}px;\n  background: ${({ theme }) => theme.colors.primary.light4};\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\nconst Title = styled(Typography.Text)`\n  color: ${({ theme }) => theme.colors.primary.dark2};\n`;\n\nconst Warning = styled(Typography.Text)`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  & .anticon {\n    padding: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst ActionButton = styled.div<{ disabled?: boolean }>`\n  display: flex;\n  & button {\n    ${({ disabled }) => `pointer-events: ${disabled ? 'none' : 'all'}`};\n    flex: 1;\n  }\n`;\n\nexport type EditSectionProps = {\n  filterSetId: number;\n  dataMaskSelected: DataMaskState;\n  onCancel: HandlerFunction;\n  disabled: boolean;\n};\n\nconst EditSection: FC<EditSectionProps> = ({\n  filterSetId,\n  onCancel,\n  dataMaskSelected,\n  disabled,\n}) => {\n  const dataMaskApplied = useNativeFiltersDataMask();\n  const dispatch = useDispatch();\n  const filterSets = useFilterSets();\n  const filters = useFilters();\n  const filterSetFilterValues = Object.values(filterSets);\n\n  const [filterSetName, setFilterSetName] = useState(\n    filterSets[filterSetId].name,\n  );\n\n  const isFilterSetNameDuplicated = useFilterSetNameDuplicated(\n    filterSetName,\n    filterSets[filterSetId].name,\n  );\n\n  const handleSave = () => {\n    dispatch(\n      updateFilterSet({\n        id: filterSetId,\n        name: filterSetName,\n        nativeFilters: filters,\n        dataMask: { ...dataMaskApplied },\n      }),\n    );\n    onCancel();\n  };\n\n  const foundFilterSet = useMemo(\n    () =>\n      findExistingFilterSet({\n        dataMaskSelected,\n        filterSetFilterValues,\n      }),\n    [dataMaskSelected, filterSetFilterValues],\n  );\n\n  const isDuplicateFilterSet =\n    foundFilterSet && foundFilterSet.id !== filterSetId;\n\n  const resultDisabled =\n    disabled || isDuplicateFilterSet || isFilterSetNameDuplicated;\n\n  return (\n    <Wrapper>\n      <Title strong>{t('Editing filter set:')}</Title>\n      <Title\n        editable={{\n          editing: true,\n          icon: <span />,\n          onChange: setFilterSetName,\n        }}\n      >\n        {filterSetName}\n      </Title>\n      <ActionButtons>\n        <Button\n          ghost\n          buttonStyle=\"tertiary\"\n          buttonSize=\"small\"\n          onClick={onCancel}\n          data-test=\"filter-set-edit-cancel\"\n        >\n          {t('Cancel')}\n        </Button>\n        <AntdTooltip\n          placement=\"right\"\n          title={\n            (isFilterSetNameDuplicated &&\n              t('Filter set with this name already exists')) ||\n            (isDuplicateFilterSet && t('Filter set already exists')) ||\n            (disabled && APPLY_FILTERS_HINT)\n          }\n        >\n          <ActionButton disabled={resultDisabled}>\n            <Button\n              disabled={resultDisabled}\n              buttonStyle=\"primary\"\n              htmlType=\"submit\"\n              buttonSize=\"small\"\n              onClick={handleSave}\n              {...getFilterBarTestId('filter-set-edit-save')}\n            >\n              {t('Save')}\n            </Button>\n          </ActionButton>\n        </AntdTooltip>\n      </ActionButtons>\n      {isDuplicateFilterSet && (\n        <Warning mark>\n          <WarningOutlined />\n          {t('This filter set is identical to: \"%s\"', foundFilterSet?.name)}\n        </Warning>\n      )}\n    </Wrapper>\n  );\n};\n\nexport default EditSection;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { setFilterConfiguration } from 'src/dashboard/actions/nativeFilters';\nimport Button from 'src/components/Button';\nimport { FilterConfiguration, styled } from '@superset-ui/core';\nimport { FiltersConfigModal } from 'src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigModal';\nimport { getFilterBarTestId } from '..';\n\nexport interface FCBProps {\n  createNewOnOpen?: boolean;\n  dashboardId?: number;\n}\n\nconst HeaderButton = styled(Button)`\n  padding: 0;\n`;\n\nexport const FilterConfigurationLink: React.FC<FCBProps> = ({\n  createNewOnOpen,\n  dashboardId,\n  children,\n}) => {\n  const dispatch = useDispatch();\n  const [isOpen, setOpen] = useState(false);\n\n  function close() {\n    setOpen(false);\n  }\n\n  async function submit(filterConfig: FilterConfiguration) {\n    dispatch(await setFilterConfiguration(filterConfig));\n    close();\n  }\n\n  return (\n    <>\n      {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions */}\n      <HeaderButton\n        {...getFilterBarTestId('create-filter')}\n        buttonStyle=\"link\"\n        buttonSize=\"xsmall\"\n        onClick={() => setOpen(true)}\n      >\n        {children}\n      </HeaderButton>\n      <FiltersConfigModal\n        isOpen={isOpen}\n        onSave={submit}\n        onCancel={close}\n        createNewOnOpen={createNewOnOpen}\n        key={`filters-for-${dashboardId}`}\n      />\n    </>\n  );\n};\n\nexport default FilterConfigurationLink;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport { css, styled, t, useTheme } from '@superset-ui/core';\nimport React, { FC } from 'react';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport FilterConfigurationLink from 'src/dashboard/components/nativeFilters/FilterBar/FilterConfigurationLink';\nimport { useFilters } from 'src/dashboard/components/nativeFilters/FilterBar/state';\nimport { RootState } from 'src/dashboard/types';\nimport { getFilterBarTestId } from '..';\n\nconst TitleArea = styled.h4`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  margin: 0;\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n\n  & > span {\n    flex-grow: 1;\n  }\n`;\n\nconst HeaderButton = styled(Button)`\n  padding: 0;\n`;\n\nconst Wrapper = styled.div`\n  padding: ${({ theme }) => theme.gridUnit}px\n    ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\ntype HeaderProps = {\n  toggleFiltersBar: (arg0: boolean) => void;\n};\n\nconst AddFiltersButtonContainer = styled.div`\n  ${({ theme }) => css`\n    margin-top: ${theme.gridUnit * 2}px;\n\n    & button > [role='img']:first-of-type {\n      margin-right: ${theme.gridUnit}px;\n      line-height: 0;\n    }\n\n    span[role='img'] {\n      padding-bottom: 1px;\n    }\n\n    .ant-btn > .anticon + span {\n      margin-left: 0;\n    }\n  `}\n`;\n\nconst Header: FC<HeaderProps> = ({ toggleFiltersBar }) => {\n  const theme = useTheme();\n  const filters = useFilters();\n  const filterValues = Object.values(filters);\n  const canEdit = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.dash_edit_perm,\n  );\n  const dashboardId = useSelector<RootState, number>(\n    ({ dashboardInfo }) => dashboardInfo.id,\n  );\n\n  return (\n    <Wrapper>\n      <TitleArea>\n        <span>{t('Filters')}</span>\n        <HeaderButton\n          {...getFilterBarTestId('collapse-button')}\n          buttonStyle=\"link\"\n          buttonSize=\"xsmall\"\n          onClick={() => toggleFiltersBar(false)}\n        >\n          <Icons.Expand iconColor={theme.colors.grayscale.base} />\n        </HeaderButton>\n      </TitleArea>\n      {canEdit && (\n        <AddFiltersButtonContainer>\n          <FilterConfigurationLink\n            dashboardId={dashboardId}\n            createNewOnOpen={filterValues.length === 0}\n          >\n            <Icons.PlusSmall /> {t('Add/Edit Filters')}\n          </FilterConfigurationLink>\n        </AddFiltersButtonContainer>\n      )}\n    </Wrapper>\n  );\n};\n\nexport default Header;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n// Internally, the portalNode must be for either HTML or SVG elements\nvar ELEMENT_TYPE_HTML = 'html';\nvar ELEMENT_TYPE_SVG = 'svg';\n// ReactDOM can handle several different namespaces, but they're not exported publicly\n// https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/react-dom/src/shared/DOMNamespaces.js#L8-L10\nvar SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\nvar validateElementType = function (domElement, elementType) {\n    if (elementType === ELEMENT_TYPE_HTML) {\n        return domElement instanceof HTMLElement;\n    }\n    if (elementType === ELEMENT_TYPE_SVG) {\n        return domElement instanceof SVGElement;\n    }\n    throw new Error(\"Unrecognized element type \\\"\" + elementType + \"\\\" for validateElementType.\");\n};\n// This is the internal implementation: the public entry points set elementType to an appropriate value\nvar createPortalNode = function (elementType) {\n    var initialProps = {};\n    var parent;\n    var lastPlaceholder;\n    var element;\n    if (elementType === ELEMENT_TYPE_HTML) {\n        element = document.createElement('div');\n    }\n    else if (elementType === ELEMENT_TYPE_SVG) {\n        element = document.createElementNS(SVG_NAMESPACE, 'g');\n    }\n    else {\n        throw new Error(\"Invalid element type \\\"\" + elementType + \"\\\" for createPortalNode: must be \\\"html\\\" or \\\"svg\\\".\");\n    }\n    var portalNode = {\n        element: element,\n        elementType: elementType,\n        setPortalProps: function (props) {\n            initialProps = props;\n        },\n        getInitialPortalProps: function () {\n            return initialProps;\n        },\n        mount: function (newParent, newPlaceholder) {\n            if (newPlaceholder === lastPlaceholder) {\n                // Already mounted - noop.\n                return;\n            }\n            portalNode.unmount();\n            // To support SVG and other non-html elements, the portalNode's elementType needs to match\n            // the elementType it's being rendered into\n            if (newParent !== parent) {\n                if (!validateElementType(newParent, elementType)) {\n                    throw new Error(\"Invalid element type for portal: \\\"\" + elementType + \"\\\" portalNodes must be used with \" + elementType + \" elements, but OutPortal is within <\" + newParent.tagName + \">.\");\n                }\n            }\n            newParent.replaceChild(portalNode.element, newPlaceholder);\n            parent = newParent;\n            lastPlaceholder = newPlaceholder;\n        },\n        unmount: function (expectedPlaceholder) {\n            if (expectedPlaceholder && expectedPlaceholder !== lastPlaceholder) {\n                // Skip unmounts for placeholders that aren't currently mounted\n                // They will have been automatically unmounted already by a subsequent mount()\n                return;\n            }\n            if (parent && lastPlaceholder) {\n                parent.replaceChild(lastPlaceholder, portalNode.element);\n                parent = undefined;\n                lastPlaceholder = undefined;\n            }\n        }\n    };\n    return portalNode;\n};\nvar InPortal = /** @class */ (function (_super) {\n    __extends(InPortal, _super);\n    function InPortal(props) {\n        var _this = _super.call(this, props) || this;\n        _this.addPropsChannel = function () {\n            Object.assign(_this.props.node, {\n                setPortalProps: function (props) {\n                    // Rerender the child node here if/when the out portal props change\n                    _this.setState({ nodeProps: props });\n                }\n            });\n        };\n        _this.state = {\n            nodeProps: _this.props.node.getInitialPortalProps(),\n        };\n        return _this;\n    }\n    InPortal.prototype.componentDidMount = function () {\n        this.addPropsChannel();\n    };\n    InPortal.prototype.componentDidUpdate = function () {\n        this.addPropsChannel();\n    };\n    InPortal.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, children = _a.children, node = _a.node;\n        return ReactDOM.createPortal(React.Children.map(children, function (child) {\n            if (!React.isValidElement(child))\n                return child;\n            return React.cloneElement(child, _this.state.nodeProps);\n        }), node.element);\n    };\n    return InPortal;\n}(React.PureComponent));\nvar OutPortal = /** @class */ (function (_super) {\n    __extends(OutPortal, _super);\n    function OutPortal(props) {\n        var _this = _super.call(this, props) || this;\n        _this.placeholderNode = React.createRef();\n        _this.passPropsThroughPortal();\n        return _this;\n    }\n    OutPortal.prototype.passPropsThroughPortal = function () {\n        var propsForTarget = Object.assign({}, this.props, { node: undefined });\n        this.props.node.setPortalProps(propsForTarget);\n    };\n    OutPortal.prototype.componentDidMount = function () {\n        var node = this.props.node;\n        this.currentPortalNode = node;\n        var placeholder = this.placeholderNode.current;\n        var parent = placeholder.parentNode;\n        node.mount(parent, placeholder);\n        this.passPropsThroughPortal();\n    };\n    OutPortal.prototype.componentDidUpdate = function () {\n        // We re-mount on update, just in case we were unmounted (e.g. by\n        // a second OutPortal, which has now been removed)\n        var node = this.props.node;\n        // If we're switching portal nodes, we need to clean up the current one first.\n        if (this.currentPortalNode && node !== this.currentPortalNode) {\n            this.currentPortalNode.unmount(this.placeholderNode.current);\n            this.currentPortalNode = node;\n        }\n        var placeholder = this.placeholderNode.current;\n        var parent = placeholder.parentNode;\n        node.mount(parent, placeholder);\n        this.passPropsThroughPortal();\n    };\n    OutPortal.prototype.componentWillUnmount = function () {\n        var node = this.props.node;\n        node.unmount(this.placeholderNode.current);\n    };\n    OutPortal.prototype.render = function () {\n        // Render a placeholder to the DOM, so we can get a reference into\n        // our location in the DOM, and swap it out for the portaled node.\n        // A <div> placeholder works fine even for SVG.\n        return React.createElement(\"div\", { ref: this.placeholderNode });\n    };\n    return OutPortal;\n}(React.PureComponent));\nvar createHtmlPortalNode = createPortalNode.bind(null, ELEMENT_TYPE_HTML);\nvar createSvgPortalNode = createPortalNode.bind(null, ELEMENT_TYPE_SVG);\nexport { createHtmlPortalNode, createSvgPortalNode, InPortal, OutPortal, };\n//# sourceMappingURL=index.js.map","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { debounce } from 'lodash';\nimport { Dispatch } from 'react';\nimport {\n  setFocusedNativeFilter,\n  unsetFocusedNativeFilter,\n} from 'src/dashboard/actions/nativeFilters';\n\nexport const dispatchFocusAction = debounce(\n  (dispatch: Dispatch<any>, id?: string) => {\n    if (id) {\n      dispatch(setFocusedNativeFilter(id));\n    } else {\n      dispatch(unsetFocusedNativeFilter());\n    }\n  },\n  300,\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  QueryFormData,\n  SuperChart,\n  DataMask,\n  t,\n  styled,\n  Behavior,\n  ChartDataResponseResult,\n  JsonObject,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { isEqual, isEqualWith } from 'lodash';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport Loading from 'src/components/Loading';\nimport BasicErrorAlert from 'src/components/ErrorMessage/BasicErrorAlert';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { waitForAsyncData } from 'src/middleware/asyncEvent';\nimport { ClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { RootState } from 'src/dashboard/types';\nimport { onFiltersRefreshSuccess } from 'src/dashboard/actions/dashboardState';\nimport { dispatchFocusAction } from './utils';\nimport { FilterProps } from './types';\nimport { getFormData } from '../../utils';\nimport { useFilterDependencies } from './state';\nimport { checkIsMissingRequiredValue } from '../utils';\n\nconst HEIGHT = 32;\n\n// Overrides superset-ui height with min-height\nconst StyledDiv = styled.div`\n  & > div {\n    height: auto !important;\n    min-height: ${HEIGHT}px;\n  }\n`;\n\nconst queriesDataPlaceholder = [{ data: [{}] }];\nconst behaviors = [Behavior.NATIVE_FILTER];\n\nconst useShouldFilterRefresh = () => {\n  const isDashboardRefreshing = useSelector<RootState, boolean>(\n    state => state.dashboardState.isRefreshing,\n  );\n  const isFilterRefreshing = useSelector<RootState, boolean>(\n    state => state.dashboardState.isFiltersRefreshing,\n  );\n\n  // trigger filter requests only after charts requests were triggered\n  return !isDashboardRefreshing && isFilterRefreshing;\n};\n\nconst FilterValue: React.FC<FilterProps> = ({\n  dataMaskSelected,\n  filter,\n  directPathToChild,\n  onFilterSelectionChange,\n  inView = true,\n  showOverflow,\n  parentRef,\n  setFilterActive,\n}) => {\n  const { id, targets, filterType, adhoc_filters, time_range } = filter;\n  const metadata = getChartMetadataRegistry().get(filterType);\n  const dependencies = useFilterDependencies(id, dataMaskSelected);\n  const shouldRefresh = useShouldFilterRefresh();\n  const [state, setState] = useState<ChartDataResponseResult[]>([]);\n  const [error, setError] = useState<string>('');\n  const [formData, setFormData] = useState<Partial<QueryFormData>>({\n    inView: false,\n  });\n  const [ownState, setOwnState] = useState<JsonObject>({});\n  const [inViewFirstTime, setInViewFirstTime] = useState(inView);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const [target] = targets;\n  const {\n    datasetId,\n    column = {},\n  }: Partial<{ datasetId: number; column: { name?: string } }> = target;\n  const { name: groupby } = column;\n  const hasDataSource = !!datasetId;\n  const [isLoading, setIsLoading] = useState<boolean>(hasDataSource);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const dispatch = useDispatch();\n\n  const handleFilterLoadFinish = useCallback(() => {\n    setIsRefreshing(false);\n    setIsLoading(false);\n    if (shouldRefresh) {\n      dispatch(onFiltersRefreshSuccess());\n    }\n  }, [dispatch, shouldRefresh]);\n\n  useEffect(() => {\n    if (!inViewFirstTime && inView) {\n      setInViewFirstTime(true);\n    }\n  }, [inView, inViewFirstTime, setInViewFirstTime]);\n\n  useEffect(() => {\n    if (!inViewFirstTime) {\n      return;\n    }\n    const newFormData = getFormData({\n      ...filter,\n      datasetId,\n      dependencies,\n      groupby,\n      adhoc_filters,\n      time_range,\n    });\n    const filterOwnState = filter.dataMask?.ownState || {};\n    // TODO: We should try to improve our useEffect hooks to depend more on\n    // granular information instead of big objects that require deep comparison.\n    const customizer = (\n      objValue: Partial<QueryFormData>,\n      othValue: Partial<QueryFormData>,\n      key: string,\n    ) => (key === 'url_params' ? true : undefined);\n    if (\n      !isRefreshing &&\n      (!isEqualWith(formData, newFormData, customizer) ||\n        !isEqual(ownState, filterOwnState) ||\n        shouldRefresh)\n    ) {\n      setFormData(newFormData);\n      setOwnState(filterOwnState);\n      if (!hasDataSource) {\n        return;\n      }\n      setIsRefreshing(true);\n      getChartDataRequest({\n        formData: newFormData,\n        force: false,\n        requestParams: { dashboardId: 0 },\n        ownState: filterOwnState,\n      })\n        .then(({ response, json }) => {\n          if (isFeatureEnabled(FeatureFlag.GLOBAL_ASYNC_QUERIES)) {\n            // deal with getChartDataRequest transforming the response data\n            const result = 'result' in json ? json.result[0] : json;\n\n            if (response.status === 200) {\n              setState([result]);\n              handleFilterLoadFinish();\n            } else if (response.status === 202) {\n              waitForAsyncData(result)\n                .then((asyncResult: ChartDataResponseResult[]) => {\n                  setState(asyncResult);\n                  handleFilterLoadFinish();\n                })\n                .catch((error: ClientErrorObject) => {\n                  setError(\n                    error.message || error.error || t('Check configuration'),\n                  );\n                  handleFilterLoadFinish();\n                });\n            } else {\n              throw new Error(\n                `Received unexpected response status (${response.status}) while fetching chart data`,\n              );\n            }\n          } else {\n            setState(json.result);\n            setError('');\n            handleFilterLoadFinish();\n          }\n        })\n        .catch((error: Response) => {\n          setError(error.statusText);\n          handleFilterLoadFinish();\n        });\n    }\n  }, [\n    inViewFirstTime,\n    dependencies,\n    datasetId,\n    groupby,\n    handleFilterLoadFinish,\n    JSON.stringify(filter),\n    hasDataSource,\n    isRefreshing,\n    shouldRefresh,\n  ]);\n\n  useEffect(() => {\n    if (directPathToChild?.[0] === filter.id) {\n      inputRef?.current?.focus();\n    }\n  }, [inputRef, directPathToChild, filter.id]);\n\n  const setDataMask = useCallback(\n    (dataMask: DataMask) => onFilterSelectionChange(filter, dataMask),\n    [filter, onFilterSelectionChange],\n  );\n\n  const setFocusedFilter = useCallback(\n    () => dispatchFocusAction(dispatch, id),\n    [dispatch, id],\n  );\n  const unsetFocusedFilter = useCallback(\n    () => dispatchFocusAction(dispatch),\n    [dispatch],\n  );\n\n  const hooks = useMemo(\n    () => ({\n      setDataMask,\n      setFocusedFilter,\n      unsetFocusedFilter,\n      setFilterActive,\n    }),\n    [setDataMask, setFilterActive, setFocusedFilter, unsetFocusedFilter],\n  );\n\n  const isMissingRequiredValue = checkIsMissingRequiredValue(\n    filter,\n    filter.dataMask?.filterState,\n  );\n\n  const filterState = useMemo(\n    () => ({\n      ...filter.dataMask?.filterState,\n      validateStatus: isMissingRequiredValue && 'error',\n    }),\n    [filter.dataMask?.filterState, isMissingRequiredValue],\n  );\n\n  if (error) {\n    return (\n      <BasicErrorAlert\n        title={t('Cannot load filter')}\n        body={error}\n        level=\"error\"\n      />\n    );\n  }\n\n  return (\n    <StyledDiv data-test=\"form-item-value\">\n      {isLoading ? (\n        <Loading position=\"inline-centered\" />\n      ) : (\n        <SuperChart\n          height={HEIGHT}\n          width=\"100%\"\n          showOverflow={showOverflow}\n          formData={formData}\n          parentRef={parentRef}\n          inputRef={inputRef}\n          // For charts that don't have datasource we need workaround for empty placeholder\n          queriesData={hasDataSource ? state : queriesDataPlaceholder}\n          chartType={filterType}\n          behaviors={behaviors}\n          filterState={filterState}\n          ownState={filter.dataMask?.ownState}\n          enableNoResults={metadata?.enableNoResults}\n          isRefreshing={isRefreshing}\n          hooks={hooks}\n        />\n      )}\n    </StyledDiv>\n  );\n};\nexport default FilterValue;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  DataMaskStateWithId,\n  ensureIsArray,\n  ExtraFormData,\n} from '@superset-ui/core';\nimport { mergeExtraFormData } from '../../utils';\n\n// eslint-disable-next-line import/prefer-default-export\nexport function useFilterDependencies(\n  id: string,\n  dataMaskSelected?: DataMaskStateWithId,\n): ExtraFormData {\n  const dependencyIds = useSelector<any, string[] | undefined>(\n    state => state.nativeFilters.filters[id]?.cascadeParentIds,\n  );\n  return useMemo(() => {\n    let dependencies = {};\n    ensureIsArray(dependencyIds).forEach(parentId => {\n      const parentState = dataMaskSelected?.[parentId];\n      dependencies = mergeExtraFormData(\n        dependencies,\n        parentState?.extraFormData,\n      );\n    });\n    return dependencies;\n  }, [dataMaskSelected, dependencyIds]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Filter, t } from '@superset-ui/core';\nimport { useSelector } from 'react-redux';\nimport {\n  ChartsState,\n  Layout,\n  LayoutItem,\n  RootState,\n} from 'src/dashboard/types';\nimport { DASHBOARD_ROOT_ID } from 'src/dashboard/util/constants';\nimport { CHART_TYPE } from 'src/dashboard/util/componentTypes';\nimport { useMemo } from 'react';\n\nconst extractTabLabel = (tab?: LayoutItem) =>\n  tab?.meta?.text || tab?.meta?.defaultText || '';\nconst extractChartLabel = (chart?: LayoutItem) =>\n  chart?.meta?.sliceNameOverride || chart?.meta?.sliceName || chart?.id || '';\n\nconst useCharts = () => {\n  const charts = useSelector<RootState, ChartsState>(state => state.charts);\n  return useMemo(() => Object.values(charts), [charts]);\n};\n\nexport const useFilterScope = (filter: Filter) => {\n  const layout = useSelector<RootState, Layout>(\n    state => state.dashboardLayout.present,\n  );\n  const charts = useCharts();\n\n  return useMemo(() => {\n    let topLevelTabs: string[] | undefined;\n    const topElementId = layout[DASHBOARD_ROOT_ID].children[0];\n    if (topElementId.startsWith('TABS-')) {\n      topLevelTabs = layout[topElementId].children;\n    }\n\n    // no charts in scope\n    if (filter.scope.rootPath.length === 0) {\n      return undefined;\n    }\n\n    // all charts in scope\n    // no charts excluded and no top level tabs\n    // OR no charts excluded and every top level tab is in rootPath\n    if (\n      filter.scope.excluded.length === 0 &&\n      (filter.scope.rootPath[0] === DASHBOARD_ROOT_ID ||\n        (topLevelTabs &&\n          topLevelTabs.every(topLevelTab =>\n            filter.scope.rootPath.includes(topLevelTab),\n          )))\n    ) {\n      return { all: [t('All charts')] };\n    }\n\n    // no charts excluded and not every top level tab in scope\n    // returns \"TAB1, TAB2\"\n    if (filter.scope.excluded.length === 0 && topLevelTabs) {\n      return {\n        tabs: filter.scope.rootPath\n          .map(tabId => extractTabLabel(layout[tabId]))\n          .filter(Boolean),\n      };\n    }\n\n    const layoutCharts = Object.values(layout).filter(\n      layoutElement => layoutElement.type === CHART_TYPE,\n    );\n\n    // no top level tabs, charts excluded\n    // returns \"CHART1, CHART2\"\n    if (filter.scope.rootPath[0] === DASHBOARD_ROOT_ID) {\n      return {\n        charts: charts\n          .filter(chart => !filter.scope.excluded.includes(chart.id))\n          .map(chart => {\n            const layoutElement = layoutCharts.find(\n              layoutChart => layoutChart.meta.chartId === chart.id,\n            );\n            return extractChartLabel(layoutElement);\n          })\n          .filter(Boolean),\n      };\n    }\n\n    // top level tabs, charts excluded\n    // returns \"TAB1, TAB2, CHART1\"\n    if (topLevelTabs) {\n      // We start assuming that all charts are in scope for all tabs in the root path\n      const topLevelTabsInFullScope = [...filter.scope.rootPath];\n      const layoutChartElementsInTabsInScope = layoutCharts.filter(element =>\n        element.parents.some(parent =>\n          topLevelTabsInFullScope.includes(parent),\n        ),\n      );\n      // Exclude the tabs that contain excluded charts\n      filter.scope.excluded.forEach(chartId => {\n        const excludedIndex = topLevelTabsInFullScope.findIndex(tabId =>\n          layoutChartElementsInTabsInScope\n            .find(chart => chart.meta.chartId === chartId)\n            ?.parents.includes(tabId),\n        );\n        if (excludedIndex > -1) {\n          topLevelTabsInFullScope.splice(excludedIndex, 1);\n        }\n      });\n      // Handle charts that are in scope but belong to excluded tabs.\n      const chartsInExcludedTabs = charts\n        .filter(chart => !filter.scope.excluded.includes(chart.id))\n        .reduce((acc: LayoutItem[], chart) => {\n          const layoutChartElementInExcludedTab =\n            layoutChartElementsInTabsInScope.find(\n              element =>\n                element.meta.chartId === chart.id &&\n                element.parents.every(\n                  parent => !topLevelTabsInFullScope.includes(parent),\n                ),\n            );\n          if (layoutChartElementInExcludedTab) {\n            acc.push(layoutChartElementInExcludedTab);\n          }\n          return acc;\n        }, []);\n      // Join tab names and chart names\n      return {\n        tabs: topLevelTabsInFullScope\n          .map(tabId => extractTabLabel(layout[tabId]))\n          .filter(Boolean),\n        charts: chartsInExcludedTabs.map(extractChartLabel).filter(Boolean),\n      };\n    }\n\n    return undefined;\n  }, [charts, filter.scope.excluded, filter.scope.rootPath, layout]);\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { css, styled } from '@superset-ui/core';\n\nexport const Row = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n    margin: ${theme.gridUnit}px 0;\n    font-size: ${theme.typography.sizes.s}px;\n\n    &:first-of-type {\n      margin-top: 0;\n    }\n\n    &:last-of-type {\n      margin-bottom: 0;\n    }\n\n    & .ant-tooltip-open {\n      display: inline-flex;\n    }\n  `};\n`;\n\nexport const RowLabel = styled.span`\n  ${({ theme }) => css`\n    color: ${theme.colors.grayscale.base};\n    padding-right: ${theme.gridUnit * 4}px;\n    margin-right: auto;\n    text-transform: uppercase;\n    white-space: nowrap;\n  `};\n`;\n\nexport const RowValue = styled.div`\n  ${({ theme }) => css`\n    color: ${theme.colors.grayscale.dark1};\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    display: inline;\n  `};\n`;\n\nexport const FilterName = styled.span`\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\n\nexport const DependencyItem = styled.span`\n  text-decoration: underline;\n  cursor: pointer;\n`;\n\nexport const RowTruncationCount = styled.span`\n  ${({ theme }) => css`\n    color: ${theme.colors.primary.base};\n  `}\n`;\n\nexport const TooltipList = styled.ul`\n  ${({ theme }) => css`\n    padding-left: ${theme.gridUnit * 3}px;\n    margin-bottom: 0;\n  `};\n`;\n\nexport const TooltipSectionLabel = styled.span`\n  font-weight: ${({ theme }) => theme.typography.weights.bold};\n`;\n\nexport const TooltipTrigger = styled.div`\n  min-width: 0;\n  display: inline-flex;\n  white-space: nowrap;\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { RefObject, useLayoutEffect, useState, useRef } from 'react';\n\nexport const useTruncation = (elementRef: RefObject<HTMLElement>) => {\n  const [elementsTruncated, setElementsTruncated] = useState(0);\n  const [hasHiddenElements, setHasHiddenElements] = useState(false);\n\n  const previousEffectInfoRef = useRef({\n    scrollWidth: 0,\n    parentElementWidth: 0,\n  });\n\n  useLayoutEffect(() => {\n    const currentElement = elementRef.current;\n    if (!currentElement) {\n      return;\n    }\n\n    const { scrollWidth, clientWidth, childNodes } = currentElement;\n\n    // By using the result of this effect to truncate content\n    // we're effectively changing it's size.\n    // That will trigger another pass at this effect.\n    // Depending on the content elements width, that second rerender could\n    // yield a different truncate count, thus potentially leading to a\n    // rendering loop.\n    // There's only a need to recompute if the parent width or the width of\n    // the child nodes changes.\n    const previousEffectInfo = previousEffectInfoRef.current;\n    const parentElementWidth = currentElement.parentElement?.clientWidth || 0;\n    previousEffectInfoRef.current = {\n      scrollWidth,\n      parentElementWidth,\n    };\n\n    if (\n      previousEffectInfo.parentElementWidth === parentElementWidth &&\n      previousEffectInfo.scrollWidth === scrollWidth\n    ) {\n      return;\n    }\n\n    if (scrollWidth > clientWidth) {\n      // \"...\" is around 6px wide\n      const maxWidth = clientWidth - 6;\n      const elementsCount = childNodes.length;\n      let width = 0;\n      let i = 0;\n      while (width < maxWidth) {\n        width += (childNodes[i] as HTMLElement).offsetWidth;\n        i += 1;\n      }\n      if (i === elementsCount) {\n        setElementsTruncated(1);\n        setHasHiddenElements(false);\n      } else {\n        setElementsTruncated(elementsCount - i);\n        setHasHiddenElements(true);\n      }\n    } else {\n      setElementsTruncated(0);\n    }\n  }, [\n    elementRef.current?.offsetWidth,\n    elementRef.current?.clientWidth,\n    elementRef,\n  ]);\n\n  return [elementsTruncated, hasHiddenElements];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { TooltipProps } from 'antd/lib/tooltip';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { TooltipTrigger } from './Styles';\n\nexport const TooltipWithTruncation = ({\n  title,\n  children,\n  ...props\n}: TooltipProps) => (\n  <Tooltip\n    title={title}\n    placement=\"bottom\"\n    overlayClassName=\"filter-card-tooltip\"\n    {...props}\n  >\n    <TooltipTrigger>{children}</TooltipTrigger>\n  </Tooltip>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo, useRef } from 'react';\nimport { t } from '@superset-ui/core';\nimport { useFilterScope } from './useFilterScope';\nimport {\n  Row,\n  RowLabel,\n  RowTruncationCount,\n  RowValue,\n  TooltipList,\n  TooltipSectionLabel,\n} from './Styles';\nimport { useTruncation } from './useTruncation';\nimport { FilterCardRowProps } from './types';\nimport { TooltipWithTruncation } from './TooltipWithTruncation';\n\nconst getTooltipSection = (items: string[] | undefined, label: string) =>\n  Array.isArray(items) && items.length > 0 ? (\n    <>\n      <TooltipSectionLabel>{label}:</TooltipSectionLabel>\n      <TooltipList>\n        {items.map(item => (\n          <li>{item}</li>\n        ))}\n      </TooltipList>\n    </>\n  ) : null;\n\nexport const ScopeRow = React.memo(({ filter }: FilterCardRowProps) => {\n  const scope = useFilterScope(filter);\n  const scopeRef = useRef<HTMLDivElement>(null);\n\n  const [elementsTruncated, hasHiddenElements] = useTruncation(scopeRef);\n  const tooltipText = useMemo(() => {\n    if (elementsTruncated === 0 || !scope) {\n      return null;\n    }\n    if (scope.all) {\n      return <span>{t('All charts')}</span>;\n    }\n    return (\n      <div>\n        {getTooltipSection(scope.tabs, t('Tabs'))}\n        {getTooltipSection(scope.charts, t('Charts'))}\n      </div>\n    );\n  }, [elementsTruncated, scope]);\n\n  return (\n    <Row>\n      <RowLabel>{t('Scope')}</RowLabel>\n      <TooltipWithTruncation title={tooltipText}>\n        <RowValue ref={scopeRef}>\n          {scope\n            ? Object.values(scope)\n                .flat()\n                .map((element, index) => (\n                  <span>{index === 0 ? element : `, ${element}`}</span>\n                ))\n            : t('None')}\n        </RowValue>\n        {hasHiddenElements > 0 && (\n          <RowTruncationCount>+{elementsTruncated}</RowTruncationCount>\n        )}\n      </TooltipWithTruncation>\n    </Row>\n  );\n});\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { setDirectPathToChild } from 'src/dashboard/actions/dashboardState';\nimport Icons from 'src/components/Icons';\nimport {\n  DependencyItem,\n  Row,\n  RowLabel,\n  RowTruncationCount,\n  RowValue,\n  TooltipList,\n} from './Styles';\nimport { useFilterDependencies } from './useFilterDependencies';\nimport { useTruncation } from './useTruncation';\nimport { DependencyValueProps, FilterCardRowProps } from './types';\nimport { TooltipWithTruncation } from './TooltipWithTruncation';\n\nconst DependencyValue = ({\n  dependency,\n  hasSeparator,\n}: DependencyValueProps) => {\n  const dispatch = useDispatch();\n  const handleClick = useCallback(() => {\n    dispatch(setDirectPathToChild([dependency.id]));\n  }, [dependency.id, dispatch]);\n  return (\n    <span>\n      {hasSeparator && <span>, </span>}\n      <DependencyItem role=\"button\" onClick={handleClick} tabIndex={0}>\n        {dependency.name}\n      </DependencyItem>\n    </span>\n  );\n};\n\nexport const DependenciesRow = React.memo(({ filter }: FilterCardRowProps) => {\n  const dependencies = useFilterDependencies(filter);\n  const dependenciesRef = useRef<HTMLDivElement>(null);\n  const [elementsTruncated, hasHiddenElements] = useTruncation(dependenciesRef);\n  const theme = useTheme();\n\n  const tooltipText = useMemo(\n    () =>\n      elementsTruncated > 0 && dependencies ? (\n        <TooltipList>\n          {dependencies.map(dependency => (\n            <li>\n              <DependencyValue dependency={dependency} />\n            </li>\n          ))}\n        </TooltipList>\n      ) : null,\n    [elementsTruncated, dependencies],\n  );\n\n  if (!Array.isArray(dependencies) || dependencies.length === 0) {\n    return null;\n  }\n  return (\n    <Row>\n      <RowLabel\n        css={css`\n          display: inline-flex;\n          align-items: center;\n        `}\n      >\n        {t('Dependent on')}{' '}\n        <TooltipWithTruncation\n          title={t(\n            'Filter only displays values relevant to selections made in other filters.',\n          )}\n        >\n          <Icons.Info\n            iconSize=\"m\"\n            iconColor={theme.colors.grayscale.light1}\n            css={css`\n              margin-left: ${theme.gridUnit}px;\n            `}\n          />\n        </TooltipWithTruncation>\n      </RowLabel>\n      <TooltipWithTruncation title={tooltipText}>\n        <RowValue ref={dependenciesRef}>\n          {dependencies.map((dependency, index) => (\n            <DependencyValue\n              dependency={dependency}\n              hasSeparator={index !== 0}\n            />\n          ))}\n        </RowValue>\n        {hasHiddenElements && (\n          <RowTruncationCount>+{elementsTruncated}</RowTruncationCount>\n        )}\n      </TooltipWithTruncation>\n    </Row>\n  );\n});\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray, Filter } from '@superset-ui/core';\nimport { useSelector } from 'react-redux';\nimport { RootState } from 'src/dashboard/types';\n\nexport const useFilterDependencies = (filter: Filter) => {\n  const filterDependencyIds = ensureIsArray(filter.cascadeParentIds);\n  return useSelector<RootState, Filter[]>(state => {\n    if (filterDependencyIds.length === 0) {\n      return [];\n    }\n    return filterDependencyIds.reduce((acc: Filter[], filterDependencyId) => {\n      acc.push(state.nativeFilters.filters[filterDependencyId] as Filter);\n      return acc;\n    }, []);\n  });\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useRef } from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Row, FilterName } from './Styles';\nimport { FilterCardRowProps } from './types';\nimport { useTruncation } from './useTruncation';\nimport { TooltipWithTruncation } from './TooltipWithTruncation';\n\nexport const NameRow = ({ filter }: FilterCardRowProps) => {\n  const filterNameRef = useRef<HTMLElement>(null);\n  const [elementsTruncated] = useTruncation(filterNameRef);\n  return (\n    <Row\n      css={(theme: SupersetTheme) =>\n        css`\n          margin-bottom: ${theme.gridUnit * 3}px;\n        `\n      }\n    >\n      <Icons.FilterSmall\n        css={(theme: SupersetTheme) =>\n          css`\n            margin-right: ${theme.gridUnit}px;\n          `\n        }\n      />\n      <TooltipWithTruncation title={elementsTruncated ? filter.name : null}>\n        <FilterName ref={filterNameRef}>{filter.name}</FilterName>\n      </TooltipWithTruncation>\n    </Row>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { getChartMetadataRegistry, t } from '@superset-ui/core';\nimport { Row, RowLabel, RowValue } from './Styles';\nimport { FilterCardRowProps } from './types';\n\nexport const TypeRow = ({ filter }: FilterCardRowProps) => {\n  const metadata = useMemo(\n    () => getChartMetadataRegistry().get(filter.filterType),\n    [filter.filterType],\n  );\n  return (\n    <Row>\n      <RowLabel>{t('Filter type')}</RowLabel>\n      <RowValue>{metadata?.name}</RowValue>\n    </Row>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { Filter } from '@superset-ui/core';\nimport { ScopeRow } from './ScopeRow';\nimport { DependenciesRow } from './DependenciesRow';\nimport { NameRow } from './NameRow';\nimport { TypeRow } from './TypeRow';\n\nexport const FilterCardContent = ({ filter }: { filter: Filter }) => (\n  <div>\n    <NameRow filter={filter} />\n    <TypeRow filter={filter} />\n    <ScopeRow filter={filter} />\n    <DependenciesRow filter={filter} />\n  </div>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport Popover from 'src/components/Popover';\nimport { FilterCardContent } from './FilterCardContent';\nimport { FilterCardProps } from './types';\n\nexport const FilterCard = ({\n  children,\n  filter,\n  getPopupContainer,\n  isVisible: externalIsVisible = true,\n}: FilterCardProps) => {\n  const [internalIsVisible, setInternalIsVisible] = useState(false);\n\n  useEffect(() => {\n    if (!externalIsVisible) {\n      setInternalIsVisible(false);\n    }\n  }, [externalIsVisible]);\n  return (\n    <Popover\n      placement=\"right\"\n      overlayClassName=\"filter-card-popover\"\n      mouseEnterDelay={0.2}\n      mouseLeaveDelay={0.2}\n      onVisibleChange={visible => {\n        setInternalIsVisible(externalIsVisible && visible);\n      }}\n      visible={externalIsVisible && internalIsVisible}\n      content={<FilterCardContent filter={filter} />}\n      getPopupContainer={getPopupContainer ?? (() => document.body)}\n      destroyTooltipOnHide\n    >\n      {children}\n    </Popover>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useContext, useMemo, useState } from 'react';\nimport { styled, SupersetTheme } from '@superset-ui/core';\nimport { FormItem as StyledFormItem, Form } from 'src/components/Form';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { checkIsMissingRequiredValue } from '../utils';\nimport FilterValue from './FilterValue';\nimport { FilterProps } from './types';\nimport { FilterCard } from '../../FilterCard';\nimport { FilterBarScrollContext } from '../index';\n\nconst StyledIcon = styled.div`\n  position: absolute;\n  right: 0;\n`;\n\nconst StyledFilterControlTitle = styled.h4`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  color: ${({ theme }) => theme.colors.grayscale.dark1};\n  margin: 0;\n  overflow-wrap: break-word;\n`;\n\nconst StyledFilterControlTitleBox = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: ${({ theme }) => theme.gridUnit}px;\n`;\n\nconst StyledFilterControlContainer = styled(Form)`\n  width: 100%;\n  && .ant-form-item-label > label {\n    text-transform: none;\n    width: 100%;\n    padding-right: ${({ theme }) => theme.gridUnit * 11}px;\n  }\n  .ant-form-item-tooltip {\n    margin-bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst FormItem = styled(StyledFormItem)`\n  .ant-form-item-label {\n    label.ant-form-item-required:not(.ant-form-item-required-mark-optional) {\n      &::after {\n        display: none;\n      }\n    }\n  }\n`;\n\nconst ToolTipContainer = styled.div`\n  font-size: ${({ theme }) => theme.typography.sizes.m}px;\n  display: flex;\n`;\n\nconst RequiredFieldIndicator = () => (\n  <span\n    css={(theme: SupersetTheme) => ({\n      color: theme.colors.error.base,\n      fontSize: `${theme.typography.sizes.s}px`,\n      paddingLeft: '1px',\n    })}\n  >\n    *\n  </span>\n);\n\nconst DescriptionToolTip = ({ description }: { description: string }) => (\n  <ToolTipContainer>\n    <Tooltip\n      title={description}\n      placement=\"right\"\n      overlayInnerStyle={{\n        display: '-webkit-box',\n        overflow: 'hidden',\n        WebkitLineClamp: 20,\n        WebkitBoxOrient: 'vertical',\n        textOverflow: 'ellipsis',\n      }}\n    >\n      <i\n        className=\"fa fa-info-circle text-muted\"\n        css={(theme: SupersetTheme) => ({\n          paddingLeft: `${theme.gridUnit}px`,\n          cursor: 'pointer',\n        })}\n      />\n    </Tooltip>\n  </ToolTipContainer>\n);\n\nconst FilterControl: React.FC<FilterProps> = ({\n  dataMaskSelected,\n  filter,\n  icon,\n  onFilterSelectionChange,\n  directPathToChild,\n  inView,\n  showOverflow,\n  parentRef,\n}) => {\n  const [isFilterActive, setIsFilterActive] = useState(false);\n\n  const { name = '<undefined>' } = filter;\n\n  const isMissingRequiredValue = checkIsMissingRequiredValue(\n    filter,\n    filter.dataMask?.filterState,\n  );\n  const isRequired = !!filter.controlValues?.enableEmptyFilter;\n\n  const label = useMemo(\n    () => (\n      <StyledFilterControlTitleBox>\n        <StyledFilterControlTitle data-test=\"filter-control-name\">\n          {name}\n        </StyledFilterControlTitle>\n        {isRequired && <RequiredFieldIndicator />}\n        {filter.description && filter.description.trim() && (\n          <DescriptionToolTip description={filter.description} />\n        )}\n        <StyledIcon data-test=\"filter-icon\">{icon}</StyledIcon>\n      </StyledFilterControlTitleBox>\n    ),\n    [name, isRequired, filter.description, icon],\n  );\n\n  const isScrolling = useContext(FilterBarScrollContext);\n\n  return (\n    <StyledFilterControlContainer layout=\"vertical\">\n      <FilterCard filter={filter} isVisible={!isFilterActive && !isScrolling}>\n        <div>\n          <FormItem\n            label={label}\n            required={filter?.controlValues?.enableEmptyFilter}\n            validateStatus={isMissingRequiredValue ? 'error' : undefined}\n          >\n            <FilterValue\n              dataMaskSelected={dataMaskSelected}\n              filter={filter}\n              showOverflow={showOverflow}\n              directPathToChild={directPathToChild}\n              onFilterSelectionChange={onFilterSelectionChange}\n              inView={inView}\n              parentRef={parentRef}\n              setFilterActive={setIsFilterActive}\n            />\n          </FormItem>\n        </div>\n      </FilterCard>\n    </StyledFilterControlContainer>\n  );\n};\n\nexport default React.memo(FilterControl);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, useCallback, useMemo } from 'react';\nimport { css } from '@emotion/react';\nimport {\n  DataMask,\n  DataMaskStateWithId,\n  Filter,\n  isFilterDivider,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport {\n  createHtmlPortalNode,\n  InPortal,\n  OutPortal,\n} from 'react-reverse-portal';\nimport { AntdCollapse } from 'src/components';\nimport {\n  useDashboardHasTabs,\n  useSelectFiltersInScope,\n} from 'src/dashboard/components/nativeFilters/state';\nimport { useFilters } from '../state';\nimport FilterControl from './FilterControl';\n\nconst Wrapper = styled.div`\n  padding: ${({ theme }) => theme.gridUnit * 4}px;\n  // 108px padding to make room for buttons with position: absolute\n  padding-bottom: ${({ theme }) => theme.gridUnit * 27}px;\n`;\n\ntype FilterControlsProps = {\n  directPathToChild?: string[];\n  dataMaskSelected: DataMaskStateWithId;\n  onFilterSelectionChange: (filter: Filter, dataMask: DataMask) => void;\n};\n\nconst FilterControls: FC<FilterControlsProps> = ({\n  directPathToChild,\n  dataMaskSelected,\n  onFilterSelectionChange,\n}) => {\n  const filters = useFilters();\n  const filterValues = useMemo(() => Object.values(filters), [filters]);\n  const portalNodes = useMemo(() => {\n    const nodes = new Array(filterValues.length);\n    for (let i = 0; i < filterValues.length; i += 1) {\n      nodes[i] = createHtmlPortalNode();\n    }\n    return nodes;\n  }, [filterValues.length]);\n\n  const filtersWithValues = useMemo(\n    () =>\n      filterValues.map(filter => ({\n        ...filter,\n        dataMask: dataMaskSelected[filter.id],\n      })),\n    [filterValues, dataMaskSelected],\n  );\n  const filterIds = new Set(filtersWithValues.map(item => item.id));\n\n  const [filtersInScope, filtersOutOfScope] =\n    useSelectFiltersInScope(filtersWithValues);\n  const dashboardHasTabs = useDashboardHasTabs();\n  const showCollapsePanel = dashboardHasTabs && filtersWithValues.length > 0;\n\n  const filterControlFactory = useCallback(\n    index => {\n      const filter = filtersWithValues[index];\n      if (isFilterDivider(filter)) {\n        return (\n          <div>\n            <h3>{filter.title}</h3>\n            <p>{filter.description}</p>\n          </div>\n        );\n      }\n      return (\n        <FilterControl\n          dataMaskSelected={dataMaskSelected}\n          filter={filter}\n          directPathToChild={directPathToChild}\n          onFilterSelectionChange={onFilterSelectionChange}\n          inView={false}\n        />\n      );\n    },\n    [\n      filtersWithValues,\n      JSON.stringify(dataMaskSelected),\n      directPathToChild,\n      onFilterSelectionChange,\n    ],\n  );\n  return (\n    <Wrapper>\n      {portalNodes\n        .filter((node, index) => filterIds.has(filterValues[index].id))\n        .map((node, index) => (\n          <InPortal node={node}>{filterControlFactory(index)}</InPortal>\n        ))}\n      {filtersInScope.map(filter => {\n        const index = filterValues.findIndex(f => f.id === filter.id);\n        return <OutPortal node={portalNodes[index]} inView />;\n      })}\n      {showCollapsePanel && (\n        <AntdCollapse\n          ghost\n          bordered\n          expandIconPosition=\"right\"\n          collapsible={filtersOutOfScope.length === 0 ? 'disabled' : undefined}\n          css={theme => css`\n            &.ant-collapse {\n              margin-top: ${filtersInScope.length > 0\n                ? theme.gridUnit * 6\n                : 0}px;\n              & > .ant-collapse-item {\n                & > .ant-collapse-header {\n                  padding-left: 0;\n                  padding-bottom: ${theme.gridUnit * 2}px;\n\n                  & > .ant-collapse-arrow {\n                    right: ${theme.gridUnit}px;\n                  }\n                }\n\n                & .ant-collapse-content-box {\n                  padding: ${theme.gridUnit * 4}px 0 0;\n                }\n              }\n            }\n          `}\n        >\n          <AntdCollapse.Panel\n            header={t('Filters out of scope (%d)', filtersOutOfScope.length)}\n            key=\"1\"\n          >\n            {filtersOutOfScope.map(filter => {\n              const index = filtersWithValues.findIndex(\n                f => f.id === filter.id,\n              );\n              return <OutPortal node={portalNodes[index]} inView />;\n            })}\n          </AntdCollapse.Panel>\n        </AntdCollapse>\n      )}\n    </Wrapper>\n  );\n};\n\nexport default React.memo(FilterControls);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport {\n  css,\n  DataMaskState,\n  DataMaskStateWithId,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport { isNullish } from 'src/utils/common';\nimport { OPEN_FILTER_BAR_WIDTH } from 'src/dashboard/constants';\nimport { rgba } from 'emotion-rgba';\nimport { getFilterBarTestId } from '../index';\n\ninterface ActionButtonsProps {\n  onApply: () => void;\n  onClearAll: () => void;\n  dataMaskSelected: DataMaskState;\n  dataMaskApplied: DataMaskStateWithId;\n  isApplyDisabled: boolean;\n}\n\nconst ActionButtonsContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n\n    position: fixed;\n    z-index: 100;\n\n    // filter bar width minus 1px for border\n    width: ${OPEN_FILTER_BAR_WIDTH - 1}px;\n    bottom: 0;\n\n    padding: ${theme.gridUnit * 4}px;\n    padding-top: ${theme.gridUnit * 6}px;\n\n    background: linear-gradient(\n      ${rgba(theme.colors.grayscale.light5, 0)},\n      ${theme.colors.grayscale.light5} ${theme.opacity.mediumLight}\n    );\n\n    pointer-events: none;\n\n    & > button {\n      pointer-events: auto;\n    }\n\n    & > .filter-apply-button {\n      margin-bottom: ${theme.gridUnit * 3}px;\n    }\n\n    && > .filter-clear-all-button {\n      color: ${theme.colors.grayscale.base};\n      margin-left: 0;\n      &:hover {\n        color: ${theme.colors.primary.dark1};\n      }\n\n      &[disabled],\n      &[disabled]:hover {\n        color: ${theme.colors.grayscale.light1};\n      }\n    }\n  `};\n`;\n\nexport const ActionButtons = ({\n  onApply,\n  onClearAll,\n  dataMaskApplied,\n  dataMaskSelected,\n  isApplyDisabled,\n}: ActionButtonsProps) => {\n  const isClearAllEnabled = useMemo(\n    () =>\n      Object.values(dataMaskApplied).some(\n        filter =>\n          !isNullish(dataMaskSelected[filter.id]?.filterState?.value) ||\n          (!dataMaskSelected[filter.id] &&\n            !isNullish(filter.filterState?.value)),\n      ),\n    [dataMaskApplied, dataMaskSelected],\n  );\n\n  return (\n    <ActionButtonsContainer>\n      <Button\n        disabled={isApplyDisabled}\n        buttonStyle=\"primary\"\n        htmlType=\"submit\"\n        className=\"filter-apply-button\"\n        onClick={onApply}\n        {...getFilterBarTestId('apply-button')}\n      >\n        {t('Apply filters')}\n      </Button>\n      <Button\n        disabled={!isClearAllEnabled}\n        buttonStyle=\"link\"\n        buttonSize=\"small\"\n        className=\"filter-clear-all-button\"\n        onClick={onClearAll}\n        {...getFilterBarTestId('clear-button')}\n      >\n        {t('Clear all')}\n      </Button>\n    </ActionButtonsContainer>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/* eslint-disable no-param-reassign */\nimport throttle from 'lodash/throttle';\nimport React, {\n  useEffect,\n  useState,\n  useCallback,\n  useMemo,\n  useRef,\n  createContext,\n} from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport cx from 'classnames';\nimport {\n  DataMaskStateWithId,\n  DataMaskWithId,\n  Filter,\n  DataMask,\n  HandlerFunction,\n  styled,\n  t,\n  SLOW_DEBOUNCE,\n  isNativeFilter,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { AntdTabs } from 'src/components';\nimport { useHistory } from 'react-router-dom';\nimport { usePrevious } from 'src/hooks/usePrevious';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { updateDataMask, clearDataMask } from 'src/dataMask/actions';\nimport { useImmer } from 'use-immer';\nimport { isEmpty, isEqual, debounce } from 'lodash';\nimport { testWithId } from 'src/utils/testUtils';\nimport Loading from 'src/components/Loading';\nimport { getInitialDataMask } from 'src/dataMask/reducer';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { EmptyStateSmall } from 'src/components/EmptyState';\nimport { useTabId } from 'src/hooks/useTabId';\nimport { RootState } from 'src/dashboard/types';\nimport { checkIsApplyDisabled, TabIds } from './utils';\nimport FilterSets from './FilterSets';\nimport {\n  useNativeFiltersDataMask,\n  useFilters,\n  useFilterSets,\n  useFilterUpdates,\n  useInitialization,\n} from './state';\nimport { createFilterKey, updateFilterKey } from './keyValue';\nimport EditSection from './FilterSets/EditSection';\nimport Header from './Header';\nimport FilterControls from './FilterControls/FilterControls';\nimport { ActionButtons } from './ActionButtons';\n\nexport const FILTER_BAR_TEST_ID = 'filter-bar';\nexport const getFilterBarTestId = testWithId(FILTER_BAR_TEST_ID);\n\nconst BarWrapper = styled.div<{ width: number }>`\n  width: ${({ theme }) => theme.gridUnit * 8}px;\n\n  & .ant-tabs-top > .ant-tabs-nav {\n    margin: 0;\n  }\n  &.open {\n    width: ${({ width }) => width}px; // arbitrary...\n  }\n`;\n\nconst Bar = styled.div<{ width: number }>`\n  & .ant-typography-edit-content {\n    left: 0;\n    margin-top: 0;\n    width: 100%;\n  }\n  position: absolute;\n  top: 0;\n  left: 0;\n  flex-direction: column;\n  flex-grow: 1;\n  width: ${({ width }) => width}px;\n  background: ${({ theme }) => theme.colors.grayscale.light5};\n  border-right: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  border-bottom: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  min-height: 100%;\n  display: none;\n  &.open {\n    display: flex;\n  }\n`;\n\nconst CollapsedBar = styled.div<{ offset: number }>`\n  position: absolute;\n  top: ${({ offset }) => offset}px;\n  left: 0;\n  height: 100%;\n  width: ${({ theme }) => theme.gridUnit * 8}px;\n  padding-top: ${({ theme }) => theme.gridUnit * 2}px;\n  display: none;\n  text-align: center;\n  &.open {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: ${({ theme }) => theme.gridUnit * 2}px;\n  }\n  svg {\n    cursor: pointer;\n  }\n`;\n\nconst StyledCollapseIcon = styled(Icons.Collapse)`\n  color: ${({ theme }) => theme.colors.primary.base};\n  margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n`;\n\nconst StyledFilterIcon = styled(Icons.Filter)`\n  color: ${({ theme }) => theme.colors.grayscale.base};\n`;\n\nconst StyledTabs = styled(AntdTabs)`\n  & .ant-tabs-nav-list {\n    width: 100%;\n  }\n  & .ant-tabs-tab {\n    display: flex;\n    justify-content: center;\n    margin: 0;\n    flex: 1;\n  }\n\n  & > .ant-tabs-nav .ant-tabs-nav-operations {\n    display: none;\n  }\n`;\n\nconst FilterBarEmptyStateContainer = styled.div`\n  margin-top: ${({ theme }) => theme.gridUnit * 8}px;\n`;\n\nexport interface FiltersBarProps {\n  filtersOpen: boolean;\n  toggleFiltersBar: any;\n  directPathToChild?: string[];\n  width: number;\n  height: number | string;\n  offset: number;\n}\n\nconst EXCLUDED_URL_PARAMS: string[] = [\n  URL_PARAMS.nativeFilters.name,\n  URL_PARAMS.permalinkKey.name,\n];\n\nconst publishDataMask = debounce(\n  async (\n    history,\n    dashboardId,\n    updateKey,\n    dataMaskSelected: DataMaskStateWithId,\n    tabId,\n  ) => {\n    const { location } = history;\n    const { search } = location;\n    const previousParams = new URLSearchParams(search);\n    const newParams = new URLSearchParams();\n    let dataMaskKey: string | null;\n    previousParams.forEach((value, key) => {\n      if (!EXCLUDED_URL_PARAMS.includes(key)) {\n        newParams.append(key, value);\n      }\n    });\n\n    const nativeFiltersCacheKey = getUrlParam(URL_PARAMS.nativeFiltersKey);\n    const dataMask = JSON.stringify(dataMaskSelected);\n    if (\n      updateKey &&\n      nativeFiltersCacheKey &&\n      (await updateFilterKey(\n        dashboardId,\n        dataMask,\n        nativeFiltersCacheKey,\n        tabId,\n      ))\n    ) {\n      dataMaskKey = nativeFiltersCacheKey;\n    } else {\n      dataMaskKey = await createFilterKey(dashboardId, dataMask, tabId);\n    }\n    if (dataMaskKey) {\n      newParams.set(URL_PARAMS.nativeFiltersKey.name, dataMaskKey);\n    }\n\n    // pathname could be updated somewhere else through window.history\n    // keep react router history in sync with window history\n    history.location.pathname = window.location.pathname;\n    history.replace({\n      search: newParams.toString(),\n    });\n  },\n  SLOW_DEBOUNCE,\n);\n\nexport const FilterBarScrollContext = createContext(false);\nconst FilterBar: React.FC<FiltersBarProps> = ({\n  filtersOpen,\n  toggleFiltersBar,\n  directPathToChild,\n  width,\n  height,\n  offset,\n}) => {\n  const history = useHistory();\n  const dataMaskApplied: DataMaskStateWithId = useNativeFiltersDataMask();\n  const [editFilterSetId, setEditFilterSetId] = useState<number | null>(null);\n  const [dataMaskSelected, setDataMaskSelected] =\n    useImmer<DataMaskStateWithId>(dataMaskApplied);\n  const dispatch = useDispatch();\n  const [updateKey, setUpdateKey] = useState(0);\n  const tabId = useTabId();\n  const filterSets = useFilterSets();\n  const filterSetFilterValues = Object.values(filterSets);\n  const [tab, setTab] = useState(TabIds.AllFilters);\n  const filters = useFilters();\n  const previousFilters = usePrevious(filters);\n  const filterValues = Object.values(filters);\n  const nativeFilterValues = filterValues.filter(isNativeFilter);\n  const dashboardId = useSelector<any, string>(\n    ({ dashboardInfo }) => dashboardInfo?.id,\n  );\n  const canEdit = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.dash_edit_perm,\n  );\n\n  const [isScrolling, setIsScrolling] = useState(false);\n  const timeout = useRef<any>();\n\n  const handleFilterSelectionChange = useCallback(\n    (\n      filter: Pick<Filter, 'id'> & Partial<Filter>,\n      dataMask: Partial<DataMask>,\n    ) => {\n      setDataMaskSelected(draft => {\n        // force instant updating on initialization for filters with `requiredFirst` is true or instant filters\n        if (\n          // filterState.value === undefined - means that value not initialized\n          dataMask.filterState?.value !== undefined &&\n          dataMaskSelected[filter.id]?.filterState?.value === undefined &&\n          filter.requiredFirst\n        ) {\n          dispatch(updateDataMask(filter.id, dataMask));\n        }\n\n        draft[filter.id] = {\n          ...(getInitialDataMask(filter.id) as DataMaskWithId),\n          ...dataMask,\n        };\n      });\n    },\n    [dataMaskSelected, dispatch, setDataMaskSelected],\n  );\n\n  useEffect(() => {\n    if (previousFilters) {\n      const updates = {};\n      Object.values(filters).forEach(currentFilter => {\n        const previousFilter = previousFilters?.[currentFilter.id];\n        if (!previousFilter) {\n          return;\n        }\n        const currentType = currentFilter.filterType;\n        const currentTargets = currentFilter.targets;\n        const currentDataMask = currentFilter.defaultDataMask;\n        const previousType = previousFilter?.filterType;\n        const previousTargets = previousFilter?.targets;\n        const previousDataMask = previousFilter?.defaultDataMask;\n        const typeChanged = currentType !== previousType;\n        const targetsChanged = !isEqual(currentTargets, previousTargets);\n        const dataMaskChanged = !isEqual(currentDataMask, previousDataMask);\n\n        if (typeChanged || targetsChanged || dataMaskChanged) {\n          updates[currentFilter.id] = getInitialDataMask(currentFilter.id);\n        }\n      });\n\n      if (!isEmpty(updates)) {\n        setDataMaskSelected(draft => ({ ...draft, ...updates }));\n        Object.keys(updates).forEach(key => dispatch(clearDataMask(key)));\n      }\n    }\n  }, [JSON.stringify(filters), JSON.stringify(previousFilters)]);\n\n  const dataMaskAppliedText = JSON.stringify(dataMaskApplied);\n\n  useEffect(() => {\n    setDataMaskSelected(() => dataMaskApplied);\n  }, [dataMaskAppliedText, setDataMaskSelected]);\n\n  useEffect(() => {\n    publishDataMask(history, dashboardId, updateKey, dataMaskApplied, tabId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dashboardId, dataMaskAppliedText, history, updateKey, tabId]);\n\n  const handleApply = useCallback(() => {\n    const filterIds = Object.keys(dataMaskSelected);\n    setUpdateKey(1);\n    filterIds.forEach(filterId => {\n      if (dataMaskSelected[filterId]) {\n        dispatch(updateDataMask(filterId, dataMaskSelected[filterId]));\n      }\n    });\n  }, [dataMaskSelected, dispatch]);\n\n  const handleClearAll = useCallback(() => {\n    const filterIds = Object.keys(dataMaskSelected);\n    filterIds.forEach(filterId => {\n      if (dataMaskSelected[filterId]) {\n        dispatch(clearDataMask(filterId));\n        setDataMaskSelected(draft => {\n          if (draft[filterId].filterState?.value !== undefined) {\n            draft[filterId].filterState!.value = undefined;\n          }\n        });\n      }\n    });\n  }, [dataMaskSelected, dispatch, setDataMaskSelected]);\n\n  const openFiltersBar = useCallback(\n    () => toggleFiltersBar(true),\n    [toggleFiltersBar],\n  );\n\n  const onScroll = useCallback(\n    throttle(() => {\n      clearTimeout(timeout.current);\n      setIsScrolling(true);\n      timeout.current = setTimeout(() => {\n        setIsScrolling(false);\n      }, 300);\n    }, 200),\n    [],\n  );\n\n  useEffect(() => {\n    document.onscroll = onScroll;\n    return () => {\n      document.onscroll = null;\n    };\n  }, [onScroll]);\n\n  useFilterUpdates(dataMaskSelected, setDataMaskSelected);\n  const isApplyDisabled = checkIsApplyDisabled(\n    dataMaskSelected,\n    dataMaskApplied,\n    nativeFilterValues,\n  );\n  const isInitialized = useInitialization();\n  const tabPaneStyle = useMemo(\n    () => ({ overflow: 'auto', height, overscrollBehavior: 'contain' }),\n    [height],\n  );\n\n  const numberOfFilters = nativeFilterValues.length;\n\n  return (\n    <FilterBarScrollContext.Provider value={isScrolling}>\n      <BarWrapper\n        {...getFilterBarTestId()}\n        className={cx({ open: filtersOpen })}\n        width={width}\n      >\n        <CollapsedBar\n          {...getFilterBarTestId('collapsable')}\n          className={cx({ open: !filtersOpen })}\n          onClick={openFiltersBar}\n          offset={offset}\n        >\n          <StyledCollapseIcon\n            {...getFilterBarTestId('expand-button')}\n            iconSize=\"l\"\n          />\n          <StyledFilterIcon\n            {...getFilterBarTestId('filter-icon')}\n            iconSize=\"l\"\n          />\n        </CollapsedBar>\n        <Bar className={cx({ open: filtersOpen })} width={width}>\n          <Header toggleFiltersBar={toggleFiltersBar} />\n          {!isInitialized ? (\n            <div css={{ height }}>\n              <Loading />\n            </div>\n          ) : isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS_SET) ? (\n            <StyledTabs\n              centered\n              onChange={setTab as HandlerFunction}\n              defaultActiveKey={TabIds.AllFilters}\n              activeKey={editFilterSetId ? TabIds.AllFilters : undefined}\n            >\n              <AntdTabs.TabPane\n                tab={t('All filters (%(filterCount)d)', {\n                  filterCount: numberOfFilters,\n                })}\n                key={TabIds.AllFilters}\n                css={tabPaneStyle}\n              >\n                {editFilterSetId && (\n                  <EditSection\n                    dataMaskSelected={dataMaskSelected}\n                    disabled={!isApplyDisabled}\n                    onCancel={() => setEditFilterSetId(null)}\n                    filterSetId={editFilterSetId}\n                  />\n                )}\n                {filterValues.length === 0 ? (\n                  <FilterBarEmptyStateContainer>\n                    <EmptyStateSmall\n                      title={t('No filters are currently added')}\n                      image=\"filter.svg\"\n                      description={\n                        canEdit &&\n                        t(\n                          'Click the button above to add a filter to the dashboard',\n                        )\n                      }\n                    />\n                  </FilterBarEmptyStateContainer>\n                ) : (\n                  <FilterControls\n                    dataMaskSelected={dataMaskSelected}\n                    directPathToChild={directPathToChild}\n                    onFilterSelectionChange={handleFilterSelectionChange}\n                  />\n                )}\n              </AntdTabs.TabPane>\n              <AntdTabs.TabPane\n                disabled={!!editFilterSetId}\n                tab={t('Filter sets (%(filterSetCount)d)', {\n                  filterSetCount: filterSetFilterValues.length,\n                })}\n                key={TabIds.FilterSets}\n                css={tabPaneStyle}\n              >\n                <FilterSets\n                  onEditFilterSet={setEditFilterSetId}\n                  disabled={!isApplyDisabled}\n                  dataMaskSelected={dataMaskSelected}\n                  tab={tab}\n                  onFilterSelectionChange={handleFilterSelectionChange}\n                />\n              </AntdTabs.TabPane>\n            </StyledTabs>\n          ) : (\n            <div css={tabPaneStyle} onScroll={onScroll}>\n              {filterValues.length === 0 ? (\n                <FilterBarEmptyStateContainer>\n                  <EmptyStateSmall\n                    title={t('No filters are currently added')}\n                    image=\"filter.svg\"\n                    description={\n                      canEdit &&\n                      t(\n                        'Click the button above to add a filter to the dashboard',\n                      )\n                    }\n                  />\n                </FilterBarEmptyStateContainer>\n              ) : (\n                <FilterControls\n                  dataMaskSelected={dataMaskSelected}\n                  directPathToChild={directPathToChild}\n                  onFilterSelectionChange={handleFilterSelectionChange}\n                />\n              )}\n            </div>\n          )}\n          <ActionButtons\n            onApply={handleApply}\n            onClearAll={handleClearAll}\n            dataMaskSelected={dataMaskSelected}\n            dataMaskApplied={dataMaskApplied}\n            isApplyDisabled={isApplyDisabled}\n          />\n        </Bar>\n      </BarWrapper>\n    </FilterBarScrollContext.Provider>\n  );\n};\nexport default React.memo(FilterBar);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DASHBOARD_GRID_ID,\n  DASHBOARD_ROOT_ID,\n} from 'src/dashboard/util/constants';\nimport { DashboardLayout } from 'src/dashboard/types';\nimport findTabIndexByComponentId from 'src/dashboard/util/findTabIndexByComponentId';\n\nexport const getRootLevelTabsComponent = (dashboardLayout: DashboardLayout) => {\n  const dashboardRoot = dashboardLayout[DASHBOARD_ROOT_ID];\n  const rootChildId = dashboardRoot?.children[0];\n  return rootChildId === DASHBOARD_GRID_ID\n    ? dashboardLayout[DASHBOARD_ROOT_ID]\n    : dashboardLayout[rootChildId];\n};\n\nexport const shouldFocusTabs = (\n  event: { target: { className: string } },\n  container: { contains: (arg0: any) => any },\n) =>\n  // don't focus the tabs when we click on a tab\n  event.target.className === 'ant-tabs-nav-wrap' ||\n  container.contains(event.target);\n\nexport const getRootLevelTabIndex = (\n  dashboardLayout: DashboardLayout,\n  directPathToChild: string[],\n): number =>\n  Math.max(\n    0,\n    findTabIndexByComponentId({\n      currentComponent: getRootLevelTabsComponent(dashboardLayout),\n      directPathToChild,\n    }),\n  );\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, t } from '@superset-ui/core';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport { componentShape } from '../util/propShapes';\nimport DashboardComponent from '../containers/DashboardComponent';\nimport DragDroppable from './dnd/DragDroppable';\nimport { GRID_GUTTER_SIZE, GRID_COLUMN_COUNT } from '../util/constants';\nimport { TAB_TYPE } from '../util/componentTypes';\n\nconst propTypes = {\n  depth: PropTypes.number.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  gridComponent: componentShape.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  isComponentVisible: PropTypes.bool.isRequired,\n  resizeComponent: PropTypes.func.isRequired,\n  setDirectPathToChild: PropTypes.func.isRequired,\n  width: PropTypes.number.isRequired,\n  dashboardId: PropTypes.number,\n};\n\nconst defaultProps = {};\n\nconst renderDraggableContentBottom = dropProps =>\n  dropProps.dropIndicatorProps && (\n    <div className=\"drop-indicator drop-indicator--bottom\" />\n  );\n\nconst renderDraggableContentTop = dropProps =>\n  dropProps.dropIndicatorProps && (\n    <div className=\"drop-indicator drop-indicator--top\" />\n  );\n\nconst DashboardEmptyStateContainer = styled.div`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\nclass DashboardGrid extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isResizing: false,\n      rowGuideTop: null,\n    };\n\n    this.handleResizeStart = this.handleResizeStart.bind(this);\n    this.handleResize = this.handleResize.bind(this);\n    this.handleResizeStop = this.handleResizeStop.bind(this);\n    this.handleTopDropTargetDrop = this.handleTopDropTargetDrop.bind(this);\n    this.getRowGuidePosition = this.getRowGuidePosition.bind(this);\n    this.setGridRef = this.setGridRef.bind(this);\n    this.handleChangeTab = this.handleChangeTab.bind(this);\n  }\n\n  getRowGuidePosition(resizeRef) {\n    if (resizeRef && this.grid) {\n      return (\n        resizeRef.getBoundingClientRect().bottom -\n        this.grid.getBoundingClientRect().top -\n        2\n      );\n    }\n    return null;\n  }\n\n  setGridRef(ref) {\n    this.grid = ref;\n  }\n\n  handleResizeStart({ ref, direction }) {\n    let rowGuideTop = null;\n    if (direction === 'bottom' || direction === 'bottomRight') {\n      rowGuideTop = this.getRowGuidePosition(ref);\n    }\n\n    this.setState(() => ({\n      isResizing: true,\n      rowGuideTop,\n    }));\n  }\n\n  handleResize({ ref, direction }) {\n    if (direction === 'bottom' || direction === 'bottomRight') {\n      this.setState(() => ({ rowGuideTop: this.getRowGuidePosition(ref) }));\n    }\n  }\n\n  handleResizeStop({ id, widthMultiple: width, heightMultiple: height }) {\n    this.props.resizeComponent({ id, width, height });\n\n    this.setState(() => ({\n      isResizing: false,\n      rowGuideTop: null,\n    }));\n  }\n\n  handleTopDropTargetDrop(dropResult) {\n    if (dropResult) {\n      this.props.handleComponentDrop({\n        ...dropResult,\n        destination: {\n          ...dropResult.destination,\n          // force appending as the first child if top drop target\n          index: 0,\n        },\n      });\n    }\n  }\n\n  handleChangeTab({ pathToTabIndex }) {\n    this.props.setDirectPathToChild(pathToTabIndex);\n  }\n\n  render() {\n    const {\n      gridComponent,\n      handleComponentDrop,\n      depth,\n      width,\n      isComponentVisible,\n      editMode,\n      canEdit,\n      setEditMode,\n      dashboardId,\n    } = this.props;\n    const columnPlusGutterWidth =\n      (width + GRID_GUTTER_SIZE) / GRID_COLUMN_COUNT;\n\n    const columnWidth = columnPlusGutterWidth - GRID_GUTTER_SIZE;\n    const { isResizing, rowGuideTop } = this.state;\n\n    const shouldDisplayEmptyState = gridComponent?.children?.length === 0;\n    const shouldDisplayTopLevelTabEmptyState =\n      shouldDisplayEmptyState && gridComponent.type === TAB_TYPE;\n\n    const dashboardEmptyState = editMode && (\n      <EmptyStateBig\n        title={t('Drag and drop components and charts to the dashboard')}\n        description={t(\n          'You can create a new chart or use existing ones from the panel on the right',\n        )}\n        buttonText={\n          <>\n            <i className=\"fa fa-plus\" />\n            {t('Create a new chart')}\n          </>\n        }\n        buttonAction={() => {\n          window.open(\n            `/chart/add?dashboard_id=${dashboardId}`,\n            '_blank',\n            'noopener noreferrer',\n          );\n        }}\n        image=\"chart.svg\"\n      />\n    );\n\n    const topLevelTabEmptyState = editMode ? (\n      <EmptyStateBig\n        title={t('Drag and drop components to this tab')}\n        description={t(\n          `You can create a new chart or use existing ones from the panel on the right`,\n        )}\n        buttonText={\n          <>\n            <i className=\"fa fa-plus\" />\n            {t('Create a new chart')}\n          </>\n        }\n        buttonAction={() => {\n          window.open(\n            `/chart/add?dashboard_id=${dashboardId}`,\n            '_blank',\n            'noopener noreferrer',\n          );\n        }}\n        image=\"chart.svg\"\n      />\n    ) : (\n      <EmptyStateBig\n        title={t('There are no components added to this tab')}\n        description={\n          canEdit && t('You can add the components in the edit mode.')\n        }\n        buttonText={canEdit && t('Edit the dashboard')}\n        buttonAction={\n          canEdit &&\n          (() => {\n            setEditMode(true);\n          })\n        }\n        image=\"chart.svg\"\n      />\n    );\n\n    return width < 100 ? null : (\n      <>\n        {shouldDisplayEmptyState && (\n          <DashboardEmptyStateContainer>\n            {shouldDisplayTopLevelTabEmptyState\n              ? topLevelTabEmptyState\n              : dashboardEmptyState}\n          </DashboardEmptyStateContainer>\n        )}\n        <div className=\"dashboard-grid\" ref={this.setGridRef}>\n          <div className=\"grid-content\" data-test=\"grid-content\">\n            {/* make the area above components droppable */}\n            {editMode && (\n              <DragDroppable\n                component={gridComponent}\n                depth={depth}\n                parentComponent={null}\n                index={0}\n                orientation=\"column\"\n                onDrop={this.handleTopDropTargetDrop}\n                className=\"empty-droptarget\"\n                editMode\n              >\n                {renderDraggableContentBottom}\n              </DragDroppable>\n            )}\n            {gridComponent?.children?.map((id, index) => (\n              <DashboardComponent\n                key={id}\n                id={id}\n                parentId={gridComponent.id}\n                depth={depth + 1}\n                index={index}\n                availableColumnCount={GRID_COLUMN_COUNT}\n                columnWidth={columnWidth}\n                isComponentVisible={isComponentVisible}\n                onResizeStart={this.handleResizeStart}\n                onResize={this.handleResize}\n                onResizeStop={this.handleResizeStop}\n                onChangeTab={this.handleChangeTab}\n              />\n            ))}\n            {/* make the area below components droppable */}\n            {editMode && gridComponent?.children?.length > 0 && (\n              <DragDroppable\n                component={gridComponent}\n                depth={depth}\n                parentComponent={null}\n                index={gridComponent.children.length}\n                orientation=\"column\"\n                onDrop={handleComponentDrop}\n                className=\"empty-droptarget\"\n                editMode\n              >\n                {renderDraggableContentTop}\n              </DragDroppable>\n            )}\n            {isResizing &&\n              Array(GRID_COLUMN_COUNT)\n                .fill(null)\n                .map((_, i) => (\n                  <div\n                    key={`grid-column-${i}`}\n                    className=\"grid-column-guide\"\n                    style={{\n                      left: i * GRID_GUTTER_SIZE + i * columnWidth,\n                      width: columnWidth,\n                    }}\n                  />\n                ))}\n            {isResizing && rowGuideTop && (\n              <div\n                className=\"grid-row-guide\"\n                style={{\n                  top: rowGuideTop,\n                  width,\n                }}\n              />\n            )}\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nDashboardGrid.propTypes = propTypes;\nDashboardGrid.defaultProps = defaultProps;\n\nexport default DashboardGrid;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport DashboardGrid from '../components/DashboardGrid';\n\nimport {\n  handleComponentDrop,\n  resizeComponent,\n} from '../actions/dashboardLayout';\nimport { setDirectPathToChild, setEditMode } from '../actions/dashboardState';\n\nfunction mapStateToProps({ dashboardState, dashboardInfo }) {\n  return {\n    editMode: dashboardState.editMode,\n    canEdit: dashboardInfo.dash_edit_perm,\n    dashboardId: dashboardInfo.id,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      handleComponentDrop,\n      resizeComponent,\n      setDirectPathToChild,\n      setEditMode,\n    },\n    dispatch,\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DashboardGrid);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n// ParentSize uses resize observer so the dashboard will update size\n// when its container size changes, due to e.g., builder side panel opening\nimport React, { FC, useEffect, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  FeatureFlag,\n  Filter,\n  Filters,\n  isFeatureEnabled,\n} from '@superset-ui/core';\nimport { ParentSize } from '@vx/responsive';\nimport pick from 'lodash/pick';\nimport Tabs from 'src/components/Tabs';\nimport DashboardGrid from 'src/dashboard/containers/DashboardGrid';\nimport {\n  ChartsState,\n  DashboardLayout,\n  LayoutItem,\n  RootState,\n} from 'src/dashboard/types';\nimport {\n  DASHBOARD_GRID_ID,\n  DASHBOARD_ROOT_DEPTH,\n} from 'src/dashboard/util/constants';\nimport { getChartIdsInFilterScope } from 'src/dashboard/util/getChartIdsInFilterScope';\nimport findTabIndexByComponentId from 'src/dashboard/util/findTabIndexByComponentId';\nimport { setInScopeStatusOfFilters } from 'src/dashboard/actions/nativeFilters';\nimport { getRootLevelTabIndex, getRootLevelTabsComponent } from './utils';\nimport { findTabsWithChartsInScope } from '../nativeFilters/utils';\nimport { NATIVE_FILTER_DIVIDER_PREFIX } from '../nativeFilters/FiltersConfigModal/utils';\n\ntype DashboardContainerProps = {\n  topLevelTabs?: LayoutItem;\n};\n\nconst useNativeFilterScopes = () => {\n  const nativeFilters = useSelector<RootState, Filters>(\n    state => state.nativeFilters?.filters,\n  );\n  return useMemo(\n    () =>\n      nativeFilters\n        ? Object.values(nativeFilters).map((filter: Filter) =>\n            pick(filter, ['id', 'scope', 'type']),\n          )\n        : [],\n    [JSON.stringify(nativeFilters)],\n  );\n};\n\nconst DashboardContainer: FC<DashboardContainerProps> = ({ topLevelTabs }) => {\n  const nativeFilterScopes = useNativeFilterScopes();\n  const dispatch = useDispatch();\n\n  const dashboardLayout = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const directPathToChild = useSelector<RootState, string[]>(\n    state => state.dashboardState.directPathToChild,\n  );\n  const charts = useSelector<RootState, ChartsState>(state => state.charts);\n\n  const tabIndex = useMemo(() => {\n    const nextTabIndex = findTabIndexByComponentId({\n      currentComponent: getRootLevelTabsComponent(dashboardLayout),\n      directPathToChild,\n    });\n\n    return nextTabIndex > -1\n      ? nextTabIndex\n      : getRootLevelTabIndex(dashboardLayout, directPathToChild);\n  }, [dashboardLayout, directPathToChild]);\n\n  useEffect(() => {\n    if (\n      !isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS) ||\n      nativeFilterScopes.length === 0\n    ) {\n      return;\n    }\n    const scopes = nativeFilterScopes.map(filterScope => {\n      if (filterScope.id.startsWith(NATIVE_FILTER_DIVIDER_PREFIX)) {\n        return {\n          filterId: filterScope.id,\n          tabsInScope: [],\n          chartsInScope: [],\n        };\n      }\n      const chartsInScope: number[] = getChartIdsInFilterScope(\n        filterScope.scope,\n        charts,\n        dashboardLayout,\n      );\n      const tabsInScope = findTabsWithChartsInScope(\n        dashboardLayout,\n        chartsInScope,\n      );\n      return {\n        filterId: filterScope.id,\n        tabsInScope: Array.from(tabsInScope),\n        chartsInScope,\n      };\n    });\n    dispatch(setInScopeStatusOfFilters(scopes));\n  }, [nativeFilterScopes, dashboardLayout, dispatch]);\n\n  const childIds: string[] = topLevelTabs\n    ? topLevelTabs.children\n    : [DASHBOARD_GRID_ID];\n\n  const min = Math.min(tabIndex, childIds.length - 1);\n  const activeKey = min === 0 ? DASHBOARD_GRID_ID : min.toString();\n\n  return (\n    <div className=\"grid-container\" data-test=\"grid-container\">\n      <ParentSize>\n        {({ width }) => (\n          /*\n            We use a TabContainer irrespective of whether top-level tabs exist to maintain\n            a consistent React component tree. This avoids expensive mounts/unmounts of\n            the entire dashboard upon adding/removing top-level tabs, which would otherwise\n            happen because of React's diffing algorithm\n          */\n          <Tabs\n            id={DASHBOARD_GRID_ID}\n            activeKey={activeKey}\n            renderTabBar={() => <></>}\n            fullWidth={false}\n            animated={false}\n            allowOverflow\n          >\n            {childIds.map((id, index) => (\n              // Matching the key of the first TabPane irrespective of topLevelTabs\n              // lets us keep the same React component tree when !!topLevelTabs changes.\n              // This avoids expensive mounts/unmounts of the entire dashboard.\n              <Tabs.TabPane\n                key={index === 0 ? DASHBOARD_GRID_ID : index.toString()}\n              >\n                <DashboardGrid\n                  gridComponent={dashboardLayout[id]}\n                  // see isValidChild for why tabs do not increment the depth of their children\n                  depth={DASHBOARD_ROOT_DEPTH + 1} // (topLevelTabs ? 0 : 1)}\n                  width={width}\n                  isComponentVisible={index === tabIndex}\n                />\n              </Tabs.TabPane>\n            ))}\n          </Tabs>\n        )}\n      </ParentSize>\n    </div>\n  );\n};\n\nexport default DashboardContainer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { NativeFilterScope } from '@superset-ui/core';\nimport { CHART_TYPE } from './componentTypes';\nimport { ChartsState, Layout } from '../types';\n\nexport function getChartIdsInFilterScope(\n  filterScope: NativeFilterScope,\n  charts: ChartsState,\n  layout: Layout,\n) {\n  const layoutItems = Object.values(layout);\n  return Object.values(charts)\n    .filter(\n      chart =>\n        !filterScope.excluded.includes(chart.id) &&\n        layoutItems\n          .find(\n            layoutItem =>\n              layoutItem?.type === CHART_TYPE &&\n              layoutItem.meta?.chartId === chart.id,\n          )\n          ?.parents?.some(elementId =>\n            filterScope.rootPath.includes(elementId),\n          ),\n    )\n    .map(chart => chart.id);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport cx from 'classnames';\nimport React, {\n  FC,\n  useCallback,\n  useEffect,\n  useState,\n  useMemo,\n  useRef,\n} from 'react';\nimport { JsonObject, styled, css, t } from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport BuilderComponentPane from 'src/dashboard/components/BuilderComponentPane';\nimport DashboardHeader from 'src/dashboard/containers/DashboardHeader';\nimport Icons from 'src/components/Icons';\nimport IconButton from 'src/dashboard/components/IconButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport getDirectPathToTabIndex from 'src/dashboard/util/getDirectPathToTabIndex';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { DashboardLayout, RootState } from 'src/dashboard/types';\nimport {\n  setDirectPathToChild,\n  setEditMode,\n} from 'src/dashboard/actions/dashboardState';\nimport { useElementOnScreen } from 'src/hooks/useElementOnScreen';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport {\n  deleteTopLevelTabs,\n  handleComponentDrop,\n} from 'src/dashboard/actions/dashboardLayout';\nimport {\n  DASHBOARD_GRID_ID,\n  DASHBOARD_ROOT_ID,\n  DASHBOARD_ROOT_DEPTH,\n  DashboardStandaloneMode,\n} from 'src/dashboard/util/constants';\nimport FilterBar from 'src/dashboard/components/nativeFilters/FilterBar';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport { useUiConfig } from 'src/components/UiConfigContext';\nimport {\n  BUILDER_SIDEPANEL_WIDTH,\n  CLOSED_FILTER_BAR_WIDTH,\n  FILTER_BAR_HEADER_HEIGHT,\n  FILTER_BAR_TABS_HEIGHT,\n  MAIN_HEADER_HEIGHT,\n  OPEN_FILTER_BAR_WIDTH,\n} from 'src/dashboard/constants';\nimport { shouldFocusTabs, getRootLevelTabsComponent } from './utils';\nimport DashboardContainer from './DashboardContainer';\nimport { useNativeFilters } from './state';\n\ntype DashboardBuilderProps = {};\n\nconst StyledDiv = styled.div`\n  display: grid;\n  grid-template-columns: auto 1fr;\n  grid-template-rows: auto 1fr;\n  flex: 1;\n  /* Special cases */\n\n  /* A row within a column has inset hover menu */\n  .dragdroppable-column .dragdroppable-row .hover-menu--left {\n    left: -12px;\n    background: ${({ theme }) => theme.colors.grayscale.light5};\n    border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  }\n\n  .dashboard-component-tabs {\n    position: relative;\n  }\n\n  /* A column within a column or tabs has inset hover menu */\n  .dragdroppable-column .dragdroppable-column .hover-menu--top,\n  .dashboard-component-tabs .dragdroppable-column .hover-menu--top {\n    top: -12px;\n    background: ${({ theme }) => theme.colors.grayscale.light5};\n    border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  }\n\n  /* move Tabs hover menu to top near actual Tabs */\n  .dashboard-component-tabs > .hover-menu-container > .hover-menu--left {\n    top: 0;\n    transform: unset;\n    background: transparent;\n  }\n\n  /* push Chart actions to upper right */\n  .dragdroppable-column .dashboard-component-chart-holder .hover-menu--top,\n  .dragdroppable .dashboard-component-header .hover-menu--top {\n    right: 8px;\n    top: 8px;\n    background: transparent;\n    border: none;\n    transform: unset;\n    left: unset;\n  }\n  div:hover > .hover-menu-container .hover-menu,\n  .hover-menu-container .hover-menu:hover {\n    opacity: 1;\n  }\n`;\n\n// @z-index-above-dashboard-charts + 1 = 11\nconst FiltersPanel = styled.div`\n  grid-column: 1;\n  grid-row: 1 / span 2;\n  z-index: 11;\n`;\n\nconst StickyPanel = styled.div<{ width: number }>`\n  position: sticky;\n  top: -1px;\n  width: ${({ width }) => width}px;\n  flex: 0 0 ${({ width }) => width}px;\n`;\n\n// @z-index-above-dashboard-popovers (99) + 1 = 100\nconst StyledHeader = styled.div`\n  grid-column: 2;\n  grid-row: 1;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n`;\n\nconst StyledContent = styled.div<{\n  fullSizeChartId: number | null;\n}>`\n  grid-column: 2;\n  grid-row: 2;\n  // @z-index-above-dashboard-header (100) + 1 = 101\n  ${({ fullSizeChartId }) => fullSizeChartId && `z-index: 101;`}\n`;\n\nconst StyledDashboardContent = styled.div<{\n  dashboardFiltersOpen: boolean;\n  editMode: boolean;\n  nativeFiltersEnabled: boolean;\n}>`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  height: auto;\n  flex: 1;\n\n  .grid-container .dashboard-component-tabs {\n    box-shadow: none;\n    padding-left: 0;\n  }\n\n  .grid-container {\n    /* without this, the grid will not get smaller upon toggling the builder panel on */\n    width: 0;\n    flex: 1;\n    position: relative;\n    margin-top: ${({ theme }) => theme.gridUnit * 6}px;\n    margin-right: ${({ theme }) => theme.gridUnit * 8}px;\n    margin-bottom: ${({ theme }) => theme.gridUnit * 6}px;\n    margin-left: ${({\n      theme,\n      dashboardFiltersOpen,\n      editMode,\n      nativeFiltersEnabled,\n    }) => {\n      if (!dashboardFiltersOpen && !editMode && nativeFiltersEnabled) {\n        return 0;\n      }\n      return theme.gridUnit * 8;\n    }}px;\n\n    ${({ editMode, theme }) =>\n      editMode &&\n      `\n      max-width: calc(100% - ${\n        BUILDER_SIDEPANEL_WIDTH + theme.gridUnit * 16\n      }px);\n    `}\n  }\n\n  .dashboard-builder-sidepane {\n    width: ${BUILDER_SIDEPANEL_WIDTH}px;\n    z-index: 1;\n  }\n\n  .dashboard-component-chart-holder {\n    // transitionable traits to show filter relevance\n    transition: opacity ${({ theme }) => theme.transitionTiming}s,\n      border-color ${({ theme }) => theme.transitionTiming}s,\n      box-shadow ${({ theme }) => theme.transitionTiming}s;\n    border: 0 solid transparent;\n  }\n`;\n\nconst DashboardBuilder: FC<DashboardBuilderProps> = () => {\n  const dispatch = useDispatch();\n  const uiConfig = useUiConfig();\n\n  const dashboardLayout = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const editMode = useSelector<RootState, boolean>(\n    state => state.dashboardState.editMode,\n  );\n  const canEdit = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.dash_edit_perm,\n  );\n  const directPathToChild = useSelector<RootState, string[]>(\n    state => state.dashboardState.directPathToChild,\n  );\n  const fullSizeChartId = useSelector<RootState, number | null>(\n    state => state.dashboardState.fullSizeChartId,\n  );\n\n  const handleChangeTab = useCallback(\n    ({ pathToTabIndex }: { pathToTabIndex: string[] }) => {\n      dispatch(setDirectPathToChild(pathToTabIndex));\n    },\n    [dispatch],\n  );\n\n  const handleDeleteTopLevelTabs = useCallback(() => {\n    dispatch(deleteTopLevelTabs());\n\n    const firstTab = getDirectPathToTabIndex(\n      getRootLevelTabsComponent(dashboardLayout),\n      0,\n    );\n    dispatch(setDirectPathToChild(firstTab));\n  }, [dashboardLayout, dispatch]);\n\n  const handleDrop = useCallback(\n    dropResult => dispatch(handleComponentDrop(dropResult)),\n    [dispatch],\n  );\n\n  const headerRef = React.useRef<HTMLDivElement>(null);\n  const dashboardRoot = dashboardLayout[DASHBOARD_ROOT_ID];\n  const rootChildId = dashboardRoot?.children[0];\n  const topLevelTabs =\n    rootChildId !== DASHBOARD_GRID_ID\n      ? dashboardLayout[rootChildId]\n      : undefined;\n  const standaloneMode = getUrlParam(URL_PARAMS.standalone);\n  const isReport = standaloneMode === DashboardStandaloneMode.REPORT;\n  const hideDashboardHeader =\n    uiConfig.hideTitle ||\n    standaloneMode === DashboardStandaloneMode.HIDE_NAV_AND_TITLE ||\n    isReport;\n  const [barTopOffset, setBarTopOffset] = useState(0);\n\n  useEffect(() => {\n    setBarTopOffset(headerRef.current?.getBoundingClientRect()?.height || 0);\n\n    let observer: ResizeObserver;\n    if (typeof global.ResizeObserver !== 'undefined' && headerRef.current) {\n      observer = new ResizeObserver(entries => {\n        setBarTopOffset(\n          current => entries?.[0]?.contentRect?.height || current,\n        );\n      });\n\n      observer.observe(headerRef.current);\n    }\n\n    return () => {\n      observer?.disconnect();\n    };\n  }, []);\n\n  const {\n    showDashboard,\n    dashboardFiltersOpen,\n    toggleDashboardFiltersOpen,\n    nativeFiltersEnabled,\n  } = useNativeFilters();\n\n  const filterBarWidth = dashboardFiltersOpen\n    ? OPEN_FILTER_BAR_WIDTH\n    : CLOSED_FILTER_BAR_WIDTH;\n\n  const [containerRef, isSticky] = useElementOnScreen<HTMLDivElement>({\n    threshold: [1],\n  });\n\n  const filterSetEnabled = isFeatureEnabled(\n    FeatureFlag.DASHBOARD_NATIVE_FILTERS_SET,\n  );\n\n  const offset =\n    FILTER_BAR_HEADER_HEIGHT +\n    (isSticky || standaloneMode ? 0 : MAIN_HEADER_HEIGHT) +\n    (filterSetEnabled ? FILTER_BAR_TABS_HEIGHT : 0);\n\n  const filterBarHeight = `calc(100vh - ${offset}px)`;\n  const filterBarOffset = dashboardFiltersOpen ? 0 : barTopOffset + 20;\n\n  const draggableStyle = useMemo(\n    () => ({\n      marginLeft:\n        dashboardFiltersOpen || editMode || !nativeFiltersEnabled ? 0 : -32,\n    }),\n    [dashboardFiltersOpen, editMode, nativeFiltersEnabled],\n  );\n\n  // If a new tab was added, update the directPathToChild to reflect it\n  const currentTopLevelTabs = useRef(topLevelTabs);\n  useEffect(() => {\n    const currentTabsLength = currentTopLevelTabs.current?.children?.length;\n    const newTabsLength = topLevelTabs?.children?.length;\n\n    if (\n      currentTabsLength !== undefined &&\n      newTabsLength !== undefined &&\n      newTabsLength > currentTabsLength\n    ) {\n      const lastTab = getDirectPathToTabIndex(\n        getRootLevelTabsComponent(dashboardLayout),\n        newTabsLength - 1,\n      );\n      dispatch(setDirectPathToChild(lastTab));\n    }\n\n    currentTopLevelTabs.current = topLevelTabs;\n  }, [topLevelTabs]);\n\n  const renderDraggableContent = useCallback(\n    ({ dropIndicatorProps }: { dropIndicatorProps: JsonObject }) => (\n      <div>\n        {!hideDashboardHeader && <DashboardHeader />}\n        {dropIndicatorProps && <div {...dropIndicatorProps} />}\n        {!isReport && topLevelTabs && !uiConfig.hideNav && (\n          <WithPopoverMenu\n            shouldFocus={shouldFocusTabs}\n            menuItems={[\n              <IconButton\n                icon={<Icons.FallOutlined iconSize=\"xl\" />}\n                label=\"Collapse tab content\"\n                onClick={handleDeleteTopLevelTabs}\n              />,\n            ]}\n            editMode={editMode}\n          >\n            {/* @ts-ignore */}\n            <DashboardComponent\n              id={topLevelTabs?.id}\n              parentId={DASHBOARD_ROOT_ID}\n              depth={DASHBOARD_ROOT_DEPTH + 1}\n              index={0}\n              renderTabContent={false}\n              renderHoverMenu={false}\n              onChangeTab={handleChangeTab}\n            />\n          </WithPopoverMenu>\n        )}\n      </div>\n    ),\n    [\n      editMode,\n      handleChangeTab,\n      handleDeleteTopLevelTabs,\n      hideDashboardHeader,\n      isReport,\n      topLevelTabs,\n      uiConfig.hideNav,\n    ],\n  );\n\n  return (\n    <StyledDiv>\n      {nativeFiltersEnabled && !editMode && (\n        <FiltersPanel>\n          <StickyPanel ref={containerRef} width={filterBarWidth}>\n            <ErrorBoundary>\n              <FilterBar\n                filtersOpen={dashboardFiltersOpen}\n                toggleFiltersBar={toggleDashboardFiltersOpen}\n                directPathToChild={directPathToChild}\n                width={filterBarWidth}\n                height={filterBarHeight}\n                offset={filterBarOffset}\n              />\n            </ErrorBoundary>\n          </StickyPanel>\n        </FiltersPanel>\n      )}\n      <StyledHeader ref={headerRef}>\n        {/* @ts-ignore */}\n        <DragDroppable\n          data-test=\"top-level-tabs\"\n          component={dashboardRoot}\n          parentComponent={null}\n          depth={DASHBOARD_ROOT_DEPTH}\n          index={0}\n          orientation=\"column\"\n          onDrop={handleDrop}\n          editMode={editMode}\n          // you cannot drop on/displace tabs if they already exist\n          disableDragDrop={!!topLevelTabs}\n          style={draggableStyle}\n        >\n          {renderDraggableContent}\n        </DragDroppable>\n      </StyledHeader>\n      <StyledContent fullSizeChartId={fullSizeChartId}>\n        <Global\n          styles={css`\n            // @z-index-above-dashboard-header (100) + 1 = 101\n            ${fullSizeChartId &&\n            `div > .filterStatusPopover.ant-popover{z-index: 101}`}\n          `}\n        />\n        {!editMode &&\n          !topLevelTabs &&\n          dashboardLayout[DASHBOARD_GRID_ID]?.children?.length === 0 && (\n            <EmptyStateBig\n              title={t('There are no charts added to this dashboard')}\n              description={\n                canEdit &&\n                t(\n                  'Go to the edit mode to configure the dashboard and add charts',\n                )\n              }\n              buttonText={canEdit && t('Edit the dashboard')}\n              buttonAction={() => dispatch(setEditMode(true))}\n              image=\"dashboard.svg\"\n            />\n          )}\n        <div\n          data-test=\"dashboard-content\"\n          className={cx('dashboard', editMode && 'dashboard--editing')}\n        >\n          <StyledDashboardContent\n            className=\"dashboard-content\"\n            dashboardFiltersOpen={dashboardFiltersOpen}\n            editMode={editMode}\n            nativeFiltersEnabled={nativeFiltersEnabled}\n          >\n            {showDashboard ? (\n              <DashboardContainer topLevelTabs={topLevelTabs} />\n            ) : (\n              <Loading />\n            )}\n            {editMode && (\n              <BuilderComponentPane\n                isStandalone={!!standaloneMode}\n                topOffset={barTopOffset}\n              />\n            )}\n          </StyledDashboardContent>\n        </div>\n      </StyledContent>\n    </StyledDiv>\n  );\n};\n\nexport default DashboardBuilder;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useSelector } from 'react-redux';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { useCallback, useEffect, useState, useContext } from 'react';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { RootState } from 'src/dashboard/types';\nimport { MigrationContext } from 'src/dashboard/containers/DashboardPage';\nimport {\n  useFilters,\n  useNativeFiltersDataMask,\n} from '../nativeFilters/FilterBar/state';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const useNativeFilters = () => {\n  const filterboxMigrationState = useContext(MigrationContext);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const showNativeFilters = useSelector<RootState, boolean>(\n    state =>\n      (getUrlParam(URL_PARAMS.showFilters) ?? true) &&\n      state.dashboardInfo.metadata?.show_native_filters,\n  );\n  const canEdit = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.dash_edit_perm,\n  );\n\n  const filters = useFilters();\n  const filterValues = Object.values(filters);\n  const expandFilters = getUrlParam(URL_PARAMS.expandFilters);\n  const [dashboardFiltersOpen, setDashboardFiltersOpen] = useState(\n    expandFilters ?? !!filterValues.length,\n  );\n\n  const nativeFiltersEnabled =\n    showNativeFilters &&\n    isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS) &&\n    (canEdit || (!canEdit && filterValues.length !== 0));\n\n  const requiredFirstFilter = filterValues.filter(\n    filter => filter.requiredFirst,\n  );\n  const dataMask = useNativeFiltersDataMask();\n  const showDashboard =\n    isInitialized ||\n    !nativeFiltersEnabled ||\n    !(\n      nativeFiltersEnabled &&\n      requiredFirstFilter.length &&\n      requiredFirstFilter.find(\n        ({ id }) => dataMask[id]?.filterState?.value === undefined,\n      )\n    );\n\n  const toggleDashboardFiltersOpen = useCallback(\n    (visible?: boolean) => {\n      setDashboardFiltersOpen(visible ?? !dashboardFiltersOpen);\n    },\n    [dashboardFiltersOpen],\n  );\n\n  useEffect(() => {\n    if (\n      expandFilters === false ||\n      (filterValues.length === 0 &&\n        nativeFiltersEnabled &&\n        ['CONVERTED', 'REVIEWING', 'NOOP'].includes(filterboxMigrationState))\n    ) {\n      toggleDashboardFiltersOpen(false);\n    } else {\n      toggleDashboardFiltersOpen(true);\n    }\n  }, [filterValues.length, filterboxMigrationState]);\n\n  useEffect(() => {\n    if (showDashboard) {\n      setIsInitialized(true);\n    }\n  }, [showDashboard]);\n\n  return {\n    showDashboard,\n    dashboardFiltersOpen,\n    toggleDashboardFiltersOpen,\n    nativeFiltersEnabled,\n  };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useRef, useState, RefObject } from 'react';\n\nexport function useElementOnScreen<T extends Element>(\n  options: IntersectionObserverInit,\n): [RefObject<T>, boolean] {\n  const containerRef = useRef<T>(null);\n  const [isSticky, setIsSticky] = useState(false);\n\n  const callback = (entries: IntersectionObserverEntry[]) => {\n    const [entry] = entries;\n    setIsSticky(entry.intersectionRatio < 1);\n  };\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(callback, options);\n    const element = containerRef.current;\n    if (element) {\n      observer.observe(element);\n    }\n    return () => {\n      if (element) {\n        observer.unobserve(element);\n      }\n    };\n  }, [containerRef, options]);\n\n  return [containerRef, isSticky];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { CHART_TYPE, MARKDOWN_TYPE, DYNAMIC_TYPE } from './componentTypes';\n\nconst USER_CONTENT_COMPONENT_TYPE: string[] = [\n  CHART_TYPE,\n  MARKDOWN_TYPE,\n  DYNAMIC_TYPE,\n];\nexport default function isDashboardEmpty(layout: any): boolean {\n  // has at least one chart or markdown component\n  return !Object.values(layout).some(\n    ({ type }: { type?: string }) =>\n      type && USER_CONTENT_COMPONENT_TYPE.includes(type),\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { JsonObject } from '@superset-ui/core';\nimport { areObjectsEqual } from '../../../reduxUtils';\n\nexport const arrayDiff = (a: string[], b: string[]) => [\n  ...a.filter(x => !b.includes(x)),\n  ...b.filter(x => !a.includes(x)),\n];\n\nexport const getAffectedOwnDataCharts = (\n  ownDataCharts: JsonObject,\n  appliedOwnDataCharts: JsonObject,\n) => {\n  const chartIds = Object.keys(ownDataCharts);\n  const appliedChartIds = Object.keys(appliedOwnDataCharts);\n  const affectedIds: string[] = arrayDiff(chartIds, appliedChartIds).filter(\n    id => ownDataCharts[id] || appliedOwnDataCharts[id],\n  );\n  const checkForUpdateIds = new Set<string>([...chartIds, ...appliedChartIds]);\n  checkForUpdateIds.forEach(chartId => {\n    if (\n      !areObjectsEqual(ownDataCharts[chartId], appliedOwnDataCharts[chartId])\n    ) {\n      affectedIds.push(chartId);\n    }\n  });\n  return [...new Set(affectedIds)];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { isFeatureEnabled, t, FeatureFlag } from '@superset-ui/core';\n\nimport { PluginContext } from 'src/components/DynamicPlugins';\nimport Loading from 'src/components/Loading';\nimport getChartIdsFromLayout from '../util/getChartIdsFromLayout';\nimport getLayoutComponentFromChartId from '../util/getLayoutComponentFromChartId';\nimport DashboardBuilder from './DashboardBuilder/DashboardBuilder';\nimport {\n  chartPropShape,\n  slicePropShape,\n  dashboardInfoPropShape,\n  dashboardStatePropShape,\n} from '../util/propShapes';\nimport {\n  LOG_ACTIONS_HIDE_BROWSER_TAB,\n  LOG_ACTIONS_MOUNT_DASHBOARD,\n  Logger,\n} from '../../logger/LogUtils';\nimport { areObjectsEqual } from '../../reduxUtils';\n\nimport '../stylesheets/index.less';\nimport getLocationHash from '../util/getLocationHash';\nimport isDashboardEmpty from '../util/isDashboardEmpty';\nimport { getAffectedOwnDataCharts } from '../util/charts/getOwnDataCharts';\n\nconst propTypes = {\n  actions: PropTypes.shape({\n    addSliceToDashboard: PropTypes.func.isRequired,\n    removeSliceFromDashboard: PropTypes.func.isRequired,\n    triggerQuery: PropTypes.func.isRequired,\n    logEvent: PropTypes.func.isRequired,\n    clearDataMaskState: PropTypes.func.isRequired,\n  }).isRequired,\n  dashboardInfo: dashboardInfoPropShape.isRequired,\n  dashboardState: dashboardStatePropShape.isRequired,\n  charts: PropTypes.objectOf(chartPropShape).isRequired,\n  slices: PropTypes.objectOf(slicePropShape).isRequired,\n  activeFilters: PropTypes.object.isRequired,\n  chartConfiguration: PropTypes.object.isRequired,\n  datasources: PropTypes.object.isRequired,\n  ownDataCharts: PropTypes.object.isRequired,\n  layout: PropTypes.object.isRequired,\n  impressionId: PropTypes.string.isRequired,\n  initMessages: PropTypes.array,\n  timeout: PropTypes.number,\n  userId: PropTypes.string,\n};\n\nconst defaultProps = {\n  initMessages: [],\n  timeout: 60,\n  userId: '',\n};\n\nclass Dashboard extends React.PureComponent {\n  static contextType = PluginContext;\n\n  static onBeforeUnload(hasChanged) {\n    if (hasChanged) {\n      window.addEventListener('beforeunload', Dashboard.unload);\n    } else {\n      window.removeEventListener('beforeunload', Dashboard.unload);\n    }\n  }\n\n  static unload() {\n    const message = t('You have unsaved changes.');\n    window.event.returnValue = message; // Gecko + IE\n    return message; // Gecko + Webkit, Safari, Chrome etc.\n  }\n\n  constructor(props) {\n    super(props);\n    this.appliedFilters = props.activeFilters ?? {};\n    this.appliedOwnDataCharts = props.ownDataCharts ?? {};\n    this.onVisibilityChange = this.onVisibilityChange.bind(this);\n  }\n\n  componentDidMount() {\n    const appContainer = document.getElementById('app');\n    const bootstrapData = appContainer?.getAttribute('data-bootstrap') || '{}';\n    const { dashboardState, layout } = this.props;\n    const eventData = {\n      is_soft_navigation: Logger.timeOriginOffset > 0,\n      is_edit_mode: dashboardState.editMode,\n      mount_duration: Logger.getTimestamp(),\n      is_empty: isDashboardEmpty(layout),\n      is_published: dashboardState.isPublished,\n      bootstrap_data_length: bootstrapData.length,\n    };\n    const directLinkComponentId = getLocationHash();\n    if (directLinkComponentId) {\n      eventData.target_id = directLinkComponentId;\n    }\n    this.props.actions.logEvent(LOG_ACTIONS_MOUNT_DASHBOARD, eventData);\n\n    // Handle browser tab visibility change\n    if (document.visibilityState === 'hidden') {\n      this.visibilityEventData = {\n        start_offset: Logger.getTimestamp(),\n        ts: new Date().getTime(),\n      };\n    }\n    window.addEventListener('visibilitychange', this.onVisibilityChange);\n    this.applyCharts();\n  }\n\n  componentDidUpdate() {\n    this.applyCharts();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const currentChartIds = getChartIdsFromLayout(this.props.layout);\n    const nextChartIds = getChartIdsFromLayout(nextProps.layout);\n\n    if (this.props.dashboardInfo.id !== nextProps.dashboardInfo.id) {\n      // single-page-app navigation check\n      return;\n    }\n\n    if (currentChartIds.length < nextChartIds.length) {\n      const newChartIds = nextChartIds.filter(\n        key => currentChartIds.indexOf(key) === -1,\n      );\n      newChartIds.forEach(newChartId =>\n        this.props.actions.addSliceToDashboard(\n          newChartId,\n          getLayoutComponentFromChartId(nextProps.layout, newChartId),\n        ),\n      );\n    } else if (currentChartIds.length > nextChartIds.length) {\n      // remove chart\n      const removedChartIds = currentChartIds.filter(\n        key => nextChartIds.indexOf(key) === -1,\n      );\n      removedChartIds.forEach(removedChartId =>\n        this.props.actions.removeSliceFromDashboard(removedChartId),\n      );\n    }\n  }\n\n  applyCharts() {\n    const { hasUnsavedChanges, editMode } = this.props.dashboardState;\n\n    const { appliedFilters, appliedOwnDataCharts } = this;\n    const { activeFilters, ownDataCharts, chartConfiguration } = this.props;\n    if (\n      isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS) &&\n      !chartConfiguration\n    ) {\n      // For a first loading we need to wait for cross filters charts data loaded to get all active filters\n      // for correct comparing  of filters to avoid unnecessary requests\n      return;\n    }\n\n    if (\n      !editMode &&\n      (!areObjectsEqual(appliedOwnDataCharts, ownDataCharts, {\n        ignoreUndefined: true,\n      }) ||\n        !areObjectsEqual(appliedFilters, activeFilters, {\n          ignoreUndefined: true,\n        }))\n    ) {\n      this.applyFilters();\n    }\n\n    if (hasUnsavedChanges) {\n      Dashboard.onBeforeUnload(true);\n    } else {\n      Dashboard.onBeforeUnload(false);\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('visibilitychange', this.onVisibilityChange);\n    this.props.actions.clearDataMaskState();\n  }\n\n  onVisibilityChange() {\n    if (document.visibilityState === 'hidden') {\n      // from visible to hidden\n      this.visibilityEventData = {\n        start_offset: Logger.getTimestamp(),\n        ts: new Date().getTime(),\n      };\n    } else if (document.visibilityState === 'visible') {\n      // from hidden to visible\n      const logStart = this.visibilityEventData.start_offset;\n      this.props.actions.logEvent(LOG_ACTIONS_HIDE_BROWSER_TAB, {\n        ...this.visibilityEventData,\n        duration: Logger.getTimestamp() - logStart,\n      });\n    }\n  }\n\n  // return charts in array\n  getAllCharts() {\n    return Object.values(this.props.charts);\n  }\n\n  applyFilters() {\n    const { appliedFilters } = this;\n    const { activeFilters, ownDataCharts } = this.props;\n\n    // refresh charts if a filter was removed, added, or changed\n    const currFilterKeys = Object.keys(activeFilters);\n    const appliedFilterKeys = Object.keys(appliedFilters);\n\n    const allKeys = new Set(currFilterKeys.concat(appliedFilterKeys));\n    const affectedChartIds = getAffectedOwnDataCharts(\n      ownDataCharts,\n      this.appliedOwnDataCharts,\n    );\n    [...allKeys].forEach(filterKey => {\n      if (\n        !currFilterKeys.includes(filterKey) &&\n        appliedFilterKeys.includes(filterKey)\n      ) {\n        // filterKey is removed?\n        affectedChartIds.push(...appliedFilters[filterKey].scope);\n      } else if (!appliedFilterKeys.includes(filterKey)) {\n        // filterKey is newly added?\n        affectedChartIds.push(...activeFilters[filterKey].scope);\n      } else {\n        // if filterKey changes value,\n        // update charts in its scope\n        if (\n          !areObjectsEqual(\n            appliedFilters[filterKey].values,\n            activeFilters[filterKey].values,\n            {\n              ignoreUndefined: true,\n            },\n          )\n        ) {\n          affectedChartIds.push(...activeFilters[filterKey].scope);\n        }\n\n        // if filterKey changes scope,\n        // update all charts in its scope\n        if (\n          !areObjectsEqual(\n            appliedFilters[filterKey].scope,\n            activeFilters[filterKey].scope,\n          )\n        ) {\n          const chartsInScope = (activeFilters[filterKey].scope || []).concat(\n            appliedFilters[filterKey].scope || [],\n          );\n          affectedChartIds.push(...chartsInScope);\n        }\n      }\n    });\n\n    // remove dup in affectedChartIds\n    this.refreshCharts([...new Set(affectedChartIds)]);\n    this.appliedFilters = activeFilters;\n    this.appliedOwnDataCharts = ownDataCharts;\n  }\n\n  refreshCharts(ids) {\n    ids.forEach(id => {\n      this.props.actions.triggerQuery(true, id);\n    });\n  }\n\n  render() {\n    if (this.context.loading) {\n      return <Loading />;\n    }\n    return (\n      <>\n        <DashboardBuilder />\n      </>\n    );\n  }\n}\n\nDashboard.propTypes = propTypes;\nDashboard.defaultProps = defaultProps;\n\nexport default Dashboard;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport { CHART_TYPE } from './componentTypes';\n\nexport default function getLayoutComponentFromChartId(layout, chartId) {\n  return Object.values(layout).find(\n    currentComponent =>\n      currentComponent &&\n      currentComponent.type === CHART_TYPE &&\n      currentComponent.meta &&\n      currentComponent.meta.chartId === chartId,\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { RootState } from 'src/dashboard/types';\nimport Dashboard from 'src/dashboard/components/Dashboard';\nimport {\n  addSliceToDashboard,\n  removeSliceFromDashboard,\n} from 'src/dashboard/actions/dashboardState';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\n\nimport { triggerQuery } from 'src/components/Chart/chartAction';\nimport { logEvent } from 'src/logger/actions';\nimport { getActiveFilters } from 'src/dashboard/util/activeDashboardFilters';\nimport {\n  getAllActiveFilters,\n  getRelevantDataMask,\n} from 'src/dashboard/util/activeAllDashboardFilters';\nimport { clearDataMaskState } from '../../dataMask/actions';\n\nfunction mapStateToProps(state: RootState) {\n  const {\n    datasources,\n    sliceEntities,\n    charts,\n    dataMask,\n    dashboardInfo,\n    dashboardState,\n    dashboardLayout,\n    impressionId,\n    nativeFilters,\n  } = state;\n\n  return {\n    initMessages: dashboardInfo.common?.flash_messages,\n    timeout: dashboardInfo.common?.conf?.SUPERSET_WEBSERVER_TIMEOUT,\n    userId: dashboardInfo.userId,\n    dashboardInfo,\n    dashboardState,\n    charts,\n    datasources,\n    // filters prop: a map structure for all the active filter_box's values and scope in this dashboard,\n    // for each filter field. map key is [chartId_column]\n    // When dashboard is first loaded into browser,\n    // its value is from preselect_filters that dashboard owner saved in dashboard's meta data\n    // When user start interacting with dashboard, it will be user picked values from all filter_box\n    activeFilters: {\n      ...getActiveFilters(),\n      ...getAllActiveFilters({\n        // eslint-disable-next-line camelcase\n        chartConfiguration: dashboardInfo.metadata?.chart_configuration,\n        nativeFilters: nativeFilters.filters,\n        dataMask,\n        layout: dashboardLayout.present,\n      }),\n    },\n    chartConfiguration: dashboardInfo.metadata?.chart_configuration,\n    ownDataCharts: getRelevantDataMask(dataMask, 'ownState'),\n    slices: sliceEntities.slices,\n    layout: dashboardLayout.present,\n    impressionId,\n  };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        setDatasources,\n        clearDataMaskState,\n        addSliceToDashboard,\n        removeSliceFromDashboard,\n        triggerQuery,\n        logEvent,\n      },\n      dispatch,\n    ),\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\n","import n,{freeze as r}from\"immer\";import{useState as t,useCallback as o,useMemo as f,useReducer as u}from\"react\";function i(f){var u=t(function(){return r(\"function\"==typeof f?f():f,!0)}),i=u[1];return[u[0],o(function(t){i(\"function\"==typeof t?n(t):r(t))},[])]}function e(r,t,o){var i=f(function(){return n(r)},[r]);return u(i,t,o)}export{i as useImmer,e as useImmerReducer};\n//# sourceMappingURL=use-immer.module.js.map\n"],"names":["module","exports","__esModule","$Object","it","key","getOwnPropertyDescriptor","toIObject","$getOwnPropertyDescriptor","_default","window","document","createElement","_interopRequireDefault","recalc","size","_inDOM","default","scrollDiv","style","position","top","width","height","overflow","body","appendChild","offsetWidth","clientWidth","removeChild","arrayMap","baseGet","baseIteratee","baseMap","baseSortBy","baseUnary","compareMultiple","identity","isArray","collection","iteratees","orders","length","iteratee","value","index","result","object","other","array","comparer","sort","isSymbol","valIsDefined","undefined","valIsNull","valIsReflexive","valIsSymbol","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","compareAscending","objCriteria","criteria","othCriteria","ordersLength","baseFlatten","map","baseIsEqual","customizer","baseOrderBy","baseRest","isIterateeCall","sortBy","baseUniq","comparator","getNanoSeconds","hrtime","loadTime","moduleLoadTime","nodeLoadTime","upTime","performance","now","process","hr","uptime","Date","getTime","call","this","root","g","vendors","suffix","raf","caf","i","last","id","queue","callback","_now","next","Math","max","setTimeout","cp","slice","cancelled","e","round","push","handle","fn","cancel","apply","arguments","polyfill","requestAnimationFrame","cancelAnimationFrame","t","n","r","o","l","m","c","d","Object","defineProperty","enumerable","get","Symbol","toStringTag","create","bind","prototype","hasOwnProperty","p","s","self","a","Function","clear","set","delete","has","__data__","Array","join","toString","u","f","h","b","y","v","x","nodeType","Buffer","isBuffer","webpackPolyfill","deprecate","paths","children","isTypedArray","crypto","msCrypto","getRandomValues","Uint8Array","k","_","O","j","w","C","E","P","N","splice","pop","RegExp","replace","test","exec","keys","IE_PROTO","hash","string","add","valueOf","byteLength","byteOffset","buffer","name","message","forEach","constructor","propertyIsEnumerable","getOwnPropertySymbols","String","require","types","binding","ArrayBuffer","resolve","Error","isRequired","bool","func","number","symbol","any","arrayOf","element","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","iterator","assign","configurable","writable","ReferenceError","setPrototypeOf","getPrototypeOf","__proto__","TypeError","PureComponent","props","title","indexOf","type","flatNodes","concat","filter","disabled","noCascade","nodeHasChildren","label","parent","isParent","isLeaf","showCheckbox","getDisabledState","treeDepth","flattenNodes","Boolean","expanded","toggleNode","toggleChecked","S","A","T","R","updateDeterminateProperty","indeterminate","checkbox","ref","I","L","check","uncheck","halfCheck","expandClose","expandOpen","expandAll","collapseAll","parentClose","parentOpen","leaf","z","toggle","q","D","M","B","F","U","H","onCheck","onClick","onExpand","Component","checked","getCheckState","expandOnClick","optimisticToggle","expandDisabled","lang","className","renderCollapseIcon","icons","icon","onKeyPress","role","tabIndex","treeId","split","htmlFor","onChange","renderCheckboxIcon","showNodeIcon","renderNodeIcon","renderCheckboxLabel","renderBareLabel","renderCollapseButton","renderLabel","renderChildren","V","$","W","J","K","G","Y","te","Q","X","Z","ee","ne","nodes","deserializeLists","state","model","prevProps","onNodeClick","onExpandAll","onCollapseAll","setProps","clone","getNode","serializeList","expandAllNodes","isEveryChildChecked","isSomeChildChecked","every","checkState","some","onlyLeafCheckboxes","showNodeTitle","defaultProps","renderTreeNodes","determineShallowCheckState","showExpandAll","nameAsArray","renderArrayHiddenInput","renderJoinedHiddenInput","nativeCheckboxes","renderExpandAll","renderHiddenInput","_typeof","obj","isFunction","input","noop","isPlainObject","isObjectLike","proto","getDecoratedComponent","instanceRef","currentRef","current","decoratedRef","isRefable","render","_item$$$typeof","item","$$typeof","isRefForwardingComponent","_classCallCheck","instance","Constructor","_defineProperties","target","descriptor","_createClass","protoProps","staticProps","Disposable","action","isDisposed","dispose","isDisposable","empty","CompositeDisposable","_len","disposables","_key","shouldDispose","idx","len","currentDisposables","_i","_i2","SerialDisposable","old","_arrayLikeToArray","arr","arr2","_setPrototypeOf","_possibleConstructorReturn","_assertThisInitialized","_getPrototypeOf","decorateHandler","_ref","DecoratedComponent","createHandler","createMonitor","createConnector","registerHandler","containerDisplayName","getType","collect","_options$arePropsEqua","options","arePropsEqual","Decorated","displayName","DragDropContainer","_React$Component","subClass","superClass","_inherits","Derived","hasNativeReflectConstruct","_super","Reflect","construct","sham","Proxy","_isNativeReflectConstruct","Super","NewTarget","_this","handleChange","nextState","getCurrentState","setState","disposable","receiveProps","handlerId","nextProps","currentType","handler","receiveType","handlerMonitor","manager","handlerConnector","_registerHandler2","_arrayWithHoles","_arr","_n","_d","_e","_s","done","err","_iterableToArrayLimit","minLen","from","_unsupportedIterableToArray","_nonIterableRest","unregister","receiveHandlerId","unsubscribe","getMonitor","subscribeToStateChange","handlerIds","setDisposable","hooks","_this2","DndContext","_ref2","dragDropManager","receiveDragDropManager","_this2$handlerConnect","reconnect","getBackend","isValidType","allowArray","ALLOWED_SPEC_METHODS","REQUIRED_SPEC_METHODS","SourceImpl","spec","monitor","beginDrag","canDrag","globalMonitor","sourceId","isDragging","getSourceId","endDrag","createSourceFactory","DragSource","createSource","backend","SourceConnector","DragSourceMonitorImpl","TargetImpl","canDrop","hover","drop","createTargetFactory","DropTarget","createTarget","DropTargetMonitorImpl","TargetConnector","DragLayer","DragLayerContainer","isCurrentlyMounted","unsubscribeFromOffsetChange","unsubscribeFromStateChange","subscribeToOffsetChange","componentWillMount","getDerivedStateFromProps","componentWillReceiveProps","prevState","componentWillUpdate","__reactInternalSnapshotFlag","__reactInternalSnapshot","getSnapshotBeforeUpdate","isReactComponent","foundWillMountName","foundWillReceivePropsName","foundWillUpdateName","UNSAFE_componentWillMount","UNSAFE_componentWillReceiveProps","UNSAFE_componentWillUpdate","componentName","newApiName","componentDidUpdate","maybeSnapshot","snapshot","__suppressDeprecationWarning","defineProperties","_react","_react2","_propTypes2","_util","Search","_Component","searchTerm","updateSearch","_props","inputClassName","caseSensitive","sortResults","throttle","filterKeys","fuzzy","inputProps","_objectWithoutProperties","placeholder","_throttleTimeout","clearTimeout","_props2","createFilter","propTypes","getValuesForKey","searchStrings","term","toLowerCase","terms","currentKeys","searchedField","_fuse2","flatten","reduce","flat","toFlatten","results","tmp","parseInt","isNaN","res","toArray","strings","exactMatch","toJS","fuse","shouldSort","search","deepValue","location","distance","threshold","maxPatternLength","tokenSeparator","findAllMatches","minMatchCharLength","getFn","sortFn","score","tokenize","matchAllTokens","includeMatches","includeScore","verbose","isCaseSensitive","setCollection","_processKeys","list","_keyWeights","_keyNames","weight","min","limit","_log","_prepareSearchers","tokenSearchers","fullSearcher","_search","_computeScore","_sort","_format","_analyze","record","resultMap","arrayIndex","pattern","isMatch","matchedIndices","output","Number","EPSILON","pow","JSON","stringify","matches","indices","console","log","patternAlphabet","match","errors","currentLocation","expectedLocation","lastIndexOf","floor","charAt","abs","isString","isNum","_extends","source","_raf2","Container","_PureComponent","_temp","args","events","subscribers","rafHandle","subscribe","notifySubscribers","evt","framePending","currentTarget","_this$node$getBoundin","getBoundingClientRect","bottom","distanceFromTop","distanceFromBottom","eventSource","getParent","event","addEventListener","_this3","removeEventListener","_this4","onScroll","onTouchStart","onTouchMove","onTouchEnd","childContextTypes","_reactDom2","Sticky","isSticky","wasSticky","handleContainerEvent","context","preventingStickyStateChanges","relative","scrollTop","offsetTop","placeholderClientRect","calculatedHeight","content","bottomDifference","bottomOffset","topOffset","scrollHeight","offsetParent","left","disableHardwareAcceleration","transform","paddingBottom","disableCompensation","cloneElement","findDOMNode","contextTypes","_Sticky2","_Container2","initialRecords","records","UiOverrideRegistry","getUiOverrideRegistry","StyledCertifiedBadge","EditableTitle","canEdit","editing","extraClasses","multiLine","noPermitTooltip","onSaveTitle","showTooltip","defaultTitle","certifiedBy","certificationDetails","onClickTitle","rest","isEditing","setIsEditing","useState","currentTitle","setCurrentTitle","lastTitle","setLastTitle","contentBoundingRect","setContentBoundingRect","contentRef","useRef","handleClick","contentBounding","handleBlur","formattedTitle","trim","handleKeyDown","stopPropagation","preventDefault","ev","handleKeyPress","useEffect","focus","setSelectionRange","scrollLeft","scrollWidth","editStyle","titleComponent","onKeyDown","onBlur","css","details","getChartIdsFromLayout","layout","values","chartIds","currentComponent","CHART_TYPE","meta","chartId","_defineProperty","ParentSize","resize","debounceTime","animationFrameID","_proto","componentDidMount","resizeObserver","entries","entry","_entry$contentRect","contentRect","observe","componentWillUnmount","disconnect","_this$props","parentSizeStyles","restProps","excluded","sourceKeys","_objectWithoutPropertiesLoose","setTarget","List","_React$PureComponent","_ret","_cellRenderer","rowIndex","isScrolling","isVisible","rowRenderer","_setRef","Grid","_onScroll","_ref3","clientHeight","_onSectionRendered","_ref4","rowOverscanStartIndex","rowOverscanStopIndex","rowStartIndex","rowStopIndex","onRowsRendered","overscanStartIndex","overscanStopIndex","startIndex","stopIndex","forceUpdate","_ref5","alignment","getOffsetForCell","columnIndex","_ref6","invalidateCellSizeAfterRender","measureAllCells","_ref7","_ref7$columnIndex","_ref7$rowIndex","recomputeGridSize","scrollToPosition","scrollToCell","noRowsRenderer","scrollToIndex","classNames","autoContainerWidth","cellRenderer","columnWidth","columnCount","noContentRenderer","onSectionRendered","scrollToRow","autoHeight","estimatedRowSize","overscanIndicesGetter","accessibilityOverscanIndicesGetter","overscanRowCount","scrollToAlignment","datasourceUrl","datasourceName","innerRef","isSelected","lastModified","sliceName","visType","Styled","styled","theme","colors","grayscale","light2","gridUnit","light5","light4","typography","weights","bold","normal","base","sizes","AddSliceCard","cx","href","staticCardStyles","pointerEvents","zIndex","dragItem","slices","slicePropShape","currentOffset","AddSliceDragPreview","parentType","NEW_COMPONENT_SOURCE_TYPE","slice_name","changed_on_humanized","viz_type","datasource_url","datasource_name","getItem","getSourceClientOffset","emptyImage","depthOne","depthThree","depthFour","depthFive","parentMaxDepthLookup","isValidChild","child","childType","parentDepth","maxParentDepth","DROP_TOP","DROP_RIGHT","DROP_BOTTOM","DROP_LEFT","scrollTopDashboardInterval","CACHED_CLIENT_OFFSET","getDropPosition","depth","componentDepth","parentComponent","component","orientation","isDraggingOverShallow","draggingItem","validChild","validSibling","TAB_TYPE","TABS_TYPE","hasChildren","childDropOrientation","siblingDropOrientation","refBoundingRect","clientOffset","getClientOffset","deltaTop","deltaBottom","deltaLeft","deltaRight","right","delta","refMiddleX","refMiddleY","mounted","dropPosition","scroll","setupScroll","documentElement","clearScroll","setInterval","clearInterval","behavior","handleScroll","DASHBOARD_ROOT_TYPE","dropIndicator","TYPE","dragConfig","disableDragDrop","parentId","connect","dragSourceRef","dragSource","dragPreviewRef","dragPreview","dropConfig","handleHover","dropResult","getDropResult","destination","componentIndex","onDrop","dropAsChildOrSibling","dragging","nextIndex","handleDrop","droppableRef","dropTarget","isDraggingOver","isOver","shallow","componentShape","editMode","useEmptyDragPreview","UnwrappedDragDroppable","React","super","setRef","Image","src","captureDraggingState","dropIndicatorProps","childProps","fetchAllSlices","isLoading","lastUpdated","errorMessage","userId","selectedSliceIds","filterboxMigrationState","FILTER_BOX_MIGRATION_STATES","dashboardId","innerHeight","KEYS_TO_FILTERS","KEYS_TO_SORT","changed_on","Controls","StyledSelect","Select","NewChartButtonContainer","NewChartButton","Button","SliceAdder","attr","desc","filteredSlices","selectedSliceIdsSet","Set","searchUpdated","handleSelect","slicesRequest","isFeatureEnabled","FeatureFlag","sortByComparator","abort","getFilteredSortedSlices","cellData","slice_id","NEW_CHART_ID","DragDroppable","NEW_COMPONENTS_SOURCE_ID","slicesListHeight","buttonStyle","buttonSize","open","Icons","Input","Loading","rowCount","rowHeight","sliceEntities","dashboardInfo","dashboardState","ownProps","sliceIds","dispatch","bindActionCreators","registryGetAll","registryKeys","registry","registryDelete","keyToDelete","registryGet","initComponents","metadata","loadComponent","registrySetComponent","getAll","DraggableNewComponent","DraggableNewColumn","NEW_COLUMN_ID","COLUMN_TYPE","DraggableNewDivider","NEW_DIVIDER_ID","DIVIDER_TYPE","DraggableNewHeader","NEW_HEADER_ID","HEADER_TYPE","DraggableNewRow","NEW_ROW_ID","ROW_TYPE","DraggableNewTabs","NEW_TABS_ID","NEW_MARKDOWN_ID","MARKDOWN_TYPE","componentKey","iconName","BuilderComponentPaneTabs","DashboardBuilderSidepane","isStandalone","Infinity","pageYOffset","hasHeader","withHeaderTopOffset","tab","NewDynamicComponent","copyMenuItemTitle","emailMenuItemTitle","emailSubject","emailBody","addDangerToast","addSuccessToast","dashboardComponentId","async","generateUrl","nativeFiltersKey","filterState","Menu","selectable","copy","error","logging","encodedBody","encodeURIComponent","encodedSubject","StyledWrapper","light1","initialCss","triggerNode","templates","CssEditor","changeCss","changeCssTemplate","AceCssEditor","renderTemplateSelector","menu","template","overlay","placement","ModalTrigger","modalTitle","modalBody","minLines","maxLines","editorProps","$blockScrolling","enableLiveAutocompletion","StyledModalTrigger","RefreshWarningContainer","RefreshIntervalModal","modalRef","refreshFrequency","handleFrequencyChange","onSave","onCancel","close","refreshIntervalOptions","refreshLimit","refreshWarning","showRefreshWarning","Form","ariaLabel","option","sortComparator","Alert","modalFooter","saveType","colorNamespace","colorScheme","shouldPersistRefreshFrequency","SaveModal","modal","newDashName","dashboardTitle","duplicateSlices","handleSaveTypeChange","handleNameChange","saveDashboard","setModalRef","toggleDuplicateSlices","positions","customCss","currentRefreshFrequency","lastModifiedTime","refresh_frequency","data","certified_by","certification_details","dashboard_title","duplicate_slices","last_modified_time","owners","roles","then","resp","json","Radio","canOverwrite","onFocus","Checkbox","FILTER_SCOPE_CONTAINER_TYPES","traverse","currentNode","components","filterFields","selectedChartId","chartNode","filterField","childNodeTree","includes","text","getFilterScopeNodesTree","DASHBOARD_ROOT_ID","getFilterScopeParentNodes","depthLimit","parentNodes","getKeyForFilterScopeTree","activeFilterField","checkedFilterFields","safeStringify","getSelectedChartIdForFilterScopeTree","getChartIdAndColumnFromFilterKey","filterKey","buildFilterScopeTreeEntry","filterScopeMap","editingList","checkedChartIdSet","nodesFiltered","getTabChildrenScope","tabScopes","parentNodeValue","forceAggregate","hasChartSiblings","tabChildren","immuneChartSiblings","scope","immuneChartIdsFromTabsNotInScope","tabs","tabsInScope","chartsNotInScope","subTab","subTabChildren","getImmuneChartIdsFromTabsNotInScope","immuneChartIdsFromTabsInScope","immune","componentsInScope","filterId","checkedChartIds","currentValue","chartChildren","chartsImmune","getFilterScopeFromNodesTree","ChartIcon","primary","updatedChildren","renderFilterScopeTreeNodes","filterScopeSelectorTreeNodePropShape","NOOP","FilterScopeTree","treeIcons","FilterFieldItem","renderFilterFieldTreeNodes","activeKey","FilterFieldTree","dashboardFilters","dashboardFilterPropShape","updateDashboardFiltersScope","setUnsavedChanges","onCloseModal","ActionsContainer","light3","FilterScopeSelector","filterFieldNodes","allFilters","dashboardFilter","filterName","columns","labels","column","getDashboardFilterKey","ALL_FILTERS_ROOT","getFilterFieldNodesTree","filtersNodes","allfilterFields","defaultFilterKey","mapByChartId","columnName","chartIdsInFilterScope","getChartIdsInFilterBoxScope","filterScope","scopes","expandedFilterIds","filterScopeTreeEntry","showSelector","searchText","filterNodes","onChangeFilterField","onCheckFilterScope","onExpandFilterScope","onSearchInputChange","onCheckFilterField","onExpandFilterField","onClose","updatedEntry","updatedFilterScopeMap","checkedChartIdsByFilterField","updatedCheckedIds","getRevertedFilterScope","nextActiveFilterField","currentActiveFilterField","filterTree","allFilterFieldScopes","updater","filtered","toLocaleLowerCase","renderFilterFieldList","renderFilterScopeTree","renderEditingFiltersName","currentFilterLabels","dashboardLayout","present","FilterScopeModalBody","padding","FilterScopeModal","handleCloseModal","filterScopeProps","FilterScope","getDashboardUrl","pathname","filters","standalone","newSearchParams","URLSearchParams","serializeActiveFilterValues","dataMaskKey","hashSection","dataMask","updateCss","forceRefreshAllCharts","setRefreshFrequency","startPeriodicRender","userCanEdit","userCanShare","userCanSave","userCanCurate","expandedSlices","showPropertiesModal","manageEmbedded","MENU_KEYS","HeaderActionsDropdown","reload","cssTemplates","showReportSubMenu","changeRefreshInterval","handleMenuClick","setShowReportSubMenu","SupersetClient","endpoint","row","template_name","catch","injectCustomCss","show","refreshInterval","isPersistent","domEvent","querySelector","visibility","downloadAsImage","url","getActiveFilters","getUrlParam","URL_PARAMS","setIsDropdownVisible","isDropdownVisible","common","conf","DASHBOARD_AUTO_REFRESH_INTERVALS","SAVE_TYPE_NEWDASHBOARD","HeaderReportDropdown","useTextMenu","isPublished","savePublished","canSave","draftButtonTooltip","draftDivTooltip","publishedTooltip","PublishedStatus","togglePublished","Tooltip","Label","onUndo","onRedo","UndoRedoKeyListeners","handleKeydown","ctrlKey","metaKey","isZChar","keyCode","isYChar","isEditingMarkdown","isEditingTitle","stopPeriodicRender","refreshTimer","uiOverrideRegistry","stringToList","stringyList","ButtonRow","DashboardEmbedControls","onHide","addInfoToast","ready","setReady","loading","setLoading","embedded","setEmbedded","allowedDomains","setAllowedDomains","isDirty","allowed_domains","enableEmbedded","useCallback","makeApi","method","finally","disableEmbedded","Modal","okType","onOk","status","docsDescription","docsUrl","uuid","rel","InfoTooltipWithTrigger","tooltip","DashboardEmbedModal","hideFooter","addWarningToast","user","UserWithPermissionsAndRoles","charts","chartPropShape","setColorSchemeAndUnsavedChanges","isStarred","fetchFaveStar","fetchCharts","saveFaveStar","updateDashboardTitle","setEditMode","showBuilderPane","logEvent","hasUnsavedChanges","maxUndoHistoryExceeded","onRefresh","undoLength","redoLength","setMaxUndoHistoryExceeded","maxUndoHistoryToast","dashboardInfoChanged","dashboardTitleChanged","headerContainerStyle","editButtonStyle","dark2","actionButtonsStyle","StyledUndoRedoButton","AntdButton","undoRedoStyle","undoRedoEmphasized","undoRedoDisabled","saveBtnStyle","discardBtnStyle","Header","URL","searchParams","showEmbedModal","showingEmbedModal","hideEmbedModal","didNotifyMaxUndoHistoryToast","emphasizeUndo","emphasizeRedo","showingPropertiesModal","handleChangeText","handleCtrlZ","handleCtrlY","toggleEditMode","forceRefresh","overwriteDashboard","hidePropertiesModal","UNDO_LIMIT","ctrlYTimeout","ctrlZTimeout","nextText","visible","chartList","LOG_ACTIONS_FORCE_REFRESH_DASHBOARD","force","interval","chartCount","intervalMessage","predefinedValue","find","moment","humanize","periodicRender","setPeriodicRunner","timed_refresh_immune_slices","affectedCharts","chart","LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD","DASHBOARD_AUTO_REFRESH_MODE","LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD","edit_mode","slug","currentColorScheme","color_scheme","currentColorNamespace","color_namespace","currentSharedLabelColors","getSharedLabelColor","getColorMap","shared_label_colors","positionJSONLength","SUPERSET_DASHBOARD_POSITION_DATA_LIMIT","DASHBOARD_POSITION_DATA_LIMIT","SAVE_TYPE_OVERWRITE","dash_edit_perm","is_managed_externally","dash_share_perm","userCanSaveAs","dash_save_perm","findPermission","SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT","SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE","PageHeaderWithActions","editableTitleProps","certificatiedBadgeProps","faveStarProps","itemId","titlePanelAdditionalItems","rightPanelAdditionalItems","iconSize","discardChanges","menuDropdownProps","getPopupContainer","closest","onVisibleChange","additionalActionsMenu","showFaveStar","showTitlePanelItems","PropertiesModal","onSubmit","updates","parse","jsonMetadata","onlyApply","styles","isDashboardLoading","chartUpdateStartTime","chartUpdateEndTime","undoableLayout","reports","past","future","DASHBOARD_HEADER_ID","undoLayoutAction","redoLayoutAction","saveDashboardRequest","updateDataMask","fetchUISpecificReport","DashboardHeader","StyledDiv","StyledSpan","getEffectiveExtraFilters","col","op","val","findAffectedCharts","activeFilters","extraFormData","getRelevantDataMask","prop","prev","getAllActiveFilters","chartConfiguration","nativeFilters","crossFilters","rootPath","layoutItemId","cachedFiltersByChart","cachedFormdataByChart","ScopingType","isShowTypeInTree","formData","buildTree","treeItem","validNodes","initiallyExcludedCharts","buildTreeLeafTitle","itemToPass","sliceNameOverride","defaultText","currentTreeItem","checkTreeItem","checkedItems","items","parents","addInvisibleParents","getDefaultScopeValue","isScopingAll","hasTooltip","tooltipTitle","formScope","initialScope","updateFormValues","expandedKeys","setExpandedKeys","treeData","currentChartId","tree","useMemo","acc","cur","useFilterScopeTree","autoExpandParent","setAutoExpandParent","checkedKeys","getTreeCheckedItems","checkable","checkedItemParents","p1","p2","isExcluded","findFilterScope","Wrapper","CleanFormItem","pathToFormValue","formScopingType","formFilterScope","initialFilterScope","initialScopingType","hasScopeBeenModified","setHasScopeBeenModified","onUpdateFormValues","formValues","updateScopes","newScope","scoping","useComponentDidUpdate","initialValue","all","specific","hidden","FILTERS_FIELD_NAME","FILTER_SUPPORTED_TYPES","filter_time","filter_timegrain","filter_timecolumn","filter_select","filter_range","useForceUpdate","updateState","setNativeFilterFieldValues","form","formFilters","getFieldValue","setFields","datasetToSelectOption","table_name","hasTemporalColumns","dataset","columnTypes","ensureIsArray","column_types","doesColumnMatchFilterType","filterType","type_generic","formScoping","setFieldsValue","setCrossFilterFieldValues","defaultFilterConfiguration","useFilterConfiguration","native_filter_configuration","useDashboardLayout","useDashboardHasTabs","FILTER_TYPE","DragIcon","shouldForwardProp","propName","onRearrange","filterIds","drag","useDrag","useDrop","accept","dragIndex","hoverIndex","hoverBoundingRect","hoverMiddleY","hoverClientY","alt","viewBox","FilterTitle","borderRadius","dark1","secondary","StyledTrashIcon","StyledWarning","forwardRef","getFilterTitle","onRemove","restoreFilter","currentFilterId","removedFilters","erroredFilters","isRemoved","isErrored","isActive","renderComponent","renderFilterGroups","StyledAddBox","TabsContainer","onAdd","filtersContainerRef","mode","handleOnAdd","getElementById","navList","getElementsByClassName","arrow","trigger","overflowY","marginLeft","ContentHolder","TitlesContainer","active","display","StyledContainer","level","StyledContent","StyledTitle","BasicErrorAlert","iconColor","cacheWrapper","cache","keyFn","ChildrenContainer","CollapsibleControl","isChecked","setIsChecked","localCache","Map","cachedSupersetGet","ColumnSelect","allowClear","filterValues","formField","datasetId","setColumns","resetColumnField","touched","column_name","currentFilterType","currentColumn","useChangeEffect","previous","lookupValue","badResponse","getClientErrorObject","errorText","notFoundContent","showSearch","DatasetSelect","getErrorMessage","page","pageSize","searchColumn","query","opr","page_size","order_column","order_direction","response","totalCount","count","hasDefaultValue","hasDataset","setDataMask","enableNoResults","formFilter","queriesData","defaultValueQueriesData","defaultDataMask","isMissingRequiredValue","SuperChart","appSection","behaviors","chartType","validateMessage","validateStatus","RemovedContent","MainPanel","AddFilter","DeleteFilter","RowPanel","Row","availableFilters","selection","onDelete","labelInValue","dependencies","onDependenciesChange","rows","setRows","updateRows","newRows","findIndex","availableFilter","getDependencySuggestion","hasAvailableFilters","hasDependencies","newDependencies","TabPane","StyledRowContainer","controlsOrder","StyledFormItem","StyledRowFormItem","StyledRowSubFormItem","StyledLabel","DefaultValueContainer","RefreshIcon","StyledCollapse","Collapse","StyledTabs","StyledAsterisk","FilterTabs","configuration","FilterPanels","settings","FILTERS_WITH_ADHOC_FILTERS","FILTER_TYPE_NAME_MAPPING","FiltersConfigForm","filterToEdit","getAvailableFilters","activeFilterPanelKeys","handleActiveFilterPanelChange","setErroredFilters","validateDependencies","setError","metrics","setMetrics","activeTabKey","setActiveTabKey","undoFormValues","setUndoFormValues","datasetDetails","setDatasetDetails","defaultFormFilter","cascadeParentIds","nativeFilterItems","nativeFilterVizTypes","loadedDatasets","datasources","doLoadedDatasetsHaveTemporalColumns","showTimeRangePicker","currentDataset","datasourceCount","targets","datasets","mostUsedDataset","maxCount","datasource","controlItems","mainControlItems","removed","controlConfig","controlPanelSections","controlSetRows","getControlItems","mapControlItems","mapMainControlItems","mainControlItem","controlValues","config","initColumn","requiredFirst","rules","required","multiple","controlItem","renderTrigger","affectsDataMask","valuePropName","colon","resetConfig","description","getControlItemsMap","hasColumn","groupby","hasMetrics","hasFilledDataset","hasAdditionalFilters","canDependOnOtherFilters","isDataDirty","setNativeFilterFieldValuesWrapper","dependenciesDefaultValues","dependency","dependenciesText","refreshHandler","extra_form_data","getChartDataRequest","requestParams","asyncResult","setErrorWrapper","statusText","newFormData","defaultValueTooltip","setHasDefaultValue","enableEmptyFilter","defaultToFirstItem","setHasPartialDefaultValue","setIsRequired","setDefaultValueTooltip","useDefaultValue","showDataset","formChanged","hasPreFilter","adhoc_filters","time_range","hasEnableSingleValue","enableSingleValue","enableSingleMaxValue","hasSorting","sortAscending","showDefaultValue","onSortChanged","onEnableSingleValueChanged","validatePreFilter","validateFields","hasTimeRange","hasAdhoc","initialDefaultValue","preFilterValidator","Promise","reject","datasource_type","useImperativeHandle","changeTab","useBackendFormUpdate","chartDatasetUid","centered","forceRender","getFiltersConfigModalTestId","mappedName","isDisabled","customLabel","expandIconPosition","header","validator","AdhocFilterControl","filterable","savedMetrics","DateFilterControl","timeRange","granularity_sqla","is_dttm","sortMetric","metric","metric_name","verbose_name","SingleValueType","formValidationFields","getFieldsError","prevErroredFilters","CancelConfirmationAlert","onConfirm","onDismiss","closable","handleSave","onConfirmCancel","saveAlertVisible","componentId","divider","whitespace","StyledModalWrapper","StyledModalBody","StyledForm","ALLOW_DEPENDENCIES","FiltersConfigModal","isOpen","initialFilterId","createNewOnOpen","configFormRef","filterConfig","filterConfigMap","useFilterConfigMap","newFilterIds","setNewFilterIds","setRemovedFilters","setSaveAlertVisible","isPending","initialCurrentFilterId","setCurrentFilterId","setFormValues","unsavedFiltersIds","removal","timerId","getInitialFilterOrder","orderedFilters","setOrderedFilters","getActiveFilterPanelKey","activeFilterPanelKey","setActiveFilterPanelKey","addFilter","newFilterId","wasOpen","usePrevious","useOpenModal","currentFilterRemoved","nextFilterId","useRemoveCurrentFilter","handleRemoveItem","resetForm","isSaving","resetFields","changed","formValue","canBeUsedAsDependency","handleErroredFilters","erroredFiltersIds","field","cleanDeletedParents","handleConfirmCancel","handleCancel","initialOrder","didChangeOrder","isFieldsTouched","buildDependencyMap","dependencyMap","formItem","configItem","possibleDependencies","found","onValuesChange","changes","didChangeFilterName","didChangeSectionTitle","maskClosable","destroyOnClose","footer","ErrorBoundary","targetIndex","newOrderedFilter","startsWith","getForm","chartConfig","chart_configuration","preserve","VerticalDotsContainer","RefreshTooltip","VerticalDotsTrigger","dropdownIconsStyles","SliceHeaderControls","toggleControls","refreshChart","showControls","showCrossFilterScopingModal","updatedDttm","toggleExpandSlice","logExploreChart","exportCSV","handleToggleFullSize","exportFullCSV","isFullSize","cachedDttm","supersetCanShare","isCached","crossFilterItems","isTable","isCrossFilter","canEmitCrossFilter","form_data","emit_filter","cachedWhen","itemCachedDttm","fromNow","updatedWhen","refreshTooltipData","itemCached","refreshTooltip","fullscreenLabel","chartStatus","lineHeight","isDescriptionExpanded","supersetCanExplore","onExploreChart","ViewQueryModal","latestQueryFormData","draggable","resizable","responsive","queryFormData","queryForce","dataSize","isRequest","supersetCanCSV","fontSize","AntdIcon","Pill","alert","Title","color","ItemIcon","Item","Reset","Indent","Panel","FilterValue","FilterIndicatorText","APPLY_FILTERS_HINT","getFilterValueForDisplay","findExistingFilterSet","filterSetFilterValues","dataMaskSelected","dataMaskFromFilterSet","dataMaskSelectedEntries","filterFromSelectedFilters","isEqual","ignoreUndefined","ignoreNull","hasSamePropsNumber","indicator","path","resultValue","SearchOutlined","appliedCrossFilterIndicators","appliedIndicators","incompatibleIndicators","unsetIndicators","onHighlightFilterSource","setVisible","activeTabs","once","getDefaultActivePanel","activePanels","setActivePanels","indicatorKey","ghost","light","panels","fill","success","Popover","overlayClassName","IndicatorStatus","TIME_GRANULARITY_FIELDS","extractLabel","selectIndicatorValue","columnKey","arrValues","isDateFilter","timeGranularityMap","time_grain_sqla","granularity","getAppliedColumns","queriesResponse","applied_filters","getRejectedColumns","rejected_filters","cachedIndicatorsForChart","cachedDashboardFilterDataForChart","cachedNativeIndicatorsForChart","cachedNativeFilterDataForChart","defaultChartConfig","indicatorsInitialState","FiltersBadge","nativeIndicators","setNativeIndicators","dashboardIndicators","setDashboardIndicators","prevChart","prevChartStatus","prevDashboardFilters","prevDatasources","showIndicators","appliedColumns","rejectedColumns","matchingFilters","matchingDatasources","datasourceId","cachedFilterData","indicators","filterDataSource","getStatus","Applied","Incompatible","Unset","directPathToFilter","selectIndicatorsForChartFromFilter","localeCompare","selectIndicatorsForChart","prevNativeFilters","prevDashboardLayout","prevDataMask","prevChartConfig","hasValue","CrossFilterApplied","nativeFilterIndicators","nativeFilter","chartsInScope","crossFilterIndicators","dashboardLayoutValues","chartLayoutItem","layoutItem","elementId","filtersState","dashboardLayoutItem","selectNativeIndicatorsForChart","statuses","sortByStatus","ind1","ind2","isInactive","DetailsPanel","annotationsLoading","annotationsError","CrossFilterIcon","updateSliceName","annotationQuery","annotationError","isExpanded","sliceCanEdit","uiConfig","headerTooltip","setHeaderTooltip","headerRef","crossFilterValue","handleClickTitle","headerElement","offsetHeight","emptyText","hideChartControls","MissingChart","isComponentVisible","setControlValue","labelColors","sharedLabelColors","timeout","maxRows","changeFilter","setFocusedFilterField","unsetFocusedFilterField","ownState","postTransformProps","datasetsStatus","SHOULD_UPDATE_ON_PROP_CHANGES","OVERFLOWABLE_VIZ_TYPES","ChartOverlay","SliceContainer","Chart","LOG_ACTIONS_EXPLORE_DASHBOARD_CHART","is_cached","lastTabId","localStorage","nextTabId","postFormData","mountExploreUrl","descriptionHeight","handleFilterMenuOpen","handleFilterMenuClose","setDescriptionRef","setHeaderRef","getChartHeight","getDescriptionHeight","shouldComponentUpdate","triggerQuery","resizeTimeout","areObjectsEqual","cacheBusterProp","descriptionRef","headerHeight","getHeaderHeight","computedStyle","getComputedStyle","getPropertyValue","marginBottom","newSelectedValues","LOG_ACTIONS_CHANGE_DASHBOARD_FILTER","isFullCSV","LOG_ACTIONS_EXPORT_CSV_DASHBOARD_CHART","exportChart","row_limit","resultType","resultFormat","LOG_ACTIONS_FORCE_REFRESH_CHART","isDeactivatedViz","cached_dttm","isOverflowable","initialValues","isFilterBox","getFilterValuesByFilterId","description_markeddown","dangerouslySetInnerHTML","__html","ChartContainer","onFilterMenuOpen","onFilterMenuClose","annotationData","chartAlert","vizType","EMPTY_OBJECT","chartQueries","extraControls","PLACEHOLDER_DATASOURCE","label_colors","sliceId","cachedFormData","extraData","filterIdsAppliedOnChart","extra_filters","getFormDataWithExtraFilters","getAppliedFilterValues","SUPERSET_WEBSERVER_TIMEOUT","superset_can_explore","superset_can_share","superset_can_csv","slice_can_edit","SQL_MAX_ROW","updateComponents","URLShortLinkButton","anchorLinkId","emailContent","shortUrl","setShortUrl","emailLink","CopyToClipboard","copyNode","getCopyUrl","AnchorLink","scrollIntoView","showShortLinkButton","scrollAnchorIntoView","block","getLocationHash","HoverStyleOverrides","HoverMenu","bottomRight","adjustableWidthAndHeight","topRight","bottomLeft","topLeft","widthAndHeight","widthOnly","heightOnly","notAdjustable","proxyToInfinity","MAX_VALUE","adjustableWidth","adjustableHeight","gutterWidth","widthStep","heightStep","widthMultiple","heightMultiple","minWidthMultiple","maxWidthMultiple","minHeightMultiple","maxHeightMultiple","staticHeight","staticHeightMultiple","staticWidth","staticWidthMultiple","onResizeStop","onResize","onResizeStart","GRID_GUTTER_SIZE","GRID_BASE_UNIT","SNAP_TO_GRID","HANDLE_CLASSES","ResizableContainer","isResizing","handleResizeStart","handleResize","handleResizeStop","direction","nextWidthMultiple","nextHeightMultiple","enableConfig","resizableConfig","enable","grid","minWidth","minHeight","maxWidth","maxHeight","handleComponent","ResizableHandle","handleClasses","getComponentById","directPathToChild","directPathLastUpdated","focusedFilterScope","fullSizeChartId","availableColumnCount","deleteComponent","handleComponentDrop","setFullSizeChartId","postAddSliceFromDashboard","FilterFocusHighlight","otherProps","useTheme","useSelector","focusedFilterField","selectFocusedFilterScope","focusedNativeFilterId","focusedFilterId","focusedChartStyles","borderColor","opacity","boxShadow","ChartHolder","chartComponentId","currentPath","componentType","IN_COMPONENT_ELEMENT_TYPES","getChartAndLabelComponentIdFromPath","outlinedComponentId","outlinedColumnName","isFocused","handleChangeFocus","handleDeleteComponent","handleUpdateSliceName","handleExtraControl","handlePostTransformProps","hideOutline","timerKey","prevTimerKey","nextFocus","nextName","columnParentWidth","GRID_MIN_COLUMN_COUNT","chartWidth","chartHeight","innerWidth","GRID_MIN_ROW_UNITS","renderInFocusCSS","MenuItem","renderButton","renderOption","selected","opt","overlayStyle","marginTop","dropdownOptions","MarkdownModeDropdown","WithPopoverMenu","container","onChangeFocus","shouldFocus","shouldFocusFunc","disableClick","menuItems","contains","parentNode","MARKDOWN_PLACE_HOLDER","MARKDOWN_ERROR_MESSAGE","Markdown","markdownSource","code","editor","editorMode","renderStartTime","Logger","handleChangeEditorMode","handleMarkdownChange","setEditor","LOG_ACTIONS_RENDER_CHART","start_offset","ts","duration","hasError","nextComponent","nextUndoLength","nextRedoLength","MarkdownEditor","componentDidCatch","getSession","setUseWrapMode","nextFocused","nextEditMode","updateMarkdownContent","nextValue","renderEditMode","showGutter","readOnly","onLoad","renderPreviewMode","SafeMarkdown","DragHandleContainer","DragHandle","BackgroundStyleDropdown","backgroundStyleOptions","minColumnWidth","Column","handleChangeBackground","handleUpdateMeta","columnComponent","onChangeTab","columnItems","backgroundStyle","background","BACKGROUND_TRANSPARENT","itemIndex","Divider","handleChangeSize","headerStyle","headerStyleOptions","headerSize","SMALL_HEADER","rowStyle","occupiedColumnCount","rowComponent","rowItems","RENDER_TAB","RENDER_TAB_CONTENT","renderType","onDropOnTab","setDirectPathToChild","TabTitleContainer","isHighlighted","renderDraggableContentBottom","dropProps","renderDraggableContentTop","Tab","handleTopDropTargetDrop","handleChangeTab","pathToTabIndex","nextTabText","renderTabContent","tabComponent","tabParentComponent","shouldDisplayEmptyState","EmptyState","image","renderTab","findTabIndexByComponentId","currentComponentIdx","nextParentId","childId","getDirectPathToTabIndex","tabsComponent","getLeafComponentIdFromPath","renderHoverMenu","setActiveTabs","createComponent","StyledTabsContainer","Tabs","showDeleteConfirmModal","AntdModal","handleDeleteTab","okText","cancelText","handleEdit","NEW_TAB_ID","tabIds","handleClickTab","handleDropOnTab","maxIndex","currTabsIds","nextTabsIds","nextFocusComponent","currentFocusComponent","nextTabIndex","targetTabId","LOG_ACTIONS_SELECT_DASHBOARD_TAB","target_id","dropTabIndex","isCurrentTabVisible","selectedTabIndex","tabsToHighlight","tabsDropIndicatorProps","tabsDragSourceRef","onEdit","tabId","componentLookup","TabsConnected","DYNAMIC_TYPE","dashboardData","updateMeta","Suspense","fallback","DashboardComponent","occupiedWidth","minimumWidth","getDetailedComponentWidth","TabIds","getOnlyExtraFormData","checkIsMissingRequiredValue","useFilterSets","filterSets","useFilters","preselectedNativeFilters","preselectNativeFilters","preselect","useNativeFiltersDataMask","useFilterSetNameDuplicated","filterSetName","ignoreName","isFilterSetNameDuplicated","ActionButton","ActionButtons","onCreate","isCreateDisabled","htmlType","getFilterBarTestId","FilterHeader","StyledFilterRow","filterSet","resultFilters","defaultActiveKey","expandIcon","Icon","changedFilter","removedFilter","strong","mark","HeaderButton","TitleText","IconsBlock","setFilterSetName","isApplied","onRebuild","danger","editable","FilterSetsWrapper","FilterSetUnitWrapper","DEFAULT_FILTER_SET_NAME","onEditFilterSet","onFilterSelectionChange","dataMaskApplied","selectedFiltersSetId","setSelectedFiltersSetId","AllFilters","foundFilterSet","isFilterMissingOrContainsInvalidMetadata","takeFilterSet","localTarget","newFilterSet","handleDeleteFilterSet","filterSetId","newFilters","updatedFilterSet","handleRebuild","Warning","isDuplicateFilterSet","resultDisabled","setOpen","TitleArea","AddFiltersButtonContainer","toggleFiltersBar","extendStatics","__extends","__","ELEMENT_TYPE_HTML","ELEMENT_TYPE_SVG","createPortalNode","elementType","lastPlaceholder","initialProps","createElementNS","portalNode","setPortalProps","getInitialPortalProps","mount","newParent","newPlaceholder","unmount","domElement","HTMLElement","SVGElement","validateElementType","tagName","replaceChild","expectedPlaceholder","InPortal","addPropsChannel","nodeProps","_a","OutPortal","placeholderNode","passPropsThroughPortal","propsForTarget","currentPortalNode","createHtmlPortalNode","dispatchFocusAction","queriesDataPlaceholder","inView","showOverflow","parentRef","setFilterActive","dependencyIds","parentState","useFilterDependencies","shouldRefresh","isDashboardRefreshing","isRefreshing","isFilterRefreshing","isFiltersRefreshing","useShouldFilterRefresh","setFormData","setOwnState","inViewFirstTime","setInViewFirstTime","inputRef","hasDataSource","setIsLoading","setIsRefreshing","handleFilterLoadFinish","filterOwnState","objValue","othValue","setFocusedFilter","unsetFocusedFilter","extractTabLabel","extractChartLabel","RowLabel","RowValue","FilterName","DependencyItem","RowTruncationCount","TooltipList","TooltipSectionLabel","TooltipTrigger","useTruncation","elementRef","elementsTruncated","setElementsTruncated","hasHiddenElements","setHasHiddenElements","previousEffectInfoRef","parentElementWidth","useLayoutEffect","currentElement","childNodes","previousEffectInfo","parentElement","elementsCount","TooltipWithTruncation","getTooltipSection","ScopeRow","useCharts","topLevelTabs","topElementId","topLevelTab","layoutCharts","layoutElement","layoutChart","topLevelTabsInFullScope","layoutChartElementsInTabsInScope","excludedIndex","chartsInExcludedTabs","layoutChartElementInExcludedTab","useFilterScope","scopeRef","tooltipText","DependencyValue","hasSeparator","DependenciesRow","filterDependencyIds","filterDependencyId","dependenciesRef","NameRow","filterNameRef","TypeRow","FilterCardContent","FilterCard","externalIsVisible","internalIsVisible","setInternalIsVisible","mouseEnterDelay","mouseLeaveDelay","destroyTooltipOnHide","StyledIcon","StyledFilterControlTitle","StyledFilterControlTitleBox","StyledFilterControlContainer","FormItem","ToolTipContainer","RequiredFieldIndicator","paddingLeft","DescriptionToolTip","overlayInnerStyle","WebkitLineClamp","WebkitBoxOrient","textOverflow","cursor","FilterControl","isFilterActive","setIsFilterActive","useContext","FilterBarScrollContext","FilterControls","portalNodes","filtersWithValues","filtersInScope","filtersOutOfScope","dashboardHasTabs","isFilterInScope","selectChartTabParents","useSelectChartTabParents","tabParents","useIsFilterInScope","useSelectFiltersInScope","showCollapsePanel","filterControlFactory","bordered","collapsible","ActionButtonsContainer","rgba","mediumLight","onApply","onClearAll","isApplyDisabled","isClearAllEnabled","BarWrapper","Bar","CollapsedBar","offset","StyledCollapseIcon","StyledFilterIcon","FilterBarEmptyStateContainer","EXCLUDED_URL_PARAMS","publishDataMask","history","updateKey","previousParams","newParams","append","nativeFiltersCacheKey","createContext","FilterBar","filtersOpen","editFilterSetId","setEditFilterSetId","setDataMaskSelected","setUpdateKey","useTabId","setTab","previousFilters","nativeFilterValues","setIsScrolling","handleFilterSelectionChange","draft","currentFilter","previousFilter","currentTargets","currentDataMask","previousType","previousTargets","previousDataMask","typeChanged","targetsChanged","dataMaskChanged","dataMaskAppliedText","handleApply","handleClearAll","openFiltersBar","onscroll","selectedId","useFilterUpdates","dataSelectedValues","dataAppliedValues","checkIsApplyDisabled","isInitialized","setIsInitialized","MigrationContext","numberOfLoadingCharts","numberOfFilterbox","querySelectorAll","filterTimeout","numberOfLoadedCharts","useInitialization","tabPaneStyle","overscrollBehavior","numberOfFilters","Provider","filterCount","filterSetCount","FilterSets","getRootLevelTabsComponent","dashboardRoot","rootChildId","shouldFocusTabs","gridComponent","resizeComponent","DashboardEmptyStateContainer","DashboardGrid","rowGuideTop","getRowGuidePosition","setGridRef","resizeRef","GRID_COLUMN_COUNT","shouldDisplayTopLevelTabEmptyState","dashboardEmptyState","buttonText","buttonAction","topLevelTabEmptyState","nativeFilterScopes","useNativeFilterScopes","getRootLevelTabIndex","layoutItems","getChartIdsInFilterScope","childIds","renderTabBar","fullWidth","animated","allowOverflow","FiltersPanel","StickyPanel","StyledHeader","StyledDashboardContent","dashboardFiltersOpen","nativeFiltersEnabled","transitionTiming","handleDeleteTopLevelTabs","firstTab","standaloneMode","isReport","hideDashboardHeader","hideTitle","barTopOffset","setBarTopOffset","observer","ResizeObserver","showDashboard","toggleDashboardFiltersOpen","showNativeFilters","show_native_filters","expandFilters","setDashboardFiltersOpen","requiredFirstFilter","useNativeFilters","filterBarWidth","containerRef","setIsSticky","intersectionRatio","IntersectionObserver","unobserve","useElementOnScreen","filterSetEnabled","filterBarHeight","filterBarOffset","draggableStyle","currentTopLevelTabs","currentTabsLength","newTabsLength","lastTab","renderDraggableContent","hideNav","USER_CONTENT_COMPONENT_TYPE","isDashboardEmpty","actions","addSliceToDashboard","removeSliceFromDashboard","clearDataMaskState","dashboardInfoPropShape","dashboardStatePropShape","ownDataCharts","impressionId","initMessages","Dashboard","hasChanged","unload","returnValue","appliedFilters","appliedOwnDataCharts","onVisibilityChange","appContainer","bootstrapData","getAttribute","eventData","is_soft_navigation","is_edit_mode","mount_duration","is_empty","is_published","bootstrap_data_length","directLinkComponentId","LOG_ACTIONS_MOUNT_DASHBOARD","visibilityState","visibilityEventData","applyCharts","currentChartIds","nextChartIds","newChartId","removedChartId","applyFilters","onBeforeUnload","logStart","LOG_ACTIONS_HIDE_BROWSER_TAB","getAllCharts","currFilterKeys","appliedFilterKeys","allKeys","affectedChartIds","appliedChartIds","affectedIds","getAffectedOwnDataCharts","refreshCharts","ids","contextType","PluginContext","flash_messages","setDatasources"],"sourceRoot":""}