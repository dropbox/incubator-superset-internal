"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9049],{39049:(t,e,a)=>{a.r(e),a.d(e,{default:()=>I});var n=a(43323),r=a(15078),i=a.n(r),s=a(45697),d=a.n(s),o=a(28041),l=a.n(o),c=a(67190),u=a(51115),p=a(28062);const g={data:d().objectOf(d().arrayOf(d().shape({key:d().arrayOf(d().string),name:d().arrayOf(d().string),time:d().number,value:d().number}))),width:d().number,height:d().number,dateTimeFormat:d().string,numberFormat:d().string,useRichTooltip:d().bool,useAreaProportions:d().bool};function m(t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius}}function h(t,e){return t.value===e.value?t.name>e.name?1:-1:e.value-t.value}function f(t,e){const{data:a,width:n,height:r,colorScheme:s,dateTimeFormat:d,numberFormat:o,useRichTooltip:g,useAreaProportions:f,sliceId:y}=e,I=i().select(t);I.classed("superset-legacy-chart-rose",!0);const b=a,A=Object.keys(b).map((t=>parseInt(t,10))).sort(((t,e)=>t-e)),R=A.length,v=b[A[0]].length,T=(0,c.JB)(o),w=(0,u.bt)(d),k=p.getScale(s);i().select(".nvtooltip").remove(),I.selectAll("*").remove();const O=i().svg.arc(),x=l().models.legend(),N=l().models.tooltip(),S={disabled:b[A[0]].map((()=>!1))},M=I.append("svg").attr("width",n).attr("height",r).append("g").attr("class","rose").append("g"),C=M.append("g").attr("class","legendWrap");function P(t){return t[A[0]].map(((t,e)=>({disabled:S.disabled[e],key:t.name})))}x.width(n).color((t=>k(t.key,y))),C.datum(P(b)).call(x),N.headerFormatter(w).valueFormatter(T);const J=r-x.height(),W=x.height(),F=Math.min(n,J)/2-35,L=.075,$=`translate(${n/2},${J/2+W})`,U=M.append("g").attr("transform",$).attr("class","roseWrap"),j=M.append("g").attr("transform",$).attr("class","labelsWrap"),D=M.append("g").attr("transform",$).attr("class","groupLabelsWrap");function Z(t){let e=0,a=0;const n=[];for(const t of A){const r=b[t].reduce(((t,e,a)=>t+(S.disabled[a]?0:e.value)),0);e=r>e?r:e,n[a]=r,a+=1}const r=2*Math.PI/R,i=[];for(let t=0;t<=R;t+=1)i.push(r*t-Math.PI/2);const s=F/e,d=s*F,o=(t,e)=>f?Math.sqrt(d*t+e*e):s*t+e,l={data:[],extend:{},push:{},pieStart:{},pie:{},pieOver:{},mini:{},labels:[],groupLabels:[]};let c=0;for(let e=0;e<R;e+=1){const a=A[e],r=i[e],s=i[e+1],d=2*Math.PI/n[e];let u,p,g=0,m=0;for(const e of t[a]){const t=S.disabled[c%v]?0:e.value,{name:a,time:n}=e;e.id=c,u=o(t,g),l.data.push({startAngle:r,endAngle:s,innerRadius:g,outerRadius:u,name:a,arcId:c,val:t,time:n}),l.extend[c]={startAngle:r,endAngle:s,innerRadius:g,name:a,outerRadius:u+8},l.push[c]={startAngle:r,endAngle:s,innerRadius:g+8,outerRadius:u+8},l.pieStart[c]={startAngle:r,endAngle:s,innerRadius:L*F,outerRadius:F},l.mini[c]={startAngle:r,endAngle:s,innerRadius:g*L,outerRadius:u*L},c+=1,g=u}const f={...l.data[e*v]};f.outerRadius=F+20,f.innerRadius=F+15,l.labels.push(f);for(const r of t[a].concat().sort(h))p=d*(S.disabled[r.id%v]?0:r.value)+m,l.pie[r.id]={startAngle:m,endAngle:p,innerRadius:F*L,outerRadius:F,percent:r.value/n[e]},l.pieOver[r.id]={startAngle:m,endAngle:p,innerRadius:F*L,outerRadius:F+8},m=p}return l.groupLabels=l.data.slice(0,v),l}let K=Z(b);function q(t,e){return function(a){const n=i().interpolate(m(a),m(t));return t=>e(Object.assign(a,n(t)))}}function B(t){return q(t,(t=>O(t)))}function G(t){return q(t,(t=>`translate(${O.centroid(t)})`))}const z={};function E(t){if(z[t])return z[t];const e=Math.floor(t/v);return z[t]=[t+1,v*(e+1)-1],z[t]}const H={};function Q(t){if(H[t])return H[t];const e=Math.floor(t/v);return H[t]=[e*v,(e+1)*v-1],H[t]}let V=-1,X=!1;const Y=U.selectAll("g").data(JSON.parse(JSON.stringify(K.data))).enter().append("g").attr("class","segment").classed("clickable",!0).on("mouseover",(function(t,e){N.data(function(t,e,a){const n=Math.floor(t.arcId/v),r=g?a[A[n]].filter((t=>!S.disabled[t.id%v])).map((e=>({key:e.name,value:e.value,color:k(e.name,y),highlight:e.id===t.arcId}))):[{key:t.name,value:t.val,color:k(t.name,y)}];return{key:"Date",value:t.time,series:r}}(t,0,b)).hidden(!1);const a=i().select(this);if(a.classed("hover",!0),V<0&&!X){a.select("path").interrupt().transition().duration(180).attrTween("d",B(K.extend[e]));const t=E(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>B(K.push[t.arcId])(t)))}else if(!X){const n=Q(V);n[0]<=t.arcId&&t.arcId<=n[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",B(K.pieOver[e]))}})).on("mouseout",(function(t,e){N.hidden(!0);const a=i().select(this);if(a.classed("hover",!1),V<0&&!X){a.select("path").interrupt().transition().duration(180).attrTween("d",B(K.data[e]));const t=E(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>B(K.data[t.arcId])(t)))}else if(!X){const n=Q(V);n[0]<=t.arcId&&t.arcId<=n[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",B(K.pie[e]))}})).on("mousemove",(function(){N()})).on("click",(function(t,e){if(X)return;const a=i().event.altKey?3750:375,n=Q(e);if(V<0)X=!0,V=e,_.interrupt().transition().duration(a).attrTween("transform",(t=>G({outerRadius:0,innerRadius:0,startAngle:t.startAngle,endAngle:t.endAngle})(t))).style("opacity",0),tt.attr("transform",`translate(${O.centroid({outerRadius:F+20,innerRadius:F+15,startAngle:K.data[e].startAngle,endAngle:K.data[e].endAngle})})`).interrupt().transition().delay(a).duration(a).attrTween("transform",(t=>G({outerRadius:F+20,innerRadius:F+15,startAngle:K.pie[n[0]+t.arcId].startAngle,endAngle:K.pie[n[0]+t.arcId].endAngle})(t))).style("opacity",(t=>S.disabled[t.arcId]||K.pie[n[0]+t.arcId].percent<.05?0:1)),Y.classed("clickable",(t=>n[0]>t.arcId||t.arcId>n[1])),et.filter((t=>n[0]<=t.arcId&&t.arcId<=n[1])).interrupt().transition().duration(a).attrTween("d",(t=>B(K.pieStart[t.arcId])(t))).transition().duration(a).attrTween("d",(t=>B(K.pie[t.arcId])(t))).each("end",(()=>{X=!1})),et.filter((t=>n[0]>t.arcId||t.arcId>n[1])).interrupt().transition().duration(a).attrTween("d",(t=>B(K.mini[t.arcId])(t)));else if(V<n[0]||n[1]<V){X=!0;const t=Q(V);_.interrupt().transition().delay(a).duration(a).attrTween("transform",(t=>G(K.labels[t.arcId/v])(t))).style("opacity",1),tt.interrupt().transition().duration(a).attrTween("transform",G({outerRadius:F+20,innerRadius:F+15,startAngle:K.data[V].startAngle,endAngle:K.data[V].endAngle})).style("opacity",0),Y.classed("clickable",!0),et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(a).attrTween("d",(t=>B(K.pieStart[t.arcId])(t))).transition().duration(a).attrTween("d",(t=>B(K.data[t.arcId])(t))).each("end",(()=>{V=-1,X=!1})),et.filter((e=>t[0]>e.arcId||e.arcId>t[1])).interrupt().transition().delay(a).duration(a).attrTween("d",(t=>B(K.data[t.arcId])(t)))}})),_=j.selectAll("g").data(JSON.parse(JSON.stringify(K.labels))).enter().append("g").attr("class","roseLabel").attr("transform",(t=>`translate(${O.centroid(t)})`));_.append("text").style("text-anchor","middle").style("fill","#000").text((t=>w(t.time)));const tt=D.selectAll("g").data(JSON.parse(JSON.stringify(K.groupLabels))).enter().append("g");tt.style("opacity",0).attr("class","roseGroupLabels").append("text").style("text-anchor","middle").style("fill","#000").text((t=>t.name));const et=Y.append("path").attr("class","arc").attr("fill",(t=>k(t.name,y))).attr("d",O);x.dispatch.on("stateChange",(t=>{S.disabled!==t.disabled&&(S.disabled=t.disabled,function(){const t=i().event.altKey?3e3:300;C.datum(P(b)).call(x);const e=Z(b);if(X=!0,V<0)et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>B(e.data[t.arcId])(t))).each("end",(()=>{X=!1,K=e})).transition().duration(0).style("opacity",(t=>S.disabled[t.arcId%v]?0:1));else{const a=Q(V);et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>a[0]<=t.arcId&&t.arcId<=a[1]?B(e.pie[t.arcId])(t):B(e.mini[t.arcId])(t))).each("end",(()=>{X=!1,K=e})).transition().duration(0).style("opacity",(t=>S.disabled[t.arcId%v]?0:1)),tt.interrupt().transition().duration(t).attrTween("transform",(t=>G({outerRadius:F+20,innerRadius:F+15,startAngle:e.pie[a[0]+t.arcId].startAngle,endAngle:e.pie[a[0]+t.arcId].endAngle})(t))).style("opacity",(t=>S.disabled[t.arcId]||K.pie[a[0]+t.arcId].percent<.05?0:1))}}())}))}f.displayName="Rose",f.propTypes=g;const y=f,I=(0,n.Z)(y)},43323:(t,e,a)=>{a.d(e,{Z:()=>i});var n=a(67294),r=a(11965);function i(t,e){class a extends n.Component{constructor(t){super(t),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()}setContainerRef(t){this.container=t}execute(){this.container&&t(this.container,this.props)}render(){const{id:t,className:e}=this.props;return(0,r.tZ)("div",{ref:this.setContainerRef,id:t,className:e})}}const i=a;return t.displayName&&(i.displayName=t.displayName),t.propTypes&&(i.propTypes={...i.propTypes,...t.propTypes}),t.defaultProps&&(i.defaultProps=t.defaultProps),a}}}]);