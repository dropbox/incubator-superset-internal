(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{1709:function(e,t,n){"use strict";var a=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n(2109)).default;t.default=s},1710:function(e,t,n){"use strict";var a=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n(2110)).default;t.default=s},1711:function(e,t,n){"use strict";var a=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n(2111)).default;t.default=s},2109:function(e,t){e.exports=function(e){const t={begin:"<",end:">",subLanguage:"xml",relevance:0},n={begin:"\\[.+?\\][\\(\\[].*?[\\)\\]]",returnBegin:!0,contains:[{className:"string",begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0,relevance:0},{className:"link",begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}],relevance:10},a={className:"strong",contains:[],variants:[{begin:/_{2}/,end:/_{2}/},{begin:/\*{2}/,end:/\*{2}/}]},s={className:"emphasis",contains:[],variants:[{begin:/\*(?!\*)/,end:/\*/},{begin:/_(?!_)/,end:/_/,relevance:0}]};a.contains.push(s),s.contains.push(a);var i=[t,n];return a.contains=a.contains.concat(i),s.contains=s.contains.concat(i),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:i=i.concat(a,s)},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:i}]}]},t,{className:"bullet",begin:"^[ \t]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},a,s,{className:"quote",begin:"^>\\s+",contains:i,end:"$"},{className:"code",variants:[{begin:"(`{3,})(.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})(.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},n,{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]}]}}},2110:function(e,t){function n(...e){return e.map(e=>{return(t=e)?"string"==typeof t?t:t.source:null;var t}).join("")}e.exports=function(e){const t=function(e){const t={"builtin-name":["action","bindattr","collection","component","concat","debugger","each","each-in","get","hash","if","in","input","link-to","loc","log","lookup","mut","outlet","partial","query-params","render","template","textarea","unbound","unless","view","with","yield"].join(" ")},a={literal:["true","false","undefined","null"].join(" ")},s=/\[.*?\]/,i=/[^\s!"#%&'()*+,.\/;<=>@\[\\\]^`{|}~]+/,c=n("(",/'.*?'/,"|",/".*?"/,"|",s,"|",i,"|",/\.|\//,")+"),l=n("(",s,"|",i,")(?==)"),o={begin:c,lexemes:/[\w.\/]+/},r=e.inherit(o,{keywords:a}),d={begin:/\(/,end:/\)/},u={className:"attr",begin:l,relevance:0,starts:{begin:/=/,end:/=/,starts:{contains:[e.NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,r,d]}}},b={contains:[e.NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{begin:/as\s+\|/,keywords:{keyword:"as"},end:/\|/,contains:[{begin:/\w+/}]},u,r,d],returnEnd:!0},g=e.inherit(o,{className:"name",keywords:t,starts:e.inherit(b,{end:/\)/})});d.contains=[g];const p=e.inherit(o,{keywords:t,className:"name",starts:e.inherit(b,{end:/}}/})}),m=e.inherit(o,{keywords:t,className:"name"}),h=e.inherit(o,{className:"name",keywords:t,starts:e.inherit(b,{end:/}}/})});return{name:"Handlebars",aliases:["hbs","html.hbs","html.handlebars","htmlbars"],case_insensitive:!0,subLanguage:"xml",contains:[{begin:/\\\{\{/,skip:!0},{begin:/\\\\(?=\{\{)/,skip:!0},e.COMMENT(/\{\{!--/,/--\}\}/),e.COMMENT(/\{\{!/,/\}\}/),{className:"template-tag",begin:/\{\{\{\{(?!\/)/,end:/\}\}\}\}/,contains:[p],starts:{end:/\{\{\{\{\//,returnEnd:!0,subLanguage:"xml"}},{className:"template-tag",begin:/\{\{\{\{\//,end:/\}\}\}\}/,contains:[m]},{className:"template-tag",begin:/\{\{#/,end:/\}\}/,contains:[p]},{className:"template-tag",begin:/\{\{(?=else\}\})/,end:/\}\}/,keywords:"else"},{className:"template-tag",begin:/\{\{(?=else if)/,end:/\}\}/,keywords:"else if"},{className:"template-tag",begin:/\{\{\//,end:/\}\}/,contains:[m]},{className:"template-variable",begin:/\{\{\{/,end:/\}\}\}/,contains:[h]},{className:"template-variable",begin:/\{\{/,end:/\}\}/,contains:[h]}]}}(e);return t.name="HTMLbars",e.getLanguage("handlebars")&&(t.disableAutodetect=!0),t}},2111:function(e,t){e.exports=function(e){var t={literal:"true false null"},n=[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],a=[e.QUOTE_STRING_MODE,e.C_NUMBER_MODE],s={end:",",endsWithParent:!0,excludeEnd:!0,contains:a,keywords:t},i={begin:"{",end:"}",contains:[{className:"attr",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE],illegal:"\\n"},e.inherit(s,{begin:/:/})].concat(n),illegal:"\\S"},c={begin:"\\[",end:"\\]",contains:[e.inherit(s)],illegal:"\\S"};return a.push(i,c),n.forEach((function(e){a.push(e)})),{name:"JSON",contains:a,keywords:t,illegal:"\\S"}}},4535:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(11),s=n.n(a),i=(n(0),n(51)),c=n(53),l=n(868),o=n(1);const r=i.c.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${({theme:e})=>e.colors.primary.base};
      }
    }
  }
`,d=i.c.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`;function u({actions:e}){return Object(o.f)(r,{className:"actions"},s()(e).call(e,(e,t)=>{const n=l.a[e.icon];return e.tooltip?Object(o.f)(c.a,{id:`${e.label}-tooltip`,title:e.tooltip,placement:e.placement,key:t},Object(o.f)(d,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick},Object(o.f)(n,null))):Object(o.f)(d,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,key:t},Object(o.f)(n,null))}))}},4545:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(15);const s={name:Object(a.e)("Data"),tabs:[{name:"Databases",label:Object(a.e)("Databases"),url:"/databaseview/list/",usesRouter:!0},{name:"Datasets",label:Object(a.e)("Datasets"),url:"/tablemodelview/list/",usesRouter:!0},{name:"Saved queries",label:Object(a.e)("Saved queries"),url:"/savedqueryview/list/",usesRouter:!0},{name:"Query history",label:Object(a.e)("Query history"),url:"/superset/sqllab/history/",usesRouter:!0}]}},4627:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(31),s=n.n(a),i=(n(0),n(51)),c=n(15),l=n(847),o=n.n(l),r=n(1710),d=n.n(r),u=n(1709),b=n.n(u),g=n(1711),p=n.n(g),m=n(766),h=n.n(m),O=n(490),f=n.n(O),j=n(45),y=n(250),v=n(1);f.a.registerLanguage("sql",o.a),f.a.registerLanguage("markdown",b.a),f.a.registerLanguage("html",d.a),f.a.registerLanguage("json",p.a);const w=i.c.div`
  margin-top: -24px;
  &:hover {
    svg {
      visibility: visible;
    }
  }
  svg {
    position: relative;
    top: 40px;
    left: 512px;
    visibility: hidden;
    margin: -4px;
  }
`;function k({addDangerToast:e,addSuccessToast:t,children:n,...a}){return Object(v.f)(w,null,Object(v.f)(j.a,{tabIndex:0,name:"copy",role:"button",onClick:a=>{var s;a.preventDefault(),a.currentTarget.blur(),s=n,Object(y.a)(s).then(()=>{e&&e(Object(c.e)("Sorry, your browser does not support copying."))}).catch(()=>{t&&t(Object(c.e)("SQL Copied!"))})}}),Object(v.f)(f.a,s()({style:h.a},a),n))}},4628:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(39);var a=n(510),s=n.n(a),i=n(0);function c({queries:e,fetchData:t,currentQueryId:n}){const a=s()(e).call(e,e=>e.id===n),[c,l]=Object(i.useState)(a),[o,r]=Object(i.useState)(!1),[d,u]=Object(i.useState)(!1);function b(){r(0===c),u(c===e.length-1)}function g(n){const a=c+(n?-1:1);a>=0&&a<e.length&&(t(e[a].id),l(a),b())}return Object(i.useEffect)(()=>{b()}),{handleKeyPress:function(t){c>=0&&c<e.length&&("ArrowDown"===t.key||"k"===t.key?(t.preventDefault(),g(!1)):"ArrowUp"!==t.key&&"j"!==t.key||(t.preventDefault(),g(!0)))},handleDataChange:g,disablePrevious:o,disableNext:d}}},4933:function(e,t,n){"use strict";n.r(t);n(39);var a=n(34),s=n.n(a),i=n(11),c=n.n(i),l=n(51),o=n(15),r=n(68),d=n(0),u=n.n(d),b=n(104),g=n.n(b),p=n(35),m=n.n(p),h=n(140),O=n(25),f=n(121),j=n(518),y=n(1254),v=n(902),w=n(4529),k=n(1256),_=n(4535),S=n(4545),N=n(250),x=n(100),C=n(42),D=n(4627),q=n(4628),E=n(1);const M=l.c.div`
  color: ${({theme:e})=>e.colors.secondary.light2};
  font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
  margin-bottom: 0;
  text-transform: uppercase;
`,T=l.c.div`
  color: ${({theme:e})=>e.colors.grayscale.dark2};
  font-size: ${({theme:e})=>e.typography.sizes.m-1}px;
  padding: 4px 0 16px 0;
`,$=Object(l.c)(x.b)`
  .ant-modal-content {
  }

  .ant-modal-body {
    padding: 24px;
  }

  pre {
    font-size: ${({theme:e})=>e.typography.sizes.xs}px;
    font-weight: ${({theme:e})=>e.typography.weights.normal};
    line-height: ${({theme:e})=>e.typography.sizes.l}px;
    height: 375px;
    border: none;
  }
`;var L=Object(f.a)(({fetchData:e,onHide:t,openInSqlLab:n,queries:a,savedQuery:s,show:i,addDangerToast:c,addSuccessToast:l})=>{const{handleKeyPress:r,handleDataChange:d,disablePrevious:u,disableNext:b}=Object(q.a)({queries:a,currentQueryId:s.id,fetchData:e});return Object(E.f)("div",{role:"none",onKeyUp:r},Object(E.f)($,{onHide:t,show:i,title:Object(o.e)("Query preview"),footer:[Object(E.f)(C.a,{key:"previous-saved-query",disabled:u,onClick:()=>d(!0)},Object(o.e)("Previous")),Object(E.f)(C.a,{key:"next-saved-query",disabled:b,onClick:()=>d(!1)},Object(o.e)("Next")),Object(E.f)(C.a,{key:"open-in-sql-lab",buttonStyle:"primary",onClick:()=>n(s.id)},Object(o.e)("Open in SQL Lab"))]},Object(E.f)(M,null,Object(o.e)("Query name")),Object(E.f)(T,null,s.label),Object(E.f)(D.a,{language:"sql",addDangerToast:c,addSuccessToast:l},s.sql||"")))});const B=l.c.div`
  .count {
    margin-left: 5px;
    color: ${({theme:e})=>e.colors.primary.base};
    text-decoration: underline;
    cursor: pointer;
  }
`,H=l.c.div`
  color: ${({theme:e})=>e.colors.grayscale.dark2};
`;t.default=Object(f.a)((function({addDangerToast:e,addSuccessToast:t,user:n}){const{state:{loading:a,resourceCount:i,resourceCollection:l,bulkSelectEnabled:b},hasPerm:p,fetchData:f,toggleBulkSelect:x,refreshData:C}=Object(j.e)("saved_query",Object(o.e)("Saved queries"),e),[D,q]=Object(d.useState)(null),[M,T]=Object(d.useState)(null),$=p("can_write"),Q=p("can_write"),z=Object(d.useCallback)(t=>{r.a.get({endpoint:`/api/v1/saved_query/${t}`}).then(({json:e={}})=>{T({...e.result})},Object(h.c)(t=>e(Object(o.e)("There was an issue previewing the selected query %s",t))))},[e]),A={activeChild:"Saved queries",...S.a},I=[];Q&&I.push({name:Object(o.e)("Bulk select"),onClick:x,buttonStyle:"secondary"}),I.push({name:Object(E.f)(u.a.Fragment,null,Object(E.f)("i",{className:"fa fa-plus"})," ",Object(o.e)("Query")),onClick:()=>{window.open(`${window.location.origin}/superset/sqllab?new=true`)},buttonStyle:"primary"}),A.buttons=I;const P=e=>{window.open(`${window.location.origin}/superset/sqllab?savedQueryId=${e}`)},R=Object(d.useCallback)(n=>{Object(N.a)(`${window.location.origin}/superset/sqllab?savedQueryId=${n}`).then(()=>{t(Object(o.e)("Link Copied!"))}).catch(()=>{e(Object(o.e)("Sorry, your browser does not support copying."))})},[e,t]),U=[{id:"changed_on_delta_humanized",desc:!0}],G=Object(d.useMemo)(()=>[{accessor:"label",Header:Object(o.e)("Name")},{accessor:"database.database_name",Header:Object(o.e)("Database"),size:"xl"},{accessor:"database",hidden:!0,disableSortBy:!0},{accessor:"schema",Header:Object(o.e)("Schema"),size:"xl"},{Cell:({row:{original:{sql_tables:e=[]}}})=>{const t=c()(e).call(e,e=>e.table),n=t.length>0?t.shift():"";return t.length?Object(E.f)(B,null,Object(E.f)("span",null,n),Object(E.f)(O.r,{placement:"right",title:Object(o.e)("TABLES"),trigger:"click",content:Object(E.f)(u.a.Fragment,null,c()(t).call(t,e=>Object(E.f)(H,{key:e},e)))},Object(E.f)("span",{className:"count"},"(+",t.length,")"))):n},accessor:"sql_tables",Header:Object(o.e)("Tables"),size:"xl",disableSortBy:!0},{Cell:({row:{original:{created_on:e}}})=>{const t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return m()(n).fromNow()},Header:Object(o.e)("Created on"),accessor:"created_on",size:"xl"},{Cell:({row:{original:{changed_on_delta_humanized:e}}})=>e,Header:Object(o.e)("Modified"),accessor:"changed_on_delta_humanized",size:"xl"},{Cell:({row:{original:e}})=>{var t;const n=s()(t=[{label:"preview-action",tooltip:Object(o.e)("Query preview"),placement:"bottom",icon:"Binoculars",onClick:()=>{z(e.id)}},$?{label:"edit-action",tooltip:Object(o.e)("Edit query"),placement:"bottom",icon:"Edit",onClick:()=>{P(e.id)}}:null,{label:"copy-action",tooltip:Object(o.e)("Copy query URL"),placement:"bottom",icon:"Copy",onClick:()=>{R(e.id)}},Q?{label:"delete-action",tooltip:Object(o.e)("Delete query"),placement:"bottom",icon:"Trash",onClick:()=>q(e)}:null]).call(t,e=>!!e);return Object(E.f)(_.a,{actions:n})},Header:Object(o.e)("Actions"),id:"actions",disableSortBy:!0}],[Q,$,R,z]),K=Object(d.useMemo)(()=>[{Header:Object(o.e)("Database"),id:"database",input:"select",operator:"rel_o_m",unfilteredLabel:"All",fetchSelects:Object(h.e)("saved_query","database",Object(h.c)(t=>e(Object(o.e)("An error occurred while fetching dataset datasource values: %s",t)))),paginate:!0},{Header:Object(o.e)("Schema"),id:"schema",input:"select",operator:"eq",unfilteredLabel:"All",fetchSelects:Object(h.d)("saved_query","schema",Object(h.c)(t=>e(Object(o.e)("An error occurred while fetching schema values: %s",t)))),paginate:!0},{Header:Object(o.e)("Search"),id:"label",input:"search",operator:"all_text"}],[e]);return Object(E.f)(u.a.Fragment,null,Object(E.f)(v.a,A),D&&Object(E.f)(k.a,{description:Object(o.e)("This action will permanently delete the saved query."),onConfirm:()=>{D&&(({id:n,label:a})=>{r.a.delete({endpoint:`/api/v1/saved_query/${n}`}).then(()=>{C(),q(null),t(Object(o.e)("Deleted: %s",a))},Object(h.c)(t=>e(Object(o.e)("There was an issue deleting %s: %s",a,t))))})(D)},onHide:()=>q(null),open:!0,title:Object(o.e)("Delete Query?")}),M&&Object(E.f)(L,{fetchData:z,onHide:()=>T(null),savedQuery:M,queries:l,openInSqlLab:P,show:!0}),Object(E.f)(y.a,{title:Object(o.e)("Please confirm"),description:Object(o.e)("Are you sure you want to delete the selected queries?"),onConfirm:n=>{r.a.delete({endpoint:`/api/v1/saved_query/?q=${g.a.encode(c()(n).call(n,({id:e})=>e))}`}).then(({json:e={}})=>{C(),t(e.message)},Object(h.c)(t=>e(Object(o.e)("There was an issue deleting the selected queries: %s",t))))}},e=>{const t=Q?[{key:"delete",name:Object(o.e)("Delete"),onSelect:e,type:"danger"}]:[];return Object(E.f)(w.b,{className:"saved_query-list-view",columns:G,count:i,data:l,fetchData:f,filters:K,initialSort:U,loading:a,pageSize:25,bulkActions:t,bulkSelectEnabled:b,disableBulkSelect:x,highlightRowId:null==M?void 0:M.id})}))}))}}]);