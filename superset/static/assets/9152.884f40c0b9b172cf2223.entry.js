"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9152],{40701:(e,t,n)=>{n.d(t,{J0:()=>T,YA:()=>v,bK:()=>_,CB:()=>b,Mu:()=>I,L1:()=>A,aZ:()=>w,qL:()=>R,nj:()=>h,x_:()=>Z,LM:()=>g,Ww:()=>m,v7:()=>E,g3:()=>C,_p:()=>N,az:()=>L,iO:()=>O,Ou:()=>x,WZ:()=>f,A7:()=>y});var r=n(21090),i=n(61988),o=n(72570),s=n(81255),a=n(80621),d=n(47456),c=n(44803),u=n(81395),l=n(31758);const h="UPDATE_COMPONENTS";function p(e){return(...t)=>(n,r)=>{const i=e(...t);n("function"==typeof i?i(n,r):i);const{dashboardLayout:o,dashboardState:s}=r();if(i.type!==h||!i.payload||!i.payload.nextComponents){const e=o.present;n((0,u.P_)(e))}s.hasUnsavedChanges||n((0,l.if)(!0))}}const f=p((e=>({type:h,payload:{nextComponents:e}})));function y(e){return(t,n)=>{const{dashboardLayout:r}=n();t(f({[a.M2]:{...r.present[a.M2],meta:{text:e}}}))}}const _="DASHBOARD_TITLE_CHANGED";function m(e){return{type:_,text:e}}const b="DELETE_COMPONENT",E=p(((e,t)=>({type:b,payload:{id:e,parentId:t}}))),T="CREATE_COMPONENT",g=p((e=>({type:T,payload:{dropResult:e}}))),v="CREATE_TOP_LEVEL_TABS",S=p((e=>({type:v,payload:{dropResult:e}}))),I="DELETE_TOP_LEVEL_TABS",C=p((()=>({type:I,payload:{}}))),R="RESIZE_COMPONENT";function O({id:e,width:t,height:n}){return(r,i)=>{const{dashboardLayout:o}=i(),{present:s}=o,a=s[e],d=t&&a.meta.width!==t,c=n&&a.meta.height!==n;if(a&&(d||c)){const i={[e]:{...a,meta:{...a.meta,width:t||a.meta.width,height:n||a.meta.height}}};r(f(i))}}}const w="MOVE_COMPONENT",D=p((e=>({type:w,payload:{dropResult:e}}))),A="HANDLE_COMPONENT_DROP";function N(e){return(t,n)=>{const r=function(e,t){const n=(0,d.Z)({dropResult:e,layout:t});return"number"==typeof n&&n<0}(e,n().dashboardLayout.present);if(r)return t((0,o.Dz)((0,i.t)("There is not enough space for this component. Try decreasing its width, or increasing the destination width.")));const{source:u,destination:l}=e,h=l&&l.id===a._4,p=u.id===a.D0,f=n().dashboardLayout.present[a._4],y=f&&f.children?f.children[0]:"";if(h)t(S(e));else if(l&&p)t(g(e));else{if(u.type===s.yR&&l.type===s.yR&&u.id===y&&l.id!==y)return t((0,o.Dz)((0,i.t)("Can not move top level tab into nested tabs")));l&&u&&(l.id!==u.id||l.index!==u.index)&&t(D(e))}const{dashboardFilters:_,dashboardLayout:m}=n();if(!p){const{present:e}=m,n=e[u.id]||{},r=e[l.id]||{};if((n.type===s.yR||n.type===s.Os)&&n.children&&0===n.children.length){const n=(0,c.Z)({childId:u.id,layout:e});t(E(u.id,n))}(function({dashboardFilters:e={},source:t=[],destination:n=[]}){const r=new Set(t),i=new Set(n);return[].concat(...Object.values(e).map((({scopes:e})=>[].concat(...Object.values(e).map((({scope:e})=>e)))))).some((e=>i.has(e)!==r.has(e)))})({dashboardFilters:_,source:(n.parents||[]).concat(u.id),destination:(r.parents||[]).concat(l.id)})&&t((0,o.Dz)((0,i.t)("This chart has been moved to a different filter scope.")))}return null}}function x(){return(e,t)=>{e(r.zF.undo());const{dashboardLayout:n,dashboardState:i}=t();0!==n.past.length||i.maxUndoHistoryExceeded||i.updatedColorScheme||e((0,l.if)(!1))}}const L=p(r.zF.redo),Z="UPDATE_COMPONENTS_PARENTS_LIST"},31758:(e,t,n)=>{n.d(t,{BD:()=>R,P0:()=>B,bs:()=>J,sm:()=>K,ec:()=>ee,k5:()=>X,Ii:()=>q,Vd:()=>O,PI:()=>w,nV:()=>le,J$:()=>ae,FF:()=>ve,RU:()=>ce,$f:()=>$,mq:()=>pe,r$:()=>me,n1:()=>Ee,yV:()=>G,ee:()=>I,oJ:()=>ne,ek:()=>P,Z9:()=>A,H9:()=>Z,Iw:()=>ye,Be:()=>j,Pi:()=>ie,Mn:()=>Y,Lb:()=>x,Qt:()=>ge,z2:()=>W,YC:()=>Q,Yy:()=>te,Cd:()=>oe,rL:()=>se,M8:()=>V,TN:()=>L,dr:()=>F,$_:()=>he,ps:()=>de,sL:()=>Se,E2:()=>ue,Mb:()=>H,GH:()=>fe,zL:()=>be,uN:()=>Te,fE:()=>k,if:()=>C,O8:()=>re,WL:()=>M,oY:()=>_e,Sn:()=>U});var r=n(21090),i=n(31069),o=n(61988),s=n(55786),a=n(78161),d=n(52256),c=n(37863),u=n(35854),l=n(98286),h=n(80621),p=n(72570),f=n(11370),y=n(43399),_=n(9679),m=n(91877),b=n(93185),E=n(40701),T=n(41295),g=n(50810),v=n(81395),S=n(52794);const I="SET_UNSAVED_CHANGES";function C(e){return{type:I,payload:{hasUnsavedChanges:e}}}const R="ADD_SLICE",O="REMOVE_SLICE",w="RESET_SLICE",D="/superset/favstar/Dashboard",A="TOGGLE_FAVE_STAR";function N(e){return{type:A,isStarred:e}}function x(e){return function(t){return i.Z.get({endpoint:`${D}/${e}/count/`}).then((({json:e})=>{e.count>0&&t(N(!0))})).catch((()=>t((0,p.Gb)((0,o.t)("There was an issue fetching the favorite status of this dashboard.")))))}}function L(e,t){return function(n){const r=t?"unselect":"select";return i.Z.get({endpoint:`${D}/${e}/${r}/`}).then((()=>{n(N(!t))})).catch((()=>n((0,p.Gb)((0,o.t)("There was an issue favoriting this dashboard.")))))}}const Z="TOGGLE_PUBLISHED";function F(e,t){return function(n){return i.Z.put({endpoint:`/api/v1/dashboard/${e}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({published:t})}).then((()=>{n((0,p.ws)(t?(0,o.t)("This dashboard is now published"):(0,o.t)("This dashboard is now hidden"))),n(function(e){return{type:Z,isPublished:e}}(t))})).catch((()=>{n((0,p.Gb)((0,o.t)("You do not have permissions to edit this dashboard.")))}))}}const P="TOGGLE_EXPAND_SLICE";function M(e){return{type:P,sliceId:e}}const j="UPDATE_CSS";function U(e){return{type:j,css:e}}const $="SET_EDIT_MODE";function H(e){return{type:$,editMode:e}}const B="ON_CHANGE";function W(){return{type:B}}const q="ON_SAVE",G="SET_REFRESH_FREQUENCY";function k(e,t=!1){return{type:G,refreshFrequency:e,isPersistent:t}}function z(e){return t=>{t(function(e){return{type:q,lastModifiedTime:e}}(e)),t(r.zF.clearHistory())}}function V(e,t,n){return(r,a)=>{var d,c,u,g,I,C,R;r({type:E.x_});const{dashboardFilters:O,dashboardLayout:w}=a(),D=w.present;Object.values(O).forEach((e=>{var t;const{chartId:n}=e,i=e.directPathToFilter.slice().pop(),o=((null==(t=D[i])?void 0:t.parents)||[]).slice();o.push(i),r((0,v.yz)(n,o))}));const A=(0,f.Z)((0,y.De)()),N=function(e){return Object.values(e).reduce(((e,{chartId:t,scopes:n})=>({...e,[t]:Object.keys(n).reduce(((e,t)=>({...e,[t]:n[t]})),{})})),{})}(O),{certified_by:x,certification_details:L,css:Z,dashboard_title:F,owners:P,roles:M,slug:j}=e,U=e=>void 0!==e.id,$={...e,certified_by:x||"",certification_details:x&&L?L:"",css:Z||"",dashboard_title:F||(0,o.t)("[ untitled dashboard ]"),owners:(0,s.Z)(P).map((e=>U(e)?e.id:e)),roles:(0,m.cr)(b.T.DASHBOARD_RBAC)?(0,s.Z)(M).map((e=>U(e)?e.id:e)):void 0,slug:j||null,metadata:{...e.metadata,color_namespace:(null==(d=e.metadata)?void 0:d.color_namespace)||void 0,color_scheme:(null==(c=e.metadata)?void 0:c.color_scheme)||"",expanded_slices:(null==(u=e.metadata)?void 0:u.expanded_slices)||{},label_colors:(null==(g=e.metadata)?void 0:g.label_colors)||{},shared_label_colors:(null==(I=e.metadata)?void 0:I.shared_label_colors)||{},refresh_frequency:(null==(C=e.metadata)?void 0:C.refresh_frequency)||0,timed_refresh_immune_slices:(null==(R=e.metadata)?void 0:R.timed_refresh_immune_slices)||[]}},H=()=>{const{dashboardInfo:{metadata:{chart_configuration:e={}}}}=a();return Object.values(e).reduce(((e,t)=>Object.values(D).find((e=>{var n;return(null==e||null==(n=e.meta)?void 0:n.chartId)===t.id}))?{...e,[t.id]:t}:e),{})},B=async e=>{const{error:t,message:n}=await(0,l.O)(e);let i=(0,o.t)("Sorry, an unknown error occured");t&&(i=(0,o.t)("Sorry, there was an error saving this dashboard: %s",t)),"string"==typeof n&&"Forbidden"===n&&(i=(0,o.t)("You do not have permission to edit this dashboard")),r((0,p.Gb)(i))};if(n===h.TN){let e={};(0,m.cr)(b.T.DASHBOARD_CROSS_FILTERS)&&(e=H());const n={certified_by:$.certified_by,certification_details:$.certification_details,css:$.css,dashboard_title:$.dashboard_title,slug:$.slug,owners:$.owners,roles:$.roles,json_metadata:(0,_.o)({...(null==$?void 0:$.metadata)||{},default_filters:(0,_.o)(A),filter_scopes:N,chart_configuration:e})};return i.Z.put({endpoint:`/api/v1/dashboard/${t}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(e=>{const n=e.json.result,i=e.json.last_modified_time;if(n.json_metadata){const e=JSON.parse(n.json_metadata);r((0,T.a8)({metadata:e})),e.chart_configuration&&r({type:T.t$,chartConfiguration:e.chart_configuration}),e.native_filter_configuration&&r({type:S.qe,filterConfig:e.native_filter_configuration})}return i&&r(z(i)),window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${j||t}/`),r((0,p.ws)((0,o.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>B(e)))}const W={...$};W.metadata&&delete W.metadata;const q={...W,...(null==$?void 0:$.metadata)||{}};return i.Z.post({endpoint:`/superset/copy_dash/${t}/`,postPayload:{data:{...q,default_filters:(0,_.o)(A),filter_scopes:(0,_.o)(N)}}}).then((e=>(e=>{const t=e.json.last_modified_time;if(t&&r(z(t)),(0,m.cr)(b.T.DASHBOARD_CROSS_FILTERS)){const e=H();r((0,T.Aw)(e))}return r((0,p.ws)((0,o.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>B(e)))}}function Y(e=[],t=!1,n=0,r){return(i,o)=>{if(!n)return void e.forEach((e=>i((0,d.refreshChart)(e,t,r))));const{metadata:s}=o().dashboardInfo,a=Math.max(n,s.stagger_time||5e3);"boolean"!=typeof s.stagger_refresh&&(s.stagger_refresh=void 0===s.stagger_refresh||"true"===s.stagger_refresh);const c=s.stagger_refresh?a/(e.length-1):0;e.forEach(((e,n)=>{setTimeout((()=>i((0,d.refreshChart)(e,t,r))),c*n)}))}}const J="ON_FILTERS_REFRESH",K="ON_FILTERS_REFRESH_SUCCESS";function Q(){return{type:K}}const X="ON_REFRESH_SUCCESS",ee="ON_REFRESH";function te(e=[],t=!1,n=0,r){return i=>{i({type:ee}),((e,t,n,r,i)=>new Promise((o=>{i(Y(e,t,n,r)),o()})))(e,t,n,r,i).then((()=>{i({type:X}),i({type:J})}))}}const ne="SHOW_BUILDER_PANE";function re(){return{type:ne}}function ie(e,t){return(n,r)=>{const{sliceEntities:i}=r(),o=i.slices[e];if(!o)return n((0,p.Dz)("Sorry, there is no chart definition associated with the chart trying to be added."));const s={...o.form_data,slice_id:o.slice_id},a={...c.u,id:e,form_data:s,formData:(0,u.oN)(s)};return Promise.all([n((0,d.addChart)(a,e)),n((0,g.QR)(s.datasource))]).then((()=>{n({type:R,slice:o}),o&&"filter_box"===o.viz_type&&n((0,v.KJ)(e,t,o.form_data))}))}}function oe(){return(e,t)=>{const{dashboardInfo:{metadata:n},dashboardState:r}=t();null!=r&&r.updateSlice&&null!=r&&r.editMode&&(n.shared_label_colors=(0,a.Z)().getColorMap(null==n?void 0:n.color_namespace,null==n?void 0:n.color_scheme),e((0,T.a8)({metadata:n})),e({type:w}))}}function se(e){return(t,n)=>{const r=n().sliceEntities.slices[e];r&&"filter_box"===r.viz_type&&t((0,v.ku)(e)),t({type:O,sliceId:e}),t((0,d.removeChart)(e));const{dashboardInfo:{metadata:i}}=n();(0,a.Z)().removeSlice(e),i.shared_label_colors=(0,a.Z)().getColorMap(null==i?void 0:i.color_namespace,null==i?void 0:i.color_scheme),t((0,T.a8)({metadata:i}))}}const ae="SET_COLOR_SCHEME";function de(e){return t=>{t(function(e){return{type:ae,colorScheme:e}}(e)),t(C(!0))}}const ce="SET_DIRECT_PATH";function ue(e){return{type:ce,path:e}}const le="SET_ACTIVE_TABS";function he(e,t){return{type:le,tabId:e,prevTabId:t}}const pe="SET_FOCUSED_FILTER_FIELD";function fe(e,t){return{type:pe,chartId:e,column:t}}const ye="UNSET_FOCUSED_FILTER_FIELD";function _e(e,t){return{type:ye,chartId:e,column:t}}const me="SET_FULL_SIZE_CHART_ID";function be(e){return{type:me,chartId:e}}const Ee="SET_MAX_UNDO_HISTORY_EXCEEDED";function Te(e=!0){return{type:Ee,payload:{maxUndoHistoryExceeded:e}}}function ge(){return(e,t)=>{const{dashboardLayout:n}=t(),r=n.past.length;return e((0,p.Dz)(`You have used all ${r} undo slots and will not be able to fully undo subsequent actions. You may save your current state to reset the history.`))}}const ve="SET_DATASETS_STATUS";function Se(e){return{type:ve,status:e}}},44803:(e,t,n)=>{n.d(t,{Z:()=>i});const r={};function i({childId:e,layout:t={}}){if(r[e]){const n=t[r[e]]||{};if(n.children&&n.children.includes(e))return n.id}return r[e]=function({childId:e,layout:t={}}){let n=null;const r=Object.keys(t);for(let i=0;i<=r.length-1;i+=1){const o=r[i],s=t[o]||{};if(o!==e&&s.children&&s.children.includes(e)){n=o;break}}return n}({childId:e,layout:t}),r[e]}},47456:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(80621),i=n(44803),o=n(72673),s=n(28428);function a({dropResult:e,layout:t}){const{source:n,destination:a,dragging:d}=e,c=n.id===r.D0?(0,s.Z)(d.type):t[d.id]||{};if(n.id===a.id)return c.meta.width;const{width:u,minimumWidth:l}=(0,o.Z)({component:c,components:t}),{width:h,occupiedWidth:p}=(0,o.Z)({id:a.id,components:t});let f=Number(h-p);if(Number.isNaN(f)){const{width:e,occupiedWidth:n}=(0,o.Z)({id:(0,i.Z)({childId:a.id,layout:t}),components:t});f=Number(e-n)}return Number.isNaN(f)||Number.isNaN(Number(u))||f>=u?u:f>=l?f:-1}},72673:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(44803),i=n(80621),o=n(81255);function s({id:e,components:t}){const n=t[e];if(!n)return 0;let r=0;return(n.children||[]).forEach((e=>{const n=t[e]||{};r+=(n.meta||{}).width||0})),r}function a({id:e,component:t,components:n={}}){const d={width:void 0,occupiedWidth:void 0,minimumWidth:void 0},c=t||n[e];return c?(d.width=(c.meta||{}).width,d.occupiedWidth=d.width,c.type===o.Os?(d.width=a({id:(0,r.Z)({childId:c.id,layout:n}),components:n}).width||i.cz,d.occupiedWidth=s({id:c.id,components:n}),d.minimumWidth=d.occupiedWidth||i.cx):c.type===o.BA?(d.minimumWidth=i.cx,d.occupiedWidth=0,(c.children||[]).forEach((e=>{n[e].type===o.Os&&(d.minimumWidth=Math.max(d.minimumWidth,s({id:e,components:n})))}))):c.type!==o.t&&c.type!==o.xh&&c.type!==o.dW||(d.minimumWidth=i.cx),d):d}},61358:(e,t,n)=>{n.d(t,{jt:()=>d,Aw:()=>c,J8:()=>l,cq:()=>h,Dr:()=>p,Me:()=>f,M:()=>y,MZ:()=>_});var r=n(31069),i=n(61988),o=n(15926),s=n.n(o),a=n(72570);const d="SET_REPORT";function c(e,t,n,o){const c=s().encode({filters:[{col:t,opr:"eq",value:o},{col:"creation_method",opr:"eq",value:n},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return r.Z.get({endpoint:`/api/v1/report/?q=${c}`}).then((({json:t})=>{e({type:d,report:t})})).catch((()=>e((0,a.Gb)((0,i.t)("There was an issue fetching reports attached to this dashboard.")))))}}const u=(e,t)=>{const n=t(),{user:r,dashboardInfo:i,charts:o,explore:s}=n;if(i)e(c(r.userId,"dashboard_id","dashboards",i.id));else{const[t]=Object.keys(o);e(c(s.user.userId,"chart_id","charts",o[t].id))}},l="ADD_REPORT",h=e=>t=>r.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:l,json:e}),t((0,a.ws)((0,i.t)("The report has been created")))})),p="EDIT_REPORT";function f(e,t){return function(n){r.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{n({type:p,json:e})})).catch((()=>n((0,a.Gb)((0,i.t)("An error occurred while editing this report.")))))}}function y(e,t){return function(n){return r.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{n((0,a.Gb)((0,i.t)("We were unable to active or deactivate this report.")))})).finally((()=>{n(u)}))}}function _(e){return function(t){return r.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,a.Gb)((0,i.t)("Your report could not be deleted")))})).finally((()=>{t(u),t((0,a.ws)((0,i.t)("Deleted: %s",e.name)))}))}}},29147:(e,t,n)=>{n.d(t,{fG:()=>d,DG:()=>c});var r=n(67294),i=n(27600),o=n(23525),s=n(11965);const a=(0,r.createContext)({hideTitle:!1,hideTab:!1,hideNav:!1,hideChartControls:!1}),d=()=>(0,r.useContext)(a),c=({children:e})=>{const t=(0,o.eY)(i.KD.uiConfig)||0,[n]=(0,r.useState)({hideTitle:0!=(1&t),hideTab:0!=(2&t),hideNav:0!=(4&t),hideChartControls:0!=(8&t)});return(0,s.tZ)(a.Provider,{value:n},e)}},89474:(e,t,n)=>{n.d(t,{h:()=>Y});var r=n(14890),i=n(53894),o=n(72570),s=n(99543),a=n(37863),d=n(8868),c=n(61358),u=n(41295),l=n(63389),h=n(31758),p=n(39023),f=n(39759),y=n(24350),_=n.n(y),m=n(50810),b=n(37927),E=n(21090),T=n(80621),g=n(40701),v=n(81255);function S(e){return[v.BA,v.dW,v.xh,v.t].indexOf(e.type)>-1}var I=n(44803),C=n(47456);function R({currentComponent:e,layout:t={}}){if(e&&t[e.id]){const n=(e.parents||[]).slice();n.push(e.id),e.children.forEach((e=>{t[e].parents=n,R({currentComponent:t[e],layout:t})}))}}var O=n(28428);const w={[v.BG]:{[v.dW]:!0,[v.BA]:!0,[v.xh]:!0},[v.gn]:{[v.dW]:!0,[v.BA]:!0,[v.xh]:!0}};function D({parentType:e,childType:t}){if(!e||!t)return!1;const n=w[e];return!!n&&Boolean(n[t])}function A({dropResult:e,layout:t}){const{dragging:n,destination:r}=e,i=n.type,o=t[r.id],s=o.type;let a=(0,O.Z)(i,n.meta);a.parents=(o.parents||[]).concat(o.id),S(n)&&(a.meta.width=(0,C.Z)({dropResult:e,layout:t})||void 0);const d=D({parentType:s,childType:i}),c={[a.id]:a};if(d){const e=(0,O.Z)(v.Os);e.children=[a.id],e.parents=(o.parents||[]).concat(o.id),c[e.id]=e,a.parents=e.parents.concat(e.id),a=e}else if(i===v.yR){const e=(0,O.Z)(v.gn);e.parents=(o.parents||[]).concat(o.id),a.children=[e.id],c[e.id]=e}const u=[...o.children];return u.splice(r.index,0,a.id),c[r.id]={...o,children:u},c}const N={[l.$]:(e,t)=>({...t.data.dashboardLayout.present}),[g.nj](e,t){const{payload:{nextComponents:n}}=t;return{...e,...n}},[g.CB](e,t){const{payload:{id:n,parentId:r}}=t;if(!(r&&n&&e[n]&&e[r]))return e;const i={...e};function o(e,t){const n=i[e];delete i[e];const{children:r=[]}=n;r.forEach((t=>{o(t,e)}));const s=i[t];if(s){const n=(s.children||[]).indexOf(e);if(n>-1){const e=[...s.children];e.splice(n,1),i[t]={...s,children:e}}}}o(n,r);const s=i[r];return s.type===v.Os&&0===s.children.length&&o(r,(0,I.Z)({childId:r,layout:i})),i},[g.J0](e,t){const{payload:{dropResult:n}}=t,r=A({dropResult:n,layout:e});return{...e,...r}},[g.aZ](e,t){const{payload:{dropResult:n}}=t,{source:r,destination:i,dragging:o}=n;if(!r||!i||!o)return e;const s=function({entitiesMap:e,source:t,destination:n}){const r=[...e[t.id].children],i=[...e[n.id].children],o=r[t.index];if(t.id===n.id){const i=function(e,t,n){const r=[...e],[i]=r.splice(t,1);return r.splice(n,0,i),r}(r,t.index,n.index);return{...e,[t.id]:{...e[t.id],children:i}}}return r.splice(t.index,1),i.splice(n.index,0,o),{...e,[t.id]:{...e[t.id],children:r},[n.id]:{...e[n.id],children:i}}}({entitiesMap:e,source:r,destination:i});if(S(s[o.id])){const t=(0,C.Z)({dropResult:n,layout:e})||void 0;(s[o.id].meta||{}).width!==t&&(s[o.id]={...s[o.id],meta:{...s[o.id].meta,width:t}})}if(D({parentType:i.type,childType:o.type})){const e=s[i.id],t=e.children,n=(0,O.Z)(v.Os);n.children=[t[i.index]],n.parents=(e.parents||[]).concat(i.id),t[i.index]=n.id,s[n.id]=n}return{...e,...s}},[g.YA](e,t){const{payload:{dropResult:n}}=t,{source:r,dragging:i}=n,o=e[T._4],s=o.children[0],a=e[s];if(r.id!==T.D0){const t=e[i.id].children[0],n=e[t],r=[...a.children].filter((e=>e!==i.id));return{...e,[T._4]:{...o,children:[i.id]},[s]:{...a,children:[]},[t]:{...n,children:[...n.children,...r]}}}const d=A({dropResult:n,layout:e}),c=Object.values(d),u=c.find((e=>e.type===v.gn)),l=c.find((e=>e.type===v.yR));return u.children=[...a.children],d[s]={...a,children:[]},d[T._4]={...o,children:[l.id]},{...e,...d}},[g.Mu](e){const t=e[T._4],n=t.children[0],r=e[n];if(r.type!==v.yR)return e;let i=[];const o={...e};return r.children.forEach((t=>{const n=e[t];i=[...i,...n.children],delete o[t]})),delete o[n],o[T._4]={...t,children:[T.PV]},o[T.PV]={...e[T.PV],children:i},o},[g.x_](e){const t={...e};return R({currentComponent:t[T._4],layout:t}),{...t}},[g.bK]:(e,t)=>({...e,[T.M2]:{...e[T.M2],meta:{...e[T.M2].meta,text:t.text}}})},x=(0,E.ZP)((function(e={},t){return t.type in N?(0,N[t.type])(e,t):e}),{limit:T.Q9+2,ignoreInitialState:!0,filter:(0,E.an)([l.$,g.nj,g.CB,g.J0,g.YA,g.Mu,g.qL,g.aZ,g.L1])});var L=n(14670),Z=n.n(L),F=n(31069),P=n(9679),M=n(97381),j=n(3741),U=n(23279),$=n.n(U);const H=new class{constructor({callback:e=(()=>{}),sizeThreshold:t=1e3,delayThreshold:n=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThrehold=n,this.trigger=$()(this.trigger.bind(this),this.delayThrehold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:n,source_id:r}=e[0];if("dashboard"===n?t+=`&dashboard_id=${r}`:"slice"===n&&(t+=`&slice_id=${r}`),navigator.sendBeacon){const n=new FormData;n.append("events",(0,P.o)(e)),navigator.sendBeacon(t,n)}else F.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let B=0;var W;const q=e=>(t=e)=>t,G=document.getElementById("app"),k=JSON.parse(null!=(W=null==G?void 0:G.getAttribute("data-bootstrap"))?W:"{}"),z={charts:a.Z,datasources:function(e,t){return t.type===m.Rn.SET_DATASOURCES?{...e,..._()(t.datasources,"uid")}:t.type===m.Rn.SET_DATASOURCE?{...e,[t.key]:t.datasource}:e||{}},dashboardInfo:function(e={},t){switch(t.type){case u.$A:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case l.$:return{...e,...t.data.dashboardInfo};default:return e}},dashboardFilters:p.ZP,dataMask:d.Z,nativeFilters:f.Z,dashboardState:function(e={},t){const n={[l.$]:()=>({...e,...t.data.dashboardState}),[h.Be]:()=>({...e,css:t.css}),[h.BD](){const n=new Set(e.sliceIds);return n.add(t.slice.slice_id),{...e,sliceIds:Array.from(n),updateSlice:!0}},[h.Vd](){const{sliceId:n}=t,r=new Set(e.sliceIds);return r.delete(n),{...e,sliceIds:Array.from(r)}},[h.PI]:()=>({...e,updateSlice:!1}),[h.Z9]:()=>({...e,isStarred:t.isStarred}),[h.H9]:()=>({...e,isPublished:t.isPublished}),[h.$f]:()=>({...e,editMode:t.editMode}),[h.n1](){const{maxUndoHistoryExceeded:n=!0}=t.payload;return{...e,maxUndoHistoryExceeded:n}},[h.oJ]:()=>({...e}),[h.J$]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[h.ek](){const n={...e.expandedSlices},{sliceId:r}=t;return n[r]?delete n[r]:n[r]=!0,{...e,expandedSlices:n}},[h.P0]:()=>({...e,hasUnsavedChanges:!0}),[h.Ii]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,updateSlice:!1,lastModifiedTime:t.lastModifiedTime}),[h.ee](){const{hasUnsavedChanges:n}=t.payload;return{...e,hasUnsavedChanges:n}},[h.yV]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[h.ec]:()=>({...e,isRefreshing:!0}),[h.bs]:()=>({...e,isFiltersRefreshing:!0}),[h.sm]:()=>({...e,isFiltersRefreshing:!1}),[h.k5]:()=>({...e,isRefreshing:!1}),[h.RU]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[h.nV](){const n=new Set(e.activeTabs);return n.delete(t.prevTabId),n.add(t.tabId),{...e,activeTabs:Array.from(n)}},[h.mq]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[h.Iw]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[h.r$]:()=>({...e,fullSizeChartId:t.chartId}),[h.FF]:()=>({...e,datasetsStatus:t.status})};return t.type in n?n[t.type]():e},dashboardLayout:x,sliceEntities:b.Z,reports:function(e={},t){const n={[c.jt]:()=>({...t.report.result.reduce(((e,t)=>({...e,[t.id]:t})),{})}),[c.J8](){const n=t.json.result;return n.id=t.json.id,{...e,[t.json.id]:n}},[c.Dr](){const n=t.json.result;return n.id=t.json.id,{...e,[t.json.id]:n}}};return t.type in n?n[t.type]():e}},V=(0,r.UY)({messageToasts:function(e=[],t){switch(t.type){case o.h:{const{payload:n}=t,r=e.slice();return n.noDuplicate&&r.find((e=>e.text===n.text))?e:[n,...e]}case o.K7:{const{payload:{id:n}}=t;return[...e].filter((e=>e.id!==n))}default:return e}},common:q(k.common||{}),user:q(k.user||{}),impressionId:q(Z().generate()),...z}),Y=(0,r.MT)(V,{},(0,r.qC)((0,r.md)(i.Z,(e=>t=>n=>{var r;if(n.type!==M.LOG_EVENT)return t(n);const{dashboardInfo:i,explore:o,impressionId:s,dashboardLayout:a}=e.getState();let d={impression_id:s,version:"v2"};i?d={source:"dashboard",source_id:i.id,...d}:o&&(d={source:"explore",source_id:o.slice?o.slice.slice_id:0,...d});const{eventName:c}=n.payload;let{eventData:u={}}=n.payload;if(u={...d,ts:(new Date).getTime(),event_name:c,...u},j.TY.has(c)?u={...u,event_type:"timing",trigger_event:B}:(B=Z().generate(),u={...u,event_type:"user",event_id:B,visibility:document.visibilityState}),u.target_id&&null!=a&&null!=(r=a.present)&&r[u.target_id]){const{meta:e}=a.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return H.append(u),u})),(0,s.hU)(!1)))}}]);