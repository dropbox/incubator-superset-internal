{"version":3,"file":"26c317d9c3baa9529fe0.chunk.js","mappings":"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","sources":["webpack://superset/./src/filters/components/Select/SelectFilterPlugin.tsx","webpack://superset/./src/filters/components/common.ts","webpack://superset/./src/filters/utils.ts","webpack://superset/./node_modules/use-immer/dist/use-immer.module.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport {\n  AppSection,\n  DataMask,\n  DataRecordValue,\n  ensureIsArray,\n  ExtraFormData,\n  GenericDataType,\n  getColumnLabel,\n  JsonObject,\n  smartDateDetailedFormatter,\n  t,\n  tn,\n} from '@superset-ui/core';\nimport { LabeledValue as AntdLabeledValue } from 'antd/lib/select';\nimport React, { useCallback, useEffect, useState, useMemo } from 'react';\nimport { Select } from 'src/components';\nimport debounce from 'lodash/debounce';\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { useImmerReducer } from 'use-immer';\nimport { propertyComparator } from 'src/components/Select/Select';\nimport { PluginFilterSelectProps, SelectValue } from './types';\nimport { StyledFormItem, FilterPluginStyle, StatusMessage } from '../common';\nimport { getDataRecordFormatter, getSelectExtraFormData } from '../../utils';\n\ntype DataMaskAction =\n  | { type: 'ownState'; ownState: JsonObject }\n  | {\n      type: 'filterState';\n      __cache: JsonObject;\n      extraFormData: ExtraFormData;\n      filterState: { value: SelectValue; label?: string };\n    };\n\nfunction reducer(\n  draft: DataMask & { __cache?: JsonObject },\n  action: DataMaskAction,\n) {\n  switch (action.type) {\n    case 'ownState':\n      draft.ownState = {\n        ...draft.ownState,\n        ...action.ownState,\n      };\n      return draft;\n    case 'filterState':\n      draft.extraFormData = action.extraFormData;\n      // eslint-disable-next-line no-underscore-dangle\n      draft.__cache = action.__cache;\n      draft.filterState = { ...draft.filterState, ...action.filterState };\n      return draft;\n    default:\n      return draft;\n  }\n}\n\nexport default function PluginFilterSelect(props: PluginFilterSelectProps) {\n  const {\n    coltypeMap,\n    data,\n    filterState,\n    formData,\n    height,\n    isRefreshing,\n    width,\n    setDataMask,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    appSection,\n    showOverflow,\n    parentRef,\n    inputRef,\n  } = props;\n  const {\n    enableEmptyFilter,\n    multiSelect,\n    showSearch,\n    inverseSelection,\n    defaultToFirstItem,\n    searchAllOptions,\n  } = formData;\n  const groupby = useMemo(\n    () => ensureIsArray(formData.groupby).map(getColumnLabel),\n    [formData.groupby],\n  );\n  const [col] = groupby;\n  const [initialColtypeMap] = useState(coltypeMap);\n  const [dataMask, dispatchDataMask] = useImmerReducer(reducer, {\n    extraFormData: {},\n    filterState,\n  });\n  const datatype: GenericDataType = coltypeMap[col];\n  const labelFormatter = useMemo(\n    () =>\n      getDataRecordFormatter({\n        timeFormatter: smartDateDetailedFormatter,\n      }),\n    [],\n  );\n\n  const updateDataMask = useCallback(\n    (values: SelectValue) => {\n      const emptyFilter =\n        enableEmptyFilter && !inverseSelection && !values?.length;\n\n      const suffix = inverseSelection && values?.length ? t(' (excluded)') : '';\n\n      dispatchDataMask({\n        type: 'filterState',\n        __cache: filterState,\n        extraFormData: getSelectExtraFormData(\n          col,\n          values,\n          emptyFilter,\n          inverseSelection,\n        ),\n        filterState: {\n          ...filterState,\n          label: values?.length\n            ? `${(values || [])\n                .map(value => labelFormatter(value, datatype))\n                .join(', ')}${suffix}`\n            : undefined,\n          value:\n            appSection === AppSection.FILTER_CONFIG_MODAL && defaultToFirstItem\n              ? undefined\n              : values,\n        },\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      appSection,\n      col,\n      datatype,\n      defaultToFirstItem,\n      dispatchDataMask,\n      enableEmptyFilter,\n      inverseSelection,\n      JSON.stringify(filterState),\n      labelFormatter,\n    ],\n  );\n\n  useEffect(() => {\n    updateDataMask(filterState.value);\n  }, [JSON.stringify(filterState.value)]);\n\n  const isDisabled =\n    appSection === AppSection.FILTER_CONFIG_MODAL && defaultToFirstItem;\n\n  const debouncedOwnStateFunc = useCallback(\n    debounce((val: string) => {\n      dispatchDataMask({\n        type: 'ownState',\n        ownState: {\n          coltypeMap: initialColtypeMap,\n          search: val,\n        },\n      });\n    }, SLOW_DEBOUNCE),\n    [],\n  );\n\n  const searchWrapper = useCallback(\n    (val: string) => {\n      if (searchAllOptions) {\n        debouncedOwnStateFunc(val);\n      }\n    },\n    [debouncedOwnStateFunc, searchAllOptions],\n  );\n\n  const clearSuggestionSearch = useCallback(() => {\n    if (searchAllOptions) {\n      dispatchDataMask({\n        type: 'ownState',\n        ownState: {\n          coltypeMap: initialColtypeMap,\n          search: null,\n        },\n      });\n    }\n  }, [dispatchDataMask, initialColtypeMap, searchAllOptions]);\n\n  const handleBlur = useCallback(() => {\n    clearSuggestionSearch();\n    unsetFocusedFilter();\n  }, [clearSuggestionSearch, unsetFocusedFilter]);\n\n  const handleChange = useCallback(\n    (value?: SelectValue | number | string) => {\n      const values = value === null ? [null] : ensureIsArray(value);\n\n      if (values.length === 0) {\n        updateDataMask(null);\n      } else {\n        updateDataMask(values);\n      }\n    },\n    [updateDataMask],\n  );\n\n  useEffect(() => {\n    if (defaultToFirstItem && filterState.value === undefined) {\n      // initialize to first value if set to default to first item\n      const firstItem: SelectValue = data[0]\n        ? (groupby.map(col => data[0][col]) as string[])\n        : null;\n      // firstItem[0] !== undefined for a case when groupby changed but new data still not fetched\n      // TODO: still need repopulate default value in config modal when column changed\n      if (firstItem && firstItem[0] !== undefined) {\n        updateDataMask(firstItem);\n      }\n    } else if (isDisabled) {\n      // empty selection if filter is disabled\n      updateDataMask(null);\n    } else {\n      // reset data mask based on filter state\n      updateDataMask(filterState.value);\n    }\n  }, [\n    col,\n    isDisabled,\n    defaultToFirstItem,\n    enableEmptyFilter,\n    inverseSelection,\n    updateDataMask,\n    data,\n    groupby,\n    JSON.stringify(filterState),\n  ]);\n\n  useEffect(() => {\n    setDataMask(dataMask);\n  }, [JSON.stringify(dataMask)]);\n\n  const placeholderText =\n    data.length === 0\n      ? t('No data')\n      : tn('%s option', '%s options', data.length, data.length);\n\n  const formItemExtra = useMemo(() => {\n    if (filterState.validateMessage) {\n      return (\n        <StatusMessage status={filterState.validateStatus}>\n          {filterState.validateMessage}\n        </StatusMessage>\n      );\n    }\n    return undefined;\n  }, [filterState.validateMessage, filterState.validateStatus]);\n\n  const options = useMemo(() => {\n    const options: { label: string; value: DataRecordValue }[] = [];\n    data.forEach(row => {\n      const [value] = groupby.map(col => row[col]);\n      options.push({\n        label: labelFormatter(value, datatype),\n        value,\n      });\n    });\n    return options;\n  }, [data, datatype, groupby, labelFormatter]);\n\n  const sortComparator = useCallback(\n    (a: AntdLabeledValue, b: AntdLabeledValue) => {\n      const labelComparator = propertyComparator('label');\n      if (formData.sortAscending) {\n        return labelComparator(a, b);\n      }\n      return labelComparator(b, a);\n    },\n    [formData.sortAscending],\n  );\n\n  return (\n    <FilterPluginStyle height={height} width={width}>\n      <StyledFormItem\n        validateStatus={filterState.validateStatus}\n        extra={formItemExtra}\n      >\n        <Select\n          allowClear\n          allowNewOptions\n          // @ts-ignore\n          value={filterState.value || []}\n          disabled={isDisabled}\n          getPopupContainer={\n            showOverflow\n              ? () => parentRef?.current\n              : (trigger: HTMLElement) => trigger?.parentNode\n          }\n          showSearch={showSearch}\n          mode={multiSelect ? 'multiple' : 'single'}\n          placeholder={placeholderText}\n          onSearch={searchWrapper}\n          onSelect={clearSuggestionSearch}\n          onBlur={handleBlur}\n          onMouseEnter={setFocusedFilter}\n          onMouseLeave={unsetFocusedFilter}\n          // @ts-ignore\n          onChange={handleChange}\n          ref={inputRef}\n          loading={isRefreshing}\n          maxTagCount={5}\n          invertSelection={inverseSelection}\n          // @ts-ignore\n          options={options}\n          sortComparator={sortComparator}\n          onDropdownVisibleChange={setFilterActive}\n        />\n      </StyledFormItem>\n    </FilterPluginStyle>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { styled } from '@superset-ui/core';\nimport { PluginFilterStylesProps } from './types';\nimport FormItem from '../../components/Form/FormItem';\n\nexport const FilterPluginStyle = styled.div<PluginFilterStylesProps>`\n  min-height: ${({ height }) => height}px;\n  width: ${({ width }) => width}px;\n`;\n\nexport const StyledFormItem = styled(FormItem)`\n  &.ant-row.ant-form-item {\n    margin: 0;\n  }\n`;\n\nexport const StatusMessage = styled.div<{\n  status?: 'error' | 'warning' | 'info';\n}>`\n  color: ${({ theme, status = 'error' }) => theme.colors[status]?.base};\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataRecordValue,\n  GenericDataType,\n  NumberFormatter,\n  QueryObjectFilterClause,\n  TimeFormatter,\n  ExtraFormData,\n} from '@superset-ui/core';\nimport { FALSE_STRING, NULL_STRING, TRUE_STRING } from 'src/utils/common';\n\nexport const getSelectExtraFormData = (\n  col: string,\n  value?: null | (string | number | boolean | null)[],\n  emptyFilter = false,\n  inverseSelection = false,\n): ExtraFormData => {\n  const extra: ExtraFormData = {};\n  if (emptyFilter) {\n    extra.adhoc_filters = [\n      {\n        expressionType: 'SQL',\n        clause: 'WHERE',\n        sqlExpression: '1 = 0',\n      },\n    ];\n  } else if (value !== undefined && value !== null && value.length !== 0) {\n    extra.filters = [\n      {\n        col,\n        op: inverseSelection ? ('NOT IN' as const) : ('IN' as const),\n        // @ts-ignore\n        val: value,\n      },\n    ];\n  }\n  return extra;\n};\n\nexport const getRangeExtraFormData = (\n  col: string,\n  lower?: number | null,\n  upper?: number | null,\n) => {\n  const filters: QueryObjectFilterClause[] = [];\n  if (lower !== undefined && lower !== null && lower !== upper) {\n    filters.push({ col, op: '>=', val: lower });\n  }\n  if (upper !== undefined && upper !== null && upper !== lower) {\n    filters.push({ col, op: '<=', val: upper });\n  }\n  if (\n    upper !== undefined &&\n    upper !== null &&\n    lower !== undefined &&\n    lower !== null &&\n    upper === lower\n  ) {\n    filters.push({ col, op: '==', val: upper });\n  }\n\n  return filters.length\n    ? {\n        filters,\n      }\n    : {};\n};\n\nexport interface DataRecordValueFormatter {\n  (value: DataRecordValue, dtype: GenericDataType): string;\n}\n\nexport function getDataRecordFormatter({\n  timeFormatter,\n  numberFormatter,\n}: {\n  timeFormatter?: TimeFormatter;\n  numberFormatter?: NumberFormatter;\n} = {}): DataRecordValueFormatter {\n  return (value, dtype) => {\n    if (value === null || value === undefined) {\n      return NULL_STRING;\n    }\n    if (typeof value === 'boolean') {\n      return value ? TRUE_STRING : FALSE_STRING;\n    }\n    if (dtype === GenericDataType.BOOLEAN) {\n      try {\n        return JSON.parse(String(value).toLowerCase())\n          ? TRUE_STRING\n          : FALSE_STRING;\n      } catch {\n        return FALSE_STRING;\n      }\n    }\n    if (typeof value === 'string') {\n      return value;\n    }\n    if (timeFormatter && dtype === GenericDataType.TEMPORAL) {\n      return timeFormatter(value);\n    }\n    if (\n      numberFormatter &&\n      typeof value === 'number' &&\n      dtype === GenericDataType.NUMERIC\n    ) {\n      return numberFormatter(value);\n    }\n    return String(value);\n  };\n}\n","import n,{freeze as r}from\"immer\";import{useState as t,useCallback as o,useMemo as f,useReducer as u}from\"react\";function i(f){var u=t(function(){return r(\"function\"==typeof f?f():f,!0)}),i=u[1];return[u[0],o(function(t){i(\"function\"==typeof t?n(t):r(t))},[])]}function e(r,t,o){var i=f(function(){return n(r)},[r]);return u(i,t,o)}export{i as useImmer,e as useImmerReducer};\n//# sourceMappingURL=use-immer.module.js.map\n"],"names":["reducer","draft","action","type","ownState","extraFormData","__cache","filterState","PluginFilterSelect","props","coltypeMap","data","formData","height","isRefreshing","width","setDataMask","setFocusedFilter","unsetFocusedFilter","setFilterActive","appSection","showOverflow","parentRef","inputRef","enableEmptyFilter","multiSelect","showSearch","inverseSelection","defaultToFirstItem","searchAllOptions","groupby","useMemo","map","col","initialColtypeMap","useState","dataMask","dispatchDataMask","datatype","labelFormatter","timeFormatter","updateDataMask","useCallback","values","emptyFilter","length","suffix","t","label","value","join","undefined","JSON","stringify","useEffect","isDisabled","debouncedOwnStateFunc","val","search","searchWrapper","clearSuggestionSearch","handleBlur","handleChange","firstItem","placeholderText","tn","formItemExtra","validateMessage","status","validateStatus","options","forEach","row","push","sortComparator","a","b","labelComparator","sortAscending","extra","allowClear","allowNewOptions","disabled","getPopupContainer","current","trigger","parentNode","mode","placeholder","onSearch","onSelect","onBlur","onMouseEnter","onMouseLeave","onChange","ref","loading","maxTagCount","invertSelection","onDropdownVisibleChange","FilterPluginStyle","StyledFormItem","StatusMessage","theme","colors","base","getSelectExtraFormData","adhoc_filters","expressionType","clause","sqlExpression","filters","op","getRangeExtraFormData","lower","upper","getDataRecordFormatter","numberFormatter","dtype","parse","String","toLowerCase","i","f","u","e","r","o"],"sourceRoot":""}