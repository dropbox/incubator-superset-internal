{"version":3,"file":"92b5dd2bef5c7f4c0f0c.chunk.js","mappings":"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","sources":["webpack://superset/./packages/superset-ui-core/src/color/index.ts","webpack://superset/./packages/superset-ui-core/src/dimension/computeMaxFontSize.ts","webpack://superset/./packages/superset-ui-core/src/dimension/getTextDimension.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/LazyFactory.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/constants.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/createHiddenSvgNode.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/createTextNode.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/factories.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/getBBoxCeil.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/updateTextNode.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberViz.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/components/Echart.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport * as CategoricalColorNamespace from './CategoricalColorNamespace';\n\nexport { CategoricalColorNamespace };\nexport { default as CategoricalColorScale } from './CategoricalColorScale';\nexport { default as CategoricalScheme } from './CategoricalScheme';\nexport * from './CategoricalScheme';\nexport { default as getCategoricalSchemeRegistry } from './CategoricalSchemeRegistrySingleton';\nexport { default as ColorScheme } from './ColorScheme';\nexport * from './ColorScheme';\nexport { default as getSequentialSchemeRegistry } from './SequentialSchemeRegistrySingleton';\nexport { default as SequentialScheme } from './SequentialScheme';\nexport * from './SequentialScheme';\nexport { default as ColorSchemeRegistry } from './ColorSchemeRegistry';\nexport * from './colorSchemes';\nexport * from './utils';\nexport {\n  default as getSharedLabelColor,\n  SharedLabelColor,\n} from './SharedLabelColorSingleton';\n\nexport const BRAND_COLOR = '#00A699';\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport getTextDimension, { GetTextDimensionInput } from './getTextDimension';\nimport { Dimension } from './types';\n\nfunction decreaseSizeUntil(\n  startSize: number,\n  computeDimension: (size: number) => Dimension,\n  condition: (dimension: Dimension) => boolean,\n): number {\n  let size = startSize;\n  let dimension = computeDimension(size);\n\n  while (!condition(dimension)) {\n    size -= 1;\n\n    // Here if the size goes below zero most likely is because it\n    // has additional style applied in which case we assume the user\n    // knows what it's doing and we just let them use that.\n    // Visually it works, although it could have another\n    // check in place.\n    if (size < 0) {\n      size = startSize;\n      break;\n    }\n\n    dimension = computeDimension(size);\n  }\n\n  return size;\n}\n\nexport default function computeMaxFontSize(\n  input: GetTextDimensionInput & {\n    maxWidth?: number;\n    maxHeight?: number;\n    idealFontSize?: number;\n  },\n) {\n  const { idealFontSize, maxWidth, maxHeight, style, ...rest } = input;\n\n  let size: number;\n  if (idealFontSize !== undefined && idealFontSize !== null) {\n    size = idealFontSize;\n  } else if (maxHeight === undefined || maxHeight === null) {\n    throw new Error(\n      'You must specify at least one of maxHeight or idealFontSize',\n    );\n  } else {\n    size = Math.floor(maxHeight);\n  }\n\n  function computeDimension(fontSize: number) {\n    return getTextDimension({\n      ...rest,\n      style: { ...style, fontSize: `${fontSize}px` },\n    });\n  }\n\n  if (maxWidth !== undefined && maxWidth !== null) {\n    size = decreaseSizeUntil(\n      size,\n      computeDimension,\n      dim => dim.width > 0 && dim.width <= maxWidth,\n    );\n  }\n\n  if (maxHeight !== undefined && maxHeight !== null) {\n    size = decreaseSizeUntil(\n      size,\n      computeDimension,\n      dim => dim.height > 0 && dim.height <= maxHeight,\n    );\n  }\n\n  return size;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { TextStyle, Dimension } from './types';\nimport updateTextNode from './svg/updateTextNode';\nimport getBBoxCeil from './svg/getBBoxCeil';\nimport { hiddenSvgFactory, textFactory } from './svg/factories';\n\nexport interface GetTextDimensionInput {\n  className?: string;\n  container?: HTMLElement;\n  style?: TextStyle;\n  text: string;\n}\n\nexport default function getTextDimension(\n  input: GetTextDimensionInput,\n  defaultDimension?: Dimension,\n): Dimension {\n  const { text, className, style, container } = input;\n\n  // Empty string\n  if (text.length === 0) {\n    return { height: 0, width: 0 };\n  }\n\n  const svgNode = hiddenSvgFactory.createInContainer(container);\n  const textNode = textFactory.createInContainer(svgNode);\n  updateTextNode(textNode, { className, style, text });\n  const dimension = getBBoxCeil(textNode, defaultDimension);\n\n  // The nodes are added to the DOM briefly only to make getBBox works.\n  // (If not added to DOM getBBox will always return 0x0.)\n  // After that the svg nodes are not needed.\n  // We delay its removal in case there are subsequent calls to this function\n  // that can reuse the svg nodes.\n  // Experiments have shown that reusing existing nodes\n  // instead of deleting and adding new ones can save lot of time.\n  setTimeout(() => {\n    textFactory.removeFromContainer(svgNode);\n    hiddenSvgFactory.removeFromContainer(container);\n  }, 500);\n\n  return dimension;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport default class LazyFactory<T extends HTMLElement | SVGElement> {\n  private activeNodes = new Map<\n    HTMLElement | SVGElement,\n    {\n      counter: number;\n      node: T;\n    }\n  >();\n\n  private factoryFn: () => T;\n\n  constructor(factoryFn: () => T) {\n    this.factoryFn = factoryFn;\n  }\n\n  createInContainer(container: HTMLElement | SVGElement = document.body) {\n    if (this.activeNodes.has(container)) {\n      const entry = this.activeNodes.get(container)!;\n      entry.counter += 1;\n\n      return entry.node;\n    }\n\n    const node = this.factoryFn();\n    container.append(node);\n    this.activeNodes.set(container, { counter: 1, node });\n\n    return node;\n  }\n\n  removeFromContainer(container: HTMLElement | SVGElement = document.body) {\n    if (this.activeNodes.has(container)) {\n      const entry = this.activeNodes.get(container)!;\n      entry.counter -= 1;\n      if (entry.counter === 0) {\n        container.removeChild(entry.node);\n        this.activeNodes.delete(container);\n      }\n    }\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// eslint-disable-next-line import/prefer-default-export\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SVG_NS } from './constants';\n\nexport default function createHiddenSvgNode() {\n  const svgNode = document.createElementNS(SVG_NS, 'svg');\n  svgNode.style.position = 'absolute'; // so it won't disrupt page layout\n  svgNode.style.top = '-100%';\n  svgNode.style.left = '-100%';\n  svgNode.style.width = '0'; // no dimensions\n  svgNode.style.height = '0';\n  svgNode.style.opacity = '0'; // not visible\n  svgNode.style.pointerEvents = 'none'; // won't capture mouse events\n\n  return svgNode;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SVG_NS } from './constants';\n\nexport default function createTextNode() {\n  return document.createElementNS(SVG_NS, 'text');\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport LazyFactory from './LazyFactory';\nimport createHiddenSvgNode from './createHiddenSvgNode';\nimport createTextNode from './createTextNode';\n\nexport const hiddenSvgFactory = new LazyFactory(createHiddenSvgNode);\nexport const textFactory = new LazyFactory(createTextNode);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Dimension } from '../types';\n\nconst DEFAULT_DIMENSION = { height: 20, width: 100 };\n\nexport default function getBBoxCeil(\n  node: SVGGraphicsElement,\n  defaultDimension: Dimension = DEFAULT_DIMENSION,\n) {\n  const { width, height } = node.getBBox ? node.getBBox() : defaultDimension;\n\n  return {\n    height: Math.ceil(height),\n    width: Math.ceil(width),\n  };\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { TextStyle } from '../types';\n\nconst STYLE_FIELDS: (keyof TextStyle)[] = [\n  'font',\n  'fontWeight',\n  'fontStyle',\n  'fontSize',\n  'fontFamily',\n  'letterSpacing',\n];\n\nexport default function updateTextNode(\n  node: SVGTextElement,\n  {\n    className,\n    style = {},\n    text,\n  }: {\n    className?: string;\n    style?: TextStyle;\n    text?: string;\n  } = {},\n) {\n  const textNode = node;\n\n  if (textNode.textContent !== text) {\n    textNode.textContent = typeof text === 'undefined' ? null : text;\n  }\n  if (textNode.getAttribute('class') !== className) {\n    textNode.setAttribute('class', className ?? '');\n  }\n\n  // Clear style\n  // Note: multi-word property names are hyphenated and not camel-cased.\n  textNode.style.removeProperty('font');\n  textNode.style.removeProperty('font-weight');\n  textNode.style.removeProperty('font-style');\n  textNode.style.removeProperty('font-size');\n  textNode.style.removeProperty('font-family');\n  textNode.style.removeProperty('letter-spacing');\n\n  // Apply new style\n  // Note: the font field will auto-populate other font fields when applicable.\n  STYLE_FIELDS.filter(\n    (field: keyof TextStyle) =>\n      typeof style[field] !== 'undefined' && style[field] !== null,\n  ).forEach((field: keyof TextStyle) => {\n    textNode.style[field] = `${style[field]}`;\n  });\n\n  return textNode;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport {\n  t,\n  getNumberFormatter,\n  NumberFormatter,\n  smartDateVerboseFormatter,\n  TimeFormatter,\n  computeMaxFontSize,\n  BRAND_COLOR,\n  styled,\n} from '@superset-ui/core';\nimport { EChartsCoreOption } from 'echarts';\nimport Echart from '../components/Echart';\nimport { TimeSeriesDatum } from './types';\n\nconst defaultNumberFormatter = getNumberFormatter();\n\nconst PROPORTION = {\n  // text size: proportion of the chart container sans trendline\n  KICKER: 0.1,\n  HEADER: 0.3,\n  SUBHEADER: 0.125,\n  // trendline size: proportion of the whole chart container\n  TRENDLINE: 0.3,\n};\n\ntype BigNumberVisProps = {\n  className?: string;\n  width: number;\n  height: number;\n  bigNumber?: number | null;\n  bigNumberFallback?: TimeSeriesDatum;\n  headerFormatter: NumberFormatter | TimeFormatter;\n  formatTime: TimeFormatter;\n  headerFontSize: number;\n  kickerFontSize: number;\n  subheader: string;\n  subheaderFontSize: number;\n  showTimestamp?: boolean;\n  showTrendLine?: boolean;\n  startYAxisAtZero?: boolean;\n  timeRangeFixed?: boolean;\n  timestamp?: number;\n  trendLineData?: TimeSeriesDatum[];\n  mainColor: string;\n  echartOptions: EChartsCoreOption;\n};\n\nclass BigNumberVis extends React.PureComponent<BigNumberVisProps> {\n  static defaultProps = {\n    className: '',\n    headerFormatter: defaultNumberFormatter,\n    formatTime: smartDateVerboseFormatter,\n    headerFontSize: PROPORTION.HEADER,\n    kickerFontSize: PROPORTION.KICKER,\n    mainColor: BRAND_COLOR,\n    showTimestamp: false,\n    showTrendLine: false,\n    startYAxisAtZero: true,\n    subheader: '',\n    subheaderFontSize: PROPORTION.SUBHEADER,\n    timeRangeFixed: false,\n  };\n\n  getClassName() {\n    const { className, showTrendLine, bigNumberFallback } = this.props;\n    const names = `superset-legacy-chart-big-number ${className} ${\n      bigNumberFallback ? 'is-fallback-value' : ''\n    }`;\n    if (showTrendLine) return names;\n    return `${names} no-trendline`;\n  }\n\n  createTemporaryContainer() {\n    const container = document.createElement('div');\n    container.className = this.getClassName();\n    container.style.position = 'absolute'; // so it won't disrupt page layout\n    container.style.opacity = '0'; // and not visible\n    return container;\n  }\n\n  renderFallbackWarning() {\n    const { bigNumberFallback, formatTime, showTimestamp } = this.props;\n    if (!bigNumberFallback || showTimestamp) return null;\n    return (\n      <span\n        className=\"alert alert-warning\"\n        role=\"alert\"\n        title={t(\n          `Last available value seen on %s`,\n          formatTime(bigNumberFallback[0]),\n        )}\n      >\n        {t('Not up to date')}\n      </span>\n    );\n  }\n\n  renderKicker(maxHeight: number) {\n    const { timestamp, showTimestamp, formatTime, width } = this.props;\n    if (!showTimestamp) return null;\n\n    const text = timestamp === null ? '' : formatTime(timestamp);\n\n    const container = this.createTemporaryContainer();\n    document.body.append(container);\n    const fontSize = computeMaxFontSize({\n      text,\n      maxWidth: width,\n      maxHeight,\n      className: 'kicker',\n      container,\n    });\n    container.remove();\n\n    return (\n      <div\n        className=\"kicker\"\n        style={{\n          fontSize,\n          height: maxHeight,\n        }}\n      >\n        {text}\n      </div>\n    );\n  }\n\n  renderHeader(maxHeight: number) {\n    const { bigNumber, headerFormatter, width } = this.props;\n    const text = bigNumber === null ? t('No data') : headerFormatter(bigNumber);\n\n    const container = this.createTemporaryContainer();\n    document.body.append(container);\n    const fontSize = computeMaxFontSize({\n      text,\n      maxWidth: width - 8, // Decrease 8px for more precise font size\n      maxHeight,\n      className: 'header-line',\n      container,\n    });\n    container.remove();\n\n    return (\n      <div\n        className=\"header-line\"\n        style={{\n          fontSize,\n          height: maxHeight,\n        }}\n      >\n        {text}\n      </div>\n    );\n  }\n\n  renderSubheader(maxHeight: number) {\n    const { bigNumber, subheader, width, bigNumberFallback } = this.props;\n    let fontSize = 0;\n\n    const NO_DATA_OR_HASNT_LANDED = t(\n      'No data after filtering or data is NULL for the latest time record',\n    );\n    const NO_DATA = t(\n      'Try applying different filters or ensuring your datasource has data',\n    );\n    let text = subheader;\n    if (bigNumber === null) {\n      text = bigNumberFallback ? NO_DATA : NO_DATA_OR_HASNT_LANDED;\n    }\n    if (text) {\n      const container = this.createTemporaryContainer();\n      document.body.append(container);\n      fontSize = computeMaxFontSize({\n        text,\n        maxWidth: width,\n        maxHeight,\n        className: 'subheader-line',\n        container,\n      });\n      container.remove();\n\n      return (\n        <div\n          className=\"subheader-line\"\n          style={{\n            fontSize,\n            height: maxHeight,\n          }}\n        >\n          {text}\n        </div>\n      );\n    }\n    return null;\n  }\n\n  renderTrendline(maxHeight: number) {\n    const { width, trendLineData, echartOptions } = this.props;\n\n    // if can't find any non-null values, no point rendering the trendline\n    if (!trendLineData?.some(d => d[1] !== null)) {\n      return null;\n    }\n\n    return (\n      <Echart\n        width={Math.floor(width)}\n        height={maxHeight}\n        echartOptions={echartOptions}\n      />\n    );\n  }\n\n  render() {\n    const {\n      showTrendLine,\n      height,\n      kickerFontSize,\n      headerFontSize,\n      subheaderFontSize,\n    } = this.props;\n    const className = this.getClassName();\n\n    if (showTrendLine) {\n      const chartHeight = Math.floor(PROPORTION.TRENDLINE * height);\n      const allTextHeight = height - chartHeight;\n\n      return (\n        <div className={className}>\n          <div className=\"text-container\" style={{ height: allTextHeight }}>\n            {this.renderFallbackWarning()}\n            {this.renderKicker(\n              Math.ceil(kickerFontSize * (1 - PROPORTION.TRENDLINE) * height),\n            )}\n            {this.renderHeader(\n              Math.ceil(headerFontSize * (1 - PROPORTION.TRENDLINE) * height),\n            )}\n            {this.renderSubheader(\n              Math.ceil(\n                subheaderFontSize * (1 - PROPORTION.TRENDLINE) * height,\n              ),\n            )}\n          </div>\n          {this.renderTrendline(chartHeight)}\n        </div>\n      );\n    }\n\n    return (\n      <div className={className} style={{ height }}>\n        {this.renderFallbackWarning()}\n        {this.renderKicker(kickerFontSize * height)}\n        {this.renderHeader(Math.ceil(headerFontSize * height))}\n        {this.renderSubheader(Math.ceil(subheaderFontSize * height))}\n      </div>\n    );\n  }\n}\n\nexport default styled(BigNumberVis)`\n  ${({ theme }) => `\n    font-family: ${theme.typography.families.sansSerif};\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    &.no-trendline .subheader-line {\n      padding-bottom: 0.3em;\n    }\n\n    .text-container {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: flex-start;\n      .alert {\n        font-size: ${theme.typography.sizes.s};\n        margin: -0.5em 0 0.4em;\n        line-height: 1;\n        padding: ${theme.gridUnit}px;\n        border-radius: ${theme.gridUnit}px;\n      }\n    }\n\n    .kicker {\n      line-height: 1em;\n      padding-bottom: 2em;\n    }\n\n    .header-line {\n      position: relative;\n      line-height: 1em;\n      span {\n        position: absolute;\n        bottom: 0;\n      }\n    }\n\n    .subheader-line {\n      line-height: 1em;\n      padding-bottom: 0;\n    }\n\n    &.is-fallback-value {\n      .kicker,\n      .header-line,\n      .subheader-line {\n        opacity: ${theme.opacity.mediumHeavy};\n      }\n    }\n  `}\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useRef,\n  useEffect,\n  useMemo,\n  forwardRef,\n  useImperativeHandle,\n} from 'react';\nimport { styled } from '@superset-ui/core';\nimport { ECharts, init } from 'echarts';\nimport { EchartsHandler, EchartsProps, EchartsStylesProps } from '../types';\n\nconst Styles = styled.div<EchartsStylesProps>`\n  height: ${({ height }) => height};\n  width: ${({ width }) => width};\n`;\n\nfunction Echart(\n  {\n    width,\n    height,\n    echartOptions,\n    eventHandlers,\n    zrEventHandlers,\n    selectedValues = {},\n  }: EchartsProps,\n  ref: React.Ref<EchartsHandler>,\n) {\n  const divRef = useRef<HTMLDivElement>(null);\n  const chartRef = useRef<ECharts>();\n  const currentSelection = useMemo(\n    () => Object.keys(selectedValues) || [],\n    [selectedValues],\n  );\n  const previousSelection = useRef<string[]>([]);\n\n  useImperativeHandle(ref, () => ({\n    getEchartInstance: () => chartRef.current,\n  }));\n\n  useEffect(() => {\n    if (!divRef.current) return;\n    if (!chartRef.current) {\n      chartRef.current = init(divRef.current);\n    }\n\n    Object.entries(eventHandlers || {}).forEach(([name, handler]) => {\n      chartRef.current?.off(name);\n      chartRef.current?.on(name, handler);\n    });\n\n    Object.entries(zrEventHandlers || {}).forEach(([name, handler]) => {\n      chartRef.current?.getZr().off(name);\n      chartRef.current?.getZr().on(name, handler);\n    });\n\n    chartRef.current.setOption(echartOptions, true);\n  }, [echartOptions, eventHandlers, zrEventHandlers]);\n\n  // highlighting\n  useEffect(() => {\n    if (!chartRef.current) return;\n    chartRef.current.dispatchAction({\n      type: 'downplay',\n      dataIndex: previousSelection.current.filter(\n        value => !currentSelection.includes(value),\n      ),\n    });\n    if (currentSelection.length) {\n      chartRef.current.dispatchAction({\n        type: 'highlight',\n        dataIndex: currentSelection,\n      });\n    }\n    previousSelection.current = currentSelection;\n  }, [currentSelection]);\n\n  useEffect(() => {\n    if (chartRef.current) {\n      chartRef.current.resize({ width, height });\n    }\n  }, [width, height]);\n\n  return <Styles ref={divRef} height={height} width={width} />;\n}\n\nexport default forwardRef(Echart);\n"],"names":["BRAND_COLOR","decreaseSizeUntil","startSize","computeDimension","condition","size","dimension","computeMaxFontSize","input","idealFontSize","maxWidth","maxHeight","style","rest","Error","Math","floor","fontSize","dim","width","height","getTextDimension","defaultDimension","text","className","container","length","svgNode","textNode","setTimeout","LazyFactory","constructor","factoryFn","activeNodes","Map","this","createInContainer","document","body","has","entry","get","counter","node","append","set","removeFromContainer","removeChild","delete","SVG_NS","createHiddenSvgNode","createElementNS","position","top","left","opacity","pointerEvents","createTextNode","hiddenSvgFactory","textFactory","DEFAULT_DIMENSION","getBBoxCeil","getBBox","ceil","STYLE_FIELDS","updateTextNode","textContent","getAttribute","setAttribute","removeProperty","filter","field","forEach","defaultNumberFormatter","PROPORTION","BigNumberVis","getClassName","showTrendLine","bigNumberFallback","props","names","createTemporaryContainer","createElement","renderFallbackWarning","formatTime","showTimestamp","role","title","t","renderKicker","timestamp","remove","renderHeader","bigNumber","headerFormatter","renderSubheader","subheader","NO_DATA_OR_HASNT_LANDED","NO_DATA","renderTrendline","trendLineData","echartOptions","some","d","render","kickerFontSize","headerFontSize","subheaderFontSize","chartHeight","allTextHeight","defaultProps","mainColor","startYAxisAtZero","timeRangeFixed","theme","typography","families","sansSerif","sizes","s","gridUnit","mediumHeavy","Styles","Echart","eventHandlers","zrEventHandlers","selectedValues","ref","divRef","useRef","chartRef","currentSelection","useMemo","Object","keys","previousSelection","useImperativeHandle","getEchartInstance","current","useEffect","entries","name","handler","off","on","getZr","setOption","dispatchAction","type","dataIndex","value","includes","resize","forwardRef"],"sourceRoot":""}