(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{178:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(77),l=a.n(n),o=a(51),i=a(1135);const s=Object(o.c)(i.a)`
  .ant-radio-inner {
    top: -1px;
    left: 2px;
    width: ${({theme:e})=>4*e.gridUnit}px;
    height: ${({theme:e})=>4*e.gridUnit}px;
    border-width: 2px;
    border-color: ${({theme:e})=>e.colors.grayscale.light2};
  }

  .ant-radio.ant-radio-checked {
    .ant-radio-inner {
      border-width: ${({theme:e})=>e.gridUnit+1}px;
      border-color: ${({theme:e})=>e.colors.primary.base};
    }

    .ant-radio-inner::after {
      background-color: ${({theme:e})=>e.colors.grayscale.light5};
      top: 0;
      left: 0;
      width: ${({theme:e})=>e.gridUnit+2}px;
      height: ${({theme:e})=>e.gridUnit+2}px;
    }
  }

  .ant-radio:hover,
  .ant-radio:focus {
    .ant-radio-inner {
      border-color: ${({theme:e})=>e.colors.primary.dark1};
    }
  }
`,c=Object(o.c)(i.a.Group)`
  font-size: inherit;
`,r=l()(s,{Group:c})},2101:function(e,t,a){"use strict";a.r(t);a(40);var n=a(69),l=a.n(n),o=a(36),i=a.n(o),s=a(56),c=a.n(s),r=a(11),d=a.n(r),h=a(12),b=a.n(h),u=a(34),p=a.n(u),m=a(29),f=a.n(m),g=a(0),O=a.n(g),j=a(2),y=a.n(j),C=a(4479),v=a(1079),S=a(178),x=a(195),E=a(259),_=a(93),w=a.n(_),T=a(51),k=a(16),D=a(68),I=a(42),M=a(134),N=a(1699),L=a(1701),P=a(46),F=a(124),K=a(140),A=a(1700),R=a(810),q=a(70),$=a(479),U=a(349),B=a(536),G=a(1139),z=a(1145),H=a(1146),W=a(31),Q=a.n(W),J=a(44),V=a.n(J),X=a(252),Y=a.n(X),Z=a(857),ee=a(4480);function te(e,t,a){var n;return d()(n=O.a.Children).call(n,e,e=>{let n=e;return e&&e.type.name===t.name&&(n=O.a.cloneElement(e,a(e))),n&&n.props.children&&(n=O.a.cloneElement(n,{children:te(n.props.children,t,a)})),n})}var ae=a(741),ne=a(706),le=a(61),oe=a(86),ie=a(80),se=a(5),ce=a.n(se),re=a(50),de=function(e){function t(){return e.apply(this,arguments)||this}return Object(ie.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=Object(oe.a)(e,["className"]),n=Object(re.f)(a),l=n[0],o=n[1],i=Object(re.d)(l);return O.a.createElement("span",Object(le.a)({},o,{className:ce()(t,i)}))},t}(O.a.Component),he=Object(re.a)("help-block",de),be=a(54),ue=a(94),pe=(a(4676),a(1));const me={value:y.a.any,label:y.a.string.isRequired,description:y.a.node,fieldKey:y.a.string.isRequired,control:y.a.node.isRequired,onChange:y.a.func,compact:y.a.bool};class fe extends O.a.PureComponent{constructor(e){var t;super(e),this.onChange=b()(t=this.onChange).call(t,this)}onChange(e){this.props.onChange(this.props.fieldKey,e)}render(){const{compact:e,value:t,label:a,control:n,description:l,fieldKey:o}=this.props,i=O.a.cloneElement(n,{value:t,onChange:this.onChange});return Object(pe.f)(ae.a,{controlId:o},Object(pe.f)(ue.a,{className:"m-r-5"},a||o,e&&l&&Object(pe.f)(be.a,{id:"field-descr",placement:"right",title:l},Object(pe.f)("i",{className:"fa fa-info-circle m-l-5"})))," ",i,Object(pe.f)(ne.a.Feedback,null),!e&&l&&Object(pe.f)(he,null,l))}}fe.propTypes=me,fe.defaultProps={onChange:()=>{},compact:!1,description:null};const ge={children:y.a.node.isRequired,onChange:y.a.func,item:y.a.object,title:y.a.node,compact:y.a.bool};class Oe extends O.a.PureComponent{constructor(e){var t;super(e),this.onChange=b()(t=this.onChange).call(t,this)}onChange(e,t){return this.props.onChange({...this.props.item,[e]:t})}render(){const{title:e}=this.props;return Object(pe.f)(ee.a,{componentClass:"fieldset",className:"CRUD"},e&&Object(pe.f)("legend",null,e),te(this.props.children,fe,e=>({onChange:this.onChange,value:this.props.item[e.props.fieldKey],compact:this.props.compact})))}}function je(e){const t=d()(e).call(e,e=>({...e,id:e.id||w.a.generate()})),a={};return f()(t).call(t,e=>{a[e.id]=e}),a}Oe.propTypes=ge,Oe.defaultProps={compact:!1,title:null};const ye=T.c.div`
  ${({stickyHeader:e})=>e&&"\n      height: 350px;\n      overflow: auto;\n\n      thead th {\n        background: #fff;\n        position: sticky;\n        top: 0;\n        z-index: 9;\n      }\n    "}
`,Ce=T.c.div`
  text-align: right;
  ${({theme:e})=>`margin-bottom: ${2*e.gridUnit}px`}
`;class ve extends O.a.PureComponent{constructor(e){var t,a,n,l,o,i,s;super(e),this.state={expandedColumns:{},collection:je(e.collection)},this.renderItem=b()(t=this.renderItem).call(t,this),this.onAddItem=b()(a=this.onAddItem).call(a,this),this.renderExpandableSection=b()(n=this.renderExpandableSection).call(n,this),this.getLabel=b()(l=this.getLabel).call(l,this),this.onFieldsetChange=b()(o=this.onFieldsetChange).call(o,this),this.renderTableBody=b()(i=this.renderTableBody).call(i,this),this.changeCollection=b()(s=this.changeCollection).call(s,this)}UNSAFE_componentWillReceiveProps(e){e.collection!==this.props.collection&&this.setState({collection:je(e.collection)})}onCellChange(e,t,a){this.changeCollection({...this.state.collection,[e]:{...this.state.collection[e],[t]:a}})}onAddItem(){if(this.props.itemGenerator){let e=this.props.itemGenerator();e.id||(e={...e,id:w.a.generate()}),this.changeCollection({...this.state.collection,[e.id]:e})}}onFieldsetChange(e){this.changeCollection({...this.state.collection,[e.id]:e})}getLabel(e){const{columnLabels:t}=this.props;let a=t&&t[e]?t[e]:e;return Y()(a).call(a,"__")&&(a=""),a}changeCollection(e){var t;(this.setState({collection:e}),this.props.onChange)&&this.props.onChange(d()(t=V()(e)).call(t,t=>e[t]))}deleteItem(e){const t={...this.state.collection};delete t[e],this.changeCollection(t)}effectiveTableColumns(){var e;const{tableColumns:t,allowDeletes:a,expandFieldset:n}=this.props,o=a?l()(t).call(t,["__actions"]):t;return n?l()(e=["__expand"]).call(e,o):o}toggleExpand(e){this.onCellChange(e,"__expanded",!1),this.setState(t=>({expandedColumns:{...t.expandedColumns,[e]:!t.expandedColumns[e]}}))}renderHeaderRow(){const e=this.effectiveTableColumns(),{allowDeletes:t,expandFieldset:a,extraButtons:n}=this.props;return Object(pe.f)("thead",null,Object(pe.f)("tr",null,a&&Object(pe.f)("th",{"aria-label":"Expand",className:"tiny-cell"}),d()(e).call(e,e=>Object(pe.f)("th",{key:e},this.getLabel(e))),n,t&&Object(pe.f)("th",{key:"delete-item","aria-label":"Delete",className:"tiny-cell"})))}renderExpandableSection(e){return te(this.props.expandFieldset,Oe,()=>({item:e,onChange:this.onFieldsetChange}))}renderCell(e,t){var a;const n=this.props.itemRenderers&&this.props.itemRenderers[t],l=e[t],o=b()(a=this.onCellChange).call(a,this,e.id,t);return n?n(l,o,this.getLabel(t),e):l}renderItem(e){const{allowAddItem:t,allowDeletes:a,expandFieldset:n,tableColumns:o}=this.props,i=!!this.state.expandedColumns[e.id]||e.__expanded;let s=[];var c,r;n&&s.push(Object(pe.f)("td",{key:"__expand",className:"expand"},Object(pe.f)("i",{role:"button","aria-label":"Toggle expand",tabIndex:0,className:`fa fa-caret-${i?"down":"right"} text-primary pointer`,onClick:b()(c=this.toggleExpand).call(c,this,e.id)})));(s=l()(s).call(s,d()(o).call(o,t=>Object(pe.f)("td",{key:t},this.renderCell(e,t)))),t&&s.push(Object(pe.f)("td",{key:"add"})),a)&&s.push(Object(pe.f)("td",{key:"__actions",className:"text-primary"},Object(pe.f)(Z.a.Trash,{"aria-label":"Delete item",className:"pointer",iconSize:"m",role:"button",tabIndex:0,onClick:b()(r=this.deleteItem).call(r,this,e.id)})));const h=[Object(pe.f)("tr",Q()({"data-test":"table-row"},{className:"row",key:e.id}),s)];return i&&h.push(Object(pe.f)("tr",{className:"exp",key:`exp__${e.id}`},Object(pe.f)("td",{colSpan:this.effectiveTableColumns().length,className:"expanded"},Object(pe.f)("div",null,this.renderExpandableSection(e))))),h}renderEmptyCell(){return Object(pe.f)("tr",null,Object(pe.f)("td",{className:"empty-collection"},this.props.emptyMessage))}renderTableBody(){var e;const t=d()(e=V()(this.state.collection)).call(e,e=>this.state.collection[e]),a=t.length?d()(t).call(t,e=>this.renderItem(e)):this.renderEmptyCell();return Object(pe.f)("tbody",null,a)}render(){return Object(pe.f)(O.a.Fragment,null,Object(pe.f)(Ce,null,this.props.allowAddItem&&Object(pe.f)("span",{className:"m-t-10 m-r-10"},Object(pe.f)(I.a,{buttonSize:"small",buttonStyle:"primary",onClick:this.onAddItem},Object(pe.f)("i",{className:"fa fa-plus"})," ",Object(k.e)("Add item")))),Object(pe.f)(ye,{className:"CRUD",stickyHeader:this.props.stickyHeader},Object(pe.f)("table",{className:"table"},this.renderHeaderRow(),this.renderTableBody())))}}var Se=a(120),xe=a(41);const Ee=T.c.div`
  .change-warning {
    margin: 16px 10px 0;
    color: ${({theme:e})=>e.colors.warning.base};
  }

  .change-warning .bold {
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }

  .form-group.has-feedback > .help-block {
    margin-top: 8px;
  }

  .form-group.form-group-md {
    margin-bottom: 8px;
  }
`,_e=T.c.div`
  align-items: center;
  display: flex;

  > svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,we=T.c.div`
  font-size: ${T.d.typography.sizes.s}px;
  display: flex;
  align-items: center;
  a {
    padding: 0 10px;
  }
`,Te=T.c.div`
  text-align: right;
  ${({theme:e})=>`margin-bottom: ${2*e.gridUnit}px`}
`,ke=(e,t)=>Object(pe.f)($.a,{value:e,onChange:t}),De=["STRING","NUMERIC","DATETIME"],Ie=[{key:"physical",label:Object(k.e)("Physical (table or view)")},{key:"virtual",label:Object(k.e)("Virtual (SQL)")}],Me={};function Ne({title:e,collection:t}){return Object(pe.f)("div",null,e," ",Object(pe.f)(E.a,{count:t?t.length:0,showZero:!0}))}function Le({columns:e,onChange:t,editableColumnName:a,showExpression:n,allowAddItem:l,allowEditDataType:o,itemGenerator:i}){return Object(pe.f)(ve,{collection:e,tableColumns:["column_name","type","is_dttm","filterable","groupby"],allowDeletes:!0,allowAddItem:l,itemGenerator:i,stickyHeader:!0,expandFieldset:Object(pe.f)(Fe,null,Object(pe.f)(Oe,{compact:!0},n&&Object(pe.f)(fe,{fieldKey:"expression",label:Object(k.e)("SQL expression"),control:Object(pe.f)(G.a,{language:"markdown",offerEditInModal:!1})}),Object(pe.f)(fe,{fieldKey:"verbose_name",label:Object(k.e)("Label"),control:Object(pe.f)(U.a,{controlId:"verbose_name",placeholder:Object(k.e)("Label")})}),Object(pe.f)(fe,{fieldKey:"description",label:Object(k.e)("Description"),control:Object(pe.f)(U.a,{controlId:"description",placeholder:Object(k.e)("Description")})}),o&&Object(pe.f)(fe,{fieldKey:"type",label:Object(k.e)("Data type"),control:Object(pe.f)(B.a,{choices:De,name:"type",freeForm:!0})}),Object(pe.f)(fe,{fieldKey:"python_date_format",label:Object(k.e)("Datetime format"),description:Object(pe.f)("div",null,Object(k.e)("The pattern of timestamp format. For strings use "),Object(pe.f)("a",{href:"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior"},Object(k.e)("Python datetime string pattern")),Object(k.e)(" expression which needs to adhere to the "),Object(pe.f)("a",{href:"https://en.wikipedia.org/wiki/ISO_8601"},Object(k.e)("ISO 8601")),Object(k.e)(" standard to ensure that the lexicographical ordering\n                      coincides with the chronological ordering. If the\n                      timestamp format does not adhere to the ISO 8601 standard\n                      you will need to define an expression and type for\n                      transforming the string into a date or timestamp. Note\n                      currently time zones are not supported. If time is stored\n                      in epoch format, put `epoch_s` or `epoch_ms`. If no pattern\n                      is specified we fall back to using the optional defaults on a per\n                      database/column name level via the extra parameter.")),control:Object(pe.f)(U.a,{controlId:"python_date_format",placeholder:"%Y/%m/%d"})}))),columnLabels:{column_name:Object(k.e)("Column"),type:Object(k.e)("Data type"),groupby:Object(k.e)("Is dimension"),is_dttm:Object(k.e)("Is temporal"),filterable:Object(k.e)("Is filterable")},onChange:t,itemRenderers:{column_name:(e,t)=>a?Object(pe.f)(R.a,{canEdit:!0,title:e,onSaveTitle:t}):e,type:e=>Object(pe.f)(F.a,null,e),is_dttm:ke,filterable:ke,groupby:ke}})}function Pe({label:e,formElement:t}){return Object(pe.f)("div",null,Object(pe.f)("div",null,Object(pe.f)("strong",null,e)),Object(pe.f)("div",null,t))}function Fe({children:e}){return Object(pe.f)(C.a,{style:{marginTop:20}},e)}f()(Ie).call(Ie,e=>{Me[e.key]=e}),Ne.propTypes={title:y.a.string,collection:y.a.array},Le.propTypes={columns:y.a.array.isRequired,onChange:y.a.func.isRequired,editableColumnName:y.a.bool,showExpression:y.a.bool,allowAddItem:y.a.bool,allowEditDataType:y.a.bool,itemGenerator:y.a.func},Le.defaultProps={editableColumnName:!1,showExpression:!1,allowAddItem:!1,allowEditDataType:!1,itemGenerator:()=>({column_name:"<new column>",filterable:!0,groupby:!0})},Pe.propTypes={label:y.a.string,formElement:y.a.node},Fe.propTypes={children:y.a.node};const Ke={datasource:y.a.object.isRequired,onChange:y.a.func,addSuccessToast:y.a.func.isRequired,addDangerToast:y.a.func.isRequired};class Ae extends O.a.PureComponent{constructor(e){var t,a,n,l,o,i,s,c,r,d;super(e),this.state={datasource:e.datasource,errors:[],isDruid:"druid"===e.datasource.type||"druid"===e.datasource.datasource_type,isSqla:"table"===e.datasource.datasource_type||"table"===e.datasource.type,isEditMode:!1,databaseColumns:p()(t=e.datasource.columns).call(t,e=>!e.expression),calculatedColumns:p()(a=e.datasource.columns).call(a,e=>!!e.expression),metadataLoading:!1,activeTabKey:0,datasourceType:e.datasource.sql?Me.virtual.key:Me.physical.key},this.onChange=b()(n=this.onChange).call(n,this),this.onChangeEditMode=b()(l=this.onChangeEditMode).call(l,this),this.onDatasourcePropChange=b()(o=this.onDatasourcePropChange).call(o,this),this.onDatasourceChange=b()(i=this.onDatasourceChange).call(i,this),this.syncMetadata=b()(s=this.syncMetadata).call(s,this),this.setColumns=b()(c=this.setColumns).call(c,this),this.validateAndChange=b()(r=this.validateAndChange).call(r,this),this.handleTabSelect=b()(d=this.handleTabSelect).call(d,this),this.allowEditSource=!Object(xe.c)(xe.a.DISABLE_DATASET_SOURCE_EDIT)}onChange(){const{datasourceType:e,datasource:t}=this.state,a=e===Me.physical.key?"":t.sql,n={...this.state.datasource,sql:a,columns:[...this.state.databaseColumns,...this.state.calculatedColumns]};this.props.onChange(n,this.state.errors)}onChangeEditMode(){this.setState(e=>({isEditMode:!e.isEditMode}))}onDatasourceChange(e){this.setState({datasource:e},this.validateAndChange)}onDatasourcePropChange(e,t){const a={...this.state.datasource,[e]:t};this.setState(a=>({datasource:{...a.datasource,[e]:t}}),this.onDatasourceChange(a))}onDatasourceTypeChange(e){this.setState({datasourceType:e})}setColumns(e){this.setState(e,this.validateAndChange)}validateAndChange(){this.validate(this.onChange)}updateColumns(e){var t;const{databaseColumns:a}=this.state,n=d()(e).call(e,e=>e.name),l=c()(a).call(a,(e,t)=>({...e,[t.column_name]:t}),{}),o=[],s={added:[],modified:[],removed:p()(t=d()(a).call(a,e=>e.column_name)).call(t,e=>!i()(n).call(n,e))};return f()(e).call(e,e=>{const t=l[e.name];t?t.type!==e.type?(o.push({...t,type:e.type}),s.modified.push(e.name)):o.push(t):(o.push({id:w.a.generate(),column_name:e.name,type:e.type,groupby:!0,filterable:!0}),s.added.push(e.name))}),(s.added.length||s.modified.length||s.removed.length)&&this.setColumns({databaseColumns:o}),s}syncMetadata(){const{datasource:e}=this.state,t=`/datasource/external_metadata/${e.type||e.datasource_type}/${e.id}/`;this.setState({metadataLoading:!0}),D.a.get({endpoint:t}).then(({json:e})=>{const t=this.updateColumns(e);t.modified.length&&this.props.addSuccessToast(Object(k.e)("Modified columns: %s",t.modified.join(", "))),t.removed.length&&this.props.addSuccessToast(Object(k.e)("Removed columns: %s",t.removed.join(", "))),t.added.length&&this.props.addSuccessToast(Object(k.e)("New columns added: %s",t.added.join(", "))),this.props.addSuccessToast(Object(k.e)("Metadata has been synced")),this.setState({metadataLoading:!1})}).catch(e=>Object(q.a)(e).then(({error:e,statusText:t})=>{this.props.addDangerToast(e||t||Object(k.e)("An error has occurred")),this.setState({metadataLoading:!1})}))}findDuplicates(e,t){const a={},n=[];return f()(e).call(e,e=>{const l=t(e);l in a?n.push(l):a[l]=null}),n}validate(e){var t;let a,n=[];const{datasource:o}=this.state;a=this.findDuplicates(o.columns,e=>e.column_name),n=l()(n).call(n,d()(a).call(a,e=>Object(k.e)("Column name [%s] is duplicated",e))),a=this.findDuplicates(o.metrics,e=>e.metric_name),n=l()(n).call(n,d()(a).call(a,e=>Object(k.e)("Metric name [%s] is duplicated",e)));const i=p()(t=this.state.calculatedColumns).call(t,e=>!e.expression&&!e.json);n=l()(n).call(n,d()(i).call(i,e=>Object(k.e)("Calculated column [%s] requires an expression",e.column_name))),this.setState({errors:n},e)}handleTabSelect(e){this.setState({activeTabKey:e})}renderSettingsFieldset(){const{datasource:e}=this.state;return Object(pe.f)(Oe,{title:Object(k.e)("Basic"),item:e,onChange:this.onDatasourceChange},Object(pe.f)(fe,{fieldKey:"description",label:Object(k.e)("Description"),control:Object(pe.f)(G.a,{language:"markdown",offerEditInModal:!1})}),Object(pe.f)(fe,{fieldKey:"default_endpoint",label:Object(k.e)("Default URL"),description:Object(k.e)("Default URL to redirect to when accessing from the dataset list page"),control:Object(pe.f)(U.a,{controlId:"default_endpoint"})}),Object(pe.f)(fe,{fieldKey:"filter_select_enabled",label:Object(k.e)("Autocomplete filters"),description:Object(k.e)("Whether to populate autocomplete filters options"),control:Object(pe.f)($.a,null)}),this.state.isSqla&&Object(pe.f)(fe,{fieldKey:"fetch_values_predicate",label:Object(k.e)("Autocomplete query predicate"),description:Object(k.e)('When using "Autocomplete filters", this can be used to improve performance of the query fetching the values. Use this option to apply a predicate (WHERE clause) to the query selecting the distinct values from the table. Typically the intent would be to limit the scan by applying a relative time filter on a partitioned or indexed time-related field.'),control:Object(pe.f)(U.a,{controlId:"fetch_values_predicate"})}),this.state.isSqla&&Object(pe.f)(fe,{fieldKey:"extra",label:Object(k.e)("Extra"),description:Object(k.e)('Extra data to specify table metadata. Currently supports certification data of the format: `{ "certification": { "certified_by": "Data Platform Team", "details": "This table is the source of truth." } }`.'),control:Object(pe.f)(G.a,{controlId:"extra",language:"json",offerEditInModal:!1})}),Object(pe.f)(fe,{fieldKey:"owners",label:Object(k.e)("Owners"),description:Object(k.e)("Owners of the dataset"),control:Object(pe.f)(z.a,{dataEndpoint:"api/v1/dataset/related/owners",multi:!0,mutator:e=>{var t;return d()(t=e.result).call(t,e=>({value:e.value,label:`${e.text}`}))}}),controlProps:{}}))}renderAdvancedFieldset(){const{datasource:e}=this.state;return Object(pe.f)(Oe,{title:Object(k.e)("Advanced"),item:e,onChange:this.onDatasourceChange},Object(pe.f)(fe,{fieldKey:"cache_timeout",label:Object(k.e)("Cache timeout"),description:Object(k.e)("The duration of time in seconds before the cache is invalidated"),control:Object(pe.f)(U.a,{controlId:"cache_timeout"})}),Object(pe.f)(fe,{fieldKey:"offset",label:Object(k.e)("Hours offset"),control:Object(pe.f)(U.a,{controlId:"offset"}),description:Object(k.e)("The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.")}),this.state.isSqla&&Object(pe.f)(fe,{fieldKey:"template_params",label:Object(k.e)("Template parameters"),description:Object(k.e)("A set of parameters that become available in the query using Jinja templating syntax"),control:Object(pe.f)(U.a,{controlId:"template_params"})}))}renderSpatialTab(){var e;const{datasource:t}=this.state,{spatials:a,all_cols:n}=t;return Object(pe.f)(M.c.TabPane,{tab:Object(pe.f)(Ne,{collection:a,title:Object(k.e)("Spatial")}),key:4},Object(pe.f)(ve,{tableColumns:["name","config"],onChange:b()(e=this.onDatasourcePropChange).call(e,this,"spatials"),itemGenerator:()=>({name:"<new spatial>",type:"<no type>",config:null}),collection:a,allowDeletes:!0,itemRenderers:{name:(e,t)=>Object(pe.f)(R.a,{canEdit:!0,title:e,onSaveTitle:t}),config:(e,t)=>Object(pe.f)(H.a,{value:e,onChange:t,choices:n})}}))}renderSourceFieldset(){const{datasource:e}=this.state;return Object(pe.f)("div",null,Object(pe.f)("div",{className:"m-l-10 m-t-20 m-b-10"},d()(Ie).call(Ie,e=>{var t;return Object(pe.f)(S.a,{key:e.key,value:e.key,inline:!0,onChange:b()(t=this.onDatasourceTypeChange).call(t,this,e.key),checked:this.state.datasourceType===e.key,disabled:!this.state.isEditMode},e.label)})),Object(pe.f)("hr",null),Object(pe.f)(Oe,{item:e,onChange:this.onDatasourceChange,compact:!0},this.state.datasourceType===Me.virtual.key&&Object(pe.f)("div",null,this.state.isSqla&&Object(pe.f)(O.a.Fragment,null,Object(pe.f)(fe,{fieldKey:"databaseSelector",label:Object(k.e)("virtual"),control:Object(pe.f)(L.a,{dbId:e.database.id,schema:e.schema,onSchemaChange:e=>this.state.isEditMode&&this.onDatasourcePropChange("schema",e),onDbChange:e=>this.state.isEditMode&&this.onDatasourcePropChange("database",e),formMode:!1,handleError:this.props.addDangerToast,readOnly:!this.state.isEditMode})}),Object(pe.f)(fe,{fieldKey:"table_name",label:Object(k.e)("Dataset name"),control:Object(pe.f)(U.a,{controlId:"table_name",onChange:e=>{this.onDatasourcePropChange("table_name",e)},placeholder:Object(k.e)("Dataset name"),disabled:!this.state.isEditMode})}),Object(pe.f)(fe,{fieldKey:"sql",label:Object(k.e)("SQL"),description:Object(k.e)("When specifying SQL, the datasource acts as a view. Superset will use this statement as a subquery while grouping and filtering on the generated parent queries."),control:Object(pe.f)(G.a,{language:"sql",offerEditInModal:!1,minLines:20,maxLines:20,readOnly:!this.state.isEditMode})})),this.state.isDruid&&Object(pe.f)(fe,{fieldKey:"json",label:Object(k.e)("JSON"),description:Object(pe.f)("div",null,Object(k.e)("The JSON metric or post aggregation definition.")),control:Object(pe.f)(G.a,{language:"json",offerEditInModal:!1})})),this.state.datasourceType===Me.physical.key&&Object(pe.f)(v.a,{md:6},this.state.isSqla&&Object(pe.f)(fe,{fieldKey:"tableSelector",label:Object(k.e)("Physical"),control:Object(pe.f)(A.a,{clearable:!1,dbId:e.database.id,handleError:this.props.addDangerToast,schema:e.schema,sqlLabMode:!1,tableName:e.table_name,onSchemaChange:this.state.isEditMode?e=>this.onDatasourcePropChange("schema",e):void 0,onDbChange:this.state.isEditMode?e=>this.onDatasourcePropChange("database",e):void 0,onTableChange:this.state.isEditMode?e=>this.onDatasourcePropChange("table_name",e):void 0,readOnly:!this.state.isEditMode}),description:Object(k.e)("The pointer to a physical table (or view). Keep in mind that the chart is associated to this Superset logical table, and this logical table points the physical table referenced here.")}))),this.allowEditSource&&Object(pe.f)(we,null,Object(pe.f)("span",{role:"button",tabIndex:0,onClick:this.onChangeEditMode},Object(pe.f)(P.a,{color:T.d.colors.grayscale.base,name:this.state.isEditMode?"lock-unlocked":"lock-locked"})),!this.state.isEditMode&&Object(pe.f)("div",null,Object(k.e)("Click the lock to make changes.")),this.state.isEditMode&&Object(pe.f)("div",null,Object(k.e)("Click the lock to prevent further changes."))))}renderErrors(){var e;return this.state.errors.length>0?Object(pe.f)(x.a,{css:e=>({marginBottom:4*e.gridUnit}),type:"error",message:Object(pe.f)(O.a.Fragment,null,d()(e=this.state.errors).call(e,e=>Object(pe.f)("div",{key:e},e)))}):null}renderMetricCollection(){var e;return Object(pe.f)(ve,{tableColumns:["metric_name","verbose_name","expression"],columnLabels:{metric_name:Object(k.e)("Metric"),verbose_name:Object(k.e)("Label"),expression:Object(k.e)("SQL expression")},expandFieldset:Object(pe.f)(Fe,null,Object(pe.f)(Oe,{compact:!0},Object(pe.f)(fe,{fieldKey:"verbose_name",label:Object(k.e)("Label"),control:Object(pe.f)(U.a,{controlId:"verbose_name"})}),Object(pe.f)(fe,{fieldKey:"description",label:Object(k.e)("Description"),control:Object(pe.f)(U.a,{controlId:"description",placeholder:Object(k.e)("Description")})}),Object(pe.f)(fe,{fieldKey:"d3format",label:Object(k.e)("D3 format"),control:Object(pe.f)(U.a,{controlId:"d3format",placeholder:"%y/%m/%d"})}),Object(pe.f)(fe,{label:Object(k.e)("Warning message"),fieldKey:"warning_text",description:Object(k.e)("Warning message to display in the metric selector"),control:Object(pe.f)(U.a,{controlId:"warning_text",placeholder:Object(k.e)("Warning message")})}),Object(pe.f)(fe,{label:Object(k.e)("Certified by"),fieldKey:"certified_by",description:Object(k.e)("Person or group that has certified this metric"),control:Object(pe.f)(U.a,{controlId:"certified_by",placeholder:Object(k.e)("Certified by")})}),Object(pe.f)(fe,{label:Object(k.e)("Certification details"),fieldKey:"certification_details",description:Object(k.e)("Details of the certification"),control:Object(pe.f)(U.a,{controlId:"certification_details",placeholder:Object(k.e)("Certification details")})}))),collection:this.state.datasource.metrics,allowAddItem:!0,onChange:b()(e=this.onDatasourcePropChange).call(e,this,"metrics"),itemGenerator:()=>({metric_name:"<new metric>",verbose_name:"",expression:""}),itemRenderers:{metric_name:(e,t,a,n)=>Object(pe.f)(_e,null,n.is_certified&&Object(pe.f)(N.a,{certifiedBy:n.certified_by,details:n.certification_details}),Object(pe.f)(R.a,{canEdit:!0,title:e,onSaveTitle:t})),verbose_name:(e,t)=>Object(pe.f)(R.a,{canEdit:!0,title:e,onSaveTitle:t}),expression:(e,t)=>Object(pe.f)(R.a,{canEdit:!0,title:e,onSaveTitle:t,extraClasses:["datasource-sql-expression"],multiLine:!0}),description:(e,t,a)=>Object(pe.f)(Pe,{label:a,formElement:Object(pe.f)(U.a,{value:e,onChange:t})}),d3format:(e,t,a)=>Object(pe.f)(Pe,{label:a,formElement:Object(pe.f)(U.a,{value:e,onChange:t})})},allowDeletes:!0,stickyHeader:!0})}render(){const{datasource:e,activeTabKey:t}=this.state;return Object(pe.f)(Ee,null,this.renderErrors(),Object(pe.f)(x.a,{css:e=>({marginBottom:4*e.gridUnit}),type:"warning",message:Object(pe.f)(O.a.Fragment,null," ",Object(pe.f)("strong",null,Object(k.e)("Be careful.")," "),Object(k.e)("Changing these settings will affect all charts using this dataset, including charts owned by other people."))}),Object(pe.f)(M.c,{fullWidth:!1,id:"table-tabs",onChange:this.handleTabSelect,defaultActiveKey:t},Object(pe.f)(M.c.TabPane,{key:0,tab:Object(k.e)("Source")},this.renderSourceFieldset()),Object(pe.f)(M.c.TabPane,{tab:Object(pe.f)(Ne,{collection:e.metrics,title:Object(k.e)("Metrics")}),key:1},this.renderMetricCollection()),Object(pe.f)(M.c.TabPane,{tab:Object(pe.f)(Ne,{collection:this.state.databaseColumns,title:Object(k.e)("Columns")}),key:2},Object(pe.f)("div",null,Object(pe.f)(Te,null,Object(pe.f)("span",{className:"m-t-10 m-r-10"},Object(pe.f)(I.a,{buttonSize:"small",buttonStyle:"primary",onClick:this.syncMetadata,className:"sync-from-source"},Object(pe.f)("i",{className:"fa fa-database"})," ",Object(k.e)("Sync columns from source")))),Object(pe.f)(Le,{className:"columns-table",columns:this.state.databaseColumns,onChange:e=>this.setColumns({databaseColumns:e})}),this.state.metadataLoading&&Object(pe.f)(K.a,null))),Object(pe.f)(M.c.TabPane,{tab:Object(pe.f)(Ne,{collection:this.state.calculatedColumns,title:Object(k.e)("Calculated columns")}),key:3},Object(pe.f)(Le,{columns:this.state.calculatedColumns,onChange:e=>this.setColumns({calculatedColumns:e}),editableColumnName:!0,showExpression:!0,allowAddItem:!0,allowEditDataType:!0,itemGenerator:()=>({column_name:"<new column>",filterable:!0,groupby:!0,expression:"<enter SQL expression here>",__expanded:!0})})),Object(pe.f)(M.c.TabPane,{key:4,tab:Object(k.e)("Settings")},Object(pe.f)("div",null,Object(pe.f)(v.a,{md:6},Object(pe.f)(Fe,null,this.renderSettingsFieldset())),Object(pe.f)(v.a,{md:6},Object(pe.f)(Fe,null,this.renderAdvancedFieldset()))))))}}Ae.defaultProps={onChange:()=>{}},Ae.propTypes=Ke;t.default=Object(Se.a)(Ae)},2108:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warning=l,t.note=o,t.resetWarned=function(){n={}},t.call=i,t.warningOnce=s,t.noteOnce=function(e,t){i(o,e,t)},t.default=void 0;var n={};function l(e,t){0}function o(e,t){0}function i(e,t,a){t||n[a]||(e(!1,a),n[a]=!0)}function s(e,t){i(l,e,t)}var c=s;t.default=c},4676:function(e,t,a){},810:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));a(40);var n=a(279),l=a.n(n),o=a(0),i=a(5),s=a.n(i),c=a(16),r=a(54),d=a(1);function h({canEdit:e=!1,editing:t=!1,extraClasses:a,multiLine:n=!1,noPermitTooltip:i,onSaveTitle:h,showTooltip:b=!0,style:u,title:p="",defaultTitle:m="",placeholder:f=""}){const[g,O]=Object(o.useState)(t),[j,y]=Object(o.useState)(p),[C,v]=Object(o.useState)(p),[S,x]=Object(o.useState)(null),E=Object(o.useRef)();function _(){if(!e||g)return;const t=E.current?E.current.getBoundingClientRect():null;O(!0),x(t)}function w(){const t=l()(j).call(j);e&&(O(!1),t.length?(C!==t&&v(t),p!==t&&h(t)):y(C))}function T(e){" "===e.key&&e.stopPropagation(),"Enter"===e.key&&(e.preventDefault(),w())}function k(t){e&&y(t.target.value)}function D(e){"Enter"===e.key&&(e.preventDefault(),w())}let I;Object(o.useEffect)(()=>{p!==j&&(v(j),y(p))},[p]),Object(o.useEffect)(()=>{g&&E.current.focus()},[g]),I=j,g||j||(I=m||p);const M=g&&S?{height:`${S.height}px`}:void 0;let N=n&&g?Object(d.f)("textarea",{ref:E,value:I,className:p?void 0:"text-muted",onKeyDown:T,onChange:k,onBlur:w,onClick:_,onKeyPress:D,placeholder:f,style:M}):Object(d.f)("input",{ref:E,type:g?"text":"button",value:I,className:p?void 0:"text-muted",onKeyDown:T,onChange:k,onBlur:w,onClick:_,onKeyPress:D,placeholder:f});return b&&!g&&(N=Object(d.f)(r.a,{id:"title-tooltip",title:e?Object(c.e)("Click to edit"):i||Object(c.e)("You don't have the rights to alter this title.")},N)),e||(N=Object(d.f)("span",{title:I},I)),Object(d.f)("span",{className:s()("editable-title",a,e&&"editable-title--editable",g&&"editable-title--editing"),style:u},N)}},857:function(e,t,a){"use strict";var n=a(353),l=a(354),o=a(355),i=a(356),s=a(357),c=a(358),r=a(359),d=a(360),h=a(361),b=a(362),u=a(363),p=a(364),m=a(365),f=a(366),g=a(367),O=a(368),j=a(369),y=a(370),C=a(371),v=a(372),S=a(373),x=a(374),E=a(375),_=a(376),w=a(377),T=a(378),k=a(379),D=a(380),I=a(381),M=a(382),N=a(383),L=a(384),P=a(385),F=a(386),K=a(387),A=a(388),R=a(389),q=a(390),$=a(391),U=a(392),B=a(393),G=a(394),z=a(395),H=a(396),W=a(397),Q=a(398),J=a(399),V=a(400),X=a(401),Y=a(402),Z=a(403),ee=a(404),te=a(405),ae=a(406),ne=a(407),le=a(408),oe=a(409),ie=a(410),se=a(411),ce=a(412),re=a(413),de=a(414),he=a(415),be=a(416),ue=a(417),pe=a(418),me=a(419),fe=a(420),ge=a(421),Oe=a(422),je=a(423),ye=a(424),Ce=a(425),ve=a(426),Se=a(427),xe=a(428),Ee=a(429),_e=a(430),we=a(431),Te=a(432),ke=a(433),De=a(434),Ie=a(435),Me=a(436),Ne=a(437),Le=a(438),Pe=a(439),Fe=a(440),Ke=a(441),Ae=a(442),Re=a(443),qe=a(444),$e=a(445),Ue=a(446),Be=a(447),Ge=a(448),ze=a(449),He=a(450),We=a(451),Qe=a(452),Je=a(453),Ve=a(454),Xe=a(455),Ye=a(456),Ze=a(457),et=a(458),tt=a(459),at=a(460),nt=a(461),lt=a(462),ot=a(463),it=a(464),st=a(465),ct=a(466),rt=a(467),dt=a(468),ht=a(469),bt=a(470),ut=a(471),pt=a(472),mt=a(473),ft=a(474),gt=a(475),Ot=a(476),jt=a(477),yt=a(478),Ct=a(31),vt=a.n(Ct),St=a(44),xt=a.n(St),Et=a(11),_t=a.n(Et),wt=a(56),Tt=a.n(wt),kt=(a(0),a(1685)),Dt=a(1049),It=a(51),Mt=a(1);const Nt=Object(It.c)(({iconColor:e,iconSize:t,...a})=>Object(Mt.f)(Dt.a,vt()({viewBox:a.viewBox||"0 0 24 24"},a)))`
  ${({iconColor:e})=>e&&`color: ${e};`};
  font-size: ${({iconSize:e,theme:t})=>e?`${t.typography.sizes[e]}px`:"24px"};
`,Lt=(e,t)=>Object(Mt.f)(Nt,vt()({component:e},t));var Pt,Ft,Kt=Nt;var At=Tt()(Pt=_t()(Ft=xt()(kt)).call(Ft,e=>({[e]:t=>Object(Mt.f)(Kt,vt()({component:kt[e]},t))}))).call(Pt,(e,t)=>({...e,...t}));t.a={...At,Alert:e=>Lt(n.a,e),AlertSolid:e=>Lt(l.a,e),AlertSolidSmall:e=>Lt(o.a,e),Binoculars:e=>Lt(i.a,e),Bolt:e=>Lt(s.a,e),BoltSmall:e=>Lt(c.a,e),BoltSmallRun:e=>Lt(r.a,e),Calendar:e=>Lt(d.a,e),Cancel:e=>Lt(h.a,e),CancelSolid:e=>Lt(b.a,e),CancelX:e=>Lt(u.a,e),CardView:e=>Lt(p.a,e),Cards:e=>Lt(m.a,e),CardsLocked:e=>Lt(f.a,e),CaretDown:e=>Lt(g.a,e),CaretLeft:e=>Lt(O.a,e),CaretRight:e=>Lt(j.a,e),CaretUp:e=>Lt(y.a,e),Certified:e=>Lt(C.a,e),Check:e=>Lt(v.a,e),CheckboxHalf:e=>Lt(S.a,e),CheckboxOff:e=>Lt(x.a,e),CheckboxOn:e=>Lt(E.a,e),CircleCheck:e=>Lt(_.a,e),CircleCheckSolid:e=>Lt(w.a,e),Circle:e=>Lt(T.a,e),Clock:e=>Lt(k.a,e),Close:e=>Lt(D.a,e),Code:e=>Lt(I.a,e),Cog:e=>Lt(M.a,e),Collapse:e=>Lt(N.a,e),ColorPalette:e=>Lt(L.a,e),Components:e=>Lt(P.a,e),Copy:e=>Lt(F.a,e),CursorTarget:e=>Lt(K.a,e),Database:e=>Lt(A.a,e),DatasetPhysical:e=>Lt(R.a,e),DatasetVirtualGreyscale:e=>Lt(q.a,e),DatasetVirtual:e=>Lt($.a,e),Download:e=>Lt(U.a,e),EditAlt:e=>Lt(B.a,e),Edit:e=>Lt(G.a,e),Email:e=>Lt(z.a,e),Error:e=>Lt(H.a,e),ErrorSolid:e=>Lt(W.a,e),ErrorSolidSmall:e=>Lt(Q.a,e),Exclamation:e=>Lt(J.a,e),Expand:e=>Lt(V.a,e),Eye:e=>Lt(X.a,e),EyeSlash:e=>Lt(Y.a,e),FavoriteSelected:e=>Lt(Z.a,e),FavoriteSmallSelected:e=>Lt(ee.a,e),FavoriteUnselected:e=>Lt(te.a,e),FieldABCIcon:e=>Lt(ae.a,e),FieldBoolean:e=>Lt(ne.a,e),FieldDate:e=>Lt(le.a,e),FieldDerived:e=>Lt(oe.a,e),FieldNum:e=>Lt(ie.a,e),FieldStruct:e=>Lt(se.a,e),File:e=>Lt(ce.a,e),Filter:e=>Lt(re.a,e),FilterSmall:e=>Lt(de.a,e),Folder:e=>Lt(he.a,e),Full:e=>Lt(be.a,e),Function:e=>Lt(ue.a,e),Gear:e=>Lt(pe.a,e),Grid:e=>Lt(me.a,e),Image:e=>Lt(fe.a,e),Import:e=>Lt(ge.a,e),Info:e=>Lt(Oe.a,e),InfoSolid:e=>Lt(je.a,e),InfoSolidSmall:e=>Lt(ye.a,e),Join:e=>Lt(Ce.a,e),Keyboard:e=>Lt(ve.a,e),Layers:e=>Lt(Se.a,e),Lightbulb:e=>Lt(xe.a,e),Link:e=>Lt(Ee.a,e),List:e=>Lt(_e.a,e),ListView:e=>Lt(we.a,e),Location:e=>Lt(Te.a,e),LockLocked:e=>Lt(ke.a,e),LockUnlocked:e=>Lt(De.a,e),Map:e=>Lt(Ie.a,e),Message:e=>Lt(Me.a,e),Minus:e=>Lt(Ne.a,e),MinusSolid:e=>Lt(Le.a,e),MoreHoriz:e=>Lt(Pe.a,e),Move:e=>Lt(Fe.a,e),NavCharts:e=>Lt(Ke.a,e),NavDashboard:e=>Lt(Ae.a,e),NavData:e=>Lt(Re.a,e),NavExplore:e=>Lt(qe.a,e),NavHome:e=>Lt($e.a,e),NavLab:e=>Lt(Ue.a,e),Note:e=>Lt(Be.a,e),Offline:e=>Lt(Ge.a,e),Paperclip:e=>Lt(ze.a,e),Placeholder:e=>Lt(He.a,e),Plus:e=>Lt(We.a,e),PlusLarge:e=>Lt(Qe.a,e),PlusSmall:e=>Lt(Je.a,e),PlusSolid:e=>Lt(Ve.a,e),Queued:e=>Lt(Xe.a,e),Refresh:e=>Lt(Ye.a,e),Running:e=>Lt(Ze.a,e),Save:e=>Lt(et.a,e),SQL:e=>Lt(tt.a,e),Search:e=>Lt(at.a,e),Server:e=>Lt(nt.a,e),Share:e=>Lt(lt.a,e),Slack:e=>Lt(ot.a,e),SortAsc:e=>Lt(it.a,e),SortDesc:e=>Lt(st.a,e),Sort:e=>Lt(ct.a,e),Table:e=>Lt(rt.a,e),Tag:e=>Lt(dt.a,e),Trash:e=>Lt(ht.a,e),TriangleChange:e=>Lt(bt.a,e),TriangleDown:e=>Lt(ut.a,e),TriangleUp:e=>Lt(pt.a,e),UpLevel:e=>Lt(mt.a,e),User:e=>Lt(ft.a,e),Warning:e=>Lt(gt.a,e),WarningSolid:e=>Lt(Ot.a,e),XLarge:e=>Lt(jt.a,e),XSmall:e=>Lt(yt.a,e)}}}]);