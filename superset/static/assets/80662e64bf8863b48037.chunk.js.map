{"version":3,"file":"80662e64bf8863b48037.chunk.js","mappings":"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","sources":["webpack://superset/./node_modules/@luma.gl/shadertools/dist/esm/modules/picking/picking.js","webpack://superset/./node_modules/@deck.gl/core/dist/esm/shaderlib/picking/picking.js","webpack://superset/./node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer-vertex.glsl.js","webpack://superset/./node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer.js","webpack://superset/./node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer-fragment.glsl.js","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/components/Legend.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/utils/geo.js","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/CategoricalDeckGLContainer.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/factory.tsx"],"sourcesContent":["const DEFAULT_HIGHLIGHT_COLOR = new Uint8Array([0, 255, 255, 255]);\nconst DEFAULT_MODULE_OPTIONS = {\n  pickingSelectedColor: null,\n  pickingHighlightColor: DEFAULT_HIGHLIGHT_COLOR,\n  pickingActive: false,\n  pickingAttribute: false\n};\n\nfunction getUniforms(opts = DEFAULT_MODULE_OPTIONS) {\n  const uniforms = {};\n\n  if (opts.pickingSelectedColor !== undefined) {\n    if (!opts.pickingSelectedColor) {\n      uniforms.picking_uSelectedColorValid = 0;\n    } else {\n      const selectedColor = opts.pickingSelectedColor.slice(0, 3);\n      uniforms.picking_uSelectedColorValid = 1;\n      uniforms.picking_uSelectedColor = selectedColor;\n    }\n  }\n\n  if (opts.pickingHighlightColor) {\n    const color = Array.from(opts.pickingHighlightColor, x => x / 255);\n\n    if (!Number.isFinite(color[3])) {\n      color[3] = 1;\n    }\n\n    uniforms.picking_uHighlightColor = color;\n  }\n\n  if (opts.pickingActive !== undefined) {\n    uniforms.picking_uActive = Boolean(opts.pickingActive);\n    uniforms.picking_uAttribute = Boolean(opts.pickingAttribute);\n  }\n\n  return uniforms;\n}\n\nconst vs = \"uniform bool picking_uActive;\\nuniform bool picking_uAttribute;\\nuniform vec3 picking_uSelectedColor;\\nuniform bool picking_uSelectedColorValid;\\n\\nout vec4 picking_vRGBcolor_Avalid;\\n\\nconst float COLOR_SCALE = 1. / 255.;\\n\\nbool picking_isColorValid(vec3 color) {\\n  return dot(color, vec3(1.0)) > 0.001;\\n}\\n\\nbool isVertexPicked(vec3 vertexColor) {\\n  return\\n    picking_uSelectedColorValid &&\\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\\n}\\n\\nvoid picking_setPickingColor(vec3 pickingColor) {\\n  if (picking_uActive) {\\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\\n\\n    if (!picking_uAttribute) {\\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\\n    }\\n  } else {\\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\\n  }\\n}\\n\\nvoid picking_setPickingAttribute(float value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.r = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec2 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rg = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec3 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rgb = value;\\n  }\\n}\\n\";\nconst fs = \"uniform bool picking_uActive;\\nuniform vec3 picking_uSelectedColor;\\nuniform vec4 picking_uHighlightColor;\\n\\nin vec4 picking_vRGBcolor_Avalid;\\nvec4 picking_filterHighlightColor(vec4 color) {\\n  if (picking_uActive) {\\n    return color;\\n  }\\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\\n\\n  if (selected) {\\n    float highLightAlpha = picking_uHighlightColor.a;\\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\\n    float highLightRatio = highLightAlpha / blendedAlpha;\\n\\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\\n    return vec4(blendedRGB, blendedAlpha);\\n  } else {\\n    return color;\\n  }\\n}\\nvec4 picking_filterPickingColor(vec4 color) {\\n  if (picking_uActive) {\\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\\n      discard;\\n    }\\n    return picking_vRGBcolor_Avalid;\\n  }\\n  return color;\\n}\\nvec4 picking_filterColor(vec4 color) {\\n  vec4 highightColor = picking_filterHighlightColor(color);\\n  return picking_filterPickingColor(highightColor);\\n}\\n\\n\";\nexport const picking = {\n  name: 'picking',\n  vs,\n  fs,\n  getUniforms\n};\n//# sourceMappingURL=picking.js.map","import { picking } from '@luma.gl/core';\nexport default {\n  inject: {\n    'vs:DECKGL_FILTER_COLOR': \"\\n  picking_setPickingColor(geometry.pickingColor);\\n  // for picking depth values\\n  picking_setPickingAttribute(geometry.position.z);\\n  \",\n    'fs:DECKGL_FILTER_COLOR': {\n      order: 99,\n      injection: \"\\n  // use highlight color if this fragment belongs to the selected object.\\n  color = picking_filterHighlightColor(color);\\n\\n  // use picking color if rendering to picking FBO.\\n  color = picking_filterPickingColor(color);\\n    \"\n    }\n  },\n  ...picking\n};\n//# sourceMappingURL=picking.js.map","export default \"#define SHADER_NAME scatterplot-layer-vertex-shader\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instancePositions;\\nattribute vec3 instancePositions64Low;\\nattribute float instanceRadius;\\nattribute float instanceLineWidths;\\nattribute vec4 instanceFillColors;\\nattribute vec4 instanceLineColors;\\nattribute vec3 instancePickingColors;\\n\\nuniform float opacity;\\nuniform float radiusScale;\\nuniform float radiusMinPixels;\\nuniform float radiusMaxPixels;\\nuniform float lineWidthScale;\\nuniform float lineWidthMinPixels;\\nuniform float lineWidthMaxPixels;\\nuniform float stroked;\\nuniform bool filled;\\nuniform bool billboard;\\n\\nvarying vec4 vFillColor;\\nvarying vec4 vLineColor;\\nvarying vec2 unitPosition;\\nvarying float innerUnitRadius;\\nvarying float outerRadiusPixels;\\n\\nvoid main(void) {\\n  geometry.worldPosition = instancePositions;\\n  outerRadiusPixels = clamp(\\n    project_size_to_pixel(radiusScale * instanceRadius),\\n    radiusMinPixels, radiusMaxPixels\\n  );\\n  float lineWidthPixels = clamp(\\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\\n    lineWidthMinPixels, lineWidthMaxPixels\\n  );\\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\\n  unitPosition = positions.xy;\\n  geometry.uv = unitPosition;\\n  geometry.pickingColor = instancePickingColors;\\n\\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\\n  \\n  if (billboard) {\\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\\n    vec3 offset = positions * outerRadiusPixels;\\n    DECKGL_FILTER_SIZE(offset, geometry);\\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\\n  } else {\\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\\n    DECKGL_FILTER_SIZE(offset, geometry);\\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\\n  }\\n\\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\\n}\\n\";\n//# sourceMappingURL=scatterplot-layer-vertex.glsl.js.map","import { Layer, project32, picking } from '@deck.gl/core';\nimport { Model, Geometry } from '@luma.gl/core';\nimport vs from './scatterplot-layer-vertex.glsl';\nimport fs from './scatterplot-layer-fragment.glsl';\nconst DEFAULT_COLOR = [0, 0, 0, 255];\nconst defaultProps = {\n  radiusUnits: 'meters',\n  radiusScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  radiusMinPixels: {\n    type: 'number',\n    min: 0,\n    value: 0\n  },\n  radiusMaxPixels: {\n    type: 'number',\n    min: 0,\n    value: Number.MAX_SAFE_INTEGER\n  },\n  lineWidthUnits: 'meters',\n  lineWidthScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  lineWidthMinPixels: {\n    type: 'number',\n    min: 0,\n    value: 0\n  },\n  lineWidthMaxPixels: {\n    type: 'number',\n    min: 0,\n    value: Number.MAX_SAFE_INTEGER\n  },\n  stroked: false,\n  filled: true,\n  billboard: false,\n  getPosition: {\n    type: 'accessor',\n    value: x => x.position\n  },\n  getRadius: {\n    type: 'accessor',\n    value: 1\n  },\n  getFillColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineWidth: {\n    type: 'accessor',\n    value: 1\n  },\n  strokeWidth: {\n    deprecatedFor: 'getLineWidth'\n  },\n  outline: {\n    deprecatedFor: 'stroked'\n  },\n  getColor: {\n    deprecatedFor: ['getFillColor', 'getLineColor']\n  }\n};\nexport default class ScatterplotLayer extends Layer {\n  getShaders() {\n    return super.getShaders({\n      vs,\n      fs,\n      modules: [project32, picking]\n    });\n  }\n\n  initializeState() {\n    this.getAttributeManager().addInstanced({\n      instancePositions: {\n        size: 3,\n        type: 5130,\n        fp64: this.use64bitPositions(),\n        transition: true,\n        accessor: 'getPosition'\n      },\n      instanceRadius: {\n        size: 1,\n        transition: true,\n        accessor: 'getRadius',\n        defaultValue: 1\n      },\n      instanceFillColors: {\n        size: this.props.colorFormat.length,\n        transition: true,\n        normalized: true,\n        type: 5121,\n        accessor: 'getFillColor',\n        defaultValue: [0, 0, 0, 255]\n      },\n      instanceLineColors: {\n        size: this.props.colorFormat.length,\n        transition: true,\n        normalized: true,\n        type: 5121,\n        accessor: 'getLineColor',\n        defaultValue: [0, 0, 0, 255]\n      },\n      instanceLineWidths: {\n        size: 1,\n        transition: true,\n        accessor: 'getLineWidth',\n        defaultValue: 1\n      }\n    });\n  }\n\n  updateState({\n    props,\n    oldProps,\n    changeFlags\n  }) {\n    super.updateState({\n      props,\n      oldProps,\n      changeFlags\n    });\n\n    if (changeFlags.extensionsChanged) {\n      var _this$state$model;\n\n      const {\n        gl\n      } = this.context;\n      (_this$state$model = this.state.model) === null || _this$state$model === void 0 ? void 0 : _this$state$model.delete();\n      this.state.model = this._getModel(gl);\n      this.getAttributeManager().invalidateAll();\n    }\n  }\n\n  draw({\n    uniforms\n  }) {\n    const {\n      viewport\n    } = this.context;\n    const {\n      radiusUnits,\n      radiusScale,\n      radiusMinPixels,\n      radiusMaxPixels,\n      stroked,\n      filled,\n      billboard,\n      lineWidthUnits,\n      lineWidthScale,\n      lineWidthMinPixels,\n      lineWidthMaxPixels\n    } = this.props;\n    const pointRadiusMultiplier = radiusUnits === 'pixels' ? viewport.metersPerPixel : 1;\n    const lineWidthMultiplier = lineWidthUnits === 'pixels' ? viewport.metersPerPixel : 1;\n    this.state.model.setUniforms(uniforms).setUniforms({\n      stroked: stroked ? 1 : 0,\n      filled,\n      billboard,\n      radiusScale: radiusScale * pointRadiusMultiplier,\n      radiusMinPixels,\n      radiusMaxPixels,\n      lineWidthScale: lineWidthScale * lineWidthMultiplier,\n      lineWidthMinPixels,\n      lineWidthMaxPixels\n    }).draw();\n  }\n\n  _getModel(gl) {\n    const positions = [-1, -1, 0, 1, -1, 0, 1, 1, 0, -1, 1, 0];\n    return new Model(gl, { ...this.getShaders(),\n      id: this.props.id,\n      geometry: new Geometry({\n        drawMode: 6,\n        vertexCount: 4,\n        attributes: {\n          positions: {\n            size: 3,\n            value: new Float32Array(positions)\n          }\n        }\n      }),\n      isInstanced: true\n    });\n  }\n\n}\nScatterplotLayer.layerName = 'ScatterplotLayer';\nScatterplotLayer.defaultProps = defaultProps;\n//# sourceMappingURL=scatterplot-layer.js.map","export default \"#define SHADER_NAME scatterplot-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform bool filled;\\nuniform float stroked;\\n\\nvarying vec4 vFillColor;\\nvarying vec4 vLineColor;\\nvarying vec2 unitPosition;\\nvarying float innerUnitRadius;\\nvarying float outerRadiusPixels;\\n\\nvoid main(void) {\\n  geometry.uv = unitPosition;\\n\\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\\n  float inCircle = smoothedge(distToCenter, outerRadiusPixels);\\n\\n  if (inCircle == 0.0) {\\n    discard;\\n  }\\n\\n  if (stroked > 0.5) {\\n    float isLine = smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter);\\n    if (filled) {\\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\\n    } else {\\n      if (isLine == 0.0) {\\n        discard;\\n      }\\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\\n    }\\n  } else if (filled) {\\n    gl_FragColor = vFillColor;\\n  } else {\\n    discard;\\n  }\\n\\n  gl_FragColor.a *= inCircle;\\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\\n}\\n\";\n//# sourceMappingURL=scatterplot-layer-fragment.glsl.js.map","/* eslint-disable react/jsx-sort-default-props */\n/* eslint-disable react/sort-prop-types */\n/* eslint-disable jsx-a11y/anchor-is-valid */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { formatNumber, styled } from '@superset-ui/core';\n\nconst StyledLegend = styled.div`\n  ${({ theme }) => `\n    font-size: ${theme.typography.sizes.s}px;\n    position: absolute;\n    background: ${theme.colors.grayscale.light5};\n    box-shadow: 0 0 ${theme.gridUnit}px ${theme.colors.grayscale.light2};\n    margin: ${theme.gridUnit * 6}px;\n    padding: ${theme.gridUnit * 3}px ${theme.gridUnit * 5}px;\n    outline: none;\n    overflow-y: scroll;\n    max-height: 200px;\n\n    & ul {\n      list-style: none;\n      padding-left: 0;\n      margin: 0;\n\n      & li a {\n        color: ${theme.colors.grayscale.base};\n        text-decoration: none;\n\n        & span {\n          margin-right: ${theme.gridUnit * 3}px;\n        }\n      }\n    }\n  `}\n`;\n\nconst categoryDelimiter = ' - ';\n\nconst propTypes = {\n  categories: PropTypes.object,\n  forceCategorical: PropTypes.bool,\n  format: PropTypes.string,\n  position: PropTypes.oneOf([null, 'tl', 'tr', 'bl', 'br']),\n  showSingleCategory: PropTypes.func,\n  toggleCategory: PropTypes.func,\n};\n\nconst defaultProps = {\n  categories: {},\n  forceCategorical: false,\n  format: null,\n  position: 'tr',\n  showSingleCategory: () => {},\n  toggleCategory: () => {},\n};\n\nexport default class Legend extends React.PureComponent {\n  format(value) {\n    if (!this.props.format || this.props.forceCategorical) {\n      return value;\n    }\n\n    const numValue = parseFloat(value);\n\n    return formatNumber(this.props.format, numValue);\n  }\n\n  formatCategoryLabel(k) {\n    if (!this.props.format) {\n      return k;\n    }\n\n    if (k.includes(categoryDelimiter)) {\n      const values = k.split(categoryDelimiter);\n\n      return (\n        this.format(values[0]) + categoryDelimiter + this.format(values[1])\n      );\n    }\n\n    return this.format(k);\n  }\n\n  render() {\n    if (\n      Object.keys(this.props.categories).length === 0 ||\n      this.props.position === null\n    ) {\n      return null;\n    }\n\n    const categories = Object.entries(this.props.categories).map(([k, v]) => {\n      const style = { color: `rgba(${v.color.join(', ')})` };\n      const icon = v.enabled ? '\\u25FC' : '\\u25FB';\n\n      return (\n        <li key={k}>\n          <a\n            href=\"#\"\n            onClick={() => this.props.toggleCategory(k)}\n            onDoubleClick={() => this.props.showSingleCategory(k)}\n          >\n            <span style={style}>{icon}</span> {this.formatCategoryLabel(k)}\n          </a>\n        </li>\n      );\n    });\n\n    const vertical = this.props.position.charAt(0) === 't' ? 'top' : 'bottom';\n    const horizontal = this.props.position.charAt(1) === 'r' ? 'right' : 'left';\n    const style = {\n      position: 'absolute',\n      [vertical]: '0px',\n      [horizontal]: '10px',\n    };\n\n    return (\n      <StyledLegend style={style}>\n        <ul>{categories}</ul>\n      </StyledLegend>\n    );\n  }\n}\n\nLegend.propTypes = propTypes;\nLegend.defaultProps = defaultProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { roundDecimal } from './utils';\n\nexport const defaultViewport = {\n  bearing: 0,\n  latitude: 31.222656842808707,\n  longitude: 6.85236157047845,\n  pitch: 0,\n  zoom: 1,\n};\n\nconst METER_TO_MILE = 1609.34;\n\nexport function unitToRadius(unit, num) {\n  if (unit === 'square_m') {\n    return Math.sqrt(num / Math.PI);\n  }\n  if (unit === 'radius_m') {\n    return num;\n  }\n  if (unit === 'radius_km') {\n    return num * 1000;\n  }\n  if (unit === 'radius_miles') {\n    return num * METER_TO_MILE;\n  }\n  if (unit === 'square_km') {\n    return Math.sqrt(num / Math.PI) * 1000;\n  }\n  if (unit === 'square_miles') {\n    return Math.sqrt(num / Math.PI) * METER_TO_MILE;\n  }\n\n  return null;\n}\n\nexport const EARTH_CIRCUMFERENCE_KM = 40075.16;\nexport const MILES_PER_KM = 1.60934;\n\nexport function kmToPixels(kilometers, latitude, zoomLevel) {\n  // Algorithm from: https://wiki.openstreetmap.org/wiki/Zoom_levels\n  const latitudeRad = latitude * (Math.PI / 180);\n  // Seems like the zoomLevel is off by one\n  const kmPerPixel =\n    (EARTH_CIRCUMFERENCE_KM * Math.cos(latitudeRad)) / 2 ** (zoomLevel + 9);\n\n  return roundDecimal(kilometers / kmPerPixel, 2);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ScatterplotLayer } from 'deck.gl';\nimport React from 'react';\nimport { getMetricLabel, t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport { createCategoricalDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\nimport { unitToRadius } from '../../utils/geo';\n\nfunction getPoints(data) {\n  return data.map(d => d.position);\n}\n\nfunction setTooltipContent(formData, verboseMap) {\n  return o => {\n    const label =\n      verboseMap?.[formData.point_radius_fixed.value] ||\n      getMetricLabel(formData.point_radius_fixed?.value);\n    return (\n      <div className=\"deckgl-tooltip\">\n        <TooltipRow\n          // eslint-disable-next-line prefer-template\n          label={t('Longitude and Latitude') + ': '}\n          value={`${o.object.position[0]}, ${o.object.position[1]}`}\n        />\n        {o.object.cat_color && (\n          <TooltipRow\n            // eslint-disable-next-line prefer-template\n            label={t('Category') + ': '}\n            value={`${o.object.cat_color}`}\n          />\n        )}\n        {o.object.metric && (\n          <TooltipRow label={`${label}: `} value={`${o.object.metric}`} />\n        )}\n      </div>\n    );\n  };\n}\n\nexport function getLayer(\n  formData,\n  payload,\n  onAddFilter,\n  setTooltip,\n  datasource,\n) {\n  const fd = formData;\n  const dataWithRadius = payload.data.features.map(d => {\n    let radius = unitToRadius(fd.point_unit, d.radius) || 10;\n    if (fd.multiplier) {\n      radius *= fd.multiplier;\n    }\n    if (d.color) {\n      return { ...d, radius };\n    }\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const color = [c.r, c.g, c.b, c.a * 255];\n\n    return { ...d, radius, color };\n  });\n\n  return new ScatterplotLayer({\n    id: `scatter-layer-${fd.slice_id}`,\n    data: dataWithRadius,\n    fp64: true,\n    getFillColor: d => d.color,\n    getRadius: d => d.radius,\n    radiusMinPixels: fd.min_radius || null,\n    radiusMaxPixels: fd.max_radius || null,\n    stroked: false,\n    ...commonLayerProps(\n      fd,\n      setTooltip,\n      setTooltipContent(fd, datasource?.verboseMap),\n    ),\n  });\n}\n\nexport default createCategoricalDeckGLComponent(getLayer, getPoints);\n","/* eslint-disable react/sort-prop-types */\n/* eslint-disable react/require-default-props */\n/* eslint-disable react/no-unused-prop-types */\n/* eslint-disable react/no-access-state-in-setstate */\n/* eslint-disable camelcase */\n/* eslint-disable no-prototype-builtins */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"\", \"__timestamp\"] }] */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { CategoricalColorNamespace } from '@superset-ui/core';\nimport AnimatableDeckGLContainer from './AnimatableDeckGLContainer';\nimport Legend from './components/Legend';\nimport { hexToRGB } from './utils/colors';\nimport { getPlaySliderParams } from './utils/time';\nimport sandboxedEval from './utils/sandbox';\n// eslint-disable-next-line import/extensions\nimport fitViewport from './utils/fitViewport';\n\nconst { getScale } = CategoricalColorNamespace;\n\nfunction getCategories(fd, data) {\n  const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n  const fixedColor = [c.r, c.g, c.b, 255 * c.a];\n  const colorFn = getScale(fd.color_scheme);\n  const categories = {};\n  data.forEach(d => {\n    if (d.cat_color != null && !categories.hasOwnProperty(d.cat_color)) {\n      let color;\n      if (fd.dimension) {\n        color = hexToRGB(colorFn(d.cat_color, fd.sliceId), c.a * 255);\n      } else {\n        color = fixedColor;\n      }\n      categories[d.cat_color] = { color, enabled: true };\n    }\n  });\n\n  return categories;\n}\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  formData: PropTypes.object.isRequired,\n  getLayer: PropTypes.func.isRequired,\n  getPoints: PropTypes.func.isRequired,\n  height: PropTypes.number.isRequired,\n  mapboxApiKey: PropTypes.string.isRequired,\n  onAddFilter: PropTypes.func,\n  payload: PropTypes.object.isRequired,\n  setControlValue: PropTypes.func.isRequired,\n  viewport: PropTypes.object.isRequired,\n  width: PropTypes.number.isRequired,\n};\n\nexport default class CategoricalDeckGLContainer extends React.PureComponent {\n  containerRef = React.createRef();\n\n  /*\n   * A Deck.gl container that handles categories.\n   *\n   * The container will have an interactive legend, populated from the\n   * categories present in the data.\n   */\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProps(props);\n\n    this.getLayers = this.getLayers.bind(this);\n    this.onValuesChange = this.onValuesChange.bind(this);\n    this.toggleCategory = this.toggleCategory.bind(this);\n    this.showSingleCategory = this.showSingleCategory.bind(this);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.payload.form_data !== this.state.formData) {\n      this.setState({ ...this.getStateFromProps(nextProps) });\n    }\n  }\n\n  onValuesChange(values) {\n    this.setState({\n      values: Array.isArray(values)\n        ? values\n        : [values, values + this.state.getStep(values)],\n    });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  getStateFromProps(props, state) {\n    const features = props.payload.data.features || [];\n    const timestamps = features.map(f => f.__timestamp);\n    const categories = getCategories(props.formData, features);\n\n    // the state is computed only from the payload; if it hasn't changed, do\n    // not recompute state since this would reset selections and/or the play\n    // slider position due to changes in form controls\n    if (state && props.payload.form_data === state.formData) {\n      return { ...state, categories };\n    }\n\n    // the granularity has to be read from the payload form_data, not the\n    // props formData which comes from the instantaneous controls state\n    const granularity =\n      props.payload.form_data.time_grain_sqla ||\n      props.payload.form_data.granularity ||\n      'P1D';\n\n    const { start, end, getStep, values, disabled } = getPlaySliderParams(\n      timestamps,\n      granularity,\n    );\n\n    const { width, height, formData } = props;\n    let { viewport } = props;\n    if (formData.autozoom) {\n      viewport = fitViewport(viewport, {\n        width,\n        height,\n        points: props.getPoints(features),\n      });\n    }\n    if (viewport.zoom < 0) {\n      viewport.zoom = 0;\n    }\n\n    return {\n      start,\n      end,\n      getStep,\n      values,\n      disabled,\n      viewport,\n      selected: [],\n      lastClick: 0,\n      formData: props.payload.form_data,\n      categories,\n    };\n  }\n\n  getLayers(values) {\n    const { getLayer, payload, formData: fd, onAddFilter } = this.props;\n    let features = payload.data.features ? [...payload.data.features] : [];\n\n    // Add colors from categories or fixed color\n    features = this.addColor(features, fd);\n\n    // Apply user defined data mutator if defined\n    if (fd.js_data_mutator) {\n      const jsFnMutator = sandboxedEval(fd.js_data_mutator);\n      features = jsFnMutator(features);\n    }\n\n    // Filter by time\n    if (values[0] === values[1] || values[1] === this.end) {\n      features = features.filter(\n        d => d.__timestamp >= values[0] && d.__timestamp <= values[1],\n      );\n    } else {\n      features = features.filter(\n        d => d.__timestamp >= values[0] && d.__timestamp < values[1],\n      );\n    }\n\n    // Show only categories selected in the legend\n    const cats = this.state.categories;\n    if (fd.dimension) {\n      features = features.filter(\n        d => cats[d.cat_color] && cats[d.cat_color].enabled,\n      );\n    }\n\n    const filteredPayload = {\n      ...payload,\n      data: { ...payload.data, features },\n    };\n\n    return [\n      getLayer(\n        fd,\n        filteredPayload,\n        onAddFilter,\n        this.setTooltip,\n        this.props.datasource,\n      ),\n    ];\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  addColor(data, fd) {\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const colorFn = getScale(fd.color_scheme);\n\n    return data.map(d => {\n      let color;\n      if (fd.dimension) {\n        color = hexToRGB(colorFn(d.cat_color, fd.sliceId), c.a * 255);\n\n        return { ...d, color };\n      }\n\n      return d;\n    });\n  }\n\n  toggleCategory(category) {\n    const categoryState = this.state.categories[category];\n    const categories = {\n      ...this.state.categories,\n      [category]: {\n        ...categoryState,\n        enabled: !categoryState.enabled,\n      },\n    };\n\n    // if all categories are disabled, enable all -- similar to nvd3\n    if (Object.values(categories).every(v => !v.enabled)) {\n      /* eslint-disable no-param-reassign */\n      Object.values(categories).forEach(v => {\n        v.enabled = true;\n      });\n    }\n    this.setState({ categories });\n  }\n\n  showSingleCategory(category) {\n    const categories = { ...this.state.categories };\n    /* eslint-disable no-param-reassign */\n    Object.values(categories).forEach(v => {\n      v.enabled = false;\n    });\n    categories[category].enabled = true;\n    this.setState({ categories });\n  }\n\n  setTooltip = tooltip => {\n    const { current } = this.containerRef;\n    if (current) {\n      current.setTooltip(tooltip);\n    }\n  };\n\n  render() {\n    return (\n      <div style={{ position: 'relative' }}>\n        <AnimatableDeckGLContainer\n          ref={this.containerRef}\n          getLayers={this.getLayers}\n          start={this.state.start}\n          end={this.state.end}\n          getStep={this.state.getStep}\n          values={this.state.values}\n          disabled={this.state.disabled}\n          viewport={this.state.viewport}\n          mapboxApiAccessToken={this.props.mapboxApiKey}\n          mapStyle={this.props.formData.mapbox_style}\n          setControlValue={this.props.setControlValue}\n          width={this.props.width}\n          height={this.props.height}\n        >\n          <Legend\n            forceCategorical\n            categories={this.state.categories}\n            format={this.props.formData.legend_format}\n            position={this.props.formData.legend_position}\n            showSingleCategory={this.showSingleCategory}\n            toggleCategory={this.toggleCategory}\n          />\n        </AnimatableDeckGLContainer>\n      </div>\n    );\n  }\n}\n\nCategoricalDeckGLContainer.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { isEqual } from 'lodash';\nimport { Datasource, QueryFormData, JsonObject } from '@superset-ui/core';\n\nimport {\n  DeckGLContainerStyledWrapper,\n  DeckGLContainer,\n} from './DeckGLContainer';\nimport CategoricalDeckGLContainer from './CategoricalDeckGLContainer';\nimport fitViewport, { Viewport } from './utils/fitViewport';\nimport { Point } from './types';\n\ntype deckGLComponentProps = {\n  datasource: Datasource;\n  formData: QueryFormData;\n  height: number;\n  onAddFilter: () => void;\n  payload: JsonObject;\n  setControlValue: () => void;\n  viewport: Viewport;\n  width: number;\n};\nexport interface getLayerType<T> {\n  (\n    formData: QueryFormData,\n    payload: JsonObject,\n    onAddFilter: () => void,\n    setTooltip: (tooltip: string) => void,\n  ): T;\n}\ninterface getPointsType<T> {\n  (point: number[]): T;\n}\ntype deckGLComponentState = {\n  viewport: Viewport;\n  layer: unknown;\n};\n\nexport function createDeckGLComponent(\n  getLayer: getLayerType<unknown>,\n  getPoints: getPointsType<Point[]>,\n): React.ComponentClass<deckGLComponentProps> {\n  // Higher order component\n  class Component extends React.PureComponent<\n    deckGLComponentProps,\n    deckGLComponentState\n  > {\n    containerRef: React.RefObject<DeckGLContainer> = React.createRef();\n\n    constructor(props: deckGLComponentProps) {\n      super(props);\n\n      const { width, height, formData } = props;\n      let { viewport } = props;\n      if (formData.autozoom) {\n        viewport = fitViewport(viewport, {\n          width,\n          height,\n          points: getPoints(props.payload.data.features),\n        }) as Viewport;\n      }\n\n      this.state = {\n        viewport,\n        layer: this.computeLayer(props),\n      };\n      this.onViewportChange = this.onViewportChange.bind(this);\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps: deckGLComponentProps) {\n      // Only recompute the layer if anything BUT the viewport has changed\n      const nextFdNoVP = { ...nextProps.formData, viewport: null };\n      const currFdNoVP = { ...this.props.formData, viewport: null };\n      if (\n        !isEqual(nextFdNoVP, currFdNoVP) ||\n        nextProps.payload !== this.props.payload\n      ) {\n        this.setState({ layer: this.computeLayer(nextProps) });\n      }\n    }\n\n    onViewportChange(viewport: Viewport) {\n      this.setState({ viewport });\n    }\n\n    computeLayer(props: deckGLComponentProps) {\n      const { formData, payload, onAddFilter } = props;\n\n      return getLayer(formData, payload, onAddFilter, this.setTooltip);\n    }\n\n    setTooltip = (tooltip: string) => {\n      const { current } = this.containerRef;\n      if (current) {\n        current?.setTooltip(tooltip);\n      }\n    };\n\n    render() {\n      const { formData, payload, setControlValue, height, width } = this.props;\n      const { layer, viewport } = this.state;\n\n      return (\n        <DeckGLContainerStyledWrapper\n          ref={this.containerRef}\n          mapboxApiAccessToken={payload.data.mapboxApiKey}\n          viewport={viewport}\n          layers={[layer]}\n          mapStyle={formData.mapbox_style}\n          setControlValue={setControlValue}\n          width={width}\n          height={height}\n          onViewportChange={this.onViewportChange}\n        />\n      );\n    }\n  }\n  return Component;\n}\n\nexport function createCategoricalDeckGLComponent(\n  getLayer: getLayerType<unknown>,\n  getPoints: getPointsType<Point[]>,\n) {\n  return function Component(props: deckGLComponentProps) {\n    const {\n      datasource,\n      formData,\n      height,\n      payload,\n      setControlValue,\n      viewport,\n      width,\n    } = props;\n\n    return (\n      <CategoricalDeckGLContainer\n        datasource={datasource}\n        formData={formData}\n        mapboxApiKey={payload.data.mapboxApiKey}\n        setControlValue={setControlValue}\n        viewport={viewport}\n        getLayer={getLayer}\n        payload={payload}\n        getPoints={getPoints}\n        width={width}\n        height={height}\n      />\n    );\n  };\n}\n"],"names":["DEFAULT_MODULE_OPTIONS","pickingSelectedColor","pickingHighlightColor","Uint8Array","pickingActive","pickingAttribute","inject","order","injection","name","vs","fs","getUniforms","opts","uniforms","undefined","selectedColor","slice","picking_uSelectedColorValid","picking_uSelectedColor","color","Array","from","x","Number","isFinite","picking_uHighlightColor","picking_uActive","Boolean","picking_uAttribute","DEFAULT_COLOR","defaultProps","radiusUnits","radiusScale","type","min","value","radiusMinPixels","radiusMaxPixels","MAX_SAFE_INTEGER","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","stroked","filled","billboard","getPosition","position","getRadius","getFillColor","getLineColor","getLineWidth","strokeWidth","deprecatedFor","outline","getColor","ScatterplotLayer","getShaders","super","modules","project32","picking","initializeState","this","getAttributeManager","addInstanced","instancePositions","size","fp64","use64bitPositions","transition","accessor","instanceRadius","defaultValue","instanceFillColors","props","colorFormat","length","normalized","instanceLineColors","instanceLineWidths","updateState","oldProps","changeFlags","extensionsChanged","_this$state$model","gl","context","state","model","delete","_getModel","invalidateAll","draw","viewport","pointRadiusMultiplier","metersPerPixel","lineWidthMultiplier","setUniforms","id","geometry","drawMode","vertexCount","attributes","positions","Float32Array","isInstanced","layerName","StyledLegend","styled","theme","typography","sizes","s","colors","grayscale","light5","gridUnit","light2","base","categoryDelimiter","propTypes","categories","PropTypes","forceCategorical","format","showSingleCategory","toggleCategory","Legend","React","numValue","parseFloat","formatNumber","formatCategoryLabel","k","values","split","render","Object","keys","entries","map","v","style","join","icon","enabled","key","href","onClick","onDoubleClick","charAt","METER_TO_MILE","setTooltipContent","formData","verboseMap","o","label","point_radius_fixed","getMetricLabel","className","TooltipRow","t","object","cat_color","metric","getLayer","payload","onAddFilter","setTooltip","datasource","fd","dataWithRadius","data","features","d","radius","unit","point_unit","num","Math","sqrt","PI","multiplier","c","color_picker","r","g","b","a","slice_id","min_radius","max_radius","commonLayerProps","createCategoricalDeckGLComponent","getScale","CategoricalColorNamespace","getPoints","height","mapboxApiKey","setControlValue","width","CategoricalDeckGLContainer","constructor","containerRef","tooltip","current","getStateFromProps","getLayers","bind","onValuesChange","UNSAFE_componentWillReceiveProps","nextProps","form_data","setState","isArray","getStep","timestamps","f","__timestamp","fixedColor","colorFn","color_scheme","forEach","hasOwnProperty","dimension","hexToRGB","sliceId","getCategories","granularity","time_grain_sqla","start","end","disabled","getPlaySliderParams","autozoom","fitViewport","points","zoom","selected","lastClick","addColor","js_data_mutator","sandboxedEval","jsFnMutator","filter","cats","category","categoryState","every","AnimatableDeckGLContainer","ref","mapboxApiAccessToken","mapStyle","mapbox_style","legend_format","legend_position","createDeckGLComponent","Component","layer","computeLayer","onViewportChange","nextFdNoVP","currFdNoVP","DeckGLContainer","layers"],"sourceRoot":""}