(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9848],{11409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_QUERY_EDITOR:()=>A,CHANGE_DATA_PREVIEW_ID:()=>ge,CLEAR_INACTIVE_QUERIES:()=>pe,CLEAR_QUERY_RESULTS:()=>he,CLONE_QUERY_TO_NEW_TAB:()=>w,COLLAPSE_TABLE:()=>P,COST_ESTIMATE_FAILED:()=>_e,COST_ESTIMATE_RETURNED:()=>ve,COST_ESTIMATE_STARTED:()=>fe,CREATE_DATASOURCE_FAILED:()=>Ee,CREATE_DATASOURCE_STARTED:()=>be,CREATE_DATASOURCE_SUCCESS:()=>ye,CtasEnum:()=>Ae,END_QUERY:()=>L,EXPAND_TABLE:()=>k,LOAD_QUERY_EDITOR:()=>te,MERGE_TABLE:()=>N,MIGRATE_QUERY:()=>X,MIGRATE_QUERY_EDITOR:()=>Y,MIGRATE_TABLE:()=>K,MIGRATE_TAB_HISTORY:()=>W,QUERY_EDITOR_PERSIST_HEIGHT:()=>Q,QUERY_EDITOR_SAVED:()=>O,QUERY_EDITOR_SETDB:()=>U,QUERY_EDITOR_SET_AUTORUN:()=>q,QUERY_EDITOR_SET_FUNCTION_NAMES:()=>z,QUERY_EDITOR_SET_QUERY_LIMIT:()=>B,QUERY_EDITOR_SET_SCHEMA:()=>$,QUERY_EDITOR_SET_SELECTED_TEXT:()=>j,QUERY_EDITOR_SET_SQL:()=>V,QUERY_EDITOR_SET_TEMPLATE_PARAMS:()=>H,QUERY_EDITOR_SET_TITLE:()=>F,QUERY_EDITOR_TOGGLE_LEFT_BAR:()=>G,QUERY_FAILED:()=>ue,QUERY_SUCCESS:()=>de,REFRESH_QUERIES:()=>oe,REMOVE_DATA_PREVIEW:()=>me,REMOVE_QUERY:()=>M,REMOVE_QUERY_EDITOR:()=>I,REMOVE_TABLES:()=>D,REQUEST_QUERY_RESULTS:()=>ce,RESET_STATE:()=>Z,RUN_QUERY:()=>ie,SET_ACTIVE_QUERY_EDITOR:()=>ee,SET_ACTIVE_SOUTHPANE_TAB:()=>ne,SET_DATABASES:()=>J,SET_EDITOR_TAB_LAST_UPDATE:()=>Te,SET_TABLES:()=>re,SET_USER_OFFLINE:()=>ae,START_QUERY:()=>se,STOP_QUERY:()=>le,UPDATE_QUERY_EDITOR:()=>x,addDangerToast:()=>Re,addInfoToast:()=>Se,addNewQueryEditor:()=>tt,addQueryEditor:()=>et,addSavedQueryToTabState:()=>vt,addSuccessToast:()=>Ce,addTable:()=>Zt,addWarningToast:()=>Ze,changeDataPreviewId:()=>Ot,clearInactiveQueries:()=>$e,clearQueryResults:()=>He,cloneQueryToNewTab:()=>rt,collapseTable:()=>Nt,convertQueryToClient:()=>Ne,convertQueryToServer:()=>Ie,createCtasDatasource:()=>jt,createDatasource:()=>Ht,createDatasourceFailed:()=>Bt,createDatasourceStarted:()=>qt,createDatasourceSuccess:()=>Vt,estimateQueryCost:()=>Ue,expandTable:()=>It,fetchQueryResults:()=>Qe,formatQuery:()=>Et,getUpToDateQuery:()=>De,loadQueryEditor:()=>ot,mergeTable:()=>Rt,migrateQueryEditorFromLocalStorage:()=>Je,persistEditorHeight:()=>kt,popDatasourceQuery:()=>Ft,popQuery:()=>$t,popSavedQuery:()=>Ut,popStoredQuery:()=>Pt,postStopQuery:()=>Ke,queryEditorSetAndSaveSql:()=>yt,queryEditorSetAutorun:()=>mt,queryEditorSetDb:()=>pt,queryEditorSetQueryLimit:()=>Tt,queryEditorSetSchema:()=>ht,queryEditorSetSelectedText:()=>Ct,queryEditorSetSql:()=>bt,queryEditorSetTemplateParams:()=>St,queryEditorSetTitle:()=>gt,queryFailed:()=>Ve,querySuccess:()=>qe,reFetchQueryResults:()=>wt,reRunQuery:()=>We,refreshQueries:()=>Lt,removeAllOtherQueryEditors:()=>dt,removeDataPreview:()=>je,removeQuery:()=>ut,removeQueryEditor:()=>ct,removeTables:()=>Dt,requestQueryResults:()=>ze,resetState:()=>Le,runQuery:()=>Ge,runQueryFromSqlEditor:()=>Ye,runTablePreviewQuery:()=>At,saveQuery:()=>ft,scheduleQuery:()=>Pe,setActiveQueryEditor:()=>nt,setActiveSouthPaneTab:()=>st,setDatabases:()=>Xe,setEditorTabLastUpdate:()=>ke,setTables:()=>at,setUserOffline:()=>Mt,startQuery:()=>Fe,stopQuery:()=>Be,switchQueryEditor:()=>it,syncTable:()=>xt,toggleLeftBar:()=>lt,updateQueryEditor:()=>Me,updateSavedQuery:()=>_t});var n=r(14670),o=r.n(n),a=r(15926),i=r.n(a),s=r(61988),l=r(31069),c=r(93185),d=r(63137),u=r.n(d),p=r(67523),h=r.n(p),m=r(44814),g=r(72570),f=r(98286),v=r(66785),_=r(3741),b=r(20292),y=r(97381);const E=/^Untitled Query (\d+)$/,T="Untitled Query ",S=function(e,t){void 0===t&&(t=`${T}1`);const r=(0,s.t)(t);if(e.length>0){const t=e.filter((e=>{var t;return null==(t=e.name)?void 0:t.match(E)})).map((e=>+e.name.replace(T,"")));if(t.length>0){const e=Math.max(...t);return(0,s.t)("%s%s",T,e+1)}return r}return r};var C=r(48527),R=r(40511);const Z="RESET_STATE",A="ADD_QUERY_EDITOR",x="UPDATE_QUERY_EDITOR",O="QUERY_EDITOR_SAVED",w="CLONE_QUERY_TO_NEW_TAB",I="REMOVE_QUERY_EDITOR",N="MERGE_TABLE",D="REMOVE_TABLES",L="END_QUERY",M="REMOVE_QUERY",k="EXPAND_TABLE",P="COLLAPSE_TABLE",U="QUERY_EDITOR_SETDB",$="QUERY_EDITOR_SET_SCHEMA",F="QUERY_EDITOR_SET_TITLE",q="QUERY_EDITOR_SET_AUTORUN",V="QUERY_EDITOR_SET_SQL",B="QUERY_EDITOR_SET_QUERY_LIMIT",H="QUERY_EDITOR_SET_TEMPLATE_PARAMS",j="QUERY_EDITOR_SET_SELECTED_TEXT",z="QUERY_EDITOR_SET_FUNCTION_NAMES",Q="QUERY_EDITOR_PERSIST_HEIGHT",G="QUERY_EDITOR_TOGGLE_LEFT_BAR",Y="MIGRATE_QUERY_EDITOR",W="MIGRATE_TAB_HISTORY",K="MIGRATE_TABLE",X="MIGRATE_QUERY",J="SET_DATABASES",ee="SET_ACTIVE_QUERY_EDITOR",te="LOAD_QUERY_EDITOR",re="SET_TABLES",ne="SET_ACTIVE_SOUTHPANE_TAB",oe="REFRESH_QUERIES",ae="SET_USER_OFFLINE",ie="RUN_QUERY",se="START_QUERY",le="STOP_QUERY",ce="REQUEST_QUERY_RESULTS",de="QUERY_SUCCESS",ue="QUERY_FAILED",pe="CLEAR_INACTIVE_QUERIES",he="CLEAR_QUERY_RESULTS",me="REMOVE_DATA_PREVIEW",ge="CHANGE_DATA_PREVIEW_ID",fe="COST_ESTIMATE_STARTED",ve="COST_ESTIMATE_RETURNED",_e="COST_ESTIMATE_FAILED",be="CREATE_DATASOURCE_STARTED",ye="CREATE_DATASOURCE_SUCCESS",Ee="CREATE_DATASOURCE_FAILED",Te="SET_EDITOR_TAB_LAST_UPDATE",Se=g.bM,Ce=g.ws,Re=g.Gb,Ze=g.Dz,Ae={TABLE:"TABLE",VIEW:"VIEW"},xe=(0,s.t)("The query couldn't be loaded"),Oe={id:"remoteId",db_id:"dbId",label:"name",template_parameters:"templateParams"},we=e=>t=>h()(t,((t,r)=>r in e?e[r]:r)),Ie=we(u()(Oe)),Ne=we(Oe);function De(e,t,r){const{sqlLab:{unsavedQueryEditor:n}}=e,o=null!=r?r:t.id;return{...t,...o===n.id&&n}}function Le(e){return(t,r)=>{const{common:n}=r(),o=(0,C.Z)({...(0,b.Z)(),common:n,...e});t({type:Z,sqlLabInitialState:o.sqlLab}),(0,R.$e)(t,o)}}function Me(e){return{type:x,alterations:e}}function ke(e){return{type:Te,timestamp:e}}function Pe(e){return t=>l.Z.post({endpoint:"/savedqueryviewapi/api/create",postPayload:e,stringify:!1}).then((()=>t(Ce((0,s.t)("Your query has been scheduled. To see details of your query, navigate to Saved queries"))))).catch((()=>t(Re((0,s.t)("Your query could not be scheduled")))))}function Ue(e){return(t,r)=>{const{dbId:n,schema:o,sql:a,selectedText:i,templateParams:c}=De(r(),e),d={database_id:n,schema:o,sql:i||a,template_params:JSON.parse(c||"{}")};return Promise.all([t({type:fe,query:e}),l.Z.post({endpoint:"/api/v1/sqllab/estimate/",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}}).then((r=>{let{json:n}=r;return t({type:ve,query:e,json:n})})).catch((r=>(0,f.O$)(r).then((r=>{const n=r.error||r.statusText||(0,s.t)("Failed at retrieving results");return t({type:_e,query:e,error:n})}))))])}}function $e(e){return{type:pe,interval:e}}function Fe(e){return Object.assign(e,{id:e.id?e.id:o().generate(),progress:0,startDttm:(0,m.zO)(),state:e.runAsync?"pending":"running",cached:!1}),{type:se,query:e}}function qe(e,t){return{type:de,query:e,results:t}}function Ve(e,t,r,n){return function(o){const a={has_err:!0,start_offset:e.startDttm,ts:(new Date).getTime()};null==n||n.forEach((e=>{var t;let{error_type:r,extra:n}=e;((null==n||null==(t=n.issue_codes)?void 0:t.map((e=>{let{message:t}=e;return t})))||[r]).forEach((e=>{o((0,y.logEvent)(_.Im,{...a,error_type:r,error_details:e}))}))})),o({type:ue,query:e,msg:t,link:r,errors:n})}}function Be(e){return{type:le,query:e}}function He(e){return{type:he,query:e}}function je(e){return{type:me,table:e}}function ze(e){return{type:ce,query:e}}function Qe(e,t){return function(r){r(ze(e));const n=i().encode({key:e.resultsKey,rows:t||null});return l.Z.get({endpoint:`/api/v1/sqllab/results/?q=${n}`,parseMethod:"json-bigint"}).then((t=>{let{json:n}=t;return r(qe(e,n))})).catch((t=>(0,f.O$)(t).then((t=>{const n=t.error||t.statusText||(0,s.t)("Failed at retrieving results");return r(Ve(e,n,t.link,t.errors))}))))}}function Ge(e){return function(t){t(Fe(e));const r={client_id:e.id,database_id:e.dbId,json:!0,runAsync:e.runAsync,schema:e.schema,sql:e.sql,sql_editor_id:e.sqlEditorId,tab:e.tab,tmp_table_name:e.tempTable,select_as_cta:e.ctas,ctas_method:e.ctas_method,templateParams:e.templateParams,queryLimit:e.queryLimit,expand_data:!0},n=window.location.search||"";return l.Z.post({endpoint:`/api/v1/sqllab/execute/${n}`,body:JSON.stringify(r),headers:{"Content-Type":"application/json"},parseMethod:"json-bigint"}).then((r=>{let{json:n}=r;e.runAsync||t(qe(e,n))})).catch((r=>(0,f.O$)(r).then((r=>{let n=r.error||r.message||r.statusText||(0,s.t)("Unknown error");n.includes("CSRF token")&&(n=(0,s.t)(v.Z.SESSION_TIMED_OUT)),t(Ve(e,n,r.link,r.errors))}))))}}function Ye(e,t,r,n,o,a){return function(i,s){const l=De(s(),t,t.id);i(Ge({dbId:l.dbId,sql:l.selectedText||l.sql,sqlEditorId:l.id,tab:l.name,schema:l.schema,tempTable:n,templateParams:l.templateParams,queryLimit:l.queryLimit||r,runAsync:!!e&&e.allow_run_async,ctas:o,ctas_method:a,updateTabState:!l.selectedText}))}}function We(e){return function(t){t(Ge({...e,id:o().generate()}))}}function Ke(e){return function(t){return l.Z.post({endpoint:"/api/v1/query/stop",body:JSON.stringify({client_id:e.id}),headers:{"Content-Type":"application/json"}}).then((()=>t(Be(e)))).then((()=>t(Ce((0,s.t)("Query was stopped."))))).catch((()=>t(Re((0,s.t)("Failed at stopping query. %s",e.id)))))}}function Xe(e){return{type:J,databases:e}}function Je(e,t,r){return function(n){return l.Z.post({endpoint:"/tabstateview/",postPayload:{queryEditor:e}}).then((o=>{let{json:a}=o;const i={...e,id:a.id.toString()};return n({type:Y,oldQueryEditor:e,newQueryEditor:i}),n({type:W,oldId:e.id,newId:i.id}),Promise.all([...t.map((e=>function(e,t,r){return l.Z.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...e,queryEditorId:t}}}).then((n=>{let{json:o}=n;const a={...e,id:o.id,queryEditorId:t};return r({type:K,oldTable:e,newTable:a})})).catch((()=>r(Ze((0,s.t)("Unable to migrate table schema state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e,i.id,n))),...r.map((e=>function(e,t,r){return l.Z.post({endpoint:encodeURI(`/tabstateview/${t}/migrate_query`),postPayload:{queryId:e}}).then((()=>r({type:X,queryId:e,queryEditorId:t}))).catch((()=>r(Ze((0,s.t)("Unable to migrate query state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e.id,i.id,n)))])})).catch((()=>n(Ze((0,s.t)("Unable to migrate query editor state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}}function et(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.post({endpoint:"/tabstateview/",postPayload:{queryEditor:e}}).then((e=>{let{json:t}=e;return{...t,loaded:!0}})):Promise.resolve({id:o().generate()})).then((r=>{let{id:n,loaded:o}=r;const a={...e,id:n.toString(),loaded:o};return t({type:A,queryEditor:a})})).catch((()=>t(Re((0,s.t)("Unable to add a new tab to the backend. Please contact your administrator.")))))}}function tt(){return function(e,t){const{sqlLab:{queryEditors:r,tabHistory:n,unsavedQueryEditor:o,databases:a},common:i}=t(),l=i.conf.SQLLAB_DEFAULT_DBID,d=r.find((e=>e.id===n[n.length-1])),u=Object.values(a).map((e=>e.id)),p=u.length>0?Math.min(...u):void 0,{dbId:h,schema:m,queryLimit:g,autorun:f}={...r[0],...d,...o.id===(null==d?void 0:d.id)&&o},v=(0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?"":(0,s.t)("-- Note: Unless you save your query, these tabs will NOT persist if you clear your cookies or change browsers.\n\n"),_=S((null==r?void 0:r.map((e=>({...e,...e.id===o.id&&o}))))||[]);return e(et({dbId:h||l||p,schema:null!=m?m:null,autorun:null!=f&&f,sql:`${v}SELECT ...`,queryLimit:g||i.conf.DEFAULT_SQLLAB_LIMIT,name:_}))}}function rt(e,t){return function(r,n){const o=n(),{queryEditors:a,unsavedQueryEditor:i,tabHistory:l}=o.sqlLab,c={...a.find((e=>e.id===l[l.length-1])),...l[l.length-1]===i.id&&i};return r(et({name:(0,s.t)("Copy of %s",c.name),dbId:e.dbId?e.dbId:null,schema:e.schema?e.schema:null,autorun:t,sql:e.sql,queryLimit:c.queryLimit,maxRow:c.maxRow,templateParams:c.templateParams}))}}function nt(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.post({endpoint:encodeURI(`/tabstateview/${e.id}/activate`)}):Promise.resolve()).then((()=>t({type:ee,queryEditor:e}))).catch((r=>404!==r.status?t(Re((0,s.t)("An error occurred while setting the active tab. Please contact your administrator."))):t({type:I,queryEditor:e})))}}function ot(e){return{type:te,queryEditor:e}}function at(e){const t=e.filter((e=>null!==e.description)).map((e=>{const{columns:t,selectStar:r,primaryKey:n,foreignKeys:o,indexes:a,dataPreviewQueryId:i}=e.description;return{dbId:e.database_id,queryEditorId:e.tab_state_id.toString(),schema:e.schema,name:e.table,expanded:e.expanded,id:e.id,dataPreviewQueryId:i,columns:t,selectStar:r,primaryKey:n,foreignKeys:o,indexes:a,isMetadataLoading:!1,isExtraMetadataLoading:!1}}));return{type:re,tables:t}}function it(e,t){return function(r){(0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)&&e&&!e.loaded?l.Z.get({endpoint:encodeURI(`/tabstateview/${e.id}`)}).then((e=>{var n,o;let{json:a}=e;const i={id:a.id.toString(),loaded:!0,name:a.label,sql:a.sql,selectedText:null,latestQueryId:null==(n=a.latest_query)?void 0:n.id,autorun:a.autorun,dbId:a.database_id,templateParams:a.template_params,schema:a.schema,queryLimit:a.query_limit,remoteId:null==(o=a.saved_query)?void 0:o.id,hideLeftBar:a.hide_left_bar};r(ot(i)),r(at(a.table_schemas||[])),r(nt(i)),a.latest_query&&a.latest_query.resultsKey&&r(Qe(a.latest_query,t))})).catch((t=>404!==t.status?r(Re((0,s.t)("An error occurred while fetching tab state"))):r({type:I,queryEditor:e}))):r(nt(e))}}function st(e){return{type:ne,tabId:e}}function lt(e){const t=!e.hideLeftBar;return{type:G,queryEditor:e,hideLeftBar:t}}function ct(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.delete({endpoint:encodeURI(`/tabstateview/${e.id}`)}):Promise.resolve()).then((()=>t({type:I,queryEditor:e}))).catch((()=>t(Re((0,s.t)("An error occurred while removing tab. Please contact your administrator.")))))}}function dt(e){return function(t,r){var n;const{sqlLab:o}=r();null==(n=o.queryEditors)||n.forEach((r=>{r.id!==e.id&&t(ct(r))}))}}function ut(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.delete({endpoint:encodeURI(`/tabstateview/${e.sqlEditorId}/query/${e.id}`)}):Promise.resolve()).then((()=>t({type:M,query:e}))).catch((()=>t(Re((0,s.t)("An error occurred while removing query. Please contact your administrator.")))))}}function pt(e,t){return{type:U,queryEditor:e,dbId:t}}function ht(e,t){return{type:$,queryEditor:e||{},schema:t}}function mt(e,t){return{type:q,queryEditor:e,autorun:t}}function gt(e,t,r){return{type:F,queryEditor:{...e,id:r},name:t}}function ft(e,t){const{id:r,...n}=Ie(e);return r=>l.Z.post({endpoint:"/api/v1/saved_query/",jsonPayload:Ie(n)}).then((n=>{const o=Ne({id:n.json.id,...n.json.result});return r({type:O,query:e,clientId:t,result:o}),r(gt(e,e.name,t)),o})).catch((()=>r(Re((0,s.t)("Your query could not be saved")))))}const vt=(e,t)=>r=>((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.put({endpoint:`/tabstateview/${e.id}`,postPayload:{saved_query_id:t.remoteId}}):Promise.resolve()).catch((()=>{r(Re((0,s.t)("Your query was not properly saved")))})).then((()=>{r(Ce((0,s.t)("Your query was saved")))}));function _t(e,t){const{id:r,...n}=Ie(e);return r=>l.Z.put({endpoint:`/api/v1/saved_query/${e.remoteId}`,jsonPayload:Ie(n)}).then((()=>{r(Ce((0,s.t)("Your query was updated"))),r(gt(e,e.name,t))})).catch((e=>{const t=(0,s.t)("Your query could not be updated");console.error(t,e),r(Re(t))})).then((()=>r(Me(e))))}function bt(e,t,r){return{type:V,queryEditor:e,sql:t,queryId:r}}function yt(e,t,r){return function(n,o){const a=De(o(),e);return n(bt(a,t,r)),(0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.put({endpoint:encodeURI(`/tabstateview/${a.id}`),postPayload:{sql:t,latest_query_id:r}}).catch((()=>n(Re((0,s.t)('An error occurred while storing your query in the backend. To avoid losing your changes, please save your query using the "Save Query" button.'))))):Promise.resolve()}}function Et(e){return function(t,r){const{sql:n}=De(r(),e);return l.Z.post({endpoint:"/api/v1/sqllab/format_sql/",body:JSON.stringify({sql:n}),headers:{"Content-Type":"application/json"}}).then((r=>{let{json:n}=r;t(bt(e,n.result))}))}}function Tt(e,t){return{type:B,queryEditor:e,queryLimit:t}}function St(e,t){return{type:H,queryEditor:e,templateParams:t}}function Ct(e,t){return{type:j,queryEditor:e,sql:t}}function Rt(e,t,r){return{type:N,table:e,query:t,prepend:r}}function Zt(e,t,r){return function(n,a){const i=De(a(),e,e.id);n(Rt({dbId:i.dbId,queryEditorId:i.id,schema:r,name:t,id:o().generate(),expanded:!0},null,!0))}}function At(e){return function(t,r){const{sqlLab:{databases:n}}=r(),a=n[e.dbId],{dbId:i}=e;if(a&&!a.disable_data_preview){const r={id:o().generate(),dbId:i,sql:e.selectStar,tableName:e.name,sqlEditorId:null,tab:"",runAsync:a.allow_run_async,ctas:!1,isDataPreview:!0};return Promise.all([t(Rt({id:e.id,dbId:e.dbId,schema:e.schema,name:e.name,queryEditorId:e.queryEditorId,dataPreviewQueryId:r.id},r)),t(Ge(r))])}return Promise.resolve()}}function xt(e,t){return function(r){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...t,...e}}}):Promise.resolve({json:{id:e.id}})).then((n=>{let{json:o}=n;const a={...e,id:o.id};r(Rt({...a,expanded:!0,initialized:!0})),e.dataPreviewQueryId||r(At({...t,...a}))})).catch((()=>r(Re((0,s.t)("An error occurred while fetching table metadata. Please contact your administrator.")))))}}function Ot(e,t){return{type:ge,oldQueryId:e,newQuery:t}}function wt(e){return function(t){const r={id:o().generate(),dbId:e.dbId,sql:e.sql,tableName:e.tableName,sqlEditorId:null,tab:"",runAsync:!1,ctas:!1,queryLimit:e.queryLimit,isDataPreview:e.isDataPreview};t(Ge(r)),t(Ot(e.id,r))}}function It(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!0}}):Promise.resolve()).then((()=>t({type:k,table:e}))).catch((()=>t(Re((0,s.t)("An error occurred while expanding the table schema. Please contact your administrator.")))))}}function Nt(e){return function(t){return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?l.Z.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!1}}):Promise.resolve()).then((()=>t({type:P,table:e}))).catch((()=>t(Re((0,s.t)("An error occurred while collapsing the table schema. Please contact your administrator.")))))}}function Dt(e){return function(t){var r;const n=null!=(r=null==e?void 0:e.filter(Boolean))?r:[];return((0,c.cr)(c.TT.SQLLAB_BACKEND_PERSISTENCE)?Promise.all(n.map((e=>l.Z.delete({endpoint:encodeURI(`/tableschemaview/${e.id}`)})))):Promise.resolve()).then((()=>t({type:D,tables:n}))).catch((()=>t(Re((0,s.t)("An error occurred while removing the table schema. Please contact your administrator.")))))}}function Lt(e){return{type:oe,alteredQueries:e}}function Mt(e){return{type:ae,offline:e}}function kt(e,t,r){return{type:Q,queryEditor:e,northPercent:t,southPercent:r}}function Pt(e){return function(t){return l.Z.get({endpoint:`/kv/${e}`}).then((e=>{let{json:r}=e;return t(et({name:r.name?r.name:(0,s.t)("Shared query"),dbId:r.dbId?parseInt(r.dbId,10):null,schema:r.schema?r.schema:null,autorun:!!r.autorun&&r.autorun,sql:r.sql?r.sql:"SELECT ...",templateParams:r.templateParams}))})).catch((()=>t(Re(xe))))}}function Ut(e){return function(t){return l.Z.get({endpoint:`/savedqueryviewapi/api/get/${e}`}).then((e=>{let{json:r}=e;const n={...Ne(r.result),loaded:!0,autorun:!1};return t(et(n))})).catch((()=>t(Re(xe))))}}function $t(e){return function(t){return l.Z.get({endpoint:`/api/v1/query/${e}`}).then((e=>{let{json:r}=e;const n=r.result,o={dbId:n.database.id,schema:n.schema,sql:n.sql,name:(0,s.t)("Copy of %s",n.tab_name),autorun:!1};return t(et(o))})).catch((()=>t(Re(xe))))}}function Ft(e,t){return function(r){const n=(0,s.t)("Query"),o=e.split("__")[0],a=i().encode({keys:["none"],columns:["name","schema","database.id","select_star"]});return l.Z.get({endpoint:`/api/v1/dataset/${o}?q=${a}`}).then((e=>{let{json:o}=e;return r(et({name:`${n} ${o.result.name}`,dbId:o.result.database.id,schema:o.result.schema,autorun:void 0!==t,sql:t||o.result.select_star}))})).catch((()=>r(Re((0,s.t)("The datasource couldn't be loaded")))))}}function qt(){return{type:be}}function Vt(e){const t=`${e.id}__table`;return{type:ye,datasource:t}}function Bt(e){return{type:Ee,err:e}}function Ht(e){return t=>{t(qt());const{dbId:r,schema:n,datasourceName:o,sql:a}=e;return l.Z.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:r,schema:n,sql:a,table_name:o,is_managed_externally:!1,external_url:null})}).then((e=>{let{json:r}=e;return t(Vt(r)),Promise.resolve(r)})).catch((e=>((0,f.O$)(e).then((e=>{t(Re(e.error))})),t(Bt((0,s.t)("An error occurred while creating the data source"))),Promise.reject())))}}function jt(e){return t=>(t(qt()),l.Z.post({endpoint:"/api/v1/dataset/get_or_create/",jsonPayload:e}).then((e=>{let{json:r}=e;return t(Vt(r.result)),r.result})).catch((()=>{const e=(0,s.t)("An error occurred while creating the data source");return t(Bt(e)),Promise.reject(new Error(e))})))}},40511:(e,t,r)=>{"use strict";r.d(t,{$e:()=>p,NU:()=>d,St:()=>u,uQ:()=>c});var n=r(78718),o=r.n(n),a=r(23936),i=r(44904);const s=new Set(["version","remoteId","autorun","dbId","height","id","latestQueryId","northPercent","queryLimit","schema","selectedText","southPercent","sql","templateParams","name","hideLeftBar"]);function l(e){var t;const{startDttm:r,results:n}=e;return Date.now()-r>i.U$||((null==(t=JSON.stringify(n))?void 0:t.length)||0)*i.TU/i.Yo>i.zf}function c(e){return e.map((e=>o()(e,["id","name","dbId","schema","dataPreviewQueryId","queryEditorId"]))).filter((e=>{let{queryEditorId:t}=e;return Boolean(t)}))}function d(e){return Object.keys(e).reduce(((t,r)=>{const{results:n}=e[r];return{...t,[r]:{...e[r],results:l(e[r])?{}:n}}}),{})}function u(e){return e.map((e=>Object.keys(e).filter((e=>s.has(e))).reduce(((t,r)=>({...t,[r]:e[r]})),{})))}function p(e,t){t.sqlLab.tables.forEach((t=>{let{name:r,schema:n,dbId:o,persistData:i}=t;o&&n&&r&&null!=i&&i.columns&&(e(a.$K.upsertQueryData("tableMetadata",{dbId:o,schema:n,table:r},i)),e(a.$K.upsertQueryData("tableExtendedMetadata",{dbId:o,schema:n,table:r},{})))}))}},52256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_CHART:()=>J,ANNOTATION_QUERY_FAILED:()=>P,ANNOTATION_QUERY_STARTED:()=>M,ANNOTATION_QUERY_SUCCESS:()=>D,CHART_RENDERING_FAILED:()=>A,CHART_RENDERING_SUCCEEDED:()=>O,CHART_UPDATE_FAILED:()=>R,CHART_UPDATE_STARTED:()=>b,CHART_UPDATE_STOPPED:()=>S,CHART_UPDATE_SUCCEEDED:()=>E,DYNAMIC_PLUGIN_CONTROLS_READY:()=>$,GET_SAVED_CHART:()=>re,POST_CHART_FORM_DATA:()=>oe,REMOVE_CHART:()=>I,RENDER_TRIGGERED:()=>Q,TRIGGER_QUERY:()=>j,UPDATE_CHART_ID:()=>K,UPDATE_QUERY_FORM_DATA:()=>Y,addChart:()=>ee,annotationQueryFailed:()=>U,annotationQueryStarted:()=>k,annotationQuerySuccess:()=>L,chartRenderingFailed:()=>x,chartRenderingSucceeded:()=>w,chartUpdateFailed:()=>Z,chartUpdateStarted:()=>y,chartUpdateStopped:()=>C,chartUpdateSucceeded:()=>T,dynamicPluginControlsReady:()=>F,exploreJSON:()=>te,getChartDataRequest:()=>B,getDatasourceSamples:()=>le,getSavedChart:()=>ne,postChartFormData:()=>ae,redirectSQLLab:()=>ie,refreshChart:()=>se,removeChart:()=>N,renderTriggered:()=>G,runAnnotationQuery:()=>H,triggerQuery:()=>z,updateChartId:()=>X,updateQueryFormData:()=>W});var n=r(30381),o=r.n(n),a=r(93185),i=r(31069),s=r(61988),l=r(37731),c=r(35854),d=r(12515),u=r(72570),p=r(97381),h=r(3741),m=r(98286),g=r(86374),f=r(74599),v=r(77997),_=r(9679);const b="CHART_UPDATE_STARTED";function y(e,t,r){return{type:b,queryController:e,latestQueryFormData:t,key:r}}const E="CHART_UPDATE_SUCCEEDED";function T(e,t){return{type:E,queriesResponse:e,key:t}}const S="CHART_UPDATE_STOPPED";function C(e){return{type:S,key:e}}const R="CHART_UPDATE_FAILED";function Z(e,t){return{type:R,queriesResponse:e,key:t}}const A="CHART_RENDERING_FAILED";function x(e,t,r){return{type:A,error:e,key:t,stackTrace:r}}const O="CHART_RENDERING_SUCCEEDED";function w(e){return{type:O,key:e}}const I="REMOVE_CHART";function N(e){return{type:I,key:e}}const D="ANNOTATION_QUERY_SUCCESS";function L(e,t,r){return{type:D,annotation:e,queryResponse:t,key:r}}const M="ANNOTATION_QUERY_STARTED";function k(e,t,r){return{type:M,annotation:e,queryController:t,key:r}}const P="ANNOTATION_QUERY_FAILED";function U(e,t,r){return{type:P,annotation:e,queryResponse:t,key:r}}const $="DYNAMIC_PLUGIN_CONTROLS_READY",F=()=>(e,t)=>{const r=t(),n=(0,c.R3)(r.explore,r.explore.form_data);e({type:$,key:n.slice_id.value,controlsState:n})},q=async function(e,t,r,n,o,s,l){var c;void 0===o&&(o="POST"),void 0===s&&(s={});const u=(0,d.pd)({resultFormat:t,resultType:r}),p=g._&&(null==(c=s)?void 0:c.dashboard_id),h=(0,d.H6)({formData:e,endpointType:u,force:n,allowDomainSharding:p,method:o,requestParams:s.dashboard_id?{dashboard_id:s.dashboard_id}:{}}),m={...s,url:h,postPayload:{form_data:e},parseMethod:l};return((0,a.cr)(a.TT.CLIENT_CACHE)?i.Z.get:i.Z.post)(m).then((e=>{let{json:t,response:r}=e;return{response:r,json:{result:[t]}}}))},V=async(e,t,r,n,o,a,s,l)=>{const c=(0,d.u)({formData:e,resultType:r,resultFormat:t,force:n,setDataMask:a,ownState:s}),{slice_id:u}=e,{dashboard_id:p}=o,h={};void 0!==u&&(h.form_data=`{"slice_id":${u}}`),void 0!==p&&(h.dashboard_id=p),n&&(h.force=n);const m=g._&&(null==o?void 0:o.dashboard_id),f=(0,d.kN)({path:"/api/v1/chart/data",qs:h,allowDomainSharding:m}).toString(),v={...o,url:f,headers:{"Content-Type":"application/json"},body:JSON.stringify(c),parseMethod:l};return i.Z.post(v)};async function B(e){let{formData:t,setDataMask:r=(()=>{}),resultFormat:n="json",resultType:o="full",force:a=!1,method:i="POST",requestParams:s={},ownState:l={}}=e,c={...s};g._&&(c={...c,mode:"cors",credentials:"include"});const[u,p]=(0,d.hz)(t);return u?q(t,n,o,a,i,c,p):V(t,n,o,a,c,r,l,p)}function H(e){let{annotation:t,timeout:r=60,formData:n=null,key:o,isDashboardRequest:a=!1,force:s=!1}=e;return function(e,l){var c;const u=o||Object.keys(l().charts)[0],p={...n||l().charts[u].latestQueryFormData};if(!t.sourceType)return Promise.resolve();p.time_grain_sqla=p.time_grain_sqla||p.granularity,p.granularity=p.granularity_sqla;const h=Object.keys(t.overrides);(h.includes("since")||h.includes("until"))&&(t.overrides={...t.overrides,time_range:null});const g=Object.keys(t.overrides).reduce(((e,r)=>({...e,[r]:t.overrides[r]||p[r]})),{});if(!a&&p){const e=p.extra_filters&&p.extra_filters.length>0;g.extra_filters=e?p.extra_filters:void 0}const f=(0,d.xW)(t.value,s),v=new AbortController,{signal:_}=v;e(k(t,v,u));const b=null==p||null==(c=p.annotation_layers)?void 0:c.findIndex((e=>e.name===t.name));return b>=0&&(p.annotation_layers[b].overrides=g),i.Z.post({url:f,signal:_,timeout:1e3*r,headers:{"Content-Type":"application/json"},jsonPayload:(0,d.u)({formData:p,force:s,resultFormat:"json",resultType:"full"})}).then((r=>{var n,o,a;let{json:i}=r;const s=null==i||null==(n=i.result)||null==(o=n[0])||null==(a=o.annotation_data)?void 0:a[t.name];return e(L(t,{data:s},u))})).catch((r=>(0,m.O$)(r).then((r=>{"timeout"===r.statusText?e(U(t,{error:"Query timeout"},u)):(r.error||"").toLowerCase().includes("no data")?e(L(t,r,u)):"abort"!==r.statusText&&e(U(t,r,u))}))))}}const j="TRIGGER_QUERY";function z(e,t){return void 0===e&&(e=!0),{type:j,value:e,key:t}}const Q="RENDER_TRIGGERED";function G(e,t){return{type:Q,value:e,key:t}}const Y="UPDATE_QUERY_FORM_DATA";function W(e,t){return{type:Y,value:e,key:t}}const K="UPDATE_CHART_ID";function X(e,t){return void 0===t&&(t=0),{type:K,newId:e,key:t}}const J="ADD_CHART";function ee(e,t){return{type:J,chart:e,key:t}}function te(e,t,r,n,i,s,l){return void 0===t&&(t=!1),void 0===r&&(r=60),async c=>{const u=h.Yd.getTimestamp(),g=new AbortController,_={signal:g.signal,timeout:1e3*r};s&&(_.dashboard_id=s);const b=B({setDataMask:t=>{c((0,f.eG)(e.slice_id,t))},formData:e,resultFormat:"json",resultType:"full",force:t,method:i,requestParams:_,ownState:l});c(y(g,e,n));const E=b.then((t=>{let{response:r,json:n}=t;if((0,a.cr)(a.TT.GLOBAL_ASYNC_QUERIES)){const t="result"in n?n.result:n,[o]=(0,d.hz)(e);switch(r.status){case 200:return Promise.resolve(t);case 202:return o?(0,v.YJ)(t[0]):(0,v.YJ)(t);default:throw new Error(`Received unexpected response status (${r.status}) while fetching chart data`)}}return n.result})).then((r=>(r.forEach((r=>c((0,p.logEvent)(h.W9,{slice_id:n,applied_filters:r.applied_filters,is_cached:r.is_cached,force_refresh:t,row_count:r.rowcount,datasource:e.datasource,start_offset:u,ts:(new Date).getTime(),duration:h.Yd.getTimestamp()-u,has_extra_filters:e.extra_filters&&e.extra_filters.length>0,viz_type:e.viz_type,data_age:r.is_cached?o()(new Date).diff(o().utc(r.cached_dttm)):null})))),c(T(r,n))))).catch((t=>{if((0,a.cr)(a.TT.GLOBAL_ASYNC_QUERIES))return c(Z([t],n));const r=(t,r)=>{c((0,p.logEvent)(h.W9,{slice_id:n,has_err:!0,is_cached:r,error_details:t,datasource:e.datasource,start_offset:u,ts:(new Date).getTime(),duration:h.Yd.getTimestamp()-u}))};return"AbortError"===t.name?(r("abort"),c(C(n))):(0,m.O$)(t).then((e=>("timeout"===t.statusText?r("timeout"):r(e.error,e.is_cached),c(Z([e],n)))))})),[S]=(0,d.hz)(e),R=S&&e.annotation_layers||[],A=s>0;return Promise.all([E,c(z(!1,n)),c(W(e,n)),...R.map((o=>c(H({annotation:o,timeout:r,formData:e,key:n,isDashboardRequest:A,force:t}))))])}}const re="GET_SAVED_CHART";function ne(e,t,r,n,o,a){return void 0===t&&(t=!1),void 0===r&&(r=60),te(e,t,r,n,"GET",o,a)}const oe="POST_CHART_FORM_DATA";function ae(e,t,r,n,o,a){return void 0===t&&(t=!1),void 0===r&&(r=60),te(e,t,r,n,"POST",o,a)}function ie(e,t){return r=>{B({formData:e,resultFormat:"json",resultType:"query"}).then((r=>{let{json:n}=r;const o="/sqllab/",a={datasourceKey:e.datasource,sql:n.result[0].query};t?t.push({pathname:o,state:{requestedQuery:a}}):i.Z.postForm(o,{form_data:(0,_.o)(a)})})).catch((()=>r((0,u.Gb)((0,s.t)("An error occurred while loading the SQL")))))}}function se(e,t,r){return(n,o)=>{var a;const i=(o().charts||{})[e],s=o().dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT;i.latestQueryFormData&&0!==Object.keys(i.latestQueryFormData).length&&n(ae(i.latestQueryFormData,t,s,i.id,r,null==(a=o().dataMask[i.id])?void 0:a.ownState))}}const le=async(e,t,r,n,o,a)=>{try{const s={force:r,datasource_type:e,datasource_id:t};return(0,l.Z)(o)&&(0,l.Z)(a)&&(s.per_page=o,s.page=a),(await i.Z.post({endpoint:"/datasource/samples",jsonPayload:n,searchParams:s})).json.result}catch(e){const t=await(0,m.O$)(e);throw new Error(t.message||t.error||(0,s.t)("Sorry, an error occurred"),{cause:e})}}},13433:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(67294),o=r(45697),a=r.n(o),i=r(61988),s=r(58593),l=r(14114),c=r(10222),d=r(11965);const u={copyNode:a().node,getText:a().func,onCopyEnd:a().func,shouldShowText:a().bool,text:a().string,wrapped:a().bool,tooltipText:a().string,addDangerToast:a().func.isRequired,addSuccessToast:a().func.isRequired,hideTooltip:a().bool},p={copyNode:(0,d.tZ)("span",null,(0,i.t)("Copy")),onCopyEnd:()=>{},shouldShowText:!0,wrapped:!0,tooltipText:(0,i.t)("Copy to clipboard"),hideTooltip:!1};var h={name:"8irbms",styles:"display:inline-flex;align-items:center"};class m extends n.Component{constructor(e){super(e),this.copyToClipboard=this.copyToClipboard.bind(this),this.onClick=this.onClick.bind(this)}onClick(){this.props.getText?this.props.getText((e=>{this.copyToClipboard(Promise.resolve(e))})):this.copyToClipboard(Promise.resolve(this.props.text))}getDecoratedCopyNode(){return n.cloneElement(this.props.copyNode,{style:{cursor:"pointer"},onClick:this.onClick})}copyToClipboard(e){(0,c.Z)((()=>e)).then((()=>{this.props.addSuccessToast((0,i.t)("Copied to clipboard!"))})).catch((()=>{this.props.addDangerToast((0,i.t)("Sorry, your browser does not support copying. Use Ctrl / Cmd + C!"))})).finally((()=>{this.props.onCopyEnd()}))}renderTooltip(e){return(0,d.tZ)(n.Fragment,null,this.props.hideTooltip?this.getDecoratedCopyNode():(0,d.tZ)(s.u,{id:"copy-to-clipboard-tooltip",placement:"topRight",style:{cursor:e},title:this.props.tooltipText,trigger:["hover"],arrowPointAtCenter:!0},this.getDecoratedCopyNode()))}renderNotWrapped(){return this.renderTooltip("pointer")}renderLink(){return(0,d.tZ)("span",{css:h},this.props.shouldShowText&&this.props.text&&(0,d.tZ)("span",{className:"m-r-5"},this.props.text),this.renderTooltip())}render(){const{wrapped:e}=this.props;return e?this.renderLink():this.renderNotWrapped()}}const g=(0,l.ZP)(m);m.propTypes=u,m.defaultProps=p},57902:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(67294),o=r(45697),a=r.n(o),i=r(61988),s=r(72875),l=r(11965);const c={children:a().node.isRequired,onError:a().func,showMessage:a().bool};class d extends n.Component{constructor(e){super(e),this.state={error:null,info:null}}componentDidCatch(e,t){this.props.onError&&this.props.onError(e,t),this.setState({error:e,info:t})}render(){const{error:e,info:t}=this.state;if(e){const r=e.toString(),n=(0,l.tZ)("span",null,(0,l.tZ)("strong",null,(0,i.t)("Unexpected error")),r?`: ${r}`:"");return this.props.showMessage?(0,l.tZ)(s.Z,{subtitle:n,copyText:n,stackTrace:t?t.componentStack:null}):null}return this.props.children}}d.propTypes=c,d.defaultProps={onError:()=>{},showMessage:!0}},81395:(e,t,r)=>{"use strict";function n(e,t){return e().dashboardState.sliceIds.includes(t)}r.d(t,{KJ:()=>a,M6:()=>c,P_:()=>h,cK:()=>m,fK:()=>o,ib:()=>p,ku:()=>s,l3:()=>i,l6:()=>g,oT:()=>d,oW:()=>l,yz:()=>u});const o="ADD_FILTER";function a(e,t,r){return(a,i)=>n(i,e)?a({type:o,chartId:e,component:t,form_data:r}):i().dashboardFilters}const i="REMOVE_FILTER";function s(e){return(t,r)=>n(r,e)?t({type:i,chartId:e}):r().dashboardFilters}const l="CHANGE_FILTER";function c(e,t,r){return(o,a)=>{if(n(a,e)){const n=a().dashboardLayout.present;return o({type:l,chartId:e,newSelectedValues:t,merge:r,components:n})}return a().dashboardFilters}}const d="UPDATE_DIRECT_PATH_TO_FILTER";function u(e,t){return(r,o)=>n(o,e)?r({type:d,chartId:e,path:t}):o().dashboardFilters}const p="UPDATE_LAYOUT_COMPONENTS";function h(e){return t=>{t({type:p,components:e})}}const m="UPDATE_DASHBOARD_FILTERS_SCOPE";function g(e){return t=>{t({type:m,scopes:e})}}},12885:(e,t,r)=>{"use strict";r.d(t,{J0:()=>y,YA:()=>T,bK:()=>f,CB:()=>_,Mu:()=>C,L1:()=>w,aZ:()=>x,qL:()=>Z,nj:()=>p,x_:()=>L,LM:()=>E,Ww:()=>v,v7:()=>b,g3:()=>R,_p:()=>I,az:()=>D,iO:()=>A,Ou:()=>N,WZ:()=>m,A7:()=>g});var n=r(21090),o=r(61988),a=r(72570),i=r(81255),s=r(80621),l=r(47456),c=r(95173),d=r(81395),u=r(9467);const p="UPDATE_COMPONENTS";function h(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(t,n)=>{const o=e(...r);t("function"==typeof o?o(t,n):o);const{dashboardLayout:a,dashboardState:i}=n();if(o.type!==p||!o.payload||!o.payload.nextComponents){const e=a.present;t((0,d.P_)(e))}i.hasUnsavedChanges||t((0,u.if)(!0))}}}const m=h((e=>({type:p,payload:{nextComponents:e}})));function g(e){return(t,r)=>{const{dashboardLayout:n}=r();t(m({[s.M2]:{...n.present[s.M2],meta:{text:e}}}))}}const f="DASHBOARD_TITLE_CHANGED";function v(e){return{type:f,text:e}}const _="DELETE_COMPONENT",b=h(((e,t)=>({type:_,payload:{id:e,parentId:t}}))),y="CREATE_COMPONENT",E=h((e=>({type:y,payload:{dropResult:e}}))),T="CREATE_TOP_LEVEL_TABS",S=h((e=>({type:T,payload:{dropResult:e}}))),C="DELETE_TOP_LEVEL_TABS",R=h((()=>({type:C,payload:{}}))),Z="RESIZE_COMPONENT";function A(e){let{id:t,width:r,height:n}=e;return(e,o)=>{const{dashboardLayout:a}=o(),{present:i}=a,s=i[t],l=r&&s.meta.width!==r,c=n&&s.meta.height!==n;if(s&&(l||c)){const o={[t]:{...s,meta:{...s.meta,width:r||s.meta.width,height:n||s.meta.height}}};e(m(o))}}}const x="MOVE_COMPONENT",O=h((e=>({type:x,payload:{dropResult:e}}))),w="HANDLE_COMPONENT_DROP";function I(e){return(t,r)=>{const n=function(e,t){const r=(0,l.Z)({dropResult:e,layout:t});return"number"==typeof r&&r<0}(e,r().dashboardLayout.present);if(n)return t((0,a.Dz)((0,o.t)("There is not enough space for this component. Try decreasing its width, or increasing the destination width.")));const{source:d,destination:u}=e,p=u&&u.id===s._4,h=d.id===s.D0,m=r().dashboardLayout.present[s._4],g=m&&m.children?m.children[0]:"";if(p)t(S(e));else if(u&&h)t(E(e));else{if(d.type===i.yR&&u.type===i.yR&&d.id===g&&u.id!==g)return t((0,a.Dz)((0,o.t)("Can not move top level tab into nested tabs")));u&&d&&(u.id!==d.id||u.index!==d.index)&&t(O(e))}const{dashboardFilters:f,dashboardLayout:v}=r();if(!h){const{present:e}=v,r=e[d.id]||{},n=e[u.id]||{};if((r.type===i.yR||r.type===i.Os)&&r.children&&0===r.children.length){const r=(0,c.Z)({childId:d.id,layout:e});t(b(d.id,r))}(function(e){let{dashboardFilters:t={},source:r=[],destination:n=[]}=e;const o=new Set(r),a=new Set(n);return[].concat(...Object.values(t).map((e=>{let{scopes:t}=e;return[].concat(...Object.values(t).map((e=>{let{scope:t}=e;return t})))}))).some((e=>a.has(e)!==o.has(e)))})({dashboardFilters:f,source:(r.parents||[]).concat(d.id),destination:(n.parents||[]).concat(u.id)})&&t((0,a.Dz)((0,o.t)("This chart has been moved to a different filter scope.")))}return null}}function N(){return(e,t)=>{e(n.zF.undo());const{dashboardLayout:r,dashboardState:o}=t();0!==r.past.length||o.maxUndoHistoryExceeded||o.updatedColorScheme||e((0,u.if)(!1))}}const D=h(n.zF.redo),L="UPDATE_COMPONENTS_PARENTS_LIST"},9467:(e,t,r)=>{"use strict";r.d(t,{BD:()=>D,P0:()=>Q,bs:()=>le,sm:()=>ce,ec:()=>pe,k5:()=>ue,Ii:()=>Y,Vd:()=>L,qJ:()=>ne,hD:()=>re,om:()=>Te,nV:()=>Ce,J$:()=>_e,FF:()=>Le,RU:()=>ye,$f:()=>j,mq:()=>Re,r$:()=>Oe,n1:()=>Ie,w9:()=>ee,yV:()=>K,ee:()=>I,oJ:()=>me,ek:()=>q,Z9:()=>M,H9:()=>$,Iw:()=>Ae,Be:()=>B,Pi:()=>fe,Mn:()=>ie,Lb:()=>P,Qt:()=>De,z2:()=>G,YC:()=>de,Yy:()=>he,Vv:()=>W,rL:()=>ve,M8:()=>ae,TN:()=>U,dr:()=>F,r7:()=>Se,uW:()=>be,sL:()=>Me,E2:()=>Ee,Mb:()=>z,GH:()=>Ze,zL:()=>we,uN:()=>Ne,Qo:()=>te,fE:()=>X,if:()=>N,O8:()=>ge,WL:()=>V,oY:()=>xe,Sn:()=>H});var n=r(21090),o=r(15926),a=r.n(o),i=r(31069),s=r(61988),l=r(55786),c=r(93185),d=r(78161),u=r(52256),p=r(37863),h=r(35854),m=r(98286),g=r(80621),f=r(52838),v=r(72570),_=r(11370),b=r(43399),y=r(9679),E=r(97381),T=r(3741),S=r(12885),C=r(41295),R=r(50810),Z=r(81395),A=r(52794),x=r(9531);const O=new Set(["json_metadata","position_json"]);function w(e,t){return t.split(".").reduce(((e,t)=>{const r=null==e?void 0:e[t];return O.has(t)&&r?JSON.parse(r):r}),e)}const I="SET_UNSAVED_CHANGES";function N(e){return{type:I,payload:{hasUnsavedChanges:e}}}const D="ADD_SLICE",L="REMOVE_SLICE",M="TOGGLE_FAVE_STAR";function k(e){return{type:M,isStarred:e}}function P(e){return function(t){return i.Z.get({endpoint:`/api/v1/dashboard/favorite_status/?q=${a().encode([e])}`}).then((e=>{var r,n;let{json:o}=e;t(k(!(null==o||null==(r=o.result)||null==(n=r[0])||!n.value)))})).catch((()=>t((0,v.Gb)((0,s.t)("There was an issue fetching the favorite status of this dashboard.")))))}}function U(e,t){return function(r){const n=`/api/v1/dashboard/${e}/favorites/`;return(t?i.Z.delete({endpoint:n}):i.Z.post({endpoint:n})).then((()=>{r(k(!t))})).catch((()=>r((0,v.Gb)((0,s.t)("There was an issue favoriting this dashboard.")))))}}const $="TOGGLE_PUBLISHED";function F(e,t){return function(r){return i.Z.put({endpoint:`/api/v1/dashboard/${e}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({published:t})}).then((()=>{r((0,v.ws)(t?(0,s.t)("This dashboard is now published"):(0,s.t)("This dashboard is now hidden"))),r(function(e){return{type:$,isPublished:e}}(t))})).catch((()=>{r((0,v.Gb)((0,s.t)("You do not have permissions to edit this dashboard.")))}))}}const q="TOGGLE_EXPAND_SLICE";function V(e){return{type:q,sliceId:e}}const B="UPDATE_CSS";function H(e){return{type:B,css:e}}const j="SET_EDIT_MODE";function z(e){return{type:j,editMode:e}}const Q="ON_CHANGE";function G(){return{type:Q}}const Y="ON_SAVE";function W(e){return{type:Y,lastModifiedTime:e}}const K="SET_REFRESH_FREQUENCY";function X(e,t){return void 0===t&&(t=!1),{type:K,refreshFrequency:e,isPersistent:t}}function J(e){return t=>{t(W(e)),t(n.zF.clearHistory())}}const ee="SET_OVERRIDE_CONFIRM";function te(e){return{type:ee,overwriteConfirmMetadata:e}}const re="SAVE_DASHBOARD_STARTED",ne="SAVE_DASHBOARD_FINISHED";function oe(){return{type:ne}}function ae(e,t,r){return(n,o)=>{var a,d,u,p,h,R,I,N,D;n({type:S.x_}),n({type:re});const{dashboardFilters:L,dashboardLayout:M}=o(),k=M.present;Object.values(L).forEach((e=>{var t;const{chartId:r}=e,o=e.directPathToFilter.slice().pop(),a=((null==(t=k[o])?void 0:t.parents)||[]).slice();a.push(o),n((0,Z.yz)(r,a))}));const P=(0,_.Z)((0,b.De)()),U=function(e){return Object.values(e).reduce(((e,t)=>{let{chartId:r,scopes:n}=t;return{...e,[r]:Object.keys(n).reduce(((e,t)=>({...e,[t]:n[t]})),{})}}),{})}(L),{certified_by:$,certification_details:F,css:q,dashboard_title:V,owners:B,roles:H,slug:j}=e,z=e=>void 0!==e.id,Q=null==(a=e.metadata)?void 0:a.cross_filters_enabled,G={...e,certified_by:$||"",certification_details:$&&F?F:"",css:q||"",dashboard_title:V||(0,s.t)("[ untitled dashboard ]"),owners:(0,l.Z)(B).map((e=>z(e)?e.id:e)),roles:(0,c.cr)(c.TT.DASHBOARD_RBAC)?(0,l.Z)(H).map((e=>z(e)?e.id:e)):void 0,slug:j||null,metadata:{...e.metadata,color_namespace:(null==(d=e.metadata)?void 0:d.color_namespace)||void 0,color_scheme:(null==(u=e.metadata)?void 0:u.color_scheme)||"",color_scheme_domain:(null==(p=e.metadata)?void 0:p.color_scheme_domain)||[],expanded_slices:(null==(h=e.metadata)?void 0:h.expanded_slices)||{},label_colors:(null==(R=e.metadata)?void 0:R.label_colors)||{},shared_label_colors:(null==(I=e.metadata)?void 0:I.shared_label_colors)||{},refresh_frequency:(null==(N=e.metadata)?void 0:N.refresh_frequency)||0,timed_refresh_immune_slices:(null==(D=e.metadata)?void 0:D.timed_refresh_immune_slices)||[],cross_filters_enabled:(0,f.U)(Q)}},Y=()=>{const{dashboardLayout:e,charts:t,dashboardInfo:{metadata:r}}=o();return(0,f.g)(e.present,r,t)},W=async e=>{const{error:t,message:r}=await(0,m.O$)(e);let o=(0,s.t)("Sorry, an unknown error occurred");t&&(o=(0,s.t)("Sorry, there was an error saving this dashboard: %s",t)),"string"==typeof r&&"Forbidden"===r&&(o=(0,s.t)("You do not have permission to edit this dashboard")),n(oe()),n((0,v.Gb)(o))};if([g.TN,g.NT].includes(r)){let o={},a={};(0,c.cr)(c.TT.DASHBOARD_CROSS_FILTERS)&&({chartConfiguration:o,globalChartConfiguration:a}=Y());const l=r===g.NT?e:{certified_by:G.certified_by,certification_details:G.certification_details,css:G.css,dashboard_title:G.dashboard_title,slug:G.slug,owners:G.owners,roles:G.roles,json_metadata:(0,y.o)({...(null==G?void 0:G.metadata)||{},default_filters:(0,y.o)(P),filter_scopes:U,chart_configuration:o,global_chart_configuration:a})},d=()=>i.Z.put({endpoint:`/api/v1/dashboard/${t}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then((e=>(e=>{const r=e.json.result,o=e.json.last_modified_time;if(r.json_metadata){const e=JSON.parse(r.json_metadata);n((0,C.a8)({metadata:e})),e.chart_configuration&&n({type:C.Jy,chartConfiguration:e.chart_configuration}),e.native_filter_configuration&&n({type:A.qe,filterConfig:e.native_filter_configuration})}return o&&n(J(o)),n(oe()),window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${j||t}/`),n((0,v.ws)((0,s.t)("This dashboard was saved successfully."))),n(te(void 0)),e})(e))).catch((e=>W(e)));return new Promise(((e,o)=>{(0,c.cr)(c.TT.CONFIRM_DASHBOARD_DIFF)&&r!==g.NT?i.Z.get({endpoint:`/api/v1/dashboard/${t}`}).then((r=>{const a=r.json.result,i=(s=a,c=l,x.yT.map((e=>({keyPath:e,...e.split(".").find((e=>O.has(e)))?{oldValue:JSON.stringify(w(s,e),null,2)||"{}",newValue:JSON.stringify(w(c,e),null,2)||"{}"}:{oldValue:w(s,e)||"",newValue:w(c,e)||""}}))).filter((e=>{let{oldValue:t,newValue:r}=e;return t!==r})));var s,c;return i.length>0?(n(te({updatedAt:a.changed_on,updatedBy:a.changed_by_name,overwriteConfirmItems:i,dashboardId:t,data:l})),o(i)):e()})):e()})).then(d).catch((e=>{const r=(0,s.t)("Please confirm the overwrite values.");n((0,E.logEvent)(T.yw,{dashboard_id:t,items:e})),n((0,v.Gb)(r))}))}"positions"in G&&!("positions"in G.metadata)&&(G.metadata.positions=G.positions),G.metadata.default_filters=(0,y.o)(P),G.metadata.filter_scopes=U;const K={dashboard_title:G.dashboard_title,css:G.css,duplicate_slices:G.duplicate_slices,json_metadata:JSON.stringify(G.metadata)};return i.Z.post({endpoint:`/api/v1/dashboard/${t}/copy/`,jsonPayload:K}).then((e=>(e=>{const t=e.json.result.last_modified_time;if(t&&n(J(t)),(0,c.cr)(c.TT.DASHBOARD_CROSS_FILTERS)){const{chartConfiguration:e,globalChartConfiguration:t}=Y();n((0,C.Mi)({chartConfiguration:e,globalChartConfiguration:t}))}return n(oe()),n((0,v.ws)((0,s.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>W(e)))}}function ie(e,t,r,n){return void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===r&&(r=0),(o,a)=>{if(!r)return void e.forEach((e=>o((0,u.refreshChart)(e,t,n))));const{metadata:i}=a().dashboardInfo,s=Math.max(r,i.stagger_time||5e3);"boolean"!=typeof i.stagger_refresh&&(i.stagger_refresh=void 0===i.stagger_refresh||"true"===i.stagger_refresh);const l=i.stagger_refresh?s/(e.length-1):0;e.forEach(((e,r)=>{setTimeout((()=>o((0,u.refreshChart)(e,t,n))),l*r)}))}}const se=(e,t,r,n,o)=>new Promise((a=>{o(ie(e,t,r,n)),a()})),le="ON_FILTERS_REFRESH",ce="ON_FILTERS_REFRESH_SUCCESS";function de(){return{type:ce}}const ue="ON_REFRESH_SUCCESS",pe="ON_REFRESH";function he(e,t,r,n){return void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===r&&(r=0),o=>{o({type:pe}),se(e,t,r,n,o).then((()=>{o({type:ue}),o({type:le})}))}}const me="SHOW_BUILDER_PANE";function ge(){return{type:me}}function fe(e,t){return(r,n)=>{const{sliceEntities:o}=n(),a=o.slices[e];if(!a)return r((0,v.Dz)("Sorry, there is no chart definition associated with the chart trying to be added."));const i={...a.form_data,slice_id:a.slice_id},s={...p.u,id:e,form_data:(0,h.oN)(i)};return Promise.all([r((0,u.addChart)(s,e)),r((0,R.QR)(i.datasource))]).then((()=>{r({type:D,slice:a}),a&&"filter_box"===a.viz_type&&r((0,Z.KJ)(e,t,a.form_data))}))}}function ve(e){return(t,r)=>{const n=r().sliceEntities.slices[e];n&&"filter_box"===n.viz_type&&t((0,Z.ku)(e)),t({type:L,sliceId:e}),t((0,u.removeChart)(e)),(0,d.ZP)().removeSlice(e)}}const _e="SET_COLOR_SCHEME";function be(e){return{type:_e,colorScheme:e}}const ye="SET_DIRECT_PATH";function Ee(e){return{type:ye,path:e}}const Te="SET_ACTIVE_TAB";function Se(e,t){return{type:Te,tabId:e,prevTabId:t}}const Ce="SET_ACTIVE_TABS",Re="SET_FOCUSED_FILTER_FIELD";function Ze(e,t){return{type:Re,chartId:e,column:t}}const Ae="UNSET_FOCUSED_FILTER_FIELD";function xe(e,t){return{type:Ae,chartId:e,column:t}}const Oe="SET_FULL_SIZE_CHART_ID";function we(e){return{type:Oe,chartId:e}}const Ie="SET_MAX_UNDO_HISTORY_EXCEEDED";function Ne(e){return void 0===e&&(e=!0),{type:Ie,payload:{maxUndoHistoryExceeded:e}}}function De(){return(e,t)=>{const{dashboardLayout:r}=t(),n=r.past.length;return e((0,v.Dz)((0,s.t)("You have used all %(historyLength)s undo slots and will not be able to fully undo subsequent actions. You may save your current state to reset the history.",{historyLength:n})))}}const Le="SET_DATASETS_STATUS";function Me(e){return{type:Le,status:e}}},4305:(e,t,r)=>{"use strict";r.d(t,{$:()=>Z,Y:()=>A});var n=r(93185),o=r(37863),a=r(37927),i=r(39759),s=r(35854),l=r(43399),c=r(12617),d=r(22318),u=r(52838),p=r(39023),h=r(80621),m=r(81255),g=r(53046),f=r(56967),v=r(28428),_=r(16454),b=r(27600),y=r(23525),E=r(42190),T=r(70400),S=r(41295),C=r(37418),R=r(52004);const Z="HYDRATE_DASHBOARD",A=e=>{let{history:t,dashboard:r,charts:A,dataMask:x,activeTabs:O}=e;return(e,w)=>{const{user:I,common:N,dashboardState:D}=w(),{metadata:L,position_data:M}=r,k=(0,T.Z)("regular"),P="true"===(0,T.Z)("reserved").edit;let U={};A.forEach((e=>{e.slice_id=e.form_data.slice_id}));try{U=(0,y.eY)(b.KD.preselectFilters)||JSON.parse(L.default_filters)}catch(e){}null!=L&&L.shared_label_colors&&(0,S.fO)(L,null==L?void 0:L.shared_label_colors),null!=L&&L.label_colors&&(0,S.fO)(L,null==L?void 0:L.label_colors);const $=M&&Object.keys(M).length>0?M:{[h.Zn]:"v2",[h._4]:{type:m.U0,id:h._4,children:[h.PV]},[h.PV]:{type:m.BG,id:h.PV,children:[],parents:[h._4]}},F={};Object.values($).forEach((e=>{e.type===m.dW&&(F[e.meta.chartId]=e.id)}));const q=function(e){void 0===e&&(e={});let t=e[h._4];return t=t&&t.children.length&&e[t.children[0]].type===m.yR?e[e[t.children[0]].children[0]]:e[t.children[0]],t.id}($),V=$[q];let B,H=0;const j=(null==L?void 0:L.filter_scopes)||{},z={},Q={},G={},Y=new Set,W=new Map;A.forEach((e=>{const t=e.slice_id,r={...e.form_data,url_params:{...e.form_data.url_params,...k}};if(z[t]={...o.u,id:t,form_data:(0,s.oN)(r)},G[t]={slice_id:t,slice_url:e.slice_url,slice_name:e.slice_name,form_data:e.form_data,viz_type:e.form_data.viz_type,datasource:e.form_data.datasource,description:e.description,description_markeddown:e.description_markeddown,owners:e.owners,modified:e.modified,changed_on:new Date(e.changed_on).getTime()},Y.add(t),!F[t]&&$[q]){var n;(0===H||H+h.fw>h.cz)&&(B=(0,v.Z)(m.Os,(V.parents||[]).slice()),$[B.id]=B,V.children.push(B.id),H=0);const t=(0,v.Z)(m.dW,{chartId:e.slice_id},(B.parents||[]).slice()),r=(null!=(n=W.get(e.slice_id))?n:0)+1;t.id=`${m.dW}-explore-${e.slice_id}-${r}`,W.set(e.slice_id,r),$[t.id]=t,B.children.push(t.id),F[t.meta.chartId]=t.id,H+=h.fw}if("filter_box"===e.form_data.viz_type){const r=(0,g.Z)(e.form_data);let{columns:n}=r;const{labels:o}=r;U[t]&&Object.keys(n).forEach((e=>{U[t][e]&&(n={...n,[e]:U[t][e]})}));const a=Object.keys(n).reduce(((e,r)=>{const n={...j[t]},{scope:o,immune:a}={...p.GI,...n[r]};return{...e,[r]:{scope:o,immune:a}}}),{}),i=F[t],s=($[i].parents||[]).slice();s.push(i),Q[t]={...p.Mj,chartId:t,componentId:i,datasourceId:e.form_data.datasource,filterName:e.slice_name,directPathToFilter:s,columns:n,labels:o,scopes:a,isDateFilter:Object.keys(n).includes(_.TIME_RANGE)}}const a=F[t];a&&$[a]&&($[a].meta.sliceName=e.slice_name)})),Object.values($).some((e=>e.id!==h._4&&!e.parents))&&(0,C.Z)({currentComponent:$[h._4],layout:$}),(0,l.DU)({dashboardFilters:Q,components:$}),$[h.M2]={id:h.M2,type:m.Vl,meta:{text:r.dashboard_title}};const K={past:[],present:$,future:[]},X=(0,y.eY)(b.KD.dashboardFocusedChart);let J;if(X){const e=Object.values(K.present).find((e=>{var t;return(null==(t=e.meta)?void 0:t.chartId)===X}));J=null==e?void 0:e.id;const r=new URLSearchParams(window.location.search);r.delete(b.KD.dashboardFocusedChart.name),t.replace({search:r.toString()})}const ee=J||(0,f.Z)();let te=D.directPathToChild||[];$[ee]&&(te=($[ee].parents||[]).slice(),te.push(ee));const re=(0,i.a)({filterConfig:(null==L?void 0:L.native_filter_configuration)||[]});if((0,n.cr)(n.TT.DASHBOARD_CROSS_FILTERS)){const{chartConfiguration:e,globalChartConfiguration:t}=(0,u.g)(K.present,L,z);L.chart_configuration=e,L.global_chart_configuration=t}const{roles:ne}=I,oe=(0,d.Ms)(r,I),ae=(0,u.U)(L.cross_filters_enabled);return e({type:Z,data:{sliceEntities:{...a.b,slices:G,isLoading:!1},charts:z,dashboardInfo:{...r,metadata:L,userId:I.userId?String(I.userId):null,dash_edit_perm:oe,dash_save_perm:(0,d.Xg)(r,I),dash_share_perm:(0,c.R)("can_share_dashboard","Superset",ne),superset_can_explore:(0,c.R)("can_explore","Superset",ne),superset_can_share:(0,c.R)("can_share_chart","Superset",ne),superset_can_csv:(0,c.R)("can_csv","Superset",ne),common:{flash_messages:null==N?void 0:N.flash_messages,conf:null==N?void 0:N.conf},filterBarOrientation:(0,n.cr)(n.TT.HORIZONTAL_FILTER_BAR)&&L.filter_bar_orientation||R.Bp.VERTICAL,crossFiltersEnabled:ae},dataMask:x,dashboardFilters:Q,nativeFilters:re,dashboardState:{preselectNativeFilters:(0,y.eY)(b.KD.nativeFilters),sliceIds:Array.from(Y),directPathToChild:te,directPathLastUpdated:Date.now(),focusedFilterField:null,expandedSlices:(null==L?void 0:L.expanded_slices)||{},refreshFrequency:(null==L?void 0:L.refresh_frequency)||0,shouldPersistRefreshFrequency:!1,css:r.css||"",colorNamespace:(null==L?void 0:L.color_namespace)||null,colorScheme:(null==L?void 0:L.color_scheme)||null,editMode:oe&&P,isPublished:r.published,hasUnsavedChanges:!1,dashboardIsSaving:!1,maxUndoHistoryExceeded:!1,lastModifiedTime:r.changed_on,isRefreshing:!1,isFiltersRefreshing:!1,activeTabs:O||(null==D?void 0:D.activeTabs)||[],datasetsStatus:E.ni.LOADING},dashboardLayout:K}})}}},39023:(e,t,r)=>{"use strict";r.d(t,{GI:()=>d,Mj:()=>u,ZP:()=>h});var n=r(81395),o=r(4305),a=r(16454),i=r(80621),s=r(53046),l=r(43399),c=r(20194);const d={scope:[i._4],immune:[]},u={chartId:null,componentId:null,filterName:null,datasourceId:null,directPathToFilter:[],isDateFilter:!1,isInstantFilter:!0,columns:{},labels:{},scopes:{}},p=[n.fK,n.l3,n.oW];function h(e,t){void 0===e&&(e={});const r={[n.fK](){const{chartId:e,component:r,form_data:n}=t,{columns:o,labels:i}=(0,s.Z)(n),l=Object.keys(o).reduce(((e,t)=>({...e,[t]:d})),{}),c=r?(r.parents||[]).slice().concat(r.id):[];return{...u,chartId:e,componentId:r.id,datasourceId:n.datasource,filterName:r.meta.sliceName,directPathToFilter:c,columns:o,labels:i,scopes:l,isInstantFilter:!!n.instant_filtering,isDateFilter:Object.keys(o).includes(a.TIME_RANGE)}},[n.oW](e){const{newSelectedValues:r,merge:n}=t,o=Object.keys(r).reduce(((e,t)=>n&&t in e?{...e,[t]:[...e[t],...r[t]]}:{...e,[t]:r[t]}),{...e.columns});return{...e,columns:o}},[n.oT](e){const{path:r}=t;return{...e,directPathToFilter:r}}};if(t.type===n.ib)return(0,l.DU)({dashboardFilters:e,components:t.components}),e;if(t.type===n.cK){const r=t.scopes,n=Object.entries(r).reduce(((e,t)=>{const[r,{scope:n,immune:o}]=t,{chartId:a,column:i}=(0,c._)(r),s={...e[a].scopes,[i]:{scope:n,immune:o}};return{...e,[a]:{...e[a],scopes:s}}}),e);return(0,l.DU)({dashboardFilters:n}),n}if(t.type===n.l3){const{chartId:r}=t,{[r]:n,...o}=e;return(0,l.DU)({dashboardFilters:o}),o}if(t.type===o.$)return t.data.dashboardFilters;if(t.type in r){const n={...e,[t.chartId]:r[t.type](e[t.chartId])};return p.includes(t.type)&&(0,l.DU)({dashboardFilters:n}),n}return e}},37927:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s,b:()=>i});var n=r(61988),o=r(38523),a=r(4305);const i={slices:{},isLoading:!0,errorMessage:null,lastUpdated:0};function s(e,t){void 0===e&&(e=i);const r={[a.$]:()=>({...t.data.sliceEntities}),[o.D2]:()=>({...e,isLoading:!0}),[o.JV]:()=>({...e,isLoading:!1,slices:{...e.slices,...t.payload.slices},lastUpdated:(new Date).getTime()}),[o.EO]:()=>({isLoading:!1,slices:{...t.payload.slices},lastUpdated:(new Date).getTime()}),[o.cK]:()=>({...e,isLoading:!1,lastUpdated:(new Date).getTime(),errorMessage:t.payload.error||(0,n.t)("Could not fetch all saved charts")})};return t.type in r?r[t.type]():e}},43399:(e,t,r)=>{"use strict";r.d(t,{DU:()=>T,De:()=>_,Z3:()=>b,_f:()=>y,up:()=>E});var n=r(58809),o=r.n(n),a=r(8816),i=r.n(a),s=r(83927),l=r.n(s),c=r(41609),d=r.n(c),u=r(20194),p=r(81255),h=r(39023);let m=[],g={},f={},v={};function _(){return g}function b(e){return m.includes(e)}function y(e,t){if(!(e in f)){const r=Object.entries(t||g).filter((t=>{let[,{scope:r}]=t;return r.includes(e)}));f[e]=i()(o()((e=>{let[t]=e;return(0,u._)(t).column})),l()((e=>{let[,{values:t}]=e;return t})))(r)}return f[e]}function E(e){let{filterScope:t}=e;function r(e,t,n){void 0===e&&(e=[]),void 0===t&&(t={}),void 0===n&&(n=[]),t&&(t.type===p.dW&&t.meta&&t.meta.chartId&&!n.includes(t.meta.chartId)?e.push(t.meta.chartId):t.children&&t.children.forEach((t=>r(e,v[t],n))))}const n=[],{scope:o,immune:a}=t||h.GI;return o.forEach((e=>r(n,v[e],a))),n}function T(e){let{dashboardFilters:t={},components:r={}}=e;m=Object.values(t).map((e=>e.chartId)),d()(r)||(v=r),f={},g=Object.values(t).reduce(((e,t)=>{const{chartId:r,columns:n,scopes:o}=t,a={};return Object.keys(n).forEach((e=>{if(Array.isArray(n[e])?n[e].length:void 0!==n[e]){const t=E({filterScope:o[e]}).filter((e=>r!==e));a[(0,u.w)({chartId:r,column:e})]={values:n[e],scope:t}}})),{...e,...a}}),{})}},47456:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(80621),o=r(95173),a=r(72673),i=r(28428);function s(e){let{dropResult:t,layout:r}=e;const{source:s,destination:l,dragging:c}=t,d=s.id===n.D0?(0,i.Z)(c.type):r[c.id]||{};if(s.id===l.id)return d.meta.width;const{width:u,minimumWidth:p}=(0,a.Z)({component:d,components:r}),{width:h,occupiedWidth:m}=(0,a.Z)({id:l.id,components:r});let g=Number(h-m);if(Number.isNaN(g)){const{width:e,occupiedWidth:t}=(0,a.Z)({id:(0,o.Z)({childId:l.id,layout:r}),components:r});g=Number(e-t)}return Number.isNaN(g)||Number.isNaN(Number(u))||g>=u?u:g>=p?g:-1}},72673:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(95173),o=r(80621),a=r(81255);function i(e){let{id:t,components:r}=e;const n=r[t];if(!n)return 0;let o=0;return(n.children||[]).forEach((e=>{const t=r[e]||{};o+=(t.meta||{}).width||0})),o}function s(e){let{id:t,component:r,components:l={}}=e;const c={width:void 0,occupiedWidth:void 0,minimumWidth:void 0},d=r||l[t];return d?(c.width=(d.meta||{}).width,c.occupiedWidth=c.width,d.type===a.Os?(c.width=s({id:(0,n.Z)({childId:d.id,layout:l}),components:l}).width||o.cz,c.occupiedWidth=i({id:d.id,components:l}),c.minimumWidth=c.occupiedWidth||o.cx):d.type===a.BA?(c.minimumWidth=o.cx,c.occupiedWidth=0,(d.children||[]).forEach((e=>{l[e].type===a.Os&&(c.minimumWidth=Math.max(c.minimumWidth,i({id:e,components:l})))}))):d.type!==a.t&&d.type!==a.xh&&d.type!==a.dW||(c.minimumWidth=o.cx),c):c}},53046:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(69856);function o(e){void 0===e&&(e={});const{date_filter:t,filter_configs:r=[],show_sqla_time_column:o,show_sqla_time_granularity:a}=e;let i=r.reduce(((e,t)=>{let{columns:r,labels:o}=e,a=t[n.ft.DEFAULT_VALUE];return""===a&&(a=null),a&&t[n.ft.MULTIPLE]&&(a=t.defaultValue.split(";")),{columns:{...r,[t.column]:t.vals||a},labels:{...o,[t.column]:t.label}}}),{columns:{},labels:{}});if(t){let t={...i.columns,[n.i2.time_range]:e.time_range};const r={...i.labels,...Object.entries(n.i2).reduce(((e,t)=>{let[r,o]=t;return{...e,[o]:n.m_[r]}}),{})};a&&(t={...t,[n.i2.time_grain_sqla]:e.time_grain_sqla}),o&&(t={...t,[n.i2.granularity_sqla]:e.granularity_sqla}),i={...i,columns:t,labels:r}}return i}},28428:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(14670),o=r.n(n),a=r(61988),i=r(81255),s=r(80621);const l={[i.dW]:{width:s.fw,height:50},[i.BA]:{width:s.fw,background:s.HE},[i.hE]:null,[i.Nc]:{text:(0,a.t)("New header"),headerSize:s.OE,background:s.HE},[i.xh]:{width:s.fw,height:50},[i.Os]:{background:s.HE},[i.yR]:null,[i.gn]:{text:"",defaultText:(0,a.t)("Tab title"),placeholder:(0,a.t)("Tab title")},[i.t]:{width:s.cz,background:s.HE}};function c(e){return`${e}-${o().generate()}`}function d(e,t,r){return void 0===r&&(r=[]),{type:e,id:c(e),children:[],parents:r,meta:{...l[e],...t}}}},11370:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(20194);function o(e){return Object.entries(e).reduce(((e,t)=>{const[r,{values:o}]=t,{chartId:a,column:i}=(0,n._)(r),s={...e[a],[i]:o};return{...e,[a]:s}}),{})}},37418:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(68492);function o(e){let{currentComponent:t,layout:r={}}=e;if(t&&r)if(r[t.id]){const e=Array.isArray(t.parents)?t.parents.slice():[];e.push(t.id),Array.isArray(t.children)&&t.children.forEach((t=>{r[t]?(r[t]={...r[t],parents:e},o({currentComponent:r[t],layout:r})):n.Z.warn(`The current layout does not contain a component with the id: ${t}.  Skipping this component`)}))}else n.Z.warn(`The current layout does not contain a component with the id: ${null==t?void 0:t.id}.  Skipping this component`)}},19485:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FETCH_DASHBOARDS_FAILED:()=>g,FETCH_DASHBOARDS_SUCCEEDED:()=>h,SAVE_SLICE_FAILED:()=>b,SAVE_SLICE_SUCCESS:()=>E,SET_SAVE_CHART_MODAL_VISIBILITY:()=>v,createDashboard:()=>A,createSlice:()=>Z,fetchDashboardsFailed:()=>f,fetchDashboardsSucceeded:()=>m,getSliceDashboards:()=>x,getSlicePayload:()=>S,saveSliceFailed:()=>y,saveSliceSuccess:()=>T,setSaveChartModalVisibility:()=>_,updateSlice:()=>R});var n=r(41609),o=r.n(n),a=r(15926),i=r.n(a),s=r(61988),l=r(31069),c=r(72570),d=r(12515),u=r(69856);const p=/^adhoc_filters/,h="FETCH_DASHBOARDS_SUCCEEDED";function m(e){return{type:h,choices:e}}const g="FETCH_DASHBOARDS_FAILED";function f(e){return{type:g,userId:e}}const v="SET_SAVE_CHART_MODAL_VISIBILITY";function _(e){return{type:v,isVisible:e}}const b="SAVE_SLICE_FAILED";function y(){return{type:b}}const E="SAVE_SLICE_SUCCESS";function T(e){return{type:E,data:e}}const S=function(e,t,r,n,a){void 0===a&&(a={});const i=(s=t,Object.entries(s).reduce(((e,t)=>{let[r,n]=t;return p.test(r)?{...e,[r]:null==n?void 0:n.filter((e=>!e.isExtra))}:e}),{}));var s,l;o()(a)||Object.keys(i||{}).forEach((e=>{var t,r;o()(i[e])&&(null==(t=a)||null==(r=t[e])||r.forEach((t=>{t.operator!==u.d.TEMPORAL_RANGE||t.isExtra||i[e].push({...t,comparator:"No filter"})})))})),(e=>((null==e?void 0:e.adhoc_filters)||[]).some((e=>e.operator===u.d.TEMPORAL_RANGE)))(i)||null==t||null==(l=t.adhoc_filters)||l.forEach((e=>{e.operator===u.d.TEMPORAL_RANGE&&e.isExtra&&i.adhoc_filters.push({...e,comparator:"No filter"})}));const c={...t,...i,dashboards:r},[h,m]=c.datasource.split("__");return{params:JSON.stringify(c),slice_name:e,viz_type:c.viz_type,datasource_id:parseInt(h,10),datasource_type:m,dashboards:r,owners:n,query_context:JSON.stringify((0,d.u)({formData:c,force:!1,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null}))}},C=(e,t,r)=>{const n=[];return e?n.push((0,c.ws)((0,s.t)("Chart [%s] has been saved",t))):n.push((0,c.ws)((0,s.t)("Chart [%s] has been overwritten",t))),r&&(r.new?n.push((0,c.ws)((0,s.t)("Dashboard [%s] just got created and chart [%s] was added to it",r.title,t))):n.push((0,c.ws)((0,s.t)("Chart [%s] was added to dashboard [%s]",t,r.title)))),n},R=(e,t,r,n)=>async(o,a)=>{const{slice_id:i,owners:s,form_data:c}=e,{explore:{form_data:{url_params:d,...u}}}=a();try{const e=await l.Z.put({endpoint:`/api/v1/chart/${i}`,jsonPayload:S(t,u,r,s,c)});return o(T()),C(!1,t,n).map(o),e.json}catch(e){throw o(y()),e}},Z=(e,t,r)=>async(n,o)=>{const{explore:{form_data:{url_params:a,...i}}}=o();try{const o=await l.Z.post({endpoint:"/api/v1/chart/",jsonPayload:S(e,i,t)});return n(T()),C(!0,e,r).map(n),o.json}catch(e){throw n(y()),e}},A=e=>async t=>{try{return(await l.Z.post({endpoint:"/api/v1/dashboard/",jsonPayload:{dashboard_title:e}})).json}catch(e){throw t(y()),e}},x=e=>async t=>{try{return(await l.Z.get({endpoint:`/api/v1/chart/${e.slice_id}?q=${i().encode({columns:["dashboards.id"]})}`})).json.result.dashboards.map((e=>{let{id:t}=e;return t}))}catch(e){throw t(y()),e}}},79069:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(73126),o=r(67294),a=r(45697),i=r.n(a),s=r(51995),l=r(11965),c=r(82342),d=r(87253);const u={value:i().bool,label:i().string,onChange:i().func},p=s.iK.div`
  ${e=>{let{theme:t}=e;return l.iv`
    .ControlHeader label {
      color: ${t.colors.grayscale.dark1};
    }
    span[role='checkbox'] {
      padding-right: ${2*t.gridUnit}px;
    }
  `}}
`;class h extends o.Component{onChange(){this.props.onChange(!this.props.value)}renderCheckbox(){return(0,l.tZ)(d.ZP,{onChange:this.onChange.bind(this),checked:!!this.props.value})}render(){return this.props.label?(0,l.tZ)(p,null,(0,l.tZ)(c.Z,(0,n.Z)({},this.props,{leftNode:this.renderCheckbox(),onClick:this.onChange.bind(this)}))):this.renderCheckbox()}}h.propTypes=u,h.defaultProps={value:!1,onChange:()=>{}}},28543:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(69856),o=r(56565),a=r(61641);const i=[...n.qB].map((e=>n.LT[e].operation));class s{constructor(e){var t;this.expressionType=e.expressionType||a.v.SIMPLE,this.expressionType===a.v.SIMPLE?(this.subject=e.subject,this.operator=null==(t=e.operator)?void 0:t.toUpperCase(),this.operatorId=e.operatorId,this.comparator=e.comparator,[n.d.IS_TRUE,n.d.IS_FALSE].indexOf(e.operatorId)>=0&&(this.comparator=e.operatorId===n.d.IS_TRUE),[n.d.IS_NULL,n.d.IS_NOT_NULL].indexOf(e.operatorId)>=0&&(this.comparator=null),this.clause=e.clause||a.P.WHERE,this.sqlExpression=null):this.expressionType===a.v.SQL&&(this.sqlExpression="string"==typeof e.sqlExpression?e.sqlExpression:(0,o.c)(e,{useSimple:!0}),this.clause=e.clause,e.operator&&i.indexOf(e.operator)>=0?(this.subject=e.subject,this.operator=e.operator,this.operatorId=e.operatorId):(this.subject=null,this.operator=null),this.comparator=null),this.isExtra=!!e.isExtra,this.isNew=!!e.isNew,this.datasourceWarning=!!e.datasourceWarning,this.filterOptionName=e.filterOptionName||`filter_${Math.random().toString(36).substring(2,15)}_${Math.random().toString(36).substring(2,15)}`}duplicateWith(e){return new s({...this,isNew:!1,...e})}equals(e){return e.expressionType===this.expressionType&&e.sqlExpression===this.sqlExpression&&e.operator===this.operator&&e.operatorId===this.operatorId&&e.comparator===this.comparator&&e.subject===this.subject}isValid(){const e=[n.d.IS_NOT_NULL,n.d.IS_NULL].map((e=>n.LT[e].operation)),t=[n.d.IS_TRUE,n.d.IS_FALSE].map((e=>n.LT[e].operation));if(this.expressionType===a.v.SIMPLE){if(e.indexOf(this.operator)>=0)return!(!this.operator||!this.subject);if(t.indexOf(this.operator)>=0)return!(!this.subject||null===this.comparator);if(this.operator&&this.subject&&this.clause)if(Array.isArray(this.comparator)){if(this.comparator.length>0)return!0}else if(null!==this.comparator)return!0}else if(this.expressionType===a.v.SQL)return!(!this.sqlExpression||!this.clause);return!1}getDefaultLabel(){const e=this.translateToSql();return e.length<43?e:`${e.substring(0,40)}...`}getTooltipTitle(){return this.translateToSql()}translateToSql(){return(0,o.c)(this)}}},61890:(e,t,r)=>{"use strict";r.d(t,{Z:()=>L});var n=r(67294),o=r(45697),a=r.n(o),i=r(31069),s=r(68492),l=r(61988),c=r(55786),d=r(68135),u=r(82342),p=r(17536),h=r(27130),m=r(19113),g=r(69856),f=r(40266),v=r(33334),_=r(70707),b=r(74069),y=r(96055),E=r(42753),T=r(7848),S=r(11965);function C(e){let{adhocFilter:t,options:r,datasource:n,onFilterEdit:o,onRemoveFilter:a,partitionColumn:i,onMoveLabel:s,onDropLabel:l,index:c,sections:d,operators:u}=e;const{actualTimeRange:p,title:h}=(0,T.w)(t);return(0,S.tZ)(y.Z,{sections:d,operators:u,adhocFilter:t,options:r,datasource:n,onFilterEdit:o,partitionColumn:i},(0,S.tZ)(v.yz,{label:null!=p?p:t.getDefaultLabel(),tooltipTitle:null!=h?h:t.getTooltipTitle(),onRemove:a,onMoveLabel:s,onDropLabel:l,index:c,type:E.g.FilterOption,withCaret:!0,isExtra:t.isExtra}))}var R=r(28543),Z=r(61641);const A=a().oneOfType([a().shape({expressionType:a().oneOf([Z.v.SIMPLE]).isRequired,clause:a().oneOf([Z.P.HAVING,Z.P.WHERE]).isRequired,subject:a().string.isRequired,comparator:a().oneOfType([a().string,a().arrayOf(a().string)]).isRequired}),a().shape({expressionType:a().oneOf([Z.v.SQL]).isRequired,clause:a().oneOf([Z.P.WHERE,Z.P.HAVING]).isRequired,sqlExpression:a().string.isRequired})]);var x=r(72201);const{warning:O}=b.default,w=a().oneOfType([a().string,p.Z]),I={label:a().oneOfType([a().object,a().string]),name:a().string,sections:a().arrayOf(a().string),operators:a().arrayOf(a().string),onChange:a().func,value:a().arrayOf(A),datasource:a().object,columns:a().arrayOf(x.Z),savedMetrics:a().arrayOf(h.Z),selectedMetrics:a().oneOfType([w,a().arrayOf(w)]),isLoading:a().bool,canDelete:a().func};function N(e){return e&&!(e instanceof R.Z)&&e.expressionType}class D extends n.Component{constructor(e){super(e),this.optionsForSelect=this.optionsForSelect.bind(this),this.onRemoveFilter=this.onRemoveFilter.bind(this),this.onNewFilter=this.onNewFilter.bind(this),this.onFilterEdit=this.onFilterEdit.bind(this),this.moveLabel=this.moveLabel.bind(this),this.onChange=this.onChange.bind(this),this.mapOption=this.mapOption.bind(this),this.getMetricExpression=this.getMetricExpression.bind(this),this.removeFilter=this.removeFilter.bind(this);const t=(this.props.value||[]).map((e=>N(e)?new R.Z(e):e));this.optionRenderer=e=>(0,S.tZ)(f.Z,{option:e}),this.valueRenderer=(e,t)=>(0,S.tZ)(C,{key:t,index:t,adhocFilter:e,onFilterEdit:this.onFilterEdit,options:this.state.options,sections:this.props.sections,operators:this.props.operators,datasource:this.props.datasource,onRemoveFilter:e=>{e.stopPropagation(),this.onRemoveFilter(t)},onMoveLabel:this.moveLabel,onDropLabel:()=>this.props.onChange(this.state.values),partitionColumn:this.state.partitionColumn}),this.state={values:t,options:this.optionsForSelect(this.props),partitionColumn:null}}componentDidMount(){const{datasource:e}=this.props;if(e&&"table"===e.type){var t;const r=null==(t=e.database)?void 0:t.id,{datasource_name:n,schema:o,is_sqllab_view:a}=e;!a&&r&&n&&o&&i.Z.get({endpoint:`/api/v1/database/${r}/table_extra/${n}/${o}/`}).then((e=>{let{json:t}=e;if(t&&t.partitions){const{partitions:e}=t;e&&e.cols&&1===Object.keys(e.cols).length&&this.setState({partitionColumn:e.cols[0]})}})).catch((e=>{s.Z.error("fetch extra_table_metadata:",e.statusText)}))}}UNSAFE_componentWillReceiveProps(e){this.props.columns!==e.columns&&this.setState({options:this.optionsForSelect(e)}),this.props.value!==e.value&&this.setState({values:(e.value||[]).map((e=>N(e)?new R.Z(e):e))})}removeFilter(e){const t=[...this.state.values];t.splice(e,1),this.setState((e=>({...e,values:t}))),this.props.onChange(t)}onRemoveFilter(e){const{canDelete:t}=this.props,{values:r}=this.state,n=null==t?void 0:t(r[e],r);"string"!=typeof n?this.removeFilter(e):O({title:(0,l.t)("Warning"),content:n})}onNewFilter(e){const t=this.mapOption(e);t&&this.setState((e=>({...e,values:[...e.values,t]})),(()=>{this.props.onChange(this.state.values)}))}onFilterEdit(e){this.props.onChange(this.state.values.map((t=>t.filterOptionName===e.filterOptionName?e:t)))}onChange(e){const t=(e||[]).map((e=>this.mapOption(e))).filter((e=>e));this.props.onChange(t)}getMetricExpression(e){return this.props.savedMetrics.find((t=>t.metric_name===e)).expression}moveLabel(e,t){const{values:r}=this.state,n=[...r];[n[t],n[e]]=[n[e],n[t]],this.setState({values:n})}mapOption(e){return e instanceof R.Z?e:e.saved_metric_name?new R.Z({expressionType:Z.v.SQL,subject:this.getMetricExpression(e.saved_metric_name),operator:g.LT[g.d.GREATER_THAN].operation,comparator:0,clause:Z.P.HAVING}):e.label?new R.Z({expressionType:Z.v.SQL,subject:new m.Z(e).translateToSql(),operator:g.LT[g.d.GREATER_THAN].operation,comparator:0,clause:Z.P.HAVING}):e.column_name?new R.Z({expressionType:Z.v.SIMPLE,subject:e.column_name,operator:g.LT[g.d.EQUALS].operation,comparator:"",clause:Z.P.WHERE,isNew:!0}):null}optionsForSelect(e){return[...e.columns,...(0,c.Z)(e.selectedMetrics).map((e=>e&&("string"==typeof e?{saved_metric_name:e}:new m.Z(e))))].filter((e=>e)).reduce(((e,t)=>(t.saved_metric_name?e.push({...t,filterOptionName:t.saved_metric_name}):t.column_name?e.push({...t,filterOptionName:`_col_${t.column_name}`}):t instanceof m.Z&&e.push({...t,filterOptionName:`_adhocmetric_${t.label}`}),e)),[]).sort(((e,t)=>(e.saved_metric_name||e.column_name||e.label).localeCompare(t.saved_metric_name||t.column_name||t.label)))}addNewFilterPopoverTrigger(e){return(0,S.tZ)(y.Z,{operators:this.props.operators,sections:this.props.sections,adhocFilter:new R.Z({}),datasource:this.props.datasource,options:this.state.options,onFilterEdit:this.onNewFilter,partitionColumn:this.state.partitionColumn},e)}render(){const{theme:e}=this.props;return(0,S.tZ)("div",{className:"metrics-select"},(0,S.tZ)(v.gM,null,(0,S.tZ)(u.Z,this.props),this.addNewFilterPopoverTrigger((0,S.tZ)(v.IG,null,(0,S.tZ)(_.Z.PlusLarge,{iconSize:"s",iconColor:e.colors.grayscale.light5})))),(0,S.tZ)(v.yj,null,this.state.values.length>0?this.state.values.map(((e,t)=>this.valueRenderer(e,t))):this.addNewFilterPopoverTrigger((0,S.tZ)(v.SW,null,(0,S.tZ)(_.Z.PlusSmall,{iconColor:e.colors.grayscale.light1}),(0,l.t)("Add filter")))))}}D.propTypes=I,D.defaultProps={name:"",onChange:()=>{},columns:[],savedMetrics:[],selectedMetrics:[]};const L=(0,d.b)(D)},72201:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(45697),o=r.n(n);const a=o().shape({column_name:o().string.isRequired,type:o().string})},19113:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s,v:()=>o});var n=r(69856);const o={SIMPLE:"SIMPLE",SQL:"SQL"};function a(e){if(e.sqlExpression&&n.Q_.test(e.sqlExpression)){const t=e.sqlExpression.indexOf(")"),r=e.sqlExpression.substring(0,t).lastIndexOf("(");if(t>0&&r>0)return e.sqlExpression.substring(r+1,t)}return null}function i(e){if(e.sqlExpression&&n.Q_.test(e.sqlExpression)){const t=e.sqlExpression.indexOf("(");if(t>0)return e.sqlExpression.substring(0,t)}return null}class s{constructor(e){if(this.expressionType=e.expressionType||o.SIMPLE,this.expressionType===o.SIMPLE){const t=a(e);this.column=e.column||t&&{column_name:t},this.aggregate=e.aggregate||i(e),this.sqlExpression=null}else this.expressionType===o.SQL&&(this.sqlExpression=e.sqlExpression,this.column=null,this.aggregate=null);this.datasourceWarning=!!e.datasourceWarning,this.hasCustomLabel=!(!e.hasCustomLabel||!e.label),this.label=this.hasCustomLabel?e.label:this.getDefaultLabel(),this.optionName=e.optionName||`metric_${Math.random().toString(36).substring(2,15)}_${Math.random().toString(36).substring(2,15)}`}getDefaultLabel(){return this.translateToSql({useVerboseName:!0})}translateToSql(e){if(void 0===e&&(e={useVerboseName:!1,transformCountDistinct:!1}),this.expressionType===o.SIMPLE){var t,r;const o=this.aggregate||"",a=e.useVerboseName&&null!=(t=this.column)&&t.verbose_name?`(${this.column.verbose_name})`:null!=(r=this.column)&&r.column_name?`(${this.column.column_name})`:"";return e.transformCountDistinct&&o===n.YY.COUNT_DISTINCT&&/^\(.*\)$/.test(a)?`COUNT(DISTINCT ${a.slice(1,-1)})`:o+a}return this.expressionType===o.SQL?this.sqlExpression:""}duplicateWith(e){return new s({...this,...e})}equals(e){return e.label===this.label&&e.expressionType===this.expressionType&&e.sqlExpression===this.sqlExpression&&e.aggregate===this.aggregate&&(e.column&&e.column.column_name)===(this.column&&this.column.column_name)}isValid(){return this.expressionType===o.SIMPLE?!(!this.column||!this.aggregate):this.expressionType===o.SQL&&!!this.sqlExpression}inferSqlExpressionAggregate(){return i(this)}inferSqlExpressionColumn(){return a(this)}}},40266:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d}),r(67294);var n=r(45697),o=r.n(n),a=r(34087),i=r(17536),s=r(99963),l=r(11965);const c={option:o().oneOfType([a.Z,o().shape({saved_metric_name:o().string.isRequired}),i.Z]).isRequired};function d(e){let{option:t}=e;return t.saved_metric_name?(0,l.tZ)(s.l,{column:{column_name:t.saved_metric_name,type:"expression"},showType:!0}):t.column_name?(0,l.tZ)(s.l,{column:t,showType:!0}):t.label?(0,l.tZ)(s.l,{column:{column_name:t.label,type:"expression"},showType:!0}):null}d.propTypes=c},17536:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(45697),o=r.n(n),a=r(69856),i=r(34087),s=r(19113);const l=o().oneOfType([o().shape({expressionType:o().oneOf([s.v.SIMPLE]).isRequired,column:i.Z.isRequired,aggregate:o().oneOf(Object.keys(a.YY)).isRequired,label:o().string.isRequired}),o().shape({expressionType:o().oneOf([s.v.SQL]).isRequired,sqlExpression:o().string.isRequired,label:o().string.isRequired})])},34087:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(45697),o=r.n(n);const a=o().shape({column_name:o().string.isRequired,type:o().string})},27130:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(45697),o=r.n(n);const a=o().shape({metric_name:o().string,verbose_name:o().string,expression:o().string})},82199:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(67294),o=r(45697),a=r.n(o),i=r(1111),s=r(61988),l=r(11965),c=r(81315),d=r(82342);const u={ariaLabel:a().string,autoFocus:a().bool,choices:a().array,clearable:a().bool,description:a().oneOfType([a().string,a().node]),disabled:a().bool,freeForm:a().bool,isLoading:a().bool,mode:a().string,multi:a().bool,isMulti:a().bool,name:a().string.isRequired,onChange:a().func,onFocus:a().func,onSelect:a().func,onDeselect:a().func,value:a().oneOfType([a().string,a().number,a().array]),default:a().oneOfType([a().string,a().number,a().array]),showHeader:a().bool,optionRenderer:a().func,valueKey:a().string,options:a().array,placeholder:a().string,filterOption:a().func,tokenSeparators:a().arrayOf(a().string),notFoundContent:a().object,label:a().string,renderTrigger:a().bool,validationErrors:a().array,rightNode:a().node,leftNode:a().node,onClick:a().func,hovered:a().bool,tooltipOnClick:a().func,warning:a().string,danger:a().string};class p extends n.PureComponent{constructor(e){super(e),this.state={options:this.getOptions(e)},this.onChange=this.onChange.bind(this),this.handleFilterOptions=this.handleFilterOptions.bind(this)}UNSAFE_componentWillReceiveProps(e){if(!(0,i.Z)(e.choices,this.props.choices)||!(0,i.Z)(e.options,this.props.options)){const t=this.getOptions(e);this.setState({options:t})}}onChange(e){const{valueKey:t}=this.props;let r=e;Array.isArray(e)&&(r=e.map((e=>void 0!==(null==e?void 0:e[t])?e[t]:e))),"object"==typeof e&&void 0!==(null==e?void 0:e[t])&&(r=e[t]),this.props.onChange(r,[])}getOptions(e){const{choices:t,optionRenderer:r,valueKey:n}=e;let o=[];return e.options?o=e.options.map((e=>({...e,value:e[n],label:e.label||e[n],customLabel:r?r(e):void 0}))):t&&(o=t.map((e=>{if(Array.isArray(e)){const[t,r]=e.length>1?e:[e[0],e[0]];return{value:t,label:r}}return Object.is(e)?{...e,value:e[n],label:e.label||e[n]}:{value:e,label:e}}))),o}handleFilterOptions(e,t){const{filterOption:r}=this.props;return r({data:t},e)}render(){const{ariaLabel:e,autoFocus:t,clearable:r,disabled:n,filterOption:o,freeForm:a,isLoading:i,isMulti:u,label:p,multi:h,name:m,notFoundContent:g,onFocus:f,onSelect:v,onDeselect:_,placeholder:b,showHeader:y,tokenSeparators:E,value:T,description:S,renderTrigger:C,rightNode:R,leftNode:Z,validationErrors:A,onClick:x,hovered:O,tooltipOnClick:w,warning:I,danger:N}=this.props,D={name:m,label:p,description:S,renderTrigger:C,rightNode:R,leftNode:Z,validationErrors:A,onClick:x,hovered:O,tooltipOnClick:w,warning:I,danger:N},L={allowNewOptions:a,autoFocus:t,ariaLabel:e||("string"==typeof p?p:(0,s.t)("Select ...")),allowClear:r,disabled:n,filterOption:!o||"function"!=typeof o||this.handleFilterOptions,header:y&&(0,l.tZ)(d.Z,D),loading:i,mode:this.props.mode||(u||h?"multiple":"single"),name:`select-${m}`,onChange:this.onChange,onFocus:f,onSelect:v,onDeselect:_,options:this.state.options,placeholder:b,sortComparator:this.props.sortComparator,value:(()=>{const e=null!=T?T:void 0!==this.props.default?this.props.default:void 0;if(null!==e||this.state.options.find((e=>null===e.value)))return e})(),tokenSeparators:E,notFoundContent:g};return(0,l.tZ)("div",{css:e=>l.iv`
          .type-label {
            margin-right: ${2*e.gridUnit}px;
          }
          .Select__multi-value__label > span,
          .Select__option > span,
          .Select__single-value > span {
            display: flex;
            align-items: center;
          }
        `},(0,l.tZ)(c.Z,L))}}p.propTypes=u,p.defaultProps={autoFocus:!1,choices:[],clearable:!0,description:null,disabled:!1,freeForm:!1,isLoading:!1,label:null,multi:!1,onChange:()=>{},onFocus:()=>{},showHeader:!0,valueKey:"value"}},665:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var n=r(67294),o=r(45697),a=r.n(o),i=r(4715),s=r(61988),l=r(37921),c=r(99299),d=r(83734),u=r(87253),p=r(82342),h=r(82199),m=r(11965);const g="latlong",f="delimited",v="geohash",_={onChange:a().func,value:a().object,animation:a().bool,choices:a().array};class b extends n.Component{constructor(e){super(e);const t=e.value||{};let r;e.choices.length>0&&(r=e.choices[0][0]),this.state={type:t.type||g,delimiter:t.delimiter||",",latCol:t.latCol||r,lonCol:t.lonCol||r,lonlatCol:t.lonlatCol||r,reverseCheckbox:t.reverseCheckbox||!1,geohashCol:t.geohashCol||r,value:null,errors:[]},this.toggleCheckbox=this.toggleCheckbox.bind(this),this.onChange=this.onChange.bind(this),this.renderReverseCheckbox=this.renderReverseCheckbox.bind(this)}componentDidMount(){this.onChange()}onChange(){const{type:e}=this.state,t={type:e},r=[],n=(0,s.t)("Invalid lat/long configuration.");e===g?(t.latCol=this.state.latCol,t.lonCol=this.state.lonCol,t.lonCol&&t.latCol||r.push(n)):e===f?(t.lonlatCol=this.state.lonlatCol,t.delimiter=this.state.delimiter,t.reverseCheckbox=this.state.reverseCheckbox,t.lonlatCol&&t.delimiter||r.push(n)):e===v&&(t.geohashCol=this.state.geohashCol,t.reverseCheckbox=this.state.reverseCheckbox,t.geohashCol||r.push(n)),this.setState({value:t,errors:r}),this.props.onChange(t,r)}setType(e){this.setState({type:e},this.onChange)}toggleCheckbox(){this.setState((e=>({reverseCheckbox:!e.reverseCheckbox})),this.onChange)}renderLabelContent(){return this.state.errors.length>0?"N/A":this.state.type===g?`${this.state.lonCol} | ${this.state.latCol}`:this.state.type===f?`${this.state.lonlatCol}`:this.state.type===v?`${this.state.geohashCol}`:null}renderSelect(e,t){return(0,m.tZ)(h.Z,{ariaLabel:e,name:e,choices:this.props.choices,value:this.state[e],clearable:!1,onFocus:()=>{this.setType(t)},onChange:t=>{this.setState({[e]:t},this.onChange)}})}renderReverseCheckbox(){return(0,m.tZ)("span",null,(0,s.t)("Reverse lat/long "),(0,m.tZ)(u.ZP,{checked:this.state.reverseCheckbox,onChange:this.toggleCheckbox}))}renderPopoverContent(){return(0,m.tZ)("div",{style:{width:"300px"}},(0,m.tZ)(d.Z,{title:(0,s.t)("Longitude & Latitude columns"),isSelected:this.state.type===g,onSelect:this.setType.bind(this,g)},(0,m.tZ)(i.X2,{gutter:16},(0,m.tZ)(i.JX,{xs:24,md:12},(0,s.t)("Longitude"),this.renderSelect("lonCol",g)),(0,m.tZ)(i.JX,{xs:24,md:12},(0,s.t)("Latitude"),this.renderSelect("latCol",g)))),(0,m.tZ)(d.Z,{title:(0,s.t)("Delimited long & lat single column"),info:(0,s.t)("Multiple formats accepted, look the geopy.points Python library for more details"),isSelected:this.state.type===f,onSelect:this.setType.bind(this,f)},(0,m.tZ)(i.X2,{gutter:16},(0,m.tZ)(i.JX,{xs:24,md:12},(0,s.t)("Column"),this.renderSelect("lonlatCol",f)),(0,m.tZ)(i.JX,{xs:24,md:12},this.renderReverseCheckbox()))),(0,m.tZ)(d.Z,{title:(0,s.t)("Geohash"),isSelected:this.state.type===v,onSelect:this.setType.bind(this,v)},(0,m.tZ)(i.X2,{gutter:16},(0,m.tZ)(i.JX,{xs:24,md:12},(0,s.t)("Column"),this.renderSelect("geohashCol",v)),(0,m.tZ)(i.JX,{xs:24,md:12},this.renderReverseCheckbox()))))}render(){return(0,m.tZ)("div",null,(0,m.tZ)(p.Z,this.props),(0,m.tZ)(c.Z,{content:this.renderPopoverContent(),placement:"topLeft",trigger:"click"},(0,m.tZ)(l.Z,{className:"pointer"},this.renderLabelContent())))}}b.propTypes=_,b.defaultProps={onChange:()=>{},animation:!0,choices:[]}},42878:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(73126),o=r(67294),a=r(45697),i=r.n(a),s=r(9875),l=r(61988),c=r(68135),d=r(35932),u=r(94670),p=r(1304),h=r(82342),m=r(11965);const g={name:i().string,onChange:i().func,initialValue:i().string,height:i().number,minLines:i().number,maxLines:i().number,offerEditInModal:i().bool,language:i().oneOf([null,"json","html","sql","markdown","javascript"]),aboveEditorSection:i().node,readOnly:i().bool,resize:i().oneOf([null,"block","both","horizontal","inline","none","vertical"]),textAreaStyles:i().object};class f extends o.Component{onControlChange(e){const{value:t}=e.target;this.props.onChange(t)}onAreaEditorChange(e){this.props.onChange(e)}renderEditor(e){void 0===e&&(e=!1);const t=e?40:this.props.minLines||12;if(this.props.language){const r={border:`1px solid ${this.props.theme.colors.grayscale.light1}`,minHeight:`${t}em`,width:"auto",...this.props.textAreaStyles};return this.props.resize&&(r.resize=this.props.resize),this.props.readOnly&&(r.backgroundColor="#f2f2f2"),(0,m.tZ)(u.YH,(0,n.Z)({mode:this.props.language,style:r,minLines:t,maxLines:e?1e3:this.props.maxLines,editorProps:{$blockScrolling:!0},defaultValue:this.props.initialValue,readOnly:this.props.readOnly,key:this.props.name},this.props,{onChange:this.onAreaEditorChange.bind(this)}))}return(0,m.tZ)(s.Kx,{placeholder:(0,l.t)("textarea"),onChange:this.onControlChange.bind(this),defaultValue:this.props.initialValue,disabled:this.props.readOnly,style:{height:this.props.height}})}renderModalBody(){return(0,m.tZ)(o.Fragment,null,(0,m.tZ)("div",null,this.props.aboveEditorSection),this.renderEditor(!0))}render(){const e=(0,m.tZ)(h.Z,this.props);return(0,m.tZ)("div",null,e,this.renderEditor(),this.props.offerEditInModal&&(0,m.tZ)(p.Z,{modalTitle:e,triggerNode:(0,m.tZ)(d.Z,{buttonSize:"small",className:"m-t-5"},(0,l.t)("Edit")," ",(0,m.tZ)("strong",null,this.props.language)," ",(0,l.t)("in modal")),modalBody:this.renderModalBody(!0),responsive:!0}))}}f.propTypes=g,f.defaultProps={onChange:()=>{},initialValue:"",height:250,minLines:3,maxLines:10,offerEditInModal:!0,readOnly:!1,resize:null,textAreaStyles:{}};const v=(0,c.b)(f)},92252:(e,t,r)=>{"use strict";r.d(t,{ai:()=>b}),r(67294);var n=r(81545),o=r(45511),a=r(61988),i=r(95826),s=r(75294),l=r(12515),c=r(69856),d=r(99963),u=r(11965);const p=(0,n.Z)(),h=(0,o.Z)(),m=[["SMART_NUMBER",(0,a.t)("Adaptive formatting")],["~g",(0,a.t)("Original value")],[",d",",d (12345.432 => 12,345)"],[".1s",".1s (12345.432 => 10k)"],[".3s",".3s (12345.432 => 12.3k)"],[",.1%",",.1% (12345.432 => 1,234,543.2%)"],[".3%",".3% (12345.432 => 1234543.200%)"],[".4r",".4r (12345.432 => 12350)"],[",.3f",",.3f (12345.432 => 12,345.432)"],["+,","+, (12345.432 => +12,345.432)"],["$,.2f","$,.2f (12345.432 => $12,345.43)"],["DURATION",(0,a.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,a.t)("Duration in ms (100.40008 => 100ms 400s 80ns)")]],g=((0,a.t)("Adaptive formatting"),{verbose_name:"Time",column_name:"__timestamp",description:(0,a.t)("A reference to the [Time] configuration, taking granularity into account")}),f={type:"SelectControl",multi:!0,freeForm:!0,label:(0,a.t)("Dimensions"),default:[],includeTime:!1,description:(0,a.t)("One or many columns to group by. High cardinality groupings should include a series limit to limit the number of fetched and rendered series."),optionRenderer:e=>(0,u.tZ)(d.l,{column:e,showType:!0}),valueKey:"column_name",filterOption:(e,t)=>{let{data:r}=e;return r.column_name&&r.column_name.toLowerCase().indexOf(t.toLowerCase())>=0||r.verbose_name&&r.verbose_name.toLowerCase().indexOf(t.toLowerCase())>=0},mapStateToProps:(e,t)=>{const r={};return e.datasource&&(r.options=e.datasource.columns.filter((e=>e.groupby)),t&&t.includeTime&&r.options.push(g)),r}},v={type:"MetricsControl",multi:!0,label:(0,a.t)("Metrics"),validators:[i.Z],mapStateToProps:e=>{const{datasource:t}=e;return{columns:t?t.columns:[],savedMetrics:t?t.metrics:[],datasource:t}},description:(0,a.t)("One or many metrics to display")},_={...v,multi:!1,label:(0,a.t)("Metric"),description:(0,a.t)("Metric")},b={metrics:v,metric:_,datasource:{type:"DatasourceControl",label:(0,a.t)("Dataset"),default:null,description:null,mapStateToProps:e=>{let{datasource:t}=e;return{datasource:t,isEditable:!!t}}},viz_type:{type:"VizTypeControl",default:"table",description:(0,a.t)("The type of visualization to display")},color_picker:{label:(0,a.t)("Fixed color"),description:(0,a.t)("Use this to define a static color for all circles"),type:"ColorPickerControl",default:{r:0,g:122,b:135,a:1},renderTrigger:!0},metric_2:{..._,label:(0,a.t)("Right axis metric"),clearable:!0,description:(0,a.t)("Choose a metric for right axis")},linear_color_scheme:{type:"ColorSchemeControl",label:(0,a.t)("Linear color scheme"),choices:()=>h.values().map((e=>[e.id,e.label])),default:h.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>h.getMap(),isLinear:!0},secondary_metric:{..._,label:(0,a.t)("Color metric"),default:null,validators:[],description:(0,a.t)("A metric to use for color")},groupby:f,columns:{...f,label:(0,a.t)("Columns"),description:(0,a.t)("One or many controls to pivot as columns")},granularity:{type:"SelectControl",freeForm:!0,label:c.m_.granularity,default:"P1D",choices:[[null,(0,a.t)("all")],["PT5S",(0,a.t)("5 seconds")],["PT30S",(0,a.t)("30 seconds")],["PT1M",(0,a.t)("1 minute")],["PT5M",(0,a.t)("5 minutes")],["PT30M",(0,a.t)("30 minutes")],["PT1H",(0,a.t)("1 hour")],["PT6H",(0,a.t)("6 hour")],["P1D",(0,a.t)("1 day")],["P7D",(0,a.t)("7 days")],["P1W",(0,a.t)("week")],["week_starting_sunday",(0,a.t)("week starting Sunday")],["week_ending_saturday",(0,a.t)("week ending Saturday")],["P1M",(0,a.t)("month")],["P3M",(0,a.t)("quarter")],["P1Y",(0,a.t)("year")]],description:(0,a.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`,`1 day` or `56 weeks`")},granularity_sqla:{type:"SelectControl",label:c.m_.granularity_sqla,description:(0,a.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),clearable:!1,optionRenderer:e=>(0,u.tZ)(d.l,{column:e,showType:!0}),valueKey:"column_name",mapStateToProps:e=>{const t={};return e.datasource&&(t.choices=e.datasource.granularity_sqla,t.default=null,e.datasource.main_dttm_col?t.default=e.datasource.main_dttm_col:t.choices&&t.choices.length>0&&(t.default=t.choices[0].column_name)),t}},time_grain_sqla:{type:"SelectControl",label:c.m_.time_grain_sqla,default:"P1D",description:(0,a.t)("The time granularity for the visualization. This applies a date transformation to alter your time column and defines a new time granularity. The options here are defined on a per database engine basis in the Superset source code."),mapStateToProps:e=>({choices:e.datasource?e.datasource.time_grain_sqla:null})},time_range:{type:"DateFilterControl",freeForm:!0,label:c.m_.time_range,default:(0,a.t)("No filter"),description:(0,a.t)('The time range for the visualization. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},row_limit:{type:"SelectControl",freeForm:!0,label:(0,a.t)("Row limit"),validators:[s.Z],default:1e4,choices:(0,l.mG)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,a.t)("Limits the number of rows that get displayed.")},limit:{type:"SelectControl",freeForm:!0,label:(0,a.t)("Series limit"),validators:[s.Z],choices:(0,l.mG)([5,10,25,50,100,500]),clearable:!0,description:(0,a.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},timeseries_limit_metric:{type:"MetricsControl",label:(0,a.t)("Sort by"),default:null,clearable:!0,description:(0,a.t)("Metric used to define how the top series are sorted if a series or row limit is present. If undefined reverts to the first metric (where appropriate)."),mapStateToProps:e=>({columns:e.datasource?e.datasource.columns:[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},series:{...f,label:(0,a.t)("Dimensions"),multi:!1,default:null,description:(0,a.t)("Defines the grouping of entities. Each series is shown as a specific color on the chart and has a legend toggle")},entity:{...f,label:(0,a.t)("Entity"),default:null,multi:!1,validators:[i.Z],description:(0,a.t)("This defines the element to be plotted on the chart")},x:{..._,label:(0,a.t)("X Axis"),description:(0,a.t)("Metric assigned to the [X] axis"),default:null},y:{..._,label:(0,a.t)("Y Axis"),default:null,description:(0,a.t)("Metric assigned to the [Y] axis")},size:{..._,label:(0,a.t)("Bubble size"),default:null},y_axis_format:{type:"SelectControl",freeForm:!0,label:(0,a.t)("Y Axis Format"),renderTrigger:!0,default:"SMART_NUMBER",choices:m,description:"D3 format syntax: https://github.com/d3/d3-format",mapStateToProps:e=>{const t=e.controls&&e.controls.comparison_type&&"percentage"===e.controls.comparison_type.value;return{warning:t?(0,a.t)('When `Calculation type` is set to "Percentage change", the Y Axis Format is forced to `.1%`'):null,disabled:t}}},adhoc_filters:{type:"AdhocFilterControl",label:(0,a.t)("Filters"),default:null,description:"",mapStateToProps:e=>({columns:e.datasource?e.datasource.columns.filter((e=>e.filterable)):[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},color_scheme:{type:"ColorSchemeControl",label:(0,a.t)("Color scheme"),default:p.getDefaultKey(),renderTrigger:!0,choices:()=>p.keys().map((e=>[e,e])),description:(0,a.t)("The color scheme for rendering chart"),schemes:()=>p.getMap()}}},12515:(e,t,r)=>{"use strict";r.d(t,{AH:()=>O,CB:()=>I,H6:()=>C,Jp:()=>v,bX:()=>w,hz:()=>R,kN:()=>S,mG:()=>N,pd:()=>A,pe:()=>x,u:()=>Z,xW:()=>y,y8:()=>T});var n=r(67294),o=r(54998),a=r.n(o),i=r(11064),s=r(19427),l=r(61654),c=r(31069),d=r(55786),u=r(86374),p=r(9679),h=r(54076),m=r(27600),g=r(69856),f=r(80621);function v(e){var t,r;const{slice:n,form_data:o}=e;return null!=(t=null!=(r=null==n?void 0:n.slice_id)?r:null==o?void 0:o.slice_id)?t:g.xA}let _=0;function b(e){void 0===e&&(e=!1);let t=0;return e&&(t=_%u.X.length,_+=1,0===t&&(t+=1,_+=1)),u.X[t]}function y(e,t){return null==e?null:a()(window.location.search).pathname("/api/v1/chart/data").search({form_data:(0,p.o)({slice_id:e}),force:t}).toString()}function E(e){return void 0===e&&(e="base"),["full","json","csv","query","results","samples"].includes(e)?"/superset/explore_json/":"/explore/"}function T(e,t,r){void 0===t&&(t={}),void 0===r&&(r=!1);const n=new(a())("/"),o=E(e),i=n.search(!0);return Object.keys(t).forEach((e=>{i[e]=t[e]})),e===m.KD.standalone.name&&(r&&(i.force="1"),i.standalone=f._B.HIDE_NAV),n.directory(o).search(i).toString()}function S(e){let{path:t,qs:r,allowDomainSharding:n=!1}=e,o=new(a())({protocol:window.location.protocol.slice(0,-1),hostname:b(n),port:window.location.port?window.location.port:"",path:t});return r&&(o=o.search(r)),o}function C(e){let{formData:t,endpointType:r="base",force:n=!1,curUrl:o=null,requestParams:i={},allowDomainSharding:s=!1,method:l="POST"}=e;if(!t.datasource)return null;delete t.label_colors;let c=S({path:"/",allowDomainSharding:s});o&&(c=a()(a()(o).search()));const d=E(r),u=c.search(!0),{slice_id:h,extra_filters:g,adhoc_filters:f,viz_type:v}=t;if(h){const e={slice_id:h};"GET"===l&&(e.viz_type=v,g&&g.length&&(e.extra_filters=g),f&&f.length&&(e.adhoc_filters=f)),u.form_data=(0,p.o)(e)}n&&(u.force="true"),"csv"===r&&(u.csv="true"),r===m.KD.standalone.name&&(u.standalone="1"),"query"===r&&(u.query="true"),"results"===r&&(u.results="true"),"samples"===r&&(u.samples="true");const _=Object.keys(i);return _.length&&_.forEach((e=>{i.hasOwnProperty(e)&&(u[e]=i[e])})),c.search(u).directory(d).toString()}const R=e=>{var t,r;const n=(0,i.Z)().get(e.viz_type);return[null!=(t=null==n?void 0:n.useLegacyApi)&&t,null!=(r=null==n?void 0:n.parseMethod)?r:"json-bigint"]},Z=e=>{var t;let{formData:r,force:n,resultFormat:o,resultType:a,setDataMask:i,ownState:c}=e;return(null!=(t=(0,s.Z)().get(r.viz_type))?t:e=>(0,l.Z)(e,(e=>[{...e}])))({...r,force:n,result_format:o,result_type:a},{ownState:c,hooks:{setDataMask:i}})},A=e=>{let{resultType:t,resultFormat:r}=e;return"csv"===r?r:t},x=e=>{let t,r,{formData:n,resultFormat:o="json",resultType:a="full",force:i=!1,ownState:s={}}=e;const[l,d]=R(n);l?(t=C({formData:n,endpointType:A({resultFormat:o,resultType:a}),allowDomainSharding:!1}),r=n):(t="/api/v1/chart/data",r=Z({formData:n,force:i,resultFormat:o,resultType:a,ownState:s,parseMethod:d})),c.Z.postForm(t,{form_data:(0,p.o)(r)})},O=(e,t)=>{const r=C({formData:e,endpointType:"base",allowDomainSharding:!1,requestParams:t});c.Z.postForm(r,{form_data:(0,p.o)(e)})},w=(e,t,r)=>{const o=(0,n.useCallback)(e,r);(0,n.useEffect)((()=>{const e=setTimeout((()=>{o()}),t);return()=>{clearTimeout(e)}}),[o,t])},I=(e,t,r)=>{var n;const o=[...g.qK].map((e=>g.LT[e].operation)).indexOf(t)>=0;let a="object"==typeof e?null!=(n=null==e?void 0:e.column_name)?n:"":null!=e?e:"";if(e&&t){a+=` ${t}`;const e=o&&Array.isArray(r)?r[0]:r,n=(0,d.Z)(r),i=void 0!==e&&Number.isNaN(Number(e)),s=i?"'":"",[l,c]=o?["(",")"]:["",""],u=n.map((e=>(0,h.lo)(e))).map((e=>`${s}${i?String(e).replace("'","''"):e}${s}`));n.length>0&&(a+=` ${l}${u.join(", ")}${c}`)}return a};function N(e){return e.map((e=>[e,e.toString()]))}},35854:(e,t,r)=>{"use strict";r.d(t,{R3:()=>i,oN:()=>s});var n=r(37687),o=r(10331),a=r(92252);function i(e,t){var r;const a={...t},i=a.viz_type||(null==(r=e.common)?void 0:r.conf.DEFAULT_VIZ_TYPE)||"table";!function(e){e.y_axis_zero&&(e.y_axis_bounds=[0,null])}(a);const s=(0,o.mi)(i,e.datasource.type,e,a),l=(0,n.Z)().get(i)||{};return l.onInit?l.onInit(s):s}function s(e){const t=e.datasource.split("__")[1],r=e.viz_type,n=(0,o.mi)(r,t,null,e),a=(0,o.Hu)(n),i={};return Object.keys(n).concat(Object.keys(e)).forEach((t=>{void 0===e[t]?i[t]=a[t]:i[t]=e[t]})),i}const l={...a.ai};Object.keys(a.ai).forEach((e=>{l[e].value=a.ai[e].default})),(0,o.Hu)(l)},39666:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>u,Dr:()=>g,J8:()=>h,M:()=>v,MZ:()=>b,Me:()=>f,_M:()=>_,cq:()=>m,jt:()=>d});var n=r(41609),o=r.n(n),a=r(31069),i=r(61988),s=r(15926),l=r.n(s),c=r(72570);const d="SET_REPORT";function u(e){let{userId:t,filterField:r,creationMethod:n,resourceId:o}=e;const s=l().encode({filters:[{col:r,opr:"eq",value:o},{col:"creation_method",opr:"eq",value:n},{col:"created_by",opr:"rel_o_m",value:t}]});return function(e){return a.Z.get({endpoint:`/api/v1/report/?q=${s}`}).then((t=>{let{json:a}=t;e(function(e,t,r,n){return{type:d,report:e,resourceId:t,creationMethod:r,filterField:n}}(a,o,n,r))})).catch((()=>e((0,c.Gb)((0,i.t)("There was an issue fetching reports attached to this dashboard.")))))}}const p=(e,t)=>{const r=t(),{user:n,dashboardInfo:a,charts:i,explore:s}=r;if(o()(a)){var l;const[t]=Object.keys(i);e(u({userId:(null==(l=s.user)?void 0:l.userId)||(null==n?void 0:n.userId),filterField:"chart_id",creationMethod:"charts",resourceId:i[t].id}))}else e(u({userId:n.userId,filterField:"dashboard_id",creationMethod:"dashboards",resourceId:a.id}))},h="ADD_REPORT",m=e=>t=>a.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((e=>{let{json:r}=e;t({type:h,json:r}),t((0,c.ws)((0,i.t)("The report has been created")))})),g="EDIT_REPORT",f=(e,t)=>r=>a.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((e=>{let{json:t}=e;r({type:g,json:t}),r((0,c.ws)((0,i.t)("Report updated")))}));function v(e,t){return function(r){return a.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{r((0,c.Gb)((0,i.t)("We were unable to active or deactivate this report.")))})).finally((()=>{r(p)}))}}const _="DELETE_REPORT";function b(e){return function(t){return a.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,c.Gb)((0,i.t)("Your report could not be deleted")))})).finally((()=>{t({type:_,report:e}),t((0,c.ws)((0,i.t)("Deleted: %s",e.name)))}))}}},54076:(e,t,r)=>{"use strict";r.d(t,{EI:()=>v,G6:()=>b,G9:()=>p,Mv:()=>g,Tb:()=>c,cD:()=>f,fV:()=>_,jy:()=>d,li:()=>l,lo:()=>h});var n=r(51115),o=r(42846),a=r(31069),i=r(55786);const s="<empty string>",l="<NULL>",c="TRUE",d="FALSE",u=(0,n.bt)(o.default.DATABASE_DATETIME);function p(e){return a.Z.post({endpoint:"/kv/store/",postPayload:{data:e}}).then((e=>`${window.location.origin+window.location.pathname}?id=${e.json.id}`))}function h(e){return null===e?l:""===e?s:!0===e?c:!1===e?d:"string"!=typeof e&&e.toString?e.toString():e}function m(e){return e.name||e}function g(e,t){let r=t.length?`${t.map(m).join("\t")}\n`:"";for(let n=0;n<e.length;n+=1){const o={};for(let r=0;r<t.length;r+=1){const a=m(t[r]);a in e[n]?o[r]=e[n][a]:o[r]=e[n][parseFloat(a)]}r+=`${Object.values(o).join("\t")}\n`}return r}function f(e,t){return e&&0!==e.length&&0!==(0,i.Z)(t).length?e.map((e=>({...e,...t.reduce(((t,r)=>(null!==e[r]&&void 0!==e[r]&&(t[r]=u(e[r])),t)),{})}))):e}const v=()=>{},_=()=>{const{appVersion:e}=navigator;return e.includes("Win")?"Windows":e.includes("Mac")?"MacOS":e.includes("X11")?"UNIX":e.includes("Linux")?"Linux":"Unknown OS"},b=()=>{const{userAgent:e}=navigator;return e&&/^((?!chrome|android).)*safari/i.test(e)}},79217:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});const n=e=>{var t;return{columns:e.columns,name:(null==e?void 0:e.datasource_name)||(null==e?void 0:e.name)||"Untitled",dbId:(null==e||null==(t=e.database)?void 0:t.id)||(null==e?void 0:e.dbId),sql:(null==e?void 0:e.sql)||"",schema:null==e?void 0:e.schema}}},44814:(e,t,r)=>{"use strict";r.d(t,{zO:()=>i,zQ:()=>a});var n=r(30381),o=r.n(n);const a=function(e,t,r){void 0===r&&(r="HH:mm:ss.SS");const n=t-e;return o()(new Date(n)).utc().format(r)},i=function(){return o()().utc().valueOf()}},86374:(e,t,r)=>{"use strict";r.d(t,{X:()=>a,_:()=>i});var n=r(93185),o=r(20292);const a=function(){var e,t;if(!document.getElementById("app"))return[];const r=new Set([window.location.hostname]);if("1"===new URLSearchParams(window.location.search).get("disableDomainSharding"))return Array.from(r);const a=(0,o.Z)();return(0,n.fG)(a.common.feature_flags),null!=a&&null!=(e=a.common)&&null!=(t=e.conf)&&t.SUPERSET_WEBSERVER_DOMAINS&&a.common.conf.SUPERSET_WEBSERVER_DOMAINS.forEach((e=>{r.add(e)})),Array.from(r)}(),i=a.length>1},16454:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TIME_RANGE:()=>ue,default:()=>ge});var n=r(23279),o=r.n(n),a=r(67294),i=r(45697),s=r.n(i),l=r(4065),c=r(73126),d=r(82492),u=r.n(d),p=r(48533),h=r(75912),m=r(95742),g=r(80454),f=r.n(g),v=r(51995),_=r(37789),b=r(12766),y=r(320),E=r(74061),T=r(11965);const S=30;function C(e){let{children:t,...r}=e;const{maxHeight:n,selectProps:o,theme:i,getStyles:s,cx:l,innerRef:c,isMulti:d,className:u}=r,{windowListRef:p,windowListInnerRef:h}=o,m=(0,a.useRef)(null),g=p||m;let{optionHeight:f}=o;f||(f=i?function(e){let{spacing:{baseUnit:t,lineHeight:r}}=e;return 4*t+r}(i):S);const v=f*t.length;return(0,a.useEffect)((()=>{const e=function(e){return Array.isArray(e)?e.findIndex((e=>{let{props:{isFocused:t=!1}={}}=e;return t}))||0:-1}(t);g.current&&e&&g.current.scrollToItem(e)}),[t,g]),(0,T.tZ)(E.t7,{css:s("menuList",r),className:l({"menu-list":!0,"menu-list--is-multi":d},u),ref:g,outerRef:c,innerRef:h,height:Math.min(v,n),width:"100%",itemData:t,itemCount:t.length,itemSize:f},(e=>{let{data:t,index:r,style:n}=e;return(0,T.tZ)("div",{style:n},t[r])}))}const{MenuList:R}=p.F,Z=100;function A(e){let{children:t,...r}=e;const{windowThreshold:n=Z}=r.selectProps;return Array.isArray(t)&&t.length>n?(0,T.tZ)(C,r,t):(0,T.tZ)(R,r,t)}function x(e){return(0,a.forwardRef)(((t,r)=>{const{components:n={},...o}=t,a={...n,MenuList:A};return(0,T.tZ)(e,(0,c.Z)({components:a,ref:r},o))}))}const O=x(_.ZP),w=x(b.ZP),I=x(y.Z),N="Select",D="Select",L=e=>({primary:e.colors.success.base,danger:e.colors.error.base,warning:e.colors.warning.base,indicator:e.colors.info.base,almostBlack:e.colors.grayscale.dark1,grayDark:e.colors.grayscale.dark1,grayLight:e.colors.grayscale.light2,gray:e.colors.grayscale.light1,grayBg:e.colors.grayscale.light4,grayBgDarker:e.colors.grayscale.light3,grayBgDarkest:e.colors.grayscale.light2,grayHeading:e.colors.grayscale.light1,menuHover:e.colors.grayscale.light3,lightest:e.colors.grayscale.light5,darkest:e.colors.grayscale.dark2,grayBorder:e.colors.grayscale.light2,grayBorderLight:e.colors.grayscale.light3,grayBorderDark:e.colors.grayscale.light1,textDefault:e.colors.grayscale.dark1,textDarkest:e.colors.grayscale.dark2,dangerLight:e.colors.error.light1}),M={container:(e,t)=>{let{theme:{spacing:{minWidth:r}}}=t;return[e,T.iv`
      min-width: ${r};
    `]},placeholder:e=>[e,T.iv`
      white-space: nowrap;
    `],indicatorSeparator:()=>T.iv`
    display: none;
  `,indicatorsContainer:e=>[e,T.iv`
      i {
        width: 1em;
        display: inline-block;
      }
    `],clearIndicator:e=>[e,T.iv`
      padding: 4px 0 4px 6px;
    `],control:(e,t)=>{let{isFocused:r,menuIsOpen:n,theme:{borderRadius:o,colors:a}}=t;const i=r&&!n;let s=a.grayBorder;return(i||n)&&(s=a.grayBorderDark),[e,T.iv`
        border-color: ${s};
        box-shadow: ${i?"inset 0 1px 1px rgba(0,0,0,.075), 0 0 0 3px rgba(0,0,0,.1)":"none"};
        border-radius: ${n?`${o}px ${o}px 0 0`:`${o}px`};
        &:hover {
          border-color: ${s};
          box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06);
        }
        flex-wrap: nowrap;
        padding-left: 1px;
      `]},menu:(e,t)=>{let{theme:{zIndex:r}}=t;return[e,T.iv`
      padding-bottom: 2em;
      z-index: ${r}; /* override at least multi-page pagination */
      width: auto;
      min-width: 100%;
      max-width: 80vw;
      background: none;
      box-shadow: none;
      border: 0;
    `]},menuList:(e,t)=>{let{theme:{borderRadius:r,colors:n}}=t;return[e,T.iv`
      background: ${n.lightest};
      border-radius: 0 0 ${r}px ${r}px;
      border: 1px solid ${n.grayBorderDark};
      box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06);
      margin-top: -1px;
      border-top-color: ${n.grayBorderLight};
      min-width: 100%;
      width: auto;
      border-radius: 0 0 ${r}px ${r}px;
      padding-top: 0;
      padding-bottom: 0;
    `]},option:(e,t)=>{let{isDisabled:r,isFocused:n,isSelected:o,theme:{colors:a,spacing:{lineHeight:i,fontSize:s},weights:l}}=t,c=a.textDefault,d=a.lightest;return n?d=a.grayBgDarker:r&&(c="#ccc"),[e,T.iv`
        cursor: pointer;
        line-height: ${i}px;
        font-size: ${s}px;
        background-color: ${d};
        color: ${c};
        font-weight: ${o?l.bold:l.normal};
        white-space: nowrap;
        &:hover:active {
          background-color: ${a.grayBg};
        }
      `]},valueContainer:(e,t)=>{let{isMulti:r,hasValue:n,theme:{spacing:{baseUnit:o}}}=t;return[e,T.iv`
      padding-left: ${r&&n?1:3*o}px;
    `]},multiValueLabel:(e,t)=>{let{theme:{spacing:{baseUnit:r}}}=t;return{...e,paddingLeft:1.2*r,paddingRight:1.2*r}},input:(e,t)=>{var r;let{selectProps:n}=t;return[e,T.iv`
      margin-left: 0;
      vertical-align: middle;
      ${null!=n&&n.isMulti&&null!=n&&null!=(r=n.value)&&r.length?"padding: 0 6px; width: 100%":"padding: 0; flex: 1 1 auto;"};
    `]},menuPortal:e=>({...e,zIndex:1030})},k={background:"none",border:"none",outline:"none",padding:0},{ClearIndicator:P,DropdownIndicator:U,Option:$,Input:F,SelectContainer:q}=p.F,V={SelectContainer:e=>{let{children:t,...r}=e;const{selectProps:{assistiveText:n}}=r;return(0,T.tZ)("div",null,(0,T.tZ)(q,r,t),n&&(0,T.tZ)("span",{css:e=>({marginLeft:3,fontSize:e.typography.sizes.s,color:e.colors.grayscale.light1})},n))},Option:e=>{let{children:t,innerProps:r,data:n,...o}=e;return(0,T.tZ)($,(0,c.Z)({},o,{data:n,css:null!=n&&n.style?n.style:null,innerProps:r}),t)},ClearIndicator:e=>(0,T.tZ)(P,e,(0,T.tZ)("i",{className:"fa"},"")),DropdownIndicator:e=>(0,T.tZ)(U,e,(0,T.tZ)("i",{className:"fa fa-caret-"+(e.selectProps.menuIsOpen?"up":"down")})),Input:e=>{const{getStyles:t}=e;return(0,T.tZ)(F,(0,c.Z)({},e,{css:t("input",e),autoComplete:"chrome-off",inputStyle:k}))}},B={valueContainer:(e,t)=>{let{getValue:r,theme:{spacing:{baseUnit:n}},isMulti:o}=t;return{...e,paddingLeft:r().length>0?1:3*n,overflow:o&&r().length>0?"visible":"hidden"}},singleValue:(e,t)=>{const{getStyles:r}=t;return{...r("multiValue",t),".metric-option":r("multiValueLabel",t)}}};function H(e){const t=(0,m.JN)(e,{withRef:!0}),r=V;function n(n){let o;const{selectRef:a,labelKey:i="label",valueKey:s="value",themeConfig:l,stylesConfig:d={},optionRenderer:g,valueRenderer:_,valueRenderedAsLabel:b,onPaste:y,multi:E=!1,clearable:S,sortable:C=!0,forceOverflow:R,className:Z=N,classNamePrefix:A=D,options:x,value:O,components:I,isMulti:k,isClearable:P,minMenuHeight:U=100,maxMenuHeight:$=220,filterOption:F,ignoreAccents:q=!1,asText:V=(e=>String(null!=e?e:"")),getOptionValue:H=(e=>"string"==typeof e?e:e[s]),getOptionLabel:j=(e=>"string"==typeof e?e:V(e[i])||V(e[s])),formatOptionLabel:z=((e,t)=>{let{context:r}=t;return"value"===r?_?_(e):j(e):g?g(e):j(e)}),...Q}=n,G=function(e,t,r){var n;if(void 0===t&&(t=[]),void 0===r&&(r="value"),null==e||""===e)return[];const o=Array.isArray(null==(n=t[0])?void 0:n.options)?t.flatMap((e=>e.options||[])):t;return(Array.isArray(e)?e:[e]).map((t=>{const n=null!=e&&e.hasOwnProperty(r)?t[r]:t;return o.find((e=>e===n||e[r]===n))||t}))}(O,x||[],s),Y=void 0===k?E:k,W=void 0===P?S:P,K=Y&&C&&Array.isArray(G)&&G.length>1,X=K?t:e,J={...r,...I};if(K){J.MultiValue=(ee=J.MultiValue||p.F.MultiValue,(0,m.W8)((e=>(0,T.tZ)(ee,(0,c.Z)({},e,{innerProps:{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()}}})))));const e={getHelperDimensions:e=>{let{node:t}=e;return t.getBoundingClientRect()},axis:"xy",onSortEnd:e=>{let{oldIndex:t,newIndex:r}=e;const n=f()(G,t,r);Q.onChange&&Q.onChange(n,{action:"set-value"})},distance:4};Object.assign(Q,e)}var ee;if((void 0===b?Y:b)&&!d.valueContainer&&Object.assign(d,B),y){const e=J.Input||p.F.Input;J.Input=t=>(0,T.tZ)(e,(0,c.Z)({},t,{onPaste:y}))}e===w&&(Q.getNewOptionData=(e,t)=>({label:t||e,[s]:e,isNew:!0})),R&&Object.assign(Q,{closeMenuOnScroll:e=>{var t,r,n;const a=null==(t=o)||null==(r=t.state)?void 0:r.menuIsOpen,i=e.target;return a&&i&&!(null!=(n=i.classList)&&n.contains("Select__menu-list"))},menuPosition:"fixed"});const te=(0,v.Fg)();return(0,T.tZ)(X,(0,c.Z)({ref:e=>{o=K&&e&&"refs"in e?e.refs.wrappedInstance:e,"function"==typeof a?a(o):a&&"current"in a&&(a.current=o)},className:Z,classNamePrefix:A,isMulti:Y,isClearable:W,options:x,value:G,minMenuHeight:U,maxMenuHeight:$,filterOption:void 0!==F?F:(0,h.c)({ignoreAccents:q}),styles:{...M,...d},theme:e=>u()(e,(e=>({borderRadius:e.borderRadius,zIndex:11,colors:L(e),spacing:{baseUnit:3,menuGutter:0,controlHeight:34,lineHeight:19,fontSize:14,minWidth:"6.5em"},weights:e.typography.weights}))(te),l),formatOptionLabel:z,getOptionLabel:j,getOptionValue:H,components:J},Q))}return a.memo(n)}const j=H(O),z=H(w),Q=H(I);class G extends a.Component{constructor(e){super(e),this.onPaste=this.onPaste.bind(this)}onPaste(e){if(!this.props.isMulti)return;e.preventDefault();const t=e.clipboardData.getData("Text");if(!t)return;const r=`[${this.props.separator}]+`,n=t.split(new RegExp(r)).map((e=>e.trim())),o=this.props.isValidNewOption,a=this.props.value||[],i={},s={};this.props.options.forEach((e=>{i[e[this.props.valueKey]]=1}));let l=[];a.forEach((e=>{l.push({[this.props.labelKey]:e,[this.props.valueKey]:e}),s[e]=1})),l=l.concat(n.filter((e=>{const t=!s[e];return s[e]=1,t&&(o?o({[this.props.labelKey]:e}):!!e)})).map((e=>{const t={[this.props.labelKey]:e,[this.props.valueKey]:e};return i[e]||this.props.options.unshift(t),t}))),l.length&&this.props.onChange&&this.props.onChange(l)}render(){const{selectWrap:e,...t}=this.props;return(0,T.tZ)(e,(0,c.Z)({},t,{onPaste:this.onPaste}))}}G.propTypes={separator:s().array,selectWrap:s().elementType,selectRef:s().func,onChange:s().func.isRequired,valueKey:s().string,labelKey:s().string,options:s().array,isMulti:s().bool,value:s().any,isValidNewOption:s().func,noResultsText:s().string,forceOverflow:s().bool},G.defaultProps={separator:[",","\n","\t",";"],selectWrap:j,valueKey:"value",labelKey:"label",options:[],isMulti:!1};var Y=r(64749);const W=(0,v.iK)((e=>(0,T.tZ)(Y.default,(0,c.Z)({getPopupContainer:e=>e.parentNode},e))))`
  display: block;
`,K=(0,v.iK)(Y.default)`
  &.ant-select-single {
    .ant-select-selector {
      height: 36px;
      padding: 0 11px;
      background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light3}};
      border: none;

      .ant-select-selection-search-input {
        height: 100%;
      }

      .ant-select-selection-item,
      .ant-select-selection-placeholder {
        line-height: 35px;
        color: ${e=>{let{theme:t}=e;return t.colors.grayscale.dark1}};
      }
    }
  }
`;Object.assign(W,{Option:Y.default.Option}),Object.assign(K,{Option:Y.default.Option});var X=r(35932),J=r(55786),ee=r(31069),te=r(61988),re=r(68135),ne=r(27600),oe=r(49238),ae=r(1090),ie=r(61357),se=r(59317),le=r(92252),ce=r(12515),de=r(69856);const ue=de.i2.time_range,pe={chartId:s().number.isRequired,origSelectedValues:s().object,datasource:s().object.isRequired,instantFiltering:s().bool,filtersFields:s().arrayOf(s().shape({field:s().string,label:s().string})),filtersChoices:s().objectOf(s().arrayOf(s().shape({id:s().string,text:s().string,filter:s().string,metric:s().number}))),onChange:s().func,onFilterMenuOpen:s().func,onFilterMenuClose:s().func,showDateFilter:s().bool,showSqlaTimeGrain:s().bool,showSqlaTimeColumn:s().bool},he=v.iK.div`
  ${e=>{let{theme:t}=e;return`\n    display: flex;\n    flex-direction: column;\n    margin-bottom: ${2*t.gridUnit+2}px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    label {\n      display: flex;\n      font-weight: ${t.typography.weights.bold};\n    }\n\n    .filter-badge-container {\n      width: 30px;\n      padding-right: ${2*t.gridUnit+2}px;\n    }\n\n    .filter-badge-container + div {\n      width: 100%;\n    }\n  `}}
`;class me extends a.PureComponent{constructor(e){super(e),this.onCloseDateFilterControl=()=>this.onFilterMenuClose(ue),this.state={selectedValues:e.origSelectedValues,hasChanged:!1},this.debouncerCache={},this.maxValueCache={},this.changeFilter=this.changeFilter.bind(this),this.onFilterMenuOpen=this.onFilterMenuOpen.bind(this),this.onOpenDateFilterControl=this.onOpenDateFilterControl.bind(this),this.onFilterMenuClose=this.onFilterMenuClose.bind(this)}onFilterMenuOpen(e){return this.props.onFilterMenuOpen(this.props.chartId,e)}onFilterMenuClose(e){return this.props.onFilterMenuClose(this.props.chartId,e)}onOpenDateFilterControl(){return this.onFilterMenuOpen(ue)}getControlData(e){const{selectedValues:t}=this.state,r={...le.ai[e],name:e,key:`control-${e}`,value:t[de.i2[e]],actions:{setControlValue:this.changeFilter}},n=r.mapStateToProps;return n?{...r,...n(this.props)}:r}getKnownMax(e,t){return this.maxValueCache[e]=Math.max(this.maxValueCache[e]||0,(0,l.max)(t||this.props.filtersChoices[e]||[],(e=>e.metric))),this.maxValueCache[e]}clickApply(){const{selectedValues:e}=this.state;this.setState({hasChanged:!1},(()=>{this.props.onChange(e,!1)}))}changeFilter(e,t){const r=de.i2[e]||e;let n=null;if(null!==t)if(Array.isArray(t))n=t.map((e=>"string"==typeof e?e:e.value));else if(Object.values(de.i2).includes(r)){var o;n=null!=(o=t.value)?o:t}else{var a;n=(0,J.Z)(null!=(a=t.value)?a:t)}this.setState((e=>({selectedValues:{...e.selectedValues,[r]:n},hasChanged:!0})),(()=>{this.props.instantFiltering&&this.props.onChange({[r]:n},!1)}))}debounceLoadOptions(e){return e in this.debouncerCache||(this.debouncerCache[e]=o()(((t,r)=>{this.loadOptions(e,t).then(r)}),ne.M$)),this.debouncerCache[e]}transformOptions(e,t){const r=void 0===t?(0,l.max)(e,(e=>e.metric)):t;return e.map((e=>{const t=Math.round(e.metric/r*100),n="lightgrey",o={backgroundImage:`linear-gradient(to right, ${n}, ${n} ${t}%, rgba(0,0,0,0) ${t}%`};let a=e.id;return!0===a?a=ne.Ly:!1===a&&(a=ne.gz),{value:e.id,label:a,style:o}}))}async loadOptions(e,t){var r;void 0===t&&(t="");const n=t.toLowerCase(),o=this.props.filtersFields.find((t=>t.key===e)).asc,a={...this.props.rawFormData,adhoc_filters:t?[{clause:"WHERE",expressionType:"SIMPLE",subject:e,operator:"ILIKE",comparator:`%${n}%`}]:null},{json:i}=await ee.Z.get({url:(0,ce.H6)({formData:a,endpointType:"json",method:"GET"})}),s=((null==i||null==(r=i.data)?void 0:r[e])||[]).filter((e=>e.id));return s&&0!==s.length?(n&&s.sort(((e,t)=>{const r=e.id.toLowerCase(),a=t.id.toLowerCase().startsWith(n)-r.startsWith(n);return 0===a?(e.metric-t.metric)*(o?1:-1):a})),this.transformOptions(s,this.getKnownMax(e,s))):[]}renderDateFilter(){const{showDateFilter:e}=this.props,t=de.m_.time_range;return e?(0,T.tZ)("div",{className:"row space-1"},(0,T.tZ)("div",{className:"col-lg-12 col-xs-12"},(0,T.tZ)(ae.ZP,{name:ue,label:t,description:(0,te.t)("Select start and end date"),onChange:e=>{this.changeFilter(ue,e)},onOpenDateFilterControl:this.onOpenDateFilterControl,onCloseDateFilterControl:this.onCloseDateFilterControl,value:this.state.selectedValues[ue]||"No filter",endpoints:["inclusive","exclusive"]}))):null}renderDatasourceFilters(){const{showSqlaTimeGrain:e,showSqlaTimeColumn:t}=this.props,r=[],n=[];return e&&n.push("time_grain_sqla"),t&&n.push("granularity_sqla"),n.length&&r.push((0,T.tZ)(ie.Z,{key:"sqla-filters",controls:n.map((e=>(0,T.tZ)(se.Z,this.getControlData(e))))})),r}renderSelect(e){const{filtersChoices:t}=this.props,{selectedValues:r}=this.state;this.debouncerCache={},this.maxValueCache={},Object.keys(r).filter((e=>e in t)).forEach((e=>{if(!r[e])return;const n=t[e]||(t[e]=[]),o=new Set(n.map((e=>e.id)));(Array.isArray(r[e])?r[e]:[r[e]]).filter((e=>null!==e&&!o.has(e))).forEach((t=>{n.unshift({filter:e,id:t,text:t,metric:0})}))}));const{key:n,label:o,[de.ft.MULTIPLE]:a,[de.ft.DEFAULT_VALUE]:i,[de.ft.CLEARABLE]:s,[de.ft.SEARCH_ALL_OPTIONS]:l}=e,c=t[n]||[];let d=r[n]||null;return void 0===d&&i&&(d=a?i.split(";"):i),(0,T.tZ)(G,{cacheOptions:!0,loadOptions:this.debounceLoadOptions(n),defaultOptions:this.transformOptions(c),key:n,placeholder:(0,te.t)("Type or Select [%s]",o),isMulti:a,isClearable:s,value:d,options:this.transformOptions(c),onChange:e=>{e!==d&&this.changeFilter(n,e)},onMenuOpen:()=>this.onFilterMenuOpen(n),onBlur:()=>this.onFilterMenuClose(n),onMenuClose:()=>this.onFilterMenuClose(n),selectWrap:l&&c.length>=de.cM?Q:z,noResultsText:(0,te.t)("No results found"),forceOverflow:!0})}renderFilters(){const{filtersFields:e=[]}=this.props;return e.map((e=>{const{label:t,key:r}=e;return(0,T.tZ)(he,{key:r,className:"filter-container"},(0,T.tZ)(oe.lX,{htmlFor:`LABEL-${r}`},t),this.renderSelect(e))}))}render(){const{instantFiltering:e,width:t,height:r}=this.props,{zIndex:n,gridUnit:o}=this.props.theme;return(0,T.tZ)(a.Fragment,null,(0,T.tZ)(T.xB,{styles:T.iv`
            .dashboard .filter_box .slice_container > div:not(.alert) {
              padding-top: 0;
            }

            .filter_box {
              padding: ${2*o+2}px 0;
              overflow: visible !important;

              &:hover {
                z-index: ${n.max};
              }
            }
          `}),(0,T.tZ)("div",{style:{width:t,height:r,overflow:"auto"}},this.renderDateFilter(),this.renderDatasourceFilters(),this.renderFilters(),!e&&(0,T.tZ)(X.Z,{buttonSize:"small",buttonStyle:"primary",onClick:this.clickApply.bind(this),disabled:!this.state.hasChanged},(0,te.t)("Apply"))))}}me.propTypes=pe,me.defaultProps={origSelectedValues:{},onChange:()=>{},onFilterMenuOpen:()=>{},onFilterMenuClose:()=>{},showDateFilter:!1,showSqlaTimeGrain:!1,showSqlaTimeColumn:!1,instantFiltering:!1};const ge=(0,re.b)(me)},74082:e=>{const t=[null];e.exports=t.length<=1?t[0]:t},61819:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(21804),o=r.n(n),a=(r(67294),r(51995)),i=r(61988),s=r(51776),l=r(11965);const c=a.iK.div`
  margin-bottom: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,d=function(e){let{certifiedBy:t,details:r,metricName:n}=e;const d=(0,a.Fg)();return(0,l.tZ)(s.Z,{id:`${o()(n)}-tooltip`,title:(0,l.tZ)("div",null,t&&(0,l.tZ)(c,null,(0,i.t)("Certified by %s",t)),(0,l.tZ)("div",null,r))},(0,l.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:"14",viewBox:"0 0 24 24",width:"14"},(0,l.tZ)("g",null,(0,l.tZ)("path",{fill:d.colors.primary.base,d:"M23,12l-2.44-2.79l0.34-3.69l-3.61-0.82L15.4,1.5L12,2.96L8.6,1.5L6.71,4.69L3.1,5.5L3.44,9.2L1,12l2.44,2.79l-0.34,3.7 l3.61,0.82L8.6,22.5l3.4-1.47l3.4,1.46l1.89-3.19l3.61-0.82l-0.34-3.69L23,12z M9.38,16.01L7,13.61c-0.39-0.39-0.39-1.02,0-1.41 l0.07-0.07c0.39-0.39,1.03-0.39,1.42,0l1.61,1.62l5.15-5.16c0.39-0.39,1.03-0.39,1.42,0l0.07,0.07c0.39,0.39,0.39,1.02,0,1.41 l-5.92,5.94C10.41,16.4,9.78,16.4,9.38,16.01z"}))))}},65634:(e,t,r)=>{"use strict";r.d(t,{E:()=>p});var n=r(67294),o=r(51995),a=r(11965),i=r(51776),s=r(46488),l=r(61819),c=r(71963),d=r(60605);const u=o.iK.span`
  display: flex;
  align-items: center;
  svg {
    margin-right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`;function p(e){let{column:t,labelRef:r,showType:o=!1}=e;const{expression:p,column_name:h,type_generic:m}=t,g=p&&p!==h,f=g?"expression":m,[v,_]=(0,n.useState)(t.column_name),[b,y]=(0,n.useState)(t.type);return(0,n.useLayoutEffect)((()=>{_((0,c.ZK)(t,r)),y((0,c.GX)(t))}),[r,t]),(0,a.tZ)(u,null,o&&void 0!==f&&(0,a.tZ)(i.u,{id:"metric-type-tooltip",title:b,placement:"bottomRight",align:{offset:[8,-2]}},(0,a.tZ)("span",null,(0,a.tZ)(s.j,{type:f}))),(0,a.tZ)(i.u,{id:"metric-name-tooltip",title:v},(0,a.tZ)("span",{className:"option-label column-option-label",css:e=>a.iv`
            margin-right: ${e.gridUnit}px;
          `,ref:r},(0,c.ok)(t))),g&&(0,a.tZ)(d.Z,{sqlExpression:p}),t.is_certified&&(0,a.tZ)(l.Z,{metricName:t.metric_name,certifiedBy:t.certified_by,details:t.certification_details}))}},46488:(e,t,r)=>{"use strict";r.d(t,{j:()=>A});var n,o=r(67294),a=r(51995),i=r(11965),s=r(61988),l=r(88889),c=r(63270),d=r(30071);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(this,arguments)}const p=(e,t)=>{let{title:r,titleId:a,...i}=e;return o.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":a},i),r?o.createElement("title",{id:a},r):null,n||(n=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m6.988 10.809-1.031 4.84c-.184.867-.57 1.576-1.16 2.126-.59.551-1.197.827-1.822.827-.344 0-.597-.066-.76-.197a.61.61 0 0 1-.242-.495.7.7 0 0 1 .152-.445c.102-.13.248-.194.44-.194.12 0 .227.028.319.082a.978.978 0 0 1 .243.206c.055.066.116.156.185.27l.178.292c.301-.023.558-.226.77-.61.214-.382.398-.929.554-1.64l1.079-5.062H4.75l.123-.534h1.13l.083-.398c.094-.453.242-.861.445-1.225.203-.363.434-.672.692-.925.254-.25.542-.447.864-.59.322-.142.632-.213.929-.213.343 0 .596.065.758.196a.61.61 0 0 1 .244.495.727.727 0 0 1-.144.446c-.096.128-.245.193-.448.193a.614.614 0 0 1-.317-.08.895.895 0 0 1-.24-.207 1.921 1.921 0 0 1-.187-.276 3.843 3.843 0 0 0-.176-.287c-.27.012-.508.19-.715.534-.207.343-.395.916-.562 1.716l-.13.621H8.57l-.123.534H6.988Zm2.225 2.261c0-1.758.45-3.183 1.387-4.424h.713c-.694.89-1.236 2.774-1.236 4.424 0 1.66.537 3.54 1.236 4.429H10.6c-.938-1.24-1.387-2.666-1.387-4.429Zm5.288.957h-.078l-1.25 1.988h-.952l1.802-2.632L12.2 10.75h1.001l1.25 1.958h.078l1.236-1.958h.952l-1.787 2.598 1.811 2.666h-.996l-1.245-1.988Zm5.23-.952c0 1.758-.45 3.184-1.387 4.424h-.713c.693-.889 1.235-2.773 1.235-4.424 0-1.66-.537-3.54-1.235-4.429h.713c.937 1.24 1.386 2.666 1.386 4.43Z",clipRule:"evenodd"})))},h=(0,o.forwardRef)(p);var m;function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g.apply(this,arguments)}const f=(e,t)=>{let{title:r,titleId:n,...a}=e;return o.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":n},a),r?o.createElement("title",{id:n},r):null,m||(m=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 4h-1v16h1V4Zm3.248 8.475c0 2.343.913 3.691 2.5 3.691 1.582 0 2.49-1.338 2.49-3.677 0-2.334-.923-3.7-2.49-3.7-1.577 0-2.5 1.361-2.5 3.686ZM5.579 9.93V16h.879V8.954h-.874l-1.875 1.348v.928l1.792-1.3h.078Zm12.169 5.468c1.04 0 1.607-1.035 1.607-2.924 0-1.87-.577-2.915-1.607-2.915s-1.616 1.054-1.616 2.915c0 1.884.576 2.924 1.616 2.924Z",clipRule:"evenodd"})))},v=(0,o.forwardRef)(f);var _;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(this,arguments)}const y=(e,t)=>{let{title:r,titleId:n,...a}=e;return o.createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":n},a),r?o.createElement("title",{id:n},r):null,_||(_=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.91 16.14c-1.14 0-2.047-.671-2.047-1.843 0-1.375 1.215-1.621 2.328-1.766 1.094-.14 1.547-.117 1.547-.562 0-.778-.41-1.235-1.265-1.235-.88 0-1.36.47-1.563.907l-.875-.313c.469-1.094 1.5-1.406 2.406-1.406.766 0 2.22.219 2.22 2.125V16h-.923v-.813h-.047c-.187.391-.734.954-1.78.954Zm.14-.828c1.095 0 1.688-.734 1.688-1.484v-.844c-.156.188-1.203.297-1.593.344-.72.094-1.36.313-1.36 1.016 0 .64.531.969 1.266.969ZM9.799 16V8h.921v2.953h.079c.203-.312.562-1.031 1.734-1.031 1.516 0 2.563 1.203 2.563 3.094 0 1.906-1.047 3.109-2.547 3.109-1.157 0-1.547-.719-1.75-1.047h-.11V16h-.89Zm.906-3c0 1.36.61 2.297 1.719 2.297 1.156 0 1.75-1.016 1.75-2.297 0-1.266-.579-2.25-1.75-2.25-1.125 0-1.72.906-1.72 2.25Zm7.684 3.125c-1.687 0-2.719-1.297-2.719-3.094 0-1.828 1.079-3.11 2.704-3.11 1.265 0 2.218.75 2.375 1.876h-.922c-.14-.547-.625-1.047-1.438-1.047-1.078 0-1.797.89-1.797 2.25 0 1.39.703 2.297 1.797 2.297.719 0 1.266-.39 1.438-1.047h.922c-.157 1.063-1.032 1.875-2.36 1.875Z",clipRule:"evenodd"})))},E=(0,o.forwardRef)(y);var T;function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S.apply(this,arguments)}const C=(e,t)=>{let{title:r,titleId:n,...a}=e;return o.createElement("svg",S({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":n},a),r?o.createElement("title",{id:n},r):null,T||(T=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10 8h1v2h2V8h1v2h2v1h-2v2h2v1h-2v2h-1v-2h-2v2h-1v-2H8v-1h2v-2H8v-1h2V8Zm3 5v-2h-2v2h2Z",clipRule:"evenodd"})))},R=(0,o.forwardRef)(C),Z=a.iK.div`
  ${e=>{let{theme:t}=e;return i.iv`
    display: flex;
    justify-content: center;
    align-items: center;
    width: ${6*t.gridUnit}px;
    height: ${6*t.gridUnit}px;
    margin-right: ${t.gridUnit}px;

    && svg {
      margin-right: 0;
      margin-left: 0;
      width: 100%;
      height: 100%;
    }
  `}};
`;function A(e){let{type:t}=e,r=(0,i.tZ)(c.Z,{"aria-label":(0,s.t)("unknown type icon")});return""===t||"expression"===t?r=(0,i.tZ)(h,{"aria-label":(0,s.t)("function type icon")}):t===l.Z.STRING?r=(0,i.tZ)(E,{"aria-label":(0,s.t)("string type icon")}):t===l.Z.NUMERIC?r=(0,i.tZ)(R,{"aria-label":(0,s.t)("numeric type icon")}):t===l.Z.BOOLEAN?r=(0,i.tZ)(v,{"aria-label":(0,s.t)("boolean type icon")}):t===l.Z.TEMPORAL&&(r=(0,i.tZ)(d.Z,{"aria-label":(0,s.t)("temporal type icon")})),(0,i.tZ)(Z,null,r)}},46666:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});const n=r(51995).iK.div`
  font-weight: ${e=>{let{theme:t}=e;return t.typography.weights.bold}};
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}};
  margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`},9882:(e,t,r)=>{"use strict";r.d(t,{V:()=>l,Z:()=>c});var n=r(21804),o=r.n(n),a=(r(67294),r(61988)),i=r(51776),s=r(11965);function l(e){let{label:t,tooltip:r,bsStyle:n,onClick:l,icon:c="info-circle",className:d="text-muted",placement:u="right",iconsStyle:p={}}=e;const h=`fa fa-${c} ${d} ${n?`text-${n}`:""}`,m=(0,s.tZ)("i",{role:"button","aria-label":(0,a.t)("Show info tooltip"),tabIndex:0,className:h,style:{cursor:l?"pointer":void 0,...p},onClick:l,onKeyPress:l&&(e=>{"Enter"!==e.key&&" "!==e.key||l()})});return r?(0,s.tZ)(i.u,{id:`${o()(t)}-tooltip`,title:r,placement:u},m):m}const c=l},51384:(e,t,r)=>{"use strict";r.d(t,{m:()=>m});var n=r(67294),o=r(51995),a=r(11965),i=r(78186),s=r(9882),l=r(46488),c=r(61819),d=r(51776),u=r(71963),p=r(60605);const h=o.iK.div`
  align-items: center;
  display: flex;

  > svg {
    margin-right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`;function m(e){let{metric:t,labelRef:r,openInNewWindow:o=!1,showFormula:m=!0,showType:g=!1,shouldShowTooltip:f=!0,url:v=""}=e;const _=t.verbose_name||t.metric_name||t.label,b=v?(0,a.tZ)("a",{href:v,target:o?"_blank":"",rel:"noreferrer"},_):_,y=(0,a.tZ)("span",{className:"option-label metric-option-label",css:e=>a.iv`
        margin-right: ${e.gridUnit}px;
      `,ref:r},b),E=t.warning_markdown||t.warning_text,[T,S]=(0,n.useState)(t.metric_name);return(0,n.useLayoutEffect)((()=>{S((0,u.Lk)(t,r))}),[r,t]),(0,a.tZ)(h,{className:"metric-option"},g&&(0,a.tZ)(l.j,{type:"expression"}),f?(0,a.tZ)(d.Z,{id:"metric-name-tooltip",title:T},y):y,m&&t.expression&&(0,a.tZ)(p.Z,{sqlExpression:t.expression}),t.is_certified&&(0,a.tZ)(c.Z,{metricName:t.metric_name,certifiedBy:t.certified_by,details:t.certification_details}),E&&(0,a.tZ)(s.Z,{className:"text-warning",icon:"warning",tooltip:(0,a.tZ)(i.Z,{source:E}),label:`warn-${t.metric_name}`,iconsStyle:{marginLeft:0}}))}},60605:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(73126),o=(r(67294),r(19181)),a=r(74981),i=r(85369),s=r(51995),l=r(11965),c=r(61988);r(89899);const d=(0,s.iK)(i.Z)`
  ${e=>{let{theme:t}=e;return l.iv`
    color: ${t.colors.grayscale.base};
    font-size: ${t.typography.sizes.s}px;
    & svg {
      margin-left: ${t.gridUnit}px;
      margin-right: ${t.gridUnit}px;
    }
  `}}
`,u=e=>{const t=(0,s.Fg)();return(0,l.tZ)(o.Z,(0,n.Z)({content:(0,l.tZ)(a.default,{mode:"sql",value:e.sqlExpression,editorProps:{$blockScrolling:!0},setOptions:{highlightActiveLine:!1,highlightGutterLine:!1},minLines:2,maxLines:6,readOnly:!0,wrapEnabled:!0,style:{border:`1px solid ${t.colors.grayscale.light2}`,background:t.colors.secondary.light5,maxWidth:100*t.gridUnit}}),placement:"bottomLeft",arrowPointAtCenter:!0,title:(0,c.t)("SQL expression")},e),(0,l.tZ)(d,null))}},51776:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c,u:()=>l});var n=r(73126),o=r(67294),a=r(51995),i=r(11965),s=r(31097);const l=e=>{let{overlayStyle:t,color:r,...l}=e;const c=(0,a.Fg)(),d=`${c.colors.grayscale.dark2}e6`;return(0,i.tZ)(o.Fragment,null,(0,i.tZ)(i.xB,{styles:i.iv`
          .ant-tooltip-open {
            display: inline-block;
            &::after {
              content: '';
              display: block;
            }
          }
        `}),(0,i.tZ)(s.Z,(0,n.Z)({overlayStyle:{fontSize:c.typography.sizes.s,lineHeight:"1.6",maxWidth:62*c.gridUnit,minWidth:30*c.gridUnit,...t},align:{offset:[0,1]},color:d||r,trigger:"hover",placement:"bottom",mouseLeaveDelay:0},l)))},c=l},71963:(e,t,r)=>{"use strict";r.d(t,{GX:()=>p,Lk:()=>m,ZK:()=>h,ok:()=>u});var n=r(67294),o=r(51995),a=r(11965),i=r(61988);const s=o.iK.div`
  ${e=>{let{theme:t}=e;return a.iv`
    display: flex;
    flex-direction: column;
    font-size: ${t.typography.sizes.s}px;
    line-height: 1.2;

    &:not(:last-of-type) {
      margin-bottom: ${2*t.gridUnit}px;
    }
    &:last-of-type {
      display: -webkit-box;
      -webkit-line-clamp: 40;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  `}}
`,l=o.iK.span`
  ${e=>{let{theme:t}=e;return a.iv`
    font-weight: ${t.typography.weights.bold};
  `}}
`,c=e=>{let{label:t,text:r}=e;return(0,a.tZ)(s,null,(0,a.tZ)(l,null,t),(0,a.tZ)("span",null,r))},d=e=>{var t,r;return!!((null==e||null==(t=e.current)?void 0:t.scrollWidth)>(null==e||null==(r=e.current)?void 0:r.clientWidth))},u=e=>e.verbose_name||e.column_name,p=e=>e.type?(0,a.tZ)(c,{label:(0,i.t)("Column datatype"),text:e.type.toLowerCase()}):null,h=(e,t)=>e.column_name&&e.verbose_name||e.description||d(t)?(0,a.tZ)(n.Fragment,null,e.column_name&&(0,a.tZ)(c,{label:(0,i.t)("Column name"),text:e.column_name}),e.verbose_name&&(0,a.tZ)(c,{label:(0,i.t)("Label"),text:e.verbose_name}),e.description&&(0,a.tZ)(c,{label:(0,i.t)("Description"),text:e.description})):null,m=(e,t)=>e.verbose_name||e.description||e.label||d(t)?(0,a.tZ)(n.Fragment,null,(0,a.tZ)(c,{label:(0,i.t)("Metric name"),text:e.metric_name}),(e.label||e.verbose_name)&&(0,a.tZ)(c,{label:(0,i.t)("Label"),text:e.label||e.verbose_name}),e.description&&(0,a.tZ)(c,{label:(0,i.t)("Description"),text:e.description})):null},35622:(e,t,r)=>{"use strict";r.d(t,{$z:()=>l,CV:()=>p,DS:()=>d,LU:()=>u,PJ:()=>m,YY:()=>g,ZK:()=>f,cm:()=>h,m_:()=>c});var n=r(61988),o=r(5364),a=r(88889),i=r(20620),s=r(38575);const l=1e5,c={time_range:(0,n.t)("Time Range"),granularity_sqla:(0,n.t)("Time Column"),time_grain_sqla:(0,n.t)("Time Grain"),granularity:(0,n.t)("Time Granularity")},d={[o.W3]:(0,n.t)("Time")},u={verbose_name:d[o.W3],column_name:o.W3,type:"TIMESTAMP",type_generic:a.Z.TEMPORAL,description:(0,n.t)("A reference to the [Time] configuration, taking granularity into account")},p={column_name:o.W3,is_dttm:!0,type:"TIMESTAMP",type_generic:a.Z.TEMPORAL},h={[i.n.aggregate]:(0,n.t)("Aggregate"),[i.n.raw]:(0,n.t)("Raw records")},m={sort_series_type:s.Id.Sum,sort_series_ascending:!1},g=[[s.Id.Name,(0,n.t)("Category name")],[s.Id.Sum,(0,n.t)("Total value")],[s.Id.Min,(0,n.t)("Minimum value")],[s.Id.Max,(0,n.t)("Maximum value")],[s.Id.Avg,(0,n.t)("Average value")]],f={sort_series_type:s.Id.Name,sort_series_ascending:!0}},93362:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var n=r(11965),o=(r(67294),r(51995)),a=r(61988),i=r(9882),s=r(51776);function l(e){let{name:t,description:r,label:o,tooltipOnClick:l,onClick:c,warning:d,danger:u,leftNode:p,rightNode:h,validationErrors:m=[],renderTrigger:g=!1,hovered:f=!1,required:v=!1}=e;if(!o)return null;const _=m.length>0?"text-danger":"";return(0,n.tZ)("div",{className:"ControlHeader"},(0,n.tZ)("div",{className:"pull-left"},(0,n.tZ)("label",{className:"control-label",htmlFor:t},p&&(0,n.tZ)("span",null,p),(0,n.tZ)("span",{role:"button",tabIndex:0,onClick:c,className:_,style:{cursor:c?"pointer":""}},o)," ",d&&(0,n.tZ)("span",null,(0,n.tZ)(s.u,{id:"error-tooltip",placement:"top",title:d},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-warning"}))," "),u&&(0,n.tZ)("span",null,(0,n.tZ)(s.u,{id:"error-tooltip",placement:"top",title:u},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-danger"}))," "),m.length>0&&(0,n.tZ)("span",null,(0,n.tZ)(s.u,{id:"error-tooltip",placement:"top",title:m.join(" ")},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-danger"}))," "),f?(0,n.tZ)("span",null,r&&(0,n.tZ)("span",null,(0,n.tZ)(i.V,{label:(0,a.t)("description"),tooltip:r,placement:"top",onClick:l})," "),g&&(0,n.tZ)("span",null,(0,n.tZ)(i.V,{label:(0,a.t)("bolt"),tooltip:(0,a.t)("Changing this control takes effect instantly"),placement:"top",icon:"bolt"})," ")):null,v&&(0,n.tZ)("span",{className:"text-danger m-l-4"},(0,n.tZ)("strong",null,"*")))),h&&(0,n.tZ)("div",{className:"pull-right"},h),(0,n.tZ)("div",{className:"clearfix"}))}const c={RadioButtonControl:function(e){let{value:t,options:r,onChange:a,...i}=e;const s=t||r[0][0],c=(0,o.Fg)();return(0,n.tZ)("div",{css:(0,n.iv)({".btn svg":{position:"relative",top:"0.2em"},".btn:focus":{outline:"none"},".control-label":{color:c.colors.grayscale.base,marginBottom:c.gridUnit},".control-label + .btn-group":{marginTop:"1px"},".btn-group .btn-default":{color:c.colors.grayscale.dark1},".btn-group .btn.active":{background:c.colors.grayscale.light4,fontWeight:c.typography.weights.bold,boxShadow:"none"}},"","")},(0,n.tZ)(l,i),(0,n.tZ)("div",{className:"btn-group btn-group-sm"},r.map((e=>{let[t,r]=e;return(0,n.tZ)("button",{key:JSON.stringify(t),type:"button",className:"btn btn-default "+(t===s?"active":""),onClick:()=>{a(t)}},r)}))))}}},53769:(e,t,r)=>{"use strict";r.d(t,{$c:()=>C,Pi:()=>A,QF:()=>f,RW:()=>v,UQ:()=>Z,Z8:()=>g,aG:()=>S,db:()=>y,iQ:()=>b,iR:()=>R,lC:()=>m,pO:()=>x,ql:()=>_,sH:()=>T,x$:()=>E,xM:()=>h});var n=r(67294),o=r(61988),a=r(95826),i=r(93185),s=r(38575),l=r(35622),c=r(65634),d=r(19835),u=r(83389),p=r(11965);const h={type:"DndColumnSelect",label:(0,o.t)("Dimensions"),multi:!0,freeForm:!0,clearable:!0,default:[],includeTime:!1,description:(0,o.t)("Dimensions contain qualitative values such as names, dates, or geographical data. Use dimensions to categorize, segment, and reveal the details in your data. Dimensions affect the level of detail in the view."),optionRenderer:e=>(0,p.tZ)(c.E,{showType:!0,column:e}),valueRenderer:e=>(0,p.tZ)(c.E,{column:e}),valueKey:"column_name",allowAll:!0,filterOption:(e,t)=>{var r,n;let{data:o}=e;return(null==(r=o.column_name)?void 0:r.toLowerCase().includes(t.toLowerCase()))||(null==(n=o.verbose_name)?void 0:n.toLowerCase().includes(t.toLowerCase()))||!1},promptTextCreator:e=>e,mapStateToProps(e,t){var r;const n={},{datasource:o}=e;if(null!=o&&null!=(r=o.columns[0])&&r.hasOwnProperty("groupby")){const e=o.columns.filter((e=>e.groupby));null!=t&&t.includeTime&&e.unshift(l.LU),n.options=e,n.savedMetrics=o.metrics||[]}else{const e=(null==o?void 0:o.columns)||[];null!=t&&t.includeTime&&e.unshift(l.CV),n.options=e}return n},commaChoosesOption:!1},m={...h,label:(0,o.t)("Columns"),description:(0,o.t)("Add dataset columns here to group the pivot table columns.")},g={...h,label:(0,o.t)("Dimension"),multi:!1,default:null,description:(0,o.t)("Defines the grouping of entities. Each series is represented by a specific color in the chart.")},f={...h,label:(0,o.t)("Entity"),default:null,multi:!1,validators:[a.Z],description:(0,o.t)("This defines the element to be plotted on the chart")},v={type:"DndFilterSelect",label:(0,o.t)("Filters"),default:[],description:"",mapStateToProps:e=>{let{datasource:t,form_data:r}=e;return{columns:(0,s.It)(t)?t.columns.filter((e=>e.filterable)):(null==t?void 0:t.columns)||[],savedMetrics:(0,d.R)(t),selectedMetrics:r.metrics||(r.metric?[r.metric]:[]),datasource:t}},provideFormDataToProps:!0,...u.sy},_={type:"DndMetricSelect",multi:!0,label:(0,o.t)("Metrics"),validators:[a.Z],mapStateToProps:e=>{let{datasource:t}=e;return{columns:(null==t?void 0:t.columns)||[],savedMetrics:(0,d.R)(t),datasource:t,datasourceType:null==t?void 0:t.type}},description:(0,o.t)("Select one or many metrics to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},b={..._,multi:!1,label:(0,o.t)("Metric"),description:(0,o.t)("Select a metric to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},y={...b,label:(0,o.t)("Right Axis Metric"),clearable:!0,description:(0,o.t)("Select a metric to display on the right axis")},E={type:"DndMetricSelect",label:(0,o.t)("Sort by"),default:null,description:(0,o.t)("This metric is used to define row selection criteria (how the rows are sorted) if a series or row limit is present. If not defined, it reverts to the first metric (where appropriate)."),mapStateToProps:e=>{let{datasource:t}=e;return{columns:(null==t?void 0:t.columns)||[],savedMetrics:(0,d.R)(t),datasource:t,datasourceType:null==t?void 0:t.type}}},T={...b,label:(0,o.t)("Bubble Size"),description:(0,o.t)("Metric used to calculate bubble size"),default:null},S={...b,label:(0,o.t)("X Axis"),description:(0,o.t)("The dataset column/metric that returns the values on your chart's x-axis."),default:null},C={...b,label:(0,o.t)("Y Axis"),description:(0,o.t)("The dataset column/metric that returns the values on your chart's y-axis."),default:null},R={...b,label:(0,o.t)("Color Metric"),default:null,validators:[],description:(0,o.t)("A metric to use for color")},Z={...g,...u.V7,label:l.m_.granularity_sqla,description:(0,o.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),default:e=>e.default,clearable:!1,canDelete:!1,ghostButtonText:(0,o.t)("Drop a temporal column here or click"),optionRenderer:e=>(0,p.tZ)(c.E,{showType:!0,column:e}),valueRenderer:e=>(0,p.tZ)(c.E,{column:e}),valueKey:"column_name"},A={...h,...u.P2};function x(e,t){return function(r){return(0,n.useMemo)((()=>(0,i.cr)(i.TT.ENABLE_EXPLORE_DRAG_AND_DROP)),[])?(0,p.tZ)(e,r):(0,p.tZ)(t,r)}}},83389:(e,t,r)=>{"use strict";r.d(t,{P2:()=>d,V7:()=>u,sy:()=>p});var n=r(61988),o=r(95826),a=r(11146),i=r(55786),s=r(5364),l=r(45211);const c=e=>"horizontal"===(null==e?void 0:e.orientation)?{label:(0,n.t)("Y-axis"),description:(0,n.t)("Dimension to use on y-axis.")}:{label:(0,n.t)("X-axis"),description:(0,n.t)("Dimension to use on x-axis.")},d={label:e=>c(null==e?void 0:e.form_data).label,multi:!1,description:e=>c(null==e?void 0:e.form_data).description,validators:[o.Z],initialValue:(e,t)=>{var r,n;if(a.O6&&null!=t&&null!=(r=t.form_data)&&r.granularity_sqla&&(null==(n=t.form_data)||!n.x_axis)&&(null==e||!e.value))return t.form_data.granularity_sqla},default:void 0},u={mapStateToProps:e=>{let{datasource:t}=e;const r=(0,l.X)(t);return{options:r.temporalColumns,default:r.defaultTemporalColumn,isTemporal:!0}}},p={initialValue:(e,t)=>{var r,n,o,c;if(!a.O6||null!=t&&null!=(r=t.controls)&&null!=(n=r.time_range)&&n.value||(0,i.Z)(e.value).findIndex((e=>"TEMPORAL_RANGE"===(null==e?void 0:e.operator)))>-1)return;if(null!=t&&null!=(o=t.form_data)&&o.granularity_sqla&&null!=t&&null!=(c=t.form_data)&&c.time_range)return[...(0,i.Z)(e.value),{clause:"WHERE",subject:t.form_data.granularity_sqla,operator:"TEMPORAL_RANGE",comparator:t.form_data.time_range,expressionType:"SIMPLE"}];const d=(null==t?void 0:t.datasource)&&(0,l.X)(t.datasource).defaultTemporalColumn;var u,p;return a.O6&&d?[...(0,i.Z)(e.value),{clause:"WHERE",subject:d,operator:"TEMPORAL_RANGE",comparator:(null==t||null==(u=t.common)||null==(p=u.conf)?void 0:p.DEFAULT_TIME_FILTER)||s.vM,expressionType:"SIMPLE"}]:void 0}}},39650:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>B});var n=r(41609),o=r.n(n),a=r(81545),i=r(45511),s=r(61988),l=r(37731),c=r(11146),d=r(72813),u=r(5364),p=r(75294),h=r(74029),m=r(62363),g=r(55786),f=r(6126),v=r(58842),_=r(35622),b=r(53769);const y=(0,a.Z)(),E=(0,i.Z)(),T=[5,10,25,50,100,500],S=document.getElementById("app"),{user:C}=JSON.parse((null==S?void 0:S.getAttribute("data-bootstrap"))||"{}"),R={type:"DatasourceControl",label:(0,s.t)("Datasource"),default:null,description:null,mapStateToProps:e=>{let{datasource:t,form_data:r}=e;return{datasource:t,form_data:r,user:C}}},Z={type:"VizTypeControl",label:(0,s.t)("Visualization Type"),default:"table",description:(0,s.t)("The type of visualization to display")},A={type:"ColorPickerControl",label:(0,s.t)("Fixed Color"),description:(0,s.t)("Use this to define a static color for all circles"),default:{r:0,g:122,b:135,a:1},renderTrigger:!0},x={type:"ColorSchemeControl",label:(0,s.t)("Linear Color Scheme"),choices:()=>E.values().map((e=>[e.id,e.label])),default:E.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>E.getMap(),isLinear:!0,mapStateToProps:e=>{var t;return{dashboardId:null==e||null==(t=e.form_data)?void 0:t.dashboardId}}},O={type:"SelectControl",freeForm:!0,label:_.m_.granularity,default:"one day",choices:[[null,(0,s.t)("all")],["PT5S",(0,s.t)("5 seconds")],["PT30S",(0,s.t)("30 seconds")],["PT1M",(0,s.t)("1 minute")],["PT5M",(0,s.t)("5 minutes")],["PT30M",(0,s.t)("30 minutes")],["PT1H",(0,s.t)("1 hour")],["PT6H",(0,s.t)("6 hour")],["P1D",(0,s.t)("1 day")],["P7D",(0,s.t)("7 days")],["P1W",(0,s.t)("week")],["week_starting_sunday",(0,s.t)("week starting Sunday")],["week_ending_saturday",(0,s.t)("week ending Saturday")],["P1M",(0,s.t)("month")],["P3M",(0,s.t)("quarter")],["P1Y",(0,s.t)("year")]],description:(0,s.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`, `1 day` or `56 weeks`")},w={type:"SelectControl",label:_.m_.time_grain_sqla,placeholder:(0,s.t)("None"),initialValue:(e,t)=>{var r,n;return(0,l.Z)(t)?null!=t&&t.metadata||"time_grain_sqla"in(null!=(r=null==t?void 0:t.form_data)?r:{})?null==t||null==(n=t.form_data)?void 0:n.time_grain_sqla:"P1D":e.value},description:(0,s.t)("Select a time grain for the visualization. The grain is the time interval represented by a single point on the chart."),mapStateToProps:e=>{let{datasource:t}=e;return{choices:(null==t?void 0:t.time_grain_sqla)||[]}},visibility:e=>{let{controls:t}=e;if(!c.O6)return!0;const r=null==t?void 0:t.x_axis,n=null==r?void 0:r.value;return!!(0,d.GA)(n)||!!(0,d.s9)(n)&&!(null==(o=(null!=(a=null==r?void 0:r.options)?a:[]).find((e=>(null==e?void 0:e.column_name)===n)))||!o.is_dttm);var o,a}},I={type:"DateFilterControl",freeForm:!0,label:_.m_.time_range,default:u.vM,description:(0,s.t)('This control filters the whole chart based on the selected time range. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},N={type:"SelectControl",freeForm:!0,label:(0,s.t)("Row limit"),clearable:!1,validators:[p.Z,(e,t)=>{var r,n;return(0,h.Z)(e,(null==t||null==(r=t.common)||null==(n=r.conf)?void 0:n.SQL_MAX_ROW)||_.$z)}],default:1e4,choices:(0,f.m)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,s.t)("Limits the number of the rows that are computed in the query that is the source of the data used for this chart.")},D={type:"CheckboxControl",label:(0,s.t)("Sort Descending"),default:!0,description:(0,s.t)("If enabled, this control sorts the results/values descending, otherwise it sorts the results ascending."),visibility:e=>{let{controls:t}=e;return Boolean((null==t?void 0:t.timeseries_limit_metric.value)&&!o()(null==t?void 0:t.timeseries_limit_metric.value))}},L={type:"SelectControl",freeForm:!0,label:(0,s.t)("Series limit"),placeholder:(0,s.t)("None"),validators:[p.Z],choices:(0,f.m)(T),clearable:!0,description:(0,s.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},M={type:"SelectControl",freeForm:!0,label:(0,s.t)("Series limit"),placeholder:(0,s.t)("None"),validators:[p.Z],choices:(0,f.m)(T),description:(0,s.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},k={type:"SelectControl",freeForm:!0,label:(0,s.t)("Y Axis Format"),renderTrigger:!0,default:v.Ul,choices:v.F6,description:v.YD,tokenSeparators:["\n","\t",";"],filterOption:(e,t)=>{let{data:r}=e;return r.label.includes(t)||r.value.includes(t)},mapStateToProps:e=>{var t,r;return{choices:(null==(t=e.controls)||null==(r=t.comparison_type)?void 0:r.value)===m.wj.Percentage?v.F6.filter((e=>e[0].includes("%"))):v.F6}}},P={type:"CurrencyControl",label:(0,s.t)("Currency format"),renderTrigger:!0},U={type:"SelectControl",freeForm:!0,label:(0,s.t)("Time format"),renderTrigger:!0,default:v._r,choices:v.HC,description:v.oq,filterOption:(e,t)=>{let{data:r}=e;return r.label.includes(t)||r.value.includes(t)}},$={type:"ColorSchemeControl",label:(0,s.t)("Color Scheme"),default:y.getDefaultKey(),renderTrigger:!0,choices:()=>y.keys().map((e=>[e,e])),description:(0,s.t)("The color scheme for rendering chart"),schemes:()=>y.getMap(),mapStateToProps:e=>{var t;return{dashboardId:null==e||null==(t=e.form_data)?void 0:t.dashboardId}}},F={type:"CheckboxControl",label:(0,s.t)("Truncate Metric"),default:!0,description:(0,s.t)("Whether to truncate metrics")},q={type:"CheckboxControl",label:(0,s.t)("Show empty columns"),default:!0,description:(0,s.t)("Show empty columns")},V={type:"HiddenControl",initialValue:(e,t)=>{var r;return Object.fromEntries((0,g.Z)(null==t||null==(r=t.datasource)?void 0:r.columns).filter((e=>e.is_dttm)).map((e=>{var t;return[null!=(t=e.column_name)?t:e.name,e.is_dttm]})))}},B={metrics:b.ql,metric:b.iQ,datasource:R,viz_type:Z,color_picker:A,metric_2:b.db,linear_color_scheme:x,secondary_metric:b.iR,groupby:b.xM,columns:b.lC,granularity:O,granularity_sqla:b.UQ,time_grain_sqla:w,time_range:I,row_limit:N,limit:L,timeseries_limit_metric:b.x$,orderby:b.x$,order_desc:D,series:b.Z8,entity:b.QF,x:b.aG,y:b.$c,size:b.sH,y_axis_format:k,x_axis_time_format:U,adhoc_filters:b.RW,color_scheme:$,series_columns:b.lC,series_limit:M,series_limit_metric:b.x$,legacy_order_by:b.x$,truncate_metric:F,x_axis:b.Pi,show_empty_columns:q,temporal_columns_lookup:V,currency_format:P}},38575:(e,t,r)=>{"use strict";r.d(t,{D_:()=>l,Id:()=>u,It:()=>c,JQ:()=>d,O9:()=>o,pp:()=>n,vD:()=>a,xN:()=>i,zy:()=>s});const n=e=>{var t,r;return(null==e||null==(t=e.standardizedFormData)?void 0:t.controls)&&(null==e||null==(r=e.standardizedFormData)?void 0:r.memorizedFormData)&&Array.isArray(e.standardizedFormData.controls.metrics)&&Array.isArray(e.standardizedFormData.controls.columns)};var o;!function(e){e.NONE="None",e.GREATER_THAN=">",e.LESS_THAN="<",e.GREATER_OR_EQUAL="",e.LESS_OR_EQUAL="",e.EQUAL="=",e.NOT_EQUAL="",e.BETWEEN="< x <",e.BETWEEN_OR_EQUAL=" x ",e.BETWEEN_OR_LEFT_EQUAL=" x <",e.BETWEEN_OR_RIGHT_EQUAL="< x "}(o||(o={}));const a=[o.BETWEEN,o.BETWEEN_OR_EQUAL,o.BETWEEN_OR_LEFT_EQUAL,o.BETWEEN_OR_RIGHT_EQUAL];function i(e){return!!e&&"column_name"in e}function s(e){return"column_name"in e&&"expression"in e&&!!e.expression}function l(e){return null!==e}function c(e){return!!e&&"columns"in e&&!("sqlEditorId"in e)}function d(e){return!!e&&"results"in e&&"sqlEditorId"in e}var u;!function(e){e.Name="name",e.Max="max",e.Min="min",e.Sum="sum",e.Avg="avg"}(u||(u={}))},58842:(e,t,r)=>{"use strict";r.d(t,{F6:()=>u,HC:()=>h,Ul:()=>m,YD:()=>s,_r:()=>g,oq:()=>p,pj:()=>l,u6:()=>c});var n=r(61988),o=r(67190),a=r(45636),i=r(78900);const s=(0,n.t)("D3 format syntax: https://github.com/d3/d3-format"),l=(0,n.t)('Only applies when "Label Type" is set to show values.'),c=(0,n.t)('Only applies when "Label Type" is not set to a percentage.'),d=[",d",".1s",".3s",",.1%",".2%",".3%",".4r",",.1f",",.2f",",.3f","+,","$,.2f"].map((e=>[e,`${e} (${(0,o.JB)(e).preview()})`])),u=[[a.default.SMART_NUMBER,(0,n.t)("Adaptive formatting")],["~g",(0,n.t)("Original value")],...d,["DURATION",(0,n.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,n.t)("Duration in ms (1.40008 => 1ms 400s 80ns)")]],p=(0,n.t)("D3 time format syntax: https://github.com/d3/d3-time-format"),h=[[i.Z.id,(0,n.t)("Adaptive formatting")],["%d/%m/%Y","%d/%m/%Y | 14/01/2019"],["%m/%d/%Y","%m/%d/%Y | 01/14/2019"],["%Y-%m-%d","%Y-%m-%d | 2019-01-14"],["%Y-%m-%d %H:%M:%S","%Y-%m-%d %H:%M:%S | 2019-01-14 01:32:10"],["%d-%m-%Y %H:%M:%S","%d-%m-%Y %H:%M:%S | 14-01-2019 01:32:10"],["%H:%M:%S","%H:%M:%S | 01:32:10"]],m=u[0][0],g=h[0][0]},19835:(e,t,r)=>{"use strict";r.d(t,{R:()=>o});var n=r(46078);const o=e=>null!=e&&e.hasOwnProperty("metrics")?(null==e?void 0:e.metrics)||[]:n.BH},89368:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,q:()=>s});var n=r(67294),o=r(93362),a=r(39650);function i(e){return"string"==typeof e&&e in o.default?o.default[e]:e}function s(e,t){if(void 0===t&&(t={}),"string"==typeof e&&e in a.ZP){const r=e;return{name:r,config:{...a.ZP[r],...t[r]}}}if(!e||"string"==typeof e||n.isValidElement(e))return e;if("name"in e&&"config"in e)return{...e,config:{...e.config,type:i(e.config.type)}};if("override"in e&&e.name in a.ZP){const{name:t,override:r}=e;return{name:t,config:{...a.ZP[t],...r}}}return null}},20002:(e,t,r)=>{"use strict";r.d(t,{u:()=>a});var n=r(1875),o=r(38575);const a=(0,n.Z)(class{constructor(){this.controls=void 0,this.controls={metrics:[],columns:[]}}setStandardizedControls(e){if((0,o.pp)(e)){const{controls:t}=e.standardizedFormData;this.controls={metrics:t.metrics,columns:t.columns}}}shiftMetric(){return this.controls.metrics.shift()}shiftColumn(){return this.controls.columns.shift()}popAllMetrics(){return this.controls.metrics.splice(0,this.controls.metrics.length)}popAllColumns(){return this.controls.columns.splice(0,this.controls.columns.length)}clear(){this.controls={metrics:[],columns:[]}}})},45211:(e,t,r)=>{"use strict";r.d(t,{X:()=>i,x:()=>s});var n=r(55786),o=r(37731),a=r(38575);function i(e){const t={temporalColumns:[],defaultTemporalColumn:void 0};var r,i,s;return(0,a.It)(e)&&(t.temporalColumns=(0,n.Z)(e.columns).filter((e=>e.is_dttm))),(0,a.JQ)(e)&&(t.temporalColumns=(0,n.Z)(e.columns).filter((e=>e.is_dttm))),(0,a.It)(e)&&(t.defaultTemporalColumn=e.main_dttm_col),(0,o.Z)(t.defaultTemporalColumn)||(t.defaultTemporalColumn=null!=(r=null==(i=t.temporalColumns[0])?void 0:i.column_name)?r:null==(s=t.temporalColumns[0])?void 0:s.name),t}function s(e,t){const r=i(t).temporalColumns;for(let t=0;t<r.length;t+=1)if(r[t].column_name===e)return!0;return!1}},6126:(e,t,r)=>{"use strict";function n(e){return e.map((e=>Array.isArray(e)?e:[e,e.toString()]))}function o(e,t){const r=[];for(let n=e;n<=t;n+=1)r.push([n,n.toString()]);return r}r.d(t,{B:()=>o,m:()=>n})},19427:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(90537),o=r(1875);class a extends n.Z{constructor(){super({name:"ChartBuildQuery",overwritePolicy:n.r.WARN})}}const i=(0,o.Z)(a)},37687:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(90537),o=r(1875);class a extends n.Z{constructor(){super({name:"ChartControlPanel"})}}const i=(0,o.Z)(a)},11064:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(90537),o=r(1875);class a extends n.Z{constructor(){super({name:"ChartMetadata",overwritePolicy:n.r.WARN})}}const i=(0,o.Z)(a)},16355:(e,t,r)=>{"use strict";var n,o,a;r.d(t,{Df:()=>a,Tr:()=>o,ZP:()=>c,cg:()=>n,eH:()=>s,t$:()=>i,we:()=>l}),function(e){e.INTERACTIVE_CHART="INTERACTIVE_CHART",e.NATIVE_FILTER="NATIVE_FILTER",e.DRILL_TO_DETAIL="DRILL_TO_DETAIL",e.DRILL_BY="DRILL_BY"}(n||(n={})),function(e){e.EXPLORE="EXPLORE",e.DASHBOARD="DASHBOARD",e.FILTER_BAR="FILTER_BAR",e.FILTER_CONFIG_MODAL="FILTER_CONFIG_MODAL",e.EMBEDDED="EMBEDDED"}(o||(o={})),function(e){e.DEPRECATED="DEPRECATED",e.FEATURED="FEATURED"}(a||(a={}));const i={[a.DEPRECATED]:"This chart uses features or modules which are no longer actively maintained. It will eventually be replaced or removed.",[a.FEATURED]:"This chart was tested and verified, so the overall experience should be stable."},s={[a.DEPRECATED]:{weight:-.1},[a.FEATURED]:{weight:.1}};var l;!function(e){e.category="category",e.value="value",e.time="time",e.log="log"}(l||(l={}));const c={}},28062:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEFAULT_NAMESPACE:()=>l,default:()=>i,getColor:()=>d,getNamespace:()=>c,getScale:()=>u});var n=r(97466),o=r(81545),a=r(86041);class i{constructor(e){this.name=void 0,this.forcedItems=void 0,this.scales=void 0,this.name=e,this.scales={},this.forcedItems={}}getScale(e){var t,r;const a=null!=(t=null!=e?e:(0,o.Z)().getDefaultKey())?t:"",i=(0,o.Z)().get(a);return new n.Z(null!=(r=null==i?void 0:i.colors)?r:[],this.forcedItems)}setColor(e,t){return this.forcedItems[(0,a.Z)(e)]=t,this}resetColors(){this.forcedItems={}}}const s={},l="GLOBAL";function c(e){void 0===e&&(e=l);const t=s[e];if(t)return t;const r=new i(e);return s[e]=r,r}function d(e,t,r){return c(r).getScale(t).getColor(e)}function u(e,t){return c(t).getScale(e)}},97466:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(99481),o=r(54732),a=r(86041),i=r(78161),s=r(25130),l=r(93185);class c extends o.Z{constructor(e,t){void 0===t&&(t={}),super(((e,t)=>this.getColor(e,t))),this.originColors=void 0,this.colors=void 0,this.scale=void 0,this.parentForcedColors=void 0,this.forcedColors=void 0,this.multiple=void 0,this.originColors=e,this.colors=e,this.scale=(0,n.Z)(),this.scale.range(e),Object.entries(t).forEach((r=>{let[n,o]=r;"number"==typeof o&&(t[n]=e[o%e.length])})),this.parentForcedColors=t,this.forcedColors={},this.multiple=0}removeSharedLabelColorFromRange(e,t){const r=new Set(this.originColors);e.forEach(((e,n)=>{n!==t&&r.delete(e)})),Object.entries(this.parentForcedColors).forEach((e=>{let[n,o]=e;n!==t&&r.delete(o)})),this.range(r.size>0?[...r]:this.originColors)}getColor(e,t){var r,n;const o=(0,a.Z)(e),c=(0,i.ZP)(),d=c.getColorMap(),u=d.get(o);let p=(null==(r=this.parentForcedColors)?void 0:r[o])||(null==(n=this.forcedColors)?void 0:n[o])||u;if((0,l.cr)(l.TT.USE_ANALAGOUS_COLORS)){const e=Math.floor(this.domain().length/this.originColors.length);if(e>this.multiple){this.multiple=e;const t=(0,s.Gh)(this.originColors,e);this.range(this.originColors.concat(t))}}const h=this.scale(o);return p||(p=h,(0,l.cr)(l.TT.AVOID_COLORS_COLLISION)&&(this.removeSharedLabelColorFromRange(d,o),p=this.scale(o))),c.addSlice(o,p,t),p}setColor(e,t){return this.forcedColors[(0,a.Z)(e)]=t,this}getColorMap(){const e={};return this.scale.domain().forEach((t=>{e[t.toString()]=this.scale(t)})),{...e,...this.forcedColors,...this.parentForcedColors}}copy(){const e=new c(this.scale.range(),this.parentForcedColors);return e.forcedColors={...this.forcedColors},e.domain(this.domain()),e.unknown(this.unknown()),e}domain(e){return void 0===e?this.scale.domain():(this.scale.domain(e),this)}range(e){return void 0===e?this.scale.range():(this.colors=e,this.scale.range(e),this)}unknown(e){return void 0===e?this.scale.unknown():(this.scale.unknown(e),this)}}const d=c},78161:(e,t,r)=>{"use strict";r.d(t,{Ag:()=>n,Xs:()=>i,ZP:()=>s});var n,o=r(28062),a=r(1875);!function(e){e[e.dashboard=0]="dashboard",e[e.explore=1]="explore"}(n||(n={}));class i{constructor(){this.sliceLabelMap=void 0,this.colorMap=void 0,this.source=void 0,this.sliceLabelMap=new Map,this.colorMap=new Map,this.source=n.dashboard}updateColorMap(e,t){const r=o.getNamespace(e),n=new Map;this.colorMap.clear(),this.sliceLabelMap.forEach((e=>{const o=r.getScale(t);e.forEach((e=>{const t=o(e);n.set(e,t)}))})),this.colorMap=n}getColorMap(){return this.colorMap}addSlice(e,t,r){if(this.source!==n.dashboard||void 0===r)return;const o=this.sliceLabelMap.get(r)||[];o.includes(e)||(o.push(e),this.sliceLabelMap.set(r,o)),this.colorMap.set(e,t)}removeSlice(e){if(this.source!==n.dashboard)return;this.sliceLabelMap.delete(e);const t=new Map;this.sliceLabelMap.forEach((e=>{e.forEach((e=>{t.set(e,this.colorMap.get(e))}))})),this.colorMap=t}reset(){new Map(this.colorMap).forEach(((e,t)=>{this.colorMap.set(t,"")}))}clear(){this.sliceLabelMap.clear(),this.colorMap.clear()}}const s=(0,a.Z)(i)},86041:(e,t,r)=>{"use strict";function n(e){return String(e).trim()}r.d(t,{Z:()=>n})},25130:(e,t,r)=>{"use strict";r.d(t,{Gh:()=>s,Qg:()=>i,Zf:()=>l,oo:()=>c,vq:()=>d});var n=r(17621),o=r.n(n);const a=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/;function i(e,t){void 0===t&&(t=186);let r=0,n=0,o=0;if(e.length>7){const t=a.exec(e);if(!t)throw new Error(`Invalid color: ${e}`);r=parseInt(t[1],10),n=parseInt(t[2],10),o=parseInt(t[3],10)}else{let t=e;if(t.startsWith("#")&&(t=t.substring(1)),3===t.length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]].join("")),6!==t.length)throw new Error(`Invalid color: ${e}`);r=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16)}return.299*r+.587*n+.114*o>t?"#000":"#FFF"}function s(e,t){const r=[],n=e.map((e=>o()(e).analogous(t+3).slice(3)));for(;null!=(a=n[n.length-1])&&a.length;){var a;n.forEach((e=>{const t=e.shift();r.push(t.toHexString())}))}return r}function l(e,t){if(t>1||t<0)throw new Error(`The opacity should between 0 and 1, but got: ${t}`);return`${e}${`0${Math.round(255*t).toString(16).toUpperCase()}`.slice(-2)}`}function c(e){let t="0",r="0",n="0";return 4===e.length?(t=`0x${e[1]}${e[1]}`,r=`0x${e[2]}${e[2]}`,n=`0x${e[3]}${e[3]}`):7===e.length&&(t=`0x${e[1]}${e[2]}`,r=`0x${e[3]}${e[4]}`,n=`0x${e[5]}${e[6]}`),`rgb(${+t}, ${+r}, ${+n})`}function d(e,t,r){let n=e.toString(16),o=t.toString(16),a=r.toString(16);return 1===n.length&&(n=`0${n}`),1===o.length&&(o=`0${o}`),1===a.length&&(a=`0${a}`),`#${n}${o}${a}`}},78186:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(1469),o=r.n(n),a=r(30236),i=r.n(a),s=r(67294),l=r(46478),c=r(82781),d=r(61608),u=r(34775),p=r(27495),h=r(93185),m=r(11965);const g=function(e){let{source:t,htmlSanitization:r=!0,htmlSchemaOverrides:n={}}=e;const a=(0,h.cr)(h.TT.ESCAPE_MARKDOWN_HTML),g=(0,s.useMemo)((()=>{const e=[];if(!a&&(e.push(u.Z),r)){const t=function(e,t){return i()(e,t,((e,t)=>o()(e)?e.concat(t):void 0))}(c.R,n);e.push([d.Z,t])}return e}),[a,r,n]);return(0,m.tZ)(l.D,{rehypePlugins:g,remarkPlugins:[p.Z],skipHtml:!1,transformLinkUri:null},t)}},68122:(e,t,r)=>{"use strict";r.d(t,{M:()=>o,o:()=>n});const n=250,o=500},37208:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l,j:()=>i});var n=r(54732),o=r(45636),a=r(67190);const i=e=>{var t;return null==(t=new Intl.NumberFormat("en-US",{style:"currency",currency:e.symbol}).formatToParts(1).find((e=>"currency"===e.type)))?void 0:t.value};class s extends n.Z{constructor(e){super((e=>this.format(e))),this.d3Format=void 0,this.locale=void 0,this.currency=void 0,this.d3Format=e.d3Format||o.default.SMART_NUMBER,this.currency=e.currency,this.locale=e.locale||"en-US"}hasValidCurrency(){var e;return Boolean(null==(e=this.currency)?void 0:e.symbol)}getNormalizedD3Format(){return this.d3Format.replace(/\$|%/g,"")}format(e){const t=(0,a.JB)(this.getNormalizedD3Format())(e);return this.hasValidCurrency()?"prefix"===this.currency.symbolPosition?`${i(this.currency)} ${t}`:`${t} ${i(this.currency)}`:t}}const l=s},81847:(e,t,r)=>{"use strict";r.d(t,{YW:()=>i,mc:()=>s,vO:()=>a});const n={},o=e=>`__superset__/${e}`;async function a(e,t){const r=o(e);if(!window[r]&&!n[e]){const o=t();n[e]=o,window[r]=await o}return n[e]}async function i(e){return Promise.all(Object.entries(e).map((e=>{let[t,r]=e;return a(t,r)})))}function s(){Object.keys(n).forEach((e=>{delete window[o(e)],delete n[e]}))}},85716:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});var n=r(67294);function o(e,t){const r=(0,n.useRef)(t);return(0,n.useEffect)((()=>{r.current=e}),[e]),r.current}},3297:(e,t,r)=>{"use strict";r.d(t,{B:()=>o,Z:()=>a});var n=r(67294);const o={name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"},a=()=>{const[e,t]=(0,n.useState)(!0),r=(0,n.useRef)(null),[o,a]=(0,n.useState)(0),[i,s]=(0,n.useState)(0);return(0,n.useEffect)((()=>{var e,t,n,o;a(null!=(e=null==(t=r.current)?void 0:t.offsetWidth)?e:0),s(null!=(n=null==(o=r.current)?void 0:o.scrollWidth)?n:0)})),(0,n.useEffect)((()=>{t(o<i)}),[o,i]),[r,e]}},53652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=class{constructor(e){this.name="TypedRegistry",this.records=void 0,this.records=e}get(e){return this.records[e]}set(e,t){this.records[e]=t}}},67706:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(46078);class o{constructor(e){this.id=void 0,this.type=void 0;const[t,r]=e.split("__");this.id=parseInt(t,10),this.type=n.i9.Table,this.type="query"===r?n.i9.Query:this.type}toString(){return`${this.id}__${this.type}`}toObject(){return{id:this.id,type:this.type}}}},61654:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(65946),o=r(67706),a=r(78444),i=r(11146);const s=e=>[e];function l(e,t){const{queryFields:r,buildQuery:l=s}="function"==typeof t?{buildQuery:t,queryFields:{}}:t||{};let c=l((0,n.Z)(e,r));return c.forEach((e=>{Array.isArray(e.post_processing)&&(e.post_processing=e.post_processing.filter(Boolean))})),(0,i.SR)(e)&&(c=c.map((t=>(0,a.T)(e,t)))),{datasource:new o.Z(e.datasource).toObject(),force:e.force||!1,queries:c,form_data:e,result_format:e.result_format||"json",result_type:e.result_type||"full"}}},65946:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(62446),o=r(46306),a=r(78483);function i(e){let t=e;return e.includes("--")&&(t=`${e}\n`),`(${t})`}var s=r(69363),l=r(5364),c=r(37731);function d(e,t){var r,d;const{annotation_layers:u=[],extra_form_data:p,time_range:h,since:m,until:g,row_limit:f,row_offset:v,order_desc:_,limit:b,timeseries_limit_metric:y,granularity:E,url_params:T={},custom_params:S={},series_columns:C,series_limit:R,series_limit_metric:Z,...A}=e,{adhoc_filters:x=[],filters:O=[],custom_form_data:w={},...I}=p||{},N=Number(f),D=Number(v),{metrics:L,columns:M,orderby:k}=(0,s.Z)(A,t),P=function(e){const t={},r=[],n={},o={filters:r,extras:n,applied_time_extras:t},a={__time_range:"time_range",__time_col:"granularity_sqla",__time_grain:"time_grain_sqla",__granularity:"granularity"};return(e.extra_filters||[]).forEach((e=>{if(e.col in a){const r=e.col;o[a[r]]=e.val,t[r]=e.val}else r.push(e)})),n.time_grain_sqla=o.time_grain_sqla||e.time_grain_sqla,o.granularity=o.granularity_sqla||e.granularity||e.granularity_sqla,delete o.granularity_sqla,delete o.time_grain_sqla,o}(e),{filters:U}=P,$={filters:[...U,...O],adhoc_filters:[...e.adhoc_filters||[],...x]},F=function(e){const{adhoc_filters:t,extras:r={},filters:n=[],where:s}=e,l=n,c=[];s&&c.push(s);const d=[];return(t||[]).forEach((e=>{const{clause:t}=e;if((0,o.Ki)(e)){const r=(0,a.Z)(e);"WHERE"===t&&l.push(r)}else{const{sqlExpression:r}=e;"WHERE"===t?c.push(r):d.push(r)}})),r.having=d.map(i).join(" AND "),r.where=c.map(i).join(" AND "),{filters:l,extras:r}}({...e,...P,...$});let q={time_range:h||void 0,since:m||void 0,until:g||void 0,granularity:E||void 0,...P,...F,columns:M,metrics:L,orderby:k,annotation_layers:u,row_limit:null==f||Number.isNaN(N)?void 0:N,row_offset:null==v||Number.isNaN(D)?void 0:D,series_columns:C,series_limit:null!=R?R:(0,c.Z)(b)?Number(b):0,series_limit_metric:null!=(r=null!=(d=(e=>{if((0,n.I0)(e))return e})(Z))?d:y)?r:void 0,order_desc:void 0===_||_,url_params:T||void 0,custom_params:S};return q=function(e,t){const r={...e},{extras:n={}}=r;return Object.entries(l.gn).forEach((e=>{let[n,o]=e;const a=t[n];void 0!==a&&(r[o]=a)})),l.fn.forEach((e=>{e in t&&(n[e]=t[e])})),Object.keys(n).length>0&&(r.extras=n),r}(q,I),{...q,custom_form_data:w}}},5364:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,Ci:()=>i,NU:()=>l,W3:()=>n,fn:()=>a,gn:()=>s,vM:()=>o});const n="__timestamp",o="No filter",a=["relative_start","relative_end","time_grain_sqla"],i=["adhoc_filters","filters","interactive_groupby","interactive_highlight","interactive_drilldown","custom_form_data"],s={granularity:"granularity",granularity_sqla:"granularity",time_column:"time_column",time_grain:"time_grain",time_range:"time_range"},l=Object.keys(s),c=[...l,...a]},78483:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(46306);function o(e){const{subject:t}=e;if((0,n._l)(e)){const{operator:r}=e;return{col:t,op:r}}if((0,n.kC)(e)){const{operator:r}=e;return{col:t,op:r,val:e.comparator}}const{operator:r}=e;return{col:t,op:r,val:e.comparator}}},69363:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(61988),o=r(74765),a=r(5364),i=r(10581),s=r(56652),l=r(20620),c=r(11146);function d(e,t){const r={metric:"metrics",metric_2:"metrics",secondary_metric:"metrics",x:"metrics",y:"metrics",size:"metrics",all_columns:"columns",series:"groupby",order_by_cols:"orderby",...t},{query_mode:d,include_time:u,...p}=e;let h=[],m=[],g=[];return Object.entries(p).forEach((e=>{let[t,n]=e;if(null==n)return;let o=r[t]||t;d===l.n.aggregate&&"columns"===o||(d!==l.n.raw||"groupby"!==o&&"metrics"!==o)&&("groupby"===o&&(o="columns"),"metrics"===o?m=m.concat(n):"columns"===o?h=h.concat(n):"orderby"===o&&(g=g.concat(n)))})),c.O6||!u||h.includes(a.W3)||h.unshift(a.W3),{columns:(0,o.Z)(h.filter((e=>""!==e)),i.Z),metrics:d===l.n.raw?void 0:(0,o.Z)(m,s.Z),orderby:g.length>0?g.map((e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){throw new Error((0,n.t)("Found invalid orderby options"))}return e})):void 0}}},10581:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(72813);function o(e){return(0,n.s9)(e)?e:null!=e&&e.label?e.label:null==e?void 0:e.sqlExpression}},56652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(62446);function o(e){return(0,n.AG)(e)?e:e.label?e.label:(0,n.nX)(e)?`${e.aggregate}(${e.column.columnName||e.column.column_name})`:e.sqlExpression}},11146:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>c,M8:()=>d,O6:()=>l,SR:()=>s});var n=r(72813),o=r(93185),a=r(5364),i=r(10581);const s=e=>(0,n.Gk)(e.x_axis),l=(0,o.cr)(o.TT.GENERIC_CHART_AXES),c=e=>{if(e.granularity_sqla||e.x_axis)return s(e)?e.x_axis:a.W3},d=e=>{const t=c(e);if(t)return(0,i.Z)(t)}},78444:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var n=r(57557),o=r.n(n),a=r(72813),i=r(11146);function s(e,t){if(!(0,i.SR)(e))return t;const{columns:r,extras:n}=t,s=[...r||[]],l=null==r?void 0:r.findIndex((t=>(0,a.s9)(t)&&(0,a.s9)(e.x_axis)&&t===e.x_axis||(0,a.GA)(t)&&(0,a.GA)(e.x_axis)&&t.sqlExpression===e.x_axis.sqlExpression));if(void 0!==l&&l>-1&&e.x_axis&&Array.isArray(r)){(0,a.GA)(r[l])?s[l]={timeGrain:null==n?void 0:n.time_grain_sqla,columnType:"BASE_AXIS",...r[l]}:s[l]={timeGrain:null==n?void 0:n.time_grain_sqla,columnType:"BASE_AXIS",sqlExpression:e.x_axis,label:e.x_axis,expressionType:"SQL"};const i=o()(t,["is_timeseries"]);return i.columns=s,i}return t}},62363:(e,t,r)=>{"use strict";var n,o;r.d(t,{ZP:()=>a,su:()=>n,wj:()=>o}),function(e){e.Mean="mean",e.Sum="sum",e.Std="std",e.Cumsum="cumsum"}(n||(n={})),function(e){e.Values="values",e.Difference="difference",e.Percentage="percentage",e.Ratio="ratio"}(o||(o={}));const a={}},72813:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e}function o(e){return"string"!=typeof e&&void 0!==(null==e?void 0:e.sqlExpression)&&void 0!==(null==e?void 0:e.label)&&(void 0===(null==e?void 0:e.expressionType)||"SQL"===(null==e?void 0:e.expressionType))}function a(e){return n(e)||o(e)}r.d(t,{GA:()=>o,Gk:()=>a,ZP:()=>i,s9:()=>n});const i={}},10916:(e,t,r)=>{"use strict";var n,o;function a(e){return e.type===n.NATIVE_FILTER}function i(e){var t,r;return a(e)&&(null==(t=e.dataMask)||null==(r=t.filterState)?void 0:r.value)}function s(e){return e.type===n.DIVIDER}r.d(t,{BE:()=>n,S0:()=>i,ZP:()=>l,gT:()=>o,kI:()=>a,nY:()=>s}),function(e){e.NATIVE_FILTER="NATIVE_FILTER",e.DIVIDER="DIVIDER"}(n||(n={})),function(e){e.NativeFilters="nativeFilters",e.CrossFilters="crossFilters"}(o||(o={}));const l={}},46078:(e,t,r)=>{"use strict";var n;r.d(t,{BH:()=>o,ZP:()=>a,i9:()=>n}),function(e){e.Table="table",e.Query="query",e.Dataset="dataset",e.SlTable="sl_table",e.SavedQuery="saved_query"}(n||(n={}));const o=[{metric_name:"COUNT(*)",expression:"COUNT(*)"}],a={}},46306:(e,t,r)=>{"use strict";r.d(t,{Ki:()=>o,VK:()=>l,_l:()=>i,jz:()=>a,kC:()=>s});var n=r(31612);function o(e){return"SIMPLE"===e.expressionType}function a(e){return"SQL"===e.expressionType}function i(e){return(0,n.CW)(e.operator)}function s(e){return(0,n.VU)(e.operator)}function l(e){return(0,n.XA)(e.operator)}},62446:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e}function o(e){return"string"!=typeof e&&"SIMPLE"===(null==e?void 0:e.expressionType)}function a(e){return"string"!=typeof e&&"SQL"===(null==e?void 0:e.expressionType)}function i(e){return n(e)||o(e)||a(e)}r.d(t,{AG:()=>n,I0:()=>i,ZP:()=>s,nX:()=>o,q5:()=>a});const s={}},31612:(e,t,r)=>{"use strict";r.d(t,{CW:()=>o,VU:()=>i,XA:()=>l});const n=new Set(["IS NOT NULL","IS NULL"]);function o(e){return n.has(e)}const a=new Set(["==","!=",">","<",">=","<=","ILIKE","LIKE","REGEX","TEMPORAL_RANGE"]);function i(e){return a.has(e)}const s=new Set(["IN","NOT IN"]);function l(e){return s.has(e)}},43716:(e,t,r)=>{"use strict";r.d(t,{C5:()=>a,Qn:()=>d,Tb:()=>s,WN:()=>i,YC:()=>h,ZP:()=>m,eh:()=>u,pY:()=>p,sn:()=>l,yv:()=>c});var n=r(46078),o=r(88889);const a={FRONTEND_CSRF_ERROR:"FRONTEND_CSRF_ERROR",FRONTEND_NETWORK_ERROR:"FRONTEND_NETWORK_ERROR",FRONTEND_TIMEOUT_ERROR:"FRONTEND_TIMEOUT_ERROR",GENERIC_DB_ENGINE_ERROR:"GENERIC_DB_ENGINE_ERROR",COLUMN_DOES_NOT_EXIST_ERROR:"COLUMN_DOES_NOT_EXIST_ERROR",TABLE_DOES_NOT_EXIST_ERROR:"TABLE_DOES_NOT_EXIST_ERROR",SCHEMA_DOES_NOT_EXIST_ERROR:"SCHEMA_DOES_NOT_EXIST_ERROR",CONNECTION_INVALID_USERNAME_ERROR:"CONNECTION_INVALID_USERNAME_ERROR",CONNECTION_INVALID_PASSWORD_ERROR:"CONNECTION_INVALID_PASSWORD_ERROR",CONNECTION_INVALID_HOSTNAME_ERROR:"CONNECTION_INVALID_HOSTNAME_ERROR",CONNECTION_PORT_CLOSED_ERROR:"CONNECTION_PORT_CLOSED_ERROR",CONNECTION_INVALID_PORT_ERROR:"CONNECTION_INVALID_PORT_ERROR",CONNECTION_HOST_DOWN_ERROR:"CONNECTION_HOST_DOWN_ERROR",CONNECTION_ACCESS_DENIED_ERROR:"CONNECTION_ACCESS_DENIED_ERROR",CONNECTION_UNKNOWN_DATABASE_ERROR:"CONNECTION_UNKNOWN_DATABASE_ERROR",CONNECTION_DATABASE_PERMISSIONS_ERROR:"CONNECTION_DATABASE_PERMISSIONS_ERROR",CONNECTION_MISSING_PARAMETERS_ERRORS:"CONNECTION_MISSING_PARAMETERS_ERRORS",OBJECT_DOES_NOT_EXIST_ERROR:"OBJECT_DOES_NOT_EXIST_ERROR",SYNTAX_ERROR:"SYNTAX_ERROR",VIZ_GET_DF_ERROR:"VIZ_GET_DF_ERROR",UNKNOWN_DATASOURCE_TYPE_ERROR:"UNKNOWN_DATASOURCE_TYPE_ERROR",FAILED_FETCHING_DATASOURCE_INFO_ERROR:"FAILED_FETCHING_DATASOURCE_INFO_ERROR",TABLE_SECURITY_ACCESS_ERROR:"TABLE_SECURITY_ACCESS_ERROR",DATASOURCE_SECURITY_ACCESS_ERROR:"DATASOURCE_SECURITY_ACCESS_ERROR",DATABASE_SECURITY_ACCESS_ERROR:"DATABASE_SECURITY_ACCESS_ERROR",QUERY_SECURITY_ACCESS_ERROR:"QUERY_SECURITY_ACCESS_ERROR",MISSING_OWNERSHIP_ERROR:"MISSING_OWNERSHIP_ERROR",BACKEND_TIMEOUT_ERROR:"BACKEND_TIMEOUT_ERROR",DATABASE_NOT_FOUND_ERROR:"DATABASE_NOT_FOUND_ERROR",MISSING_TEMPLATE_PARAMS_ERROR:"MISSING_TEMPLATE_PARAMS_ERROR",INVALID_TEMPLATE_PARAMS_ERROR:"INVALID_TEMPLATE_PARAMS_ERROR",RESULTS_BACKEND_NOT_CONFIGURED_ERROR:"RESULTS_BACKEND_NOT_CONFIGURED_ERROR",DML_NOT_ALLOWED_ERROR:"DML_NOT_ALLOWED_ERROR",INVALID_CTAS_QUERY_ERROR:"INVALID_CTAS_QUERY_ERROR",INVALID_CVAS_QUERY_ERROR:"INVALID_CVAS_QUERY_ERROR",SQLLAB_TIMEOUT_ERROR:"SQLLAB_TIMEOUT_ERROR",RESULTS_BACKEND_ERROR:"RESULTS_BACKEND_ERROR",ASYNC_WORKERS_ERROR:"ASYNC_WORKERS_ERROR",GENERIC_COMMAND_ERROR:"GENERIC_COMMAND_ERROR",GENERIC_BACKEND_ERROR:"GENERIC_BACKEND_ERROR",INVALID_PAYLOAD_FORMAT_ERROR:"INVALID_PAYLOAD_FORMAT_ERROR",INVALID_PAYLOAD_SCHEMA_ERROR:"INVALID_PAYLOAD_SCHEMA_ERROR"},i={TABLE:"TABLE",VIEW:"VIEW"};var s;!function(e){e.STARTED="started",e.STOPPED="stopped",e.FAILED="failed",e.PENDING="pending",e.RUNNING="running",e.SCHEDULED="scheduled",e.SUCCESS="success",e.FETCHING="fetching",e.TIMED_OUT="timed_out"}(s||(s={}));const l=[s.RUNNING,s.STARTED,s.PENDING,s.FETCHING,s.SCHEDULED],c=[s.STOPPED,s.FAILED,s.SUCCESS,s.TIMED_OUT],d={id:"clientId2353",dbId:1,sql:"SELECT * FROM something",sqlEditorId:"dfsadfs",tab:"unimportant",tempTable:"",ctas:!1,cached:!1,errorMessage:null,extra:{progress:null},isDataPreview:!1,progress:0,resultsKey:null,state:s.SUCCESS,tempSchema:null,trackingUrl:null,templateParams:null,rows:42,queryLimit:100,limitingFactor:"",endDttm:1476910579693,duration:"",startDttm:1476910566092.96,time:{},user:{},userId:1,db:{},started:"",querylink:{},queryId:1,executedSql:"",output:"",actions:{},type:n.i9.Query,columns:[{column_name:"Column 1",type:"STRING",is_dttm:!1,type_generic:o.Z.STRING},{column_name:"Column 3",type:"STRING",is_dttm:!1,type_generic:o.Z.STRING},{column_name:"Column 2",type:"TIMESTAMP",is_dttm:!0,type_generic:o.Z.TEMPORAL}]},u={results:{displayLimitReached:!1,columns:[{column_name:"Column 1",type:"STRING",type_generic:o.Z.STRING,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:o.Z.STRING,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:o.Z.TEMPORAL,is_dttm:!0}],data:[{"Column 1":"a","Column 2":"b","Column 3":"2014-11-11T00:00:00"}],expanded_columns:[],selected_columns:[{column_name:"Column 1",type:"STRING",type_generic:o.Z.STRING,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:o.Z.STRING,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:o.Z.TEMPORAL,is_dttm:!0}],query:{limit:6}}},p={...d,...u};var h;!function(e){e.Row="row",e.Column="column"}(h||(h={}));const m={}},20620:(e,t,r)=>{"use strict";var n;r.d(t,{Z:()=>o,n:()=>n}),function(e){e.aggregate="aggregate",e.raw="raw"}(n||(n={}));const o={}},88889:(e,t,r)=>{"use strict";var n;r.d(t,{C:()=>o,Z:()=>n}),function(e){e[e.NUMERIC=0]="NUMERIC",e[e.STRING=1]="STRING",e[e.TEMPORAL=2]="TEMPORAL",e[e.BOOLEAN=3]="BOOLEAN"}(n||(n={}));const o={}},88484:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o,t:()=>n});const n=/(\d{4}-\d{2}-\d{2})[\sT](\d{2}:\d{2}:\d{2}\.?\d*).*/;function o(e){const t=e.match(n);return t?`${t[1]}T${t[2]}Z`:e}},75049:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=r(53652),o=r(1875);class a extends n.Z{constructor(){super(...arguments),this.name="ExtensionsRegistry"}}const i=(0,o.Z)(a,{})},55786:(e,t,r)=>{"use strict";function n(e){return null==e?[]:Array.isArray(e)?e:[e]}r.d(t,{Z:()=>n})},32103:(e,t,r)=>{"use strict";r.d(t,{Kv:()=>s,T4:()=>l,Ul:()=>c,Z6:()=>i,ZU:()=>d}),r(67294);var n=r(68924),o=r(11965);const a=new n.FilterXSS({whiteList:{...(0,n.getDefaultWhiteList)(),span:["style","class","title"],div:["style","class"],a:["style","class","href","title","target"],img:["style","class","src","alt","title","width","height"],video:["autoplay","controls","loop","preload","src","height","width","muted"]},stripIgnoreTag:!0,css:!1});function i(e){return a.process(e)}function s(e){return Array.from((new DOMParser).parseFromString(e,"text/html").body.childNodes).some((e=>{let{nodeType:t}=e;return 1===t}))}function l(e){return s(e)?i(e):e}function c(e){return s(e)?(0,o.tZ)("span",{className:"safe-html-wrapper",dangerouslySetInnerHTML:{__html:i(e)}}):e}function d(e){return e.replace(/<[^>]*>/g,"")}},37731:(e,t,r)=>{"use strict";function n(e){return null!=e}r.d(t,{Z:()=>n})},1111:(e,t,r)=>{"use strict";function n(e,t){return e===t||!e&&!t||!!(e&&t&&e.length===t.length&&e.every(((e,r)=>e===t[r])))}r.d(t,{Z:()=>n})},74765:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(e,t){if(t){const r=new Set;return e.filter((e=>{const n=t(e);return!r.has(n)&&(r.add(n),!0)}))}return[...new Set(e)]}},75294:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(61988);function o(e){return!(!e||!Number.isNaN(Number(e))&&parseInt(e,10)===Number(e))&&(0,n.t)("is expected to be an integer")}},99298:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(61988);function o(e){return!(!e||!Number.isNaN(Number(e)))&&(0,n.t)("is expected to be a number")}},74029:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(61988);function o(e,t){return Number(e)>+t&&(0,n.t)("Value cannot exceed %s",t)}},95826:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(61988);function o(e){return!!(null==e||""===e||Array.isArray(e)&&0===e.length)&&(0,n.t)("cannot be empty")}},872:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(61988);function o(e){return!("string"==typeof e&&e.trim().length>0&&Number.isFinite(Number(e.trim()))||"number"==typeof e&&Number.isFinite(e))&&(0,n.t)("is expected to be a number")}},43693:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m,V:()=>h});var n=r(67294),o=r(28216),a=r(68492),i=r(35937),s=r.n(i),l=r(28241);const c=r(10362).h.injectEndpoints({endpoints:e=>({updateSqlEditorTab:e.mutation({query:e=>{let{queryEditor:{version:t=l.o7,id:r,dbId:n,schema:o,queryLimit:a,sql:i,name:c,latestQueryId:d,hideLeftBar:u,templateParams:p,autorun:h,updatedAt:m},extra:g}=e;return{method:"PUT",endpoint:encodeURI(`/tabstateview/${r}`),postPayload:s()({database_id:n,schema:o,sql:i,label:c,query_limit:a,latest_query_id:d,template_params:p,hide_left_bar:u,autorun:h,extra_json:JSON.stringify({updatedAt:m,version:t,...g})},(e=>void 0!==e))}}})})}),{useUpdateSqlEditorTabMutation:d}=c;var u=r(74004),p=r(11409);function h(e,t,r){return e.map((e=>({...e,...t.id===e.id&&t}))).filter((e=>function(e,t){return e.inLocalStorage||e.updatedAt&&e.updatedAt>t}(e,r)))}const m=()=>{const e=(0,o.v9)((e=>e.sqlLab.queryEditors)),t=(0,o.v9)((e=>e.sqlLab.unsavedQueryEditor)),r=(0,o.v9)((e=>e.sqlLab.editorTabLastUpdatedAt)),i=(0,o.I0)(),s=(0,n.useRef)(r),[l,{error:c}]=d(),m=(0,u.n)(t,5e3);return(0,n.useEffect)((()=>{const t=h(e,m,s.current);Promise.all(t.filter((e=>{let{inLocalStorage:t}=e;return!t})).map((e=>l({queryEditor:e})))).then((e=>{e.some((e=>"error"in e))||(s.current=Date.now(),i((0,p.setEditorTabLastUpdate)(s.current)))}))}),[m,i,e,l]),(0,n.useEffect)((()=>{c&&a.Z.warn("An error occurred while saving your editor state.",c)}),[i,c]),null}},47710:(e,t,r)=>{"use strict";r.d(t,{W:()=>I});var n=r(47037),o=r.n(n),a=r(41609),i=r.n(a),s=r(67294),l=r(87183),c=r(4715),d=r(9875),u=r(74069),p=r(35932),h=r(51995),m=r(31069),g=r(61988),f=r(28216),v=r(30381),_=r.n(v),b=r(15926),y=r.n(b),E=r(11409),T=r(72570),S=r(28241),C=r(12515),R=r(40219),Z=r(27600),A=r(11965);const x=h.iK.div`
  .sdm-body {
    margin: 0 8px;
  }
  .sdm-input {
    margin-left: 45px;
    width: 401px;
  }
  .sdm-autocomplete {
    width: 401px;
    align-self: center;
  }
  .sdm-radio {
    display: block;
    height: 30px;
    margin: 10px 0px;
    line-height: 30px;
  }
  .sdm-overwrite-msg {
    margin: 7px;
  }
  .sdm-overwrite-container {
    flex: 1 1 auto;
    display: flex;
  }
`,O=async(e,t,r,n,o,a)=>{const i=`api/v1/dataset/${t}?override_columns=${a}`,s=JSON.stringify({sql:r,columns:n,owners:o,database_id:e});return(await m.Z.put({endpoint:i,headers:{"Content-Type":"application/json"},body:s})).json.result},w=(0,g.t)("Untitled Dataset"),I=e=>{let{visible:t,onHide:r,buttonTextOnSave:n,buttonTextOnOverwrite:a,modalDescription:h,datasource:v,openWindow:b=!0,formData:I={}}=e;const N=(0,f.v9)((e=>{var t,r;return(null==(t=e.common)||null==(r=t.conf)?void 0:r.DEFAULT_VIZ_TYPE)||"table"})),D=()=>`${(null==v?void 0:v.name)||w} ${_()().format("L HH:mm:ss")}`,[L,M]=(0,s.useState)(D()),[k,P]=(0,s.useState)(S.fT.SAVE_NEW),[U,$]=(0,s.useState)(!1),[F,q]=(0,s.useState)({}),[V,B]=(0,s.useState)(void 0),[H,j]=(0,s.useState)(!1),z=(0,f.v9)((e=>e.user)),Q=(0,f.I0)(),G=e=>{b?window.open(e,"_blank","noreferrer"):window.location.href=e},Y={...S.C9,...I||{}},W=(0,s.useCallback)((async function(e){void 0===e&&(e="");const{userId:t}=z,r=y().encode({filters:[{col:"table_name",opr:"ct",value:e},{col:"owners",opr:"rel_m_m",value:t}],order_column:"changed_on_delta_humanized",order_direction:"desc"});return m.Z.get({endpoint:`/api/v1/dataset/?q=${r}`}).then((e=>({data:e.json.result.map((e=>({value:e.table_name,label:e.table_name,datasetid:e.id,owners:e.owners}))),totalCount:e.json.count})))}),[z]),K=k===S.fT.SAVE_NEW&&0===L.length||k===S.fT.OVERWRITE_DATASET&&i()(V);return(0,A.tZ)(u.default,{show:t,title:(0,g.t)("Save or Overwrite Dataset"),onHide:r,footer:(0,A.tZ)(s.Fragment,null,k===S.fT.SAVE_NEW&&(0,A.tZ)(p.Z,{disabled:K,buttonStyle:"primary",onClick:()=>{var e,t;j(!0);const n=null!=(e=null==v?void 0:v.columns)?e:[];let a;if(o()(null==v?void 0:v.templateParams)){const e=JSON.parse(v.templateParams);e._filters&&(delete e._filters,a=JSON.stringify(e))}Q((0,E.createDatasource)({sql:v.sql,dbId:v.dbId||(null==v||null==(t=v.database)?void 0:t.id),schema:null==v?void 0:v.schema,templateParams:a,datasourceName:L})).then((e=>(0,R.nv)(e.id,"table",{...Y,datasource:`${e.id}__table`,..."table"===N&&{all_columns:n.map((e=>e.column_name))}}))).then((e=>{j(!1);const t=(0,C.y8)(null,{[Z.KD.formDataKey.name]:e});G(t),M(D()),r()})).catch((()=>{j(!1),(0,T.Gb)((0,g.t)("An error occurred saving dataset"))}))},loading:H},n),k===S.fT.OVERWRITE_DATASET&&(0,A.tZ)(s.Fragment,null,U&&(0,A.tZ)(p.Z,{onClick:()=>{$(!1),q({})}},(0,g.t)("Back")),(0,A.tZ)(p.Z,{className:"md",buttonStyle:"primary",onClick:async()=>{var e,t,n;if(!U)return void $(!0);j(!0);const[,o]=await Promise.all([O(null==v?void 0:v.dbId,null==F?void 0:F.datasetid,null==v?void 0:v.sql,null==v||null==(e=v.columns)?void 0:e.map((e=>({column_name:e.column_name,type:e.type,is_dttm:e.is_dttm}))),null==F||null==(t=F.owners)?void 0:t.map((e=>e.id)),!0),(0,R.nv)(F.datasetid,"table",{...Y,datasource:`${F.datasetid}__table`,..."table"===N&&{all_columns:null==v||null==(n=v.columns)?void 0:n.map((e=>e.column_name))}})]);j(!1);const a=(0,C.y8)(null,{[Z.KD.formDataKey.name]:o});G(a),$(!1),M(D()),r()},disabled:K,loading:H},a)))},(0,A.tZ)(x,null,!U&&(0,A.tZ)("div",{className:"sdm-body"},h&&(0,A.tZ)("div",{className:"sdm-prompt"},h),(0,A.tZ)(l.Y.Group,{onChange:e=>{P(Number(e.target.value))},value:k},(0,A.tZ)(l.Y,{className:"sdm-radio",value:1},(0,g.t)("Save as new"),(0,A.tZ)(d.II,{className:"sdm-input",value:L,onChange:e=>{M(e.target.value)},disabled:1!==k})),(0,A.tZ)("div",{className:"sdm-overwrite-container"},(0,A.tZ)(l.Y,{className:"sdm-radio",value:2},(0,g.t)("Overwrite existing")),(0,A.tZ)("div",{className:"sdm-autocomplete"},(0,A.tZ)(c.qb,{allowClear:!0,showSearch:!0,placeholder:(0,g.t)("Select or type dataset name"),ariaLabel:(0,g.t)("Existing dataset"),onChange:(e,t)=>{q(t),B(e)},options:e=>W(e),value:V,filterOption:(e,t)=>t.value.toLowerCase().includes(e.toLowerCase()),disabled:2!==k,getPopupContainer:()=>document.body}))))),U&&(0,A.tZ)("div",{className:"sdm-overwrite-msg"},(0,g.t)("Are you sure you want to overwrite this dataset?"))))}},44904:(e,t,r)=>{"use strict";r.d(t,{Em:()=>i,GJ:()=>Z,IY:()=>o,N2:()=>C,OI:()=>O,TU:()=>b,U$:()=>y,Yn:()=>R,Yo:()=>_,b$:()=>E,bR:()=>s,eU:()=>l,ev:()=>c,fM:()=>g,hC:()=>f,iJ:()=>A,lV:()=>m,lr:()=>x,oN:()=>h,rD:()=>S,rP:()=>u,rp:()=>d,uC:()=>a,xj:()=>p,zY:()=>v,zf:()=>T});var n=r(61988);const o={offline:"danger",failed:"danger",pending:"info",fetching:"info",running:"warning",stopped:"danger",success:"success"},a={offline:(0,n.t)("offline"),failed:(0,n.t)("failed"),pending:(0,n.t)("pending"),fetching:(0,n.t)("fetching"),running:(0,n.t)("running"),stopped:(0,n.t)("stopped"),success:(0,n.t)("success")},i={success:"success",failed:"failed",running:"running",offline:"offline",pending:"pending"},s={success:(0,n.t)("success"),failed:(0,n.t)("failed"),running:(0,n.t)("running"),offline:(0,n.t)("offline"),pending:(0,n.t)("pending")},l=5,c=3,d=51,u=400,p=10,h=30,m=70,g=2e3,f=600,v=100,_=1024,b=2,y=864e5,E=5120,T=1024,S=.9,C=8e3,R=100,Z=90,A=60,x=55,O=50},48527:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(61988),o=r(72570),a=r(1927);function i(e){void 0===e&&(e=[]);const t=[];return e.forEach((e=>{let[r,n]=e;const i="danger"===r?a.p.DANGER:"success"===r&&a.p.SUCCESS||a.p.INFO,s=(0,o.fz)({text:n,toastType:i}).payload;t.push(s)})),t}var s=r(28241);function l(e){return e.reduce(((e,t)=>e.slice(-1)[0]===t?e:e.concat(t)),[])}function c(e){var t;let{common:r,active_tab:o,tab_state_ids:a=[],databases:c,queries:d,...u}=e,p={};const h={version:s.o7,loaded:!0,name:(0,n.t)("Untitled query"),sql:"SELECT *\nFROM\nWHERE",latestQueryId:null,autorun:!1,dbId:r.conf.SQLLAB_DEFAULT_DBID,queryLimit:r.conf.DEFAULT_SQLLAB_LIMIT,hideLeftBar:!1,remoteId:null};let m={};a.forEach((e=>{let t,{id:r,label:n}=e;var a,i,l,c;t=o&&o.id===r?{version:null!=(a=null==(i=o.extra_json)?void 0:i.version)?a:s.$I.v1,id:r.toString(),loaded:!0,name:o.label,sql:o.sql||"",selectedText:void 0,latestQueryId:o.latest_query?o.latest_query.id:null,remoteId:(null==(l=o.saved_query)?void 0:l.id)||null,autorun:Boolean(o.autorun),templateParams:o.template_params||void 0,dbId:o.database_id,schema:o.schema,queryLimit:o.query_limit,hideLeftBar:o.hide_left_bar,updatedAt:null==(c=o.extra_json)?void 0:c.updatedAt}:{...h,id:r.toString(),loaded:!1,name:n},p={...p,[t.id]:t}}));const g=o?[o.id.toString()]:[];let f={},v=Date.now();var _;o&&(v=(null==(_=o.extra_json)?void 0:_.updatedAt)||v,o.table_schemas.filter((e=>null!==e.description)).forEach((e=>{const{dataPreviewQueryId:t,...r}=e.description,n={dbId:e.database_id,queryEditorId:e.tab_state_id.toString(),schema:e.schema,name:e.table,expanded:e.expanded,id:e.id,dataPreviewQueryId:t,persistData:r,initialized:!0};f={...f,[n.id]:n}})));const b={...d};try{const e=localStorage.getItem("redux"),t=e?JSON.parse(e):void 0;if(e&&null!=t&&t.sqlLab){const{sqlLab:e}=t;if(0===e.queryEditors.length)localStorage.removeItem("redux");else{m=e.unsavedQueryEditor||m,e.queryEditors.forEach((e=>{var t,r;const n=Boolean(p[e.id]),o=null==(t=p[e.id])?void 0:t.updatedAt,a=e.updatedAt&&(!o||e.updatedAt>o),i=!n||a?e:{};p={...p,[e.id]:{...p[e.id],...i,name:i.title||i.name||(null==(r=p[e.id])?void 0:r.name),...i.id&&m.id===e.id&&m,inLocalStorage:!n,loaded:!0}}}));const t=new Set;e.tables&&(f=e.tables.reduce(((e,r)=>{const n=!t.has(r.queryEditorId);return n&&t.add(r.queryEditorId),{...e,[r.id]:{...f[r.id],...r,expanded:n,inLocalStorage:!0}}}),f)),e.queries&&Object.values(e.queries).forEach((e=>{b[e.id]={...e,inLocalStorage:!0}})),e.tabHistory&&g.push(...e.tabHistory)}}}catch(e){}return{sqlLab:{activeSouthPaneTab:"Results",alerts:[],databases:c,offline:!1,queries:Object.fromEntries(Object.entries(b).map((e=>{let[t,r]=e;return[t,{...r,...r.startDttm&&{startDttm:Number(r.startDttm)},...r.endDttm&&{endDttm:Number(r.endDttm)}}]}))),queryEditors:Object.values(p),tabHistory:l(g),tables:Object.values(f),queriesLastUpdate:Date.now(),editorTabLastUpdatedAt:v,queryCostEstimates:{},unsavedQueryEditor:m},messageToasts:i((null==(t=r||{})?void 0:t.flash_messages)||[]),localStorageUsageInKilobytes:0,common:r,...u}}},28241:(e,t,r)=>{"use strict";var n;r.d(t,{$I:()=>n,C9:()=>i,fT:()=>a,o7:()=>o}),function(e){e[e.v1=1]="v1"}(n||(n={}));const o=n.v1;var a;!function(e){e[e.SAVE_NEW=1]="SAVE_NEW",e[e.OVERWRITE_DATASET=2]="OVERWRITE_DATASET"}(a||(a={}));const i={metrics:[],groupby:[],time_range:"No filter",row_limit:1e3}},33313:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(44904);const o=["AND","AS","ASC","AVG","BY","CASE","COUNT","CREATE","CROSS","DATABASE","DEFAULT","DELETE","DESC","DISTINCT","DROP","ELSE","END","FOREIGN","FROM","GRANT","GROUP","HAVING","IF","INNER","INSERT","JOIN","KEY","LEFT","LIMIT","MAX","MIN","NATURAL","NOT","NULL","OFFSET","ON","OR","ORDER","OUTER","PRIMARY","REFERENCES","RIGHT","SELECT","SUM","TABLE","THEN","TYPE","UNION","UPDATE","WHEN","WHERE"].concat(["BIGINT","BINARY","BIT","CHAR","DATE","DECIMAL","DOUBLE","FLOAT","INT","INTEGER","MONEY","NUMBER","NUMERIC","REAL","SET","TEXT","TIMESTAMP","VARCHAR"]).map((e=>({meta:"sql",name:e,score:n.Yn,value:e})))},29487:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(73126),o=r(11965),a=(r(67294),r(4863)),i=r(51995),s=r(70707);function l(e){const{type:t="info",description:r,showIcon:l=!0,closable:c=!0,roomBelow:d=!1,children:u}=e,p=(0,i.Fg)(),{colors:h,typography:m,gridUnit:g}=p,{alert:f,error:v,info:_,success:b}=h;let y=_,E=s.Z.InfoSolid;return"error"===t?(y=v,E=s.Z.ErrorSolid):"warning"===t?(y=f,E=s.Z.AlertSolid):"success"===t&&(y=b,E=s.Z.CircleCheckSolid),(0,o.tZ)(a.default,(0,n.Z)({role:"alert",showIcon:l,icon:(0,o.tZ)(E,{"aria-label":`${t} icon`}),closeText:c&&(0,o.tZ)(s.Z.XSmall,{"aria-label":"close icon"}),css:(0,o.iv)({marginBottom:d?4*g:0,padding:`${2*g}px ${3*g}px`,alignItems:"flex-start",border:0,backgroundColor:y.light2,"& .ant-alert-icon":{marginRight:2*g},"& .ant-alert-message":{color:y.dark2,fontSize:m.sizes.m,fontWeight:r?m.weights.bold:m.weights.normal},"& .ant-alert-description":{color:y.dark2,fontSize:m.sizes.m}},"","")},e),u)}},94670:(e,t,r)=>{"use strict";r.d(t,{Ad:()=>f,YH:()=>m,Z5:()=>v,cE:()=>h,iO:()=>u,ry:()=>g,up:()=>p});var n=r(73126),o=r(67294),a=r(53239),i=r(67913),s=r(38325),l=r(11965);const c={"mode/sql":()=>r.e(8883).then(r.t.bind(r,48883,23)),"mode/markdown":()=>Promise.all([r.e(9794),r.e(5802),r.e(4832),r.e(6061)]).then(r.t.bind(r,66061,23)),"mode/css":()=>Promise.all([r.e(5802),r.e(4972)]).then(r.t.bind(r,94972,23)),"mode/json":()=>r.e(8750).then(r.t.bind(r,58750,23)),"mode/yaml":()=>r.e(741).then(r.t.bind(r,60741,23)),"mode/html":()=>Promise.all([r.e(9794),r.e(5802),r.e(4832),r.e(1258)]).then(r.t.bind(r,71258,23)),"mode/javascript":()=>Promise.all([r.e(9794),r.e(4579)]).then(r.t.bind(r,54579,23)),"theme/textmate":()=>r.e(2089).then(r.t.bind(r,2089,23)),"theme/github":()=>r.e(440).then(r.t.bind(r,50440,23)),"ext/language_tools":()=>r.e(5335).then(r.t.bind(r,75335,23)),"ext/searchbox":()=>r.e(8656).then(r.t.bind(r,68656,23))};function d(e,t){let{defaultMode:d,defaultTheme:u,defaultTabSize:p=2,fontFamily:h="Menlo, Consolas, Courier New, Ubuntu Mono, source-code-pro, Lucida Console, monospace",placeholder:m}=void 0===t?{}:t;return(0,i.Z)((async()=>{var t,i;const{default:m}=await Promise.resolve().then(r.bind(r,74981));await Promise.all(e.map((e=>c[e]())));const g=d||(null==(t=e.find((e=>e.startsWith("mode/"))))?void 0:t.replace("mode/","")),f=u||(null==(i=e.find((e=>e.startsWith("theme/"))))?void 0:i.replace("theme/",""));return(0,o.forwardRef)((function(e,t){let{keywords:r,mode:i=g,theme:c=f,tabSize:d=p,defaultValue:u="",...v}=e;const _=(0,a.acequire)("ace/ext/language_tools"),b=(0,s.Z)((e=>{const t={getCompletions:(t,r,n,o,a)=>{Number.isNaN(parseInt(o,10))&&r.getMode().$id===`ace/mode/${i}`&&a(null,e)}};_.setCompleters([t])}));return(0,o.useEffect)((()=>{r&&b(r)}),[r,b]),(0,l.tZ)(m,(0,n.Z)({ref:t,mode:i,theme:c,tabSize:d,defaultValue:u,setOptions:{fontFamily:h}},v))}))}),m)}const u=d(["mode/sql","theme/github","ext/language_tools","ext/searchbox"]),p=d(["mode/sql","theme/github","ext/language_tools","ext/searchbox"],{placeholder:()=>(0,l.tZ)("div",{style:{height:"100%"}},(0,l.tZ)("div",{style:{width:41,height:"100%",background:"#e8e8e8"}}),(0,l.tZ)("div",{className:"ace_content"}))}),h=d(["mode/markdown","theme/textmate"]),m=d(["mode/markdown","mode/sql","mode/json","mode/html","mode/javascript","theme/textmate"]),g=d(["mode/css","theme/github"]),f=d(["mode/json","theme/github"]),v=d(["mode/json","mode/yaml","theme/github"])},67913:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(73126),o=r(67294),a=r(38703),i=r(11965);function s(e){let{width:t,height:r,showLoadingForImport:n=!1,placeholderStyle:o}=e;return r&&(0,i.tZ)("div",{key:"async-asm-placeholder",style:{width:t,height:r,...o}},n&&(0,i.tZ)(a.Z,{position:"floating"}))||null}function l(e,t){let r,a;function l(){return r||(r=e instanceof Promise?e:e()),a||r.then((e=>{a=e.default||e})),r}void 0===t&&(t=s);const c=(0,o.forwardRef)((function(e,r){const[s,c]=(0,o.useState)(void 0!==a);(0,o.useEffect)((()=>{let e=!0;return s||l().then((()=>{e&&c(!0)})),()=>{e=!1}}));const d=a||t;return d?(0,i.tZ)(d,(0,n.Z)({ref:d===a?r:null},e)):null}));return c.preload=l,c}},35932:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(73126),o=r(11965),a=r(21804),i=r.n(a),s=r(67294),l=r(84967),c=r(94184),d=r.n(c),u=r(4715),p=r(51995),h=r(58593);function m(e){const{tooltip:t,placement:r,disabled:a=!1,buttonSize:c,buttonStyle:m,className:g,cta:f,children:v,href:_,showMarginRight:b=!0,...y}=e,E=(0,p.Fg)(),{colors:T,transitionTiming:S,borderRadius:C,typography:R}=E,{primary:Z,grayscale:A,success:x,warning:O,error:w}=T;let I=32,N=18;"xsmall"===c?(I=22,N=5):"small"===c&&(I=30,N=10);let D=Z.light4,L=(0,l.CD)(.1,Z.base,Z.light4),M=(0,l.CD)(.25,Z.base,Z.light4),k=A.light2,P=Z.dark1,U=P,$=0,F="none",q="transparent",V="transparent",B="transparent";"primary"===m?(D=Z.base,L=Z.dark1,M=(0,l.CD)(.2,A.dark2,Z.dark1),P=A.light5,U=P):"tertiary"===m||"dashed"===m?(D=A.light5,L=A.light5,M=A.light5,k=A.light5,$=1,F="dashed"===m?"dashed":"solid",q=Z.dark1,V=Z.light1,B=A.light2):"danger"===m?(D=w.base,L=(0,l.CD)(.1,A.light5,w.base),M=(0,l.CD)(.2,A.dark2,w.base),P=A.light5,U=P):"warning"===m?(D=O.base,L=(0,l.CD)(.1,A.dark2,O.base),M=(0,l.CD)(.2,A.dark2,O.base),P=A.light5,U=P):"success"===m?(D=x.base,L=(0,l.CD)(.1,A.light5,x.base),M=(0,l.CD)(.2,A.dark2,x.base),P=A.light5,U=P):"link"===m&&(D="transparent",L="transparent",M="transparent",U=Z.base);const H=v;let j=[];j=H&&H.type===s.Fragment?s.Children.toArray(H.props.children):s.Children.toArray(v);const z=b&&j.length>1?2*E.gridUnit:0,Q=(0,o.tZ)(u.C0,(0,n.Z)({href:a?void 0:_,disabled:a,className:d()(g,"superset-button",{cta:!!f}),css:(0,o.iv)({display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:1.5715,fontSize:R.sizes.s,fontWeight:R.weights.bold,height:I,textTransform:"uppercase",padding:`0px ${N}px`,transition:`all ${S}s`,minWidth:f?36*E.gridUnit:void 0,minHeight:f?8*E.gridUnit:void 0,boxShadow:"none",borderWidth:$,borderStyle:F,borderColor:q,borderRadius:C,color:P,backgroundColor:D,"&:hover":{color:U,backgroundColor:L,borderColor:V},"&:active":{color:P,backgroundColor:M},"&:focus":{color:P,backgroundColor:D,borderColor:q},"&[disabled], &[disabled]:hover":{color:A.base,backgroundColor:"link"===m?"transparent":k,borderColor:"link"===m?"transparent":B,pointerEvents:"none"},marginLeft:0,"& + .superset-button":{marginLeft:2*E.gridUnit},"& > :first-of-type":{marginRight:z}},"","")},y),v);return t?(0,o.tZ)(h.u,{placement:r,id:`${i()(t)}-tooltip`,title:t},a?(0,o.tZ)("span",{css:(0,o.iv)({cursor:"not-allowed","& > .superset-button":{marginLeft:2*E.gridUnit}},"","")},Q):Q):Q}},37863:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h,u:()=>p});var n=r(57557),o=r.n(n),a=r(61988),i=r(4305),s=r(50810),l=r(10331),c=r(76445),d=r(44814),u=r(52256);const p={id:0,chartAlert:null,chartStatus:"loading",chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:{},sliceFormData:null,queryController:null,queriesResponse:null,triggerQuery:!0,lastRendered:0};function h(e,t){void 0===e&&(e={});const r={[u.ADD_CHART]:()=>({...p,...t.chart}),[u.CHART_UPDATE_SUCCEEDED]:e=>({...e,chartStatus:"success",chartAlert:null,queriesResponse:t.queriesResponse,chartUpdateEndTime:(0,d.zO)()}),[u.CHART_UPDATE_STARTED]:e=>({...e,chartStatus:"loading",chartStackTrace:null,chartAlert:null,chartUpdateEndTime:null,chartUpdateStartTime:(0,d.zO)(),queryController:t.queryController}),[u.CHART_UPDATE_STOPPED]:e=>({...e,chartStatus:"stopped",chartAlert:(0,a.t)("Updating chart was stopped"),chartUpdateEndTime:(0,d.zO)()}),[u.CHART_RENDERING_SUCCEEDED]:e=>({...e,chartStatus:"rendered",chartUpdateEndTime:(0,d.zO)()}),[u.CHART_RENDERING_FAILED]:e=>({...e,chartStatus:"failed",chartStackTrace:t.stackTrace,chartAlert:(0,a.t)("An error occurred while rendering the visualization: %s",t.error)}),[u.CHART_UPDATE_FAILED](e){var r,n,o,i;return{...e,chartStatus:"failed",chartAlert:t.queriesResponse?null==(r=t.queriesResponse)||null==(n=r[0])?void 0:n.error:(0,a.t)("Network error."),chartUpdateEndTime:(0,d.zO)(),queriesResponse:t.queriesResponse,chartStackTrace:t.queriesResponse?null==(o=t.queriesResponse)||null==(i=o[0])?void 0:i.stacktrace:null}},[u.DYNAMIC_PLUGIN_CONTROLS_READY]:e=>({...e,sliceFormData:(0,l.Hu)(t.controlsState)}),[u.TRIGGER_QUERY]:e=>({...e,triggerQuery:t.value,chartStatus:"loading"}),[u.RENDER_TRIGGERED]:e=>({...e,lastRendered:t.value}),[u.UPDATE_QUERY_FORM_DATA]:e=>({...e,latestQueryFormData:t.value}),[u.ANNOTATION_QUERY_STARTED](e){var r;null!=(r=e.annotationQuery)&&r[t.annotation.name]&&e.annotationQuery[t.annotation.name].abort();const n={...e.annotationQuery,[t.annotation.name]:t.queryController};return{...e,annotationQuery:n}},[u.ANNOTATION_QUERY_SUCCESS](e){const r={...e.annotationData,[t.annotation.name]:t.queryResponse.data},n={...e.annotationError};delete n[t.annotation.name];const o={...e.annotationQuery};return delete o[t.annotation.name],{...e,annotationData:r,annotationError:n,annotationQuery:o}},[u.ANNOTATION_QUERY_FAILED](e){const r={...e.annotationData};delete r[t.annotation.name];const n={...e.annotationError,[t.annotation.name]:t.queryResponse?t.queryResponse.error:(0,a.t)("Network error.")},o={...e.annotationQuery};return delete o[t.annotation.name],{...e,annotationData:r,annotationError:n,annotationQuery:o}}};if(t.type===u.REMOVE_CHART)return o()(e,[t.key]);if(t.type===u.UPDATE_CHART_ID){const{newId:r,key:n}=t;return e[r]={...e[n],id:r},delete e[n],e}return t.type===i.$||t.type===c._?{...t.data.charts}:t.type===s.Rn.SET_DATASOURCES?Object.fromEntries(Object.entries(e).map((e=>{let[t,r]=e;return[t,"failed"===r.chartStatus&&r.chartStackTrace?{...r,chartStatus:"",chartStackTrace:null,chartAlert:null}:r]}))):t.type in r?{...e,[t.key]:r[t.type](e[t.key])}:e}},13842:(e,t,r)=>{"use strict";r.d(t,{dc:()=>i,lU:()=>a,zq:()=>s}),r(67294);var n=r(51995),o=r(11965);const a=()=>{const e=(0,n.Fg)();return(0,o.tZ)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.tZ)("path",{d:"M16 0H2C0.89 0 0 0.9 0 2V16C0 17.1 0.89 18 2 18H16C17.11 18 18 17.1 18 16V2C18 0.9 17.11 0 16 0Z",fill:e.colors.primary.base}),(0,o.tZ)("path",{d:"M7 14L2 9L3.41 7.59L7 11.17L14.59 3.58L16 5L7 14Z",fill:"white"}))},i=()=>{const e=(0,n.Fg)();return(0,o.tZ)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.tZ)("path",{d:"M16 0H2C0.9 0 0 0.9 0 2V16C0 17.1 0.9 18 2 18H16C17.1 18 18 17.1 18 16V2C18 0.9 17.1 0 16 0Z",fill:e.colors.grayscale.light1}),(0,o.tZ)("path",{d:"M14 10H4V8H14V10Z",fill:"white"}))},s=()=>{const e=(0,n.Fg)();return(0,o.tZ)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.tZ)("path",{d:"M16 0H2C0.9 0 0 0.9 0 2V16C0 17.1 0.9 18 2 18H16C17.1 18 18 17.1 18 16V2C18 0.9 17.1 0 16 0Z",fill:e.colors.grayscale.light2}),(0,o.tZ)("path",{d:"M16 2V16H2V2H16V2Z",fill:"white"}))}},87253:(e,t,r)=>{"use strict";r.d(t,{lU:()=>s.lU,zq:()=>s.zq,ZP:()=>i}),r(67294);var n=r(51995),o=r(11965);const a=n.iK.span`
  &,
  & svg {
    vertical-align: top;
  }
`;function i(e){let{checked:t,onChange:r,style:n,className:i}=e;return(0,o.tZ)(a,{style:n,onClick:()=>{r(!t)},role:"checkbox",tabIndex:0,"aria-checked":t,"aria-label":"Checkbox",className:i||""},t?(0,o.tZ)(s.lU,null):(0,o.tZ)(s.zq,null))}var s=r(13842)},43700:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i}),r(67294);var n=r(51995),o=r(46445),a=r(11965);const i=Object.assign((0,n.iK)((e=>{let{light:t,bigger:r,bold:n,animateArrows:i,...s}=e;return(0,a.tZ)(o.Z,s)}))`
    .ant-collapse-item {
      .ant-collapse-header {
        font-weight: ${e=>{let{bold:t,theme:r}=e;return t?r.typography.weights.bold:r.typography.weights.normal}};
        font-size: ${e=>{let{bigger:t,theme:r}=e;return t?4*r.gridUnit+"px":"inherit"}};

        .ant-collapse-arrow svg {
          transition: ${e=>{let{animateArrows:t}=e;return t?"transform 0.24s":"none"}};
        }

        ${e=>{let{expandIconPosition:t}=e;return t&&"right"===t&&"\n            .anticon.anticon-right.ant-collapse-arrow > svg {\n              transform: rotate(90deg) !important;\n            }\n          "}}

        ${e=>{let{light:t,theme:r}=e;return t&&`\n            color: ${r.colors.grayscale.light4};\n            .ant-collapse-arrow svg {\n              color: ${r.colors.grayscale.light4};\n            }\n          `}}

        ${e=>{let{ghost:t,bordered:r,theme:n}=e;return t&&r&&`\n            border-bottom: 1px solid ${n.colors.grayscale.light3};\n          `}}
      }
      .ant-collapse-content {
        .ant-collapse-content-box {
          .loading.inline {
            margin: ${e=>{let{theme:t}=e;return 12*t.gridUnit}}px auto;
            display: block;
          }
        }
      }
    }
    .ant-collapse-item-active {
      .ant-collapse-header {
        ${e=>{let{expandIconPosition:t}=e;return t&&"right"===t&&"\n            .anticon.anticon-right.ant-collapse-arrow > svg {\n              transform: rotate(-90deg) !important;\n            }\n          "}}
      }
    }
  `,{Panel:o.Z.Panel})},77775:(e,t,r)=>{"use strict";r.d(t,{Q:()=>Z,W:()=>M});var n=r(67294),o=r(29487),a=r(61988),i=r(51995),s=r(31069),l=r(76962),c=r(74069),d=r(35932),u=r(34858),p=r(12515),h=r(27600),m=r(98286),g=r(38703),f=r(9875),v=r(33228),_=r(14114),b=r(34581),y=r(11965);const E=(0,a.t)("Warning! Changing the dataset may break the chart if the metadata does not exist."),T=(0,a.t)("Changing the dataset may break the chart if the chart relies on columns or metadata that does not exist in the target dataset"),S=(0,i.iK)(c.default)`
  .ant-modal-body {
    display: flex;
    flex-direction: column;
  }
`,C=i.iK.div`
  .btn-container {
    display: flex;
    justify-content: flex-end;
    padding: 0px 15px;
    margin: 10px 0 0 0;
  }

  .confirm-modal-container {
    margin: 9px;
  }
`,R=i.iK.span`
  cursor: pointer;
  color: ${e=>{let{theme:t}=e;return t.colors.primary.dark1}};
  &: hover {
    color: ${e=>{let{theme:t}=e;return t.colors.primary.dark2}};
  }
`,Z=(0,_.ZP)((e=>{let{addDangerToast:t,addSuccessToast:r,onChange:i,onDatasourceSave:c,onHide:_,show:Z}=e;const[A,x]=(0,n.useState)(void 0),[O,w]=(0,n.useState)(0),[I,N]=(0,n.useState)(v.dY),[D,L]=(0,n.useState)(!1),[M,k]=(0,n.useState)(),P=(0,n.useRef)(null),{state:{loading:U,resourceCollection:$,resourceCount:F},fetchData:q}=(0,u.Yi)("dataset",(0,a.t)("dataset"),t),V=(0,n.useCallback)((e=>{L(!0),k(e)}),[]),B={pageIndex:O,pageSize:v.IV,filters:[],sortBy:I};(0,p.bX)((()=>{q({...B,...A&&{filters:[{id:"table_name",operator:"ct",value:A}]}})}),h.M$,[A,O,I]),(0,n.useEffect)((()=>{Z&&(async()=>{setTimeout((()=>{var e;return null==P||null==(e=P.current)?void 0:e.focus()}),200)})()}),[t,q,i,c,_,V,Z]);const H=[{Cell:e=>{let{row:{original:t}}=e;return(0,y.tZ)(R,{role:"button",tabIndex:0,onClick:()=>V({type:"table",...t})},null==t?void 0:t.table_name)},Header:(0,a.t)("Name"),accessor:"table_name"},{Header:(0,a.t)("Type"),accessor:"kind",disableSortBy:!0},{Header:(0,a.t)("Schema"),accessor:"schema"},{Header:(0,a.t)("Connection"),accessor:"database.database_name",disableSortBy:!0},{Cell:e=>{let{row:{original:{owners:t=[]}}}=e;return(0,y.tZ)(b.Z,{users:t})},Header:(0,a.t)("Owners"),id:"owners",disableSortBy:!0}];return(0,y.tZ)(S,{show:Z,onHide:_,responsive:!0,title:(0,a.t)("Swap dataset"),width:D?"432px":"",height:D?"auto":"540px",hideFooter:!D,footer:(0,y.tZ)(n.Fragment,null,D&&(0,y.tZ)(C,null,(0,y.tZ)("div",{className:"btn-container"},(0,y.tZ)(d.Z,{onClick:()=>{L(!1)}},(0,a.t)("Cancel")),(0,y.tZ)(d.Z,{className:"proceed-btn",buttonStyle:"primary",onClick:()=>{s.Z.get({endpoint:`/api/v1/dataset/${null==M?void 0:M.id}`}).then((e=>{let{json:t}=e;t.result.type="table",c(t.result),i(`${null==M?void 0:M.id}__table`)})).catch((e=>{(0,m.O$)(e).then((e=>{let{error:r,message:n}=e;const o=r?r.error||r.statusText||r:n;t(o)}))})),_(),r((0,a.t)("Successfully changed dataset!"))}},(0,a.t)("Proceed")))))},(0,y.tZ)(n.Fragment,null,!D&&(0,y.tZ)(n.Fragment,null,(0,y.tZ)(o.Z,{roomBelow:!0,type:"warning",css:e=>({marginBottom:4*e.gridUnit}),message:(0,y.tZ)(n.Fragment,null,(0,y.tZ)("strong",null,(0,a.t)("Warning!"))," ",T)}),(0,y.tZ)(f.II,{ref:P,type:"text",value:A,placeholder:(0,a.t)("Search / Filter"),onChange:e=>{var t;const r=null!=(t=e.target.value)?t:"";x(r),w(0)}}),U&&(0,y.tZ)(g.Z,null),!U&&(0,y.tZ)(l.Z,{columns:H,data:$,pageSize:v.IV,initialPageIndex:O,initialSortBy:I,totalCount:F,onServerPagination:e=>{w(e.pageIndex),e.sortBy&&N(e.sortBy.length>0?e.sortBy:v.dY)},className:"table-condensed",emptyWrapperType:l.u.Small,serverPagination:!0,isPaginationSticky:!0,scrollTable:!0})),D&&(0,y.tZ)(n.Fragment,null,E)))}));var A=r(37731),x=r(93185),O=r(67913),w=r(72875),I=r(28216);const N=(0,O.Z)((()=>Promise.all([r.e(1216),r.e(6217),r.e(1862)]).then(r.bind(r,1862)))),D=(0,i.iK)(c.default)`
  .modal-content {
    height: 900px;
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }

  .modal-header {
    flex: 0 1 auto;
  }
  .modal-body {
    flex: 1 1 auto;
    overflow: auto;
  }

  .modal-footer {
    flex: 0 1 auto;
  }
`;function L(e){const t=null!=e&&e.certified_by||null!=e&&e.certification_details?{certified_by:null==e?void 0:e.certified_by,details:null==e?void 0:e.certification_details}:void 0;return JSON.stringify({certification:t,warning_markdown:null==e?void 0:e.warning_markdown})}const M=(0,_.ZP)((e=>{var t;let{addSuccessToast:r,datasource:i,onDatasourceSave:l,onHide:u,show:p}=e;const[h,g]=(0,n.useState)({...i,metrics:null==i||null==(t=i.metrics)?void 0:t.map((e=>({...e,currency:JSON.parse(e.currency||"null")})))}),f=(0,I.v9)((e=>{var t;return null==(t=e.common)?void 0:t.currencies})),[v,_]=(0,n.useState)([]),[b,E]=(0,n.useState)(!1),[T,S]=(0,n.useState)(!1),C=(0,n.useRef)(null),[R,Z]=c.default.useModal(),O=()=>{var e,t,n,o,i;const c=(null==(e=h.tableSelector)?void 0:e.schema)||(null==(t=h.databaseSelector)?void 0:t.schema)||h.schema;E(!0),s.Z.put({endpoint:`/api/v1/dataset/${h.id}`,jsonPayload:{table_name:h.table_name,database_id:null==(n=h.database)?void 0:n.id,sql:h.sql,filter_select_enabled:h.filter_select_enabled,fetch_values_predicate:h.fetch_values_predicate,schema:c,description:h.description,main_dttm_col:h.main_dttm_col,normalize_columns:h.normalize_columns,always_filter_main_dttm:h.always_filter_main_dttm,offset:h.offset,default_endpoint:h.default_endpoint,cache_timeout:""===h.cache_timeout?null:h.cache_timeout,is_sqllab_view:h.is_sqllab_view,template_params:h.template_params,extra:h.extra,is_managed_externally:h.is_managed_externally,external_url:h.external_url,metrics:null==h||null==(o=h.metrics)?void 0:o.map((e=>{const t={expression:e.expression,description:e.description,metric_name:e.metric_name,metric_type:e.metric_type,d3format:e.d3format||null,currency:(0,A.Z)(e.currency)?JSON.stringify(e.currency):null,verbose_name:e.verbose_name,warning_text:e.warning_text,uuid:e.uuid,extra:L(e)};return Number.isNaN(Number(e.id))||(t.id=e.id),t})),columns:null==h||null==(i=h.columns)?void 0:i.map((e=>({id:"number"==typeof e.id?e.id:void 0,column_name:e.column_name,type:e.type,advanced_data_type:e.advanced_data_type,verbose_name:e.verbose_name,description:e.description,expression:e.expression,filterable:e.filterable,groupby:e.groupby,is_active:e.is_active,is_dttm:e.is_dttm,python_date_format:e.python_date_format||null,uuid:e.uuid,extra:L(e)}))),owners:h.owners.map((e=>e.value||e.id))}}).then((()=>(r((0,a.t)("The dataset has been saved")),s.Z.get({endpoint:`/api/v1/dataset/${null==h?void 0:h.id}`})))).then((e=>{let{json:t}=e;t.result.type="table",l({...t.result,owners:h.owners}),u()})).catch((e=>{E(!1),(0,m.O$)(e).then((e=>{var t;let r,n;null!=e&&null!=(t=e.errors)&&t.length?r=e.errors[0]:"string"==typeof e.error&&(n=e.error),R.error({title:(0,a.t)("Error saving dataset"),okButtonProps:{danger:!0,className:"btn-danger"},content:(0,y.tZ)(w.Z,{error:r,source:"crud",fallback:n})})}))}))},M=!(0,x.cr)(x.TT.DISABLE_LEGACY_DATASOURCE_EDITOR);return(0,y.tZ)(D,{show:p,onHide:u,title:(0,y.tZ)("span",null,(0,a.t)("Edit Dataset "),(0,y.tZ)("strong",null,h.table_name)),maskClosable:!T,footer:(0,y.tZ)(n.Fragment,null,M&&(0,y.tZ)(d.Z,{buttonSize:"small",buttonStyle:"default",className:"m-r-5",onClick:()=>{window.location.href=h.edit_url||h.url}},(0,a.t)("Use legacy datasource editor")),(0,y.tZ)(d.Z,{buttonSize:"small",className:"m-r-5",onClick:u},(0,a.t)("Cancel")),(0,y.tZ)(d.Z,{buttonSize:"small",buttonStyle:"primary",onClick:()=>{C.current=R.confirm({title:(0,a.t)("Confirm save"),content:(0,y.tZ)("div",null,(0,y.tZ)(o.Z,{css:e=>({marginTop:4*e.gridUnit,marginBottom:4*e.gridUnit}),type:"warning",showIcon:!0,message:(0,a.t)("The dataset configuration exposed here\n                affects all the charts using this dataset.\n                Be mindful that changing settings\n                here may affect other charts\n                in undesirable ways.")}),(0,a.t)("Are you sure you want to save and apply changes?")),onOk:O,icon:null,okText:(0,a.t)("OK"),cancelText:(0,a.t)("Cancel")})},disabled:b||v.length>0||h.is_managed_externally,tooltip:h.is_managed_externally?(0,a.t)("This dataset is managed externally, and can't be edited in Superset"):""},(0,a.t)("Save"))),responsive:!0},(0,y.tZ)(N,{showLoadingForImport:!0,height:500,datasource:h,onChange:(e,t)=>{g({...e,metrics:null==e?void 0:e.metrics.map((e=>({...e,is_certified:(null==e?void 0:e.certified_by)||(null==e?void 0:e.certification_details)})))}),_(t)},setIsEditing:S,currencies:f}),Z)}))},62276:(e,t,r)=>{"use strict";r.d(t,{M:()=>s,S:()=>i});var n=r(60593),o=r(51995);const a=n.Z.RangePicker,i=(0,o.iK)(a)`
  border-radius: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,s=n.Z},14278:(e,t,r)=>{"use strict";r.d(t,{EM:()=>y,Zn:()=>m,gp:()=>g});var n=r(14176),o=r.n(n),a=r(67294),i=r(11064),s=r(22102),l=r(93185),c=r(81847),d=r(68492),u=r(11965);const p=(0,i.Z)(),h={loading:!0,dynamicPlugins:{},keys:[],mountedPluginMetadata:{},fetchAll:()=>{}},m=a.createContext(h),g=()=>(0,a.useContext)(m);function f(){return{keys:p.keys(),mountedPluginMetadata:o()(p.getMap(),(e=>void 0===e))}}function v(e,t){switch(t.type){case"begin":{const r={...e.dynamicPlugins};return t.keys.forEach((e=>{r[e]={key:e,error:null,mounting:!0}})),{...e,loading:t.keys.length>0,dynamicPlugins:r}}case"complete":return{...e,loading:Object.values(e.dynamicPlugins).some((e=>e.mounting&&e.key!==t.key)),dynamicPlugins:{...e.dynamicPlugins,[t.key]:{key:t.key,mounting:!1,error:t.error}}};case"changed keys":return{...e,...f()};default:return e}}const _=(0,s.Z)({method:"GET",endpoint:"/dynamic-plugins/api/read"}),b={react:()=>Promise.resolve().then(r.t.bind(r,67294,19)),lodash:()=>r.e(6486).then(r.t.bind(r,96486,23)),"react-dom":()=>Promise.resolve().then(r.t.bind(r,90731,19)),"@superset-ui/chart-controls":()=>r.e(2233).then(r.bind(r,82233)),"@superset-ui/core":()=>Promise.all([r.e(1216),r.e(2087),r.e(981),r.e(6377),r.e(7263),r.e(868),r.e(1497)]).then(r.bind(r,40174))},y=e=>{let{children:t}=e;const[r,n]=(0,a.useReducer)(v,h,(e=>({...e,...f(),fetchAll:o,loading:(0,l.cr)(l.TT.DYNAMIC_PLUGINS)})));async function o(){try{await(0,c.YW)(b);const{result:e}=await _({});n({type:"begin",keys:e.map((e=>e.key))}),await Promise.all(e.map((async e=>{let t=null;try{await import(e.bundle_url)}catch(r){d.Z.error(`Failed to load plugin ${e.key} with the following error:`,r.stack),t=r}n({type:"complete",key:e.key,error:t})})))}catch(e){d.Z.error("Failed to load dynamic plugins",e.stack||e)}}return(0,a.useEffect)((()=>{(0,l.cr)(l.TT.DYNAMIC_PLUGINS)&&o();const e=()=>{n({type:"changed keys"})};return p.addListener(e),()=>{p.removeListener(e)}}),[]),(0,u.tZ)(m.Provider,{value:r},t)}},94301:(e,t,r)=>{"use strict";r.d(t,{Tc:()=>S,UX:()=>R,XJ:()=>E,x3:()=>T}),r(67294);var n,o=r(51995),a=r(11965),i=r(61988),s=r(4715),l=r(35932);!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Big=2]="Big"}(n||(n={}));const c=o.iK.div`
  ${e=>{let{theme:t}=e;return a.iv`
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    align-items: center;
    justify-content: center;
    padding: ${4*t.gridUnit}px;
    text-align: center;

    & .ant-empty-image svg {
      width: auto;
    }

    & a,
    & span[role='button'] {
      color: inherit;
      text-decoration: underline;
      &:hover {
        color: ${t.colors.grayscale.base};
      }
    }
  `}}
`,d=o.iK.div``,u=o.iK.p`
  ${e=>{let{theme:t}=e;return a.iv`
    font-size: ${t.typography.sizes.m}px;
    color: ${t.colors.grayscale.light1};
    margin: ${2*t.gridUnit}px 0 0 0;
    font-weight: ${t.typography.weights.bold};
  `}}
`,p=(0,o.iK)(u)`
  ${e=>{let{theme:t}=e;return a.iv`
    font-size: ${t.typography.sizes.l}px;
    color: ${t.colors.grayscale.light1};
    margin-top: ${4*t.gridUnit}px;
  `}}
`,h=o.iK.p`
  ${e=>{let{theme:t}=e;return a.iv`
    font-size: ${t.typography.sizes.s}px;
    color: ${t.colors.grayscale.light1};
    margin: ${2*t.gridUnit}px 0 0 0;
  `}}
`,m=(0,o.iK)(h)`
  ${e=>{let{theme:t}=e;return a.iv`
    font-size: ${t.typography.sizes.m}px;
  `}}
`,g=(0,o.iK)(h)`
  ${e=>{let{theme:t}=e;return a.iv`
    margin-top: ${t.gridUnit}px;
    line-height: 1.2;
  `}}
`,f=(0,o.iK)(l.Z)`
  ${e=>{let{theme:t}=e;return a.iv`
    margin-top: ${4*t.gridUnit}px;
    z-index: 1;
  `}}
`,v=e=>"string"==typeof e?`/static/assets/images/${e}`:e,_=e=>{switch(e){case n.Small:return{height:"50px"};case n.Medium:return{height:"80px"};case n.Big:return{height:"150px"};default:return{height:"50px"}}},b=e=>{let{image:t,size:r}=e;return(0,a.tZ)(s.HY,{description:!1,image:v(t),imageStyle:_(r)})},y=e=>{e.preventDefault(),e.stopPropagation()},E=e=>{let{title:t,image:r,description:o,buttonAction:i,buttonText:s,className:l}=e;return(0,a.tZ)(c,{className:l},r&&(0,a.tZ)(b,{image:r,size:n.Big}),(0,a.tZ)(d,{css:e=>a.iv`
        max-width: ${150*e.gridUnit}px;
      `},(0,a.tZ)(p,null,t),o&&(0,a.tZ)(m,null,o),i&&s&&(0,a.tZ)(f,{buttonStyle:"primary",onClick:i,onMouseDown:y},s)))},T=e=>{let{title:t,image:r,description:o,buttonAction:i,buttonText:s}=e;return(0,a.tZ)(c,null,r&&(0,a.tZ)(b,{image:r,size:n.Medium}),(0,a.tZ)(d,{css:e=>a.iv`
        max-width: ${100*e.gridUnit}px;
      `},(0,a.tZ)(u,null,t),o&&(0,a.tZ)(h,null,o),s&&i&&(0,a.tZ)(f,{buttonStyle:"primary",onClick:i,onMouseDown:y},s)))},S=e=>{let{title:t,image:r,description:o}=e;return(0,a.tZ)(c,null,r&&(0,a.tZ)(b,{image:r,size:n.Small}),(0,a.tZ)(d,{css:e=>a.iv`
        max-width: ${75*e.gridUnit}px;
      `},(0,a.tZ)(u,null,t),o&&(0,a.tZ)(g,null,o)))},C={NO_DATABASES_MATCH_TITLE:(0,i.t)("No databases match your search"),NO_DATABASES_AVAILABLE_TITLE:(0,i.t)("There are no databases available"),MANAGE_YOUR_DATABASES_TEXT:(0,i.t)("Manage your databases"),HERE_TEXT:(0,i.t)("here")},R=e=>(0,a.tZ)(S,{image:"empty.svg",title:e?C.NO_DATABASES_MATCH_TITLE:C.NO_DATABASES_AVAILABLE_TITLE,description:(0,a.tZ)("p",null,C.MANAGE_YOUR_DATABASES_TEXT," ",(0,a.tZ)("a",{href:"/databaseview/list"},C.HERE_TEXT))})},91178:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(67294),o=r(51995),a=r(61988),i=r(54076),s=r(74069),l=r(35932),c=r(71894),d=r(70707),u=r(13433),p=r(11965);const h=o.iK.div`
  align-items: center;
  background-color: ${e=>{let{level:t,theme:r}=e;return r.colors[t].light2}};
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
  border: 1px solid ${e=>{let{level:t,theme:r}=e;return r.colors[t].base}};
  color: ${e=>{let{level:t,theme:r}=e;return r.colors[t].dark2}};
  padding: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  width: 100%;

  .top-row {
    display: flex;
    justify-content: space-between;
  }

  .error-body {
    padding-top: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    padding-left: ${e=>{let{theme:t}=e;return 8*t.gridUnit}}px;
  }

  .icon {
    margin-right: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  }

  .link {
    color: ${e=>{let{level:t,theme:r}=e;return r.colors[t].dark2}};
    text-decoration: underline;
  }
`,m=(0,o.iK)(s.default)`
  color: ${e=>{let{level:t,theme:r}=e;return r.colors[t].dark2}};
  overflow-wrap: break-word;

  .ant-modal-header {
    background-color: ${e=>{let{level:t,theme:r}=e;return r.colors[t].light2}};
    padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  }

  .icon {
    margin-right: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  }

  .header {
    display: flex;
    align-items: center;
    font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.l}}px;
  }
`,g=o.iK.div`
  align-items: center;
  display: flex;
`;function f(e){let{body:t,copyText:r,level:s="error",source:f="dashboard",subtitle:v,title:_,description:b}=e;const y=(0,o.Fg)(),[E,T]=(0,n.useState)(!1),[S,C]=(0,n.useState)((0,c.b)()),R=(0,c.b)()||["explore","sqllab"].includes(f),Z=y.colors[s].base;return(0,p.tZ)(h,{level:s,role:"alert"},(0,p.tZ)("div",{className:"top-row"},(0,p.tZ)(g,null,"error"===s?(0,p.tZ)(d.Z.ErrorSolid,{className:"icon",iconColor:Z}):(0,p.tZ)(d.Z.WarningSolid,{className:"icon",iconColor:Z}),(0,p.tZ)("strong",null,_)),!R&&!b&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>T(!0)},(0,a.t)("See more"))),b&&(0,p.tZ)("div",{className:"error-body"},(0,p.tZ)("p",null,b),!R&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>T(!0)},(0,a.t)("See more"))),R?(0,p.tZ)("div",{className:"error-body"},(0,p.tZ)("p",null,v),t&&(0,p.tZ)(n.Fragment,null,!S&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>C(!0)},(0,a.t)("See more")),S&&(0,p.tZ)(n.Fragment,null,(0,p.tZ)("br",null),t,(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>C(!1)},(0,a.t)("See less"))))):(0,p.tZ)(m,{level:s,show:E,onHide:()=>T(!1),destroyOnClose:!0,title:(0,p.tZ)("div",{className:"header"},"error"===s?(0,p.tZ)(d.Z.ErrorSolid,{className:"icon",iconColor:Z}):(0,p.tZ)(d.Z.WarningSolid,{className:"icon",iconColor:Z}),(0,p.tZ)("div",{className:"title"},_)),footer:(0,p.tZ)(n.Fragment,null,r&&(0,p.tZ)(u.Z,{text:r,shouldShowText:!1,wrapped:!1,copyNode:(0,p.tZ)(l.Z,{onClick:i.EI},(0,a.t)("Copy message"))}),(0,p.tZ)(l.Z,{cta:!0,buttonStyle:"primary",onClick:()=>T(!1)},(0,a.t)("Close")))},(0,p.tZ)(n.Fragment,null,(0,p.tZ)("p",null,v),v&&t&&(0,p.tZ)("br",null),t)))}},72875:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(67294),o=r(61988),a=r(92869),i=r(91178),s=r(11965);const l=(0,o.t)("Unexpected error");function c(e){let{title:t=l,error:r,subtitle:o,copyText:c,link:d,stackTrace:u,source:p,description:h,fallback:m}=e;if(r){const e=(0,a.Z)().get(r.error_type);if(e)return(0,s.tZ)(e,{error:r,source:p,subtitle:o})}return m?(0,s.tZ)(n.Fragment,null,m):(0,s.tZ)(i.Z,{level:"warning",title:t,subtitle:o,copyText:c,description:h,source:p,body:d||u?(0,s.tZ)(n.Fragment,null,d&&(0,s.tZ)("a",{href:d,target:"_blank",rel:"noopener noreferrer"},"(Request Access)"),(0,s.tZ)("br",null),u&&(0,s.tZ)("pre",null,u)):void 0})}},92869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(90537),o=r(1875);class a extends n.Z{constructor(){super({name:"ErrorMessageComponent",overwritePolicy:n.r.ALLOW})}}const i=(0,o.Z)(a)},67663:(e,t,r)=>{"use strict";r.d(t,{C:()=>n});const n={FRONTEND_CSRF_ERROR:"FRONTEND_CSRF_ERROR",FRONTEND_NETWORK_ERROR:"FRONTEND_NETWORK_ERROR",FRONTEND_TIMEOUT_ERROR:"FRONTEND_TIMEOUT_ERROR",GENERIC_DB_ENGINE_ERROR:"GENERIC_DB_ENGINE_ERROR",COLUMN_DOES_NOT_EXIST_ERROR:"COLUMN_DOES_NOT_EXIST_ERROR",TABLE_DOES_NOT_EXIST_ERROR:"TABLE_DOES_NOT_EXIST_ERROR",SCHEMA_DOES_NOT_EXIST_ERROR:"SCHEMA_DOES_NOT_EXIST_ERROR",CONNECTION_INVALID_USERNAME_ERROR:"CONNECTION_INVALID_USERNAME_ERROR",CONNECTION_INVALID_PASSWORD_ERROR:"CONNECTION_INVALID_PASSWORD_ERROR",CONNECTION_INVALID_HOSTNAME_ERROR:"CONNECTION_INVALID_HOSTNAME_ERROR",CONNECTION_PORT_CLOSED_ERROR:"CONNECTION_PORT_CLOSED_ERROR",CONNECTION_INVALID_PORT_ERROR:"CONNECTION_INVALID_PORT_ERROR",CONNECTION_HOST_DOWN_ERROR:"CONNECTION_HOST_DOWN_ERROR",CONNECTION_ACCESS_DENIED_ERROR:"CONNECTION_ACCESS_DENIED_ERROR",CONNECTION_UNKNOWN_DATABASE_ERROR:"CONNECTION_UNKNOWN_DATABASE_ERROR",CONNECTION_DATABASE_PERMISSIONS_ERROR:"CONNECTION_DATABASE_PERMISSIONS_ERROR",CONNECTION_MISSING_PARAMETERS_ERRORS:"CONNECTION_MISSING_PARAMETERS_ERRORS",OBJECT_DOES_NOT_EXIST_ERROR:"OBJECT_DOES_NOT_EXIST_ERROR",SYNTAX_ERROR:"SYNTAX_ERROR",VIZ_GET_DF_ERROR:"VIZ_GET_DF_ERROR",UNKNOWN_DATASOURCE_TYPE_ERROR:"UNKNOWN_DATASOURCE_TYPE_ERROR",FAILED_FETCHING_DATASOURCE_INFO_ERROR:"FAILED_FETCHING_DATASOURCE_INFO_ERROR",TABLE_SECURITY_ACCESS_ERROR:"TABLE_SECURITY_ACCESS_ERROR",DATASOURCE_SECURITY_ACCESS_ERROR:"DATASOURCE_SECURITY_ACCESS_ERROR",DATABASE_SECURITY_ACCESS_ERROR:"DATABASE_SECURITY_ACCESS_ERROR",QUERY_SECURITY_ACCESS_ERROR:"QUERY_SECURITY_ACCESS_ERROR",MISSING_OWNERSHIP_ERROR:"MISSING_OWNERSHIP_ERROR",DASHBOARD_SECURITY_ACCESS_ERROR:"DASHBOARD_SECURITY_ACCESS_ERROR",BACKEND_TIMEOUT_ERROR:"BACKEND_TIMEOUT_ERROR",DATABASE_NOT_FOUND_ERROR:"DATABASE_NOT_FOUND_ERROR",MISSING_TEMPLATE_PARAMS_ERROR:"MISSING_TEMPLATE_PARAMS_ERROR",INVALID_TEMPLATE_PARAMS_ERROR:"INVALID_TEMPLATE_PARAMS_ERROR",RESULTS_BACKEND_NOT_CONFIGURED_ERROR:"RESULTS_BACKEND_NOT_CONFIGURED_ERROR",DML_NOT_ALLOWED_ERROR:"DML_NOT_ALLOWED_ERROR",INVALID_CTAS_QUERY_ERROR:"INVALID_CTAS_QUERY_ERROR",INVALID_CVAS_QUERY_ERROR:"INVALID_CVAS_QUERY_ERROR",SQLLAB_TIMEOUT_ERROR:"SQLLAB_TIMEOUT_ERROR",RESULTS_BACKEND_ERROR:"RESULTS_BACKEND_ERROR",ASYNC_WORKERS_ERROR:"ASYNC_WORKERS_ERROR",GENERIC_COMMAND_ERROR:"GENERIC_COMMAND_ERROR",GENERIC_BACKEND_ERROR:"GENERIC_BACKEND_ERROR",INVALID_PAYLOAD_FORMAT_ERROR:"INVALID_PAYLOAD_FORMAT_ERROR",INVALID_PAYLOAD_SCHEMA_ERROR:"INVALID_PAYLOAD_SCHEMA_ERROR",MARSHMALLOW_ERROR:"MARSHMALLOW_ERROR"}},34581:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m}),r(67294);var n=r(81545),o=r(51995),a=r(58593),i=r(4715);var s,l,c=r(11965);const d=null!=(s=null==(l=(0,n.Z)().get())?void 0:l.colors)?s:[],u=e=>`\n  width: ${6*e.gridUnit}px;\n  height: ${6*e.gridUnit}px;\n  line-height: ${6*e.gridUnit}px;\n  font-size: ${e.typography.sizes.m}px;\n`,p=(0,o.iK)(i.qE)`
  ${e=>{let{theme:t}=e;return u(t)}}
`,h=(0,o.iK)(i.qE.Group)`
  .ant-avatar {
    ${e=>{let{theme:t}=e;return u(t)}}
  }
`;function m(e){let{users:t,maxCount:r=4}=e;return(0,c.tZ)(h,{maxCount:r},t.map((e=>{var t,r;let{first_name:n,last_name:o,id:i}=e;const s=`${n} ${o}`,l=function(e,t){return e?t[function(e,t){const r=[...e].map((e=>e.charCodeAt(0))),n=r.length,o=n%(t-1)+1,a=r.reduce(((e,t)=>e+t))%t;let i=r[0]%t;return[...new Array(n)].forEach((()=>{i=(o*i+a)%t})),i}(e,t.length)]:"transparent"}(`${i}-${n}-${o}`,d);return(0,c.tZ)(a.u,{key:s,title:s,placement:"top"},(0,c.tZ)(p,{key:s,style:{backgroundColor:l,borderColor:l}},null==n||null==(t=n[0])?void 0:t.toLocaleUpperCase(),null==o||null==(r=o[0])?void 0:r.toLocaleUpperCase()))})))}},4591:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(97538);const o=(0,r(51995).iK)(n.Z.Item)`
  ${e=>{let{theme:t}=e;return`\n    .ant-form-item-label {\n      padding-bottom: ${t.gridUnit}px;\n      & > label {\n        text-transform: uppercase;\n        font-size: ${t.typography.sizes.s}px;\n        color: ${t.colors.grayscale.base};\n\n        &.ant-form-item-required:not(.ant-form-item-required-mark-optional) {\n          &::before {\n            display: none;\n          }\n          &::after {\n            display: inline-block;\n            color: ${t.colors.error.base};\n            font-size: ${t.typography.sizes.s}px;\n            content: '*';\n          }\n        }\n      }\n    }\n  `}}
`},2857:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s}),r(67294);var n=r(51995),o=r(11965);const a=n.iK.label`
  text-transform: uppercase;
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,i=n.iK.label`
  text-transform: uppercase;
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  &::after {
    display: inline-block;
    margin-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    color: ${e=>{let{theme:t}=e;return t.colors.error.base}};
    font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.m}}px;
    content: '*';
  }
`;function s(e){let{children:t,htmlFor:r,required:n=!1,className:s}=e;const l=n?i:a;return(0,o.tZ)(l,{htmlFor:r,className:s},t)}},12353:(e,t,r)=>{"use strict";r.d(t,{Z:()=>C});var n,o=r(73126),a=r(67294),i=r(77808),s=r(31097),l=r(51995),c=r(11965),d=r(61988),u=r(8272),p=r(70707);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h.apply(this,arguments)}const m=(e,t)=>{let{title:r,titleId:o,...i}=e;return a.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":o},i),r?a.createElement("title",{id:o},r):null,n||(n=a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 7a1 1 0 0 0-1 1v4a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm9.71-7.44-5.27-5.27a1.05 1.05 0 0 0-.71-.29H8.27a1.05 1.05 0 0 0-.71.29L2.29 7.56a1.05 1.05 0 0 0-.29.71v7.46c.004.265.107.518.29.71l5.27 5.27c.192.183.445.286.71.29h7.46a1.05 1.05 0 0 0 .71-.29l5.27-5.27a1.05 1.05 0 0 0 .29-.71V8.27a1.05 1.05 0 0 0-.29-.71ZM20 15.31 15.31 20H8.69L4 15.31V8.69L8.69 4h6.62L20 8.69v6.62Z",clipRule:"evenodd"})))},g=(0,a.forwardRef)(m);var f=r(4591),v=r(2857);const _=(0,l.iK)(i.Z)`
  margin: ${e=>{let{theme:t}=e;return`${t.gridUnit}px 0 ${2*t.gridUnit}px`}};
`,b=(0,l.iK)(i.Z.Password)`
  margin: ${e=>{let{theme:t}=e;return`${t.gridUnit}px 0 ${2*t.gridUnit}px`}};
`,y=(0,l.iK)("div")`
  input::-webkit-outer-spin-button,
  input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  margin-bottom: ${e=>{let{theme:t}=e;return 3*t.gridUnit}}px;
  .ant-form-item {
    margin-bottom: 0;
  }
`,E=l.iK.div`
  display: flex;
  align-items: center;
`,T=(0,l.iK)(v.Z)`
  margin-bottom: 0;
`,S=c.iv`
  &.anticon > * {
    line-height: 0;
  }
`,C=e=>{let{label:t,validationMethods:r,errorMessage:n,helpText:a,required:i=!1,hasTooltip:l=!1,tooltipText:h,id:m,className:v,visibilityToggle:C,...R}=e;return(0,c.tZ)(y,{className:v},(0,c.tZ)(E,null,(0,c.tZ)(T,{htmlFor:m,required:i},t),l&&(0,c.tZ)(u.Z,{tooltip:`${h}`,viewBox:"0 -1 24 24"})),(0,c.tZ)(f.Z,{css:e=>((e,t)=>c.iv`
  .ant-form-item-children-icon {
    display: none;
  }
  ${t&&`.ant-form-item-control-input-content {\n      position: relative;\n      &:after {\n        content: ' ';\n        display: inline-block;\n        background: ${e.colors.error.base};\n        mask: url(${g});\n        mask-size: cover;\n        width: ${4*e.gridUnit}px;\n        height: ${4*e.gridUnit}px;\n        position: absolute;\n        right: ${1.25*e.gridUnit}px;\n        top: ${2.75*e.gridUnit}px;\n      }\n    }`}
`)(e,!!n),validateTrigger:Object.keys(r),validateStatus:n?"error":"success",help:n||a,hasFeedback:!!n},C||"password"===R.name?(0,c.tZ)(b,(0,o.Z)({},R,r,{iconRender:e=>e?(0,c.tZ)(s.Z,{title:(0,d.t)("Hide password.")},(0,c.tZ)(p.Z.EyeInvisibleOutlined,{iconSize:"m",css:S})):(0,c.tZ)(s.Z,{title:(0,d.t)("Show password.")},(0,c.tZ)(p.Z.EyeOutlined,{iconSize:"m",css:S})),role:"textbox"})):(0,c.tZ)(_,(0,o.Z)({},R,r))))}},49238:(e,t,r)=>{"use strict";r.d(t,{l0:()=>s,xJ:()=>l.Z,lX:()=>c.Z,QA:()=>d.Z}),r(67294);var n=r(97538),o=r(51995),a=r(11965);const i=(0,o.iK)(n.Z)`
  &.ant-form label {
    font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  }
  .ant-form-item {
    margin-bottom: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  }
`;function s(e){return(0,a.tZ)(i,e)}var l=r(4591),c=r(2857),d=r(12353)},70707:(e,t,r)=>{"use strict";r.d(t,{Z:()=>_});var n=r(73126),o=r(18029),a=r.n(o),i=r(67294),s=r(62816),l=r(16165),c=r(51995);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}const u=(e,t)=>{let{title:r,titleId:n,...o}=e;return i.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:t,"aria-labelledby":n},o))},p=(0,i.forwardRef)(u);var h=r(11965);const m=(0,c.iK)((e=>{let{iconColor:t,iconSize:r,viewBox:o,...a}=e;return(0,h.tZ)(l.Z,(0,n.Z)({viewBox:o||"0 0 24 24"},a))}))`
  ${e=>{let{iconColor:t}=e;return t&&`color: ${t};`}};
  font-size: ${e=>{let{iconSize:t,theme:r}=e;return t?`${r.typography.sizes[t]||r.typography.sizes.m}px`:"24px"}};
`,g=e=>{const{fileName:t,...o}=e,[,a]=(0,i.useState)(!1),s=(0,i.useRef)(),l=t.replace("_","-");return(0,i.useEffect)((()=>{let e=!1;return async function(){s.current=(await r(69233)(`./${t}.svg`)).default,e||a(!0)}(),()=>{e=!0}}),[t,s]),(0,h.tZ)(m,(0,n.Z)({component:s.current||p,"aria-label":l},o))},f=Object.keys(s).filter((e=>!e.includes("TwoTone"))).map((e=>({[e]:t=>(0,h.tZ)(m,(0,n.Z)({component:s[e]},t))}))).reduce(((e,t)=>({...e,...t}))),v={};["alert","alert_solid","alert_solid_small","area-chart-tile","bar-chart-tile","big-number-chart-tile","binoculars","bolt","bolt_small","bolt_small_run","calendar","cancel","cancel_solid","cancel-x","card_view","cards","cards_locked","caret_down","caret_left","caret_right","caret_up","certified","check","checkbox-half","checkbox-off","checkbox-on","circle_check","circle_check_solid","circle","clock","close","code","cog","collapse","color_palette","current-rendered-tile","components","copy","cursor_target","database","dataset_physical","dataset_virtual_greyscale","dataset_virtual","download","drag","edit_alt","edit","email","error","error_solid","error_solid_small","exclamation","expand","eye","eye_slash","favorite-selected","favorite_small_selected","favorite-unselected","field_abc","field_boolean","field_date","field_derived","field_num","field_struct","file","filter","filter_small","folder","full","function_x","gear","grid","image","import","info","info-solid","info_solid_small","join","keyboard","layers","lightbulb","line-chart-tile","link","list","list_view","location","lock_locked","lock_unlocked","map","message","minus","minus_solid","more_horiz","more_vert","move","nav_charts","nav_dashboard","nav_data","nav_explore","nav_home","nav_lab","note","offline","paperclip","pie-chart-tile","placeholder","plus","plus_large","plus_small","plus_solid","queued","refresh","running","save","sql","search","server","share","slack","sort_asc","sort_desc","sort","table","table-chart-tile","tag","trash","triangle_change","triangle_down","triangle_up","up-level","user","warning","warning_solid","x-large","x-small","tags","ballot","category","undo","redo"].forEach((e=>{const t=a()(e).replace(/ /g,"");v[t]=t=>(0,h.tZ)(g,(0,n.Z)({fileName:e},t))}));const _={...f,...v}},8272:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u}),r(67294);var n=r(51995),o=r(58593),a=r(70707),i=r(11965);const s=(0,n.iK)(o.u)`
  cursor: pointer;
  path:first-of-type {
    fill: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  }
`,l=n.iK.span`
  display: -webkit-box;
  -webkit-line-clamp: 20;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
`,c={fontSize:"12px",lineHeight:"16px"},d="rgba(0,0,0,0.9)";function u(e){let{tooltip:t,placement:r="right",trigger:n="hover",overlayStyle:o=c,bgColor:u=d,viewBox:p="0 -2 24 24"}=e;return(0,i.tZ)(s,{title:(0,i.tZ)(l,null,t),placement:r,trigger:n,overlayStyle:o,color:u},(0,i.tZ)(a.Z.InfoSolidSmall,{className:"info-solid-small",viewBox:p}))}},9875:(e,t,r)=>{"use strict";r.d(t,{II:()=>i,Kx:()=>l,Rn:()=>s});var n=r(51995),o=r(77808),a=r(36795);const i=(0,n.iK)(o.Z)`
  border: 1px solid ${e=>{let{theme:t}=e;return t.colors.secondary.light3}};
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
`,s=(0,n.iK)(a.Z)`
  border: 1px solid ${e=>{let{theme:t}=e;return t.colors.secondary.light3}};
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
`,l=(0,n.iK)(o.Z.TextArea)`
  border: 1px solid ${e=>{let{theme:t}=e;return t.colors.secondary.light3}};
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
`},37921:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(73126),o=r(11965),a=(r(67294),r(4715)),i=r(51995);function s(e){const t=(0,i.Fg)(),{colors:r,transitionTiming:s}=t,{type:l="default",onClick:c,children:d,...u}=e,{alert:p,primary:h,secondary:m,grayscale:g,success:f,warning:v,error:_,info:b}=r;let y=g.light3,E=c?h.light2:g.light3,T=c?g.light2:"transparent",S=c?h.light1:"transparent",C=g.dark1;if("default"!==l){let e;C=g.light4,"alert"===l?(C=g.dark1,e=p):e="success"===l?f:"warning"===l?v:"danger"===l?_:"info"===l?b:"secondary"===l?m:h,y=e.base,E=c?e.dark1:e.base,T=c?e.dark1:"transparent",S=c?e.dark2:"transparent"}return(0,o.tZ)(a.Vp,(0,n.Z)({onClick:c},u,{css:(0,o.iv)({transition:`background-color ${s}s`,whiteSpace:"nowrap",cursor:c?"pointer":"default",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:y,borderColor:T,borderRadius:21,padding:"0.35em 0.8em",lineHeight:1,color:C,maxWidth:"100%","&:hover":{backgroundColor:E,borderColor:S,opacity:1}},"","")}),d)}},38703:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c}),r(67294);var n=r(51995),o=r(94184),a=r.n(o),i=r(89419),s=r(11965);const l=n.iK.img`
  z-index: 99;
  width: 50px;
  height: unset;
  position: relative;
  margin: 10px;
  &.inline {
    margin: 0px;
    width: 30px;
  }
  &.inline-centered {
    margin: 0 auto;
    width: 30px;
    display: block;
  }
  &.floating {
    padding: 0;
    margin: 0;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
`;function c(e){let{position:t="floating",image:r,className:n}=e;return(0,s.tZ)(l,{className:a()("loading",t,n),alt:"Loading...",src:r||i,role:"status","aria-live":"polite","aria-label":"Loading"})}},83862:(e,t,r)=>{"use strict";r.d(t,{MainNav:()=>c,Menu:()=>l});var n=r(51995),o=r(43865);const a=(0,n.iK)(o.Z.Item)`
  > a {
    text-decoration: none;
  }

  &.ant-menu-item {
    height: ${e=>{let{theme:t}=e;return 8*t.gridUnit}}px;
    line-height: ${e=>{let{theme:t}=e;return 8*t.gridUnit}}px;
    a {
      border-bottom: none;
      transition: background-color ${e=>{let{theme:t}=e;return t.transitionTiming}}s;
      &:after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 50%;
        width: 0;
        height: 3px;
        opacity: 0;
        transform: translateX(-50%);
        transition: all ${e=>{let{theme:t}=e;return t.transitionTiming}}s;
        background-color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
      }
      &:focus {
        border-bottom: none;
        background-color: transparent;
        @media (max-width: 767px) {
          background-color: ${e=>{let{theme:t}=e;return t.colors.primary.light5}};
        }
      }
    }
  }

  &.ant-menu-item,
  &.ant-dropdown-menu-item {
    span[role='button'] {
      display: inline-block;
      width: 100%;
    }
    transition-duration: 0s;
  }
`,i=(0,n.iK)(o.Z)`
  line-height: 51px;
  border: none;

  & > .ant-menu-item,
  & > .ant-menu-submenu {
    vertical-align: inherit;
    &:hover {
      color: ${e=>{let{theme:t}=e;return t.colors.grayscale.dark1}};
    }
  }

  &:not(.ant-menu-dark) > .ant-menu-submenu,
  &:not(.ant-menu-dark) > .ant-menu-item {
    &:hover {
      border-bottom: none;
    }
  }

  &:not(.ant-menu-dark) > .ant-menu-submenu,
  &:not(.ant-menu-dark) > .ant-menu-item {
    margin: 0px;
  }

  & > .ant-menu-item > a {
    padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  }
`,s=(0,n.iK)(o.Z.SubMenu)`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.dark1}};
  border-bottom: none;
  .ant-menu-submenu-open,
  .ant-menu-submenu-active {
    background-color: ${e=>{let{theme:t}=e;return t.colors.primary.light5}};
    .ant-menu-submenu-title {
      color: ${e=>{let{theme:t}=e;return t.colors.grayscale.dark1}};
      background-color: ${e=>{let{theme:t}=e;return t.colors.primary.light5}};
      border-bottom: none;
      margin: 0;
      &:after {
        opacity: 1;
        width: calc(100% - 1);
      }
    }
  }
  .ant-menu-submenu-title {
    position: relative;
    top: ${e=>{let{theme:t}=e;return-t.gridUnit-3}}px;
    &:after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 50%;
      width: 0;
      height: 3px;
      opacity: 0;
      transform: translateX(-50%);
      transition: all ${e=>{let{theme:t}=e;return t.transitionTiming}}s;
      background-color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
    }
  }
  .ant-menu-submenu-arrow {
    top: 67%;
  }
  & > .ant-menu-submenu-title {
    padding: 0 ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px 0
      ${e=>{let{theme:t}=e;return 3*t.gridUnit}}px !important;
    span[role='img'] {
      position: absolute;
      right: ${e=>{let{theme:t}=e;return-t.gridUnit-2}}px;
      top: ${e=>{let{theme:t}=e;return 5.25*t.gridUnit}}px;
      svg {
        font-size: ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px;
        color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
      }
    }
    & > span {
      position: relative;
      top: 7px;
    }
    &:hover {
      color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
    }
  }
`,l=Object.assign(o.Z,{Item:a}),c=Object.assign(i,{Item:a,SubMenu:s,Divider:o.Z.Divider,ItemGroup:o.Z.ItemGroup})},72570:(e,t,r)=>{"use strict";r.d(t,{Dz:()=>p,Gb:()=>h,K7:()=>l,RS:()=>c,bM:()=>d,fz:()=>s,h:()=>i,s2:()=>m,ws:()=>u});var n=r(14670),o=r.n(n),a=r(1927);const i="ADD_TOAST";function s(e){let{toastType:t,text:r,duration:n=8e3,noDuplicate:a=!1}=e;return{type:i,payload:{id:(s=t,`${s}-${o().generate()}`),toastType:t,text:r,duration:n,noDuplicate:a}};var s}const l="REMOVE_TOAST";function c(e){return{type:l,payload:{id:e}}}function d(e,t){return s({text:e,toastType:a.p.INFO,duration:4e3,...t})}function u(e,t){return s({text:e,toastType:a.p.SUCCESS,duration:4e3,...t})}function p(e,t){return s({text:e,toastType:a.p.WARNING,duration:6e3,...t})}function h(e,t){return s({text:e,toastType:a.p.DANGER,duration:8e3,...t})}const m={addInfoToast:d,addSuccessToast:u,addWarningToast:p,addDangerToast:h}},1927:(e,t,r)=>{"use strict";var n;r.d(t,{p:()=>n}),function(e){e.INFO="INFO_TOAST",e.SUCCESS="SUCCESS_TOAST",e.WARNING="WARNING_TOAST",e.DANGER="DANGER_TOAST"}(n||(n={}))},14114:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>l,e1:()=>c});var n=r(67294),o=r(14890),a=r(28216),i=r(72570);const s={addInfoToast:i.bM,addSuccessToast:i.ws,addWarningToast:i.Dz,addDangerToast:i.Gb};function l(e){return(0,a.$j)(null,(e=>(0,o.DE)(s,e)))(e)}function c(){const e=(0,a.I0)();return(0,n.useMemo)((()=>(0,o.DE)(s,e)),[e])}},74069:(e,t,r)=>{"use strict";r.d(t,{o:()=>g,default:()=>b});var n=r(73126),o=r(14293),a=r.n(o),i=r(67294),s=r(51995),l=r(61988),c=r(11965),d=r(4715),u=r(35932),p=r(29119),h=r(61193),m=r.n(h);const g=(0,s.iK)((e=>(0,c.tZ)(d.xT,(0,n.Z)({},e,{maskTransitionName:""}))))`
  ${e=>{let{theme:t,responsive:r,maxWidth:n}=e;return r&&(0,c.iv)("max-width:",null!=n?n:"900px",";padding-left:",3*t.gridUnit,"px;padding-right:",3*t.gridUnit,"px;padding-bottom:0;top:0;","")}}

  .ant-modal-content {
    display: flex;
    flex-direction: column;
    max-height: ${e=>{let{theme:t}=e;return`calc(100vh - ${8*t.gridUnit}px)`}};
    margin-bottom: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    margin-top: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  }

  .ant-modal-header {
    flex: 0 0 auto;
    background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light4}};
    border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px
      ${e=>{let{theme:t}=e;return t.borderRadius}}px 0 0;
    padding-left: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    padding-right: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;

    .ant-modal-title h4 {
      display: flex;
      margin: 0;
      align-items: center;
    }
  }

  .ant-modal-close-x {
    display: flex;
    align-items: center;

    .close {
      flex: 1 1 auto;
      margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
      color: ${e=>{let{theme:t}=e;return t.colors.secondary.dark1}};
      font-size: 32px;
      font-weight: ${e=>{let{theme:t}=e;return t.typography.weights.light}};
    }
  }

  .ant-modal-body {
    flex: 0 1 auto;
    padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    overflow: auto;
    ${e=>{let{resizable:t,height:r}=e;return!t&&r&&`height: ${r};`}}
  }
  .ant-modal-footer {
    flex: 0 0 1;
    border-top: ${e=>{let{theme:t}=e;return t.gridUnit/4}}px solid
      ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
    padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;

    .btn {
      font-size: 12px;
      text-transform: uppercase;
    }

    .btn + .btn {
      margin-left: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    }
  }

  // styling for Tabs component
  // Aaron note 20-11-19: this seems to be exclusively here for the Edit Database modal.
  // TODO: remove this as it is a special case.
  .ant-tabs-top {
    margin-top: -${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  }

  &.no-content-padding .ant-modal-body {
    padding: 0;
  }

  ${e=>{let{draggable:t,theme:r}=e;return t&&`\n    .ant-modal-header {\n      padding: 0;\n      .draggable-trigger {\n          cursor: move;\n          padding: ${4*r.gridUnit}px;\n          width: 100%;\n        }\n    }\n  `}};

  ${e=>{let{resizable:t,hideFooter:r}=e;return t&&`\n    .resizable {\n      pointer-events: all;\n\n      .resizable-wrapper {\n        height: 100%;\n      }\n\n      .ant-modal-content {\n        height: 100%;\n\n        .ant-modal-body {\n          /* 100% - header height - footer height */\n          height: ${r?"calc(100% - 55px);":"calc(100% - 55px - 65px);"}\n        }\n      }\n    }\n  `}}
`,f=e=>({maxHeight:"100vh",maxWidth:"100vw",minHeight:e?109:174,minWidth:"380px",enable:{bottom:!0,bottomLeft:!1,bottomRight:!0,left:!1,top:!1,topLeft:!1,topRight:!1,right:!0}}),v=e=>{let{children:t,disablePrimaryButton:r=!1,primaryButtonLoading:o=!1,onHide:s,onHandledPrimaryAction:d,primaryButtonName:h=(0,l.t)("OK"),primaryButtonType:v="primary",show:_,name:b,title:y,width:E,maxWidth:T,responsive:S=!1,centered:C,footer:R,hideFooter:Z,wrapProps:A,draggable:x=!1,resizable:O=!1,resizableConfig:w=f(Z),draggableConfig:I,destroyOnClose:N,...D}=e;const L=(0,i.useRef)(null),[M,k]=(0,i.useState)(),[P,U]=(0,i.useState)(!0);let $;i.isValidElement(R)&&($=i.cloneElement(R,{closeModal:s}));const F=a()($)?[(0,c.tZ)(u.Z,{key:"back",onClick:s,cta:!0},(0,l.t)("Cancel")),(0,c.tZ)(u.Z,{key:"submit",buttonStyle:v,disabled:r,loading:o,onClick:d,cta:!0},h)]:$,q=E||(S?"100vw":"600px"),V=!(O||x),B=(0,i.useMemo)((()=>0===Object.keys(w).length?f(Z):w),[Z,w]);return(0,c.tZ)(g,(0,n.Z)({centered:!!C,onOk:d,onCancel:s,width:q,maxWidth:T,responsive:S,visible:_,title:(0,c.tZ)((()=>x?(0,c.tZ)("div",{className:"draggable-trigger",onMouseOver:()=>P&&U(!1),onMouseOut:()=>!P&&U(!0)},y):(0,c.tZ)(i.Fragment,null,y)),null),closeIcon:(0,c.tZ)("span",{className:"close","aria-hidden":"true"},""),footer:Z?null:F,hideFooter:Z,wrapProps:{"data-test":`${b||y}-modal`,...A},modalRender:e=>O||x?(0,c.tZ)(m(),(0,n.Z)({disabled:!x||P,bounds:M,onStart:(e,t)=>((e,t)=>{var r,n,o;const{clientWidth:a,clientHeight:i}=null==(r=window)||null==(n=r.document)?void 0:n.documentElement,s=null==L||null==(o=L.current)?void 0:o.getBoundingClientRect();s&&k({left:-(null==s?void 0:s.left)+(null==t?void 0:t.x),right:a-((null==s?void 0:s.right)-(null==t?void 0:t.x)),top:-(null==s?void 0:s.top)+(null==t?void 0:t.y),bottom:i-((null==s?void 0:s.bottom)-(null==t?void 0:t.y))})})(0,t)},I),O?(0,c.tZ)(p.e,(0,n.Z)({className:"resizable"},B),(0,c.tZ)("div",{className:"resizable-wrapper",ref:L},e)):(0,c.tZ)("div",{ref:L},e)):e,mask:V,draggable:x,resizable:O,destroyOnClose:N},D),t)};v.displayName="Modal";const _={okButtonProps:{className:"modal-functions-ok-button"},cancelButtonProps:{className:"modal-functions-cancel-button"}},b=Object.assign(v,{error:e=>d.xT.error({...e,..._}),warning:e=>d.xT.warning({...e,..._}),confirm:e=>d.xT.confirm({...e,..._}),useModal:d.xT.useModal})},1304:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(67294),o=r(74069),a=r(35932),i=r(11965);const s=n.forwardRef(((e,t)=>{const[r,s]=(0,n.useState)(!1),{beforeOpen:l=(()=>{}),onExit:c=(()=>{}),isButton:d=!1,resizable:u=!1,draggable:p=!1,className:h="",tooltip:m,modalFooter:g,triggerNode:f,destroyOnClose:v=!0,modalBody:_,draggableConfig:b={},resizableConfig:y={},modalTitle:E,responsive:T,width:S,maxWidth:C}=e,R=()=>{s(!1),null==c||c()},Z=e=>{e.preventDefault(),null==l||l(),s(!0)};return t&&(t.current={close:R,open:Z}),(0,i.tZ)(n.Fragment,null,d&&(0,i.tZ)(a.Z,{className:"modal-trigger",tooltip:m,onClick:Z},f),!d&&(0,i.tZ)("span",{onClick:Z,role:"button"},f),(0,i.tZ)(o.default,{className:h,show:r,onHide:R,title:E,footer:g,hideFooter:!g,width:S,maxWidth:C,responsive:T,resizable:u,resizableConfig:y,draggable:p,draggableConfig:b,destroyOnClose:v},_))}))},64158:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u}),r(67294);var n=r(51995),o=r(94184),a=r.n(o),i=r(11965);const s=n.iK.ul`
  display: inline-block;
  margin: 16px 0;
  padding: 0;

  li {
    display: inline;
    margin: 0 4px;

    span {
      padding: 8px 12px;
      text-decoration: none;
      background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light5}};
      border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;

      &:hover,
      &:focus {
        z-index: 2;
        color: ${e=>{let{theme:t}=e;return t.colors.grayscale.dark1}};
        background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light3}};
      }
    }

    &.disabled {
      span {
        background-color: transparent;
        cursor: default;

        &:focus {
          outline: none;
        }
      }
    }
    &.active {
      span {
        z-index: 3;
        color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light5}};
        cursor: default;
        background-color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};

        &:focus {
          outline: none;
        }
      }
    }
  }
`;function l(e){let{children:t}=e;return(0,i.tZ)(s,{role:"navigation"},t)}l.Next=function(e){let{disabled:t,onClick:r}=e;return(0,i.tZ)("li",{className:a()({disabled:t})},(0,i.tZ)("span",{role:"button",tabIndex:t?-1:0,onClick:e=>{e.preventDefault(),t||r(e)}},""))},l.Prev=function(e){let{disabled:t,onClick:r}=e;return(0,i.tZ)("li",{className:a()({disabled:t})},(0,i.tZ)("span",{role:"button",tabIndex:t?-1:0,onClick:e=>{e.preventDefault(),t||r(e)}},""))},l.Item=function(e){let{active:t,children:r,onClick:n}=e;return(0,i.tZ)("li",{className:a()({active:t})},(0,i.tZ)("span",{role:"button",tabIndex:t?-1:0,onClick:e=>{e.preventDefault(),t||n(e)}},r))},l.Ellipsis=function(e){let{disabled:t,onClick:r}=e;return(0,i.tZ)("li",{className:a()({disabled:t})},(0,i.tZ)("span",{role:"button",tabIndex:t?-1:0,onClick:e=>{e.preventDefault(),t||r(e)}},""))};const c=l;var d=r(52630);const u=(0,d.YM)({WrapperComponent:c,itemTypeToComponent:{[d.iB.PAGE]:e=>{let{value:t,isActive:r,onClick:n}=e;return(0,i.tZ)(c.Item,{active:r,onClick:n},t)},[d.iB.ELLIPSIS]:e=>{let{isActive:t,onClick:r}=e;return(0,i.tZ)(c.Ellipsis,{disabled:t,onClick:r})},[d.iB.PREVIOUS_PAGE_LINK]:e=>{let{isActive:t,onClick:r}=e;return(0,i.tZ)(c.Prev,{disabled:t,onClick:r})},[d.iB.NEXT_PAGE_LINK]:e=>{let{isActive:t,onClick:r}=e;return(0,i.tZ)(c.Next,{disabled:t,onClick:r})},[d.iB.FIRST_PAGE_LINK]:()=>null,[d.iB.LAST_PAGE_LINK]:()=>null}})},99299:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a}),r(67294);var n=r(19181),o=r(11965);const a=e=>(0,o.tZ)(n.Z,e)},83734:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(11965),o=(r(67294),r(51995)),a=r(58593),i=r(70707);function s(e){let{title:t,isSelected:r,children:s,onSelect:l,info:c}=e;const d=(0,o.Fg)();return(0,n.tZ)("div",{css:(0,n.iv)({paddingBottom:2*d.gridUnit,opacity:r?1:d.opacity.mediumHeavy},"","")},(0,n.tZ)("div",{role:"button",tabIndex:0,onClick:l,css:(0,n.iv)({display:"flex",alignItems:"center",cursor:l?"pointer":"default"},"","")},(0,n.tZ)("strong",null,t),c&&(0,n.tZ)(a.u,{title:c,css:(0,n.iv)({marginLeft:d.gridUnit},"","")},(0,n.tZ)(i.Z.InfoSolidSmall,{role:"img",width:14,height:14,iconColor:d.colors.grayscale.light1})),(0,n.tZ)(i.Z.Check,{role:"img",iconColor:r?d.colors.primary.base:d.colors.grayscale.base})),(0,n.tZ)("div",{css:(0,n.iv)({marginLeft:d.gridUnit,marginTop:d.gridUnit},"","")},s))}},87183:(e,t,r)=>{"use strict";r.d(t,{Y:()=>s});var n=r(51995),o=r(47933);const a=(0,n.iK)(o.ZP)`
  .ant-radio-inner {
    top: -1px;
    left: 2px;
    width: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    height: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    border-width: 2px;
    border-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
  }

  .ant-radio.ant-radio-checked {
    .ant-radio-inner {
      border-width: ${e=>{let{theme:t}=e;return t.gridUnit+1}}px;
      border-color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
    }

    .ant-radio-inner::after {
      background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light5}};
      top: 0;
      left: 0;
      width: ${e=>{let{theme:t}=e;return t.gridUnit+2}}px;
      height: ${e=>{let{theme:t}=e;return t.gridUnit+2}}px;
    }
  }

  .ant-radio:hover,
  .ant-radio:focus {
    .ant-radio-inner {
      border-color: ${e=>{let{theme:t}=e;return t.colors.primary.dark1}};
    }
  }
`,i=(0,n.iK)(o.ZP.Group)`
  font-size: inherit;
`,s=Object.assign(a,{Group:i,Button:o.ZP.Button})},84101:(e,t,r)=>{"use strict";r.d(t,{Z:()=>C});var n=r(73126),o=r(44908),a=r.n(o),i=r(18446),s=r.n(i),l=r(67294),c=r(61988),d=r(85716),u=r(55786),p=r(23279),h=r.n(p),m=r(70707),g=r(98286),f=r(27600),v=r(85633),_=r(47767),b=r(26579),y=r(34891),E=r(11965);const T=e=>{let{error:t}=e;return(0,E.tZ)(_.BD,null,(0,E.tZ)(m.Z.ErrorSolid,null)," ",(0,E.tZ)(_.Vv,null,t))},S=(e,t,r)=>`${e};${t};${r}`,C=(0,l.forwardRef)(((e,t)=>{let{allowClear:r,allowNewOptions:o=!1,ariaLabel:i,autoClearSearchValue:p=!1,fetchOnlyOnSearch:m,filterOption:C=!0,header:R=null,headerPosition:Z="top",helperText:A,invertSelection:x=!1,lazyLoading:O=!0,loading:w,mode:I="single",name:N,notFoundContent:D,onBlur:L,onError:M,onChange:k,onClear:P,onDropdownVisibleChange:U,onDeselect:$,onSearch:F,onSelect:q,optionFilterProps:V=["label","value"],options:B,pageSize:H=b.L8,placeholder:j=(0,c.t)("Select ..."),showSearch:z=!0,sortComparator:Q=b.Ns,tokenSeparators:G=b.pp,value:Y,getPopupContainer:W,oneLine:K,maxTagCount:X,...J}=e;const ee="single"===I,[te,re]=(0,l.useState)(Y),[ne,oe]=(0,l.useState)(""),[ae,ie]=(0,l.useState)(w),[se,le]=(0,l.useState)(""),[ce,de]=(0,l.useState)(!1),[ue,pe]=(0,l.useState)(0),[he,me]=(0,l.useState)(0),[ge,fe]=(0,l.useState)(!O),[ve,_e]=(0,l.useState)(!1),be=(0,l.useRef)(te),ye=(0,l.useRef)(new Map),Ee=ee?void 0:"multiple",Te=!m||ne,[Se,Ce]=(0,l.useState)(null!=X?X:b.pM),[Re,Ze]=(0,l.useState)(0),Ae=(0,d.D)(Re,0),xe=(0,l.useCallback)((()=>Ze(Re+1)),[Re]);(0,l.useEffect)((()=>{K&&Ce(ce?0:1)}),[ce,K]),(0,l.useEffect)((()=>{be.current=te}),[te]);const Oe=(0,l.useCallback)(((e,t)=>(0,v.Y1)(e,t,be.current)),[]),we=(0,l.useCallback)(((e,t)=>(0,v.tj)(e,t,ne,Oe,Q)),[ne,Q,Oe]),Ie=(0,l.useCallback)(((e,t)=>(0,v.Sl)(e,t,Oe,Q)),[Q,Oe]),[Ne,De]=(0,l.useState)(b.DW),Le=(0,l.useMemo)((()=>{const e=(0,u.Z)(te).filter((e=>!(0,v.Gq)((0,v.NA)(e),Ne))).map((e=>(0,v.nq)(e)?e:{value:e,label:String(e)}));return e.length>0?e.concat(Ne):Ne}),[Ne,te]),Me=(0,l.useCallback)((e=>(0,g.O$)(e).then((e=>{const{error:t}=e;le(t),M&&M(t)}))),[M]),ke=(0,l.useCallback)((e=>{let t=[];if(e&&Array.isArray(e)&&e.length){const r=new Set(e.map((e=>e.value)));De((n=>(t=n.filter((e=>!r.has(e.value))).concat(e).sort(Ie),t)))}return t}),[Ie]),Pe=(0,l.useMemo)((()=>(e,t)=>{if(pe(t),ve)return void ie(!1);const r=S(e,t,H),n=ye.current.get(r);if(void 0!==n)return me(n),void ie(!1);ie(!0),B(e,t,H).then((t=>{let{data:n,totalCount:o}=t;const a=ke(n);ye.current.set(r,o),me(o),!m&&""===e&&a.length>=o&&_e(!0)})).catch(Me).finally((()=>{ie(!1)}))}),[ve,m,ke,Me,B,H]),Ue=(0,l.useMemo)((()=>h()(Pe,f.M$)),[Pe]),$e=h()((e=>{const t=e.trim();if(o){const e=t&&!(0,v.Gq)(t,Le,!0)&&{label:t,value:t,isNewOption:!0},r=Le.filter((e=>!e.isNewOption||(0,v.Gq)(e.value,te))),n=e?[e,...r]:r;De(n)}ve||!ge||ye.current.has(S(t,0,H))||ie(!(m&&!t)),oe(e),null==F||F(t)}),f.oP);(0,l.useEffect)((()=>()=>$e.cancel()),[$e]),(0,l.useEffect)((()=>{if(Re!==Ae){const e=(0,u.Z)(te),t=new Set(e.map(v.NA)),r=(0,v.vi)(Le.filter((e=>t.has(e.value))));ee?null==k||k(te,r[0]):null==k||k(e,r)}}),[Le,ee,k,Re,Ae,te]),(0,l.useEffect)((()=>{ye.current.clear(),_e(!1),De(b.DW)}),[B]),(0,l.useEffect)((()=>{re(Y)}),[Y]),(0,l.useEffect)((()=>()=>{Ue.cancel()}),[Ue]),(0,l.useEffect)((()=>{ge&&Te&&(ne?Ue(ne,0):Pe("",0))}),[ge,Pe,Te,ne,Ue]),(0,l.useEffect)((()=>{void 0!==w&&w!==ae&&ie(w)}),[ae,w]);const Fe=()=>ye.current.clear();(0,l.useImperativeHandle)(t,(()=>({...t.current,clearCache:Fe})),[t]);const qe=(0,l.useCallback)((e=>{const t=(0,v.Rl)(e,Le,!0),r={label:e,value:e};return t&&(r.label=(0,v.Kn)(t)?t.label:t,r.value=(0,v.Kn)(t)?t.value:t),r}),[Le]),Ve=(0,l.useMemo)((()=>(0,v.$)(Le)),[Le]);return(0,E.tZ)(_.PQ,{headerPosition:Z},R&&(0,E.tZ)(_.eb,{headerPosition:Z},R),(0,E.tZ)(_.Qr,(0,n.Z)({allowClear:!ae&&r,"aria-label":i||N,autoClearSearchValue:p,dropdownRender:e=>(0,v.RI)(e,ce,ae,Le.length,A,se?(0,E.tZ)(T,{error:se}):void 0),filterOption:(e,t)=>(0,v.Dz)(e,t,V,C),filterSort:we,getPopupContainer:W||(e=>e.parentNode),headerPosition:Z,labelInValue:!0,maxTagCount:Se,mode:Ee,notFoundContent:ae?(0,c.t)("Loading..."):D,onBlur:e=>{oe(""),null==L||L(e)},onDeselect:(e,t)=>{Array.isArray(te)&&((0,v.nq)(e)?re(te.filter((t=>t.value!==e.value))):re(te.filter((t=>t!==e))),t.isNewOption&&De(Le.filter((t=>(0,v.NA)(t.value)!==(0,v.NA)(e))))),xe(),null==$||$(e,t)},onDropdownVisibleChange:e=>{if(de(e),ge!==e&&fe(e),!e&&ae&&setTimeout((()=>{ie(!1)}),250),e&&!ne&&Ne.length>1){const e=Ne.slice().sort(Ie);s()(e,Ne)||De(e)}U&&U(e)},onPaste:e=>{const t=e.clipboardData.getData("text");if(ee)re(qe(t));else{const e=G.find((e=>t.includes(e))),r=(e?a()(t.split(e)):[t]).map((e=>qe(e)));re((e=>[...e||[],...r]))}xe()},onPopupScroll:e=>{const t=e.currentTarget,r=t.scrollTop>.7*(t.scrollHeight-t.offsetHeight);!ae&&ue*H+H<he&&r&&Pe(ne,ue+1)},onSearch:z?$e:void 0,onSelect:(e,t)=>{re(ee?e:t=>{const r=(0,u.Z)(t),n=(0,v.NA)(e);if(!(0,v.Gq)(n,r)){const t=[...r,e];return(0,v.nq)(e),t}return t}),xe(),null==q||q(e,t)},onClear:()=>{re(void 0),P&&P(),xe()},options:Ve?void 0:Le,placeholder:j,showSearch:z,showArrow:!0,tokenSeparators:G,value:te,suffixIcon:(0,v.AI)(ae,z,ce),menuItemSelectedIcon:x?(0,E.tZ)(_.F6,{iconSize:"m","aria-label":"stop"}):(0,E.tZ)(_.Y1,{iconSize:"m","aria-label":"check"}),oneLine:K,tagRender:y.Z},J,{ref:t}),(0,v.$)(Le)&&(0,v.PO)(Le)))}))},34891:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(73126),o=(r(67294),r(60331)),a=r(51995),i=r(3297),s=r(58593),l=r(85633),c=r(47767),d=r(11965);const u=(0,a.iK)(o.Z)`
  & .ant-tag-close-icon {
    display: inline-flex;
    align-items: center;
    margin-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }

  & .tag-content {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,p=e=>{const[t,r]=(0,i.Z)();return(0,d.tZ)(s.u,{title:r?e.children:null},(0,d.tZ)(u,(0,n.Z)({},e,{className:"ant-select-selection-item"}),(0,d.tZ)("span",{className:"tag-content",ref:t},e.children)))},h=e=>{const{label:t,value:r}=e;return r!==l.qP?(0,d.tZ)(p,(0,n.Z)({onMouseDown:e=>{const t=e.target;("svg"===t.tagName||"path"===t.tagName||"span"===t.tagName&&t.className.includes("ant-tag-close-icon"))&&e.stopPropagation()}},e),t):(0,d.tZ)(c.WC,null)}},81315:(e,t,r)=>{"use strict";r.d(t,{Z:()=>S});var n=r(73126),o=r(44908),a=r.n(o),i=r(18446),s=r.n(i),l=r(23279),c=r.n(l),d=r(67294),u=r(61988),p=r(85716),h=r(55786),m=r(67190),g=r(45636),f=r(64749),v=r(27600),_=r(85633),b=r(47767),y=r(26579),E=r(34891),T=r(11965);const S=(0,d.forwardRef)(((e,t)=>{let{allowClear:r,allowNewOptions:o=!1,allowSelectAll:i=!0,ariaLabel:l,autoClearSearchValue:S=!1,filterOption:C=!0,header:R=null,headerPosition:Z="top",helperText:A,invertSelection:x=!1,labelInValue:O=!1,loading:w,mode:I="single",name:N,notFoundContent:D,onBlur:L,onChange:M,onClear:k,onDropdownVisibleChange:P,onDeselect:U,onSearch:$,onSelect:F,optionFilterProps:q=["label","value"],options:V,placeholder:B=(0,u.t)("Select ..."),showSearch:H=!0,sortComparator:j=y.Ns,tokenSeparators:z=y.pp,value:Q,getPopupContainer:G,oneLine:Y,maxTagCount:W,...K}=e;const X="single"===I,J=!!o||H,[ee,te]=(0,d.useState)(Q),[re,ne]=(0,d.useState)(""),[oe,ae]=(0,d.useState)(w),[ie,se]=(0,d.useState)(!1),[le,ce]=(0,d.useState)(null!=W?W:y.pM),[de,ue]=(0,d.useState)(0),pe=(0,p.D)(de,0),he=(0,d.useCallback)((()=>ue(de+1)),[de]);(0,d.useEffect)((()=>{Y&&ce(ie?0:1)}),[ie,Y]);const me=X?void 0:"multiple",{Option:ge}=f.default,fe=(0,d.useCallback)(((e,t)=>(0,_.Y1)(e,t,ee)),[ee]),ve=(0,d.useCallback)(((e,t)=>(0,_.tj)(e,t,re,fe,j)),[re,j,fe]),_e=(0,d.useMemo)((()=>Array.isArray(V)?V.slice():y.DW),[V]),be=(0,d.useMemo)((()=>_e.slice().sort(fe)),[_e,fe]),[ye,Ee]=(0,d.useState)(be),Te=(0,d.useMemo)((()=>{const e=(0,h.Z)(ee).filter((e=>!(0,_.Gq)((0,_.NA)(e),ye))).map((e=>(0,_.nq)(e)?e:{value:e,label:String(e)}));return(e.length>0?e.concat(ye):ye).filter((e=>e.value!==_.qP))}),[ye,ee]),Se=(0,d.useMemo)((()=>Te.filter((e=>!e.disabled))),[Te]),Ce=(0,d.useMemo)((()=>Te.filter((e=>(0,_.Gq)(e.value,ee)||!e.disabled))),[Te,ee]),Re=(0,d.useMemo)((()=>!X&&i&&ye.length>0&&Se.length>1&&!re),[X,i,ye.length,Se.length,re]),Ze=(0,d.useMemo)((()=>(0,h.Z)(ee).length===Ce.length+1),[ee,Ce]),Ae=()=>{te(X?void 0:Te.filter((e=>e.disabled&&(0,_.Gq)(e.value,ee))).map((e=>O?{label:e.label,value:e.value}:e.value))),he()},xe=c()((e=>{const t=e.trim();if(o){const e=t&&!(0,_.Gq)(t,Te,!0)&&{label:t,value:t,isNewOption:!0},r=(0,h.Z)(Te).filter((e=>!e.isNewOption||(0,_.Gq)(e.value,ee))),n=e?[e,...r]:r;Ee(n)}ne(t),null==$||$(t)}),v.oP);(0,d.useEffect)((()=>()=>xe.cancel()),[xe]),(0,d.useEffect)((()=>{Ee(_e)}),[_e]),(0,d.useEffect)((()=>{void 0!==w&&w!==oe&&ae(w)}),[oe,w]),(0,d.useEffect)((()=>{te(Q)}),[Q]),(0,d.useEffect)((()=>{Re&&(0,h.Z)(Q).length===Ce.length&&te(O?[...(0,h.Z)(Q),_.tP]:[...(0,h.Z)(Q),_.qP])}),[O,Ce.length,Re,Q]),(0,d.useEffect)((()=>{if((0,h.Z)(ee).some((e=>(0,_.NA)(e)===_.qP))&&!Ze){const e=Ce.map((e=>O?e:e.value));e.push(O?_.tP:_.qP),te(e),he()}}),[ee,Ze,O,Ce,he]);const Oe=(0,d.useMemo)((()=>()=>`${_.qP} (${(0,m.uf)(g.default.INTEGER,Ce.length)})`),[Ce]),we=(0,d.useCallback)(((e,t)=>{let r=e,n=t;if(!X)if((0,h.Z)(r).some((e=>(0,_.NA)(e)===_.qP)))Ze?r=(0,h.Z)(e).filter((e=>(0,_.NA)(e)!==_.qP)):(r=(0,_.Q8)(Ce,O),n=(0,_.vi)(Ce));else if((0,h.Z)(e).length===Ce.length&&Ze){const e=Ce.filter((e=>(0,_.Gq)(e.value,ee)&&e.disabled));r=(0,_.Q8)(e,O),n=(0,_.vi)(e)}null==M||M(r,n)}),[X,O,M,Ce,Ze,ee]);(0,d.useEffect)((()=>{if(de!==pe){const e=(0,h.Z)(ee),t=new Set(e.map(_.NA)),r=(0,_.vi)(Te.filter((e=>t.has(e.value))));X?we(ee,ee?r[0]:void 0):we(e,r)}}),[Te,we,X,M,de,pe,ee]);const Ie=(0,d.useMemo)((()=>Re||(0,_.$)(V)),[Re,V]),Ne=(0,d.useMemo)((()=>(0,h.Z)(ee).length-le-(Ze?1:0)),[le,Ze,ee]);let De=le;"responsive"!==De&&0===Ne&&Ze&&(De-=1);const Le=(0,d.useCallback)((e=>{const t=(0,_.Rl)(e,Te,!0);if(O){const r={label:e,value:e};return t&&(r.label=(0,_.Kn)(t)?t.label:t,r.value=(0,_.Kn)(t)?t.value:t),r}return t?(0,_.Kn)(t)?t.value:t:e}),[Te,O]);return(0,T.tZ)(b.PQ,{headerPosition:Z},R&&(0,T.tZ)(b.eb,{headerPosition:Z},R),(0,T.tZ)(b.Qr,(0,n.Z)({allowClear:!oe&&r,"aria-label":l||N,autoClearSearchValue:S,dropdownRender:e=>(0,_.RI)(e,ie,oe,Te.length,A),filterOption:(e,t)=>(0,_.Dz)(e,t,q,C),filterSort:ve,getPopupContainer:G||(e=>e.parentNode),headerPosition:Z,labelInValue:O,maxTagCount:De,maxTagPlaceholder:()=>`+ ${Ne>0?Ne:1} ...`,mode:me,notFoundContent:oe?(0,u.t)("Loading..."):D,onBlur:e=>{ne(""),null==L||L(e)},onDeselect:(e,t)=>{if(Array.isArray(ee))if((0,_.NA)(e)===(0,_.NA)(_.qP))Ae();else{let r=ee;r=r.filter((t=>(0,_.NA)(t)!==(0,_.NA)(e))),Ze&&!t.isNewOption&&(r=r.filter((e=>(0,_.NA)(e)!==_.qP))),te(r),t.isNewOption&&Ee(Te.filter((t=>(0,_.NA)(t.value)!==(0,_.NA)(e))))}he(),null==U||U(e,t)},onDropdownVisibleChange:e=>{se(e),e&&!re&&ye.length>1&&(s()(be,ye)||Ee(be)),P&&P(e)},onPaste:e=>{const t=e.clipboardData.getData("text");if(X)te(Le(t));else{const e=z.find((e=>t.includes(e))),r=(e?a()(t.split(e)):[t]).map((e=>Le(e)));te((e=>[...e||[],...r]))}he()},onPopupScroll:void 0,onSearch:J?xe:void 0,onSelect:(e,t)=>{te(X?e:t=>{const r=(0,h.Z)(t),n=(0,_.NA)(e);if(n===(0,_.NA)(_.qP))return(0,_.nq)(e)?[...Ce,_.tP]:[_.qP,...Ce.map((e=>e.value))];if(!(0,_.Gq)(n,r)){const t=[...r,e];return t.length===Ce.length&&Re?(0,_.nq)(e)?[...t,_.tP]:[...t,_.qP]:t}return t}),he(),null==F||F(e,t)},onClear:()=>{Ae(),k&&k()},placeholder:B,showSearch:J,showArrow:!0,tokenSeparators:z,value:ee,suffixIcon:(0,_.AI)(oe,J,ie),menuItemSelectedIcon:x?(0,T.tZ)(b.F6,{iconSize:"m","aria-label":"stop"}):(0,T.tZ)(b.Y1,{iconSize:"m","aria-label":"check"}),options:Ie?void 0:Te,oneLine:Y,tagRender:E.Z},K,{ref:t}),Re&&(0,T.tZ)(ge,{id:"select-all",className:"select-all",key:_.qP,value:_.qP},Oe()),Ie&&(0,_.PO)(Te)))}))},26579:(e,t,r)=>{"use strict";r.d(t,{L8:()=>i,Ns:()=>s,DW:()=>a,pM:()=>n,pp:()=>o});const n=4,o=[",","\r\n","\n","\t",";"],a=[],i=100,s=(e,t,r)=>{let n,o;return"string"==typeof e.label&&"string"==typeof t.label?(n=e.label,o=t.label):"string"==typeof e.value&&"string"==typeof t.value&&(n=e.value,o=t.value),"string"==typeof n&&"string"==typeof o?r?function(e,t,r){const n=e.toLowerCase()||"",o=t.toLowerCase()||"",a=r.toLowerCase()||"";return r&&(Number(t===r)-Number(e===r)||Number(t.startsWith(r))-Number(e.startsWith(r))||Number(o===a)-Number(n===a)||Number(o.startsWith(a))-Number(n.startsWith(a))||Number(t.includes(r))-Number(e.includes(r))||Number(o.includes(a))-Number(e.includes(a)))||e.localeCompare(t)}(n,o,r):n.localeCompare(o):e.value-t.value}},47767:(e,t,r)=>{"use strict";r.d(t,{BD:()=>v,F6:()=>p,H$:()=>m,PQ:()=>c,Qr:()=>d,SC:()=>g,Vv:()=>_,WC:()=>u,Y1:()=>h,eb:()=>l,oz:()=>f});var n=r(51995),o=r(70707),a=r(60331),i=r(11382),s=r(64749);const l=n.iK.span`
  ${e=>{let{theme:t,headerPosition:r}=e;return`\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    margin-right: ${"left"===r?2*t.gridUnit:0}px;\n  `}}
`,c=n.iK.div`
  ${e=>{let{headerPosition:t}=e;return`\n    display: flex;\n    flex-direction: ${"top"===t?"column":"row"};\n    align-items: ${"left"===t?"center":void 0};\n    width: 100%;\n  `}}
`,d=(0,n.iK)(s.default,{shouldForwardProp:e=>"headerPosition"!==e&&"oneLine"!==e})`
  ${e=>{let{theme:t,headerPosition:r,oneLine:n}=e;return`\n    flex: ${"left"===r?1:0};\n    && .ant-select-selector {\n      border-radius: ${t.gridUnit}px;\n    }\n    // Open the dropdown when clicking on the suffix\n    // This is fixed in version 4.16\n    .ant-select-arrow .anticon:not(.ant-select-suffix) {\n      pointer-events: none;\n    }\n    .select-all {\n      border-bottom: 1px solid ${t.colors.grayscale.light3};\n    }\n    ${n&&`\n        .ant-select-selection-overflow {\n          flex-wrap: nowrap;\n        }\n\n        .ant-select-selection-overflow-item:not(.ant-select-selection-overflow-item-rest):not(.ant-select-selection-overflow-item-suffix) {\n          flex-shrink: 1;\n          min-width: ${13*t.gridUnit}px;\n        }\n\n        .ant-select-selection-overflow-item-suffix {\n          flex: unset;\n          min-width: 0px;\n        }\n      `};\n `}}
`,u=n.iK.span`
  display: none;
`,p=((0,n.iK)(a.Z)`
  ${e=>{let{theme:t}=e;return`\n    background: ${t.colors.grayscale.light3};\n    font-size: ${t.typography.sizes.m}px;\n    border: none;\n  `}}
`,(0,n.iK)(o.Z.StopOutlined)`
  vertical-align: 0;
`),h=(0,n.iK)(o.Z.CheckOutlined)`
  vertical-align: 0;
`,m=(0,n.iK)(i.Z)`
  margin-top: ${e=>{let{theme:t}=e;return-t.gridUnit}}px;
`,g=n.iK.div`
  ${e=>{let{theme:t}=e;return`\n   margin-left: ${3*t.gridUnit}px;\n   line-height: ${8*t.gridUnit}px;\n   color: ${t.colors.grayscale.light1};\n `}}
`,f=n.iK.div`
  ${e=>{let{theme:t}=e;return`\n   padding: ${2*t.gridUnit}px ${3*t.gridUnit}px;\n   color: ${t.colors.grayscale.base};\n   font-size: ${t.typography.sizes.s}px;\n   cursor: default;\n   border-bottom: 1px solid ${t.colors.grayscale.light2};\n `}}
`,v=n.iK.div`
  ${e=>{let{theme:t}=e;return`\n    display: flex;\n    justify-content: center;\n    align-items: flex-start;\n    width: 100%;\n    padding: ${2*t.gridUnit}px;\n    color: ${t.colors.error.base};\n    & svg {\n      margin-right: ${2*t.gridUnit}px;\n    }\n  `}}
`,_=n.iK.div`
  overflow: hidden;
  text-overflow: ellipsis;
`},85633:(e,t,r)=>{"use strict";r.d(t,{$:()=>Z,AI:()=>S,Dz:()=>R,Gq:()=>_,Kn:()=>m,NA:()=>f,PO:()=>A,Q8:()=>x,RI:()=>C,Rl:()=>v,Sl:()=>T,Y1:()=>y,mj:()=>b,nq:()=>g,qP:()=>p,tP:()=>h,tj:()=>E,vi:()=>O});var n=r(73126),o=r(55786),a=r(61988),i=r(64749),s=r(67294),l=r(70707),c=r(47767),d=r(11965);const{Option:u}=i.default,p="Select All",h={value:p,label:String(p)};function m(e){return null!==e&&"object"==typeof e&&!1===Array.isArray(e)}function g(e){return m(e)&&"value"in e&&"label"in e}function f(e){return g(e)?e.value:e}function v(e,t,r){return void 0===r&&(r=!1),(0,o.Z)(t).find((t=>t==e||m(t)&&("value"in t&&t.value==e||r&&"label"in t&&t.label===e)))}function _(e,t,r){return void 0===r&&(r=!1),void 0!==v(e,t,r)}const b=e=>(t,r)=>"string"==typeof t[e]&&"string"==typeof r[e]?t[e].localeCompare(r[e]):t[e]-r[e],y=(e,t,r)=>r&&void 0!==e.value&&void 0!==t.value?Number(_(t.value,r))-Number(_(e.value,r)):0,E=(e,t,r,n,o)=>n(e,t)||o(e,t,r),T=(e,t,r,n)=>r(e,t)||n(e,t,""),S=(e,t,r)=>e?(0,d.tZ)(c.H$,{size:"small"}):t&&r?(0,d.tZ)(l.Z.SearchOutlined,{iconSize:"s"}):(0,d.tZ)(l.Z.DownOutlined,{iconSize:"s"}),C=(e,t,r,n,o,i)=>{var l,u;return t||null==(l=e.ref)||null==(u=l.current)||u.scrollTo({top:0}),r&&0===n?(0,d.tZ)(c.SC,null,(0,a.t)("Loading...")):i||(0,d.tZ)(s.Fragment,null,o&&(0,d.tZ)(c.oz,{role:"note"},o),e)},R=(e,t,r,n)=>{if("function"==typeof n)return n(e,t);if(n){const n=e.trim().toLowerCase();if(null!=r&&r.length)return r.some((e=>(null!=t&&t[e]?String(t[e]).trim().toLowerCase():"").includes(n)))}return!1},Z=e=>null==e?void 0:e.some((e=>!(null==e||!e.customLabel))),A=e=>e.map((e=>{const t="object"==typeof e,r=t?(null==e?void 0:e.label)||e.value:e,o=t?e.value:e,{customLabel:a,...i}=e;return(0,d.tZ)(u,(0,n.Z)({},i,{key:o,label:r,value:o}),t&&a?a:r)})),x=(e,t)=>t?e.map((e=>({key:e.value,value:e.value,label:e.label}))):e.map((e=>e.value)),O=e=>e.map((e=>({children:e.label,key:e.value,...e})))},97754:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(73126),o=r(67294),a=r(94184),i=r.n(a),s=r(51995),l=r(70707),c=r(11965);const d=s.iK.table`
  ${e=>{let{theme:t}=e;return`\n    background-color: ${t.colors.grayscale.light5};\n    border-collapse: separate;\n    border-radius: ${t.borderRadius}px;\n\n    thead > tr > th {\n      border: 0;\n    }\n\n    tbody {\n      tr:first-of-type > td {\n        border-top: 0;\n      }\n    }\n    th {\n      background: ${t.colors.grayscale.light5};\n      position: sticky;\n      top: 0;\n\n      &:first-of-type {\n        padding-left: ${4*t.gridUnit}px;\n      }\n\n      &.xs {\n        min-width: 25px;\n      }\n      &.sm {\n        min-width: 50px;\n      }\n      &.md {\n        min-width: 75px;\n      }\n      &.lg {\n        min-width: 100px;\n      }\n      &.xl {\n        min-width: 150px;\n      }\n      &.xxl {\n        min-width: 200px;\n      }\n\n      span {\n        white-space: nowrap;\n        display: flex;\n        align-items: center;\n        line-height: 2;\n      }\n\n      svg {\n        display: inline-block;\n        position: relative;\n      }\n    }\n\n    td {\n      &.xs {\n        width: 25px;\n      }\n      &.sm {\n        width: 50px;\n      }\n      &.md {\n        width: 75px;\n      }\n      &.lg {\n        width: 100px;\n      }\n      &.xl {\n        width: 150px;\n      }\n      &.xxl {\n        width: 200px;\n      }\n    }\n\n    .table-cell-loader {\n      position: relative;\n\n      .loading-bar {\n        background-color: ${t.colors.secondary.light4};\n        border-radius: 7px;\n\n        span {\n          visibility: hidden;\n        }\n      }\n\n      .empty-loading-bar {\n        display: inline-block;\n        width: 100%;\n        height: 1.2em;\n      }\n    }\n\n    .actions {\n      white-space: nowrap;\n      min-width: 100px;\n\n      svg,\n      i {\n        margin-right: 8px;\n\n        &:hover {\n          path {\n            fill: ${t.colors.primary.base};\n          }\n        }\n      }\n    }\n\n    .table-row {\n      .actions {\n        opacity: 0;\n        font-size: ${t.typography.sizes.xl}px;\n        display: flex;\n      }\n\n      &:hover {\n        background-color: ${t.colors.secondary.light5};\n\n        .actions {\n          opacity: 1;\n          transition: opacity ease-in ${t.transitionTiming}s;\n        }\n      }\n    }\n\n    .table-row-selected {\n      background-color: ${t.colors.secondary.light4};\n\n      &:hover {\n        background-color: ${t.colors.secondary.light4};\n      }\n    }\n\n    .table-cell {\n      font-feature-settings: 'tnum' 1;\n      text-overflow: ellipsis;\n      overflow: hidden;\n      max-width: 320px;\n      line-height: 1;\n      vertical-align: middle;\n      &:first-of-type {\n        padding-left: ${4*t.gridUnit}px;\n      }\n      &__wrap {\n        white-space: normal;\n      }\n      &__nowrap {\n        white-space: nowrap;\n      }\n    }\n\n    @keyframes loading-shimmer {\n      40% {\n        background-position: 100% 0;\n      }\n\n      100% {\n        background-position: 100% 0;\n      }\n    }\n  `}}
`;d.displayName="table";const u=o.memo((e=>{let{getTableProps:t,getTableBodyProps:r,prepareRow:o,headerGroups:a,columns:s,rows:u,loading:p,highlightRowId:h,columnsForWrapText:m}=e;return(0,c.tZ)(d,(0,n.Z)({},t(),{className:"table table-hover"}),(0,c.tZ)("thead",null,a.map((e=>(0,c.tZ)("tr",e.getHeaderGroupProps(),e.headers.map((e=>{let t=(0,c.tZ)(l.Z.Sort,null);return e.isSorted&&e.isSortedDesc?t=(0,c.tZ)(l.Z.SortDesc,null):e.isSorted&&!e.isSortedDesc&&(t=(0,c.tZ)(l.Z.SortAsc,null)),e.hidden?null:(0,c.tZ)("th",(0,n.Z)({},e.getHeaderProps(e.canSort?e.getSortByToggleProps():{}),{className:i()({[e.size||""]:e.size})}),(0,c.tZ)("span",null,e.render("Header"),e.canSort&&t))})))))),(0,c.tZ)("tbody",r(),p&&0===u.length&&[...new Array(12)].map(((e,t)=>(0,c.tZ)("tr",{key:t},s.map(((e,t)=>e.hidden?null:(0,c.tZ)("td",{key:t,className:i()("table-cell",{"table-cell-loader":p})},(0,c.tZ)("span",{className:"loading-bar empty-loading-bar",role:"progressbar","aria-label":"loading"}))))))),u.length>0&&u.map((e=>{o(e);const t=e.original.id;return(0,c.tZ)("tr",(0,n.Z)({},e.getRowProps(),{className:i()("table-row",{"table-row-selected":e.isSelected||void 0!==t&&t===h})}),e.cells.map((e=>{if(e.column.hidden)return null;const t=e.column.cellProps||{},r=null==m?void 0:m.includes(e.column.Header);return(0,c.tZ)("td",(0,n.Z)({className:i()("table-cell table-cell__"+(r?"wrap":"nowrap"),{"table-cell-loader":p,[e.column.size||""]:e.column.size})},e.getCellProps(),t),(0,c.tZ)("span",{className:i()({"loading-bar":p}),role:p?"progressbar":void 0},(0,c.tZ)("span",null,e.render("Cell"))))})))}))))}))},46977:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b,u:()=>n});var n,o=r(73126),a=r(67294),i=r(18446),s=r.n(i),l=r(51995),c=r(61988),d=r(79521),u=r(4715),p=r(64158),h=r(97754),m=r(11965);!function(e){e.Default="Default",e.Small="Small"}(n||(n={}));const g=l.iK.div`
  margin: ${e=>{let{theme:t}=e;return 40*t.gridUnit}}px 0;
`,f=l.iK.div`
  ${e=>{let{scrollTable:t,theme:r}=e;return t&&`\n    flex: 1 1 auto;\n    margin-bottom: ${4*r.gridUnit}px;\n    overflow: auto;\n  `}}

  .table-row {
    ${e=>{let{theme:t,small:r}=e;return!r&&`height: ${11*t.gridUnit-1}px;`}}

    .table-cell {
      ${e=>{let{theme:t,small:r}=e;return r&&`\n        padding-top: ${t.gridUnit+1}px;\n        padding-bottom: ${t.gridUnit+1}px;\n        line-height: 1.45;\n      `}}
    }
  }

  th[role='columnheader'] {
    z-index: 1;
    border-bottom: ${e=>{let{theme:t}=e;return`${t.gridUnit-2}px solid ${t.colors.grayscale.light2}`}};
    ${e=>{let{small:t}=e;return t&&"padding-bottom: 0;"}}
  }
`,v=l.iK.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light5}};

  ${e=>{let{isPaginationSticky:t}=e;return t&&"\n        position: sticky;\n        bottom: 0;\n        left: 0;\n    "}};

  .row-count-container {
    margin-top: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  }
`,_=e=>{let{columns:t,data:r,pageSize:i,totalCount:l=r.length,initialPageIndex:_,initialSortBy:b=[],loading:y=!1,withPagination:E=!0,emptyWrapperType:T=n.Default,noDataText:S,showRowCount:C=!0,serverPagination:R=!1,columnsForWrapText:Z,onServerPagination:A=(()=>{}),scrollTopOnPagination:x=!1,...O}=e;const w={pageSize:null!=i?i:10,pageIndex:null!=_?_:0,sortBy:b},{getTableProps:I,getTableBodyProps:N,headerGroups:D,page:L,rows:M,prepareRow:k,pageCount:P,gotoPage:U,state:{pageIndex:$,pageSize:F,sortBy:q}}=(0,d.useTable)({columns:t,data:r,initialState:w,manualPagination:R,manualSortBy:R,pageCount:Math.ceil(l/w.pageSize)},d.useFilters,d.useSortBy,d.usePagination),V=E?L:M;let B;switch(T){case n.Small:B=e=>{let{children:t}=e;return(0,m.tZ)(a.Fragment,null,t)};break;case n.Default:default:B=e=>{let{children:t}=e;return(0,m.tZ)(g,null,t)}}const H=!y&&0===V.length,j=P>1&&E,z=(0,a.useRef)(null);return(0,a.useEffect)((()=>{R&&$!==w.pageIndex&&A({pageIndex:$})}),[$]),(0,a.useEffect)((()=>{R&&!s()(q,w.sortBy)&&A({pageIndex:0,sortBy:q})}),[q]),(0,m.tZ)(a.Fragment,null,(0,m.tZ)(f,(0,o.Z)({},O,{ref:z}),(0,m.tZ)(h.Z,{getTableProps:I,getTableBodyProps:N,prepareRow:k,headerGroups:D,rows:V,columns:t,loading:y,columnsForWrapText:Z}),H&&(0,m.tZ)(B,null,S?(0,m.tZ)(u.HY,{image:u.HY.PRESENTED_IMAGE_SIMPLE,description:S}):(0,m.tZ)(u.HY,{image:u.HY.PRESENTED_IMAGE_SIMPLE}))),j&&(0,m.tZ)(v,{className:"pagination-container",isPaginationSticky:O.isPaginationSticky},(0,m.tZ)(p.Z,{totalPages:P||0,currentPage:P?$+1:0,onChange:e=>(e=>{var t;x&&(null==z||null==(t=z.current)||t.scroll(0,0)),U(e)})(e-1),hideFirstAndLastPageLinks:!0}),C&&(0,m.tZ)("div",{className:"row-count-container"},!y&&(0,c.t)("%s-%s of %s",F*$+(L.length&&1),F*$+L.length,l))))},b=a.memo(_)},76962:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n.Z,u:()=>n.u});var n=r(46977)},71262:(e,t,r)=>{"use strict";r.d(t,{Xv:()=>h,cl:()=>g,ZP:()=>f});var n=r(73126),o=(r(67294),r(11965)),a=r(51995),i=r(20838),s=r(70707);const l=e=>{let{animated:t=!1,fullWidth:r=!0,allowOverflow:a=!0,...s}=e;return(0,o.tZ)(i.default,(0,n.Z)({animated:t},s,{css:e=>o.iv`
      overflow: ${a?"visible":"hidden"};

      .ant-tabs-content-holder {
        overflow: ${a?"visible":"auto"};
      }
      .ant-tabs-tab {
        flex: 1 1 auto;
        &.ant-tabs-tab-active .ant-tabs-tab-btn {
          color: inherit;
        }
        &:hover {
          .anchor-link-container {
            cursor: pointer;
            .fa.fa-link {
              visibility: visible;
            }
          }
        }
        .short-link-trigger.btn {
          padding: 0 ${e.gridUnit}px;
          & > .fa.fa-link {
            top: 0;
          }
        }
      }
      ${r&&o.iv`
        .ant-tabs-nav-list {
          width: 100%;
        }
      `};

      .ant-tabs-tab-btn {
        display: flex;
        flex: 1 1 auto;
        align-items: center;
        justify-content: center;
        font-size: ${e.typography.sizes.s}px;
        text-align: center;
        text-transform: uppercase;
        user-select: none;
        .required {
          margin-left: ${e.gridUnit/2}px;
          color: ${e.colors.error.base};
        }
      }
      .ant-tabs-ink-bar {
        background: ${e.colors.secondary.base};
      }
    `}))},c=(0,a.iK)(i.default.TabPane)``,d=Object.assign(l,{TabPane:c}),u=(0,a.iK)(l)`
  ${e=>{let{theme:t,fullWidth:r}=e;return`\n    .ant-tabs-content-holder {\n      background: ${t.colors.grayscale.light5};\n    }\n\n    & > .ant-tabs-nav {\n      margin-bottom: 0;\n    }\n\n    .ant-tabs-tab-remove {\n      padding-top: 0;\n      padding-bottom: 0;\n      height: ${6*t.gridUnit}px;\n    }\n\n    ${r?o.iv`
            .ant-tabs-nav-list {
              width: 100%;
            }
          `:""}\n  `}}
`,p=(0,a.iK)(s.Z.CancelX)`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
`,h=Object.assign(u,{TabPane:c});h.defaultProps={type:"editable-card",fullWidth:!1,animated:{inkBar:!0,tabPane:!1}},h.TabPane.defaultProps={closeIcon:(0,o.tZ)(p,{role:"button",tabIndex:0})};const m=(0,a.iK)(h)`
  &.ant-tabs-card > .ant-tabs-nav .ant-tabs-tab {
    margin: 0 ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    padding: ${e=>{let{theme:t}=e;return`${3*t.gridUnit}px ${t.gridUnit}px`}};
    background: transparent;
    border: none;
  }

  &.ant-tabs-card > .ant-tabs-nav .ant-tabs-ink-bar {
    visibility: visible;
  }

  .ant-tabs-tab-btn {
    font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.m}}px;
  }

  .ant-tabs-tab-remove {
    margin-left: 0;
    padding-right: 0;
  }

  .ant-tabs-nav-add {
    min-width: unset !important;
    background: transparent !important;
    border: none !important;
  }
`,g=Object.assign(m,{TabPane:c}),f=d},58593:(e,t,r)=>{"use strict";r.d(t,{u:()=>l});var n=r(73126),o=r(67294),a=r(51995),i=r(11965),s=r(31097);const l=e=>{const t=(0,a.Fg)();return(0,i.tZ)(o.Fragment,null,(0,i.tZ)(i.xB,{styles:i.iv`
          .ant-tooltip-open {
            display: inline-block;
            &::after {
              content: '';
              display: block;
            }
          }
          .ant-tooltip-inner > p {
            margin: 0;
          }
        `}),(0,i.tZ)(s.Z,(0,n.Z)({overlayStyle:{fontSize:t.typography.sizes.s,lineHeight:"1.6"},overlayInnerStyle:{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:40,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},color:`${t.colors.grayscale.dark2}e6`},e)))}},29147:(e,t,r)=>{"use strict";r.d(t,{DG:()=>c,fG:()=>l});var n=r(67294),o=r(27600),a=r(23525),i=r(11965);const s=(0,n.createContext)({hideTitle:!1,hideTab:!1,hideNav:!1,hideChartControls:!1}),l=()=>(0,n.useContext)(s),c=e=>{let{children:t}=e;const r=(0,a.eY)(o.KD.uiConfig)||0,[l]=(0,n.useState)({hideTitle:0!=(1&r),hideTab:0!=(2&r),hideNav:0!=(4&r),hideChartControls:0!=(8&r)});return(0,i.tZ)(s.Provider,{value:l},t)}},86057:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(11965),o=(r(67294),r(51995)),a=r(78186),i=r(70707),s=r(58593);const l=function(e){let{warningMarkdown:t,size:r,marginRight:l}=e;const c=(0,o.Fg)();return(0,n.tZ)(s.u,{id:"warning-tooltip",title:(0,n.tZ)(a.Z,{source:t})},(0,n.tZ)(i.Z.AlertSolid,{iconColor:c.colors.alert.base,iconSize:r,css:(0,n.iv)({marginRight:null!=l?l:2*c.gridUnit},"","")}))}},4715:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>E.Z,C0:()=>y.Z,D6:()=>I.Z,Gj:()=>C.Z,Grid:()=>c.ZP,HY:()=>l.Z,IZ:()=>x.Z,JX:()=>i.Z,KU:()=>w.Z,O5:()=>b.Z,Od:()=>p.Z,Ol:()=>S.Z,Ph:()=>n.Z,Rg:()=>m.Z,T:()=>h.Z,Vp:()=>g.Z,X2:()=>u.Z,ZT:()=>v.Z,_e:()=>N.Z,aV:()=>d.ZP,gq:()=>_.Z,iz:()=>s.Z,mp:()=>f.Z,oc:()=>Z.Z,qE:()=>a.C,qb:()=>o.Z,qz:()=>R.Z,r4:()=>T.Z,rb:()=>O.Z,xT:()=>A.Z});var n=r(81315),o=r(84101),a=r(51890),i=r(15746),s=r(27049),l=r(14277),c=r(75302),d=r(8243),u=r(71230),p=r(33860),h=r(19650),m=r(27220),g=r(60331),f=r(6802),v=r(16809),_=r(81306),b=r(35247),y=r(71577),E=r(39144),T=r(9676),S=r(46445),C=r(13013),R=r(33746),Z=r(77808),A=r(99441),x=r(8834),O=r(31955),w=r(59314),I=r(73453),N=r(31097)},41295:(e,t,r)=>{"use strict";r.d(t,{$A:()=>u,C6:()=>b,Fl:()=>v,Jy:()=>m,Mi:()=>g,Mn:()=>_,a8:()=>h,fO:()=>p,nH:()=>f});var n=r(47037),o=r.n(n),a=r(28062),i=r(22102),s=r(61988),l=r(98286),c=r(72570),d=r(9467);const u="DASHBOARD_INFO_UPDATED";function p(e,t){const r=a.getNamespace(null==e?void 0:e.color_namespace),n=o()(t)?JSON.parse(t):t;Object.keys(n).forEach((e=>{r.setColor(e,n[e])}))}function h(e){const{metadata:t}=e;return a.getNamespace(null==t?void 0:t.color_namespace).resetColors(),null!=t&&t.shared_label_colors&&p(t,null==t?void 0:t.shared_label_colors),null!=t&&t.label_colors&&p(t,null==t?void 0:t.label_colors),{type:u,newInfo:e}}const m="SAVE_CHART_CONFIG_COMPLETE",g=e=>{let{chartConfiguration:t,globalChartConfiguration:r}=e;return async(e,n)=>{e({type:"SAVE_CHART_CONFIG_BEGIN",chartConfiguration:t,globalChartConfiguration:r});const{id:o,metadata:a}=n().dashboardInfo,l=(0,i.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${o}`});try{const n=await l({json_metadata:JSON.stringify({...a,chart_configuration:null!=t?t:a.chart_configuration,global_chart_configuration:null!=r?r:a.global_chart_configuration})});e(h({metadata:JSON.parse(n.result.json_metadata)})),e({type:m,chartConfiguration:t,globalChartConfiguration:r})}catch(n){e({type:"SAVE_CHART_CONFIG_FAIL",chartConfiguration:t,globalChartConfiguration:r}),e((0,c.Gb)((0,s.t)("Failed to save cross-filter scoping")))}}},f="SET_FILTER_BAR_ORIENTATION",v="SET_CROSS_FILTERS_ENABLED";function _(e){return async(t,r)=>{const{id:n,metadata:o}=r().dashboardInfo,a=(0,i.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await a({json_metadata:JSON.stringify({...o,filter_bar_orientation:e})}),n=r.result,i=r.last_modified_time;if(n.json_metadata){const e=JSON.parse(n.json_metadata);e.filter_bar_orientation&&t((s=e.filter_bar_orientation,{type:f,filterBarOrientation:s}))}i&&t((0,d.Vv)(i))}catch(e){const r=await(0,l.HR)(e,"dashboard");throw t((0,c.Gb)(r)),e}var s}}function b(e){return async(t,r)=>{const{id:n,metadata:o}=r().dashboardInfo,a=(0,i.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await a({json_metadata:JSON.stringify({...o,cross_filters_enabled:e})}),n=r.result,i=r.last_modified_time;n.json_metadata&&t(function(e){return{type:v,crossFiltersEnabled:e}}(JSON.parse(n.json_metadata).cross_filters_enabled)),i&&t((0,d.Vv)(i))}catch(e){const r=await(0,l.HR)(e,"dashboard");throw t((0,c.Gb)(r)),e}}}},50810:(e,t,r)=>{"use strict";r.d(t,{Fy:()=>a,QR:()=>s,Rn:()=>n});var n,o=r(31069);function a(e){return{type:n.SET_DATASOURCES,datasources:e}}function i(e,t){return{type:n.SET_DATASOURCE,key:t,datasource:e}}function s(e){return(t,r)=>{const{datasources:n}=r(),a=n[e];return a?t(i(a,e)):o.Z.get({endpoint:`/superset/fetch_datasource_metadata?datasourceKey=${e}`}).then((r=>{let{json:n}=r;return t(i(n,e))}))}}!function(e){e.SET_DATASOURCES="SET_DATASOURCES",e.SET_DATASOURCE="SET_DATASOURCE"}(n||(n={}))},52794:(e,t,r)=>{"use strict";r.d(t,{$7:()=>b,$l:()=>f,DU:()=>C,RY:()=>u,T6:()=>_,TT:()=>T,Up:()=>y,X8:()=>v,Zp:()=>d,jE:()=>E,kN:()=>c,pi:()=>h,qN:()=>S,qe:()=>l,ql:()=>g,rF:()=>Z,rR:()=>R,xQ:()=>m,xk:()=>p});var n=r(50361),o=r.n(n),a=r(22102),i=r(74599),s=r(41295);const l="SET_FILTER_CONFIG_COMPLETE",c="SET_IN_SCOPE_STATUS_OF_FILTERS",d="SET_FILTER_SETS_COMPLETE",u=e=>async(t,r)=>{var n;t({type:"SET_FILTER_CONFIG_BEGIN",filterConfig:e});const{id:o,metadata:c}=r().dashboardInfo,d=null==(n=r().nativeFilters)?void 0:n.filters,u=(0,a.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${o}`}),p=e.map((e=>{const t=d[e.id];return t?{...t,...e}:e}));try{const e=await u({json_metadata:JSON.stringify({...c,native_filter_configuration:p})});t((0,s.a8)({metadata:JSON.parse(e.result.json_metadata)})),t({type:l,filterConfig:p}),t((0,i.Ft)(p,d))}catch(e){t({type:"SET_FILTER_CONFIG_FAIL",filterConfig:p}),t({type:i.u3,filterConfig:p})}},p=e=>async(t,r)=>{var n;const a=null==(n=r().nativeFilters)?void 0:n.filters,i=e.map((e=>({...a[e.filterId],chartsInScope:e.chartsInScope,tabsInScope:e.tabsInScope})));t({type:c,filterConfig:i});const l=o()(r().dashboardInfo.metadata),d=l.native_filter_configuration.map((e=>{const t=i.find((t=>t.id===e.id));return t?{...t,...e}:e}));l.native_filter_configuration=d,t((0,s.a8)({metadata:l}))},h=e=>async t=>{const r=(0,a.Z)({method:"GET",endpoint:`/api/v1/dashboard/${e}/filtersets`});t({type:"SET_FILTER_SETS_BEGIN"});const n=await r(null);t({type:d,filterSets:n.ids.map(((e,t)=>({...n.result[t].params,id:e,name:n.result[t].name})))})},m=e=>async(t,r)=>{const n=r().dashboardInfo.id,o=(0,a.Z)({method:"POST",endpoint:`/api/v1/dashboard/${n}/filtersets`});t({type:"CREATE_FILTER_SET_BEGIN"});const i={...e};delete i.name,await o({name:e.name,owner_type:"Dashboard",owner_id:n,json_metadata:JSON.stringify(i)}),t({type:"CREATE_FILTER_SET_COMPLETE"}),t(h(n))},g=e=>async(t,r)=>{const n=r().dashboardInfo.id,o=(0,a.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${n}/filtersets/${e.id}`});t({type:"UPDATE_FILTER_SET_BEGIN"});const i={...e};delete i.id,delete i.name,await o({name:e.name,json_metadata:JSON.stringify(i)}),t({type:"UPDATE_FILTER_SET_COMPLETE"}),t(h(n))},f=e=>async(t,r)=>{const n=r().dashboardInfo.id,o=(0,a.Z)({method:"DELETE",endpoint:`/api/v1/dashboard/${n}/filtersets/${e}`});t({type:"DELETE_FILTER_SET_BEGIN"}),await o({}),t({type:"DELETE_FILTER_SET_COMPLETE"}),t(h(n))},v="SET_FOCUSED_NATIVE_FILTER",_="UNSET_FOCUSED_NATIVE_FILTER";function b(e){return{type:v,id:e}}function y(){return{type:_}}const E="SET_HOVERED_NATIVE_FILTER",T="UNSET_HOVERED_NATIVE_FILTER";function S(e){return{type:E,id:e}}function C(){return{type:T}}const R="UPDATE_CASCADE_PARENT_IDS";function Z(e,t){return{type:R,id:e,parentIds:t}}},38523:(e,t,r)=>{"use strict";r.d(t,{D2:()=>h,EO:()=>p,Ff:()=>f,JV:()=>u,cK:()=>m,ex:()=>v});var n=r(15926),o=r.n(n),a=r(93185),i=r(31069),s=r(61988),l=r(72570),c=r(98286);const d=200,u="ADD_SLICES",p="SET_SLICES",h="FETCH_ALL_SLICES_STARTED",m="FETCH_ALL_SLICES_FAILED",g=e=>e.reduce(((e,t)=>{let r=JSON.parse(t.params);var n,o;return r={...r,datasource:(n=t.datasource_id,o=t.datasource_type,`${n}__${o}`||r.datasource)},{...e,[t.id]:{slice_id:t.id,slice_url:t.url,slice_name:t.slice_name,form_data:r,datasource_name:t.datasource_name_text,datasource_url:t.datasource_url,datasource_id:t.datasource_id,datasource_type:t.datasource_type,changed_on:new Date(t.changed_on_utc).getTime(),description:t.description,description_markdown:t.description_markeddown,viz_type:t.viz_type,modified:t.changed_on_delta_humanized,changed_on_humanized:t.changed_on_delta_humanized,thumbnail_url:t.thumbnail_url,owners:t.owners,created_by:t.created_by}}}),{});function f(e){return t=>{t(function(e){return{type:p,payload:{slices:e}}}(e))}}function v(e,t,r){return void 0===r&&(r="changed_on"),n=>{n({type:h});const p=t?[{col:"slice_name",opr:"chart_all_text",value:t}]:[];return(0,a.cr)(a.TT.DASHBOARD_NATIVE_FILTERS)&&p.push({col:"viz_type",opr:"neq",value:"filter_box"}),e&&p.push({col:"owners",opr:"rel_m_m",value:e}),i.Z.get({endpoint:`/api/v1/chart/?q=${o().encode({columns:["changed_on_delta_humanized","changed_on_utc","datasource_id","datasource_type","datasource_url","datasource_name_text","description_markeddown","description","id","params","slice_name","thumbnail_url","url","viz_type","owners.id","created_by.id"],filters:p,page_size:d,order_column:"changed_on"===r?"changed_on_delta_humanized":r,order_direction:"changed_on"===r?"desc":"asc"})}`}).then((e=>{let{json:t}=e;const{result:r}=t,o=g(r);return n(function(e){return{type:u,payload:{slices:e}}}(o))})).catch((e=>(0,c.O$)(e).then((e=>{let{error:t}=e;n(function(e){return{type:m,payload:{error:e}}}(t||(0,s.t)("Could not fetch all saved charts"))),n((0,l.Gb)((0,s.t)("Sorry there was an error fetching saved charts: ")+t))}))))}}},92242:(e,t,r)=>{"use strict";r.d(t,{EJ:()=>p,G$:()=>d,GA:()=>u,Ky:()=>m,QN:()=>f,W6:()=>g,rW:()=>h,uh:()=>c});var n=r(14670),o=r.n(n),a=r(8868),i=r(68492),s=r(10916),l=r(80621);const c=function(e,t,r){if(void 0===r&&(r=[]),r.includes(t))return!0;const n=e.get(t);return!!n&&n.some((n=>c(e,n,[...r,t])))},d=async(e,t,r)=>{try{let t;try{t=await e.validateFields()}catch(e){var n;if(null!=e&&null!=(n=e.errorFields)&&n.length||null==e||!e.outOfDate)throw e;t=e.values}return t}catch(e){var o;if(i.Z.warn("Filter configuration failed:",e),null==(o=e.errorFields)||!o.length)return null;const n=e.errorFields;if(!n.some((e=>e.name[1]===t))){const e=n.find((e=>"filters"===e.name[0]));e&&r(e.name[1])}return null}},u=(e,t,r,n,o)=>async()=>{const i=t.filter((e=>!r[e])).map((t=>{var r,n,i,c;const d=null==(r=o.filters)?void 0:r[t];if(!d)return e[t];if(d.type===s.BE.DIVIDER)return{id:t,type:s.BE.DIVIDER,scope:{rootPath:[l._4],excluded:[]},title:d.title,description:d.description};const u={};return d.dataset&&(u.datasetId=d.dataset.value),d.dataset&&d.column&&(u.column={name:d.column}),{id:t,adhoc_filters:d.adhoc_filters,time_range:d.time_range,controlValues:null!=(n=d.controlValues)?n:{},granularity_sqla:d.granularity_sqla,requiredFirst:Object.values(null!=(i=d.requiredFirst)?i:{}).find((e=>e)),name:d.name,filterType:d.filterType,targets:[u],defaultDataMask:null!=(c=d.defaultDataMask)?c:(0,a.H)(),cascadeParentIds:d.dependencies||[],scope:d.scope,sortMetric:d.sortMetric,type:d.type,description:(d.description||"").trim()}}));await n(i)},p=(e,t,r)=>n=>{const o=window.setTimeout((()=>{(r=>{e((e=>({...e,[r]:{isPending:!1}}))),t((e=>e.filter((e=>e!==r))))})(n)}),5e3);e((e=>({...e,[n]:{isPending:!0,timerId:o}}))),r(!1)},h="NATIVE_FILTER-",m="NATIVE_FILTER_DIVIDER-",g=e=>`${e===s.BE.NATIVE_FILTER?h:m}${o().generate()}`,f=e=>e.map((e=>e.id))},1510:(e,t,r)=>{"use strict";r.d(t,{Rz:()=>v,X3:()=>m,on:()=>p,vk:()=>h,zi:()=>u});var n=r(5364),o=r(16355),a=r(93185),i=r(70400),s=r(81255),l=r(80621),c=r(20292);const d=()=>{var e,t;const r=(0,c.Z)();return(null==r||null==(e=r.common)||null==(t=e.conf)?void 0:t.NATIVE_FILTER_DEFAULT_ROW_LIMIT)||1e3},u=e=>{var t;let{datasetId:r,dependencies:n={},groupby:o,defaultDataMask:a,controlValues:s,filterType:l,sortMetric:c,adhoc_filters:u,time_range:p,granularity_sqla:h,type:m,dashboardId:g,id:f}=e;const v={};return r&&(v.datasource=`${r}__table`),o&&(v.groupby=[o]),c&&(v.sortMetric=c),{...s,...v,adhoc_filters:null!=u?u:[],extra_filters:[],extra_form_data:n,granularity_sqla:h,metrics:["count"],row_limit:d(),showSearch:!0,defaultValue:null==a||null==(t=a.filterState)?void 0:t.value,time_range:p,url_params:(0,i.Z)("regular"),inView:!0,viz_type:l,type:m,dashboardId:g,native_filter_id:f}};function p(e,t){void 0===e&&(e={}),void 0===t&&(t={});const r={};return n.Ci.forEach((n=>{const o=[...e[n]||[],...t[n]||[]];o.length&&(r[n]=o)})),n.Ay.forEach((n=>{const o=e[n];void 0!==o&&(r[n]=o);const a=t[n];void 0!==a&&(r[n]=a)})),r}function h(e,t){let r={};return t.forEach((t=>{var n,o;r=p(r,null!=(n=null==(o=e[t])?void 0:o.extraFormData)?n:{})})),r}function m(e){return!e.includes(o.cg.NATIVE_FILTER)||(0,a.cr)(a.TT.DASHBOARD_FILTERS_EXPERIMENTAL)&&(0,a.cr)(a.TT.DASHBOARD_CROSS_FILTERS)&&e.includes(o.cg.INTERACTIVE_CHART)}const g=(e,t)=>{var r;return(null==e||null==(r=e[t])?void 0:r.type)===s.gn},f=(e,t,r,n,o,a)=>{var i,l,c,d,u,p;a.has(r)||(a.add(r),(null==e||null==(i=e[r])?void 0:i.type)===s.dW&&t.includes(null==(l=e[r])||null==(c=l.meta)?void 0:c.chartId)&&n.forEach(o.add,o),0===(null==e||null==(d=e[r])||null==(u=d.children)?void 0:u.length)||g(e,r)&&o.has(r)||null==(p=e[r])||p.children.forEach((r=>f(e,t,r,g(e,r)?[...n,r]:n,o,a))))},v=(e,t)=>{const r=e[l._4].children[0],n=r!==l.PV,o=new Set,a=new Set;var i,c;return n?null==(i=e[r])||null==(c=i.children)||c.forEach((r=>f(e,t,r,[r],o,a))):Object.values(e).filter((e=>(null==e?void 0:e.type)===s.gn)).forEach((r=>f(e,t,r.id,[r.id],o,a))),o}},9531:(e,t,r)=>{"use strict";r.d(t,{I6:()=>l,Ky:()=>i,UN:()=>d,XX:()=>p,a7:()=>u,aF:()=>c,eV:()=>m,gz:()=>s,tw:()=>a,yT:()=>h});var n=r(46078),o=r(80621);const a={id:0,type:n.i9.Table,uid:"_placeholder_",datasource_name:"",table_name:"",columns:[],column_types:[],metrics:[],column_formats:{},currency_formats:{},verbose_map:{},main_dttm_col:"",description:""},i=53,s=32,l=260,c=550,d=80,u=46,p=374,h=["css","json_metadata.filter_scopes"],m={rootPath:[o._4],excluded:[]}},39759:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i,a:()=>a});var n=r(52794),o=r(4305);function a(e){let{filterSetsConfig:t,filterConfig:r,state:n}=e;const o={},a={};var i;if(r?(r.forEach((e=>{const{id:t}=e;a[t]=e})),o.filters=a):o.filters=null!=(i=null==n?void 0:n.filters)?i:{},t){const e={};t.forEach((t=>{const{id:r}=t;e[r]=t})),o.filterSets=e}else{var s;o.filterSets=null!=(s=null==n?void 0:n.filterSets)?s:{}}return o.focusedFilterId=void 0,o}function i(e,t){switch(void 0===e&&(e={filters:{},filterSets:{}}),t.type){case o.$:return{filters:t.data.nativeFilters.filters,filterSets:t.data.nativeFilters.filterSets};case n.qe:case n.kN:return a({filterConfig:t.filterConfig,state:e});case n.Zp:return a({filterSetsConfig:t.filterSets,state:e});case n.X8:return{...e,focusedFilterId:t.id};case n.T6:return{...e,focusedFilterId:void 0};case n.jE:return{...e,hoveredFilterId:t.id};case n.TT:return{...e,hoveredFilterId:void 0};case n.rR:return{...e,filters:{...e.filters,[t.id]:{...e.filters[t.id],cascadeParentIds:t.parentIds}}};default:return e}}},52004:(e,t,r)=>{"use strict";var n;r.d(t,{$:()=>o,Bp:()=>n,_6:()=>a}),function(e){e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL"}(n||(n={}));const o="global",a=e=>e===o},81255:(e,t,r)=>{"use strict";r.d(t,{BA:()=>o,BG:()=>i,F0:()=>u,Nc:()=>c,Os:()=>p,U0:()=>s,Vl:()=>a,ZP:()=>f,dW:()=>n,gn:()=>m,hE:()=>l,t:()=>g,xh:()=>d,yR:()=>h});const n="CHART",o="COLUMN",a="HEADER",i="GRID",s="ROOT",l="DIVIDER",c="HEADER",d="MARKDOWN",u="NEW_COMPONENT_SOURCE",p="ROW",h="TABS",m="TAB",g="DYNAMIC",f={CHART_TYPE:n,COLUMN_TYPE:o,DASHBOARD_HEADER_TYPE:a,DASHBOARD_GRID_TYPE:i,DASHBOARD_ROOT_TYPE:s,DIVIDER_TYPE:l,HEADER_TYPE:c,MARKDOWN_TYPE:d,NEW_COMPONENT_SOURCE_TYPE:u,ROW_TYPE:p,TABS_TYPE:h,TAB_TYPE:m,DYNAMIC_TYPE:g}},80621:(e,t,r)=>{"use strict";r.d(t,{AA:()=>T,Bu:()=>D,C3:()=>p,D0:()=>s,ES:()=>d,Ep:()=>L,HE:()=>x,Jd:()=>l,M2:()=>o,Mu:()=>v,NN:()=>g,NT:()=>I,Nb:()=>c,OE:()=>R,PV:()=>n,Q9:()=>O,TN:()=>w,Xk:()=>m,Z1:()=>u,Zn:()=>i,_4:()=>a,_B:()=>k,b5:()=>A,cd:()=>_,cx:()=>E,cz:()=>y,dU:()=>M,es:()=>b,fw:()=>S,gR:()=>f,kS:()=>N,pQ:()=>Z,u_:()=>C,vD:()=>h});const n="GRID_ID",o="HEADER_ID",a="ROOT_ID",i="DASHBOARD_VERSION_KEY",s="NEW_COMPONENTS_SOURCE_ID",l="NEW_CHART_ID",c="NEW_COLUMN_ID",d="NEW_DIVIDER_ID",u="NEW_HEADER_ID",p="NEW_MARKDOWN_ID",h="NEW_ROW_ID",m="NEW_TAB_ID",g="NEW_TABS_ID",f="NEW_DYNAMIC_COMPONENT",v=0,_=8,b=2*_,y=12,E=1,T=5,S=4,C="SMALL_HEADER",R="MEDIUM_HEADER",Z="LARGE_HEADER",A="BACKGROUND_WHITE",x="BACKGROUND_TRANSPARENT",O=50,w="overwrite",I="overwriteConfirmed",N="newDashboard",D=65535,L=["LABEL"],M="ALL_FILTERS_ROOT";var k;!function(e){e[e.NONE=0]="NONE",e[e.HIDE_NAV=1]="HIDE_NAV",e[e.HIDE_NAV_AND_TITLE=2]="HIDE_NAV_AND_TITLE",e[e.REPORT=3]="REPORT"}(k||(k={}))},52838:(e,t,r)=>{"use strict";r.d(t,{U:()=>p,g:()=>h});var n=r(50361),o=r.n(n),a=r(93185),i=r(37731),s=r(11064),l=r(16355),c=r(32873),d=r(52004),u=r(9531);const p=e=>(0,a.cr)(a.TT.DASHBOARD_CROSS_FILTERS)&&(void 0===e||e),h=(e,t,r)=>{var n;if(!(0,a.cr)(a.TT.DASHBOARD_CROSS_FILTERS))return;const p=null!=(n=t.global_chart_configuration)&&n.scope?{scope:t.global_chart_configuration.scope,chartsInScope:(0,c.Q)(t.global_chart_configuration.scope,Object.values(r).map((e=>e.id)),e)}:{scope:u.eV,chartsInScope:Object.values(r).map((e=>e.id))},h={};return Object.values(e).forEach((n=>{var a,u,m,g,f,v;const _=null==(a=n.meta)?void 0:a.chartId;var b;(0,i.Z)(_)&&((null!=(u=null==(m=null!=(g=(0,s.Z)().get(null==(f=r[_])||null==(v=f.form_data)?void 0:v.viz_type))?g:{})?void 0:m.behaviors)?u:[]).includes(l.cg.INTERACTIVE_CHART)&&(null!=(b=t.chart_configuration)&&b[_]&&(h[_]=o()(t.chart_configuration[_])),h[_]||(h[_]={id:_,crossFilters:{scope:d.$}}),h[_].crossFilters.chartsInScope=(0,d._6)(h[_].crossFilters.scope)?p.chartsInScope.filter((e=>e!==Number(_))):(0,c.Q)(h[_].crossFilters.scope,Object.values(r).map((e=>e.id)),e)))})),{chartConfiguration:h,globalChartConfiguration:p}}},70400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(17563);const o=new Set(["standalone","edit"]);function a(e){const t=n.parse(window.location.search);return Object.entries(t).reduce(((t,r)=>{let[n,a]=r;return"regular"===e&&o.has(n)||"reserved"===e&&!o.has(n)?t:Array.isArray(a)?{...t,[n]:a[0]}:{...t,[n]:a}}),{})}},95173:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});const n={};function o(e){let t=null;if(e){const{childId:o,layout:a={}}=e;if(n[o]){var r;const e=(null==a?void 0:a[n[o]])||{};if(null!=e&&e.children&&null!=e&&null!=(r=e.children)&&null!=r.includes&&r.includes(o))return e.id}t=function(e){let t=null;if(e){const{childId:n,layout:o={}}=e;if(o){const e=Object.keys(o);for(let a=0;a<=e.length-1;a+=1){var r;const i=e[a],s=o[i]||{};if(i!==n&&null!=s&&null!=(r=s.children)&&null!=r.includes&&r.includes(n)){t=i;break}}}}return t}({childId:o,layout:a}),n[o]=t}return t}},32873:(e,t,r)=>{"use strict";r.d(t,{Q:()=>o});var n=r(81255);function o(e,t,r){const o=Object.values(r);return t.filter((t=>{var r,a;return!e.excluded.includes(t)&&(null==(r=o.find((e=>{var r;return(null==e?void 0:e.type)===n.dW&&(null==(r=e.meta)?void 0:r.chartId)===t})))||null==(a=r.parents)?void 0:a.some((t=>e.rootPath.includes(t))))}))}},20194:(e,t,r)=>{"use strict";function n(e){let{chartId:t,column:r}=e;return`${t}_${r}`}r.d(t,{_:()=>a,w:()=>n});const o=/^([0-9]+)_(.*)$/;function a(e){const t=o.exec(e);if(!t)throw new Error("Cannot parse invalid filter key");return{chartId:parseInt(t[1],10),column:t[2]}}},56967:(e,t,r)=>{"use strict";function n(){return(window.location.hash||"#").substring(1)}r.d(t,{Z:()=>n})},22318:(e,t,r)=>{"use strict";r.d(t,{Ms:()=>d,Xg:()=>p,i5:()=>l,N$:()=>u});var n=r(93185),o=r(68630),a=r.n(o);function i(e){return function(e){return a()(e)&&"username"in e}(e)&&"permissions"in e&&"roles"in e}var s=r(12617);const l=e=>i(e)&&Object.keys(e.roles||{}).some((e=>"admin"===e.toLowerCase())),c=(e,t)=>i(t)&&e.owners.some((e=>e.id===t.userId)),d=(e,t)=>i(t)&&(l(t)||c(e,t))&&(0,s.R)("can_write","Dashboard",null==t?void 0:t.roles);function u(e,t,r){return l(e)||i(e)&&Object.values(e.roles||{}).flat().some((e=>e[0]===r&&e[1]===t))}const p=(e,t)=>i(t)&&(0,s.R)("can_write","Dashboard",null==t?void 0:t.roles)&&(!(0,n.cr)(n.TT.DASHBOARD_RBAC)||l(t)||c(e,t))},74599:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,Ch:()=>a,Ft:()=>c,eG:()=>d,mO:()=>s,sh:()=>p,u3:()=>l,ze:()=>u});var n=r(93185),o=r(8868);const a="CLEAR_DATA_MASK_STATE",i="UPDATE_DATA_MASK",s="SET_DATA_MASK_FOR_FILTER_CONFIG_COMPLETE",l="SET_DATA_MASK_FOR_FILTER_CONFIG_FAIL";function c(e,t){return{type:s,filterConfig:e,filters:t}}function d(e,t){const r=(0,n.cr)(n.TT.DASHBOARD_NATIVE_FILTERS)||(0,n.cr)(n.TT.DASHBOARD_CROSS_FILTERS);return{type:i,filterId:e,dataMask:r?t:{}}}function u(e){return d(e,(0,o.H)(e))}function p(){return{type:a}}},8868:(e,t,r)=>{"use strict";r.d(t,{H:()=>c,Z:()=>u});var n=r(12902),o=r(93185),a=r(92242),i=r(4305),s=r(74599),l=r(99543);function c(e,t){void 0===t&&(t={});let r={};return e&&(r={id:e}),{...r,extraFormData:{},filterState:{},ownState:{},...t}}function d(e,t,r,n,o){e.forEach((e=>{var r;const a=n||{};t[e.id]={...c(e.id),...e.defaultDataMask,...a[e.id]},o&&!(0,l.JB)(e.defaultDataMask,null==(r=o[e.id])?void 0:r.defaultDataMask,{ignoreUndefined:!0})&&(t[e.id]={...t[e.id],...e.defaultDataMask})})),Object.values(r).forEach((e=>{String(null==e?void 0:e.id).startsWith(a.rW)||(t[null==e?void 0:e.id]=e)}))}const u=(0,n.ZP)(((e,t)=>{var r,n,a,l;const u={};switch(t.type){case s.Ch:return u;case s.A:return e[t.filterId]={...c(t.filterId),...e[t.filterId],...t.dataMask},e;case i.$:var p,h;return(0,o.cr)(o.TT.DASHBOARD_CROSS_FILTERS)&&Object.keys(null==(p=t.data.dashboardInfo)||null==(h=p.metadata)?void 0:h.chart_configuration).forEach((e=>{u[e]={...c(e)}})),d(null!=(r=null==(n=t.data.dashboardInfo)||null==(a=n.metadata)?void 0:a.native_filter_configuration)?r:[],u,e,t.data.dataMask),u;case s.mO:return d(null!=(l=t.filterConfig)?l:[],u,e,t.filters),u;default:return e}}),{})},99068:(e,t,r)=>{"use strict";r.d(t,{AG:()=>s,yn:()=>d});var n=r(31069),o=r(72570),a=r(98286),i=r(651);const s="SET_DATASOURCE";function l(e){return{type:s,datasource:e}}function c(e){return function(t,r){const{explore:{datasource:n}}=r();t(l(e)),t((0,i.updateFormDataByDatasource)(n,e))}}const d={setDatasource:l,changeDatasource:c,saveDataset:function(e){let{schema:t,sql:r,database:i,templateParams:s,datasourceName:l,columns:d}=e;return async function(e){try{const{json:{data:o}}=await n.Z.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:null==i?void 0:i.id,table_name:l,schema:t,sql:r,template_params:s,columns:d})});return e(c(o)),o}catch(t){throw(0,a.O$)(t).then((t=>{e((0,o.Gb)(t.error))})),t}}}}},651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CREATE_NEW_SLICE:()=>D,FETCH_DATASOURCES_STARTED:()=>h,FETCH_DATASOURCES_SUCCEEDED:()=>g,FETCH_DATASOURCE_SUCCEEDED:()=>u,FETCH_FAVE_STAR:()=>b,POST_DATASOURCE_STARTED:()=>d,SAVE_FAVE_STAR:()=>E,SET_EXPLORE_CONTROLS:()=>R,SET_FIELD_VALUE:()=>S,SET_FORCE_QUERY:()=>P,SET_FORM_DATA:()=>A,SET_SAVE_ACTION:()=>I,SLICE_UPDATED:()=>M,TOGGLE_FAVE_STAR:()=>v,UPDATE_CHART_TITLE:()=>O,UPDATE_FORM_DATA_BY_DATASOURCE:()=>l,createNewSlice:()=>L,exploreActions:()=>$,fetchDatasourceSucceeded:()=>p,fetchDatasourcesStarted:()=>m,fetchDatasourcesSucceeded:()=>f,fetchFaveStar:()=>y,saveFaveStar:()=>T,setControlValue:()=>C,setExploreControls:()=>Z,setForceQuery:()=>U,setFormData:()=>x,setSaveAction:()=>N,sliceUpdated:()=>k,toggleFaveStar:()=>_,updateChartTitle:()=>w,updateFormDataByDatasource:()=>c});var n=r(15926),o=r.n(n),a=r(31069),i=r(61988),s=r(72570);const l="UPDATE_FORM_DATA_BY_DATASOURCE";function c(e,t){return{type:l,prevDatasource:e,newDatasource:t}}const d="POST_DATASOURCE_STARTED",u="FETCH_DATASOURCE_SUCCEEDED";function p(){return{type:u}}const h="FETCH_DATASOURCES_STARTED";function m(){return{type:h}}const g="FETCH_DATASOURCES_SUCCEEDED";function f(){return{type:g}}const v="TOGGLE_FAVE_STAR";function _(e){return{type:v,isStarred:e}}const b="FETCH_FAVE_STAR";function y(e){return function(t){a.Z.get({endpoint:`/api/v1/chart/favorite_status/?q=${o().encode([e])}`}).then((e=>{var r,n;let{json:o}=e;t(_(!(null==o||null==(r=o.result)||null==(n=r[0])||!n.value)))}))}}const E="SAVE_FAVE_STAR";function T(e,t){return function(r){const n=`/api/v1/chart/${e}/favorites/`;(t?a.Z.delete({endpoint:n}):a.Z.post({endpoint:n})).then((()=>r(_(!t)))).catch((()=>{r((0,s.Gb)((0,i.t)("An error occurred while starring this chart")))}))}}const S="SET_FIELD_VALUE";function C(e,t,r){return{type:S,controlName:e,value:t,validationErrors:r}}const R="UPDATE_EXPLORE_CONTROLS";function Z(e){return{type:R,formData:e}}const A="UPDATE_FORM_DATA";function x(e){return{type:A,formData:e}}const O="UPDATE_CHART_TITLE";function w(e){return{type:O,sliceName:e}}const I="SET_SAVE_ACTION";function N(e){return{type:I,saveAction:e}}const D="CREATE_NEW_SLICE";function L(e,t,r,n,o){return{type:D,can_add:e,can_download:t,can_overwrite:r,slice:n,form_data:o}}const M="SLICE_UPDATED";function k(e){return{type:M,slice:e}}const P="SET_FORCE_QUERY";function U(e){return{type:P,force:e}}const $={...s.s2,fetchDatasourcesStarted:m,fetchDatasourcesSucceeded:f,toggleFaveStar:_,fetchFaveStar:y,saveFaveStar:T,setControlValue:C,setExploreControls:Z,updateChartTitle:w,createNewSlice:L,sliceUpdated:k,setForceQuery:U}},76445:(e,t,r)=>{"use strict";r.d(t,{_:()=>v,u:()=>_});var n,o=r(12515),a=r(35854),i=r(5364),s=r(11146),l=r(10581),c=r(55786),d=r(81545),u=r(45511),p=r(10331),h=r(42313),m=r(23525),g=r(27600),f=r(12617);!function(e){e.CATEGORICAL="CATEGORICAL",e.SEQUENTIAL="SEQUENTIAL"}(n||(n={}));const v="HYDRATE_EXPLORE",_=e=>{let{form_data:t,slice:r,dataset:_,metadata:b,saveAction:y=null}=e;return(e,E)=>{var T,S;const{user:C,datasources:R,charts:Z,sliceEntities:A,common:x,explore:O}=E(),w=(0,m.eY)(g.KD.sliceId),I=(0,m.eY)(g.KD.dashboardId),N=w?null==A||null==(T=A.slices)?void 0:T[w]:null,D=null!=r?r:N,L=null!=t?t:null==D?void 0:D.form_data;if(!L.viz_type){const e=(null==x?void 0:x.conf.DEFAULT_VIZ_TYPE)||"table";L.viz_type=(0,m.eY)(g.KD.vizType)||e}var M;L.time_range||(L.time_range=(null==x||null==(M=x.conf)?void 0:M.DEFAULT_TIME_FILTER)||i.vM),s.O6&&L.include_time&&L.granularity_sqla&&(null==(S=L.groupby)||!S.some((e=>(0,l.Z)(e)===(0,l.Z)(L.granularity_sqla))))&&(L.groupby=[L.granularity_sqla,...(0,c.Z)(L.groupby)],L.granularity_sqla=void 0),I&&(L.dashboardId=I);const k=_,P={form_data:L,slice:D,datasource:k},U=(0,a.R3)(P,L),$=U.color_scheme&&"color_scheme",F=U.linear_color_scheme&&"linear_color_scheme",q=e=>{const t="CATEGORICAL"===e?(0,d.Z)():(0,u.Z)(),r="CATEGORICAL"===e?$:F,n=t.defaultKey,o="CATEGORICAL"===e?"supersetColors":"superset_seq_1",a=L[r],i=!!t.get(a,!0);a&&!i&&(U[r].value=n||o)};$&&q(n.CATEGORICAL),F&&q(n.SEQUENTIAL);const V={can_add:(0,f.R)("can_write","Chart",null==C?void 0:C.roles),can_download:(0,f.R)("can_csv","Superset",null==C?void 0:C.roles),can_overwrite:(0,c.Z)(null==r?void 0:r.owners).includes(null==C?void 0:C.userId),isDatasourceMetaLoading:!1,isStarred:!1,triggerRender:!1,datasource:k,controls:U,form_data:L,slice:D,controlsTransferred:O.controlsTransferred,standalone:(0,m.eY)(g.KD.standalone),force:(0,m.eY)(g.KD.force),metadata:b,saveAction:y,common:x};Object.entries(V.controls).forEach((e=>{let[t,r]=e;V.controls[t]=(0,p.RO)(r,V)}));const B=D?(0,p.Hu)(U):null,H=(0,o.Jp)(P),j={id:H,chartAlert:null,chartStatus:null,chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:(0,p.Hu)(V.controls),sliceFormData:B,queryController:null,queriesResponse:null,triggerQuery:!1,lastRendered:0};return e({type:v,data:{charts:{...Z,[H]:j},datasources:{...R,[(0,h.T)(k)]:k},saveModal:{dashboards:[],saveModalAlert:null,isVisible:!1},explore:V}})}}},59317:(e,t,r)=>{"use strict";r.d(t,{Z:()=>Lo});var n=r(73126),o=r(18446),a=r.n(o),i=r(67294),s=r(51995),l=r(85716),c=r(57902),d=r(93362),u=r(45697),p=r.n(u),h=r(4715),m=r(28216),g=r(61988),f=r(68135),v=r(9882),_=r(67913),b=r(12515),y=r(52256),E=r(11965);function T(e){const{selectable:t,children:r,...o}=e,a=(0,s.Fg)(),i={"&.ant-list-item":{padding:`${a.gridUnit+2}px ${3*a.gridUnit}px`,":first-of-type":{borderTopLeftRadius:a.gridUnit,borderTopRightRadius:a.gridUnit},":last-of-type":{borderBottomLeftRadius:a.gridUnit,borderBottomRightRadius:a.gridUnit}}};return t&&(i["&:hover"]={cursor:"pointer",backgroundColor:a.colors.grayscale.light4}),(0,E.tZ)(h.aV.Item,(0,n.Z)({},o,{css:i}),r)}var S=r(27845);const C=(0,_.Z)((()=>Promise.all([r.e(2087),r.e(1997)]).then(r.bind(r,31997))),(()=>(0,E.tZ)("div",{style:{width:450,height:368}}))),R={colorScheme:p().string.isRequired,annotationError:p().object,annotationQuery:p().object,vizType:p().string,validationErrors:p().array,name:p().string.isRequired,actions:p().object,value:p().arrayOf(p().object),onChange:p().func,refreshAnnotationData:p().func};class Z extends i.PureComponent{constructor(e){super(e),this.state={popoverVisible:{},addedAnnotationIndex:null},this.addAnnotationLayer=this.addAnnotationLayer.bind(this),this.removeAnnotationLayer=this.removeAnnotationLayer.bind(this),this.handleVisibleChange=this.handleVisibleChange.bind(this)}componentDidMount(){C.preload()}UNSAFE_componentWillReceiveProps(e){const{name:t,annotationError:r,validationErrors:n,value:o}=e;Object.keys(r).length&&!n.length&&this.props.actions.setControlValue(t,o,Object.keys(r)),!Object.keys(r).length&&n.length&&this.props.actions.setControlValue(t,o,[])}addAnnotationLayer(e,t){let r=this.props.value;r.includes(e)?r=r.map((r=>r===e?t:r)):(r=[...r,t],this.setState({addedAnnotationIndex:r.length-1})),this.props.refreshAnnotationData({annotation:t,force:!0}),this.props.onChange(r)}handleVisibleChange(e,t){this.setState((r=>({popoverVisible:{...r.popoverVisible,[t]:e}})))}removeAnnotationLayer(e){const t=this.props.value.filter((t=>t!==e)),r=(0,S.j)();r&&r.style.setProperty("overflow-y","auto","important"),this.props.onChange(t)}renderPopover(e,t,r){const o=(null==t?void 0:t.name)||"_new";return(0,E.tZ)("div",{id:`annotation-pop-${o}`},(0,E.tZ)(C,(0,n.Z)({},t,{error:r,colorScheme:this.props.colorScheme,vizType:this.props.vizType,addAnnotationLayer:e=>this.addAnnotationLayer(t,e),removeAnnotationLayer:()=>this.removeAnnotationLayer(t),close:()=>{this.handleVisibleChange(!1,e),this.setState({addedAnnotationIndex:null})}})))}renderInfo(e){const{annotationError:t,annotationQuery:r,theme:n}=this.props;return r[e.name]?(0,E.tZ)("i",{className:"fa fa-refresh",style:{color:n.colors.primary.base},"aria-hidden":!0}):t[e.name]?(0,E.tZ)(v.V,{label:"validation-errors",bsStyle:"danger",tooltip:t[e.name]}):e.show?"":(0,E.tZ)("span",{style:{color:n.colors.error.base}}," Hidden ")}render(){const{addedAnnotationIndex:e}=this.state,t=this.props.value[e],r=this.props.value.map(((e,t)=>(0,E.tZ)(S.Z,{key:t,trigger:"click",title:(0,g.t)("Edit annotation layer"),css:e=>({"&:hover":{cursor:"pointer",backgroundColor:e.colors.grayscale.light4}}),content:this.renderPopover(t,e,this.props.annotationError[e.name]),visible:this.state.popoverVisible[t],onVisibleChange:e=>this.handleVisibleChange(e,t)},(0,E.tZ)(T,{selectable:!0},(0,E.tZ)("span",null,e.name),(0,E.tZ)("span",{style:{float:"right"}},this.renderInfo(e)))))),n="add";return(0,E.tZ)("div",null,(0,E.tZ)(h.aV,{bordered:!0,css:e=>({borderRadius:e.gridUnit})},r,(0,E.tZ)(S.Z,{trigger:"click",content:this.renderPopover(n,t),title:(0,g.t)("Add annotation layer"),visible:this.state.popoverVisible[n],destroyTooltipOnHide:!0,onVisibleChange:e=>this.handleVisibleChange(e,n)},(0,E.tZ)(T,{selectable:!0},(0,E.tZ)("i",{className:"fa fa-plus"})," "," ",(0,g.t)("Add annotation layer")))))}}Z.propTypes=R,Z.defaultProps={vizType:"",value:[],annotationError:{},annotationQuery:{},onChange:()=>{}};const A=(0,f.b)(Z),x=(0,m.$j)((function(e){var t,r;let{charts:n,explore:o}=e;const a=n[(0,b.Jp)(o)]||n[0]||{};return{colorScheme:null==(t=o.controls)||null==(r=t.color_scheme)?void 0:r.value,annotationError:a.annotationError,annotationQuery:a.annotationQuery,vizType:o.controls.viz_type.value}}),(function(e){return{refreshAnnotationData:t=>e((0,y.runAnnotationQuery)(t))}}))(A);var O=r(23279),w=r.n(O),I=r(9875),N=r(82342);const D=s.iK.div`
  display: flex;
`,L=(0,s.iK)(I.Rn)`
  flex: 1;
  margin-right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,M=(0,s.iK)(I.Rn)`
  flex: 1;
  margin-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,k=e=>null===e||Number.isNaN(Number(e))?null:Number(e);function P(e){let{onChange:t=(()=>{}),value:r=[null,null],...n}=e;const[o,a]=(0,i.useState)([k(r[0]),k(r[1])]),s=r[0],l=r[1],c=(0,i.useRef)(w()(t,300)).current,d=e=>{a(e),c([void 0===e[0]?null:e[0],void 0===e[1]?null:e[1]])};return(0,i.useEffect)((()=>{a([k(s),k(l)])}),[s,l]),(0,E.tZ)("div",null,(0,E.tZ)(N.Z,n),(0,E.tZ)(D,null,(0,E.tZ)(L,{placeholder:(0,g.t)("Min"),onChange:e=>{d([k(e),o[1]])},value:null===o[0]?void 0:o[0]}),(0,E.tZ)(M,{placeholder:(0,g.t)("Max"),onChange:e=>{d([o[0],k(e)])},value:null===o[1]?void 0:o[1]})))}var U=r(79069),$=r(14670),F=r.n($),q=r(95742),V=r(70707),B=r(33334);const H={name:p().string.isRequired,label:p().string,description:p().string,placeholder:p().string,addTooltip:p().string,itemGenerator:p().func,keyAccessor:p().func,onChange:p().func,value:p().oneOfType([p().array]),isFloat:p().bool,isInt:p().bool,controlName:p().string.isRequired},j={label:null,description:null,onChange:()=>{},placeholder:(0,g.t)("Empty collection"),itemGenerator:()=>({key:F().generate()}),keyAccessor:e=>e.key,value:[],addTooltip:(0,g.t)("Add an item")},z=(0,q.W8)(T),Q=(0,q.JN)(h.aV),G=(0,q.W6)((()=>(0,E.tZ)("i",{role:"img","aria-label":"drag",className:"fa fa-bars text-primary",style:{cursor:"ns-resize"}})));var Y={name:"11g6mpt",styles:"justify-content:flex-start"};class W extends i.Component{constructor(e){super(e),this.onAdd=this.onAdd.bind(this)}onChange(e,t){const r=[...this.props.value];r[e]={...this.props.value[e],...t},this.props.onChange(r)}onAdd(){this.props.onChange(this.props.value.concat([this.props.itemGenerator()]))}onSortEnd(e){let{oldIndex:t,newIndex:r}=e;this.props.onChange((0,q.Rp)(this.props.value,t,r))}removeItem(e){this.props.onChange(this.props.value.filter(((t,r)=>e!==r)))}renderList(){if(0===this.props.value.length)return(0,E.tZ)("div",{className:"text-muted"},this.props.placeholder);const e=No[this.props.controlName];return(0,E.tZ)(Q,{useDragHandle:!0,lockAxis:"y",onSortEnd:this.onSortEnd.bind(this),bordered:!0,css:e=>({borderRadius:e.gridUnit})},this.props.value.map(((t,r)=>{const{label:o,...a}=this.props;return(0,E.tZ)(z,{className:"clearfix",css:Y,key:this.props.keyAccessor(t),index:r},(0,E.tZ)(G,null),(0,E.tZ)("div",{css:e=>({flex:1,marginLeft:2*e.gridUnit,marginRight:2*e.gridUnit})},(0,E.tZ)(e,(0,n.Z)({},a,t,{onChange:this.onChange.bind(this,r)}))),(0,E.tZ)(v.V,{icon:"times",label:"remove-item",tooltip:(0,g.t)("Remove item"),bsStyle:"primary",onClick:this.removeItem.bind(this,r)}))})))}render(){const{theme:e}=this.props;return(0,E.tZ)("div",{className:"CollectionControl"},(0,E.tZ)(B.gM,null,(0,E.tZ)(N.Z,this.props),(0,E.tZ)(B.IG,{onClick:this.onAdd},(0,E.tZ)(V.Z.PlusLarge,{iconSize:"s",iconColor:e.colors.grayscale.light5}))),this.renderList())}}W.propTypes=H,W.defaultProps=j;const K=(0,f.b)(W);var X=r(24198),J=r(81545),ee=r(99299);const te={onChange:p().func,value:p().object},re={position:"absolute",width:"50px",height:"20px",top:"0px",left:"0px",right:"0px",bottom:"0px"},ne=s.iK.div`
  ${e=>{let{theme:t}=e;return`\n      width: 50px;\n      height: 20px;\n      position: relative;\n      padding: ${t.gridUnit}px;\n      borderRadius: ${t.borderRadius}px;\n      display: inline-block;\n      cursor: pointer;\n    `}}
`,oe={color:{...re,borderRadius:"2px"},checkerboard:{...re,background:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==") left center'}};class ae extends i.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e){this.props.onChange(e.rgb)}renderPopover(){const e=(0,J.Z)().get().colors.filter(((e,t)=>t<7));return(0,E.tZ)("div",{id:"filter-popover",className:"color-popover"},(0,E.tZ)(X.xS,{css:E.iv`
            // We need to use important here as these are element level styles
            padding: 0 !important;
            box-shadow: none !important;
          `,color:this.props.value,onChange:this.onChange,presetColors:e}))}render(){const e=this.props.value||{r:0,g:0,b:0,a:0},t={...oe.color,background:`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`};return(0,E.tZ)("div",null,(0,E.tZ)(N.Z,this.props),(0,E.tZ)(ee.Z,{trigger:"click",placement:"right",content:this.renderPopover()},(0,E.tZ)(ne,null,(0,E.tZ)("div",{style:oe.checkerboard}),(0,E.tZ)("div",{style:t}))))}}ae.propTypes=te,ae.defaultProps={onChange:()=>{}};var ie=r(76787),se=r(47037),le=r.n(se),ce=r(46078),de=r(31069),ue=r(45211),pe=r(23525),he=r(83862),me=r(58593),ge=r(77775),fe=r(35932),ve=r(91178),_e=r(86057),be=r(27600),ye=r(79217),Ee=r(22318),Te=r(1304),Se=r(13218),Ce=r.n(Se),Re=r(16550);const Ze=(0,g.t)("Close"),Ae=(0,g.t)("Save as Dataset"),xe=(0,g.t)("Open in SQL Lab"),Oe=e=>{const t=(0,Re.k6)();return(0,E.tZ)("div",null,(0,E.tZ)(fe.Z,{onClick:()=>{null==e||null==e.closeModal||e.closeModal(),null==e||null==e.changeDatasource||e.changeDatasource()}},Ae),(0,E.tZ)(fe.Z,{onClick:r=>{let{metaKey:n}=r;return(r=>{const{datasource:n}=e;if(Ce()(n)){const{id:e,type:o,sql:a}=n;((e,r,n,o)=>{const a={datasourceKey:`${r}__${n}`,sql:o};e?de.Z.postForm("/sqllab/",a):t.push({pathname:"/sqllab",state:{requestedQuery:a}})})(r,e,o,a)}})(Boolean(n))}},xe),(0,E.tZ)(fe.Z,{buttonStyle:"primary",onClick:()=>{null==e||null==e.closeModal||e.closeModal()}},Ze))};var we=r(85626),Ie=r(47710),Ne=r(9679),De=r(73727);const Le={actions:p().object.isRequired,onChange:p().func,value:p().string,datasource:p().object.isRequired,form_data:p().object.isRequired,isEditable:p().bool,onDatasourceSave:p().func},Me=s.iK.div`
  .data-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
    padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    padding-right: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  }
  .error-alert {
    margin: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  }
  .ant-dropdown-trigger {
    margin-left: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    box-shadow: none;
    &:active {
      box-shadow: none;
    }
  }
  .btn-group .open .dropdown-toggle {
    box-shadow: none;
    &.button-default {
      background: none;
    }
  }
  i.angle {
    color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
  }
  svg.datasource-modal-trigger {
    color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
    cursor: pointer;
  }
  .title-select {
    flex: 1 1 100%;
    display: inline-block;
    background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light3}};
    padding: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
    text-align: center;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }
  .datasource-svg {
    margin-right: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    flex: none;
  }
  span[aria-label='dataset-physical'] {
    color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  }
  span[aria-label='more-vert'] {
    color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
  }
`,ke="change_dataset",Pe="view_in_sql_lab",Ue="edit_dataset",$e="save_as_dataset",Fe={[ce.i9.Query]:(0,E.tZ)(V.Z.ConsoleSqlOutlined,{className:"datasource-svg"}),[ce.i9.Table]:(0,E.tZ)(V.Z.DatasetPhysical,{className:"datasource-svg"})},qe=e=>{e.metaKey?e.preventDefault():e.stopPropagation()};class Ve extends i.PureComponent{constructor(e){super(e),this.onDatasourceSave=e=>{var t,r,n;this.props.actions.changeDatasource(e);const{temporalColumns:o,defaultTemporalColumn:a}=(0,ue.X)(e),{columns:i}=e,s=null==(t=this.props.form_data)?void 0:t.granularity_sqla,l=null==(r=i.find((e=>{let{column_name:t}=e;return t===s})))?void 0:r.is_dttm,c=null==(n=i.find((e=>{let{column_name:t}=e;return t===a})))?void 0:n.is_dttm;if("table"===e.type&&!l){const e=c?a:null==o?void 0:o[0];this.props.actions.setControlValue("granularity_sqla",e||null)}this.props.onDatasourceSave&&this.props.onDatasourceSave(e)},this.toggleShowDatasource=()=>{this.setState((e=>{let{showDatasource:t}=e;return{showDatasource:!t}}))},this.toggleChangeDatasourceModal=()=>{this.setState((e=>{let{showChangeDatasourceModal:t}=e;return{showChangeDatasourceModal:!t}}))},this.toggleEditDatasourceModal=()=>{this.setState((e=>{let{showEditDatasourceModal:t}=e;return{showEditDatasourceModal:!t}}))},this.toggleSaveDatasetModal=()=>{this.setState((e=>{let{showSaveDatasetModal:t}=e;return{showSaveDatasetModal:!t}}))},this.handleMenuItemClick=e=>{let{key:t}=e;switch(t){case ke:this.toggleChangeDatasourceModal();break;case Ue:this.toggleEditDatasourceModal();break;case Pe:{const{datasource:e}=this.props,t={datasourceKey:`${e.id}__${e.type}`,sql:e.sql};de.Z.postForm("/sqllab/",{form_data:(0,Ne.o)(t)})}break;case $e:this.toggleSaveDatasetModal()}},this.state={showEditDatasourceModal:!1,showChangeDatasourceModal:!1,showSaveDatasetModal:!1}}render(){var e,t;const{showChangeDatasourceModal:r,showEditDatasourceModal:n,showSaveDatasetModal:o}=this.state,{datasource:a,onChange:s,theme:l}=this.props,c=!(null!=a&&a.id);let d=!1;if(c){const e=(0,pe.eY)(be.KD.datasourceId),t=(0,pe.eY)(be.KD.sliceId);e||t||(d=!0)}const{user:u}=this.props,p=(null==(e=a.owners)?void 0:e.map((e=>e.id||e.value)).includes(u.userId))||(0,Ee.i5)(u),m=(0,Ee.N$)(u,"SQL Lab","menu_access"),f=(0,g.t)("Edit dataset"),v={datasourceKey:`${a.id}__${a.type}`,sql:a.sql},_=(0,E.tZ)(he.Menu,{onClick:this.handleMenuItemClick},this.props.isEditable&&!c&&(0,E.tZ)(he.Menu.Item,{key:Ue,disabled:!p},p?f:(0,E.tZ)(me.u,{title:(0,g.t)("You must be a dataset owner in order to edit. Please reach out to a dataset owner to request modifications or edit access.")},f)),(0,E.tZ)(he.Menu.Item,{key:ke},(0,g.t)("Swap dataset")),!c&&m&&(0,E.tZ)(he.Menu.Item,{key:Pe},(0,E.tZ)(De.rU,{to:{pathname:"/sqllab",state:{requestedQuery:v}},onClick:qe},(0,g.t)("View in SQL Lab")))),b=(0,E.tZ)(he.Menu,{onClick:this.handleMenuItemClick},(0,E.tZ)(he.Menu.Item,{key:"query_preview"},(0,E.tZ)(Te.Z,{triggerNode:(0,E.tZ)("span",null,(0,g.t)("Query preview")),modalTitle:(0,g.t)("Query preview"),modalBody:(0,E.tZ)(we.Z,{sql:(null==a?void 0:a.sql)||(null==a?void 0:a.select_star)||""}),modalFooter:(0,E.tZ)(Oe,{changeDatasource:this.toggleSaveDatasetModal,datasource:a}),draggable:!1,resizable:!1,responsive:!0})),m&&(0,E.tZ)(he.Menu.Item,{key:Pe},(0,E.tZ)(De.rU,{to:{pathname:"/sqllab",state:{requestedQuery:v}},onClick:qe},(0,g.t)("View in SQL Lab"))),(0,E.tZ)(he.Menu.Item,{key:$e},(0,g.t)("Save as dataset"))),{health_check_message:y}=a;let T;if(null!=a&&a.extra)if(le()(a.extra))try{T=JSON.parse(a.extra)}catch{}else T=a.extra;const S=c?(0,g.t)("Missing dataset"):(e=>"query"===(null==e?void 0:e.type)?null==e?void 0:e.sql:(null==e?void 0:e.name)||"")(a),C=S;return(0,E.tZ)(Me,{className:"DatasourceControl"},(0,E.tZ)("div",{className:"data-container"},Fe[null==a?void 0:a.type],((e,t)=>(null==e?void 0:e.length)>25?(0,E.tZ)(me.u,{title:t},(0,E.tZ)("span",{className:"title-select"},e)):(0,E.tZ)("span",{title:t,className:"title-select"},e))(S,C),y&&(0,E.tZ)(me.u,{title:y},(0,E.tZ)(V.Z.AlertSolid,{iconColor:l.colors.warning.base})),(null==(t=T)?void 0:t.warning_markdown)&&(0,E.tZ)(_e.Z,{warningMarkdown:T.warning_markdown}),(0,E.tZ)(h.Gj,{overlay:a.type===ce.i9.Query?b:_,trigger:["click"]},(0,E.tZ)(V.Z.MoreVert,{className:"datasource-modal-trigger"}))),c&&d&&(0,E.tZ)("div",{className:"error-alert"},(0,E.tZ)(ve.Z,{level:"warning",title:(0,g.t)("Missing URL parameters"),source:"explore",subtitle:(0,E.tZ)(i.Fragment,null,(0,E.tZ)("p",null,(0,g.t)("The URL is missing the dataset_id or slice_id parameters.")))})),c&&!d&&(0,E.tZ)("div",{className:"error-alert"},(0,E.tZ)(ve.Z,{level:"warning",title:(0,g.t)("Missing dataset"),source:"explore",subtitle:(0,E.tZ)(i.Fragment,null,(0,E.tZ)("p",null,(0,g.t)("The dataset linked to this chart may have been deleted.")),(0,E.tZ)("p",null,(0,E.tZ)(fe.Z,{buttonStyle:"primary",onClick:()=>this.handleMenuItemClick({key:ke})},(0,g.t)("Swap dataset"))))})),n&&(0,E.tZ)(ge.W,{datasource:a,show:n,onDatasourceSave:this.onDatasourceSave,onHide:this.toggleEditDatasourceModal}),r&&(0,E.tZ)(ge.Q,{onDatasourceSave:this.onDatasourceSave,onHide:this.toggleChangeDatasourceModal,show:r,onChange:s}),o&&(0,E.tZ)(Ie.W,{visible:o,onHide:this.toggleSaveDatasetModal,buttonTextOnSave:(0,g.t)("Save"),buttonTextOnOverwrite:(0,g.t)("Overwrite"),modalDescription:(0,g.t)("Save this query as a virtual dataset to continue exploring"),datasource:(0,ye.z)(a),openWindow:!1,formData:this.props.form_data}))}}Ve.propTypes=Le,Ve.defaultProps={onChange:()=>{},onDatasourceSave:null,value:null,isEditable:!0};const Be=(0,f.b)(Ve);var He=r(1090),je=r(37921),ze=r(43700),Qe=r(79684),Ge=r(55786),Ye=r(34087),We=r(42753),Ke=r(19113),Xe=r(27130);const Je=s.iK.span`
  display: inline-block;
  padding: 2px 0;
`,et=(0,s.iK)(I.II)`
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}};
  height: 26px;
  padding-left: ${e=>{let{theme:t}=e;return 2.5*t.gridUnit}}px;
`,tt=e=>{let{title:t,isEditDisabled:r,onChange:n}=e;const[o,a]=(0,i.useState)(!1),[s,l]=(0,i.useState)(!1),c=(0,g.t)("My metric"),d=(0,i.useCallback)((()=>a(!0)),[]),u=(0,i.useCallback)((()=>a(!1)),[]),p=(0,i.useCallback)((()=>l(!0)),[]),h=(0,i.useCallback)((()=>l(!1)),[]),m=(0,i.useCallback)((e=>{"Enter"===e.key&&(e.preventDefault(),h())}),[h]),f=(0,i.useCallback)((e=>{""===e.target.value&&n(e),h()}),[n,h]);return r?(0,E.tZ)("span",null,(null==t?void 0:t.label)||c):s?(0,E.tZ)(et,{type:"text",placeholder:null==t?void 0:t.label,value:null!=t&&t.hasCustomLabel?t.label:"",autoFocus:!0,onChange:n,onBlur:f,onKeyPress:m}):(0,E.tZ)(me.u,{placement:"top",title:(0,g.t)("Click to edit label")},(0,E.tZ)("span",{className:"AdhocMetricEditPopoverTitle inline-editable",onMouseOver:d,onMouseOut:u,onClick:p,onBlur:h,role:"button",tabIndex:0},(0,E.tZ)(Je,null,(null==t?void 0:t.label)||c),"",(0,E.tZ)("i",{className:"fa fa-pencil",style:{color:o?"black":"grey"}})))};var rt=r(63325),nt=r(37731),ot=r(71262),at=r(94301),it=r(49238),st=r(94670),lt=r(33313),ct=r(54076),dt=r(69856),ut=r(99963);const pt={onChange:p().func.isRequired,onClose:p().func.isRequired,onResize:p().func.isRequired,getCurrentTab:p().func,getCurrentLabel:p().func,adhocMetric:p().instanceOf(Ke.Z).isRequired,columns:p().arrayOf(Ye.Z),savedMetricsOptions:p().arrayOf(Xe.Z),savedMetric:Xe.Z,datasource:p().object,isNewMetric:p().bool,isLabelModified:p().bool},ht={columns:[],getCurrentTab:ct.EI,isNewMetric:!1},mt=(0,s.iK)(h.Ph)`
  .metric-option {
    & > svg {
      min-width: ${e=>{let{theme:t}=e;return 4*t.gridUnit+"px"}};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,gt="SAVED";class ft extends i.PureComponent{constructor(e){super(e),this.defaultActiveTabKey=this.getDefaultTab(),this.onSave=this.onSave.bind(this),this.onResetStateAndClose=this.onResetStateAndClose.bind(this),this.onColumnChange=this.onColumnChange.bind(this),this.onAggregateChange=this.onAggregateChange.bind(this),this.onSavedMetricChange=this.onSavedMetricChange.bind(this),this.onSqlExpressionChange=this.onSqlExpressionChange.bind(this),this.onDragDown=this.onDragDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTabChange=this.onTabChange.bind(this),this.handleAceEditorRef=this.handleAceEditorRef.bind(this),this.refreshAceEditor=this.refreshAceEditor.bind(this),this.getDefaultTab=this.getDefaultTab.bind(this),this.state={adhocMetric:this.props.adhocMetric,savedMetric:this.props.savedMetric,width:dt.kc,height:dt.H7},document.addEventListener("mouseup",this.onMouseUp)}componentDidMount(){this.props.getCurrentTab(this.defaultActiveTabKey)}componentDidUpdate(e,t){var r,n,o,a,i,s,l,c,d,u,p,h,m;(null==(r=t.adhocMetric)?void 0:r.sqlExpression)===(null==(n=this.state.adhocMetric)?void 0:n.sqlExpression)&&(null==(o=t.adhocMetric)?void 0:o.aggregate)===(null==(a=this.state.adhocMetric)?void 0:a.aggregate)&&(null==(i=t.adhocMetric)||null==(s=i.column)?void 0:s.column_name)===(null==(l=this.state.adhocMetric)||null==(c=l.column)?void 0:c.column_name)&&(null==(d=t.savedMetric)?void 0:d.metric_name)===(null==(u=this.state.savedMetric)?void 0:u.metric_name)||this.props.getCurrentLabel({savedMetricLabel:(null==(p=this.state.savedMetric)?void 0:p.verbose_name)||(null==(h=this.state.savedMetric)?void 0:h.metric_name),adhocMetricLabel:null==(m=this.state.adhocMetric)?void 0:m.getDefaultLabel()})}componentWillUnmount(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)}getDefaultTab(){const{adhocMetric:e,savedMetric:t,savedMetricsOptions:r,isNewMetric:n}=this.props;return(0,nt.Z)(e.column)||(0,nt.Z)(e.sqlExpression)?e.expressionType:(n||t.metric_name)&&Array.isArray(r)&&r.length>0?gt:e.expressionType}onSave(){var e;const{adhocMetric:t,savedMetric:r}=this.state,n=null!=r&&r.metric_name?r:t,o=null!=(e=this.props.savedMetric)&&e.metric_name?this.props.savedMetric:this.props.adhocMetric;this.props.onChange({...n},o),this.props.onClose()}onResetStateAndClose(){this.setState({adhocMetric:this.props.adhocMetric,savedMetric:this.props.savedMetric},this.props.onClose)}onColumnChange(e){const t=this.props.columns.find((t=>t.column_name===e));this.setState((e=>({adhocMetric:e.adhocMetric.duplicateWith({column:t,expressionType:Ke.v.SIMPLE}),savedMetric:void 0})))}onAggregateChange(e){this.setState((t=>({adhocMetric:t.adhocMetric.duplicateWith({aggregate:e,expressionType:Ke.v.SIMPLE}),savedMetric:void 0})))}onSavedMetricChange(e){const t=this.props.savedMetricsOptions.find((t=>t.metric_name===e));this.setState((e=>({savedMetric:t,adhocMetric:e.adhocMetric.duplicateWith({column:void 0,aggregate:void 0,sqlExpression:void 0,expressionType:Ke.v.SIMPLE})})))}onSqlExpressionChange(e){this.setState((t=>({adhocMetric:t.adhocMetric.duplicateWith({sqlExpression:e,expressionType:Ke.v.SQL}),savedMetric:void 0})))}onDragDown(e){this.dragStartX=e.clientX,this.dragStartY=e.clientY,this.dragStartWidth=this.state.width,this.dragStartHeight=this.state.height,document.addEventListener("mousemove",this.onMouseMove)}onMouseMove(e){this.props.onResize(),this.setState({width:Math.max(this.dragStartWidth+(e.clientX-this.dragStartX),dt.kc),height:Math.max(this.dragStartHeight+(e.clientY-this.dragStartY),dt.H7)})}onMouseUp(){document.removeEventListener("mousemove",this.onMouseMove)}onTabChange(e){this.refreshAceEditor(),this.props.getCurrentTab(e)}handleAceEditorRef(e){e&&(this.aceEditorRef=e)}refreshAceEditor(){setTimeout((()=>{this.aceEditorRef&&this.aceEditorRef.editor.resize()}),0)}renderColumnOption(e){const t={...e};return t.metric_name&&!t.verbose_name&&(t.verbose_name=t.metric_name),(0,E.tZ)(ut.l,{column:t,showType:!0})}renderMetricOption(e){return(0,E.tZ)(ut.B,{metric:e,showType:!0})}render(){var e;const{adhocMetric:t,savedMetric:r,columns:o,savedMetricsOptions:a,onChange:s,onClose:l,onResize:c,datasource:d,isNewMetric:u,isLabelModified:p,...m}=this.props,{adhocMetric:f,savedMetric:v}=this.state,_=lt.Z.concat(o.map((e=>({name:e.column_name,value:e.column_name,score:50,meta:"column"})))),b=f.column&&f.column.column_name||f.inferSqlExpressionColumn(),y={ariaLabel:(0,g.t)("Select column"),placeholder:(0,g.t)("%s column(s)",o.length),value:b,onChange:this.onColumnChange,allowClear:!0,autoFocus:!b},T={ariaLabel:(0,g.t)("Select aggregate options"),placeholder:(0,g.t)("%s aggregates(s)",dt.Ps.length),value:f.aggregate||f.inferSqlExpressionAggregate(),onChange:this.onAggregateChange,allowClear:!0,autoFocus:!!b},S={ariaLabel:(0,g.t)("Select saved metrics"),placeholder:(0,g.t)("%s saved metric(s)",null!=(e=null==a?void 0:a.length)?e:0),value:null==v?void 0:v.metric_name,onChange:this.onSavedMetricChange,allowClear:!0,autoFocus:!0},C=f.isValid()||(null==v?void 0:v.metric_name),R=p||u||!f.equals(t)||!(void 0===(null==v?void 0:v.metric_name)&&void 0===(null==r?void 0:r.metric_name))&&(null==v?void 0:v.metric_name)!==(null==r?void 0:r.metric_name);let Z={};if(null!=d&&d.extra)try{Z=JSON.parse(d.extra)}catch{}return(0,E.tZ)(it.l0,(0,n.Z)({layout:"vertical",id:"metrics-edit-popover"},m),(0,E.tZ)(ot.ZP,{id:"adhoc-metric-edit-tabs",defaultActiveKey:this.defaultActiveTabKey,className:"adhoc-metric-edit-tabs",style:{height:this.state.height,width:this.state.width},onChange:this.onTabChange,allowOverflow:!0},(0,E.tZ)(ot.ZP.TabPane,{key:gt,tab:(0,g.t)("Saved")},(0,Ge.Z)(a).length>0?(0,E.tZ)(it.xJ,{label:(0,g.t)("Saved metric")},(0,E.tZ)(mt,(0,n.Z)({options:(0,Ge.Z)(a).map((e=>({value:e.metric_name,label:e.metric_name,customLabel:this.renderMetricOption(e),key:e.id})))},S))):d.type===ce.i9.Table?(0,E.tZ)(at.Tc,{image:"empty.svg",title:(0,g.t)("No saved metrics found"),description:(0,g.t)('Add metrics to dataset in "Edit datasource" modal')}):(0,E.tZ)(at.Tc,{image:"empty.svg",title:(0,g.t)("No saved metrics found"),description:(0,E.tZ)(i.Fragment,null,(0,E.tZ)("span",{tabIndex:0,role:"button",onClick:()=>{this.props.handleDatasetModal(!0),this.props.onClose()}},(0,g.t)("Create a dataset")),(0,g.t)(" to add metrics"))})),(0,E.tZ)(ot.ZP.TabPane,{key:Ke.v.SIMPLE,tab:Z.disallow_adhoc_metrics?(0,E.tZ)(me.u,{title:(0,g.t)("Simple ad-hoc metrics are not enabled for this dataset")},(0,g.t)("Simple")):(0,g.t)("Simple"),disabled:Z.disallow_adhoc_metrics},(0,E.tZ)(it.xJ,{label:(0,g.t)("column")},(0,E.tZ)(h.Ph,(0,n.Z)({options:o.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,key:e.id,customLabel:this.renderColumnOption(e)})))},y))),(0,E.tZ)(it.xJ,{label:(0,g.t)("aggregate")},(0,E.tZ)(h.Ph,(0,n.Z)({options:dt.Ps.map((e=>({value:e,label:e,key:e})))},T)))),(0,E.tZ)(ot.ZP.TabPane,{key:Ke.v.SQL,tab:Z.disallow_adhoc_metrics?(0,E.tZ)(me.u,{title:(0,g.t)("Custom SQL ad-hoc metrics are not enabled for this dataset")},(0,g.t)("Custom SQL")):(0,g.t)("Custom SQL"),disabled:Z.disallow_adhoc_metrics},(0,E.tZ)(st.iO,{showLoadingForImport:!0,ref:this.handleAceEditorRef,keywords:_,height:this.state.height-80+"px",onChange:this.onSqlExpressionChange,width:"100%",showGutter:!1,value:f.sqlExpression||f.translateToSql({transformCountDistinct:!0}),editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,className:"filter-sql-editor",wrapEnabled:!0}))),(0,E.tZ)("div",null,(0,E.tZ)(fe.Z,{buttonSize:"small",onClick:this.onResetStateAndClose,cta:!0},(0,g.t)("Close")),(0,E.tZ)(fe.Z,{disabled:!C||!R,buttonStyle:"primary",buttonSize:"small",onClick:this.onSave,cta:!0},(0,g.t)("Save")),(0,E.tZ)("i",{role:"button","aria-label":"Resize",tabIndex:0,onMouseDown:this.onDragDown,className:"fa fa-expand edit-popover-resize text-muted"})))}}ft.propTypes=pt,ft.defaultProps=ht;class vt extends i.PureComponent{constructor(e){super(e),this.onPopoverResize=this.onPopoverResize.bind(this),this.onLabelChange=this.onLabelChange.bind(this),this.closePopover=this.closePopover.bind(this),this.togglePopover=this.togglePopover.bind(this),this.getCurrentTab=this.getCurrentTab.bind(this),this.getCurrentLabel=this.getCurrentLabel.bind(this),this.onChange=this.onChange.bind(this),this.handleDatasetModal=this.handleDatasetModal.bind(this),this.state={adhocMetric:e.adhocMetric,popoverVisible:!1,title:{label:e.adhocMetric.label,hasCustomLabel:e.adhocMetric.hasCustomLabel},currentLabel:"",labelModified:!1,isTitleEditDisabled:!1,showSaveDatasetModal:!1}}static getDerivedStateFromProps(e,t){return t.adhocMetric.optionName!==e.adhocMetric.optionName?{adhocMetric:e.adhocMetric,title:{label:e.adhocMetric.label,hasCustomLabel:e.adhocMetric.hasCustomLabel},currentLabel:"",labelModified:!1}:{adhocMetric:e.adhocMetric}}onLabelChange(e){var t;const{verbose_name:r,metric_name:n}=this.props.savedMetric,o=null==(t=this.props.adhocMetric)?void 0:t.getDefaultLabel(),a=e.target.value;this.setState((e=>({title:{label:a||e.currentLabel||r||n||o,hasCustomLabel:!!a},labelModified:!0})))}onPopoverResize(){this.forceUpdate()}handleDatasetModal(e){this.setState({showSaveDatasetModal:e})}closePopover(){this.togglePopover(!1),this.setState({labelModified:!1})}togglePopover(e){this.setState({popoverVisible:e})}getCurrentTab(e){this.setState({isTitleEditDisabled:e===gt})}getCurrentLabel(e){let{savedMetricLabel:t,adhocMetricLabel:r}=e;const n=t||r;this.setState({currentLabel:n,labelModified:!0}),!t&&this.state.title.hasCustomLabel||this.setState({title:{label:n,hasCustomLabel:!1}})}onChange(e,t){this.props.onMetricEdit({...e,...this.state.title},t)}render(){const{adhocMetric:e,savedMetric:t,columns:r,savedMetricsOptions:n,datasource:o,isControlledComponent:a}=this.props,{verbose_name:s,metric_name:l}=t,{hasCustomLabel:c,label:d}=e,u=c?d:e.getDefaultLabel(),p=this.state.labelModified?this.state.title:{label:s||l||u,hasCustomLabel:c},{visible:h,togglePopover:m,closePopover:f}=a?{visible:this.props.visible,togglePopover:this.props.togglePopover,closePopover:this.props.closePopover}:{visible:this.state.popoverVisible,togglePopover:this.togglePopover,closePopover:this.closePopover},v=(0,E.tZ)(rt.b,null,(0,E.tZ)(ft,{adhocMetric:e,columns:r,savedMetricsOptions:n,savedMetric:t,datasource:o,handleDatasetModal:this.handleDatasetModal,onResize:this.onPopoverResize,onClose:f,onChange:this.onChange,getCurrentTab:this.getCurrentTab,getCurrentLabel:this.getCurrentLabel,isNewMetric:this.props.isNew,isLabelModified:this.state.labelModified&&u!==this.state.title.label})),_=(0,E.tZ)(tt,{title:p,onChange:this.onLabelChange,isEditDisabled:this.state.isTitleEditDisabled});return(0,E.tZ)(i.Fragment,null,this.state.showSaveDatasetModal&&(0,E.tZ)(Ie.W,{visible:this.state.showSaveDatasetModal,onHide:()=>this.handleDatasetModal(!1),buttonTextOnSave:(0,g.t)("Save"),buttonTextOnOverwrite:(0,g.t)("Overwrite"),modalDescription:(0,g.t)("Save this query as a virtual dataset to continue exploring"),datasource:o}),(0,E.tZ)(S.Z,{placement:"right",trigger:"click",content:v,defaultVisible:h,visible:h,onVisibleChange:m,title:_,destroyTooltipOnHide:!0},this.props.children))}}const _t=vt,bt={adhocMetric:p().instanceOf(Ke.Z),onMetricEdit:p().func.isRequired,onRemoveMetric:p().func,columns:p().arrayOf(Ye.Z),savedMetricsOptions:p().arrayOf(Xe.Z),savedMetric:Xe.Z,datasource:p().object,onMoveLabel:p().func,onDropLabel:p().func,index:p().number,type:p().string,multi:p().bool,datasourceWarningMessage:p().string};class yt extends i.PureComponent{constructor(e){super(e),this.onRemoveMetric=this.onRemoveMetric.bind(this)}onRemoveMetric(e){null==e||e.stopPropagation(),this.props.onRemoveMetric(this.props.index)}render(){const{adhocMetric:e,onMetricEdit:t,columns:r,savedMetricsOptions:n,savedMetric:o,datasource:a,onMoveLabel:i,onDropLabel:s,index:l,type:c,multi:d,datasourceWarningMessage:u}=this.props;return(0,E.tZ)(_t,{adhocMetric:e,onMetricEdit:t,columns:r,savedMetricsOptions:n,savedMetric:o,datasource:a},(0,E.tZ)(B.yz,{savedMetric:o,adhocMetric:e,label:e.label,onRemove:this.onRemoveMetric,onMoveLabel:i,onDropLabel:s,index:l,type:null!=c?c:We.g.AdhocMetricOption,withCaret:!0,isFunction:!0,multi:d,datasourceWarningMessage:u}))}}const Et=yt;yt.propTypes=bt;const Tt={option:p().oneOfType([p().object,p().string]).isRequired,index:p().number.isRequired,onMetricEdit:p().func,onRemoveMetric:p().func,onMoveLabel:p().func,onDropLabel:p().func,columns:p().arrayOf(Ye.Z),savedMetrics:p().arrayOf(Xe.Z),savedMetricsOptions:p().arrayOf(Xe.Z),multi:p().bool,datasource:p().object,datasourceWarningMessage:p().string};function St(e){let t,{option:r,onMetricEdit:n,onRemoveMetric:o,columns:a,savedMetrics:i,savedMetricsOptions:s,datasource:l,onMoveLabel:c,onDropLabel:d,index:u,type:p,multi:h,datasourceWarningMessage:m}=e;var g;if("string"==typeof r?(g=r,t=i.find((e=>e.metric_name===g))):r.metric_name&&(t=r),r instanceof Ke.Z||t){var f;const e={onMetricEdit:n,onRemoveMetric:o,columns:a,savedMetricsOptions:s,datasource:l,adhocMetric:r instanceof Ke.Z?r:new Ke.Z({}),onMoveLabel:c,onDropLabel:d,index:u,savedMetric:null!=(f=t)?f:{},type:p,multi:h,datasourceWarningMessage:m};return(0,E.tZ)(Et,e)}return null}St.propTypes=Tt;var Ct=r(17536);const Rt={name:p().string.isRequired,onChange:p().func,value:p().oneOfType([p().arrayOf(p().oneOfType([p().string,Ct.Z])),p().oneOfType([p().string,Ct.Z])]),columns:p().arrayOf(Ye.Z),savedMetrics:p().arrayOf(Xe.Z),isLoading:p().bool,multi:p().bool,clearable:p().bool,datasource:p().object};function Zt(e,t,r){var n;return null!=(n=null==e?void 0:e.filter((e=>Array.isArray(t)?!t.includes(e.metric_name)||e.metric_name===r:e)))?n:[]}function At(e){return e&&!(e instanceof Ke.Z)&&e.expressionType}function xt(e){return e?Array.isArray(e)?e.map((e=>At(e)?new Ke.Z(e):e)):At(e)?[new Ke.Z(e)]:[e]:[]}const Ot={metric_name:"",expression:""},wt=e=>{let{onChange:t,multi:r,value:n,columns:o,savedMetrics:c,datasource:d,...u}=e;const[p,h]=(0,i.useState)(xt(n)),m=(0,s.Fg)(),f=(0,l.D)(o),v=(0,l.D)(c),_=(0,i.useCallback)((e=>{if(null===e)return void t(null);const n=(0,Ge.Z)(e).map((e=>e.metric_name?e.metric_name:e)).filter((e=>e));t(r?n:n[0])}),[r,t]),b=(0,i.useCallback)((e=>{const t=[...p,e];h(t),_(t)}),[_,p]),y=(0,i.useCallback)(((e,t)=>{const r=p.map((r=>r!==t.metric_name&&void 0===r.optionName||r.optionName!==t.optionName?r:e));h(r),_(r)}),[_,p]),T=(0,i.useCallback)((e=>{if(!Array.isArray(p))return;const t=[...p];t.splice(e,1),h(t),_(t)}),[_,p]),S=(0,i.useCallback)(((e,t)=>{const r=[...p];[r[t],r[e]]=[r[e],r[t]],h(r)}),[p]),C=(0,i.useCallback)((()=>!r&&p.length>0),[r,p.length]),R=(0,i.useMemo)((()=>Zt(c,n,null)),[n,c]),Z=(0,i.useMemo)((()=>new Ke.Z({})),[p]),A=(0,i.useCallback)((e=>C()?e:(0,E.tZ)(_t,{adhocMetric:Z,onMetricEdit:b,columns:o,savedMetricsOptions:R,savedMetric:Ot,datasource:d,isNew:!0},e)),[o,d,C,Z,b,R]);(0,i.useEffect)((()=>{if(n&&(!a()(f,o)||!a()(v,c))){const e=((e,t,r)=>(0,Ge.Z)(e).filter((e=>"string"==typeof e||e.metric_name?null==r?void 0:r.some((t=>t.metric_name===e||t.metric_name===e.metric_name)):null==t?void 0:t.some((t=>!e.column||e.column.column_name===t.column_name)))))(n,o,c);a()(e,n)||_(e)}}),[o,_,c]),(0,i.useEffect)((()=>{h(xt(n))}),[n]);const x=(0,i.useCallback)((()=>_(p)),[_,p]),O=(0,i.useCallback)(((e,t)=>(0,E.tZ)(St,{key:t,index:t,option:e,onMetricEdit:y,onRemoveMetric:T,columns:o,datasource:d,savedMetrics:c,savedMetricsOptions:Zt(c,p,null==p?void 0:p[t]),onMoveLabel:S,onDropLabel:x,multi:r})),[o,d,S,r,x,y,T,c,p]);return(0,E.tZ)("div",{className:"metrics-select"},(0,E.tZ)(B.gM,null,(0,E.tZ)(N.Z,u),A((0,E.tZ)(B.IG,{disabled:C()},(0,E.tZ)(V.Z.PlusLarge,{iconSize:"s",iconColor:m.colors.grayscale.light5})))),(0,E.tZ)(B.yj,null,p.length>0?p.map(((e,t)=>O(e,t))):A((0,E.tZ)(B.SW,null,(0,E.tZ)(V.Z.PlusSmall,{iconColor:m.colors.grayscale.light1}),(0,g.t)("Add metric")))))};wt.propTypes=Rt,wt.defaultProps={onChange:()=>{},clearable:!0,savedMetrics:[],columns:[]};const It=wt;var Nt=r(83734);const Dt="fix",Lt="metric",Mt={onChange:p().func,value:p().object,isFloat:p().bool,datasource:p().object.isRequired,default:p().shape({type:p().oneOf(["fix","metric"]),value:p().oneOfType([p().string,p().number])})},kt={onChange:()=>{},default:{type:Dt,value:5}};class Pt extends i.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this),this.setType=this.setType.bind(this),this.setFixedValue=this.setFixedValue.bind(this),this.setMetric=this.setMetric.bind(this);const t=(e.value?e.value.type:e.default.type)||Dt,r=(e.value?e.value.value:e.default.value)||"100";this.state={type:t,fixedValue:t===Dt?r:"",metricValue:t===Lt?r:null}}onChange(){this.props.onChange({type:this.state.type,value:this.state.type===Dt?this.state.fixedValue:this.state.metricValue})}setType(e){this.setState({type:e},this.onChange)}setFixedValue(e){this.setState({fixedValue:e},this.onChange)}setMetric(e){this.setState({metricValue:e},this.onChange)}render(){const e=(this.props.value||this.props.default).type||Dt,t=this.props.datasource?this.props.datasource.columns:null,r=this.props.datasource?this.props.datasource.metrics:null;return(0,E.tZ)("div",null,(0,E.tZ)(N.Z,this.props),(0,E.tZ)(ze.Z,{ghost:!0,css:e=>(0,E.iv)("&.ant-collapse>.ant-collapse-item.ant-collapse-no-arrow>.ant-collapse-header{border:0px;padding:0px 0px ",2*e.gridUnit,"px 0px;display:inline-block;}&.ant-collapse-ghost>.ant-collapse-item>.ant-collapse-content>.ant-collapse-content-box{padding:0px;& .well{margin-bottom:0px;padding:",2*e.gridUnit,"px;}}","")},(0,E.tZ)(ze.Z.Panel,{showArrow:!1,header:(0,E.tZ)(je.Z,{onClick:()=>{}},this.state.type===Dt&&(0,E.tZ)("span",null,this.state.fixedValue),this.state.type===Lt&&(0,E.tZ)("span",null,(0,E.tZ)("span",null,(0,g.t)("metric"),": "),(0,E.tZ)("strong",null,this.state.metricValue?this.state.metricValue.label:null)))},(0,E.tZ)("div",{className:"well"},(0,E.tZ)(Nt.Z,{title:(0,g.t)("Fixed"),isSelected:e===Dt,onSelect:()=>{this.setType(Dt)}},(0,E.tZ)(Qe.Z,{isFloat:!0,onChange:this.setFixedValue,onFocus:()=>{this.setType(Dt)},value:this.state.fixedValue})),(0,E.tZ)(Nt.Z,{title:(0,g.t)("Based on a metric"),isSelected:e===Lt,onSelect:()=>{this.setType(Lt)}},(0,E.tZ)(It,{name:"metric",columns:t,savedMetrics:r,multi:!1,onFocus:()=>{this.setType(Lt)},onChange:this.setMetric,value:this.state.metricValue,datasource:this.props.datasource}))))))}}Pt.propTypes=Mt,Pt.defaultProps=kt;var Ut=r(14114),$t=r(98286);function Ft(e){return void 0!==e.value}const qt=(0,Ut.ZP)((e=>{let{addDangerToast:t,allowClear:r=!0,ariaLabel:n,dataEndpoint:o,multi:a=!0,mutator:s,onChange:l,placeholder:c,value:d,...u}=e;const[p,m]=(0,i.useState)([]);return(0,i.useEffect)((()=>{de.Z.get({endpoint:o}).then((e=>{const t=s?s(e.json):e.json.result;m(t)})).catch((e=>(0,$t.O$)(e).then((e=>{const{error:r}=e;t((0,g.t)("Error while fetching data: %s",r))}))))}),[t,o,s]),(0,E.tZ)(h.Ph,{allowClear:r,ariaLabel:n||(0,g.t)("Select ..."),value:(()=>{const e=d||(void 0!==u.default?u.default:void 0);if(null!==e||p.find((e=>null===e.value)))return e})(),header:(0,E.tZ)(N.Z,u),mode:a?"multiple":"single",onChange:e=>{let t=e;Array.isArray(e)&&(t=e.map((e=>Ft(e)?e.value:e))),Ft(e)&&(t=e.value),l(t)},options:p,placeholder:c})}));var Vt=r(82199),Bt=r(36155),Ht={name:"mlsake",styles:"margin-left:0;margin-right:0"};function jt(e){return(0,E.tZ)(Bt.Z,(0,n.Z)({},e,{css:Ht}))}var zt=r(665),Qt=r(42878);const Gt={label:p().string,tooltip:p().string,colType:p().string,width:p().string,height:p().string,timeLag:p().oneOfType([p().string,p().number]),timeRatio:p().string,comparisonType:p().string,showYAxis:p().bool,yAxisBounds:p().array,bounds:p().array,d3format:p().string,dateFormat:p().string,onChange:p().func},Yt={label:(0,g.t)("Time series columns"),tooltip:"",colType:"",width:"",height:"",timeLag:"",timeRatio:"",comparisonType:"",showYAxis:!1,yAxisBounds:[null,null],bounds:[null,null],d3format:"",dateFormat:""},Wt=[{value:"value",label:(0,g.t)("Actual value"),key:"value"},{value:"diff",label:(0,g.t)("Difference"),key:"diff"},{value:"perc",label:(0,g.t)("Percentage"),key:"perc"},{value:"perc_change",label:(0,g.t)("Percentage change"),key:"perc_change"}],Kt=[{value:"time",label:(0,g.t)("Time comparison"),key:"time"},{value:"contrib",label:(0,g.t)("Contribution"),key:"contrib"},{value:"spark",label:(0,g.t)("Sparkline"),key:"spark"},{value:"avg",label:(0,g.t)("Period average"),key:"avg"}],Xt=(0,s.iK)(h.X2)`
  margin-top: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  display: flex;
  align-items: center;
`,Jt=(0,s.iK)(h.JX)`
  display: flex;
  align-items: center;
`,er=(0,s.iK)(v.V)`
  margin-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light1}};
`,tr=s.iK.div`
  margin-top: ${e=>{let{theme:t}=e;return 5*t.gridUnit}}px;
  display: flex;
  justify-content: center;
`;class rr extends i.Component{constructor(e){super(e),this.onSave=this.onSave.bind(this),this.onClose=this.onClose.bind(this),this.resetState=this.resetState.bind(this),this.initialState=this.initialState.bind(this),this.onPopoverVisibleChange=this.onPopoverVisibleChange.bind(this),this.state=this.initialState()}initialState(){return{label:this.props.label,tooltip:this.props.tooltip,colType:this.props.colType,width:this.props.width,height:this.props.height,timeLag:this.props.timeLag||0,timeRatio:this.props.timeRatio,comparisonType:this.props.comparisonType,showYAxis:this.props.showYAxis,yAxisBounds:this.props.yAxisBounds,bounds:this.props.bounds,d3format:this.props.d3format,dateFormat:this.props.dateFormat,popoverVisible:!1}}resetState(){const e=this.initialState();this.setState({...e})}onSave(){this.props.onChange(this.state),this.setState({popoverVisible:!1})}onClose(){this.resetState()}onSelectChange(e,t){this.setState({[e]:t})}onTextInputChange(e,t){this.setState({[e]:t.target.value})}onCheckboxChange(e,t){this.setState({[e]:t})}onBoundsChange(e){this.setState({bounds:e})}onPopoverVisibleChange(e){e?this.setState({popoverVisible:e}):this.resetState()}onYAxisBoundsChange(e){this.setState({yAxisBounds:e})}textSummary(){return`${this.props.label}`}formRow(e,t,r,n){return(0,E.tZ)(Xt,null,(0,E.tZ)(Jt,{xs:24,md:11},e,(0,E.tZ)(er,{placement:"top",tooltip:t,label:r})),(0,E.tZ)(h.JX,{xs:24,md:13},n))}renderPopover(){return(0,E.tZ)("div",{id:"ts-col-popo",style:{width:320}},this.formRow((0,g.t)("Label"),(0,g.t)("The column header label"),"time-lag",(0,E.tZ)(I.II,{value:this.state.label,onChange:this.onTextInputChange.bind(this,"label"),placeholder:(0,g.t)("Label")})),this.formRow((0,g.t)("Tooltip"),(0,g.t)("Column header tooltip"),"col-tooltip",(0,E.tZ)(I.II,{value:this.state.tooltip,onChange:this.onTextInputChange.bind(this,"tooltip"),placeholder:(0,g.t)("Tooltip")})),this.formRow((0,g.t)("Type"),(0,g.t)("Type of comparison, value difference or percentage"),"col-type",(0,E.tZ)(h.Ph,{ariaLabel:(0,g.t)("Type"),value:this.state.colType||void 0,onChange:this.onSelectChange.bind(this,"colType"),options:Kt})),(0,E.tZ)("hr",null),"spark"===this.state.colType&&this.formRow((0,g.t)("Width"),(0,g.t)("Width of the sparkline"),"spark-width",(0,E.tZ)(I.II,{value:this.state.width,onChange:this.onTextInputChange.bind(this,"width"),placeholder:(0,g.t)("Width")})),"spark"===this.state.colType&&this.formRow((0,g.t)("Height"),(0,g.t)("Height of the sparkline"),"spark-width",(0,E.tZ)(I.II,{value:this.state.height,onChange:this.onTextInputChange.bind(this,"height"),placeholder:(0,g.t)("Height")})),["time","avg"].indexOf(this.state.colType)>=0&&this.formRow((0,g.t)("Time lag"),(0,g.t)("Number of periods to compare against"),"time-lag",(0,E.tZ)(I.II,{value:this.state.timeLag,onChange:this.onTextInputChange.bind(this,"timeLag"),placeholder:(0,g.t)("Time Lag")})),["spark"].indexOf(this.state.colType)>=0&&this.formRow((0,g.t)("Time ratio"),(0,g.t)("Number of periods to ratio against"),"time-ratio",(0,E.tZ)(I.II,{value:this.state.timeRatio,onChange:this.onTextInputChange.bind(this,"timeRatio"),placeholder:(0,g.t)("Time Ratio")})),"time"===this.state.colType&&this.formRow((0,g.t)("Type"),(0,g.t)("Type of comparison, value difference or percentage"),"comp-type",(0,E.tZ)(h.Ph,{ariaLabel:(0,g.t)("Type"),value:this.state.comparisonType||void 0,onChange:this.onSelectChange.bind(this,"comparisonType"),options:Wt})),"spark"===this.state.colType&&this.formRow((0,g.t)("Show Y-axis"),(0,g.t)("Show Y-axis on the sparkline. Will display the manually set min/max if set or min/max values in the data otherwise."),"show-y-axis-bounds",(0,E.tZ)(U.Z,{value:this.state.showYAxis,onChange:this.onCheckboxChange.bind(this,"showYAxis")})),"spark"===this.state.colType&&this.formRow((0,g.t)("Y-axis bounds"),(0,g.t)("Manually set min/max values for the y-axis."),"y-axis-bounds",(0,E.tZ)(P,{value:this.state.yAxisBounds,onChange:this.onYAxisBoundsChange.bind(this)})),"spark"!==this.state.colType&&this.formRow((0,g.t)("Color bounds"),(0,g.t)("Number bounds used for color encoding from red to blue.\n               Reverse the numbers for blue to red. To get pure red or blue,\n               you can enter either only min or max."),"bounds",(0,E.tZ)(P,{value:this.state.bounds,onChange:this.onBoundsChange.bind(this)})),this.formRow((0,g.t)("Number format"),(0,g.t)("Optional d3 number format string"),"d3-format",(0,E.tZ)(I.II,{value:this.state.d3format,onChange:this.onTextInputChange.bind(this,"d3format"),placeholder:(0,g.t)("Number format string")})),"spark"===this.state.colType&&this.formRow((0,g.t)("Date format"),(0,g.t)("Optional d3 date format string"),"date-format",(0,E.tZ)(I.II,{value:this.state.dateFormat,onChange:this.onTextInputChange.bind(this,"dateFormat"),placeholder:(0,g.t)("Date format string")})),(0,E.tZ)(tr,null,(0,E.tZ)(fe.Z,{buttonSize:"small",onClick:this.onClose,cta:!0},(0,g.t)("Close")),(0,E.tZ)(fe.Z,{buttonStyle:"primary",buttonSize:"small",onClick:this.onSave,cta:!0},(0,g.t)("Save"))))}render(){return(0,E.tZ)("span",null,this.textSummary()," ",(0,E.tZ)(S.Z,{trigger:"click",content:this.renderPopover(),title:(0,g.t)("Column Configuration"),visible:this.state.popoverVisible,onVisibleChange:this.onPopoverVisibleChange},(0,E.tZ)(v.V,{icon:"edit",className:"text-primary",label:"edit-ts-column"})))}}rr.propTypes=Gt,rr.defaultProps=Yt;var nr=r(79512);const or=["longitude","latitude","zoom","bearing","pitch"],ar={onChange:p().func,value:p().shape({longitude:p().number,latitude:p().number,zoom:p().number,bearing:p().number,pitch:p().number}),default:p().object,name:p().string.isRequired};class ir extends i.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e,t){this.props.onChange({...this.props.value,[e]:t})}renderTextControl(e){return(0,E.tZ)("div",{key:e},(0,E.tZ)(it.lX,null,e),(0,E.tZ)(Qe.Z,{value:this.props.value[e],onChange:this.onChange.bind(this,e),isFloat:!0}))}renderPopover(){return(0,E.tZ)("div",{id:`filter-popover-${this.props.name}`},or.map((e=>this.renderTextControl(e))))}renderLabel(){return this.props.value.longitude&&this.props.value.latitude?`${(0,nr.decimal2sexagesimal)(this.props.value.longitude)} | ${(0,nr.decimal2sexagesimal)(this.props.value.latitude)}`:"N/A"}render(){return(0,E.tZ)("div",null,(0,E.tZ)(N.Z,this.props),(0,E.tZ)(ee.Z,{container:document.body,trigger:"click",placement:"right",content:this.renderPopover(),title:(0,g.t)("Viewport")},(0,E.tZ)(je.Z,{className:"pointer"},this.renderLabel())))}}ir.propTypes=ar,ir.defaultProps={onChange:()=>{},default:{type:"fix",value:5},value:{longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0}};var sr=r(11064),lr=r(93185),cr=r(14278),dr=r(74069),ur=r(20292),pr=r(13284);const hr=[{name:"echarts_timeseries_line",icon:(0,E.tZ)(V.Z.LineChartTile,null)},{name:"echarts_timeseries_bar",icon:(0,E.tZ)(V.Z.BarChartTile,null)},{name:"echarts_area",icon:(0,E.tZ)(V.Z.AreaChartTile,null)},{name:"table",icon:(0,E.tZ)(V.Z.TableChartTile,null)},{name:"big_number_total",icon:(0,E.tZ)(V.Z.BigNumberChartTile,null)},{name:"pie",icon:(0,E.tZ)(V.Z.PieChartTile,null)}],mr={iconSize:"l",css:e=>E.iv`
    padding: ${e.gridUnit}px;
    & > * {
      line-height: 0;
    }
  `},gr=e=>{var t;let{isActive:r,isRendered:o,vizMeta:a,onTileClick:l}=e;const{mountedPluginMetadata:c}=(0,cr.gp)(),d=(0,i.useRef)(null),u=(0,s.Fg)(),p=2*u.transitionTiming,[h,m]=(0,i.useState)(!1),[f,v]=(0,i.useState)(!1),[_,b]=(0,i.useState)(!1),y=a.name?(null==(t=c[a.name])?void 0:t.name)||`${a.name}`:(0,g.t)("Select Viz Type"),T=(0,i.useCallback)((()=>{l(a.name),v(!0),m(!1),setTimeout((()=>{v(!1)}),1e3*p)}),[l,p,a.name]);(0,i.useEffect)((()=>{b(Boolean(!f&&(!r||d.current&&d.current.scrollWidth>d.current.clientWidth)))}),[r,f]);const S=(0,i.useMemo)((()=>r?{}:{role:"button",tabIndex:0,onClick:T}),[T,r]);let C=null;return _&&(C=o?(0,g.t)("Currently rendered: %s",y):y),(0,E.tZ)(me.u,{title:C,onVisibleChange:e=>m(e),visible:h&&!f,placement:"top",mouseEnterDelay:.4},(0,E.tZ)("div",(0,n.Z)({},S,{css:E.iv`
          display: flex;
          align-items: center;
          text-transform: uppercase;

          color: ${u.colors.grayscale.base};
          font-weight: ${u.typography.weights.bold};
          border-radius: 6px;
          white-space: nowrap;
          overflow: hidden;
          max-width: fit-content;

          ${!r&&E.iv`
            flex-shrink: 0;
            width: ${6*u.gridUnit}px;
            background-color: transparent;
            transition: none;
            &:hover svg path {
              fill: ${u.colors.primary.base};
              transition: fill ${u.transitionTiming}s ease-out;
            }
          `}

          ${r&&E.iv`
            width: 100%;
            background-color: ${u.colors.grayscale.light4};
            transition: width ${p}s ease-out,
              background-color ${p}s ease-out;
            cursor: default;
            svg path {
              fill: ${u.colors.primary.base};
            }
          `}
        `}),a.icon," ",(0,E.tZ)("span",{css:E.iv`
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
            padding-right: ${u.gridUnit}px;
          `,ref:d},y)))},fr=i.memo((e=>{let{currentSelection:t,onChange:r}=e;const o=(0,m.v9)((e=>{var t,r,n;return null==(t=e.charts)||null==(r=t[(0,b.Jp)(e.explore)])||null==(n=r.latestQueryFormData)?void 0:n.viz_type})),a=(0,i.useMemo)((()=>{const e=[...hr];return t&&hr.every((e=>e.name!==t))&&t!==o&&e.unshift({name:t,icon:(0,E.tZ)(V.Z.MonitorOutlined,(0,n.Z)({},mr,{"aria-label":"monitor"}))}),o&&hr.every((e=>e.name!==o))&&e.unshift({name:o,icon:(0,E.tZ)(V.Z.CheckSquareOutlined,(0,n.Z)({},mr,{"aria-label":"check-square"}))}),e}),[t,o]);return(0,E.tZ)("div",{css:e=>E.iv`
          display: flex;
          justify-content: space-between;
          column-gap: ${e.gridUnit}px;
        `},a.map((e=>(0,E.tZ)(gr,{vizMeta:e,isActive:t===e.name,isRendered:o===e.name,onTileClick:r,key:e.name}))))})),vr=(0,ur.Z)().common.conf.VIZ_TYPE_DENYLIST||[],_r=(0,sr.Z)();function br(e){let{vizType:t}=e;return(0,cr.gp)().loading||_r.has(t)?null:(0,E.tZ)("div",{className:"text-danger",css:e=>E.iv`
        margin-top: ${e.gridUnit}px;
      `},(0,E.tZ)("i",{className:"fa fa-exclamation-circle text-danger"})," ",(0,E.tZ)("small",null,(0,g.t)("This visualization type is not supported.")))}(0,lr.cr)(lr.TT.DASHBOARD_NATIVE_FILTERS)&&!vr.includes("filter_box")&&vr.push("filter_box");const yr=(0,s.iK)(dr.default)`
  .ant-modal-body {
    padding: 0;
  }
`;var Er=r(61890);const Tr={marginTop:"5px",minHeight:"30px"},Sr={textAlign:"right"},Cr={label:p().string.isRequired,tooltip:p().string,control:p().node.isRequired,isCheckbox:p().bool};function Rr(e){let{label:t,tooltip:r,control:n,isCheckbox:o}=e;const a=(0,E.tZ)("span",null,t," ",r&&(0,E.tZ)(v.V,{placement:"top",label:t,tooltip:r}));return o?(0,E.tZ)(h.X2,{style:Tr,gutter:16},(0,E.tZ)(h.JX,{xs:24,md:8,style:Sr},n),(0,E.tZ)(h.JX,{xs:24,md:16},a)):(0,E.tZ)(h.X2,{style:Tr,gutter:16},(0,E.tZ)(h.JX,{xs:24,md:8,style:Sr},a),(0,E.tZ)(h.JX,{xs:24,md:16},n))}Rr.propTypes=Cr,Rr.defaultProps={tooltip:null,isCheckbox:!1};const Zr=new Set(["TINYINT","SMALLINT","INT","INTEGER","BIGINT","LONG"]),Ar=new Set(["FLOAT","DOUBLE","REAL","NUMERIC","DECIMAL","MONEY"]),xr={datasource:p().object.isRequired,onChange:p().func,asc:p().bool,clearable:p().bool,multiple:p().bool,column:p().string,label:p().string,metric:p().string,searchAllOptions:p().bool,defaultValue:p().string},Or={width:350};class wr extends i.Component{constructor(e){super(e);const{column:t,metric:r,asc:n,clearable:o,multiple:a,searchAllOptions:i,label:s,defaultValue:l}=e;this.state={column:t,metric:r,label:s,asc:n,clearable:o,multiple:a,searchAllOptions:i,defaultValue:l},this.onChange=this.onChange.bind(this),this.onControlChange=this.onControlChange.bind(this)}onChange(){this.props.onChange(this.state)}onControlChange(e,t){let r=t;const{column:n,multiple:o}=this.state;if(t&&!o&&e===dt.ft.DEFAULT_VALUE){const{datasource:e}=this.props,o=e.columns.find((e=>e.column_name===n));if(o&&o.type){const e=o.type.toUpperCase();"BOOLEAN"===e?r="true"===t:Zr.has(e)?r=Number.isNaN(Number(t))?null:parseInt(t,10):Ar.has(e)&&(r=Number.isNaN(Number(t))?null:parseFloat(t))}}this.setState({[e]:r},this.onChange)}setType(){}textSummary(){return this.state.column||"N/A"}renderForm(){return(0,E.tZ)("div",null,(0,E.tZ)(Rr,{label:(0,g.t)("Column"),control:(0,E.tZ)(h.Ph,{ariaLabel:(0,g.t)("Column"),value:this.state.column,name:"column",options:this.props.datasource.columns.filter((e=>e.column_name!==this.state.column)).map((e=>({value:e.column_name,label:e.column_name}))).concat([{value:this.state.column,label:this.state.column}]),onChange:e=>this.onControlChange("column",e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Label"),control:(0,E.tZ)(Qe.Z,{value:this.state.label,name:"label",onChange:e=>this.onControlChange("label",e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Default"),tooltip:(0,g.t)("(optional) default value for the filter, when using the multiple option, you can use a semicolon-delimited list of options."),control:(0,E.tZ)(Qe.Z,{value:this.state.defaultValue,name:"defaultValue",onChange:e=>this.onControlChange(dt.ft.DEFAULT_VALUE,e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Sort metric"),tooltip:(0,g.t)("Metric to sort the results by"),control:(0,E.tZ)(h.Ph,{ariaLabel:(0,g.t)("Sort metric"),value:this.state.metric,name:"column",options:this.props.datasource.metrics.filter((e=>e.metric_name!==this.state.metric)).map((e=>({value:e.metric_name,label:e.metric_name}))).concat([{value:this.state.metric,label:this.state.metric}]),onChange:e=>this.onControlChange("metric",e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Sort ascending"),tooltip:(0,g.t)("Check for sorting ascending"),isCheckbox:!0,control:(0,E.tZ)(U.Z,{value:this.state.asc,onChange:e=>this.onControlChange("asc",e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Allow multiple selections"),isCheckbox:!0,tooltip:(0,g.t)("Multiple selections allowed, otherwise filter is limited to a single value"),control:(0,E.tZ)(U.Z,{value:this.state.multiple,onChange:e=>this.onControlChange(dt.ft.MULTIPLE,e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Search all filter options"),tooltip:(0,g.t)("By default, each filter loads at most 1000 choices at the initial page load. Check this box if you have more than 1000 filter values and want to enable dynamically searching that loads filter values as users type (may add stress to your database)."),isCheckbox:!0,control:(0,E.tZ)(U.Z,{value:this.state.searchAllOptions,onChange:e=>this.onControlChange(dt.ft.SEARCH_ALL_OPTIONS,e)})}),(0,E.tZ)(Rr,{label:(0,g.t)("Required"),tooltip:(0,g.t)("User must select a value for this filter"),isCheckbox:!0,control:(0,E.tZ)(U.Z,{value:!this.state.clearable,onChange:e=>this.onControlChange("clearable",!e)})}))}renderPopover(){return(0,E.tZ)("div",{id:"ts-col-popo",style:Or},this.renderForm())}render(){return(0,E.tZ)("span",null,this.textSummary()," ",(0,E.tZ)(S.Z,{trigger:"click",content:this.renderPopover(),title:(0,g.t)("Filter configuration")},(0,E.tZ)(v.V,{icon:"edit",className:"text-primary",label:"edit-ts-column"})))}}wr.propTypes=xr,wr.defaultProps={onChange:()=>{},asc:!0,clearable:!0,multiple:!0,searchAllOptions:!1};var Ir,Nr=r(81315);!function(e){e.NONE="None",e.GREATER_THAN=">",e.LESS_THAN="<",e.GREATER_OR_EQUAL="",e.LESS_OR_EQUAL="",e.EQUAL="=",e.NOT_EQUAL="",e.BETWEEN="< x <",e.BETWEEN_OR_EQUAL=" x ",e.BETWEEN_OR_LEFT_EQUAL=" x <",e.BETWEEN_OR_RIGHT_EQUAL="< x "}(Ir||(Ir={}));const Dr=[Ir.BETWEEN,Ir.BETWEEN_OR_EQUAL,Ir.BETWEEN_OR_LEFT_EQUAL,Ir.BETWEEN_OR_RIGHT_EQUAL],Lr=(0,s.iK)(I.Rn)`
  width: 100%;
`,Mr=s.iK.div`
  display: flex;
  justify-content: flex-end;
`,kr=[{value:Ir.NONE,label:(0,g.t)("None")},{value:Ir.GREATER_THAN,label:">"},{value:Ir.LESS_THAN,label:"<"},{value:Ir.GREATER_OR_EQUAL,label:""},{value:Ir.LESS_OR_EQUAL,label:""},{value:Ir.EQUAL,label:"="},{value:Ir.NOT_EQUAL,label:""},{value:Ir.BETWEEN,label:"< x <"},{value:Ir.BETWEEN_OR_EQUAL,label:" x "},{value:Ir.BETWEEN_OR_LEFT_EQUAL,label:" x <"},{value:Ir.BETWEEN_OR_RIGHT_EQUAL,label:"< x "}],Pr=(e,t)=>r=>(n,o)=>r&&o&&!e(Number(r),Number(o))?Promise.reject(new Error(t)):Promise.resolve(),Ur=Pr(((e,t)=>e>t),(0,g.t)("This value should be smaller than the right target value")),$r=Pr(((e,t)=>e<t),(0,g.t)("This value should be greater than the left target value")),Fr=e=>e&&Dr.includes(e),qr=e=>!e||e===Ir.NONE,Vr=[{required:!0,message:(0,g.t)("Required")}],Br=[{required:!0,message:(0,g.t)("Required")},e=>{let{getFieldValue:t}=e;return{validator:Ur(t("targetValueRight"))}}],Hr=[{required:!0,message:(0,g.t)("Required")},e=>{let{getFieldValue:t}=e;return{validator:$r(t("targetValueLeft"))}}],jr=["targetValueRight"],zr=["targetValueLeft"],Qr=(e,t)=>qr(e.operator)!==qr(t.operator)||Fr(e.operator)!==Fr(t.operator),Gr=(0,E.tZ)(it.xJ,{name:"operator",label:(0,g.t)("Operator"),rules:Vr,initialValue:kr[0].value},(0,E.tZ)(Nr.Z,{ariaLabel:(0,g.t)("Operator"),options:kr})),Yr=e=>{let{getFieldValue:t}=e;return qr(t("operator"))?(0,E.tZ)(h.X2,{gutter:12},(0,E.tZ)(h.JX,{span:6},Gr)):Fr(t("operator"))?(0,E.tZ)(h.X2,{gutter:12},(0,E.tZ)(h.JX,{span:9},(0,E.tZ)(it.xJ,{name:"targetValueLeft",label:(0,g.t)("Left value"),rules:Br,dependencies:jr,validateTrigger:"onBlur",trigger:"onBlur"},(0,E.tZ)(Lr,null))),(0,E.tZ)(h.JX,{span:6},Gr),(0,E.tZ)(h.JX,{span:9},(0,E.tZ)(it.xJ,{name:"targetValueRight",label:(0,g.t)("Right value"),rules:Hr,dependencies:zr,validateTrigger:"onBlur",trigger:"onBlur"},(0,E.tZ)(Lr,null)))):(0,E.tZ)(h.X2,{gutter:12},(0,E.tZ)(h.JX,{span:6},Gr),(0,E.tZ)(h.JX,{span:18},(0,E.tZ)(it.xJ,{name:"targetValue",label:(0,g.t)("Target value"),rules:Vr},(0,E.tZ)(Lr,null))))},Wr=e=>{var t;let{config:r,onChange:n,columns:o=[]}=e;const a=[{value:(i=(0,s.Fg)()).colors.success.light1,label:(0,g.t)("success")},{value:i.colors.alert.light1,label:(0,g.t)("alert")},{value:i.colors.error.light1,label:(0,g.t)("error")},{value:i.colors.success.dark1,label:(0,g.t)("success dark")},{value:i.colors.alert.dark1,label:(0,g.t)("alert dark")},{value:i.colors.error.dark1,label:(0,g.t)("error dark")}];var i;return(0,E.tZ)(it.l0,{onFinish:n,initialValues:r,requiredMark:"optional",layout:"vertical"},(0,E.tZ)(h.X2,{gutter:12},(0,E.tZ)(h.JX,{span:12},(0,E.tZ)(it.xJ,{name:"column",label:(0,g.t)("Column"),rules:Vr,initialValue:null==(t=o[0])?void 0:t.value},(0,E.tZ)(Nr.Z,{ariaLabel:(0,g.t)("Select column"),options:o}))),(0,E.tZ)(h.JX,{span:12},(0,E.tZ)(it.xJ,{name:"colorScheme",label:(0,g.t)("Color scheme"),rules:Vr,initialValue:a[0].value},(0,E.tZ)(Nr.Z,{ariaLabel:(0,g.t)("Color scheme"),options:a})))),(0,E.tZ)(it.xJ,{noStyle:!0,shouldUpdate:Qr},Yr),(0,E.tZ)(it.xJ,null,(0,E.tZ)(Mr,null,(0,E.tZ)(fe.Z,{htmlType:"submit",buttonStyle:"primary"},(0,g.t)("Apply")))))},Kr=e=>{let{title:t,columns:r,onChange:o,config:a,children:s,...l}=e;const[c,d]=(0,i.useState)(!1),u=(0,i.useCallback)((e=>{d(!1),o(e)}),[o]);return(0,E.tZ)(ee.Z,(0,n.Z)({title:t,content:(0,E.tZ)(Wr,{onChange:u,config:a,columns:r}),visible:c,onVisibleChange:d,trigger:["click"],overlayStyle:{width:"450px"}},l),s)},Xr=s.iK.div`
  ${e=>{let{theme:t}=e;return E.iv`
    padding: ${t.gridUnit}px;
    border: solid 1px ${t.colors.grayscale.light2};
    border-radius: ${t.gridUnit}px;
  `}}
`,Jr=(0,s.iK)(B.EQ)`
  &,
  & > div {
    margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    :last-child {
      margin-bottom: 0;
    }
  }
`,en=s.iK.button`
  ${e=>{let{theme:t}=e;return E.iv`
    color: ${t.colors.grayscale.light1};
    height: 100%;
    width: ${6*t.gridUnit}px;
    border: none;
    border-right: solid 1px ${t.colors.grayscale.dark2}0C;
    padding: 0;
    outline: none;
    border-bottom-left-radius: 3px;
    border-top-left-radius: 3px;
  `}}
`;var tn=r(22068);function rn(e){let{displayGhostButton:t=!0,accept:r,valuesRenderer:n,...o}=e;const a=(0,s.Fg)(),[{isOver:l,canDrop:c},d]=(0,tn.L)({accept:r,drop:e=>{o.onDrop(e),null==o.onDropValue||o.onDropValue(e.value)},canDrop:e=>{var t;return o.canDrop(e)&&(null==(t=null==o.canDropValue?void 0:o.canDropValue(e.value))||t)},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop(),type:e.getItemType()})}),u=(0,i.useMemo)((()=>n()),[n]);return(0,E.tZ)("div",{ref:d},(0,E.tZ)(B.gM,null,(0,E.tZ)(N.Z,o)),(0,E.tZ)(B.H$,{canDrop:c,isOver:l},u,t&&(0,E.tZ)(B.SW,{cancelHover:!o.onClickGhostButton,onClick:o.onClickGhostButton},(0,E.tZ)(V.Z.PlusSmall,{iconColor:a.colors.grayscale.light1}),(0,g.t)(o.ghostButtonText))))}var nn,on=r(75294);!function(e){e.Isoline="ISOLINE",e.Isoband="ISOBAND"}(nn||(nn={}));const an=s.iK.div`
  margin-top: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,sn=(0,s.iK)(h.X2)`
  width: 100%;
  gap: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,ln=e=>e&&(e=>!(Object.keys(e).length<4)&&e.upperThreshold&&e.lowerThreshold)(e)?nn.Isoband:nn.Isoline,cn=(e,t)=>{const r={lowerThreshold:[],upperThreshold:[],strokeWidth:[],color:[]},n=(0,on.Z)(t.lowerThreshold);if(n&&r.lowerThreshold.push(n),e===nn.Isoline){const e=(0,on.Z)(t.strokeWidth);e&&r.strokeWidth.push(e)}if(e===nn.Isoband){const e=(0,on.Z)(t.upperThreshold);e&&r.upperThreshold.push(e),!e&&!n&&t.upperThreshold&&t.lowerThreshold&&parseFloat(t.lowerThreshold)>=parseFloat(t.upperThreshold)&&(r.lowerThreshold.push((0,g.t)("Lower threshold must be lower than upper threshold")),r.upperThreshold.push((0,g.t)("Upper threshold must be greater than lower threshold")))}return r},dn={lowerThreshold:void 0,upperThreshold:void 0,color:void 0,strokeWidth:void 0},un=e=>{let{value:t,onSave:r,onClose:n}=e;const[o,a]=(0,i.useState)(ln(t)),[s,l]=(0,i.useState)(t||dn),[c,d]=(0,i.useState)(cn(ln(t),t||dn)),[u,p]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=o===nn.Isoband,t=Boolean(s.lowerThreshold)||0===s.lowerThreshold,r=Boolean(s.upperThreshold)||0===s.upperThreshold,n=Boolean(s.strokeWidth)||0===s.strokeWidth,a="object"==typeof s.color&&"r"in s.color&&"number"==typeof s.color.r&&"g"in s.color&&"number"==typeof s.color.g&&"b"in s.color&&"number"==typeof s.color.b&&"a"in s.color&&"number"==typeof s.color.a,i=cn(o,s);i!==c&&d(i);const l=e?t&&r&&a:t&&a&&n;l!==u&&p(l)}),[s,o]);const m=e=>{const t={...s};t.color={...e,a:100},l(t)},f=e=>{const t={...s};t.lowerThreshold=e,l(t)};return(0,E.tZ)(i.Fragment,null,(0,E.tZ)(ot.ZP,{id:"contour-edit-tabs",onChange:e=>{a(e)},defaultActiveKey:ln(t)},(0,E.tZ)(ot.ZP.TabPane,{className:"adhoc-filter-edit-tab",key:nn.Isoline,tab:(0,g.t)("Isoline")},(0,E.tZ)("div",{key:nn.Isoline,className:"isoline-popover-section"},(0,E.tZ)(sn,null,(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoline-threshold",label:(0,g.t)("Threshold"),description:(0,g.t)("Defines the value that determines the boundary between different regions or levels in the data "),validationErrors:c.lowerThreshold,hovered:!0}),(0,E.tZ)(Qe.Z,{value:s.lowerThreshold,onChange:f}))),(0,E.tZ)(sn,null,(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoline-stroke-width",label:(0,g.t)("Stroke Width"),description:(0,g.t)("The width of the Isoline in pixels"),validationErrors:c.strokeWidth,hovered:!0}),(0,E.tZ)(Qe.Z,{value:s.strokeWidth||"",onChange:e=>{const t={...s};t.strokeWidth=e,l(t)}})),(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoline-color",label:(0,g.t)("Color"),description:(0,g.t)("The color of the isoline"),validationErrors:c.color,hovered:!0}),(0,E.tZ)(ae,{value:"object"==typeof s&&(null==s?void 0:s.color),onChange:m}))))),(0,E.tZ)(ot.ZP.TabPane,{className:"adhoc-filter-edit-tab",key:nn.Isoband,tab:(0,g.t)("Isoband")},(0,E.tZ)("div",{key:nn.Isoband,className:"isoline-popover-section"},(0,E.tZ)(sn,null,(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoband-threshold-lower",label:(0,g.t)("Lower Threshold"),description:(0,g.t)("The lower limit of the threshold range of the Isoband"),validationErrors:c.lowerThreshold,hovered:!0}),(0,E.tZ)(Qe.Z,{value:s.lowerThreshold||"",onChange:f})),(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoband-threshold-upper",label:(0,g.t)("Upper Threshold"),description:(0,g.t)("The upper limit of the threshold range of the Isoband"),validationErrors:c.upperThreshold,hovered:!0}),(0,E.tZ)(Qe.Z,{value:s.upperThreshold||"",onChange:e=>{const t={...s};t.upperThreshold=e,l(t)}}))),(0,E.tZ)(sn,null,(0,E.tZ)(h.JX,{flex:"1"},(0,E.tZ)(N.Z,{name:"isoband-color",label:(0,g.t)("Color"),description:(0,g.t)("The color of the isoband"),validationErrors:c.color,hovered:!0}),(0,E.tZ)(ae,{value:null==s?void 0:s.color,onChange:m})))))),(0,E.tZ)(an,null,(0,E.tZ)(fe.Z,{buttonSize:"small",onClick:n,cta:!0},(0,g.t)("Close")),(0,E.tZ)(fe.Z,{disabled:!u||Object.keys(c).some((e=>c[e].length>0)),buttonStyle:"primary",buttonSize:"small",className:"m-r-5",onClick:()=>{if(u&&r){const e=o===nn.Isoline?(e=>({color:e.color,lowerThreshold:e.lowerThreshold,upperThreshold:void 0,strokeWidth:e.strokeWidth}))(s):(e=>({color:e.color,lowerThreshold:e.lowerThreshold,upperThreshold:e.upperThreshold,strokeWidth:void 0}))(s);r((e=>{const t={...e};return["lowerThreshold","upperThreshold","strokeWidth"].forEach((e=>{t[e]=Number(t[e])})),t})(e)),n&&n()}},cta:!0},(0,g.t)("Save"))))},pn=e=>{let{value:t,saveContour:r,isControlled:n,visible:o,toggleVisibility:a,...s}=e;const[l,c]=(0,i.useState)(!1),d=n?o:l,u=n&&a?a:c,p=(0,E.tZ)(un,{value:t,onSave:r,onClose:()=>u(!1)});return(0,E.tZ)(S.Z,{trigger:"click",content:p,defaultVisible:d,visible:d,onVisibleChange:u,destroyTooltipOnHide:!0},s.children)};var hn=r(27034),mn=r(72813);const gn=(0,s.iK)(v.V)`
  margin: 0 ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`;function fn(e){let{children:t,index:r,clickClose:n,withCaret:o,isExtra:a,datasourceWarningMessage:l,canDelete:c=!0}=e;const d=(0,s.Fg)(),u=(0,i.useCallback)((e=>{e.stopPropagation(),n(r)}),[n,r]);return(0,E.tZ)(B.EQ,{withCaret:o},c&&(0,E.tZ)(B.gu,{role:"button",onClick:u},(0,E.tZ)(V.Z.XSmall,{iconColor:d.colors.grayscale.light1})),(0,E.tZ)(B.__,null,t),(!!l||a)&&(0,E.tZ)(gn,{icon:"exclamation-triangle",placement:"top",bsStyle:"warning",tooltip:l||(0,g.t)("\n                This filter was inherited from the dashboard's context.\n                It won't be saved when saving the chart.\n              ")}),o&&(0,E.tZ)(B.Ne,null,(0,E.tZ)(V.Z.CaretRight,{iconColor:d.colors.grayscale.light1})))}const vn=s.iK.div`
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function _n(e){const{index:t,label:r,tooltipTitle:o,column:a,type:s,onShiftOptions:l,clickClose:c,withCaret:d,isExtra:u,datasourceWarningMessage:p,canDelete:h=!0,tooltipOverlay:m,...g}=e,f=(0,i.useRef)(null),v=(0,i.useRef)(null),[{isDragging:_},b]=(0,hn.c)({item:{type:s,dragIndex:t},collect:e=>({isDragging:e.isDragging()})}),[,y]=(0,tn.L)({accept:s,hover:(e,r)=>{var n;if(!f.current)return;const{dragIndex:o}=e,a=t;if(o===a)return;const i=null==(n=f.current)?void 0:n.getBoundingClientRect(),s=(i.bottom-i.top)/2,c=r.getClientOffset(),d=c?c.y-i.top:0;o<a&&d<s||o>a&&d>s||(l(o,a),e.dragIndex=a)}}),T=!_&&o&&r&&o!==r||!_&&v&&v.current&&v.current.scrollWidth>v.current.clientWidth||!_&&m,S=()=>T?m?(0,E.tZ)(me.u,{overlay:m},(0,E.tZ)("span",null,r)):(0,E.tZ)(me.u,{title:o||r},(0,E.tZ)("span",null,r)):(0,E.tZ)("span",null,r),C=()=>{const e=a&&(0,mn.GA)(a)?{verbose_name:a.label,expression:a.sqlExpression}:a;return(0,E.tZ)(ut.l,{column:e,labelRef:v,showType:!0})};return b(y(f)),(0,E.tZ)(B.a7,(0,n.Z)({ref:f},g),(0,E.tZ)(fn,{index:t,clickClose:c,withCaret:d,isExtra:u,datasourceWarningMessage:p,canDelete:h},(0,E.tZ)((()=>r?(0,E.tZ)(vn,{ref:v},(0,E.tZ)(S,null)):a?(0,E.tZ)(vn,null,(0,E.tZ)(C,null)):null),null)))}const bn=(0,s.iK)(_n)`
  max-width: 100%;
  min-width: 100%;
`,yn=s.iK.li`
  display: flex;
  align-items: center;
`,En=s.iK.div`
  background-color: ${e=>{let{formattedColor:t}=e;return t}};
  height: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  width: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  margin: 0 ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,Tn=e=>{let{contour:t,index:r,saveContour:n,onClose:o,onShift:a}=e;const{lowerThreshold:i,upperThreshold:s,color:l,strokeWidth:c}=t,d=s,u=l?`rgba(${l.r}, ${l.g}, ${l.b}, 1)`:"undefined",p=d?(h=[i||-1,s],`${(0,g.t)("Threshold")}: [${h[0]}, ${h[1]}], color: ${u}`):((e,t)=>`${(0,g.t)("Threshold")}: ${e}, ${(0,g.t)("color")}: ${u}, ${(0,g.t)("stroke width")}: ${t}`)(i||-1,c);var h;const m=(0,E.tZ)("div",{className:"contour-tooltip-overlay"},(0,E.tZ)(yn,null,(0,g.t)("Threshold: "),d?`[${i}, ${s}]`:`${i}`),(0,E.tZ)(yn,null,(0,g.t)("Color: "),(0,E.tZ)(En,{formattedColor:u})," ",u),!d&&(0,E.tZ)(yn,null,`${(0,g.t)("Stroke Width:")} ${c}`));return(0,E.tZ)(pn,{saveContour:n,value:t},(0,E.tZ)(bn,{index:r,label:p,type:"ContourOption",withCaret:!0,clickClose:o,onShiftOptions:a,tooltipOverlay:m}))},Sn=[{lowerThreshold:4,color:{r:255,g:0,b:255,a:100},strokeWidth:1,zIndex:0},{lowerThreshold:5,color:{r:0,g:255,b:0,a:100},strokeWidth:2,zIndex:1},{lowerThreshold:6,upperThreshold:10,color:{r:0,g:0,b:255,a:100},zIndex:2}],Cn=(0,s.iK)("div")`
  position: relative;
  width: calc(100% - ${e=>{let{theme:t}=e;return t.gridUnit}}px);
  bottom: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  left: 0;
`;var Rn=r(41609),Zn=r.n(Rn),An=r(38575),xn=r(53769);const On=e=>(0,An.xN)(e)?e.column_name:e;class wn{constructor(e,t,r){this.values=void 0,this.options=void 0,this.multi=void 0,this.options=e,this.multi=t,this.values=(0,Ge.Z)(r).map((t=>t&&(0,mn.s9)(t)&&t in e?e[t]:(0,mn.s9)(t)?null:t)).filter(Boolean)}add(e){(0,mn.s9)(e)&&e in this.options?this.values.push(this.options[e]):(0,mn.s9)(e)||this.values.push(e)}del(e){this.values.splice(e,1)}replace(e,t){this.values[e]&&(this.values[e]=(0,mn.s9)(t)?this.options[t]:t)}swap(e,t){[this.values[e],this.values[t]]=[this.values[t],this.values[e]]}has(e){return this.values.some((t=>(0,mn.s9)(e)?t.column_name===e||t.label===e:t.column_name===e.label||t.label===e.label))}getValues(){return this.multi?this.values.map(On):this.values.length>0?On(this.values[0]):void 0}}var In=r(23493),Nn=r.n(In);const Dn=(0,s.iK)(h.Ph)`
  .metric-option {
    & > svg {
      min-width: ${e=>{let{theme:t}=e;return 4*t.gridUnit+"px"}};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,Ln=e=>{let{columns:t,editedColumn:r,getCurrentTab:n,hasCustomLabel:o,isTemporal:a,label:s,onChange:l,onClose:c,setDatasetModal:d,setLabel:u}=e;const p=(0,m.v9)((e=>e.explore.datasource.type)),[f]=(0,i.useState)(s),[v,_,b]=(e=>e?(0,mn.GA)(e)?[e,void 0,void 0]:(0,An.zy)(e)?[void 0,e,void 0]:[void 0,void 0,e]:[void 0,void 0,void 0])(r),[y,T]=(0,i.useState)(v),[S,C]=(0,i.useState)(_),[R,Z]=(0,i.useState)(b),[A,x]=(0,i.useState)(null),[O,w,I]=function(e,t){const[r,n]=(0,i.useState)(dt.kc),[o,a]=(0,i.useState)(dt.H7),[s,l]=(0,i.useState)(0),[c,d]=(0,i.useState)(0),[u,p]=(0,i.useState)(0),[h,m]=(0,i.useState)(0),[g,f]=(0,i.useState)(r),[v,_]=(0,i.useState)(o),[b,y]=(0,i.useState)(!1),T=(0,i.useCallback)((e=>{e.preventDefault(),l(e.clientX),d(e.clientY)}),[]),S=(0,i.useCallback)((()=>{y(!1)}),[]),C=(0,i.useCallback)((e=>{p(e.clientX),m(e.clientY),y(!0)}),[]);(0,i.useEffect)((()=>{b?document.addEventListener("mousemove",T):(f(r),_(o),document.removeEventListener("mousemove",T))}),[T,b]);const R=(0,i.useCallback)(Nn()((e=>{let{dragStartX:t,dragStartY:r,dragStartWidth:o,dragStartHeight:i,clientX:s,clientY:l,minWidth:c,minHeight:d}=e;n(Math.max(o+(s-t),c)),a(Math.max(i+(l-r),d))}),50),[a,n]);return(0,i.useEffect)((()=>{b&&R({dragStartX:u,dragStartY:h,dragStartWidth:g,dragStartHeight:v,clientX:s,clientY:c,minWidth:e,minHeight:t})}),[b,s,c,g,v,u,h]),(0,i.useEffect)((()=>(document.addEventListener("mouseup",S),()=>document.removeEventListener("mouseup",S))),[S]),[(0,E.tZ)("i",{role:"button","aria-label":"Resize",tabIndex:0,onMouseDown:C,className:"fa fa-expand edit-popover-resize text-muted"}),r,o]}(dt.kc,dt.H7),N=(0,i.useRef)(null),[D,L]=(0,i.useMemo)((()=>null==t?void 0:t.reduce(((e,t)=>(t.expression?e[0].push(t):e[1].push(t),e)),[[],[]])),[t]),M=(0,i.useCallback)((e=>{T({label:s,sqlExpression:e,expressionType:"SQL"}),Z(void 0),C(void 0)}),[s]),k=(0,i.useCallback)((e=>{const t=D.find((t=>t.column_name===e));C(t),Z(void 0),T(void 0),u((null==t?void 0:t.verbose_name)||(null==t?void 0:t.column_name)||"")}),[D,u]),P=(0,i.useCallback)((e=>{const t=L.find((t=>t.column_name===e));C(void 0),Z(t),T(void 0),u((null==t?void 0:t.verbose_name)||(null==t?void 0:t.column_name)||"")}),[u,L]),U=v?"sqlExpression":b||0===D.length?"simple":"saved";(0,i.useEffect)((()=>{n(U),x(U)}),[U,n,x]),(0,i.useEffect)((()=>{if(void 0===y&&"sqlExpression"===A&&o){const e=(null==R?void 0:R.column_name)||(null==S?void 0:S.expression)||"";T({label:s,sqlExpression:e,expressionType:"SQL"})}}),[y,U,o,n,s,S,R,A]);const $=(0,i.useCallback)((()=>{y&&y.label!==s&&(y.label=s);const e=y||S||R;e&&(l(e),c())}),[y,s,l,c,S,R]),F=(0,i.useCallback)((()=>{C(_),Z(b),T(v),c()}),[v,_,b,c]),q=(0,i.useCallback)((e=>{var t;n(e),x(e),null==(t=N.current)||t.editor.focus()}),[n]),V=(0,i.useCallback)((()=>{var e;null==(e=N.current)||e.editor.resize()}),[]),B=()=>{d&&d(!0),c()},H=y||S||R,j=f!==s||(null==S?void 0:S.column_name)!==(null==_?void 0:_.column_name)||(null==R?void 0:R.column_name)!==(null==b?void 0:b.column_name)||(null==y?void 0:y.sqlExpression)!==(null==v?void 0:v.sqlExpression),z=(0,g.t)("Saved expressions"),Q=(0,g.t)("Column");return(0,E.tZ)(it.l0,{layout:"vertical",id:"metrics-edit-popover"},(0,E.tZ)(ot.ZP,{id:"adhoc-metric-edit-tabs",defaultActiveKey:U,onChange:q,className:"adhoc-metric-edit-tabs",allowOverflow:!0,css:E.iv`
          height: ${I}px;
          width: ${w}px;
        `},(0,E.tZ)(ot.ZP.TabPane,{key:"saved",tab:(0,g.t)("Saved")},D.length>0?(0,E.tZ)(it.xJ,{label:z},(0,E.tZ)(Dn,{ariaLabel:z,value:null==S?void 0:S.column_name,onChange:k,allowClear:!0,autoFocus:!S,placeholder:(0,g.t)("%s column(s)",D.length),options:D.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,customLabel:(0,E.tZ)(ut.l,{column:e,showType:!0}),key:e.column_name})))})):p===ce.i9.Table?(0,E.tZ)(at.Tc,{image:"empty.svg",title:a?(0,g.t)("No temporal columns found"):(0,g.t)("No saved expressions found"),description:a?(0,g.t)('Add calculated temporal columns to dataset in "Edit datasource" modal'):(0,g.t)('Add calculated columns to dataset in "Edit datasource" modal')}):(0,E.tZ)(at.Tc,{image:"empty.svg",title:a?(0,g.t)("No temporal columns found"):(0,g.t)("No saved expressions found"),description:a?(0,E.tZ)(i.Fragment,null,(0,E.tZ)("span",{role:"button",tabIndex:0,onClick:B},(0,g.t)("Create a dataset"))," ",(0,g.t)(" to mark a column as a time column")):(0,E.tZ)(i.Fragment,null,(0,E.tZ)("span",{role:"button",tabIndex:0,onClick:B},(0,g.t)("Create a dataset"))," ",(0,g.t)(" to add calculated columns"))})),(0,E.tZ)(ot.ZP.TabPane,{key:"simple",tab:(0,g.t)("Simple")},a&&0===L.length?(0,E.tZ)(at.Tc,{image:"empty.svg",title:(0,g.t)("No temporal columns found"),description:p===ce.i9.Table?(0,g.t)('Mark a column as temporal in "Edit datasource" modal'):(0,E.tZ)(i.Fragment,null,(0,E.tZ)("span",{role:"button",tabIndex:0,onClick:B},(0,g.t)("Create a dataset"))," ",(0,g.t)(" to mark a column as a time column"))}):(0,E.tZ)(it.xJ,{label:Q},(0,E.tZ)(h.Ph,{ariaLabel:Q,value:null==R?void 0:R.column_name,onChange:P,allowClear:!0,autoFocus:!R,placeholder:(0,g.t)("%s column(s)",L.length),options:L.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,customLabel:(0,E.tZ)(ut.l,{column:e,showType:!0}),key:e.column_name})))}))),(0,E.tZ)(ot.ZP.TabPane,{key:"sqlExpression",tab:(0,g.t)("Custom SQL")},(0,E.tZ)(st.iO,{value:(null==y?void 0:y.sqlExpression)||(null==R?void 0:R.column_name)||(null==S?void 0:S.expression),onFocus:V,showLoadingForImport:!0,onChange:M,width:"100%",height:I-80+"px",showGutter:!1,editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,className:"filter-sql-editor",wrapEnabled:!0,ref:N}))),(0,E.tZ)("div",null,(0,E.tZ)(fe.Z,{buttonSize:"small",onClick:F,cta:!0},(0,g.t)("Close")),(0,E.tZ)(fe.Z,{disabled:!H||!j,buttonStyle:"primary",buttonSize:"small",onClick:$,cta:!0},(0,g.t)("Save")),O))},Mn=(0,s.iK)(I.II)`
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}};
  height: 26px;
  padding-left: ${e=>{let{theme:t}=e;return 2.5*t.gridUnit}}px;
`,kn=e=>{let{title:t,onChange:r,isEditDisabled:n,hasCustomLabel:o}=e;const[a,s]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),d=(0,i.useCallback)((()=>{s(!0)}),[]),u=(0,i.useCallback)((()=>{s(!1)}),[]),p=(0,i.useCallback)((()=>{c(!0)}),[]),h=(0,i.useCallback)((()=>{c(!1)}),[]),m=(0,i.useCallback)((e=>{""===e.target.value&&r(e),h()}),[h,r]),f=(0,g.t)("My column");return n?(0,E.tZ)("span",null,t||f):l?(0,E.tZ)(Mn,{type:"text",placeholder:t,value:o?t:"",autoFocus:!0,onChange:r,onBlur:m}):(0,E.tZ)(me.u,{placement:"top",title:(0,g.t)("Click to edit label")},(0,E.tZ)("span",{className:"AdhocMetricEditPopoverTitle inline-editable",onMouseOver:d,onMouseOut:u,onClick:p,onBlur:h,role:"button",tabIndex:0},t||f,"",(0,E.tZ)("i",{className:"fa fa-pencil",style:{color:a?"black":"grey"}})))},Pn=(0,g.t)("My column"),Un=e=>{let{columns:t,editedColumn:r,onColumnEdit:n,isControlledComponent:o,children:a,isTemporal:s,...l}=e;const c=(0,m.v9)((e=>e.explore.datasource)),[d,u]=(0,i.useState)(Pn),[p,h]=(0,i.useState)(!1),[f,v]=(0,i.useState)(!0),[_,b]=(0,i.useState)(!1),[y,T]=(0,i.useState)(!1);let C=Pn;r&&(0,An.xN)(r)?C=r.verbose_name||r.column_name:r&&(0,mn.GA)(r)&&(C=r.label||Pn),(0,i.useEffect)((()=>{u(C)}),[C,p]);const R=(0,i.useCallback)((e=>{h(e)}),[]),Z=(0,i.useCallback)((()=>{h(!1)}),[]),{visible:A,handleTogglePopover:x,handleClosePopover:O}=o?{visible:l.visible,handleTogglePopover:l.togglePopover,handleClosePopover:l.closePopover}:{visible:p,handleTogglePopover:R,handleClosePopover:Z},w=(0,i.useCallback)((e=>{v("sqlExpression"!==e)}),[]),I=(0,i.useMemo)((()=>(0,E.tZ)(rt.b,null,(0,E.tZ)(Ln,{editedColumn:r,columns:t,setDatasetModal:T,onClose:O,onChange:n,hasCustomLabel:_,label:d,setLabel:u,getCurrentTab:w,isTemporal:s}))),[t,r,w,_,O,s,n,d]),N=(0,i.useCallback)((e=>{u(e.target.value),b(!0)}),[u,b]),D=(0,i.useMemo)((()=>(0,E.tZ)(kn,{title:d,onChange:N,isEditDisabled:f,hasCustomLabel:_})),[_,f,N,d]);return(0,E.tZ)(i.Fragment,null,y&&(0,E.tZ)(Ie.W,{visible:y,onHide:()=>T(!1),buttonTextOnSave:(0,g.t)("Save"),buttonTextOnOverwrite:(0,g.t)("Overwrite"),modalDescription:(0,g.t)("Save this query as a virtual dataset to continue exploring"),datasource:c}),(0,E.tZ)(S.Z,{trigger:"click",content:I,defaultVisible:A,visible:A,onVisibleChange:x,title:D,destroyTooltipOnHide:!0},a))},$n=(0,xn.pO)((function(e){const{value:t,options:r,multi:o=!0,onChange:a,canDelete:s=!0,ghostButtonText:l,name:c,label:d,isTemporal:u}=e,[p,h]=(0,i.useState)(!1),m=(0,i.useMemo)((()=>{const e=Object.fromEntries(r.map((e=>[e.column_name,e])));return new wn(e,o,t)}),[o,r,t]),f=(0,i.useCallback)((e=>{const t=e.value;m.multi||Zn()(m.values)?m.add(t.column_name):m.replace(0,t.column_name),a(m.getValues())}),[a,m]),v=(0,i.useCallback)((e=>{const t=e.value.column_name;return t in m.options&&!m.has(t)}),[m]),_=(0,i.useCallback)((e=>{m.del(e),a(m.getValues())}),[a,m]),b=(0,i.useCallback)(((e,t)=>{m.swap(e,t),a(m.getValues())}),[a,m]),y=(0,i.useCallback)((()=>m.values.map(((e,t)=>{const n=(0,mn.GA)(e)&&e.datasourceWarning?(0,g.t)("This column might be incompatible with current dataset"):void 0;return(0,E.tZ)(Un,{key:t,columns:r,onColumnEdit:e=>{(0,An.xN)(e)?m.replace(t,e.column_name):m.replace(t,e),a(m.getValues())},editedColumn:e,isTemporal:u},(0,E.tZ)(_n,{key:t,index:t,clickClose:_,onShiftOptions:b,type:`${We.g.ColumnOption}_${c}_${d}`,canDelete:s,column:e,datasourceWarningMessage:n,withCaret:!0}))}))),[s,u,d,c,a,_,b,m,r]),T=(0,i.useCallback)((e=>{(0,An.xN)(e)?m.add(e.column_name):m.add(e),a(m.getValues())}),[a,m]),S=(0,i.useCallback)((e=>{h(e)}),[]),C=(0,i.useCallback)((()=>{S(!1)}),[S]),R=(0,i.useCallback)((()=>{S(!0)}),[S]),Z=(0,i.useMemo)((()=>null!=l?l:(0,g.tn)("Drop a column here or click","Drop columns here or click",o?2:1)),[l,o]);return(0,E.tZ)("div",null,(0,E.tZ)(rn,(0,n.Z)({onDrop:f,canDrop:v,valuesRenderer:y,accept:We.g.Column,displayGhostButton:o||0===m.values.length,ghostButtonText:Z,onClickGhostButton:R},e)),(0,E.tZ)(Un,{columns:r,onColumnEdit:T,isControlledComponent:!0,togglePopover:S,closePopover:C,visible:p,isTemporal:u},(0,E.tZ)("div",null)))}),Vt.Z);var Fn=r(68492),qn=r(11146),Vn=r(96055),Bn=r(28543),Hn=r(7848);function jn(e){let{adhocFilter:t,options:r,datasource:n,onFilterEdit:o,onShiftOptions:a,onClickClose:i,partitionColumn:s,index:l}=e;const{actualTimeRange:c,title:d}=(0,Hn.w)(t);return(0,E.tZ)(Vn.Z,{key:l,adhocFilter:t,options:r,datasource:n,onFilterEdit:o,partitionColumn:s},(0,E.tZ)(_n,{key:l,index:l,label:null!=c?c:t.getDefaultLabel(),tooltipTitle:null!=d?d:t.getTooltipTitle(),clickClose:i,onShiftOptions:a,type:We.g.FilterOption,withCaret:!0,isExtra:t.isExtra,datasourceWarningMessage:t.datasourceWarning?(0,g.t)("This filter might be incompatible with current dataset"):void 0}))}var zn=r(61314),Qn=r(61641);const{warning:Gn}=dr.default,Yn=[We.g.Column,We.g.Metric,We.g.MetricOption,We.g.AdhocMetricOption],Wn=e=>!(e instanceof Bn.Z)&&(null==e?void 0:e.expressionType),Kn=(0,xn.pO)((e=>{var t;const{datasource:r,onChange:o=(()=>{}),name:a,canDelete:s}=e,l=Array.from(null!=(t=e.value)?t:[]),[c,d]=(0,i.useState)(l.map((e=>Wn(e)?new Bn.Z(e):e))),[u,p]=(0,i.useState)(void 0),[h,m]=(0,i.useState)(!1),[f,v]=(0,i.useState)({}),_=(e,t)=>[...e,...[...(null==t?void 0:t.metrics)||[],null==t?void 0:t.metric].map((e=>e&&("string"==typeof e?{saved_metric_name:e}:new Ke.Z(e))))].filter((e=>e)).reduce(((e,t)=>("saved_metric_name"in t&&t.saved_metric_name?e.push({...t,filterOptionName:t.saved_metric_name}):"column_name"in t&&t.column_name?e.push({...t,filterOptionName:`_col_${t.column_name}`}):t instanceof Ke.Z&&e.push({...t,filterOptionName:`_adhocmetric_${t.label}`}),e)),[]).sort(((e,t)=>{var r,n;return null!=(r=null==(n=e.saved_metric_name||e.column_name||e.label)?void 0:n.localeCompare(t.saved_metric_name||t.column_name||t.label||""))?r:0})),[b,y]=(0,i.useState)(_(e.columns,e.formData));(0,i.useEffect)((()=>{if(r&&"table"===r.type){var e;const t=null==(e=r.database)?void 0:e.id,{datasource_name:n,schema:o,is_sqllab_view:a}=r;!a&&t&&n&&o&&de.Z.get({endpoint:`/api/v1/database/${t}/table_extra/${n}/${o}/`}).then((e=>{let{json:t}=e;if(null!=t&&t.partitions){const{partitions:e}=t;null!=e&&e.cols&&1===Object.keys(e.cols).length&&p(e.cols[0])}})).catch((e=>{Fn.Z.error("fetch extra_table_metadata:",e.statusText)}))}}),[r]),(0,i.useEffect)((()=>{y(_(e.columns,e.formData))}),[e.columns,e.formData]),(0,i.useEffect)((()=>{d((e.value||[]).map((e=>Wn(e)?new Bn.Z(e):e)))}),[e.value]);const T=(0,i.useCallback)((e=>{const t=[...c];t.splice(e,1),d(t),o(t)}),[o,c]),S=(0,i.useCallback)((e=>{const t=null==s?void 0:s(c[e],c);"string"!=typeof t?T(e):Gn({title:(0,g.t)("Warning"),content:t})}),[s,T,c]),C=(0,i.useCallback)(((e,t)=>{const r=[...c];[r[t],r[e]]=[r[e],r[t]],d(r)}),[c]),R=(0,i.useCallback)((t=>{var r;return null==(r=e.savedMetrics.find((e=>e.metric_name===t)))?void 0:r.expression}),[e.savedMetrics]),Z=(0,i.useCallback)((e=>{if(e instanceof Bn.Z)return e;const t=e;return t.saved_metric_name?new Bn.Z({expressionType:Qn.v.SQL,subject:R(t.saved_metric_name),operator:dt.LT[dt.d.GREATER_THAN].operation,operatorId:dt.d.GREATER_THAN,comparator:0,clause:Qn.P.HAVING}):t.label?new Bn.Z({expressionType:Qn.v.SQL,subject:new Ke.Z(e).translateToSql(),operator:dt.LT[dt.d.GREATER_THAN].operation,operatorId:dt.d.GREATER_THAN,comparator:0,clause:Qn.P.HAVING}):t.column_name?new Bn.Z({expressionType:Qn.v.SIMPLE,subject:t.column_name,operator:dt.LT[dt.d.EQUALS].operation,operatorId:dt.d.EQUALS,comparator:"",clause:Qn.P.WHERE,isNew:!0}):null}),[r.type,R]),A=(0,i.useCallback)((e=>{o(c.map((t=>t.filterOptionName===e.filterOptionName?e:t)))}),[o,c]),x=(0,i.useCallback)((e=>{const t=Z(e);if(t){const e=[...c,t];d(e),o(e)}}),[Z,o,c]),O=(0,i.useCallback)((e=>{m(e)}),[]),w=(0,i.useCallback)((()=>{O(!1)}),[O]),I=(0,i.useCallback)((()=>c.map(((e,t)=>(0,E.tZ)(jn,{index:t,adhocFilter:e,options:b,datasource:r,onFilterEdit:A,partitionColumn:u,onClickClose:S,onShiftOptions:C})))),[S,A,C,b,u,r,c]),N=(0,i.useCallback)((()=>{v({}),O(!0)}),[O]),D=(0,zn.Ct)(),L=(0,i.useMemo)((()=>{if(null==(t=f)?void 0:t.metric_name)return new Bn.Z({expressionType:Qn.v.SQL,clause:Qn.P.HAVING,sqlExpression:null==f?void 0:f.expression});var t;if(f instanceof Ke.Z)return new Bn.Z({expressionType:Qn.v.SQL,clause:Qn.P.HAVING,sqlExpression:null==f?void 0:f.translateToSql()});const r={subject:null==f?void 0:f.column_name};return r.subject&&(r.operator=dt.LT[dt.d.IN].operation,r.operatorId=dt.d.IN),qn.O6&&(0,An.xN)(f)&&(0,ue.x)(null==f?void 0:f.column_name,e.datasource)&&(r.operator=dt.d.TEMPORAL_RANGE,r.operatorId=dt.d.TEMPORAL_RANGE,r.comparator=D),new Bn.Z(r)}),[f]),M=(0,i.useCallback)((()=>!0),[]),k=(0,i.useCallback)((e=>{v(e.value),O(!0)}),[a,O]);return(0,E.tZ)(i.Fragment,null,(0,E.tZ)(rn,(0,n.Z)({onDrop:k,canDrop:M,valuesRenderer:I,accept:Yn,ghostButtonText:(0,g.t)("Drop columns/metrics here or click"),onClickGhostButton:N},e)),(0,E.tZ)(Vn.Z,{adhocFilter:L,options:b,datasource:r,onFilterEdit:x,partitionColumn:u,isControlledComponent:!0,visible:h,togglePopover:O,closePopover:w,requireSave:!!f}))}),Er.Z);var Xn=r(62446),Jn=r(88889);const eo={},to=[We.g.Column,We.g.Metric],ro=(e,t,r)=>e?(0,Ge.Z)(e).filter((e=>(0,Xn.AG)(e)?t.some((t=>t.metric_name===e)):!(0,Xn.nX)(e)||r.some((t=>t.column_name===e.column.column_name)))).map((e=>{if(!(t=e)||t instanceof Ke.Z||"string"==typeof t||!t.expressionType)return e;var t;if((0,Xn.nX)(e)){const t=r.find((t=>t.column_name===e.column.column_name));if(t)return new Ke.Z({...e,column:t})}return new Ke.Z(e)})):[],no=(e,t,r)=>{var n;return null!=(n=null==e?void 0:e.filter((e=>{var n;return Array.isArray(t)?!t.includes(null!=(n=e.metric_name)?n:"")||e.metric_name===r:e})))?n:[]},oo=(0,xn.pO)((e=>{const{onChange:t,multi:r}=e,o=(0,i.useCallback)((e=>{if(null===e)return void t(null);const n=(0,Ge.Z)(e).map((e=>e.metric_name?e.metric_name:e)).filter((e=>e));t(r?n:n[0])}),[r,t]),[a,s]=(0,i.useState)(ro(e.value,e.savedMetrics,e.columns)),[l,c]=(0,i.useState)({}),[d,u]=(0,i.useState)(!1);(0,i.useEffect)((()=>{s(ro(e.value,e.savedMetrics,e.columns))}),[JSON.stringify(e.value),JSON.stringify(e.savedMetrics),JSON.stringify(e.columns)]);const p=(0,i.useCallback)((e=>!("metric"===e.type&&a.includes(e.value.metric_name))),[a]),h=(0,i.useCallback)((t=>{const r=e.multi?[...a,t]:[t];s(r),o(r)}),[o,e.multi,a]),m=(0,i.useCallback)(((e,t)=>{if(t instanceof Ke.Z&&t.equals(e))return;const r=a.map((r=>("metric_name"in t&&r===t.metric_name||void 0!==r.optionName)&&r.optionName===t.optionName?e:r));s(r),o(r)}),[o,a]),f=(0,i.useCallback)((e=>{if(!Array.isArray(a))return;const t=[...a];t.splice(e,1),s(t),o(t)}),[o,a]),v=(0,i.useCallback)(((e,t)=>{const r=[...a];[r[t],r[e]]=[r[e],r[t]],s(r)}),[a]),_=(0,i.useMemo)((()=>no(e.savedMetrics,e.value)),[e.savedMetrics,e.value]),b=(0,i.useCallback)((t=>{var r;return no(e.savedMetrics,e.value,null==(r=e.value)?void 0:r[t])}),[e.savedMetrics,e.value]),y=(0,i.useCallback)((()=>t(r?a:a[0])),[r,t,a]),T=(0,i.useCallback)(((t,n)=>(0,E.tZ)(St,{key:n,index:n,option:t,onMetricEdit:m,onRemoveMetric:f,columns:e.columns,savedMetrics:e.savedMetrics,savedMetricsOptions:b(n),datasource:e.datasource,onMoveLabel:v,onDropLabel:y,type:`${We.g.AdhocMetricOption}_${e.name}_${e.label}`,multi:r,datasourceWarningMessage:t instanceof Ke.Z&&t.datasourceWarning?(0,g.t)("This metric might be incompatible with current dataset"):void 0})),[b,y,v,r,m,f,e.columns,e.datasource,e.label,e.name,e.savedMetrics]),S=(0,i.useCallback)((()=>a.map(((e,t)=>T(e,t)))),[a,T]),C=(0,i.useCallback)((e=>{u(e)}),[]),R=(0,i.useCallback)((()=>{C(!1)}),[C]),Z=(0,i.useCallback)((e=>{e.type===We.g.Metric&&h(e.value),e.type===We.g.Column&&(c(e),C(!0))}),[h,C]),A=(0,i.useCallback)((()=>{c({}),C(!0)}),[C]),x=(0,i.useMemo)((()=>{if((null==(e=l)?void 0:e.value)&&(null==e?void 0:e.type)&&l.type===We.g.Column){const e=l.value,t={column:e};return e.type_generic===Jn.Z.NUMERIC?t.aggregate=dt.YY.SUM:e.type_generic!==Jn.Z.STRING&&e.type_generic!==Jn.Z.BOOLEAN&&e.type_generic!==Jn.Z.TEMPORAL||(t.aggregate=dt.YY.COUNT_DISTINCT),new Ke.Z(t)}var e;return new Ke.Z({})}),[l]),O=(0,g.tn)("Drop a column/metric here or click","Drop columns/metrics here or click",r?2:1);return(0,E.tZ)("div",{className:"metrics-select"},(0,E.tZ)(rn,(0,n.Z)({onDrop:Z,canDrop:p,valuesRenderer:S,accept:to,ghostButtonText:O,displayGhostButton:r||0===a.length,onClickGhostButton:A},e)),(0,E.tZ)(_t,{adhocMetric:x,onMetricEdit:h,columns:e.columns,savedMetricsOptions:_,savedMetric:eo,datasource:e.datasource,isControlledComponent:!0,visible:d,togglePopover:C,closePopover:R,isNew:!0},(0,E.tZ)("div",null)))}),It);var ao=r(9870),io=r(35622),so=r(46488),lo=r(872),co=r(58842);const uo={controlType:"Select",label:(0,g.t)("D3 format"),description:co.YD,options:co.F6.map((e=>({value:e[0],label:e[1]}))),defaultValue:co.F6[0][0],creatable:!0,minWidth:"14em",debounceDelay:500},po={controlType:"Select",label:(0,g.t)("D3 format"),description:co.oq,options:co.HC.map((e=>({value:e[0],label:e[1]}))),defaultValue:co.HC[0][0],creatable:!0,minWidth:"10em",debounceDelay:500},ho={controlType:"Slider",label:(0,g.t)("Fraction digits"),description:(0,g.t)("Number of decimal digits to round numbers to"),min:0,step:1,max:100,defaultValue:100},mo={controlType:"InputNumber",label:(0,g.t)("Min Width"),description:(0,g.t)("Default minimal column width in pixels, actual width may still be larger than this if other columns don't need much space"),width:120,placeholder:(0,g.t)("auto"),debounceDelay:400,validators:[lo.Z]},go={controlType:"RadioButtonControl",label:(0,g.t)("Text align"),description:(0,g.t)("Horizontal alignment"),width:130,debounceDelay:50,defaultValue:"left",options:[["left",(0,E.tZ)(V.Z.AlignLeftOutlined,{iconSize:"m"})],["center",(0,E.tZ)(V.Z.AlignCenterOutlined,{iconSize:"m"})],["right",(0,E.tZ)(V.Z.AlignRightOutlined,{iconSize:"m"})]]},fo={controlType:"Checkbox",label:(0,g.t)("Show cell bars"),description:(0,g.t)("Whether to display a bar chart background in table columns"),defaultValue:!0,debounceDelay:200},vo={controlType:"Checkbox",label:(0,g.t)("Align +/-"),description:(0,g.t)("Whether to align positive and negative values in cell bar chart at 0"),defaultValue:!1,debounceDelay:200},_o={controlType:"Checkbox",label:(0,g.t)("Color +/-"),description:(0,g.t)("Whether to colorize numeric values by if they are positive or negative"),defaultValue:!1,debounceDelay:200},bo={controlType:"Checkbox",label:(0,g.t)("Truncate Cells"),description:(0,g.t)('Truncate long cells to the "min width" set above'),defaultValue:!1,debounceDelay:400},yo={controlType:"CurrencyControl",label:(0,g.t)("Currency format"),description:(0,g.t)("Customize chart metrics or columns with currency symbols as prefixes or suffixes. Choose a symbol from dropdown or type your own."),debounceDelay:200},Eo={d3NumberFormat:uo,d3SmallNumberFormat:{...uo,label:(0,g.t)("Small number format"),description:(0,g.t)("D3 number format for numbers between -1.0 and 1.0, useful when you want to have different significant digits for small and large numbers")},d3TimeFormat:po,fractionDigits:ho,columnWidth:mo,truncateLongCells:bo,horizontalAlign:go,showCellBars:fo,alignPositiveNegative:vo,colorPositiveNegative:_o,currencyFormat:yo},To={[Jn.Z.STRING]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}],["truncateLongCells"]],[Jn.Z.NUMERIC]:[{tab:(0,g.t)("Display"),children:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"right"}}],["showCellBars"],["alignPositiveNegative"],["colorPositiveNegative"]]},{tab:(0,g.t)("Number formatting"),children:[["d3NumberFormat"],["d3SmallNumberFormat"],["currencyFormat"]]}],[Jn.Z.TEMPORAL]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}],["d3TimeFormat"]],[Jn.Z.BOOLEAN]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}]]};function So(e){return!(null==e||!e.tab)}var Co=r(68122);const Ro={Slider:jt,InputNumber:I.Rn,Input:I.II,Select:h.Ph,Checkbox:U.Z,RadioButtonControl:d.default.RadioButtonControl,CurrencyControl:ao.Z};function Zo(e){let{name:t,label:r,description:o,width:a,validators:l,onChange:c,value:d,defaultValue:u,controlType:p,...h}=e;const{gridUnit:m}=(0,s.Fg)(),[g,f]=(0,i.useState)(!1),[v,_]=(0,i.useState)(void 0===d?u:d),[b,y]=(0,i.useState)(),T=e=>{const t=e&&"object"==typeof e&&"target"in e?"checkbox"===e.target.type||"radio"===e.target.type?e.target.checked:e.target.value:e,r=(null==l?void 0:l.map((e=>!function(e){return null==e||""===e}(t)&&e(t))).filter((e=>!!e)))||[];y(r),_(t),0===r.length&&c&&c(t)},S=Ro[p];return(0,E.tZ)("div",{css:(0,E.iv)({margin:2*m,width:a,maxWidth:"100%",flex:1},"",""),onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1)},"Checkbox"===p?(0,E.tZ)(Ro.Checkbox,(0,n.Z)({value:v,onChange:T,name:t,label:r,description:o,validationErrors:b},h)):(0,E.tZ)(i.Fragment,null,r&&(0,E.tZ)(N.Z,{name:t,label:r,description:o,validationErrors:b,hovered:g}),(0,E.tZ)(S,(0,n.Z)({},h,{value:v,onChange:T}))))}function Ao(e){let{children:t}=e;const{gridUnit:r}=(0,s.Fg)();return(0,E.tZ)("div",{css:(0,E.iv)({display:"flex",flexWrap:"nowrap",marginBottom:r,maxWidth:"100%"},"","")},t)}function xo(e){let{onChange:t,value:r,children:n}=e;const o=(0,s.Fg)(),a=(0,i.useMemo)((()=>({0:t,[Co.o]:w()(t,Co.o)})),[t]),l=i.Children.map(n,(e=>{if("children"in e.props){const n=Array.isArray(e.props.children)?100/e.props.children.length+"%":void 0;return i.cloneElement(e,{children:i.Children.map(e.props.children,(e=>{const{name:o,width:s,debounceDelay:l=Co.o,onChange:c}=e.props;return i.cloneElement(e,{width:s||n,value:null==r?void 0:r[o],debounceDelay:void 0,onChange(e){c&&c(e),l in a||(a[l]=w()(t,l)),a[l]({...r,[o]:e})}})}))})}return e}));return(0,E.tZ)("div",{css:(0,E.iv)({label:{textTransform:"uppercase",color:o.colors.text.label,fontSize:o.typography.sizes.s}},"","")},l)}function Oo(e){let{column:t,configFormLayout:r,onChange:o}=e;const a=(e,t)=>(0,E.tZ)(Ao,{key:t},e.map((e=>{const t="string"==typeof e?e:e.name,r="string"==typeof e?{}:"override"in e?e.override:e.config,o={...t in Eo?Eo[t]:void 0,...r};return(0,E.tZ)(Zo,(0,n.Z)({key:t,name:t},o))}))),i=r[void 0===t.type?Jn.Z.STRING:t.type];return So(i[0])?(0,E.tZ)(ot.ZP,{centered:!0},i.map(((e,r)=>So(e)?(0,E.tZ)(ot.ZP.TabPane,{tab:e.tab,key:r},(0,E.tZ)(xo,{onChange:o,value:t.config},e.children.map(((e,t)=>a(e,t))))):null))):(0,E.tZ)(xo,{onChange:o,value:t.config},i.map(((e,t)=>a(e,t))))}const wo=i.memo((function(e){let{column:t,onChange:r,configFormLayout:n,width:o,height:a}=e;const{colors:i,gridUnit:l}=(0,s.Fg)(),c=6*l;return(0,E.tZ)(ee.Z,{title:t.name,content:()=>(0,E.tZ)(Oo,{column:t,onChange:r,configFormLayout:n}),trigger:"click",placement:"right",overlayInnerStyle:{width:o,height:a},overlayClassName:"column-config-popover"},(0,E.tZ)("div",{css:(0,E.iv)({display:"flex",alignItems:"center",cursor:"pointer",padding:`${l}px ${2*l}px`,borderBottom:`1px solid ${i.grayscale.light2}`,position:"relative",paddingRight:c,"&:last-child":{borderBottom:"none"},"&:hover":{background:i.grayscale.light4},"> .fa":{color:i.grayscale.light2},"&:hover > .fa":{color:i.grayscale.light1}},"")},(0,E.tZ)(so.j,{type:t.type}),t.name,(0,E.tZ)("i",{className:"fa fa-caret-right",css:(0,E.iv)({position:"absolute",right:3*l,top:3*l},"")})))})),Io={AnnotationLayerControl:x,BoundsControl:P,CheckboxControl:U.Z,CollectionControl:K,ColorPickerControl:ae,ColorSchemeControl:ie.Z,ColumnConfigControl:function(e){let{queryResponse:t,appliedColumnNames:r=[],value:n,onChange:o,configFormLayout:a=To,width:l,height:c,...d}=e;const{colnames:u,coltypes:p}=t||{};let h=[],m=[];if(0===r.length)h=u||[],m=p||[];else{const e=new Set(r);null==u||u.forEach(((t,r)=>{e.has(t)&&(h.push(t),m.push(null==p?void 0:p[r]))}))}const f=(0,s.Fg)(),v=(0,i.useMemo)((()=>{var e;const t={};return null==(e=h)||e.forEach(((e,r)=>{var o;t[e]={name:io.DS[e]||e,type:null==(o=m)?void 0:o[r],config:(null==n?void 0:n[e])||{}}})),t}),[n,h,m]),[_,b]=(0,i.useState)(!1),y=e=>v[e]||{};if(!h||0===h.length)return null;const T=h.length>12,S=T&&!_?h.slice(0,10):h;return(0,E.tZ)(i.Fragment,null,(0,E.tZ)(N.Z,d),(0,E.tZ)("div",{css:(0,E.iv)({border:`1px solid ${f.colors.grayscale.light2}`,borderRadius:f.gridUnit},"","")},S.map((e=>(0,E.tZ)(wo,{key:e,column:y(e),onChange:t=>((e,t)=>{if(o){const r=h&&n?Object.fromEntries(Object.entries(n).filter((e=>{let[t]=e;return h.includes(t)}))):{...n};o({...r,[e]:t})}})(e,t),configFormLayout:a,width:l,height:c}))),T&&(0,E.tZ)("div",{role:"button",tabIndex:-1,css:(0,E.iv)({padding:2*f.gridUnit,textAlign:"center",cursor:"pointer",textTransform:"uppercase",fontSize:f.typography.sizes.xs,color:f.colors.text.label,":hover":{backgroundColor:f.colors.grayscale.light4}},"",""),onClick:()=>b(!_)},_?(0,E.tZ)(i.Fragment,null,(0,E.tZ)("i",{className:"fa fa-angle-up"}),"  ",(0,g.t)("Show less columns")):(0,E.tZ)(i.Fragment,null,(0,E.tZ)("i",{className:"fa fa-angle-down"})," ",(0,g.t)("Show all columns")))))},CurrencyControl:ao.Z,DatasourceControl:Be,DateFilterControl:He.ZP,DndColumnSelectControl:rn,DndColumnSelect:$n,DndFilterSelect:Kn,DndMetricSelect:oo,FixedOrMetricControl:Pt,HiddenControl:function(e){return(0,E.tZ)(I.II,{type:"hidden",value:e.value})},SelectAsyncControl:qt,SelectControl:Vt.Z,SliderControl:function(e){let{default:t,name:r,label:o,description:a,renderTrigger:s,rightNode:l,leftNode:c,validationErrors:d,hovered:u,warning:p,danger:h,onClick:m,tooltipOnClick:g,onChange:f=(()=>{}),...v}=e;const _={name:r,label:o,description:a,renderTrigger:s,rightNode:l,leftNode:c,validationErrors:d,onClick:m,hovered:u,tooltipOnClick:g,warning:p,danger:h};return(0,E.tZ)(i.Fragment,null,(0,E.tZ)(N.Z,_),(0,E.tZ)(jt,(0,n.Z)({},v,{onChange:f,defaultValue:t})))},SpatialControl:zt.Z,TextAreaControl:Qt.Z,TextControl:Qe.Z,TimeSeriesColumnControl:rr,ViewportControl:ir,VizTypeControl:e=>{let{value:t,onChange:r=ct.EI,isModalOpenInit:n}=e;const[o,a]=(0,i.useState)(!!n),[s,l]=(0,i.useState)(0),[c,d]=(0,i.useState)(t),u=(0,i.useCallback)((()=>{a(!0)}),[]),p=(0,i.useCallback)((()=>{r(c),a(!1)}),[c,r]),h=(0,i.useCallback)((()=>{a(!1),l((e=>e+1)),d(t)}),[t]);return(0,E.tZ)(i.Fragment,null,(0,E.tZ)("div",{css:e=>E.iv`
          min-width: ${72*e.gridUnit}px;
          max-width: fit-content;
        `},(0,E.tZ)(fr,{onChange:r,currentSelection:t}),t&&(0,E.tZ)(br,{vizType:t})),(0,E.tZ)("div",{css:e=>E.iv`
          display: flex;
          justify-content: flex-end;
          margin-top: ${3*e.gridUnit}px;
          color: ${e.colors.grayscale.base};
          text-decoration: underline;
        `},(0,E.tZ)("span",{role:"button",tabIndex:0,onClick:u},(0,g.t)("View all charts"))),(0,E.tZ)(yr,{show:o,onHide:h,title:(0,g.t)("Select a visualization type"),primaryButtonName:(0,g.t)("Select"),disablePrimaryButton:!c,onHandledPrimaryAction:p,maxWidth:`${pr.UB}px`,responsive:!0},(0,E.tZ)(pr.ZP,{key:s,selectedViz:c,onChange:d,onDoubleClick:p,denyList:vr})))},MetricsControl:It,AdhocFilterControl:Er.Z,FilterBoxItemControl:wr,ConditionalFormattingControl:e=>{let{value:t,onChange:r,columnOptions:n,verboseMap:o,removeIrrelevantConditions:a,...l}=e;const c=(0,s.Fg)(),[d,u]=(0,i.useState)(null!=t?t:[]);return(0,i.useEffect)((()=>{r&&r(d)}),[d,r]),(0,i.useEffect)((()=>{if(a){const e=d.filter((e=>n.some((t=>(null==t?void 0:t.value)===(null==e?void 0:e.column)))));e.length!==d.length&&a&&u(e)}}),[d,n,a]),(0,E.tZ)("div",null,(0,E.tZ)(N.Z,l),(0,E.tZ)(Xr,null,d.map(((e,t)=>(0,E.tZ)(Jr,{key:t},(0,E.tZ)(en,{onClick:()=>(e=>{u((t=>t.filter(((t,r)=>r!==e))))})(t)},(0,E.tZ)(V.Z.XSmall,{iconColor:c.colors.grayscale.light1})),(0,E.tZ)(Kr,{title:(0,g.t)("Edit formatter"),config:e,columns:n,onChange:e=>((e,t)=>{const r=[...d];r.splice(t,1,e),u(r)})(e,t),destroyTooltipOnHide:!0},(0,E.tZ)(B.EQ,{withCaret:!0},(0,E.tZ)(B.__,null,(e=>{var t;let{column:r,operator:n,targetValue:a,targetValueLeft:i,targetValueRight:s}=e;const l=null!=(t=r&&(null==o?void 0:o[r]))?t:r;switch(n){case Ir.NONE:return`${l}`;case Ir.BETWEEN:return`${i} ${Ir.LESS_THAN} ${l} ${Ir.LESS_THAN} ${s}`;case Ir.BETWEEN_OR_EQUAL:return`${i} ${Ir.LESS_OR_EQUAL} ${l} ${Ir.LESS_OR_EQUAL} ${s}`;case Ir.BETWEEN_OR_LEFT_EQUAL:return`${i} ${Ir.LESS_OR_EQUAL} ${l} ${Ir.LESS_THAN} ${s}`;case Ir.BETWEEN_OR_RIGHT_EQUAL:return`${i} ${Ir.LESS_THAN} ${l} ${Ir.LESS_OR_EQUAL} ${s}`;default:return`${l} ${n} ${a}`}})(e)),(0,E.tZ)(B.Ne,null,(0,E.tZ)(V.Z.CaretRight,{iconColor:c.colors.grayscale.light1}))))))),(0,E.tZ)(Kr,{title:(0,g.t)("Add new formatter"),columns:n,onChange:e=>{u((t=>[...t,e]))},destroyTooltipOnHide:!0},(0,E.tZ)(B.SW,null,(0,E.tZ)(V.Z.PlusSmall,{iconColor:c.colors.grayscale.light1}),(0,g.t)("Add new color formatter")))))},XAxisSortControl:function(e){const[t,r]=(0,i.useState)(e.value);return(0,i.useEffect)((()=>{e.shouldReset&&(e.onChange(void 0),r(null))}),[e.shouldReset,e.value]),(0,E.tZ)(Vt.Z,(0,n.Z)({},e,{value:t}))},ContourControl:e=>{let{onChange:t,...r}=e;const[o,a]=(0,i.useState)(!1),[s,l]=(0,i.useState)(null!=r&&r.value?null==r?void 0:r.value:Sn);(0,i.useEffect)((()=>{const e=s.map(((e,t)=>({...e,zIndex:10*(t+1)})));null==t||t(e)}),[t,s]);const c=e=>{a(e)},d=e=>{const t=[...s];t.splice(e,1),l(t)},u=(e,t)=>{const r=[...s];[r[e],r[t]]=[r[t],r[e]],l(r)},p=(0,g.t)("Click to add a contour");return(0,E.tZ)(i.Fragment,null,(0,E.tZ)(rn,(0,n.Z)({onDrop:()=>{},canDrop:()=>!0,valuesRenderer:()=>s.map(((e,t)=>(0,E.tZ)(Tn,{key:t,saveContour:e=>((e,t)=>{const r=[...s];r[t]=e,l(r)})(e,t),contour:e,index:t,onClose:d,onShift:u}))),accept:[],ghostButtonText:p,onClickGhostButton:()=>{c(!0)}},r)),(0,E.tZ)(pn,{saveContour:e=>{l([...s,e]),c(!1)},isControlled:!0,visible:o,toggleVisibility:a},(0,E.tZ)(Cn,null)))},...d.default},No=Io,Do=s.iK.div`
  padding-bottom: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
`;function Lo(e){const{actions:{setControlValue:t},name:r,type:o,hidden:s,isVisible:d,resetOnHide:u=!0}=e,[p,h]=(0,i.useState)(!1),m=(0,l.D)(d),g=(0,i.useCallback)(((e,n)=>t(r,e,n)),[r,t]);if((0,i.useEffect)((()=>{!0===m&&!1===d&&void 0!==e.default&&!a()(e.value,e.default)&&u&&(null==t||t(r,e.default))}),[r,m,d,t,e.value,e.default]),!o||!1===d)return null;const f="string"==typeof o?No[o]:o;return f?(0,E.tZ)(Do,{className:"Control",style:s?{display:"none"}:void 0,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)},(0,E.tZ)(c.Z,null,(0,E.tZ)(f,(0,n.Z)({onChange:g,hovered:p},e)))):(console.warn(`Unknown controlType: ${o}`),null)}},82342:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(67294),o=r(11965),a=r(51995),i=r(61988),s=r(9882),l=r(58593),c=r(49238),d=r(70707);const u=o.iv`
  &.anticon {
    font-size: unset;
    .anticon {
      line-height: unset;
      vertical-align: unset;
    }
  }
`,p=e=>{let{name:t,label:r,description:p,validationErrors:h=[],renderTrigger:m=!1,rightNode:g,leftNode:f,onClick:v,hovered:_=!1,tooltipOnClick:b=(()=>{}),warning:y,danger:E}=e;const{gridUnit:T,colors:S}=(0,a.Fg)(),C=(0,n.useRef)(!1),R=(0,n.useMemo)((()=>(h.length||(C.current=!0),C.current?h.length?S.error.base:"unset":S.alert.base)),[S.error.base,S.alert.base,h.length]);return r?(0,o.tZ)("div",{className:"ControlHeader"},(0,o.tZ)("div",{className:"pull-left"},(0,o.tZ)(c.lX,{css:e=>o.iv`
            margin-bottom: ${.5*e.gridUnit}px;
            position: relative;
          `},f&&(0,o.tZ)("span",null,f),(0,o.tZ)("span",{role:"button",tabIndex:0,onClick:v,style:{cursor:v?"pointer":""}},r)," ",y&&(0,o.tZ)("span",null,(0,o.tZ)(l.u,{id:"error-tooltip",placement:"top",title:y},(0,o.tZ)(d.Z.AlertSolid,{iconColor:S.alert.base,iconSize:"s"}))," "),E&&(0,o.tZ)("span",null,(0,o.tZ)(l.u,{id:"error-tooltip",placement:"top",title:E},(0,o.tZ)(d.Z.ErrorSolid,{iconColor:S.error.base,iconSize:"s"}))," "),(null==h?void 0:h.length)>0&&(0,o.tZ)("span",null,(0,o.tZ)(l.u,{id:"error-tooltip",placement:"top",title:null==h?void 0:h.join(" ")},(0,o.tZ)(d.Z.ExclamationCircleOutlined,{css:o.iv`
                    ${u};
                    color: ${R};
                  `}))," "),_?(0,o.tZ)("span",{css:()=>o.iv`
          position: absolute;
          top: 50%;
          right: 0;
          padding-left: ${T}px;
          transform: translate(100%, -50%);
          white-space: nowrap;
        `},p&&(0,o.tZ)("span",null,(0,o.tZ)(l.u,{id:"description-tooltip",title:p,placement:"top"},(0,o.tZ)(d.Z.InfoCircleOutlined,{css:u,onClick:b}))," "),m&&(0,o.tZ)("span",null,(0,o.tZ)(s.V,{label:(0,i.t)("bolt"),tooltip:(0,i.t)("Changing this control takes effect instantly"),placement:"top",icon:"bolt"})," ")):null)),g&&(0,o.tZ)("div",{className:"pull-right"},g),(0,o.tZ)("div",{className:"clearfix"})):null}},61357:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(67294),o=r(11965);const a=12;function i(e){let{controls:t}=e;const r=(0,n.useCallback)((e=>"HiddenControl"===(null==e?void 0:e.props.type)||!1===(null==e?void 0:e.props.isVisible)),[]),i=t.filter((e=>!r(e))),s=i.length?a/i.length:a;return(0,o.tZ)("div",{className:"row"},t.map(((e,t)=>(0,o.tZ)("div",{className:`col-lg-${s} col-xs-12`,style:{display:r(e)?"none":"block"},key:t},e))))}},50909:(e,t,r)=>{"use strict";r.d(t,{C4:()=>L,HS:()=>A,_q:()=>k,m:()=>Z,qi:()=>R,uy:()=>x});var n=r(11965),o=r(67294),a=r(51995),i=r(61988),s=r(51115),l=r(42846),c=r(88889),d=r(32103),u=r(23279),p=r.n(u),h=r(4715),m=r(9875),g=r(27600),f=r(87183),v=r(70707),_=r(35932),b=r(99299),y=r(54076),E=r(13433),T=r(89555),S=r(61587);const C=(0,a.iK)("span")`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light1}};
`,R=(0,a.iK)(_.Z)`
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;

  // needed to override button's first-of-type margin: 0
  && {
    margin: 0 ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  }

  i {
    padding: 0 ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`,Z=e=>{let{data:t,columns:r}=e;const o=(0,a.Fg)();return(0,n.tZ)(E.Z,{text:t&&r?(0,y.Mv)(t,r):"",wrapped:!1,copyNode:(0,n.tZ)(v.Z.CopyOutlined,{iconColor:o.colors.grayscale.base,iconSize:"l","aria-label":(0,i.t)("Copy"),role:"button",css:n.iv`
            &.anticon > * {
              line-height: 0;
            }
          `})})},A=e=>{let{onChangeHandler:t}=e;const r=(0,a.Fg)(),o=p()(t,g.M$);return(0,n.tZ)(m.II,{prefix:(0,n.tZ)(v.Z.Search,{iconColor:r.colors.grayscale.base}),placeholder:(0,i.t)("Search"),onChange:e=>{const t=e.target.value;o(t)},css:n.iv`
        width: 200px;
        margin-right: ${2*r.gridUnit}px;
      `})},x=e=>{var t;let{data:r,loading:o}=e;return(0,n.tZ)(T.Z,{rowcount:null!=(t=null==r?void 0:r.length)?t:0,loading:o})};var O;!function(e){e.Formatted="formatted",e.Original="original"}(O||(O={}));const w=e=>{let{onChange:t,value:r}=e;return(0,n.tZ)(f.Y.Group,{value:r,onChange:t},(0,n.tZ)(h.T,{direction:"vertical"},(0,n.tZ)(f.Y,{value:O.Formatted},(0,i.t)("Formatted date")),(0,n.tZ)(f.Y,{value:O.Original},(0,i.t)("Original value"))))},I=a.iK.div`
  display: flex;
  flex-direction: column;

  padding: ${e=>{let{theme:t}=e;return 4*t.gridUnit+"px"}};
`,N=a.iK.span`
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
  margin-bottom: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  text-transform: uppercase;
`,D=e=>{let{columnName:t,onTimeColumnChange:r,datasourceId:s,isOriginalTimeColumn:l}=e;const c=(0,a.Fg)(),d=e=>{r(t,e.target.value)},u=(0,o.useMemo)((()=>s?(0,n.tZ)(I,{onClick:e=>e.stopPropagation()},(0,n.tZ)(n.xB,{styles:n.iv`
              .column-formatting-popover .ant-popover-inner-content {
                padding: 0;
              }
            `}),(0,n.tZ)(N,null,(0,i.t)("Column Formatting")),(0,n.tZ)(w,{onChange:d,value:l?O.Original:O.Formatted})):null),[s,l]);return s?(0,n.tZ)("span",null,(0,n.tZ)(b.Z,{overlayClassName:"column-formatting-popover",trigger:"click",content:u,placement:"bottomLeft",arrowPointAtCenter:!0},(0,n.tZ)(v.Z.SettingOutlined,{iconSize:"m",iconColor:c.colors.grayscale.light1,css:(0,n.iv)({marginRight:`${c.gridUnit}px`},"",""),onClick:e=>e.stopPropagation()})),t):(0,n.tZ)("span",null,t)},L=(e,t)=>{const r=(0,o.useMemo)((()=>{var e;return null!=(e=null==t?void 0:t.map((e=>Object.values(e).map((e=>e?e.toString().toLowerCase():(0,i.t)("N/A"))))))?e:[]}),[t]);return(0,o.useMemo)((()=>null!=t&&t.length?t.filter(((t,n)=>r[n].some((t=>null==t?void 0:t.includes(e.toLowerCase()))))):[]),[t,e,r])},M=(0,s.bt)(l.default.DATABASE_DATETIME),k=(e,t,r,a,i,s,l)=>{const[u,p]=(0,o.useState)((0,S.W)(a)),h=(e,t)=>{if(a)if(t!==O.Original||u.includes(e)){if(t===O.Formatted&&u.includes(e)){const t=(0,S.W)(a);t.splice(t.indexOf(e),1),(0,S.e)(a,t),p(t)}}else{const t=(0,S.W)(a);t.push(e),(0,S.e)(a,t),p(t)}};return(0,o.useEffect)((()=>{i&&p((0,S.W)(a))}),[a,i]),(0,o.useMemo)((()=>e&&null!=r&&r.length?e.filter((e=>Object.keys(r[0]).includes(e))).map(((e,o)=>{const i=null==t?void 0:t[o],p=r[0][e],m=i===c.Z.TEMPORAL?u.indexOf(e):-1,f=u.includes(e);return{id:e||o,accessor:t=>t[e],Header:i===c.Z.TEMPORAL&&"string"!=typeof p?(0,n.tZ)(D,{columnName:e,datasourceId:a,onTimeColumnChange:h,isOriginalTimeColumn:f}):e,Cell:e=>{let{value:t}=e;return!0===t?g.Ly:!1===t?g.gz:null===t?(0,n.tZ)(C,null,g.Wq):i===c.Z.TEMPORAL&&-1===m&&"number"==typeof t?M(t):"string"==typeof t&&l?(0,d.Ul)(t):String(t)},...null==s?void 0:s[e]}})):[]),[e,r,t,a,s,u])}},61587:(e,t,r)=>{"use strict";r.d(t,{W:()=>a,e:()=>i});var n=r(55786),o=r(61337);const a=e=>{const t=(0,o.rV)(o.dR.explore__data_table_original_formatted_time_columns,{});return void 0===e?[]:(0,n.Z)(t[e])},i=(e,t)=>{const r=(0,o.rV)(o.dR.explore__data_table_original_formatted_time_columns,{});(0,o.LS)(o.dR.explore__data_table_original_formatted_time_columns,{...r,[e]:t})}},42753:(e,t,r)=>{"use strict";var n;r.d(t,{g:()=>n}),function(e){e.Column="column",e.ColumnOption="columnOption",e.AdhocColumnOption="adhocColumn",e.Metric="metric",e.MetricOption="metricOption",e.AdhocMetricOption="adhocMetric",e.FilterOption="filterOption"}(n||(n={}))},63325:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});const n=r(51995).iK.div`
  .edit-popover-resize {
    transform: scaleX(-1);
    float: right;
    margin-top: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
    margin-right: ${e=>{let{theme:t}=e;return-2*t.gridUnit}}px;
    cursor: nwse-resize;
  }
  .filter-sql-editor {
    border: ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}} solid thin;
  }
`},89555:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l}),r(67294);var n=r(67190),o=r(61988),a=r(37921),i=r(58593),s=r(11965);function l(e){const{rowcount:t=0,limit:r,loading:l}=e,c=t===r,d=c||0===t&&!l?"danger":"default",u=(0,n.JB)()(t),p=(0,s.tZ)(a.Z,{type:d},l?(0,o.t)("Loading..."):(0,s.tZ)("span",null,(0,o.tn)("%s row","%s rows",t,u)));return c?(0,s.tZ)(i.u,{id:"tt-rowcount-tooltip",title:(0,s.tZ)("span",null,(0,o.t)("Limit reached"))},p):p}},76787:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var n=r(73126),o=r(23560),a=r.n(o),i=r(67294),s=r(51995),l=r(61988),c=r(4715),d=r(82342),u=r(58593),p=r(70707),h=r(11965);function m(e){const{id:t,label:r,colors:n}=e,[o,a]=(0,i.useState)(!1),s=(0,i.useRef)(null),l=(0,i.useRef)(null),c=()=>n.map(((e,r)=>(0,h.tZ)("span",{key:`${t}-${r}`,css:t=>h.iv`
          padding-left: ${t.gridUnit/2}px;
          :before {
            content: '';
            display: inline-block;
            background-color: ${e};
            border: 1px solid ${"white"===e?"black":e};
            width: 9px;
            height: 10px;
          }
        `})));return(0,h.tZ)(u.u,{"data-testid":"tooltip",overlayClassName:"color-scheme-tooltip",title:()=>(0,h.tZ)(i.Fragment,null,(0,h.tZ)("span",null,r),(0,h.tZ)("div",null,c())),key:t,visible:o},(0,h.tZ)("span",{className:"color-scheme-option",onMouseEnter:()=>{const e=s.current,t=l.current;e&&t&&(e.scrollWidth>e.offsetWidth||e.scrollHeight>e.offsetHeight||t.scrollWidth>t.offsetWidth||t.scrollHeight>t.offsetHeight)&&a(!0)},onMouseLeave:()=>{a(!1)},css:h.iv`
          display: flex;
          align-items: center;
          justify-content: flex-start;
        `},(0,h.tZ)("span",{className:"color-scheme-label",ref:s,css:e=>h.iv`
            min-width: 125px;
            padding-right: ${2*e.gridUnit}px;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
          `},r),(0,h.tZ)("span",{ref:l,css:e=>h.iv`
            flex: 100%;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
            padding-right: ${e.gridUnit}px;
          `},c())))}const g=(0,s.iK)(p.Z.AlertSolid)`
  color: ${e=>{let{theme:t}=e;return t.colors.alert.base}};
`,f=(0,l.t)("This color scheme is being overridden by custom label colors.\n    Check the JSON metadata in the Advanced settings"),v=(0,l.t)("The color scheme is determined by the related dashboard.\n        Edit the color scheme in the dashboard properties."),_=e=>{let{label:t,hasCustomLabelColors:r,dashboardId:n}=e;if(r||n){const e=r?f:v;return(0,h.tZ)(i.Fragment,null,t," ",(0,h.tZ)(u.u,{title:e},(0,h.tZ)(g,{iconSize:"s"})))}return(0,h.tZ)(i.Fragment,null,t)},b=e=>{let{hasCustomLabelColors:t=!1,dashboardId:r,label:o=(0,l.t)("Color scheme"),name:s,onChange:p=(()=>{}),value:g,clearable:f=!1,defaultScheme:b,choices:y=[],schemes:E={},isLinear:T,...S}=e;const C=(0,i.useMemo)((()=>{if(r)return"dashboard";let e=g||b;if("SUPERSET_DEFAULT"===e){var t;const r=a()(E)?E():E;e=null==r||null==(t=r.SUPERSET_DEFAULT)?void 0:t.id}return e}),[r,b,E,g]),R=(0,i.useMemo)((()=>{if(r)return[{value:"dashboard",label:(0,l.t)("dashboard"),customLabel:(0,h.tZ)(u.u,{title:v},(0,l.t)("Dashboard scheme"))}];const e=a()(E)?E():E,t=a()(y)?y():y,n=[];return t.filter((e=>{const t=e[0],r="SUPERSET_DEFAULT"!==t&&!n.includes(t);return n.push(t),r})).map((t=>{var r;let[n]=t;const o=e[n];let a=[];return o&&(a=T?o.getColors(10):o.colors),{customLabel:(0,h.tZ)(m,{id:o.id,label:o.label,colors:a}),label:(null==e||null==(r=e[n])?void 0:r.label)||n,value:n}}))}),[y,r,T,E]);return(0,h.tZ)(c.Ph,{header:(0,h.tZ)(d.Z,(0,n.Z)({},S,{label:(0,h.tZ)(_,{label:o,hasCustomLabelColors:t,dashboardId:r})})),ariaLabel:(0,l.t)("Select color scheme"),allowClear:f,disabled:!!r,name:`select-${s}`,onChange:e=>p(e),options:R,placeholder:(0,l.t)("Select scheme"),value:C})}},27845:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c,j:()=>s});var n=r(73126),o=r(67294),a=r(99299),i=r(11965);const s=()=>{var e;return null==(e=document.getElementById("controlSections"))?void 0:e.lastElementChild},l=e=>{var t,r;const n=null==(t=window)?void 0:t.innerHeight,o=null==e||null==(r=e.getBoundingClientRect())?void 0:r.top;return n&&o?o/n:0},c=e=>{let{getPopupContainer:t,getVisibilityRatio:r=l,visible:c,destroyTooltipOnHide:d=!1,...u}=e;const p=(0,o.useRef)(),[h,m]=(0,o.useState)(void 0===c?u.defaultVisible:c),[g,f]=o.useState("right"),v=(0,o.useCallback)((()=>{const e=r(p.current);f(e<.35&&"rightTop"!==g?"rightTop":e>.65&&"rightBottom"!==g?"rightBottom":"right")}),[r]),_=(0,o.useCallback)((e=>{const t=s();t&&t.style.setProperty("overflow-y",e?"hidden":"auto","important")}),[v]),b=(0,o.useCallback)((e=>(p.current=e,(null==t?void 0:t(e))||document.body)),[v,t]),y=(0,o.useCallback)((e=>{void 0===e&&_(e),m(!!e),null==u.onVisibleChange||u.onVisibleChange(!!e)}),[u,_]),E=(0,o.useCallback)((e=>{"Escape"===e.key&&(m(!1),null==u.onVisibleChange||u.onVisibleChange(!1))}),[u]);return(0,o.useEffect)((()=>{void 0!==c&&m(!!c)}),[c]),(0,o.useEffect)((()=>{void 0!==h&&_(h)}),[h,_]),(0,o.useEffect)((()=>(h&&document.addEventListener("keydown",E),()=>{document.removeEventListener("keydown",E)})),[E,h]),(0,o.useEffect)((()=>{h&&v()}),[h,v]),(0,i.tZ)(a.Z,(0,n.Z)({},u,{visible:h,arrowPointAtCenter:!0,placement:g,onVisibleChange:y,getPopupContainer:b,destroyTooltipOnHide:d}))}},9870:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(73126),o=r(67294),a=r(28216),i=r(51995),s=r(11965),l=r(61988),c=r(55786),d=r(37208),u=r(4715),p=r(82342);const h=i.iK.div`
  ${e=>{let{theme:t}=e;return s.iv`
    display: flex;
    align-items: center;

    & > :first-child {
      margin-right: ${4*t.gridUnit}px;
      min-width: 0;
      flex: 1;
    }

    & > :nth-child(2) {
      min-width: 0;
      flex: 1;
    }
  `}}
`,m=[{value:"prefix",label:(0,l.t)("Prefix")},{value:"suffix",label:(0,l.t)("Suffix")}],g=e=>{let{onChange:t,value:r={},symbolSelectOverrideProps:i={},currencySelectOverrideProps:g={},symbolSelectAdditionalStyles:f,currencySelectAdditionalStyles:v,..._}=e;const b=(0,a.v9)((e=>{var t;return null==(t=e.common)?void 0:t.currencies})),y=(0,o.useMemo)((()=>(0,c.Z)(b).map((e=>({value:e,label:`${(0,d.j)({symbol:e})} (${e})`})))),[b]);return(0,s.tZ)(o.Fragment,null,(0,s.tZ)(p.Z,_),(0,s.tZ)(h,{css:s.iv`
          & > :first-child {
            ${f};
          }
          & > :nth-child(2) {
            ${v};
          }
        `,className:"currency-control-container"},(0,s.tZ)(u.Ph,(0,n.Z)({ariaLabel:(0,l.t)("Currency prefix or suffix"),options:m,placeholder:(0,l.t)("Prefix or suffix"),onChange:e=>{t({...r,symbolPosition:e})},onClear:()=>t({...r,symbolPosition:void 0}),value:null==r?void 0:r.symbolPosition,allowClear:!0},i)),(0,s.tZ)(u.Ph,(0,n.Z)({ariaLabel:(0,l.t)("Currency symbol"),options:y,placeholder:(0,l.t)("Currency"),onChange:e=>{t({...r,symbol:e})},onClear:()=>t({...r,symbol:void 0}),value:null==r?void 0:r.symbol,allowClear:!0,allowNewOptions:!0},g))))}},74092:(e,t,r)=>{"use strict";r.d(t,{Z:()=>z});var n=r(67294),o=r(51995),a=r(11965),i=r(3297),s=r(5364),l=r(61988),c=r(35932),d=r(82342),u=r(74069),p=r(4715),h=r(70707),m=r(81315),g=r(58593),f=r(12515),v=r(27600),_=r(54076),b=r(27845),y=r(61314),E=r(87183);function T(e){let t="Last week";return y.bk.has(e.value)?t=e.value:e.onChange(t),(0,a.tZ)(n.Fragment,null,(0,a.tZ)("div",{className:"section-title"},(0,l.t)("Configure Time Range: Last...")),(0,a.tZ)(E.Y.Group,{value:t,onChange:t=>e.onChange(t.target.value)},y.Sm.map((e=>{let{value:t,label:r}=e;return(0,a.tZ)(E.Y,{key:t,value:t,className:"vertical-radio"},r)}))))}var S=r(31209);function C(e){let{onChange:t,value:r}=e;return(0,n.useEffect)((()=>{y.LY.has(r)||t(S.gT)}),[t,r]),y.LY.has(r)?(0,a.tZ)(n.Fragment,null,(0,a.tZ)("div",{className:"section-title"},(0,l.t)("Configure Time Range: Previous...")),(0,a.tZ)(E.Y.Group,{value:r,onChange:e=>t(e.target.value)},y._S.map((e=>{let{value:t,label:r}=e;return(0,a.tZ)(E.Y,{key:t,value:t,className:"vertical-radio"},r)})))):null}var R=r(93754),Z=r.n(R),A=r(28216),x=r(58146),O=r(9875),w=r(62276),I=r(9882);function N(e){var t;const{customRange:r,matchedFlag:n}=(0,y.c_)(e.value);n||e.onChange((0,y.jK)(r));const{sinceDatetime:o,sinceMode:i,sinceGrain:s,sinceGrainValue:c,untilDatetime:d,untilMode:u,untilGrain:h,untilGrainValue:g,anchorValue:f,anchorMode:v}={...r};function _(t,n){e.onChange((0,y.jK)({...r,[t]:n}))}function b(t,n){Z()(n)&&n>0&&e.onChange((0,y.jK)({...r,[t]:n}))}const T=(0,A.v9)((e=>{var t;return null==e||null==(t=e.common)?void 0:t.locale})),S=null==(t=x.locales[y.ZU[T]])?void 0:t.DatePicker;return(0,a.tZ)("div",null,(0,a.tZ)("div",{className:"section-title"},(0,l.t)("Configure custom time range")),(0,a.tZ)(p.X2,{gutter:24},(0,a.tZ)(p.JX,{span:12},(0,a.tZ)("div",{className:"control-label"},(0,l.t)("START (INCLUSIVE)")," ",(0,a.tZ)(I.V,{tooltip:(0,l.t)("Start date included in time range"),placement:"right"})),(0,a.tZ)(m.Z,{ariaLabel:(0,l.t)("START (INCLUSIVE)"),options:y._d,value:i,onChange:e=>_("sinceMode",e)}),"specific"===i&&(0,a.tZ)(p.X2,null,(0,a.tZ)(w.M,{showTime:!0,defaultValue:(0,y.DL)(o),onChange:e=>_("sinceDatetime",e.format(y.KZ)),allowClear:!1,locale:S})),"relative"===i&&(0,a.tZ)(p.X2,{gutter:8},(0,a.tZ)(p.JX,{span:11},(0,a.tZ)(O.Rn,{placeholder:(0,l.t)("Relative quantity"),value:Math.abs(c),min:1,defaultValue:1,onChange:e=>b("sinceGrainValue",e||1),onStep:e=>b("sinceGrainValue",e||1)})),(0,a.tZ)(p.JX,{span:13},(0,a.tZ)(m.Z,{ariaLabel:(0,l.t)("Relative period"),options:y.kj,value:s,onChange:e=>_("sinceGrain",e)})))),(0,a.tZ)(p.JX,{span:12},(0,a.tZ)("div",{className:"control-label"},(0,l.t)("END (EXCLUSIVE)")," ",(0,a.tZ)(I.V,{tooltip:(0,l.t)("End date excluded from time range"),placement:"right"})),(0,a.tZ)(m.Z,{ariaLabel:(0,l.t)("END (EXCLUSIVE)"),options:y.hj,value:u,onChange:e=>_("untilMode",e)}),"specific"===u&&(0,a.tZ)(p.X2,null,(0,a.tZ)(w.M,{showTime:!0,defaultValue:(0,y.DL)(d),onChange:e=>_("untilDatetime",e.format(y.KZ)),allowClear:!1,locale:S})),"relative"===u&&(0,a.tZ)(p.X2,{gutter:8},(0,a.tZ)(p.JX,{span:11},(0,a.tZ)(O.Rn,{placeholder:(0,l.t)("Relative quantity"),value:g,min:1,defaultValue:1,onChange:e=>b("untilGrainValue",e||1),onStep:e=>b("untilGrainValue",e||1)})),(0,a.tZ)(p.JX,{span:13},(0,a.tZ)(m.Z,{ariaLabel:(0,l.t)("Relative period"),options:y.Ae,value:h,onChange:e=>_("untilGrain",e)}))))),"relative"===i&&"relative"===u&&(0,a.tZ)("div",{className:"control-anchor-to"},(0,a.tZ)("div",{className:"control-label"},(0,l.t)("Anchor to")),(0,a.tZ)(p.X2,{align:"middle"},(0,a.tZ)(p.JX,null,(0,a.tZ)(E.Y.Group,{onChange:function(t){const n=t.target.value;"now"===n?e.onChange((0,y.jK)({...r,anchorValue:"now",anchorMode:n})):e.onChange((0,y.jK)({...r,anchorValue:y.V7,anchorMode:n}))},defaultValue:"now",value:v},(0,a.tZ)(E.Y,{key:"now",value:"now"},(0,l.t)("NOW")),(0,a.tZ)(E.Y,{key:"specific",value:"specific"},(0,l.t)("Date/Time")))),"now"!==v&&(0,a.tZ)(p.JX,null,(0,a.tZ)(w.M,{showTime:!0,defaultValue:(0,y.DL)(f),onChange:e=>_("anchorValue",e.format(y.KZ)),allowClear:!1,className:"control-anchor-to-datetime",locale:S})))))}var D=r(73126);const L=(0,a.tZ)(n.Fragment,null,(0,a.tZ)("div",null,(0,a.tZ)("h3",null,"DATETIME"),(0,a.tZ)("p",null,(0,l.t)("Return to specific datetime.")),(0,a.tZ)("h4",null,(0,l.t)("Syntax")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,"datetime([string])")),(0,a.tZ)("h4",null,(0,l.t)("Example")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,'datetime("2020-03-01 12:00:00")\ndatetime("now")\ndatetime("last year")'))),(0,a.tZ)("div",null,(0,a.tZ)("h3",null,"DATEADD"),(0,a.tZ)("p",null,(0,l.t)("Moves the given set of dates by a specified interval.")),(0,a.tZ)("h4",null,(0,l.t)("Syntax")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,"dateadd([datetime], [integer], [dateunit])\ndateunit = (year | quarter | month | week | day | hour | minute | second)")),(0,a.tZ)("h4",null,(0,l.t)("Example")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,'dateadd(datetime("today"), -13, day)\ndateadd(datetime("2020-03-01"), 2, day)'))),(0,a.tZ)("div",null,(0,a.tZ)("h3",null,"DATETRUNC"),(0,a.tZ)("p",null,(0,l.t)("Truncates the specified date to the accuracy specified by the date unit.")),(0,a.tZ)("h4",null,(0,l.t)("Syntax")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,"datetrunc([datetime], [dateunit])\ndateunit = (year | quarter | month | week)")),(0,a.tZ)("h4",null,(0,l.t)("Example")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,'datetrunc(datetime("2020-03-01"), week)\ndatetrunc(datetime("2020-03-01"), month)'))),(0,a.tZ)("div",null,(0,a.tZ)("h3",null,"LASTDAY"),(0,a.tZ)("p",null,(0,l.t)("Get the last date by the date unit.")),(0,a.tZ)("h4",null,(0,l.t)("Syntax")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,"lastday([datetime], [dateunit])\ndateunit = (year | month | week)")),(0,a.tZ)("h4",null,(0,l.t)("Example")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,'lastday(datetime("today"), month)'))),(0,a.tZ)("div",null,(0,a.tZ)("h3",null,"HOLIDAY"),(0,a.tZ)("p",null,(0,l.t)("Get the specify date for the holiday")),(0,a.tZ)("h4",null,(0,l.t)("Syntax")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,"holiday([string])\nholiday([holiday string], [datetime])\nholiday([holiday string], [datetime], [country name])")),(0,a.tZ)("h4",null,(0,l.t)("Example")),(0,a.tZ)("pre",null,(0,a.tZ)("code",null,'holiday("new year")\nholiday("christmas", datetime("2019"))\nholiday("christmas", dateadd(datetime("2019"), 1, year))\nholiday("christmas", datetime("2 years ago"))\nholiday("Easter Monday", datetime("2019"), "UK")')))),M=e=>{const t=(0,o.Fg)();return(0,a.tZ)(a.ms,null,(r=>{let{css:n}=r;return(0,a.tZ)(g.u,(0,D.Z)({overlayClassName:n`
            .ant-tooltip-content {
              min-width: ${125*t.gridUnit}px;
              max-height: 410px;
              overflow-y: scroll;

              .ant-tooltip-inner {
                max-width: ${125*t.gridUnit}px;
                h3 {
                  font-size: ${t.typography.sizes.m}px;
                  font-weight: ${t.typography.weights.bold};
                }
                h4 {
                  font-size: ${t.typography.sizes.m}px;
                  font-weight: ${t.typography.weights.bold};
                }
                pre {
                  border: none;
                  text-align: left;
                  word-break: break-word;
                  font-size: ${t.typography.sizes.s}px;
                }
              }
            }
          `},e))}))};function k(e){return(0,a.tZ)(M,(0,D.Z)({title:L},e))}function P(e){return e.includes(y.UD)?e:e.startsWith("Last")?[e,""].join(y.UD):e.startsWith("Next")?["",e].join(y.UD):y.UD}function U(e){const t=P(e.value||""),[r,o]=t.split(y.UD);function i(t,n){"since"===t?e.onChange(`${n}${y.UD}${o}`):e.onChange(`${r}${y.UD}${n}`)}return t!==e.value&&e.onChange(P(e.value||"")),(0,a.tZ)(n.Fragment,null,(0,a.tZ)("div",{className:"section-title"},(0,l.t)("Configure Advanced Time Range "),(0,a.tZ)(k,{placement:"rightBottom"},(0,a.tZ)("i",{className:"fa fa-info-circle text-muted"}))),(0,a.tZ)("div",{className:"control-label"},(0,l.t)("START (INCLUSIVE)")," ",(0,a.tZ)(I.V,{tooltip:(0,l.t)("Start date included in time range"),placement:"right"})),(0,a.tZ)(O.II,{key:"since",value:r,onChange:e=>i("since",e.target.value)}),(0,a.tZ)("div",{className:"control-label"},(0,l.t)("END (EXCLUSIVE)")," ",(0,a.tZ)(I.V,{tooltip:(0,l.t)("End date excluded from time range"),placement:"right"})),(0,a.tZ)(O.II,{key:"until",value:o,onChange:e=>i("until",e.target.value)}))}const $="#45BED6",F=o.iK.div`
  ${e=>{let{theme:t,isActive:r,isPlaceholder:n}=e;return a.iv`
    width: 100%;
    height: ${8*t.gridUnit}px;

    display: flex;
    align-items: center;
    flex-wrap: nowrap;

    padding: 0 ${3*t.gridUnit}px;

    background-color: ${t.colors.grayscale.light5};

    border: 1px solid
      ${r?$:t.colors.grayscale.light2};
    border-radius: ${t.borderRadius}px;

    cursor: pointer;

    transition: border-color 0.3s cubic-bezier(0.65, 0.05, 0.36, 1);
    :hover,
    :focus {
      border-color: ${$};
    }

    .date-label-content {
      color: ${n?t.colors.grayscale.light1:t.colors.grayscale.dark1};
      overflow: hidden;
      text-overflow: ellipsis;
      min-width: 0;
      flex-shrink: 1;
      white-space: nowrap;
    }

    span[role='img'] {
      margin-left: auto;
      padding-left: ${t.gridUnit}px;

      & > span[role='img'] {
        line-height: 0;
      }
    }
  `}}
`,q=(0,n.forwardRef)(((e,t)=>{const r=(0,o.Fg)();return(0,a.tZ)(F,(0,D.Z)({},e,{tabIndex:0}),(0,a.tZ)("span",{className:"date-label-content",ref:t},e.label),(0,a.tZ)(h.Z.CalendarOutlined,{iconSize:"s",iconColor:r.colors.grayscale.base}))})),V=(0,o.iK)(m.Z)`
  width: 272px;
`,B=o.iK.div`
  ${e=>{let{theme:t}=e;return a.iv`
    .ant-row {
      margin-top: 8px;
    }

    .ant-input-number {
      width: 100%;
    }

    .ant-picker {
      padding: 4px 17px 4px;
      border-radius: 4px;
      width: 100%;
    }

    .ant-divider-horizontal {
      margin: 16px 0;
    }

    .control-label {
      font-size: 11px;
      font-weight: ${t.typography.weights.medium};
      color: ${t.colors.grayscale.light2};
      line-height: 16px;
      text-transform: uppercase;
      margin: 8px 0;
    }

    .vertical-radio {
      display: block;
      height: 40px;
      line-height: 40px;
    }

    .section-title {
      font-style: normal;
      font-weight: ${t.typography.weights.bold};
      font-size: 15px;
      line-height: 24px;
      margin-bottom: 8px;
    }

    .control-anchor-to {
      margin-top: 16px;
    }

    .control-anchor-to-datetime {
      width: 217px;
    }

    .footer {
      text-align: right;
    }
  `}}
`,H=o.iK.span`
  span {
    margin-right: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    vertical-align: middle;
  }
  .text {
    vertical-align: middle;
  }
  .error {
    color: ${e=>{let{theme:t}=e;return t.colors.error.base}};
  }
`,j=(e,t,r)=>e?(0,a.tZ)("div",null,t&&(0,a.tZ)("strong",null,t),r&&(0,a.tZ)("div",{css:e=>a.iv`
            margin-top: ${e.gridUnit}px;
          `},r)):r||null;function z(e){var t;const{onChange:r,onOpenPopover:m=_.EI,onClosePopover:E=_.EI,overlayStyle:S="Popover",isOverflowingFilterBar:R=!1}=e,Z=(0,y.Ct)(),A=null!=(t=e.value)?t:Z,[x,O]=(0,n.useState)(A),[w,I]=(0,n.useState)(!1),D=(0,n.useMemo)((()=>(0,y.X0)(A)),[A]),[L,M]=(0,n.useState)(D),[k,P]=(0,n.useState)(A),[$,F]=(0,n.useState)(A),[z,Q]=(0,n.useState)(!1),[G,Y]=(0,n.useState)(A),[W,K]=(0,n.useState)(A),X=(0,o.Fg)(),[J,ee]=(0,i.Z)();function te(){F(A),M(D),I(!1),E()}(0,n.useEffect)((()=>{if(A===s.vM)return O(s.vM),K(null),void Q(!0);(0,y.z1)(A).then((e=>{let{value:t,error:r}=e;r?(Y(r||""),Q(!1),K(A||null)):("Common"===D||"Calendar"===D||"No filter"===D?(O(A),K(j(ee,A,t))):(O(t||""),K(j(ee,t,A))),Q(!0)),P(A),Y(t||A)}))}),[D,ee,J,A]),(0,f.bX)((()=>{if($===s.vM)return Y(s.vM),P(s.vM),void Q(!0);k!==$&&(0,y.z1)($).then((e=>{let{value:t,error:r}=e;r?(Y(r||""),Q(!1)):(Y(t||""),Q(!0)),P($)}))}),v.M$,[$]);const re=()=>{w?te():(F(A),M(D),I(!0),m())},ne=(0,a.tZ)(B,null,(0,a.tZ)("div",{className:"control-label"},(0,l.t)("RANGE TYPE")),(0,a.tZ)(V,{ariaLabel:(0,l.t)("RANGE TYPE"),options:y.un,value:L,onChange:function(e){e===s.vM&&F(s.vM),M(e)}}),"No filter"!==L&&(0,a.tZ)(p.iz,null),"Common"===L&&(0,a.tZ)(T,{value:$,onChange:F}),"Calendar"===L&&(0,a.tZ)(C,{value:$,onChange:F}),"Advanced"===L&&(0,a.tZ)(U,{value:$,onChange:F}),"Custom"===L&&(0,a.tZ)(N,{value:$,onChange:F}),"No filter"===L&&(0,a.tZ)("div",null),(0,a.tZ)(p.iz,null),(0,a.tZ)("div",null,(0,a.tZ)("div",{className:"section-title"},(0,l.t)("Actual time range")),z&&(0,a.tZ)("div",null,"No filter"===G?(0,l.t)("No filter"):G),!z&&(0,a.tZ)(H,{className:"warning"},(0,a.tZ)(h.Z.ErrorSolidSmall,{iconColor:X.colors.error.base}),(0,a.tZ)("span",{className:"text error"},G))),(0,a.tZ)(p.iz,null),(0,a.tZ)("div",{className:"footer"},(0,a.tZ)(c.Z,{buttonStyle:"secondary",cta:!0,key:"cancel",onClick:te},(0,l.t)("CANCEL")),(0,a.tZ)(c.Z,{buttonStyle:"primary",cta:!0,disabled:!z,key:"apply",onClick:function(){r($),I(!1),E()}},(0,l.t)("APPLY")))),oe=(0,a.tZ)(H,null,(0,a.tZ)(h.Z.EditAlt,{iconColor:X.colors.grayscale.base}),(0,a.tZ)("span",{className:"text"},(0,l.t)("Edit time range"))),ae=(0,a.tZ)(b.Z,{placement:"right",trigger:"click",content:ne,title:oe,defaultVisible:w,visible:w,onVisibleChange:re,overlayStyle:{width:"600px"},getPopupContainer:e=>R?e.parentNode:document.body,destroyTooltipOnHide:!0},(0,a.tZ)(g.u,{placement:"top",title:W,getPopupContainer:e=>e.parentElement},(0,a.tZ)(q,{label:x,isActive:w,isPlaceholder:x===s.vM,ref:J}))),ie=(0,a.tZ)(n.Fragment,null,(0,a.tZ)(g.u,{placement:"top",title:W,getPopupContainer:e=>e.parentElement},(0,a.tZ)(q,{onClick:re,label:x,isActive:w,isPlaceholder:x===s.vM,ref:J})),(0,a.tZ)(u.default,{title:oe,show:w,onHide:re,width:"600px",hideFooter:!0,zIndex:1030},ne));return(0,a.tZ)(n.Fragment,null,(0,a.tZ)(d.Z,e),"Modal"===S?ie:ae)}},1090:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>n.Z,z1:()=>o.z1});var n=r(74092),o=r(61314)},31209:(e,t,r)=>{"use strict";r.d(t,{MZ:()=>o,gT:()=>n,po:()=>a});const n="previous calendar week",o="previous calendar month",a="previous calendar year"},61314:(e,t,r)=>{"use strict";r.d(t,{_S:()=>T,LY:()=>w,gn:()=>S,Sm:()=>y,bk:()=>O,MI:()=>E,un:()=>b,ZU:()=>L,V7:()=>D,KZ:()=>I,UD:()=>u,kj:()=>R,_d:()=>A,Ae:()=>Z,hj:()=>x,c_:()=>Q,jK:()=>G,DL:()=>j,z1:()=>g,X0:()=>m,Ct:()=>f});var n=r(30381),o=r.n(n),a=r(15926),i=r.n(a),s=r(5364),l=r(31069),c=r(98286),d=r(28216);const u=" : ",p=(e,t)=>e.replace("T00:00:00","")||(t?"-":""),h=function(e,t){void 0===t&&(t="col");const r=e.split(u);return 1===r.length?e:`${p(r[0],!0)}  ${t} < ${p(r[1])}`},m=e=>E.has(e)?"Common":S.has(e)?"Calendar":e===s.vM?"No filter":Q(e).matchedFlag?"Custom":"Advanced",g=async function(e,t){void 0===t&&(t="col");const r=`/api/v1/time_range/?q=${i().encode_uri(e)}`;try{var n,o,a,s;const e=await l.Z.get({endpoint:r}),i=(d=(null==e||null==(n=e.json)||null==(o=n.result)?void 0:o.since)||"",p=(null==e||null==(a=e.json)||null==(s=a.result)?void 0:s.until)||"",`${d}${u}${p}`);return{value:h(i,t)}}catch(e){const t=await(0,c.O$)(e);return{error:t.message||t.error||e.statusText}}var d,p};function f(){var e;return null!=(e=(0,d.v9)((e=>{var t,r;return null==e||null==(t=e.common)||null==(r=t.conf)?void 0:r.DEFAULT_TIME_FILTER})))?e:s.vM}var v=r(61988),_=r(31209);const b=[{value:"Common",label:(0,v.t)("Last")},{value:"Calendar",label:(0,v.t)("Previous")},{value:"Custom",label:(0,v.t)("Custom")},{value:"Advanced",label:(0,v.t)("Advanced")},{value:"No filter",label:(0,v.t)("No filter")}],y=[{value:"Last day",label:(0,v.t)("last day")},{value:"Last week",label:(0,v.t)("last week")},{value:"Last month",label:(0,v.t)("last month")},{value:"Last quarter",label:(0,v.t)("last quarter")},{value:"Last year",label:(0,v.t)("last year")}],E=new Set(y.map((e=>{let{value:t}=e;return t}))),T=[{value:_.gT,label:(0,v.t)("previous calendar week")},{value:_.MZ,label:(0,v.t)("previous calendar month")},{value:_.po,label:(0,v.t)("previous calendar year")}],S=new Set(T.map((e=>{let{value:t}=e;return t}))),C=[{value:"second",label:e=>(0,v.t)("Seconds %s",e)},{value:"minute",label:e=>(0,v.t)("Minutes %s",e)},{value:"hour",label:e=>(0,v.t)("Hours %s",e)},{value:"day",label:e=>(0,v.t)("Days %s",e)},{value:"week",label:e=>(0,v.t)("Weeks %s",e)},{value:"month",label:e=>(0,v.t)("Months %s",e)},{value:"quarter",label:e=>(0,v.t)("Quarters %s",e)},{value:"year",label:e=>(0,v.t)("Years %s",e)}],R=C.map((e=>({value:e.value,label:e.label((0,v.t)("Before"))}))),Z=C.map((e=>({value:e.value,label:e.label((0,v.t)("After"))}))),A=[{value:"specific",label:(0,v.t)("Specific Date/Time")},{value:"relative",label:(0,v.t)("Relative Date/Time")},{value:"now",label:(0,v.t)("Now")},{value:"today",label:(0,v.t)("Midnight")}],x=A.slice(),O=new Set(["Last day","Last week","Last month","Last quarter","Last year"]),w=new Set([_.gT,_.MZ,_.po]),I="YYYY-MM-DD[T]HH:mm:ss",N=o()().utc().startOf("day").subtract(7,"days").format(I),D=o()().utc().startOf("day").format(I),L={en:"en_US",fr:"fr_FR",es:"es_ES",it:"it_IT",zh:"zh_CN",ja:"ja_JP",de:"de_DE",pt:"pt_PT",pt_BR:"pt_BR",ru:"ru_RU",ko:"ko_KR",sk:"sk_SK",sl:"sl_SI",nl:"nl_NL"};var M;!function(e){e.commonFrame="common-frame",e.modalOverlay="modal-overlay",e.popoverOverlay="time-range-trigger",e.noFilter="no-filter",e.cancelButton="cancel-button",e.applyButton="date-filter-control__apply-button"}(M||(M={}));const k=String.raw`\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.\d+)?(?:(?:[+-]\d\d:\d\d)|Z)?`,P=String.raw`(?:TODAY|NOW)`,U=String.raw`[+-]?[1-9][0-9]*`,$=String.raw`YEAR|QUARTER|MONTH|WEEK|DAY|HOUR|MINUTE|SECOND`,F=RegExp(String.raw`^DATEADD\(DATETIME\("(${k}|${P})"\),\s(${U}),\s(${$})\)$`,"i"),q=RegExp(String.raw`^${k}$|^${P}$`,"i"),V=["now","today"],B={sinceDatetime:N,sinceMode:"relative",sinceGrain:"day",sinceGrainValue:-7,untilDatetime:D,untilMode:"specific",untilGrain:"day",untilGrainValue:7,anchorMode:"now",anchorValue:"now"},H=["specific","today","now"],j=e=>"now"===e?o()().utc().startOf("second"):"today"===e?o()().utc().startOf("day"):o()(e),z=e=>j(e).format(I),Q=e=>{const t=e.split(u);if(2===t.length){const[e,r]=t;if(q.test(e)&&q.test(r)){const t=V.includes(e)?e:"specific",n=V.includes(r)?r:"specific";return{customRange:{...B,sinceDatetime:e,untilDatetime:r,sinceMode:t,untilMode:n},matchedFlag:!0}}const n=e.match(F);if(n&&q.test(r)&&e.includes(r)){const[e,t,o]=n.slice(1),a=V.includes(r)?r:"specific";return{customRange:{...B,sinceGrain:o,sinceGrainValue:parseInt(t,10),sinceDatetime:e,untilDatetime:e,sinceMode:"relative",untilMode:a},matchedFlag:!0}}const o=r.match(F);if(q.test(e)&&o&&r.includes(e)){const[t,r,n]=[...o.slice(1)],a=V.includes(e)?e:"specific";return{customRange:{...B,untilGrain:n,untilGrainValue:parseInt(r,10),sinceDatetime:t,untilDatetime:t,untilMode:"relative",sinceMode:a},matchedFlag:!0}}if(n&&o){const[e,t,r]=[...n.slice(1)],[a,i,s]=[...o.slice(1)];if(e===a)return{customRange:{...B,sinceGrain:r,sinceGrainValue:parseInt(t,10),sinceDatetime:e,untilGrain:s,untilGrainValue:parseInt(i,10),untilDatetime:a,anchorValue:e,sinceMode:"relative",untilMode:"relative",anchorMode:"now"===e?"now":"specific"},matchedFlag:!0}}}return{customRange:B,matchedFlag:!1}},G=e=>{const{sinceDatetime:t,sinceMode:r,sinceGrain:n,sinceGrainValue:o,untilDatetime:a,untilMode:i,untilGrain:s,untilGrainValue:l,anchorValue:c}={...e};if(H.includes(r)&&H.includes(i))return`${"specific"===r?z(t):r} : ${"specific"===i?z(a):i}`;if(H.includes(r)&&"relative"===i){const e="specific"===r?z(t):r;return`${e} : DATEADD(DATETIME("${e}"), ${l}, ${s})`}if("relative"===r&&H.includes(i)){const e="specific"===i?z(a):i;return`DATEADD(DATETIME("${e}"), ${-Math.abs(o)}, ${n}) : ${e}`}return`DATEADD(DATETIME("${c}"), ${-Math.abs(o)}, ${n}) : DATEADD(DATETIME("${c}"), ${l}, ${s})`}},96055:(e,t,r)=>{"use strict";r.d(t,{Z:()=>J});var n=r(67294),o=r(73126),a=r(45697),i=r.n(a),s=r(35932),l=r(51995),c=r(61988),d=r(57902),u=r(71262),p=r(17536),h=r(28543),m=r(4591),g=r(4715),f=r(37731),v=r(11146),_=r(31069),b=r(93185),y=r(69856),E=r(40266),T=r(58593),S=r(9875),C=r(54076),R=r(45211),Z=r(23279),A=r.n(Z),x=r(55786),O=r(15926),w=r.n(O);const I={parsedAdvancedDataType:"",advancedDataTypeOperatorList:[],errorMessage:""};var N=r(7848),D=r(61314),L=r(61641),M=r(11965);const k=(0,l.iK)(S.II)`
  margin-bottom: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
`,P=((0,l.iK)(m.Z)`
  &.ant-row.ant-form-item {
    margin: 0;
  }
`,(0,l.iK)(g.Ph)`
  .ant-select-selector::after {
    content: ${e=>{let{labelText:t}=e;return t||"\\A0"}};
    display: inline-block;
    white-space: nowrap;
    color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light1}};
    width: max-content;
  }
`),U=e=>{var t,r;const{onSubjectChange:a,onOperatorChange:i,isOperatorRelevant:s,onComparatorChange:l,onDatePickerChange:d}=(e=>{const t=(0,D.Ct)(),r=(t,r)=>{var n;const o=null==(n=e.datasource.columns)?void 0:n.find((e=>e.column_name===r)),a=!!o&&("BOOL"===o.type||"BOOLEAN"===o.type),i=!!o&&("INT"===o.type||"INTEGER"===o.type),s=!!o&&!!o.expression;if(t&&t===y.d.LATEST_PARTITION){const{partitionColumn:t}=e;return t&&r&&r===t}return(!t||t!==y.d.TEMPORAL_RANGE)&&(t===y.d.IS_TRUE||t===y.d.IS_FALSE?a||i||s:a?t===y.d.IS_NULL||t===y.d.IS_NOT_NULL:e.adhocFilter.clause!==L.P.HAVING||-1!==y.Ak.indexOf(t))};return{onSubjectChange:n=>{const o=e.options.find((e=>"column_name"in e&&e.column_name===n||"optionName"in e&&e.optionName===n));let a,i="";o&&"column_name"in o?(i=o.column_name,a=L.P.WHERE):o&&"saved_metric_name"in o?(i=o.saved_metric_name,a=L.P.HAVING):null!=o&&o.label&&(i=o.label,a=L.P.HAVING);let{operator:s,operatorId:l,comparator:c}=e.adhocFilter;s=s&&l&&r(l,i)?y.LT[l].operation:null,(0,f.Z)(s)||(s=y.d.IN,l=y.d.IN,c=void 0),v.O6&&(0,R.x)(n,e.datasource)&&(i=n,s=y.d.TEMPORAL_RANGE,l=y.d.TEMPORAL_RANGE,c=t),e.onChange(e.adhocFilter.duplicateWith({subject:i,clause:a,operator:s,expressionType:L.v.SIMPLE,operatorId:l,comparator:c}))},onOperatorChange:t=>{const r=e.adhocFilter.comparator;let n;n=y.qK.has(t)?Array.isArray(r)?r:[r].filter((e=>e)):Array.isArray(r)?r[0]:r,t!==y.d.IS_TRUE&&t!==y.d.IS_FALSE||(n=y.d.IS_TRUE===t),t&&y.qB.has(t)?e.onChange(e.adhocFilter.duplicateWith({subject:e.adhocFilter.subject,clause:L.P.WHERE,operatorId:t,operator:y.LT[t].operation,expressionType:L.v.SQL,datasource:e.datasource})):e.onChange(e.adhocFilter.duplicateWith({operatorId:t,operator:y.LT[t].operation,comparator:n,expressionType:L.v.SIMPLE}))},onComparatorChange:t=>{e.onChange(e.adhocFilter.duplicateWith({comparator:t,expressionType:L.v.SIMPLE}))},isOperatorRelevant:r,clearOperator:()=>{e.onChange(e.adhocFilter.duplicateWith({operatorId:void 0,operator:void 0}))},onDatePickerChange:(t,r)=>{e.onChange(e.adhocFilter.duplicateWith({subject:t,operator:y.d.TEMPORAL_RANGE,comparator:r,expressionType:L.v.SIMPLE}))}}})(e),[u,p]=(0,n.useState)([]),[h,m]=(0,n.useState)(e.adhocFilter.comparator),[S,Z]=(0,n.useState)(!1),{advancedDataTypesState:O,subjectAdvancedDataType:U,fetchAdvancedDataTypeValueCallback:$,fetchSubjectAdvancedDataType:F}=(e=>{const[t,r]=(0,n.useState)(I),[o,a]=(0,n.useState)(),i=(0,n.useCallback)(((t,n,o)=>{const a=(0,x.Z)(t);o?A()((()=>{const t=`/api/v1/advanced_data_type/convert?q=${w().encode({type:o,values:a})}`;_.Z.get({endpoint:t}).then((t=>{let{json:n}=t;r({parsedAdvancedDataType:n.result.display_value,advancedDataTypeOperatorList:n.result.valid_filter_operators,errorMessage:n.result.error_message}),e(!n.result.error_message)})).catch((()=>{r({parsedAdvancedDataType:"",advancedDataTypeOperatorList:n.advancedDataTypeOperatorList,errorMessage:(0,c.t)("Failed to retrieve advanced type")}),e(!1)}))}),600)():r(I)}),[e]);return{advancedDataTypesState:t,subjectAdvancedDataType:o,setAdvancedDataTypesState:r,fetchAdvancedDataTypeValueCallback:i,fetchSubjectAdvancedDataType:e=>{const t=e.options.find((t=>"column_name"in t&&t.column_name===e.adhocFilter.subject||"optionName"in t&&t.optionName===e.adhocFilter.subject));t&&"advanced_data_type"in t?a(t.advanced_data_type):e.validHandler(!0)}}})(e.validHandler),q=(e,t)=>U?s(e,t)&&O.advancedDataTypeOperatorList.includes(e):s(e,t),V=()=>{const e=(()=>{var e;const t=Array.isArray(h)?h.filter((e=>u.includes(e))).length:0;return null!=(e=(null==u?void 0:u.length)-t)?e:0})(),t=(0,c.t)("%s option(s)",e);return e?t:""};let B=e.options;const{subject:H,operator:j,operatorId:z}=e.adhocFilter,Q={ariaLabel:(0,c.t)("Select subject"),value:null!=H?H:void 0,onChange:e=>{m(void 0),a(e)},notFoundContent:(0,c.t)("No such column found. To filter on a metric, try the Custom SQL tab."),autoFocus:!H,placeholder:""};Q.placeholder=e.adhocFilter.clause===L.P.WHERE?(0,c.t)("%s column(s)",B.length):(0,c.t)("To filter on a metric, use Custom SQL tab."),B=e.options.filter((e=>"column_name"in e&&e.column_name));const G={placeholder:(0,c.t)("%s operator(s)",(null!=(t=e.operators)?t:y.GS).filter((e=>q(e,H))).length),value:z,onChange:i,autoFocus:!!Q.value&&!j,ariaLabel:(0,c.t)("Select operator")},Y=!!Q.value&&!!G.value,W={allowClear:!0,allowNewOptions:!0,ariaLabel:(0,c.t)("Comparator option"),mode:y.qK.has(z)?"multiple":"single",loading:S,value:h,onChange:l,notFoundContent:(0,c.t)("Type a value here"),disabled:y.yi.includes(z),placeholder:V(),autoFocus:Y},K=h&&h.length>0&&V(),X=(0,N.v)({columnName:e.adhocFilter.subject,timeRange:e.adhocFilter.operator===y.d.TEMPORAL_RANGE?e.adhocFilter.comparator:void 0,datasource:e.datasource,onChange:d});(0,n.useEffect)((()=>{X||(()=>{const{datasource:t}=e,r=e.adhocFilter.subject,n=e.adhocFilter.clause===L.P.HAVING;if(r&&t&&t.filter_select&&!n){const e=new AbortController,{signal:n}=e;S&&e.abort(),Z(!0),_.Z.get({signal:n,endpoint:`/api/v1/datasource/${t.type}/${t.id}/column/${r}/values/`}).then((e=>{let{json:t}=e;p(t.result.map((e=>({value:e,label:(0,C.lo)(e)})))),Z(!1)})).catch((()=>{p([]),Z(!1)}))}})()}),[e.adhocFilter.subject]),(0,n.useEffect)((()=>{(0,b.cr)(b.TT.ENABLE_ADVANCED_DATA_TYPES)&&F(e)}),[e.adhocFilter.subject]),(0,n.useEffect)((()=>{(0,b.cr)(b.TT.ENABLE_ADVANCED_DATA_TYPES)&&$(void 0===h?"":h,O,U)}),[h,U,$]),(0,n.useEffect)((()=>{(0,b.cr)(b.TT.ENABLE_ADVANCED_DATA_TYPES)&&m(e.adhocFilter.comparator)}),[e.adhocFilter.comparator]);const J=(0,M.tZ)(g.Ph,(0,o.Z)({css:e=>({marginTop:4*e.gridUnit,marginBottom:4*e.gridUnit}),options:B.map((e=>{return{value:"column_name"in e&&e.column_name||"optionName"in e&&e.optionName||"",label:"saved_metric_name"in e&&e.saved_metric_name||"column_name"in e&&e.column_name||"label"in e&&e.label,key:"id"in e&&e.id||"optionName"in e&&e.optionName||void 0,customLabel:(t=e,(0,M.tZ)(E.Z,{option:t}))};var t}))},Q)),ee=(0,M.tZ)(n.Fragment,null,(0,M.tZ)(g.Ph,(0,o.Z)({css:e=>({marginBottom:4*e.gridUnit}),options:(null!=(r=e.operators)?r:y.GS).filter((e=>q(e,H))).map(((e,t)=>({value:e,label:y.LT[e].display,key:e,order:t})))},G)),y.qK.has(z)||u.length>0?(0,M.tZ)(T.u,{title:O.errorMessage||O.parsedAdvancedDataType},(0,M.tZ)(P,(0,o.Z)({labelText:K,options:u},W))):(0,M.tZ)(T.u,{title:O.errorMessage||O.parsedAdvancedDataType},(0,M.tZ)(k,{name:"filter-value",ref:e=>{e&&Y&&e.focus()},onChange:e=>{const{value:t}=e.target;m(t),l(t)},value:h,placeholder:(0,c.t)("Filter value (case sensitive)"),disabled:y.yi.includes(z)})));return(0,M.tZ)(n.Fragment,null,J,null!=X?X:ee)};var $=r(94670),F=r(33313),q=r(72201);const V={adhocFilter:i().instanceOf(h.Z).isRequired,onChange:i().func.isRequired,options:i().arrayOf(i().oneOfType([q.Z,i().shape({saved_metric_name:i().string.isRequired}),p.Z])).isRequired,height:i().number.isRequired,activeKey:i().string.isRequired},B=(0,l.iK)(g.Ph)`
  ${e=>{let{theme:t}=e;return`\n    width: ${30*t.gridUnit}px;\n    marginRight: ${t.gridUnit}px;\n  `}}
`;class H extends n.Component{constructor(e){super(e),this.onSqlExpressionChange=this.onSqlExpressionChange.bind(this),this.onSqlExpressionClauseChange=this.onSqlExpressionClauseChange.bind(this),this.handleAceEditorRef=this.handleAceEditorRef.bind(this),this.selectProps={ariaLabel:(0,c.t)("Select column")}}componentDidUpdate(){this.aceEditorRef&&this.aceEditorRef.editor.resize()}onSqlExpressionClauseChange(e){this.props.onChange(this.props.adhocFilter.duplicateWith({clause:e,expressionType:L.v.SQL}))}onSqlExpressionChange(e){this.props.onChange(this.props.adhocFilter.duplicateWith({sqlExpression:e,expressionType:L.v.SQL}))}handleAceEditorRef(e){e&&(this.aceEditorRef=e)}render(){const{adhocFilter:e,height:t,options:r}=this.props,n={placeholder:(0,c.t)("choose WHERE or HAVING..."),value:e.clause,onChange:this.onSqlExpressionClauseChange},a=F.Z.concat(r.map((e=>e.column_name?{name:e.column_name,value:e.column_name,score:50,meta:"option"}:null)).filter(Boolean)),i=Object.keys(L.P).map((e=>({label:e,value:e})));return(0,M.tZ)("span",null,(0,M.tZ)("div",{className:"filter-edit-clause-section"},(0,M.tZ)(B,(0,o.Z)({options:i},this.selectProps,n)),(0,M.tZ)("span",{className:"filter-edit-clause-info"},(0,M.tZ)("strong",null,"WHERE")," ",(0,c.t)("Filters by columns"),(0,M.tZ)("br",null),(0,M.tZ)("strong",null,"HAVING")," ",(0,c.t)("Filters by metrics"))),(0,M.tZ)("div",{css:e=>({marginTop:4*e.gridUnit})},(0,M.tZ)($.iO,{ref:this.handleAceEditorRef,keywords:a,height:t-130+"px",onChange:this.onSqlExpressionChange,width:"100%",showGutter:!1,value:e.sqlExpression||e.translateToSql(),editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,className:"filter-sql-editor",wrapEnabled:!0})))}}H.propTypes=V;const j={adhocFilter:i().instanceOf(h.Z).isRequired,onChange:i().func.isRequired,onClose:i().func.isRequired,onResize:i().func.isRequired,options:i().arrayOf(i().oneOfType([q.Z,i().shape({saved_metric_name:i().string.isRequired}),p.Z])).isRequired,datasource:i().object,partitionColumn:i().string,theme:i().object,sections:i().arrayOf(i().string),operators:i().arrayOf(i().string),requireSave:i().bool},z=l.iK.i`
  margin-left: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,Q=l.iK.div`
  .adhoc-filter-edit-tabs > .nav-tabs {
    margin-bottom: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;

    & > li > a {
      padding: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    }
  }

  #filter-edit-popover {
    max-width: none;
  }

  .filter-edit-clause-info {
    font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.xs}}px;
    padding-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }

  .filter-edit-clause-section {
    display: inline-flex;
  }

  .adhoc-filter-simple-column-dropdown {
    margin-top: ${e=>{let{theme:t}=e;return 5*t.gridUnit}}px;
  }
`,G=l.iK.div`
  margin-top: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`;class Y extends n.Component{constructor(e){var t,r;super(e),this.onSave=this.onSave.bind(this),this.onDragDown=this.onDragDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onAdhocFilterChange=this.onAdhocFilterChange.bind(this),this.setSimpleTabIsValid=this.setSimpleTabIsValid.bind(this),this.adjustHeight=this.adjustHeight.bind(this),this.onTabChange=this.onTabChange.bind(this),this.state={adhocFilter:this.props.adhocFilter,width:y.kc,height:y.H7,activeKey:(null==(t=this.props)||null==(r=t.adhocFilter)?void 0:r.expressionType)||"SIMPLE",isSimpleTabValid:!0},this.popoverContentRef=n.createRef()}componentDidMount(){document.addEventListener("mouseup",this.onMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)}onAdhocFilterChange(e){this.setState({adhocFilter:e})}setSimpleTabIsValid(e){this.setState({isSimpleTabValid:e})}onSave(){this.props.onChange(this.state.adhocFilter),this.props.onClose()}onDragDown(e){this.dragStartX=e.clientX,this.dragStartY=e.clientY,this.dragStartWidth=this.state.width,this.dragStartHeight=this.state.height,document.addEventListener("mousemove",this.onMouseMove)}onMouseMove(e){this.props.onResize(),this.setState({width:Math.max(this.dragStartWidth+(e.clientX-this.dragStartX),y.kc),height:Math.max(this.dragStartHeight+(e.clientY-this.dragStartY),y.H7)})}onMouseUp(){document.removeEventListener("mousemove",this.onMouseMove)}onTabChange(e){this.setState({activeKey:e})}adjustHeight(e){this.setState((t=>({height:t.height+e})))}render(){const{adhocFilter:e,options:t,onChange:r,onClose:n,onResize:a,datasource:i,partitionColumn:l,theme:p,operators:h,requireSave:m,...g}=this.props,{adhocFilter:f}=this.state,v=f.isValid(),_=m||!f.equals(e);return(0,M.tZ)(Q,(0,o.Z)({id:"filter-edit-popover"},g,{ref:this.popoverContentRef}),(0,M.tZ)(u.ZP,{id:"adhoc-filter-edit-tabs",defaultActiveKey:f.expressionType,className:"adhoc-filter-edit-tabs",style:{minHeight:this.state.height,width:this.state.width},allowOverflow:!0,onChange:this.onTabChange},(0,M.tZ)(u.ZP.TabPane,{className:"adhoc-filter-edit-tab",key:L.v.SIMPLE,tab:(0,c.t)("Simple")},(0,M.tZ)(d.Z,null,(0,M.tZ)(U,{operators:h,adhocFilter:this.state.adhocFilter,onChange:this.onAdhocFilterChange,options:t,datasource:i,onHeightChange:this.adjustHeight,partitionColumn:l,popoverRef:this.popoverContentRef.current,validHandler:this.setSimpleTabIsValid}))),(0,M.tZ)(u.ZP.TabPane,{className:"adhoc-filter-edit-tab",key:L.v.SQL,tab:(0,c.t)("Custom SQL")},(0,M.tZ)(d.Z,null,(0,M.tZ)(H,{adhocFilter:this.state.adhocFilter,onChange:this.onAdhocFilterChange,options:this.props.options,height:this.state.height,activeKey:this.state.activeKey})))),(0,M.tZ)(G,null,(0,M.tZ)(s.Z,{buttonSize:"small",onClick:this.props.onClose,cta:!0},(0,c.t)("Close")),(0,M.tZ)(s.Z,{disabled:!v||!this.state.isSimpleTabValid||!_,buttonStyle:"primary",buttonSize:"small",className:"m-r-5",onClick:this.onSave,cta:!0},(0,c.t)("Save")),(0,M.tZ)(z,{role:"button","aria-label":"Resize",tabIndex:0,onMouseDown:this.onDragDown,className:"fa fa-expand edit-popover-resize text-muted"})))}}Y.propTypes=j;var W=r(63325),K=r(27845);class X extends n.PureComponent{constructor(e){super(e),this.onPopoverResize=this.onPopoverResize.bind(this),this.closePopover=this.closePopover.bind(this),this.togglePopover=this.togglePopover.bind(this),this.state={popoverVisible:!1}}onPopoverResize(){this.forceUpdate()}closePopover(){this.togglePopover(!1)}togglePopover(e){this.setState({popoverVisible:e})}render(){const{adhocFilter:e,isControlledComponent:t}=this.props,{visible:r,togglePopover:n,closePopover:o}=t?{visible:this.props.visible,togglePopover:this.props.togglePopover,closePopover:this.props.closePopover}:{visible:this.state.popoverVisible,togglePopover:this.togglePopover,closePopover:this.closePopover},a=(0,M.tZ)(W.b,null,(0,M.tZ)(Y,{adhocFilter:e,options:this.props.options,datasource:this.props.datasource,partitionColumn:this.props.partitionColumn,onResize:this.onPopoverResize,onClose:o,sections:this.props.sections,operators:this.props.operators,onChange:this.props.onFilterEdit,requireSave:this.props.requireSave}));return(0,M.tZ)(K.Z,{trigger:"click",content:a,defaultVisible:r,visible:r,onVisibleChange:n,destroyTooltipOnHide:!0},this.props.children)}}const J=X},61641:(e,t,r)=>{"use strict";var n,o;r.d(t,{P:()=>o,v:()=>n}),function(e){e.SIMPLE="SIMPLE",e.SQL="SQL"}(n||(n={})),function(e){e.HAVING="HAVING",e.WHERE="WHERE"}(o||(o={}))},7848:(e,t,r)=>{"use strict";r.d(t,{v:()=>g,w:()=>l});var n=r(67294),o=r(5364),a=r(1090),i=r(69856),s=r(61641);const l=e=>{const[t,r]=(0,n.useState)({});return(0,n.useEffect)((()=>{e.operator===i.d.TEMPORAL_RANGE&&e.expressionType===s.v.SIMPLE||r({}),e.operator===i.d.TEMPORAL_RANGE&&e.comparator===o.vM&&r({actualTimeRange:`${e.subject} (${o.vM})`,title:o.vM}),e.operator===i.d.TEMPORAL_RANGE&&e.expressionType===s.v.SIMPLE&&e.comparator!==o.vM&&t.title!==e.comparator&&(0,a.z1)(e.comparator,e.subject).then((t=>{let{value:n,error:o}=t;r(o?{actualTimeRange:`${e.subject} (${e.comparator})`,title:o}:{actualTimeRange:null!=n?n:"",title:e.comparator})}))}),[e]),t};var c=r(11146),d=r(61988),u=r(45211),p=r(74092),h=r(82342),m=r(11965);const g=e=>{let{columnName:t,timeRange:r,datasource:o,onChange:a}=e;return c.O6&&(0,u.x)(t,o)?(0,m.tZ)(n.Fragment,null,(0,m.tZ)(h.Z,{label:(0,d.t)("Time Range")}),(0,m.tZ)(p.Z,{value:r,name:"time_range",onChange:e=>a(t,e),overlayStyle:"Modal"})):void 0}},56565:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});var n=r(46306),o=r(69856),a=r(12515);const i={"==":"=","!=":"<>",">":">","<":"<",">=":">=","<=":"<=",IN:"IN","NOT IN":"NOT IN",LIKE:"LIKE",ILIKE:"ILIKE",REGEX:"REGEX","IS NOT NULL":"IS NOT NULL","IS NULL":"IS NULL","IS TRUE":"IS TRUE","IS FALSE":"IS FALSE","LATEST PARTITION":e=>{let{datasource:t}=e;return`= '{{ presto.latest_partition('${t.schema}.${t.datasource_name}') }}'`}},s=function(e,t){let{useSimple:r}=void 0===t?{useSimple:!1}:t;if((0,n.Ki)(e)||r){const{subject:t,operator:r}=e,n="comparator"in e?e.comparator:void 0,s=r&&r===o.LT[o.d.LATEST_PARTITION].operation?i[r](e):i[r];return(0,a.CB)(t,s,n)}return(0,n.jz)(e)?e.sqlExpression:""}},33334:(e,t,r)=>{"use strict";r.d(t,{EQ:()=>g,H$:()=>S,IG:()=>R,Ne:()=>_,SW:()=>C,__:()=>f,a7:()=>m,gM:()=>E,gu:()=>b,yj:()=>T,yz:()=>Z});var n=r(73126),o=r(67294),a=r(22068),i=r(27034),s=r(51995),l=r(61988),c=r(9882),d=r(58593),u=r(70707),p=r(99963),h=r(11965);const m=s.iK.div`
  margin-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  :last-child {
    margin-bottom: 0;
  }
`,g=s.iK.div`
  display: flex;
  align-items: center;
  width: 100%;
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  height: ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px;
  background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light3}};
  border-radius: 3px;
  cursor: ${e=>{let{withCaret:t}=e;return t?"pointer":"default"}};
`,f=s.iK.div`
  ${e=>{let{theme:t}=e;return`\n    display: flex;\n    width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    align-items: center;\n    white-space: nowrap;\n    padding-left: ${t.gridUnit}px;\n    svg {\n      margin-right: ${t.gridUnit}px;\n    }\n    .type-label {\n      margin-right: ${2*t.gridUnit}px;\n      margin-left: ${t.gridUnit}px;\n      font-weight: ${t.typography.weights.normal};\n      width: auto;\n    }\n    .option-label {\n      display: inline;\n    }\n  `}}
`,v=s.iK.span`
  overflow: hidden;
  text-overflow: ellipsis;
`,_=s.iK.div`
  height: 100%;
  border-left: solid 1px ${e=>{let{theme:t}=e;return t.colors.grayscale.dark2}}0C;
  margin-left: auto;
`,b=s.iK.div`
  height: 100%;
  width: ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px;
  border-right: solid 1px ${e=>{let{theme:t}=e;return t.colors.grayscale.dark2}}0C;
  cursor: pointer;
`,y=(0,s.iK)(c.V)`
  margin: 0 ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,E=s.iK.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
`,T=s.iK.div`
  padding: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  border: solid 1px ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
  border-radius: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,S=s.iK.div`
  padding: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  border: ${e=>{let{canDrop:t,isOver:r,theme:n}=e;return t?`dashed 1px ${n.colors.info.dark1}`:r&&!t?`dashed 1px ${n.colors.error.dark1}`:`solid 1px ${n.colors.grayscale.light2}`}};
  border-radius: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
`,C=s.iK.div`
  display: flex;
  align-items: center;
  width: 100%;
  height: ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px;
  padding-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light1}};
  border: dashed 1px ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
  border-radius: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  cursor: ${e=>{let{cancelHover:t}=e;return t?"inherit":"pointer"}};

  :hover {
    background-color: ${e=>{let{cancelHover:t,theme:r}=e;return t?"inherit":r.colors.grayscale.light4}};
  }

  :active {
    background-color: ${e=>{let{cancelHover:t,theme:r}=e;return t?"inherit":r.colors.grayscale.light3}};
  }
`,R=s.iK.button`
  display: flex;
  align-items: center;
  justify-content: center;
  height: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  width: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;
  padding: 0;
  background-color: ${e=>{let{theme:t}=e;return t.colors.primary.dark1}};
  border: none;
  border-radius: 2px;

  :disabled {
    cursor: not-allowed;
    background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light1}};
  }
`,Z=e=>{let{label:t,savedMetric:r,adhocMetric:c,onRemove:E,onMoveLabel:T,onDropLabel:S,withCaret:C,isFunction:R,type:Z,index:A,isExtra:x,datasourceWarningMessage:O,tooltipTitle:w,multi:I=!0,...N}=e;const D=(0,s.Fg)(),L=(0,o.useRef)(null),M=(0,o.useRef)(null),k=null==r?void 0:r.metric_name,[,P]=(0,a.L)({accept:Z,drop(){I&&(null==S||S())},hover(e,t){var r;if(!I)return;if(!L.current)return;const n=e.index,o=A;if(n===o)return;const a=null==(r=L.current)?void 0:r.getBoundingClientRect(),i=(a.bottom-a.top)/2,s=t.getClientOffset(),l=null!=s&&s.y?(null==s?void 0:s.y)-a.top:0;n<o&&l<i||n>o&&l>i||(null==T||T(n,o),e.index=o)}}),[{isDragging:U},$]=(0,i.c)({item:{type:Z,index:A,value:null!=r&&r.metric_name?r:c},collect:e=>({isDragging:e.isDragging()})});return $(P(L)),(0,h.tZ)(m,{ref:L},(0,h.tZ)(g,(0,n.Z)({withCaret:C},N),(0,h.tZ)(b,{role:"button",onClick:E},(0,h.tZ)(u.Z.XSmall,{iconColor:D.colors.grayscale.light1})),(0,h.tZ)(f,null,R&&(0,h.tZ)(u.Z.FieldDerived,null),(()=>{const e=!U&&"string"==typeof t&&w&&t&&w!==t||!U&&M&&M.current&&M.current.scrollWidth>M.current.clientWidth;return r&&k?(0,h.tZ)(p.B,{metric:r,labelRef:M,shouldShowTooltip:!U}):e?(0,h.tZ)(d.u,{title:w||t},(0,h.tZ)(v,{ref:M},t)):(0,h.tZ)(v,{ref:M},t)})()),(!!O||x)&&(0,h.tZ)(y,{icon:"exclamation-triangle",placement:"top",bsStyle:"warning",tooltip:O||(0,l.t)("\n                This filter was inherited from the dashboard's context.\n                It won't be saved when saving the chart.\n              ")}),C&&(0,h.tZ)(_,null,(0,h.tZ)(u.Z.CaretRight,{iconColor:D.colors.grayscale.light1}))))}},79684:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(67294),o=r(99298),a=r(75294),i=r(23279),s=r.n(i),l=r(27600),c=r(82342),d=r(9875),u=r(11965);const p=e=>null==e?"":String(e);class h extends n.Component{constructor(e){super(e),this.initialValue=void 0,this.onChange=e=>{var t,r;let n=e;const i=[];if(""!==e&&this.props.isFloat){const t=(0,o.Z)(e);t?i.push(t):n=e.match(/.*([.0])$/g)?e:parseFloat(e)}if(""!==e&&this.props.isInt){const t=(0,a.Z)(e);t?i.push(t):n=parseInt(e,10)}null==(t=(r=this.props).onChange)||t.call(r,n,i)},this.debouncedOnChange=s()((e=>{this.onChange(e)}),l.oP),this.onChangeWrapper=e=>{const{value:t}=e.target;this.setState({value:t},(()=>{this.debouncedOnChange(t)}))},this.initialValue=e.value,this.state={value:p(this.initialValue)}}render(){let{value:e}=this.state;return this.initialValue!==this.props.value&&(this.initialValue=this.props.value,e=p(this.props.value)),(0,u.tZ)("div",null,(0,u.tZ)(c.Z,this.props),(0,u.tZ)(d.II,{type:"text",placeholder:this.props.placeholder,onChange:this.onChangeWrapper,onFocus:this.props.onFocus,value:e,disabled:this.props.disabled,"aria-label":this.props.label}))}}},85626:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f}),r(67294);var n=r(51995),o=r(42110),a=r(120),i=r(13433),s=r(50909),l=r(53459),c=r(49889),d=r(33743),u=r(22489),p=r(11965);const h=(0,n.iK)(s.qi)`
  && {
    margin: 0 0 ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`;o.Z.registerLanguage("markdown",l.Z),o.Z.registerLanguage("html",c.Z),o.Z.registerLanguage("sql",d.Z),o.Z.registerLanguage("json",u.Z);const m=n.iK.div`
  height: 100%;
  display: flex;
  flex-direction: column;
`,g=(0,n.iK)(o.Z)`
  flex: 1;
`,f=e=>{const{sql:t,language:r="sql"}=e;return(0,p.tZ)(m,{key:t},(0,p.tZ)(i.Z,{text:t,shouldShowText:!1,copyNode:(0,p.tZ)(h,{buttonSize:"xsmall"},(0,p.tZ)("i",{className:"fa fa-clipboard"}))}),(0,p.tZ)(g,{language:r,style:a.Z},t))}},13284:(e,t,r)=>{"use strict";r.d(t,{UB:()=>S,ZP:()=>Y});var n,o=r(73126),a=r(67294),i=r(74221),s=r(94184),l=r.n(s),c=r(61988),d=r(51995),u=r(11965),p=r(16355),h=r(4715),m=r(58593),g=r(9875),f=r(37921),v=r(14278),_=r(70707),b=r(1510),y=r(64239);!function(e){e.ALL_CHARTS="ALL_CHARTS",e.CATEGORY="CATEGORY",e.TAGS="TAGS",e.RECOMMENDED_TAGS="RECOMMENDED_TAGS"}(n||(n={}));const E=["line","big_number","big_number_total","table","pivot_table_v2","echarts_timeseries_line","echarts_area","echarts_timeseries_bar","echarts_timeseries_scatter","pie","mixed_timeseries","filter_box","dist_bar","area","bar","deck_polygon","time_table","histogram","deck_scatter","deck_hex","time_pivot","deck_arc","heatmap","deck_grid","deck_screengrid","treemap_v2","box_plot","sunburst","sankey","word_cloud","mapbox","kepler","cal_heatmap","rose","bubble","bubble_v2","deck_geojson","horizon","deck_multi","compare","partition","event_flow","deck_path","graph_chart","world_map","paired_ttest","para","country_map"],T=new Set(E),S=1090,C=(0,c.t)("Other"),R=(0,c.t)("All charts"),Z=[(0,c.t)("Popular"),(0,c.t)("ECharts"),(0,c.t)("Advanced-Analytics")],A=d.iK.div`
  ${e=>{let{isSelectedVizMetadata:t}=e;return`\n    display: grid;\n    grid-template-rows: ${t?"auto minmax(100px, 1fr) minmax(200px, 35%)":"auto minmax(100px, 1fr)"};\n    // em is used here because the sidebar should be sized to fit the longest standard tag\n    grid-template-columns: minmax(14em, auto) 5fr;\n    grid-template-areas:\n      'sidebar search'\n      'sidebar main'\n      'details details';\n    height: 70vh;\n    overflow: auto;\n  `}}
`,x=d.iK.h3`
  margin-top: 0;
  margin-bottom: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.l}}px;
  font-weight: ${e=>{let{theme:t}=e;return t.typography.weights.bold}};
  line-height: ${e=>{let{theme:t}=e;return 6*t.gridUnit}}px;
`,O=d.iK.div`
  grid-area: sidebar;
  display: flex;
  flex-direction: column;
  border-right: 1px solid ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
  overflow: auto;

  .ant-collapse .ant-collapse-item {
    .ant-collapse-header {
      font-size: ${e=>{let{theme:t}=e;return t.typography.sizes.s}}px;
      color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
      padding-left: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
      padding-bottom: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    }
    .ant-collapse-content .ant-collapse-content-box {
      display: flex;
      flex-direction: column;
      padding: 0 ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    }
  }
`,w=d.iK.div`
  grid-area: main;
  overflow-y: auto;
`,I=d.iK.div`
  ${e=>{let{theme:t}=e;return`\n    grid-area: search;\n    margin-top: ${3*t.gridUnit}px;\n    margin-bottom: ${t.gridUnit}px;\n    margin-left: ${3*t.gridUnit}px;\n    margin-right: ${3*t.gridUnit}px;\n    .ant-input-affix-wrapper {\n      padding-left: ${2*t.gridUnit}px;\n    }\n  `}}
`,N=d.iK.div`
  display: flex;
  justify-content: center;
  align-items: center;
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
`,D=d.iK.button`
  ${e=>{let{theme:t}=e;return`\n    all: unset; // remove default button styles\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    cursor: pointer;\n    margin: ${t.gridUnit}px 0;\n    padding: 0 ${t.gridUnit}px;\n    border-radius: ${t.borderRadius}px;\n    line-height: 2em;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    position: relative;\n\n    &:focus {\n      outline: initial;\n    }\n\n    &.selected {\n      background-color: ${t.colors.primary.base};\n      color: ${t.colors.primary.light5};\n\n      svg {\n        color: ${t.colors.primary.light5};\n      }\n\n      &:hover {\n        .cancel {\n          visibility: visible;\n        }\n      }\n    }\n\n    & span:first-of-type svg {\n      margin-top: ${1.5*t.gridUnit}px;\n    }\n\n    .cancel {\n      visibility: hidden;\n    }\n  `}}
`,L=d.iK.div`
  overflow: auto;
  display: grid;
  grid-template-columns: repeat(
    auto-fill,
    ${e=>{let{theme:t}=e;return 24*t.gridUnit}}px
  );
  grid-auto-rows: max-content;
  justify-content: space-evenly;
  grid-gap: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
  justify-items: center;
  // for some reason this padding doesn't seem to apply at the bottom of the container. Why is a mystery.
  padding: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,M=e=>u.iv`
  grid-area: details;
  border-top: 1px solid ${e.colors.grayscale.light2};
`,k=e=>u.iv`
  padding: ${4*e.gridUnit}px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: auto auto 1fr;
  grid-template-areas:
    'viz-name examples-header'
    'viz-tags examples'
    'description examples';
`,P=d.iK.div`
  grid-area: viz-tags;
  width: ${e=>{let{theme:t}=e;return 120*t.gridUnit}}px;
  padding-right: ${e=>{let{theme:t}=e;return 14*t.gridUnit}}px;
  padding-bottom: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`,U=d.iK.p`
  grid-area: description;
  overflow: auto;
  padding-right: ${e=>{let{theme:t}=e;return 14*t.gridUnit}}px;
  margin: 0;
`,$=d.iK.div`
  grid-area: examples;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  overflow: auto;
  gap: ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px;

  img {
    height: 100%;
    border-radius: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    border: 1px solid ${e=>{let{theme:t}=e;return t.colors.grayscale.light2}};
  }
`,F=e=>u.iv`
  cursor: pointer;
  width: ${24*e.gridUnit}px;
  position: relative;

  img {
    min-width: ${24*e.gridUnit}px;
    min-height: ${24*e.gridUnit}px;
    border: 1px solid ${e.colors.grayscale.light2};
    border-radius: ${e.gridUnit}px;
    transition: border-color ${e.transitionTiming};
  }

  &.selected img {
    border: 2px solid ${e.colors.primary.light2};
  }

  &:hover:not(.selected) img {
    border: 1px solid ${e.colors.grayscale.light1};
  }

  .viztype-label {
    margin-top: ${2*e.gridUnit}px;
    text-align: center;
  }
`,q=d.iK.div`
  ${e=>{let{theme:t}=e;return`\n    border: 1px solid ${t.colors.primary.dark1};\n    box-sizing: border-box;\n    border-radius: ${t.gridUnit}px;\n    background: ${t.colors.grayscale.light5};\n    line-height: ${2.5*t.gridUnit}px;\n    color: ${t.colors.primary.dark1};\n    font-size: ${t.typography.sizes.s}px;\n    font-weight: ${t.typography.weights.bold};\n    text-align: center;\n    padding: ${.5*t.gridUnit}px ${t.gridUnit}px;\n    text-transform: uppercase;\n    cursor: pointer;\n\n    div {\n      transform: scale(0.83,0.83);\n    }\n  `}}
`,V=d.iK.div`
  position: absolute;
  right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  top: ${e=>{let{theme:t}=e;return 19*t.gridUnit}}px;
`,B=d.iK.div`
  display: inline-block !important;
  margin-left: ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
`;function H(e){return T.has(e.key)?E.indexOf(e.key):E.length}const j=e=>{let{entry:t,selectedViz:r,setSelectedViz:n,onDoubleClick:o}=e;const a=(0,d.Fg)(),{key:i,value:s}=t,l=r===t.key;return(0,u.tZ)("div",{role:"button",css:F(a),tabIndex:0,className:l?"selected":"",onClick:()=>n(i),onDoubleClick:o},(0,u.tZ)("img",{alt:s.name,width:"100%",className:"viztype-selector "+(l?"selected":""),src:s.thumbnail}),(0,u.tZ)("div",{className:"viztype-label"},s.name),s.label&&(0,u.tZ)(V,null,(0,u.tZ)(q,null,(0,u.tZ)("div",null,(0,c.t)(s.label)))))},z=e=>{let{vizEntries:t,...r}=e;return(0,u.tZ)(L,null,t.map((e=>(0,u.tZ)(j,(0,o.Z)({key:e.key},r,{entry:e})))))},Q=e=>{let{selector:t,sectionId:r,icon:n,isSelected:o,onClick:i,className:s}=e;const c=(0,a.useRef)(null);return(0,a.useEffect)((()=>{o&&queueMicrotask((()=>(0,y.default)(c.current,{behavior:"smooth",scrollMode:"if-needed"})))}),[]),(0,u.tZ)(D,{ref:c,key:t,name:t,className:l()(s,o&&"selected"),onClick:()=>i(t,r)},n,t)},G=(e,t)=>t===e.category||t===C&&null==e.category||(e.tags||[]).indexOf(t)>-1;function Y(e){var t,r;const{selectedViz:o,onChange:s,onDoubleClick:l,className:d}=e,{mountedPluginMetadata:y}=(0,v.gp)(),E=(0,a.useRef)(),[T,S]=(0,a.useState)(""),[D,L]=(0,a.useState)(!0),F=D&&!!T,V=o?y[o]:null,j=(0,a.useMemo)((()=>{const t=Object.entries(y).map((e=>{let[t,r]=e;return{key:t,value:r}})).filter((t=>{let{key:r}=t;return!e.denyList.includes(r)})).filter((e=>{let{value:t}=e;return(0,b.X3)(t.behaviors||[])&&!t.deprecated}));return t.sort(((e,t)=>H(e)-H(t))),t}),[y]),Y=(0,a.useMemo)((()=>{const e={};return j.forEach((t=>{const r=t.value.category||C;e[r]||(e[r]=[]),e[r].push(t)})),e}),[j]),W=(0,a.useMemo)((()=>Object.keys(Y).sort(((e,t)=>e===C?1:t===C?-1:e.localeCompare(t)))),[Y]),K=(0,a.useMemo)((()=>{const e={};return j.forEach((t=>{(t.value.tags||[]).forEach((r=>{e[r]||(e[r]=[]),e[r].push(t)}))})),e}),[j]),X=(0,a.useMemo)((()=>Object.keys(K).sort(((e,t)=>e.localeCompare(t))).filter((e=>-1===Z.indexOf(e)))),[K]),J=(0,a.useMemo)((()=>j.sort(((e,t)=>e.key.localeCompare(t.key)))),[j]),[ee,te]=(0,a.useState)((()=>(null==V?void 0:V.category)||Z[0])),[re,ne]=(0,a.useState)((()=>null!=V&&V.category?n.CATEGORY:n.RECOMMENDED_TAGS)),oe=(0,a.useMemo)((()=>new i.Z(j,{ignoreLocation:!0,threshold:.3,keys:[{name:"value.name",weight:4},{name:"value.tags",weight:2},"value.description"]})),[j]),ae=(0,a.useMemo)((()=>""===T.trim()?[]:oe.search(T).map((e=>e.item)).sort(((e,t)=>{var r,n;const o=null==(r=e.value)?void 0:r.label,a=null==(n=t.value)?void 0:n.label,i=o&&p.eH[o]?p.eH[o].weight:0;return(a&&p.eH[a]?p.eH[a].weight:0)-i}))),[T,oe]),ie=(0,a.useCallback)((()=>{L(!0)}),[]),se=(0,a.useCallback)((e=>S(e.target.value)),[]),le=(0,a.useCallback)((()=>{L(!1),S(""),E.current.blur()}),[]),ce=(0,a.useCallback)(((e,t)=>{D&&le(),te(e),ne(t);const r=V&&G(V,e);e===ee||r||s(null)}),[le,D,ee,V,s]),de=(0,a.useMemo)((()=>({[n.RECOMMENDED_TAGS]:{title:(0,c.t)("Recommended tags"),icon:(0,u.tZ)(_.Z.Tags,null),selectors:Z},[n.CATEGORY]:{title:(0,c.t)("Category"),icon:(0,u.tZ)(_.Z.Category,null),selectors:W},[n.TAGS]:{title:(0,c.t)("Tags"),icon:(0,u.tZ)(_.Z.Tags,null),selectors:X}})),[W,X]);return(0,u.tZ)(A,{className:d,isSelectedVizMetadata:Boolean(V)},(0,u.tZ)(O,null,(0,u.tZ)(Q,{css:e=>{let{gridUnit:t}=e;return u.iv`
              margin: ${2*t}px;
              margin-bottom: 0;
            `},sectionId:n.ALL_CHARTS,selector:R,icon:(0,u.tZ)(_.Z.Ballot,null),isSelected:!F&&R===ee&&n.ALL_CHARTS===re,onClick:ce}),(0,u.tZ)(h.Ol,{expandIconPosition:"right",ghost:!0,defaultActiveKey:Object.keys(de)},Object.keys(de).map((e=>{const t=de[e];return(0,u.tZ)(h.Ol.Panel,{header:(0,u.tZ)("span",{className:"header"},t.title),key:e},t.selectors.map((r=>(0,u.tZ)(Q,{key:r,selector:r,sectionId:e,icon:t.icon,isSelected:!F&&r===ee&&e===re,onClick:ce}))))})))),(0,u.tZ)(I,null,(0,u.tZ)(g.II,{type:"text",ref:E,value:T,placeholder:(0,c.t)("Search all charts"),onChange:se,onFocus:ie,prefix:(0,u.tZ)(N,null,(0,u.tZ)(_.Z.Search,{iconSize:"m"})),suffix:(0,u.tZ)(N,null,T&&(0,u.tZ)(_.Z.XLarge,{iconSize:"m",onClick:le}))})),(0,u.tZ)(w,null,(0,u.tZ)(z,{vizEntries:F?ae:ee===R&&re===n.ALL_CHARTS?J:re===n.CATEGORY&&Y[ee]?Y[ee]:re!==n.TAGS&&re!==n.RECOMMENDED_TAGS||!K[ee]?[]:K[ee],selectedViz:o,setSelectedViz:s,onDoubleClick:l})),V?(0,u.tZ)("div",{css:e=>[M(e),k(e)]},(0,u.tZ)(a.Fragment,null,(0,u.tZ)(x,{css:u.iv`
                grid-area: viz-name;
                position: relative;
              `},null==V?void 0:V.name,(null==V?void 0:V.label)&&(0,u.tZ)(m.u,{id:"viz-badge-tooltip",placement:"top",title:null!=(t=V.labelExplanation)?t:p.t$[V.label]},(0,u.tZ)(B,null,(0,u.tZ)(q,null,(0,u.tZ)("div",null,(0,c.t)(V.label)))))),(0,u.tZ)(P,null,null==V?void 0:V.tags.map((e=>(0,u.tZ)(f.Z,{key:e},e)))),(0,u.tZ)(U,null,(null==V?void 0:V.description)||(0,c.t)("No description available.")),(0,u.tZ)(x,{css:u.iv`
                grid-area: examples-header;
              `},(0,c.t)("Examples")),(0,u.tZ)($,null,(null!=V&&null!=(r=V.exampleGallery)&&r.length?V.exampleGallery:[{url:null==V?void 0:V.thumbnail,caption:null==V?void 0:V.name}]).map((e=>(0,u.tZ)("img",{key:e.url,src:e.url,alt:e.caption,title:e.caption})))))):null)}},99963:(e,t,r)=>{"use strict";r.d(t,{B:()=>l,l:()=>c}),r(67294);var n=r(51995),o=r(51384),a=r(65634),i=r(11965);const s=n.iK.div`
  width: 100%;
  > span {
    display: flex;
    align-items: center;
  }

  .option-label {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    & ~ i {
      margin-left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
    }
  }
  .type-label {
    margin-right: ${e=>{let{theme:t}=e;return 3*t.gridUnit}}px;
    width: ${e=>{let{theme:t}=e;return 7*t.gridUnit}}px;
    display: inline-block;
    text-align: center;
    font-weight: ${e=>{let{theme:t}=e;return t.typography.weights.bold}};
  }
`,l=e=>(0,i.tZ)(s,null,(0,i.tZ)(o.m,e)),c=e=>(0,i.tZ)(s,null,(0,i.tZ)(a.E,e))},69856:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>c,GS:()=>l,H7:()=>_,LT:()=>s,Ps:()=>a,Q_:()=>h,YY:()=>o,cM:()=>f,d:()=>i,ft:()=>g,i2:()=>v,kc:()=>b,m_:()=>m,qB:()=>u,qK:()=>d,xA:()=>y,yi:()=>p});var n=r(61988);const o={AVG:"AVG",COUNT:"COUNT",COUNT_DISTINCT:"COUNT_DISTINCT",MAX:"MAX",MIN:"MIN",SUM:"SUM"},a=Object.values(o);var i;!function(e){e.EQUALS="EQUALS",e.NOT_EQUALS="NOT_EQUALS",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.IN="IN",e.NOT_IN="NOT_IN",e.LIKE="LIKE",e.ILIKE="ILIKE",e.IS_NOT_NULL="IS_NOT_NULL",e.IS_NULL="IS_NULL",e.LATEST_PARTITION="LATEST_PARTITION",e.IS_TRUE="IS_TRUE",e.IS_FALSE="IS_FALSE",e.TEMPORAL_RANGE="TEMPORAL_RANGE"}(i||(i={}));const s={[i.EQUALS]:{display:(0,n.t)("Equal to (=)"),operation:"=="},[i.NOT_EQUALS]:{display:(0,n.t)("Not equal to ()"),operation:"!="},[i.LESS_THAN]:{display:(0,n.t)("Less than (<)"),operation:"<"},[i.LESS_THAN_OR_EQUAL]:{display:(0,n.t)("Less or equal (<=)"),operation:"<="},[i.GREATER_THAN]:{display:(0,n.t)("Greater than (>)"),operation:">"},[i.GREATER_THAN_OR_EQUAL]:{display:(0,n.t)("Greater or equal (>=)"),operation:">="},[i.IN]:{display:(0,n.t)("In"),operation:"IN"},[i.NOT_IN]:{display:(0,n.t)("Not in"),operation:"NOT IN"},[i.LIKE]:{display:(0,n.t)("Like"),operation:"LIKE"},[i.ILIKE]:{display:(0,n.t)("Like (case insensitive)"),operation:"ILIKE"},[i.IS_NOT_NULL]:{display:(0,n.t)("Is not null"),operation:"IS NOT NULL"},[i.IS_NULL]:{display:(0,n.t)("Is null"),operation:"IS NULL"},[i.LATEST_PARTITION]:{display:(0,n.t)("use latest_partition template"),operation:"LATEST PARTITION"},[i.IS_TRUE]:{display:(0,n.t)("Is true"),operation:"=="},[i.IS_FALSE]:{display:(0,n.t)("Is false"),operation:"=="},[i.TEMPORAL_RANGE]:{display:(0,n.t)("TEMPORAL_RANGE"),operation:"TEMPORAL_RANGE"}},l=Object.values(i),c=(i.LIKE,i.ILIKE,[i.EQUALS,i.NOT_EQUALS,i.LESS_THAN,i.LESS_THAN_OR_EQUAL,i.GREATER_THAN,i.GREATER_THAN_OR_EQUAL]),d=new Set([i.IN,i.NOT_IN]),u=new Set([i.LATEST_PARTITION,i.TEMPORAL_RANGE]),p=[i.IS_NOT_NULL,i.IS_NULL,i.LATEST_PARTITION,i.IS_TRUE,i.IS_FALSE],h=/^(LONG|DOUBLE|FLOAT)?(SUM|AVG|MAX|MIN|COUNT)\([A-Z0-9_."]*\)$/i,m={time_range:(0,n.t)("Time range"),granularity_sqla:(0,n.t)("Time column"),time_grain_sqla:(0,n.t)("Time grain"),granularity:(0,n.t)("Time granularity")},g={CLEARABLE:"clearable",DEFAULT_VALUE:"defaultValue",MULTIPLE:"multiple",SEARCH_ALL_OPTIONS:"searchAllOptions",SORT_ASCENDING:"asc",SORT_METRIC:"metric"},f=1e3,v={time_range:"__time_range",granularity_sqla:"__time_col",time_grain_sqla:"__time_grain",granularity:"__granularity"},_=240,b=320,y=0},10331:(e,t,r)=>{"use strict";r.d(t,{os:()=>P,RO:()=>T,mi:()=>C,Bx:()=>y,vP:()=>S,YY:()=>O,Hu:()=>R,Bq:()=>_});var n={};r.r(n),r.d(n,{NVD3TimeSeries:()=>f,annotations:()=>g,colorScheme:()=>h,datasourceAndVizType:()=>p,sqlaTimeSeries:()=>m});var o=r(30845),a=r(46078),i=r(37687),s=r(38575),l=r(89368),c=(r(67294),r(61988)),d=r(46666),u=r(11965);const p={controlSetRows:[["datasource"],["viz_type"],[{name:"slice_id",config:{type:"HiddenControl",label:(0,c.t)("Chart ID"),hidden:!0,description:(0,c.t)("The id of the active chart")}},{name:"cache_timeout",config:{type:"HiddenControl",label:(0,c.t)("Cache Timeout (seconds)"),hidden:!0,description:(0,c.t)("The number of seconds before expiring the cache")}},{name:"url_params",config:{type:"HiddenControl",label:(0,c.t)("URL parameters"),hidden:!0,description:(0,c.t)("Extra parameters for use in jinja templated queries")}}]]},h={label:(0,c.t)("Color scheme"),controlSetRows:[["color_scheme"]]},m={label:(0,c.t)("Time"),description:(0,c.t)("Time related form attributes"),expanded:!0,controlSetRows:[["granularity_sqla"],["time_range"]]},g={label:(0,c.t)("Annotations and layers"),tabOverride:"data",expanded:!0,controlSetRows:[[{name:"annotation_layers",config:{type:"AnnotationLayerControl",label:"",default:[],description:(0,c.t)("Annotation layers"),renderTrigger:!0,tabOverride:"data"}}]]},f=[{label:(0,c.t)("Query"),expanded:!0,controlSetRows:[["metrics"],["adhoc_filters"],["groupby"],["limit","timeseries_limit_metric"],["order_desc"],[{name:"contribution",config:{type:"CheckboxControl",label:(0,c.t)("Contribution"),default:!1,description:(0,c.t)("Compute the contribution to the total")}}],["row_limit",null]]},{label:(0,c.t)("Advanced analytics"),tabOverride:"data",description:(0,c.t)("This section contains options that allow for advanced analytical post processing of query results"),controlSetRows:[[(0,u.tZ)(d.U,null,(0,c.t)("Rolling window"))],[{name:"rolling_type",config:{type:"SelectControl",label:(0,c.t)("Rolling function"),default:"None",choices:[["None",(0,c.t)("None")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")],["std",(0,c.t)("std")],["cumsum",(0,c.t)("cumsum")]],description:(0,c.t)("Defines a rolling window function to apply, works along with the [Periods] text box")}},{name:"rolling_periods",config:{type:"TextControl",label:(0,c.t)("Periods"),isInt:!0,description:(0,c.t)("Defines the size of the rolling window function, relative to the time granularity selected")}},{name:"min_periods",config:{type:"TextControl",label:(0,c.t)("Min periods"),isInt:!0,description:(0,c.t)('The minimum number of rolling periods required to show a value. For instance if you do a cumulative sum on 7 days you may want your "Min Period" to be 7, so that all data points shown are the total of 7 periods. This will hide the "ramp up" taking place over the first 7 periods')}}],[(0,u.tZ)(d.U,null,(0,c.t)("Time comparison"))],[{name:"time_compare",config:{type:"SelectControl",multi:!0,freeForm:!0,label:(0,c.t)("Time shift"),choices:[["1 day",(0,c.t)("1 day")],["1 week",(0,c.t)("1 week")],["28 days",(0,c.t)("28 days")],["30 days",(0,c.t)("30 days")],["52 weeks",(0,c.t)("52 weeks")],["1 year",(0,c.t)("1 year")],["104 weeks",(0,c.t)("104 weeks")],["2 years",(0,c.t)("2 years")],["156 weeks",(0,c.t)("156 weeks")],["3 years",(0,c.t)("3 years")]],description:(0,c.t)("Overlay one or more timeseries from a relative time period. Expects relative time deltas in natural language (example: 24 hours, 7 days, 52 weeks, 365 days). Free text is supported.")}},{name:"comparison_type",config:{type:"SelectControl",label:(0,c.t)("Calculation type"),default:"values",choices:[["values",(0,c.t)("Actual values")],["absolute",(0,c.t)("Difference")],["percentage",(0,c.t)("Percentage change")],["ratio",(0,c.t)("Ratio")]],description:(0,c.t)("How to display time shifts: as individual lines; as the difference between the main time series and each time shift; as the percentage change; or as the ratio between series and time shifts.")}}],[(0,u.tZ)(d.U,null,(0,c.t)("Resample"))],[{name:"resample_rule",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Rule"),default:null,choices:[["1T",(0,c.t)("1T")],["1H",(0,c.t)("1H")],["1D",(0,c.t)("1D")],["7D",(0,c.t)("7D")],["1M",(0,c.t)("1M")],["1AS",(0,c.t)("1AS")]],description:(0,c.t)("Pandas resample rule")}},{name:"resample_method",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Method"),default:null,choices:[["asfreq",(0,c.t)("asfreq")],["bfill",(0,c.t)("bfill")],["ffill",(0,c.t)("ffill")],["median",(0,c.t)("median")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")]],description:(0,c.t)("Pandas resample method")}}]]}],v=(0,o.Z)(((e,t)=>{const{sectionOverrides:r={},controlOverrides:o,controlPanelSections:i=[]}=t,c={...n};Object.entries(r).forEach((e=>{let[t,r]=e;"object"==typeof r&&r.constructor===Object?c[t]={...c[t],...r}:c[t]=r}));const{datasourceAndVizType:d}=c,u=[a.i9.Query,a.i9.Table].includes(e)?["granularity"]:["granularity_sqla","time_grain_sqla"];return[d].concat(i.filter(s.D_)).map((e=>{const{controlSetRows:t}=e;return{...e,controlSetRows:(null==t?void 0:t.map((e=>e.filter((e=>"string"!=typeof e||!u.includes(e))).map((e=>(0,l.q)(e,o))))))||[]}}))}));function _(e,t){const r=(0,i.Z)().get(e)||{};return v(t,r)}const b=(0,o.Z)(((e,t)=>{const{controlOverrides:r={},controlPanelSections:n=[]}=t,o=(0,l.q)(function(e,t){var r;return null!=(r=e.filter(s.D_).map((e=>e.controlSetRows)).flat(2).find((e=>t===e||null!==e&&"object"==typeof e&&"name"in e&&e.name===t)))?r:null}(n,e),r);return o&&"config"in o?o.config:o})),y=function(e,t){const r=(0,i.Z)().get(t)||{};return b(e,r)};var E=r(55786);function T(e,t){const{mapStateToProps:r}=e;let n={...e},{value:o}=n;return r&&t&&(n={...e,...r.call(e,t,e)},o=o||n.value),"function"==typeof n.initialValue&&(n.initialValue=n.initialValue(n,t),"function"==typeof n.initialValue&&delete n.initialValue),n.initialValue&&(o=n.initialValue,delete n.initialValue),"function"==typeof n.default&&(n.default=n.default(n,t),"function"==typeof n.default&&delete n.default),n.default&&void 0===o&&(o=n.default),o&&n.multi&&!Array.isArray(o)&&(o=[o]),n.value=o,function(e,t){const r=e.validators,{externalValidationErrors:n=[]}=e,o=[];r&&r.length>0&&r.forEach((r=>{const n=r.call(e,e.value,t);n&&o.push(n)}));const a=[...o,...n];return{...e,validationErrors:a}}(function(e){if("SelectControl"===e.type&&!e.freeForm&&e.choices&&e.value){const t={...e},r=e.choices,n=(0,E.Z)(e.value),o=r.map((e=>e[0]));if(e.multi&&n.length>0)return t.value=n.filter((e=>o.includes(e))),t;if(!e.multi&&!o.includes(n[0]))return t.value=null,t}return e}(n),n)}function S(e,t,r){if(!e)return null;const n={...e,value:r};return null!=t&&t.controls||null===t?T(n,t):n}function C(e,t,r,n){const o={};return _(e,t).forEach((e=>e.controlSetRows.forEach((e=>e.forEach((e=>{if(null!=e&&e.config&&e.name){const{config:t,name:a}=e;o[a]=S(t,r,n[a])}})))))),o}function R(e){const t={};return Object.keys(e).forEach((r=>{const n=e[r];t[r]=n.value})),t}var Z=r(62446),A=r(46306);const x=(e,t,r)=>t.options&&"string"==typeof r&&t.options.some((e=>Array.isArray(e)?e[0]===r:e.column_name===r))?e.columns.some((e=>e.column_name===r)):t.savedMetrics&&(0,Z.AG)(r)&&t.savedMetrics.some((e=>e.metric_name===r))?e.metrics.some((e=>e.metric_name===r)):t.columns&&((0,Z.nX)(r)||(0,A.Ki)(r))&&t.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject}))?e.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject})):!!(0,Z.q5)(r)&&(Object.assign(r,{datasourceWarning:!0}),!0),O=(e,t,r)=>{if(null!=r){if(Array.isArray(r)){const n=r.filter((r=>x(e,t,r)));return n.length>0?n:t.default}return x(e,t,r)?r:t.default}};var w=r(57557),I=r.n(w),N=r(20002),D=r(35854);const L=["metric","metrics","metric_2","size","x","y","secondary_metric"],M=["groupby","columns","groupbyColumns","groupbyRows","entity","series","series_columns"],k=["granularity_sqla","time_grain_sqla","time_range","adhoc_filters","limit","timeseries_limit_metric","series_limit_metric","order_desc","row_limit","x_axis","rolling_type","rolling_periods","min_periods","time_compare","comparison_type","resample_rule","resample_method"];class P{constructor(e){var t,r;this.sfd=void 0;const n=Object.freeze(e),o=null==n||null==(t=n.standardizedFormData)?void 0:t.memorizedFormData,a=n.viz_type;let i,s=new Map;if(Array.isArray(o)&&o.length>0&&n.datasource===(null==(r=o.slice(-1)[0][1])?void 0:r.datasource))s=new Map(n.standardizedFormData.memorizedFormData),s.has(a)&&s.delete(a),s.set(a,n),i=P.getStandardizedControls(n);else{const e=I()(n,"standardizedFormData");s.set(a,e),i=P.getStandardizedControls(e)}this.sfd={controls:i,memorizedFormData:s}}static getStandardizedControls(e){const t={metrics:[],columns:[]};if(Object.entries(e).forEach((e=>{let[r,n]=e;L.includes(r)&&t.metrics.push(...(0,E.Z)(n)),M.includes(r)&&t.columns.push(...(0,E.Z)(n))})),(0,s.pp)(e)){const{metrics:r,columns:n}=e.standardizedFormData.controls;t.metrics.push(...r),t.columns.push(...n)}return t}getLatestFormData(e){return this.has(e)?this.get(e):this.memorizedFormData.slice(-1)[0][1]}get standardizedControls(){return this.sfd.controls}get memorizedFormData(){return Array.from(this.sfd.memorizedFormData.entries())}serialize(){return{controls:this.standardizedControls,memorizedFormData:this.memorizedFormData}}has(e){return this.sfd.memorizedFormData.has(e)}get(e){return this.sfd.memorizedFormData.get(e)}transform(e,t){const r=this.getLatestFormData(e),n={};k.forEach((e=>{e in t.form_data&&(n[e]=t.form_data[e])}));const o=(0,D.R3)(t,{...r,...n,viz_type:e}),a={...R(o),standardizedFormData:this.serialize()};let s={formData:a,controlsState:o};const l=(0,i.Z)().get(e);if(null!=l&&l.formDataOverrides){(0,N.u)().setStandardizedControls(a);const e={...l.formDataOverrides(a),standardizedFormData:{controls:{...(0,N.u)().controls},memorizedFormData:this.memorizedFormData}};(0,N.u)().clear(),s={formData:e,controlsState:(0,D.R3)(t,e)}}return s.controlsState=(0,D.R3)({...t,controls:s.controlsState},s.formData),s}}},40219:(e,t,r)=>{"use strict";r.d(t,{BR:()=>s,LW:()=>u,nv:()=>d});var n=r(57557),o=r.n(n),a=r(31069);const i=["url_params"],s=e=>o()(e,i),l=(e,t)=>{let r="api/v1/explore/form_data";return e&&(r=r.concat(`/${e}`)),t&&(r=r.concat(`?tab_id=${t}`)),r},c=(e,t,r,n)=>{const o={datasource_id:e,datasource_type:t,form_data:JSON.stringify(s(r))};return n&&(o.chart_id=n),o},d=(e,t,r,n,o)=>a.Z.post({endpoint:l(void 0,o),jsonPayload:c(e,t,r,n)}).then((e=>e.json.key)),u=(e,t,r,n,o,i)=>a.Z.put({endpoint:l(r,i),jsonPayload:c(e,t,n,o)}).then((e=>e.json.message))},33228:(e,t,r)=>{"use strict";r.d(t,{IV:()=>o,dY:()=>a,iX:()=>i,mI:()=>s});var n=r(61988);const o=25,a=[{id:"changed_on_delta_humanized",desc:!0}],i=(0,n.t)('The passwords for the databases below are needed in order to import them together with the datasets. Please note that the "Secure Extra" and "Certificate" sections of the database configuration are not present in export files, and should be added manually after the import if they are needed.'),s=(0,n.t)("You are importing one or more datasets that already exist. Overwriting might cause you to lose some of your work. Are you sure you want to overwrite?")},39589:(e,t,r)=>{"use strict";var n,o;r.d(t,{Z:()=>o,g:()=>n}),function(e){e.Charts="CHARTS",e.Dashboards="DASHBOARDS",e.Recents="RECENTS",e.SavedQueries="SAVED_QUERIES"}(n||(n={})),function(e){e.GOOGLE_SHEETS="gsheets",e.DB_CONNECTION="dbconnection",e.DATASET_CREATION="datasetCreation"}(o||(o={}))},42190:(e,t,r)=>{"use strict";r.d(t,{l6:()=>s,ni:()=>n,s_:()=>c});var n,o=r(22102),a=r(67294);!function(e){e.LOADING="loading",e.COMPLETE="complete",e.ERROR="error"}(n||(n={}));const i={status:n.LOADING,result:null,error:null};function s(e,t){return(0,a.useMemo)((()=>{if(e.status!==n.COMPLETE)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:n.ERROR,result:null,error:e}}}),[e,t])}const l=e=>e.result;function c(e){return s(function(e){const[t,r]=(0,a.useState)(i),s=(0,a.useRef)((()=>{}));return(0,a.useEffect)((()=>{r(i),s.current();let t=!1;return s.current=()=>{t=!0},(0,o.Z)({method:"GET",endpoint:e})({}).then((e=>{t||r({status:n.COMPLETE,result:e,error:null})})).catch((e=>{t||r({status:n.ERROR,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}},10362:(e,t,r)=>{"use strict";r.d(t,{h:()=>l});var n=r(15926),o=r.n(n),a=r(98286),i=r(30848),s=r(31069);const l=(0,i.LC)({reducerPath:"queryApi",tagTypes:["Schemas","Tables","DatabaseFunctions","QueryValidations","TableMetadatas","SqlLabInitialState"],endpoints:()=>({}),baseQuery:(e,t)=>{let{endpoint:r,urlParams:n,transformResponse:i,method:l="GET",parseMethod:c="json",...d}=e;return s.Z.request({...d,endpoint:`${r}${n?`?q=${o().encode(n)}`:""}`,method:l,parseMethod:c,signal:t.signal}).then((e=>{var t;return{data:null!=(t=null==i?void 0:i(e))?t:e}})).catch((e=>(0,a.O$)(e).then((e=>({error:e})))))}})},69279:(e,t,r)=>{"use strict";r.d(t,{Kt:()=>l,Xx:()=>u});var n=r(67294),o=r(38325);const a=r(10362).h.injectEndpoints({endpoints:e=>({schemas:e.query({providesTags:[{type:"Schemas",id:"LIST"}],query:e=>{let{dbId:t,forceRefresh:r}=e;return{endpoint:`/api/v1/database/${t}/schemas/`,urlParams:{force:r},transformResponse:e=>{let{json:t}=e;return t.result.map((e=>({value:e,label:e,title:e})))}}},serializeQueryArgs:e=>{let{queryArgs:{dbId:t}}=e;return{dbId:t}}})})}),{useLazySchemasQuery:i,useSchemasQuery:s,endpoints:l,util:c}=a,d=[];function u(e){const t=(0,n.useRef)(!1),{dbId:r,onSuccess:a,onError:l}=e||{},[c]=i(),u=s({dbId:r,forceRefresh:!1},{skip:!r}),p=(0,o.Z)(((e,t)=>{null==a||a(e,t)})),h=(0,o.Z)((()=>{null==l||l()})),m=(0,n.useCallback)((()=>{r&&c({dbId:r,forceRefresh:!0}).then((e=>{let{isSuccess:t,isError:r,data:n}=e;t&&p(n||d,!0),r&&h()}))}),[r,h,p,c]);return(0,n.useEffect)((()=>{if(t.current){const{requestId:e,isSuccess:t,isError:r,isFetching:n,data:o,originalArgs:a}=u;null!=a&&a.forceRefresh||!e||n||(t&&p(o||d,!1),r&&h())}else t.current=!0}),[u,p,h]),{...u,refetch:m}}},23936:(e,t,r)=>{"use strict";r.d(t,{$K:()=>h,QD:()=>p,SJ:()=>u,uY:()=>d,zA:()=>m});var n=r(67294),o=r(38325),a=r(10362),i=r(69279);const s=a.h.injectEndpoints({endpoints:e=>({tables:e.query({providesTags:["Tables"],query:e=>{let{dbId:t,schema:r,forceRefresh:n}=e;return{endpoint:`/api/v1/database/${null!=t?t:"undefined"}/tables/`,urlParams:{force:n,schema_name:r?encodeURIComponent(r):""},transformResponse:e=>{let{json:t}=e;return{options:t.result,hasMore:t.count>t.result.length}}}},serializeQueryArgs:e=>{let{queryArgs:{dbId:t,schema:r}}=e;return{dbId:t,schema:r}}}),tableMetadata:e.query({query:e=>{let{dbId:t,schema:r,table:n}=e;return{endpoint:`/api/v1/database/${t}/table/${encodeURIComponent(n)}/${encodeURIComponent(r)}/`,transformResponse:e=>{let{json:t}=e;return t}}}}),tableExtendedMetadata:e.query({query:e=>{let{dbId:t,schema:r,table:n}=e;return{endpoint:`/api/v1/database/${t}/table_extra/${encodeURIComponent(n)}/${encodeURIComponent(r)}/`,transformResponse:e=>{let{json:t}=e;return t}}}})})}),{useLazyTablesQuery:l,useTablesQuery:c,useTableMetadataQuery:d,useTableExtendedMetadataQuery:u,endpoints:p,util:h}=s;function m(e){const t=(0,n.useRef)(!1),{data:r,isFetching:a}=(0,i.Xx)({dbId:e.dbId}),s=(0,n.useMemo)((()=>new Set(null==r?void 0:r.map((e=>{let{value:t}=e;return t})))),[r]),{dbId:d,schema:u,onSuccess:p,onError:h}=e||{},m=Boolean(d&&u&&!a&&s.has(u)),g=c({dbId:d,schema:u,forceRefresh:!1},{skip:!m}),[f]=l(),v=(0,o.Z)(((e,t)=>{null==p||p(e,t)})),_=(0,o.Z)((e=>{null==h||h(e)})),b=(0,n.useCallback)((()=>{m&&f({dbId:d,schema:u,forceRefresh:!0}).then((e=>{let{isSuccess:t,isError:r,data:n,error:o}=e;t&&n&&v(n,!0),r&&_(o)}))}),[d,u,m,v,_,f]);return(0,n.useEffect)((()=>{if(t.current){const{requestId:e,isSuccess:t,isError:r,isFetching:n,data:o,error:a,originalArgs:i}=g;null!=i&&i.forceRefresh||!e||n||(t&&o&&v(o,!1),r&&_(a))}else t.current=!0}),[g,v,_]),{...g,refetch:b}}},74004:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var n=r(67294),o=r(27600);function a(e,t){void 0===t&&(t=o.oP);const[r,a]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const r=setTimeout((()=>{a(e)}),t);return()=>{clearTimeout(r)}}),[e,t]),r}},38325:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(97654);function o(e){return(0,n.Z)(e)}},3741:(e,t,r)=>{"use strict";r.d(t,{$b:()=>s,BL:()=>w,Eh:()=>y,Ep:()=>d,Ev:()=>a,F8:()=>x,FY:()=>b,H3:()=>p,Im:()=>D,Iq:()=>l,Kr:()=>Z,P$:()=>T,PC:()=>g,Ph:()=>_,Qg:()=>v,S:()=>h,TA:()=>E,TD:()=>c,TG:()=>P,TY:()=>$,Tl:()=>I,W9:()=>n,Wl:()=>i,Yd:()=>F,ZX:()=>N,aD:()=>o,br:()=>f,g3:()=>M,kV:()=>S,n2:()=>R,oK:()=>m,qL:()=>k,t4:()=>O,vH:()=>u,xD:()=>U,xE:()=>A,yw:()=>C,zf:()=>L});const n="load_chart",o="render_chart",a="hide_browser_tab",i="mount_dashboard",s="mount_explorer",l="select_dashboard_tab",c="force_refresh_chart",d="change_explore_controls",u="toggle_edit_dashboard",p="force_refresh_dashboard",h="periodic_render_dashboard",m="explore_dashboard_chart",g="export_csv_dashboard_chart",f="export_xlsx_dashboard_chart",v="change_dashboard_filter",_="dataset_creation_empty_cancellation",b="dataset_creation_database_cancellation",y="dataset_creation_schema_cancellation",E="dataset_creation_table_cancellation",T="dataset_creation_success",S="spa_navigation",C="confirm_overwrite_dashboard_metadata",R="dashboard_download_as_image",Z="dashboard_download_as_pdf",A="chart_download_as_image",x="chart_download_as_csv",O="chart_download_as_csv_pivoted",w="chart_download_as_xls",I="chart_download_as_json",N="sqllab_warn_local_storage_usage",D="sqllab_fetch_failed_query",L="drill_by_modal_opened",M="further_drill_by",k="drill_by_edit_chart",P="drill_by_breadcrumb_clicked",U="sqllab_monitor_local_storage_usage",$=new Set([n,o,a,D]),F=(new Set([i,l,m,c,g,v,d,u,p,h,s,C,R,Z,A]),{timeOriginOffset:0,markTimeOrigin(){this.timeOriginOffset=window.performance.now()},getTimestamp(){return Math.round(window.performance.now()-this.timeOriginOffset)}})},97381:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LOG_EVENT:()=>n,logEvent:()=>o});const n="LOG_EVENT";function o(e,t){return r=>r({type:n,payload:{eventName:e,eventData:t}})}},77997:(e,t,r)=>{"use strict";r.d(t,{YJ:()=>b});var n=r(31069),o=r(55786),a=r(68492),i=r(22102),s=r(93185),l=r(20292),c=r(98286);const d="polling",u="last_async_event_id";let p,h,m,g,f,v,_;const b=async e=>new Promise(((t,r)=>{const i=e.job_id;var s;s=async e=>{switch(e.status){case"done":{let{data:a,status:i}=await(async e=>{let t,r="success";try{const{json:r}=await n.Z.get({endpoint:String(e.result_url)});t="result"in r?r.result:r}catch(e){r="error",t=await(0,c.O$)(e)}return{status:r,data:t}})(e);a=(0,o.Z)(a),"success"===i?t(a):r(a);break}case"error":{const t=(0,c.MV)(e);r(t);break}default:a.Z.warn("received event with status",e.status)}var s;f[s=i]&&delete f[s]},f[i]=s})),y=(0,i.Z)({method:"GET",endpoint:"/api/v1/async_event/"}),E=async e=>{e.forEach((e=>{const t=e.job_id,r=f[t];r?(r(e),delete v[t]):(v[t]||(v[t]=0),v[t]+=1,v[t]<=6?setTimeout((()=>{E([e])}),100*v[t]):(delete v[t],a.Z.warn("listener not found for job_id",e.job_id))),(e=>{_=e.id;try{localStorage.setItem(u,_)}catch(e){a.Z.warn("Error saving event Id to localStorage",e)}})(e)}))},T=async()=>{const e=_?{last_id:_}:{};if(Object.keys(f).length)try{const{result:t}=await y(e);null!=t&&t.length&&await E(t)}catch(e){a.Z.warn(e)}h===d&&(g=window.setTimeout(T,m))};let S,C,R=0;const Z=()=>{let e=p.GLOBAL_ASYNC_QUERIES_WEBSOCKET_URL;_&&(e+=`?last_id=${_}`),C=new WebSocket(e),C.addEventListener("open",(()=>{a.Z.log("WebSocket connected"),clearTimeout(S),R=0})),C.addEventListener("close",(()=>{S=setTimeout((()=>{R+=1,R<=6?Z():(a.Z.warn("WebSocket not available, falling back to async polling"),T())}),2500)})),C.addEventListener("error",(()=>{C.readyState<2&&C.close()})),C.addEventListener("message",(async e=>{let t=[];try{t=[JSON.parse(e.data)],await E(t)}catch(e){a.Z.warn(e)}}))};(e=>{if((0,s.cr)(s.TT.GLOBAL_ASYNC_QUERIES)){g&&clearTimeout(g),f={},v={},_=null,p=(0,l.Z)().common.conf,h=p.GLOBAL_ASYNC_QUERIES_TRANSPORT||d,m=p.GLOBAL_ASYNC_QUERIES_POLLING_DELAY||500;try{_=localStorage.getItem(u)}catch(e){a.Z.warn("Failed to fetch last event Id from localStorage")}h===d&&T(),"ws"===h&&Z()}})()},99543:(e,t,r)=>{"use strict";r.d(t,{JB:()=>R,SJ:()=>_,_0:()=>S,gP:()=>E,gf:()=>y,p1:()=>T,wK:()=>b,zd:()=>C});var n=r(28368),o=r.n(n),a=r(45220),i=r.n(a),s=r(52353),l=r.n(s),c=r(57557),d=r.n(c),u=r(14176),p=r.n(u),h=r(18446),m=r.n(h),g=r(14670),f=r.n(g),v=(r(64417),r(55786));function _(e,t,r){const n={...e[t]},o={...r};return o.id||(o.id=f().generate()),n[o.id]=o,{...e,[t]:n}}function b(e,t,r,n){const o={...e[t]};return o[r.id]={...o[r.id],...n},{...e,[t]:o}}function y(e,t,r,n,o){void 0===o&&(o="id");const a=[];return e[t].forEach((e=>{r[o]===e[o]?a.push({...e,...n}):a.push(e)})),{...e,[t]:a}}function E(e,t,r,n){void 0===n&&(n="id");const o=[];return e[t].forEach((e=>{r[n]!==e[n]&&o.push(e)})),{...e,[t]:o}}function T(e,t){let r;return e.forEach((e=>{e.id===t&&(r=e)})),r}function S(e,t,r,n){void 0===n&&(n=!1);const o={...r};o.id||(o.id=f().generate());const a={};return a[t]=n?[o,...e[t]]:[...e[t],o],{...e,...a}}function C(e,t,r,n){void 0===n&&(n=!1);const o=[...r];o.forEach((e=>{e.id||(e.id=f().generate())}));const a={};return a[t]=n?[...o,...e[t]]:[...e[t],...o],{...e,...a}}function R(e,t,r){var n;void 0===r&&(r={ignoreUndefined:!1,ignoreNull:!1,ignoreFields:[]});let a=e,s=t;if(r.ignoreUndefined&&(a=p()(a,l()),s=p()(s,l())),r.ignoreNull&&(a=p()(a,i()),s=p()(s,i())),null!=(n=r.ignoreFields)&&n.length){const e=(0,v.Z)(r.ignoreFields);return o()(a,s,((t,r)=>m()((0,v.Z)(t).map((t=>d()(t,e))),(0,v.Z)(r).map((t=>d()(t,e))))))}return m()(a,s)}},10222:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(54076);const o=e=>(async e=>{if((0,n.G6)())try{const t=new ClipboardItem({"text/plain":e()});await navigator.clipboard.write([t])}catch{const t=await e();await navigator.clipboard.writeText(t)}else{const t=await e();await navigator.clipboard.writeText(t)}})(e).catch((()=>e().then((e=>new Promise(((t,r)=>{const n=document.getSelection();if(n){n.removeAllRanges();const t=document.createRange(),o=document.createElement("span");o.textContent=e,o.style.position="fixed",o.style.top="0",o.style.clip="rect(0, 0, 0, 0)",o.style.whiteSpace="pre",document.body.appendChild(o),t.selectNode(o),n.addRange(t);try{document.execCommand("copy")||r()}catch(e){r()}document.body.removeChild(o),n.removeRange?n.removeRange(t):n.removeAllRanges()}t()}))))))},66785:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={SESSION_TIMED_OUT:"Your session timed out, please refresh your page and try again."}},12617:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});const n=(0,r(30845).Z)(((e,t,r)=>!!r&&Object.values(r).some((r=>r.some((r=>{let[n,o]=r;return n===e&&o===t}))))))},98286:(e,t,r)=>{"use strict";r.d(t,{HR:()=>s,MV:()=>i,O$:()=>l,d7:()=>c});var n=r(61988),o=r(67663),a=r(66785);function i(e){let t={...e};var r,o,i;(t.errors&&t.errors.length>0&&(t.error=t.description=t.errors[0].message,t.link=null==(r=t.errors[0])||null==(o=r.extra)?void 0:o.link),!t.error&&t.message)&&("object"==typeof t.message&&(t.error=(null==(i=Object.values(t.message)[0])?void 0:i[0])||(0,n.t)("Invalid input")),"string"==typeof t.message&&(t.error=t.message));return t.stack?t={...t,error:(0,n.t)("Unexpected error: ")+(t.description||(0,n.t)("(no description, click to see stack trace)")),stacktrace:t.stack}:t.responseText&&t.responseText.indexOf("CSRF")>=0&&(t={...t,error:(0,n.t)(a.Z.SESSION_TIMED_OUT)}),{...t,error:t.error}}async function s(e,t){const{error:r,message:o}=await l(e);let a=(0,n.t)("Sorry, an unknown error occurred.");return r&&(a=(0,n.t)("Sorry, there was an error saving this %s: %s",t,r)),"string"==typeof o&&"Forbidden"===o&&(a=(0,n.t)("You do not have permission to edit this %s",t)),a}function l(e){return new Promise((t=>{if("string"==typeof e)return void t({error:e});if(e instanceof TypeError&&"Failed to fetch"===e.message)return void t({error:(0,n.t)("Network error")});if("timeout"in e&&"statusText"in e&&"timeout"===e.statusText)return void t({...e,error:(0,n.t)("Request timed out"),errors:[{error_type:o.C.FRONTEND_TIMEOUT_ERROR,extra:{timeout:e.timeout/1e3,issue_codes:[{code:1e3,message:(0,n.t)("Issue 1000 - The dataset is too large to query.")},{code:1001,message:(0,n.t)("Issue 1001 - The database is under an unusual load.")}]},level:"error",message:"Request timed out"}]});const r=e instanceof Response?e:e.response;if(r&&!r.bodyUsed)return void r.clone().json().then((e=>{const n={...r,...e};t(i(n))})).catch((()=>{r.text().then((e=>{t({...r,error:e})}))}));let a=e.statusText||e.message;a||(console.error("non-standard error:",e),a=(0,n.t)("An error occurred")),t({...r,error:a})}))}function c(e,t){let r=e;const n=(null==t?void 0:t.message)||(null==t?void 0:t.error);return n&&(r=`${r}:\n${n}`),r}},42313:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=e=>{var t,r;return null!=(t=e.uid)?t:`${null!=(r=e.id)?r:"None"}__${e.type}`}},71894:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});const n=()=>{var e,t;return null==(e=window)||null==(t=e.navigator)?void 0:t.webdriver}},61337:(e,t,r)=>{"use strict";var n;function o(e,t){try{const r=localStorage.getItem(e);return null===r?t:JSON.parse(r)}catch{return t}}function a(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function i(e,t){return o(e,t)}function s(e,t){a(e,t)}r.d(t,{I_:()=>a,LS:()=>s,OH:()=>o,dR:()=>n,rV:()=>i}),function(e){e.filter_box_transition_snoozed_at="filter_box_transition_snoozed_at",e.db="db",e.chart_split_sizes="chart_split_sizes",e.controls_width="controls_width",e.datasource_width="datasource_width",e.is_datapanel_open="is_datapanel_open",e.homepage_chart_filter="homepage_chart_filter",e.homepage_dashboard_filter="homepage_dashboard_filter",e.homepage_collapse_state="homepage_collapse_state",e.homepage_activity_filter="homepage_activity_filter",e.datasetname_set_successful="datasetname_set_successful",e.sqllab__is_autocomplete_enabled="sqllab__is_autocomplete_enabled",e.explore__data_table_original_formatted_time_columns="explore__data_table_original_formatted_time_columns",e.dashboard__custom_filter_bar_widths="dashboard__custom_filter_bar_widths",e.dashboard__explore_context="dashboard__explore_context",e.dashboard__editor_show_only_my_charts="dashboard__editor_show_only_my_charts",e.common__resizable_sidebar_widths="common__resizable_sidebar_widths"}(n||(n={}))},9679:(e,t,r)=>{"use strict";function n(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if("object"==typeof r&&null!==r){if(t.has(r))try{return JSON.parse(JSON.stringify(r))}catch(e){return}t.add(r)}return r}))}r.d(t,{o:()=>n})},8911:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(()=>{try{return r(74082)||{}}catch(e){return{}}})()},23525:(e,t,r)=>{"use strict";r.d(t,{Nm:()=>b,TO:()=>E,YE:()=>_,eY:()=>p,en:()=>T});var n=r(41609),o=r.n(n),a=r(31069),i=r(37731),s=r(15926),l=r.n(s),c=r(27600),d=r(43399),u=r(11370);function p(e){let{name:t,type:r}=e;const n=new URLSearchParams(window.location.search).get(t);switch(r){case"number":return n?"true"===n.toLowerCase()?1:"false"===n.toLowerCase()?0:Number.isNaN(Number(n))?null:Number(n):null;case"object":return n?JSON.parse(n):null;case"boolean":return n?"false"!==n.toLowerCase()&&"0"!==n:null;case"rison":if(!n)return null;try{return l().decode(n)}catch{return n}default:return n}}function h(e){const t=new URLSearchParams;return new URLSearchParams(window.location.search).forEach(((r,n)=>{e.includes(n)||t.append(n,r)})),t}function m(e){const t=[];return e.forEach(((e,r)=>t.push([r,e]))),t}function g(e){const t=e||c.$O,r=h(t),n=(0,d.De)();return o()(n)||t.includes(c.KD.preselectFilters.name)||r.append(c.KD.preselectFilters.name,JSON.stringify((0,u.Z)((0,d.De)()))),m(r)}function f(){const e=h(c.Rv),t=(0,d.De)();return o()(t)||e.append(c.KD.preselectFilters.name,JSON.stringify((0,u.Z)((0,d.De)()))),m(e)}function v(e,t){return a.Z.post({endpoint:e,jsonPayload:t}).then((e=>e.json.url))}function _(e,t){return v("/api/v1/explore/permalink",{formData:e,urlParams:g(t)})}function b(e){let{dashboardId:t,dataMask:r,activeTabs:n,anchor:o}=e;return v(`/api/v1/dashboard/${t}/permalink`,{urlParams:f(),dataMask:r,activeTabs:n,anchor:o})}const y=/^([^:/?#]+:)?(?:(\/\/)?([^/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/;function E(e){const t=e.match(y)||[];return"string"==typeof t[1]&&t[1].length>0||"//"===t[2]||"string"==typeof t[3]&&t[3].length>0}function T(e){const t=e.match(y)||[];return!E(e)||(0,i.Z)(t[1])||e.startsWith("//")?e:`//${e}`}},34858:(e,t,r)=>{"use strict";r.d(t,{LE:()=>g,NE:()=>_,PW:()=>f,Yi:()=>m,_l:()=>x,bR:()=>y,cb:()=>R,fF:()=>b,h1:()=>A,jb:()=>T,rM:()=>E,xx:()=>C,z:()=>S});var n=r(15926),o=r.n(n),a=r(67294),i=r(31069),s=r(61988),l=r(22102),c=r(40768),d=r(10222),u=r(98286),p=r(8911);const h=e=>"string"==typeof e?e:Object.entries(e).map((e=>{let[t,r]=e;return Array.isArray(r)?`(${t}) ${r.join(", ")}`:`(${t}) ${r}`})).join("\n");function m(e,t,r,n,l,d,u){void 0===n&&(n=!0),void 0===l&&(l=[]),void 0===u&&(u=!0);const[p,h]=(0,a.useState)({count:0,collection:l,loading:u,lastFetchDataConfig:null,permissions:[],bulkSelectEnabled:!1});function m(e){h((t=>({...t,...e})))}(0,a.useEffect)((()=>{n&&i.Z.get({endpoint:`/api/v1/${e}/_info?q=${o().encode({keys:["permissions"]})}`}).then((e=>{let{json:t={}}=e;m({permissions:t.permissions})}),(0,c.v$)((e=>r((0,s.t)("An error occurred while fetching %s info: %s",t,e)))))}),[]);const g=(0,a.useCallback)((n=>{let{pageIndex:a,pageSize:l,sortBy:u,filters:p}=n;m({lastFetchDataConfig:{filters:p,pageIndex:a,pageSize:l,sortBy:u},loading:!0});const h=(d||[]).concat(p).map((e=>{let{id:t,operator:r,value:n}=e;return{col:t,opr:r,value:n&&"object"==typeof n&&"value"in n?n.value:n}})),g=o().encode_uri({order_column:u[0].id,order_direction:u[0].desc?"desc":"asc",page:a,page_size:l,...h.length?{filters:h}:{}});return i.Z.get({endpoint:`/api/v1/${e}/?q=${g}`}).then((e=>{let{json:t={}}=e;m({collection:t.result,count:t.count,lastFetched:(new Date).toISOString()})}),(0,c.v$)((e=>r((0,s.t)("An error occurred while fetching %ss: %s",t,e))))).finally((()=>{m({loading:!1})}))}),[d]);return{state:{loading:p.loading,resourceCount:p.count,resourceCollection:p.collection,bulkSelectEnabled:p.bulkSelectEnabled,lastFetched:p.lastFetched},setResourceCollection:e=>m({collection:e}),hasPerm:function(e){return!!p.permissions.length&&Boolean(p.permissions.find((t=>t===e)))},fetchData:g,toggleBulkSelect:function(){m({bulkSelectEnabled:!p.bulkSelectEnabled})},refreshData:e=>p.lastFetchDataConfig?g(p.lastFetchDataConfig):e?g(e):null}}function g(e,t,r,n){void 0===n&&(n="");const[o,l]=(0,a.useState)({loading:!1,resource:null,error:null});function d(e){l((t=>({...t,...e})))}return{state:o,setResource:e=>d({resource:e}),fetchResource:(0,a.useCallback)((o=>{d({loading:!0});const a=`/api/v1/${e}/${o}`,l=""!==n?`${a}/${n}`:a;return i.Z.get({endpoint:l}).then((e=>{let{json:t={}}=e;return d({resource:t.result,error:null}),t.result}),(0,c.v$)((e=>{r((0,s.t)("An error occurred while fetching %ss: %s",t,h(e))),d({error:e})}))).finally((()=>{d({loading:!1})}))}),[r,e,t]),createResource:(0,a.useCallback)((function(n,o){return void 0===o&&(o=!1),d({loading:!0}),i.Z.post({endpoint:`/api/v1/${e}/`,body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((e=>{let{json:t={}}=e;return d({resource:{id:t.id,...t.result},error:null}),t.id}),(0,c.v$)((e=>{o||r((0,s.t)("An error occurred while creating %ss: %s",t,h(e))),d({error:e})}))).finally((()=>{d({loading:!1})}))}),[r,e,t]),updateResource:(0,a.useCallback)((function(n,o,a,l){return void 0===a&&(a=!1),void 0===l&&(l=!0),l&&d({loading:!0}),i.Z.put({endpoint:`/api/v1/${e}/${n}`,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).then((e=>{let{json:t={}}=e;return d({resource:{...t.result,id:t.id},error:null}),t.result}),(0,c.v$)((e=>(a||r((0,s.t)("An error occurred while fetching %ss: %s",t,JSON.stringify(e))),d({error:e}),e)))).finally((()=>{l&&d({loading:!1})}))}),[r,e,t]),clearError:()=>d({error:null})}}function f(e,t,r){const[n,o]=(0,a.useState)({loading:!1,passwordsNeeded:[],alreadyExists:[],sshPasswordNeeded:[],sshPrivateKeyNeeded:[],sshPrivateKeyPasswordNeeded:[],failed:!1});function l(e){o((t=>({...t,...e})))}return{state:n,importResource:(0,a.useCallback)((function(n,o,a,d,p,h){void 0===o&&(o={}),void 0===a&&(a={}),void 0===d&&(d={}),void 0===p&&(p={}),void 0===h&&(h=!1),l({loading:!0,failed:!1});const m=new FormData;m.append("formData",n);const g=(0,s.t)("Please re-export your file and try importing again");return o&&m.append("passwords",JSON.stringify(o)),h&&m.append("overwrite","true"),a&&m.append("ssh_tunnel_passwords",JSON.stringify(a)),d&&m.append("ssh_tunnel_private_keys",JSON.stringify(d)),p&&m.append("ssh_tunnel_private_key_passwords",JSON.stringify(p)),i.Z.post({endpoint:`/api/v1/${e}/import/`,body:m,headers:{Accept:"application/json"}}).then((()=>(l({passwordsNeeded:[],alreadyExists:[],sshPasswordNeeded:[],sshPrivateKeyNeeded:[],sshPrivateKeyPasswordNeeded:[],failed:!1}),!0))).catch((e=>(0,u.O$)(e).then((e=>(l({failed:!0}),e.errors?((0,c.Er)(e.errors)?r((0,s.t)("An error occurred while importing %s: %s",t,[...e.errors.map((e=>e.message)),g].join(".\n"))):l({passwordsNeeded:(0,c.$u)(e.errors),sshPasswordNeeded:(0,c.dK)(e.errors),sshPrivateKeyNeeded:(0,c.ru)(e.errors),sshPrivateKeyPasswordNeeded:(0,c.z9)(e.errors),alreadyExists:(0,c.cE)(e.errors)}),!1):(r((0,s.t)("An error occurred while importing %s: %s",t,e.message||e.error)),!1)))))).finally((()=>{l({loading:!1})}))}),[])}}const v={chart:(0,l.Z)({requestType:"rison",method:"GET",endpoint:"/api/v1/chart/favorite_status/"}),dashboard:(0,l.Z)({requestType:"rison",method:"GET",endpoint:"/api/v1/dashboard/favorite_status/"}),tag:(0,l.Z)({requestType:"rison",method:"GET",endpoint:"/api/v1/tag/favorite_status/"})};function _(e,t,r){const[n,o]=(0,a.useState)({}),l=e=>o((t=>({...t,...e})));return(0,a.useEffect)((()=>{t.length&&v[e](t).then((e=>{let{result:t}=e;const r=t.reduce(((e,t)=>(e[t.id]=t.value,e)),{});l(r)}),(0,c.v$)((e=>r((0,s.t)("There was an error fetching the favorite status: %s",e)))))}),[t,e,r]),[(0,a.useCallback)(((t,n)=>{const o=`/api/v1/${e}/${t}/favorites/`;(n?i.Z.delete({endpoint:o}):i.Z.post({endpoint:o})).then((()=>{l({[t]:!n})}),(0,c.v$)((e=>r((0,s.t)("There was an error saving the favorite status: %s",e)))))}),[e]),n]}const b=(e,t)=>{const[r,n]=(0,a.useState)(null);return{sliceCurrentlyEditing:r,handleChartUpdated:function(r){const n=t.map((e=>e.id===r.id?{...e,...r}:e));e(n)},openChartEditModal:function(e){n({slice_id:e.id,slice_name:e.slice_name,description:e.description,cache_timeout:e.cache_timeout,certified_by:e.certified_by,certification_details:e.certification_details,is_managed_externally:e.is_managed_externally})},closeChartEditModal:function(){n(null)}}},y=(e,t,r)=>{(0,d.Z)((()=>Promise.resolve(`${window.location.origin}/sqllab?savedQueryId=${e}`))).then((()=>{r((0,s.t)("Link Copied!"))})).catch((()=>{t((0,s.t)("Sorry, your browser does not support copying."))}))},E=()=>p.Z.DB_IMAGES,T=()=>p.Z.DB_CONNECTION_ALERTS,S=()=>p.Z.DB_CONNECTION_DOC_LINKS,C=(e,t,r)=>{i.Z.post({endpoint:"api/v1/database/test_connection/",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((()=>{r((0,s.t)("Connection looks good!"))}),(0,c.v$)((e=>{t((0,s.t)("ERROR: %s",h(e)))})))};function R(){const[e,t]=(0,a.useState)(null);return[e,(0,a.useCallback)((()=>{i.Z.get({endpoint:"/api/v1/database/available/"}).then((e=>{let{json:r}=e;t(r)}))}),[t])]}const Z=e=>e&&Array.isArray(null==e?void 0:e.catalog)?{...e,catalog:Object.assign({},...e.catalog.map((e=>({[e.name]:e.value}))))}:e;function A(){const[e,t]=(0,a.useState)(null);return[e,(0,a.useCallback)((function(e,r){var n;return void 0===r&&(r=!1),null!=e&&null!=(n=e.parameters)&&n.ssh?(t(null),[]):i.Z.post({endpoint:"/api/v1/database/validate_parameters/",body:JSON.stringify(Z(e)),headers:{"Content-Type":"application/json"}}).then((()=>{t(null)})).catch((e=>{if("function"==typeof e.json)return e.json().then((e=>{let{errors:n=[]}=e;const o=n.filter((e=>!["CONNECTION_MISSING_PARAMETERS_ERROR","CONNECTION_ACCESS_DENIED_ERROR"].includes(e.error_type)||r)).reduce(((e,t)=>{var r;let{error_type:n,extra:o,message:a}=t;return o.catalog?o.catalog.name?{...e,error_type:n,[o.catalog.idx]:{name:a}}:o.catalog.url?{...e,error_type:n,[o.catalog.idx]:{url:a}}:{...e,error_type:n,[o.catalog.idx]:{name:a,url:a}}:o.invalid?{...e,[o.invalid[0]]:a,error_type:n}:o.missing?{...e,error_type:n,...Object.assign({},...o.missing.map((e=>({[e]:"This is a required field"}))))}:null!=(r=o.issue_codes)&&r.length?{...e,error_type:n,description:a||(null==(i=o.issue_codes[0])?void 0:i.message)}:e;var i}),{});return t(o),o}));console.error(e)}))}),[t]),t]}const x=(e,t,r)=>{var n;return r?null==(n=e.reports[t])?void 0:n[r]:null}},12:(e,t,r)=>{"use strict";var n,o;r.d(t,{F:()=>n,J:()=>o}),function(e){e.Favorite="Favorite",e.Mine="Mine",e.Other="Other",e.Viewed="Viewed",e.Created="Created",e.Edited="Edited"}(n||(n={})),function(e){e.id="id",e.changed_on="changed_on",e.changed_by="changed_by",e.database="database",e.database_name="database.database_name",e.schema="schema",e.sql="sql",e.executed_sql="executed_sql",e.sql_tables="sql_tables",e.status="status",e.tab_name="tab_name",e.user="user",e.user_first_name="user.first_name",e.start_time="start_time",e.end_time="end_time",e.rows="rows",e.tmp_table_name="tmp_table_name",e.tracking_url="tracking_url"}(o||(o={}))},40768:(e,t,r)=>{"use strict";r.d(t,{$u:()=>F,B1:()=>T,Er:()=>j,Gm:()=>A,IB:()=>O,IV:()=>b,Iu:()=>x,Ld:()=>E,Mc:()=>Q,ZB:()=>D,_L:()=>N,cE:()=>H,dK:()=>q,eX:()=>v,if:()=>G,iv:()=>w,mq:()=>I,ru:()=>V,tm:()=>C,v$:()=>Z,wk:()=>R,xF:()=>S,xL:()=>L,z9:()=>B});var n=r(25325),o=r.n(n),a=r(51995),i=r(31069),s=r(61988),l=r(68492),c=r(11965),d=r(15926),u=r.n(d),p=r(98286),h=r(8911),m=r(12617),g=r(39589),f=r(12);(()=>{const e=u(),t=[];for(let e=0;e<16;e+=1)for(let r=0;r<16;r+=1){if(e+r===0)continue;const n=String.fromCharCode(16*e+r);/\w|[-_./~]/.test(n)||t.push(`\\u00${e.toString(16)}${r.toString(16)}`)}e.not_idchar=t.join(""),e.not_idstart="-0123456789";const r=`[^${e.not_idstart}${e.not_idchar}][^${e.not_idchar}]*`;e.id_ok=new RegExp(`^${r}$`),e.next_id=new RegExp(r,"g")})();const v=a.iK.div`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
`,_=e=>(t,r,n,o)=>async function(n,a,s){var l;void 0===n&&(n="");const c=`/api/v1/${t}/${e}/${r}`,d=u().encode_uri({filter:n,page:a,page_size:s}),{json:p={}}=await i.Z.get({endpoint:`${c}?q=${d}`});let h=!1;const m=o?{label:`${o.firstName} ${o.lastName}`,value:o.userId}:void 0,g=[];return null==p||null==(l=p.result)||l.filter((e=>{let{text:t}=e;return t.trim().length>0})).forEach((e=>{let{text:t,value:r}=e;m&&r===m.value&&t===m.label?h=!0:g.push({label:t,value:r})})),!m||n&&!h||g.unshift(m),{data:g,totalCount:null==p?void 0:p.count}},b=5,y=e=>{const t={order_column:"changed_on_delta_humanized",order_direction:"desc",page:0,page_size:b,filters:e};return e||delete t.filters,u().encode(t)},E=e=>{const t={edited:[{col:"changed_by",opr:"rel_o_m",value:`${e}`}]},r=[i.Z.get({endpoint:`/api/v1/dashboard/?q=${y(t.edited)}`}),i.Z.get({endpoint:`/api/v1/chart/?q=${y(t.edited)}`})];return Promise.all(r).then((e=>{var t,r;let[n,o]=e;return{editedDash:null==(t=o.json)?void 0:t.result.slice(0,3),editedChart:null==(r=n.json)?void 0:r.result.slice(0,3)}})).catch((e=>e))},T=function(e,t,r){return void 0===r&&(r=[{col:"owners",opr:"rel_m_m",value:`${e}`}]),i.Z.get({endpoint:`/api/v1/${t}/?q=${y(r)}`}).then((e=>{var t;return null==(t=e.json)?void 0:t.result}))},S=(e,t,r,n)=>i.Z.get({endpoint:t}).then((e=>{const t={},o=[i.Z.get({endpoint:`/api/v1/chart/?q=${y(n)}`}),i.Z.get({endpoint:`/api/v1/dashboard/?q=${y(n)}`})];return Promise.all(o).then((r=>{let[n,o]=r;return t.other=[...n.json.result,...o.json.result],t.viewed=e.json.result,t})).catch((e=>r((0,s.t)("There was an error fetching your recent activity:"),e)))})),C=_("related"),R=_("distinct");function Z(e){return async t=>{const r=await(0,p.O$)(t),n=null==r?void 0:r.errors,o=await h.Z;null!=n&&n.length&&null!=o&&o.ERRORS&&n[0].error_type in o.ERRORS&&(r.message=o.ERRORS[n[0].error_type]),l.Z.error(t),e(r.message||r.error)}}function A(e,t,r,n,o,a){let{id:l,slice_name:c}=e;const d={pageIndex:0,pageSize:b,sortBy:[{id:"changed_on_delta_humanized",desc:!0}],filters:[{id:"created_by",operator:"rel_o_m",value:`${a}`}]};i.Z.delete({endpoint:`/api/v1/chart/${l}`}).then((()=>{"Mine"===o?n(d):n(),t((0,s.t)("Deleted: %s",c))}),(()=>{r((0,s.t)("There was an issue deleting: %s",c))}))}function x(e,t,r,n,o,a){let{id:l,dashboard_title:c}=e;return i.Z.delete({endpoint:`/api/v1/dashboard/${l}`}).then((()=>{"Mine"===o?t({pageIndex:0,pageSize:b,sortBy:[{id:"changed_on_delta_humanized",desc:!0}],filters:[{id:"owners",operator:"rel_m_m",value:`${a}`}]}):t(),r((0,s.t)("Deleted: %s",c))}),Z((e=>n((0,s.t)("There was an issue deleting %s: %s",c,e)))))}function O(e,t){let r=e.split("\n");return r.length>=t&&(r=r.slice(0,t),r.push("...")),r.join("\n")}const w=5,I=[576,768,992,1200].map((e=>`@media (max-width: ${e}px)`)),N=a.iK.div`
  ${e=>{let{showThumbnails:t,theme:r}=e;return`\n    overflow: hidden;\n    display: grid;\n    grid-gap: ${12*r.gridUnit}px ${4*r.gridUnit}px;\n    grid-template-columns: repeat(auto-fit, 300px);\n    max-height: ${t?"314":"148"}px;\n    margin-top: ${-6*r.gridUnit}px;\n    padding: ${t?`${8*r.gridUnit+3}px ${9*r.gridUnit}px`:`${8*r.gridUnit+1}px ${9*r.gridUnit}px`};\n  `}}
`,D=a.iK.div`
  cursor: pointer;
  a {
    text-decoration: none;
  }
  .ant-card-cover > div {
    /* Height is calculated based on 300px width, to keep the same aspect ratio as the 800*450 thumbnails */
    height: 168px;
  }
`,L=e=>c.iv`
  margin: auto ${2*e.gridUnit}px auto 0;
  color: ${e.colors.grayscale.base};
`,M=e=>{var t;return"object"==typeof e&&Array.isArray(e._schema)&&!(null==(t=e._schema)||!t.find((e=>"Must provide a password for the database"===e)))},k=e=>{var t;return"object"==typeof e&&Array.isArray(e._schema)&&!(null==(t=e._schema)||!t.find((e=>"Must provide a password for the ssh tunnel"===e)))},P=e=>{var t;return"object"==typeof e&&Array.isArray(e._schema)&&!(null==(t=e._schema)||!t.find((e=>"Must provide a private key for the ssh tunnel"===e)))},U=e=>{var t;return"object"==typeof e&&Array.isArray(e._schema)&&!(null==(t=e._schema)||!t.find((e=>"Must provide a private key password for the ssh tunnel"===e)))},$=e=>"string"==typeof e&&e.includes("already exists and `overwrite=true` was not passed"),F=e=>e.map((e=>Object.entries(e.extra).filter((e=>{let[,t]=e;return M(t)})).map((e=>{let[t]=e;return t})))).flat(),q=e=>e.map((e=>Object.entries(e.extra).filter((e=>{let[,t]=e;return k(t)})).map((e=>{let[t]=e;return t})))).flat(),V=e=>e.map((e=>Object.entries(e.extra).filter((e=>{let[,t]=e;return P(t)})).map((e=>{let[t]=e;return t})))).flat(),B=e=>e.map((e=>Object.entries(e.extra).filter((e=>{let[,t]=e;return U(t)})).map((e=>{let[t]=e;return t})))).flat(),H=e=>e.map((e=>Object.entries(e.extra).filter((e=>{let[,t]=e;return $(t)})).map((e=>{let[t]=e;return t})))).flat(),j=e=>e.some((e=>{const t=Object.entries(e.extra).filter((e=>{let[t]=e;return"issue_codes"!==t}));return 0===t.length||!t.every((e=>{let[,t]=e;return M(t)||$(t)||k(t)||P(t)||U(t)}))})),z=(e,t)=>void 0!==e&&o()(e,t).length>0,Q=(e,t,r,n,o)=>{const a=(0,m.R)("can_this_form_get","CsvToDatabaseView",e)&&z(t,o),i=z(r,o)&&(0,m.R)("can_this_form_get","ColumnarToDatabaseView",e),s=z(n,o)&&(0,m.R)("can_this_form_get","ExcelToDatabaseView",e);return{canUploadCSV:a,canUploadColumnar:i,canUploadExcel:s,canUploadData:a||i||s}};function G(e,t,r,n){return e===f.F.Created||t===g.g.SavedQueries&&e===f.F.Mine?[{id:"created_by",operator:"rel_o_m",value:`${null==r?void 0:r.userId}`}]:t===g.g.SavedQueries&&e===f.F.Favorite?[{id:"id",operator:"saved_query_is_fav",value:!0}]:e===f.F.Mine&&r?[{id:"owners",operator:"rel_m_m",value:`${r.userId}`}]:e===f.F.Favorite&&[g.g.Dashboards,g.g.Charts].includes(t)?[{id:"id",operator:t===g.g.Dashboards?"dashboard_is_favorite":"chart_is_favorite",value:!0}]:e===f.F.Other?(n||[]).map((e=>({id:e.col,operator:e.opr,value:e.value}))):[]}},60835:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>Se,zn:()=>Ze,h:()=>Ae});var n=r(29829),o=r(53894),a=r(10362),i=r(72570),s=r(37863),l=r(8868),c=r(57557),d=r.n(c),u=r(39666),p=r(41295),h=r(4305),m=r(9467),g=r(39023),f=r(39759),v=r(24350),_=r.n(v),b=r(50810),y=r(37927),E=r(21090),T=r(80621),S=r(12885),C=r(81255);function R(e){return[C.BA,C.dW,C.xh,C.t].indexOf(e.type)>-1}var Z=r(95173),A=r(47456),x=r(37418),O=r(28428);const w={[C.BG]:{[C.dW]:!0,[C.BA]:!0,[C.xh]:!0},[C.gn]:{[C.dW]:!0,[C.BA]:!0,[C.xh]:!0}};function I(e){let{parentType:t,childType:r}=e;if(!t||!r)return!1;const n=w[t];return!!n&&Boolean(n[r])}function N(e){let{dropResult:t,layout:r}=e;const{dragging:n,destination:o}=t,a=n.type,i=r[o.id],s=i.type;let l=(0,O.Z)(a,n.meta);l.parents=(i.parents||[]).concat(i.id),R(n)&&(l.meta.width=(0,A.Z)({dropResult:t,layout:r})||void 0);const c=I({parentType:s,childType:a}),d={[l.id]:l};if(c){const e=(0,O.Z)(C.Os);e.children=[l.id],e.parents=(i.parents||[]).concat(i.id),d[e.id]=e,l.parents=e.parents.concat(e.id),l=e}else if(a===C.yR){const e=(0,O.Z)(C.gn);e.parents=(i.parents||[]).concat(i.id),l.children=[e.id],d[e.id]=e}const u=[...i.children];return u.splice(o.index,0,l.id),d[o.id]={...i,children:u},d}function D(e,t,r){const n=null==r?void 0:r[e];if(n){delete r[e];const{children:o=[]}=n;null==o||null==o.forEach||o.forEach((t=>{D(t,e,r)}));const a=null==r?void 0:r[t];if(Array.isArray(null==a?void 0:a.children)){const n=a.children.indexOf(e);if(n>-1){const e=[...a.children];e.splice(n,1),r[t]={...a,children:e}}}}}const L={[h.$]:(e,t)=>({...t.data.dashboardLayout.present}),[S.nj](e,t){const{payload:{nextComponents:r}}=t;return{...e,...r}},[S.CB](e,t){var r;const{payload:{id:n,parentId:o}}=t;if(!(o&&n&&e[n]&&e[o]))return e;const a={...e};D(n,o,a);const i=a[o];return(null==i?void 0:i.type)===C.Os&&0===(null==i||null==(r=i.children)?void 0:r.length)&&D(o,(0,Z.Z)({childId:o,layout:a}),a),a},[S.J0](e,t){const{payload:{dropResult:r}}=t,n=N({dropResult:r,layout:e});return{...e,...n}},[S.aZ](e,t){const{payload:{dropResult:r}}=t,{source:n,destination:o,dragging:a}=r;if(!n||!o||!a)return e;const i=function(e){let{entitiesMap:t,source:r,destination:n}=e;const o=[...t[r.id].children],a=[...t[n.id].children],i=o[r.index];if(r.id===n.id){const e=function(e,t,r){const n=[...e],[o]=n.splice(t,1);return n.splice(r,0,o),n}(o,r.index,n.index);return{...t,[r.id]:{...t[r.id],children:e}}}return o.splice(r.index,1),a.splice(n.index,0,i),{...t,[r.id]:{...t[r.id],children:o},[n.id]:{...t[n.id],children:a}}}({entitiesMap:e,source:n,destination:o});if(R(i[a.id])){const t=(0,A.Z)({dropResult:r,layout:e})||void 0;(i[a.id].meta||{}).width!==t&&(i[a.id]={...i[a.id],meta:{...i[a.id].meta,width:t}})}if(I({parentType:o.type,childType:a.type})){const e=i[o.id],t=e.children,r=(0,O.Z)(C.Os);r.children=[t[o.index]],r.parents=(e.parents||[]).concat(o.id),t[o.index]=r.id,i[r.id]=r}return{...e,...i}},[S.YA](e,t){const{payload:{dropResult:r}}=t,{source:n,dragging:o}=r,a=e[T._4],i=a.children[0],s=e[i];if(n.id!==T.D0){const t=e[o.id].children[0],r=e[t],n=[...s.children].filter((e=>e!==o.id));return{...e,[T._4]:{...a,children:[o.id]},[i]:{...s,children:[]},[t]:{...r,children:[...r.children,...n]}}}const l=N({dropResult:r,layout:e}),c=Object.values(l),d=c.find((e=>e.type===C.gn)),u=c.find((e=>e.type===C.yR));return d.children=[...s.children],l[i]={...s,children:[]},l[T._4]={...a,children:[u.id]},{...e,...l}},[S.Mu](e){const t=e[T._4],r=t.children[0],n=e[r];if(n.type!==C.yR)return e;let o=[];const a={...e};return n.children.forEach((t=>{const r=e[t];o=[...o,...r.children],delete a[t]})),delete a[r],a[T._4]={...t,children:[T.PV]},a[T.PV]={...e[T.PV],children:o},a},[S.x_](e){const t={...e};return(0,x.Z)({currentComponent:t[T._4],layout:t}),{...t}},[S.bK]:(e,t)=>({...e,[T.M2]:{...e[T.M2],meta:{...e[T.M2].meta,text:t.text}}})},M=(0,E.ZP)((function(e,t){return void 0===e&&(e={}),t.type in L?(0,L[t.type])(e,t):e}),{limit:T.Q9+2,ignoreInitialState:!0,filter:(0,E.an)([h.$,S.nj,S.CB,S.J0,S.YA,S.Mu,S.qL,S.aZ,S.L1])});var k=r(14670),P=r.n(k),U=r(31069),$=r(9679),F=r(97381),q=r(3741),V=r(23279),B=r.n(V);const H=new class{constructor(e){let{callback:t=(()=>{}),sizeThreshold:r=1e3,delayThreshold:n=1e3}=e;this.queue=[],this.sizeThreshold=r,this.delayThreshold=n,this.trigger=B()(this.trigger.bind(this),this.delayThreshold),this.callback=t}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:r,source_id:n}=e[0];if("dashboard"===r?t+=`&dashboard_id=${n}`:"slice"===r&&(t+=`&slice_id=${n}`),navigator.sendBeacon){const r=new FormData;r.append("events",(0,$.o)(e)),U.Z.getGuestToken()&&r.append("guest_token",U.Z.getGuestToken()),navigator.sendBeacon(t,r)}else U.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let j=0;const z=e=>t=>r=>{var n;if(r.type!==F.LOG_EVENT)return t(r);const{dashboardInfo:o,explore:a,impressionId:i,dashboardLayout:s,sqlLab:l}=e.getState();let c={impression_id:i,version:"v2"};if(null!=o&&o.id)c={source:"dashboard",source_id:o.id,...c};else if(null!=a&&a.slice)c={source:"explore",source_id:a.slice?a.slice.slice_id:0,...c};else if(l){const e=l.queryEditors.find((e=>{let{id:t}=e;return t===l.tabHistory.slice(-1)[0]}));c={source:"sqlLab",source_id:null==e?void 0:e.id,db_id:null==e?void 0:e.dbId,schema:null==e?void 0:e.schema}}const{eventName:d}=r.payload;let{eventData:u={}}=r.payload;if(u={...c,ts:(new Date).getTime(),event_name:d,...u},q.TY.has(d)?u={...u,event_type:"timing",trigger_event:j}:(j=P().generate(),u={...u,event_type:"user",event_id:j,visibility:document.visibilityState}),u.target_id&&null!=s&&null!=(n=s.present)&&n[u.target_id]){const{meta:e}=s.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return H.append(u),u};var Q=r(19485),G=r(76445),Y=r(55786),W=r(52256),K=r(35854),X=r(10331),J=r(651),ee=r(42313),te=r(99068),re=r(35937),ne=r.n(re),oe=r(64417),ae=r.n(oe),ie=r(93185),se=r(43693),le=r(40511),ce=r(44904);const de={tables:le.uQ,queries:le.NU,queryEditors:le.St,unsavedQueryEditor:e=>(0,le.St)([e])[0]},ue={paths:["sqlLab"],config:{slicer:e=>t=>{const r={};e.forEach((e=>{if((0,ie.cr)(ie.TT.SQLLAB_BACKEND_PERSISTENCE)){const{queryEditors:e,editorTabLastUpdatedAt:n,unsavedQueryEditor:o,tables:a,queries:i,tabHistory:s}=t.sqlLab,l=(0,se.V)(e,o,n);if(l.length>0){const e=l.every((e=>{let{inLocalStorage:t}=e;return!t}));r.sqlLab={queryEditors:l,...!e&&{tabHistory:s,tables:a.filter((e=>e.inLocalStorage)),queries:ne()(i,(e=>e.inLocalStorage&&!e.isDataPreview))}}}}else delete t[e].common,"sqlLab"===e&&(r[e]=Object.fromEntries(Object.entries(t[e]).map((e=>{var t,r;let[n,o]=e;return[n,null!=(t=null==(r=de[n])?void 0:r.call(de,o))?t:o]}))))}));const n=JSON.stringify(r),o=Math.round(n.length*ce.TU/ce.Yo*100)/100;return t.localStorageUsageInKilobytes!==o&&(t.localStorageUsageInKilobytes=o),r},merge:function(e,t){var r;return void 0===t&&(t={}),{...e,...t,sqlLab:{...(null==(r=t)?void 0:r.sqlLab)||{},...e.sqlLab}}}}},pe=ae()(ue.paths,ue.config);var he=r(61988),me=r(43716),ge=r(88484),fe=r(11409),ve=r(44814),_e=r(99543);function be(e,t,r,n){if(void 0===n&&(n=!1),e.tabHistory[e.tabHistory.length-1]!==r){const{queryEditors:n}=(0,_e.gf)(e,"queryEditors",{id:r},t);return{queryEditors:n}}return{unsavedQueryEditor:{...e.unsavedQueryEditor.id===r&&e.unsavedQueryEditor,...r?{id:r,...t}:e.unsavedQueryEditor,...!n&&{updatedAt:(new Date).getTime()}}}}var ye=r(48527);const Ee=e=>function(t){return void 0===t&&(t=e),t},Te=(0,r(20292).Z)(),Se="USER_LOADED",Ce=e=>[o.Z,z,a.h.middleware],Re={sqlLab:function e(t,r){void 0===t&&(t={});const n={[fe.ADD_QUERY_EDITOR](){const e={...(0,_e.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),tabHistory:[...t.tabHistory,r.queryEditor.id]};return(0,_e._0)(e,"queryEditors",{...r.queryEditor,updatedAt:(new Date).getTime()})},[fe.QUERY_EDITOR_SAVED](){const{query:e,result:n,clientId:o}=r,a=t.queryEditors.find((e=>e.id===o));return(0,_e.gf)(t,"queryEditors",a,{remoteId:n.remoteId,name:e.name},"id")},[fe.UPDATE_QUERY_EDITOR](){const e=r.alterations.remoteId,n=t.queryEditors.find((t=>t.remoteId===e));return null==n?t:(0,_e.gf)(t,"queryEditors",n,r.alterations,"remoteId")},[fe.CLONE_QUERY_TO_NEW_TAB](){const n=t.queryEditors.find((e=>e.id===t.tabHistory[t.tabHistory.length-1])),o={...n,...t.unsavedQueryEditor.id===n.id&&t.unsavedQueryEditor},a={remoteId:o.remoteId,name:(0,he.t)("Copy of %s",o.name),dbId:r.query.dbId?r.query.dbId:null,schema:r.query.schema?r.query.schema:null,autorun:!0,sql:r.query.sql,queryLimit:r.query.queryLimit,maxRow:r.query.maxRow};return e({...t,unsavedQueryEditor:{}},fe.addQueryEditor(a))},[fe.REMOVE_QUERY_EDITOR](){const e={...r.queryEditor,...r.queryEditor.id===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};let n=(0,_e.gP)(t,"queryEditors",e);const o=n.queryEditors.map((e=>e.id)),a={};Object.keys(t.queries).forEach((e=>{const r=t.queries[e];o.indexOf(r.sqlEditorId)>-1&&(a[e]=r)}));let i=t.tabHistory.slice();i=i.filter((e=>o.indexOf(e)>-1));const s=t.tables.filter((t=>t.queryEditorId!==e.id));return n={...n,tabHistory:i,tables:s,queries:a,unsavedQueryEditor:{...r.queryEditor.id!==t.unsavedQueryEditor.id&&t.unsavedQueryEditor}},n},[fe.REMOVE_QUERY](){const e={...t.queries};return delete e[r.query.id],{...t,queries:e}},[fe.RESET_STATE]:()=>({...r.sqlLabInitialState}),[fe.MERGE_TABLE](){const e={...r.table};let n;if(t.tables.forEach((t=>{t.dbId===e.dbId&&t.queryEditorId===e.queryEditorId&&t.schema===e.schema&&t.name===e.name&&(n=t)})),n)return r.query&&(e.dataPreviewQueryId=r.query.id),n.initialized&&(e.id=n.id),(0,_e.gf)(t,"tables",n,e);e.dataPreviewQueryId=null;let o=(0,_e._0)(t,"tables",e,Boolean(r.prepend));return r.query&&(o=(0,_e.gf)(o,"tables",e,{dataPreviewQueryId:r.query.id})),o},[fe.EXPAND_TABLE]:()=>(0,_e.gf)(t,"tables",r.table,{expanded:!0}),[fe.REMOVE_DATA_PREVIEW](){const e={...t.queries};return delete e[r.table.dataPreviewQueryId],{...(0,_e.gf)(t,"tables",r.table,{dataPreviewQueryId:null}),queries:e}},[fe.CHANGE_DATA_PREVIEW_ID](){const e={...t.queries};delete e[r.oldQueryId];const n=[];return t.tables.forEach((e=>{e.dataPreviewQueryId===r.oldQueryId?n.push({...e,dataPreviewQueryId:r.newQuery.id}):n.push(e)})),{...t,queries:e,tables:n,activeSouthPaneTab:r.newQuery.id}},[fe.COLLAPSE_TABLE]:()=>(0,_e.gf)(t,"tables",r.table,{expanded:!1}),[fe.REMOVE_TABLES](){const e=r.tables.map((e=>e.id));return{...t,tables:t.tables.filter((t=>!e.includes(t.id)))}},[fe.COST_ESTIMATE_STARTED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:null}}}),[fe.COST_ESTIMATE_RETURNED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!0,cost:r.json.result,error:null}}}),[fe.COST_ESTIMATE_FAILED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:r.error}}}),[fe.START_QUERY](){let e={...t};if(r.query.sqlEditorId){const n={...(0,_e.p1)(t.queryEditors,r.query.sqlEditorId),...r.query.sqlEditorId===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};if(n.latestQueryId&&t.queries[n.latestQueryId]){const r={...t.queries[n.latestQueryId].results,data:[],query:null},o={...t.queries[n.latestQueryId],results:r},a={...t.queries,[o.id]:o};e={...t,queries:a}}}else e.activeSouthPaneTab=r.query.id;return e=(0,_e.SJ)(e,"queries",r.query),{...e,...be(t,{latestQueryId:r.query.id},r.query.sqlEditorId,r.query.isDataPreview)}},[fe.STOP_QUERY]:()=>(0,_e.wK)(t,"queries",r.query,{state:me.Tb.STOPPED,results:[]}),[fe.CLEAR_QUERY_RESULTS](){const e={...r.query.results};return e.data=[],(0,_e.wK)(t,"queries",r.query,{results:e,cached:!0})},[fe.REQUEST_QUERY_RESULTS]:()=>(0,_e.wK)(t,"queries",r.query,{state:me.Tb.FETCHING}),[fe.QUERY_SUCCESS](){var e,n,o,a,i,s,l,c,d,u;if(r.query.state===me.Tb.STOPPED||r.results.status!==me.Tb.SUCCESS)return t;const p={endDttm:(0,ve.zO)(),progress:100,results:r.results,rows:(null==r||null==(e=r.results)||null==(n=e.query)?void 0:n.rows)||0,state:me.Tb.SUCCESS,limitingFactor:null==r||null==(o=r.results)||null==(a=o.query)?void 0:a.limitingFactor,tempSchema:null==r||null==(i=r.results)||null==(s=i.query)?void 0:s.tempSchema,tempTable:null==r||null==(l=r.results)||null==(c=l.query)?void 0:c.tempTable,errorMessage:null,cached:!1},h=null==r||null==(d=r.results)||null==(u=d.query)?void 0:u.resultsKey;return h&&(p.resultsKey=h),(0,_e.wK)(t,"queries",r.query,p)},[fe.QUERY_FAILED](){if(r.query.state===me.Tb.STOPPED)return t;const e={state:me.Tb.FAILED,errors:r.errors,errorMessage:r.msg,endDttm:(0,ve.zO)(),link:r.link};return(0,_e.wK)(t,"queries",r.query,e)},[fe.SET_ACTIVE_QUERY_EDITOR](){var e;if(t.queryEditors.map((e=>e.id)).indexOf(null==(e=r.queryEditor)?void 0:e.id)>-1&&t.tabHistory[t.tabHistory.length-1]!==r.queryEditor.id){const e={...(0,_e.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),unsavedQueryEditor:{}};return{...r.queryEditor.id===t.unsavedQueryEditor.id?(0,_e.gf)(e,"queryEditors",r.queryEditor,{...r.queryEditor,...t.unsavedQueryEditor}):e,tabHistory:[...t.tabHistory,r.queryEditor.id]}}return t},[fe.LOAD_QUERY_EDITOR](){const e=(0,_e.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor});return(0,_e.gf)(e,"queryEditors",r.queryEditor,{...r.queryEditor})},[fe.SET_TABLES]:()=>(0,_e.zd)(t,"tables",r.tables),[fe.SET_ACTIVE_SOUTHPANE_TAB]:()=>({...t,activeSouthPaneTab:r.tabId}),[fe.MIGRATE_QUERY_EDITOR](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.queryEditors=e.queryEditors.filter((e=>e.id!==r.oldQueryEditor.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,_e._0)((0,_e.gP)(t,"queryEditors",r.oldQueryEditor),"queryEditors",r.newQueryEditor)},[fe.MIGRATE_TABLE](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.tables=e.tables.filter((e=>e.id!==r.oldTable.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,_e._0)((0,_e.gP)(t,"tables",r.oldTable),"tables",r.newTable)},[fe.MIGRATE_TAB_HISTORY](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.tabHistory=e.tabHistory.filter((e=>e!==r.oldId)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}const e=t.tabHistory.filter((e=>e!==r.oldId));return e.push(r.newId),{...t,tabHistory:e}},[fe.MIGRATE_QUERY](){const e={...t.queries[r.queryId],sqlEditorId:r.queryEditorId},n={...t.queries,[e.id]:e};return{...t,queries:n}},[fe.QUERY_EDITOR_SETDB]:()=>({...t,...be(t,{dbId:r.dbId},r.queryEditor.id)}),[fe.QUERY_EDITOR_SET_SCHEMA]:()=>({...t,...be(t,{schema:r.schema},r.queryEditor.id)}),[fe.QUERY_EDITOR_SET_TITLE]:()=>({...t,...be(t,{name:r.name},r.queryEditor.id)}),[fe.QUERY_EDITOR_SET_SQL](){const{unsavedQueryEditor:e}=t;return(null==e?void 0:e.id)===r.queryEditor.id&&e.sql===r.sql?t:{...t,...be(t,{sql:r.sql,...r.queryId&&{latestQueryId:r.queryId}},r.queryEditor.id)}},[fe.QUERY_EDITOR_SET_QUERY_LIMIT]:()=>({...t,...be(t,{queryLimit:r.queryLimit},r.queryEditor.id)}),[fe.QUERY_EDITOR_SET_TEMPLATE_PARAMS]:()=>({...t,...be(t,{templateParams:r.templateParams},r.queryEditor.id)}),[fe.QUERY_EDITOR_SET_SELECTED_TEXT]:()=>({...t,...be(t,{selectedText:r.sql},r.queryEditor.id,!0)}),[fe.QUERY_EDITOR_SET_AUTORUN]:()=>({...t,...be(t,{autorun:r.autorun},r.queryEditor.id)}),[fe.QUERY_EDITOR_PERSIST_HEIGHT]:()=>({...t,...be(t,{northPercent:r.northPercent,southPercent:r.southPercent},r.queryEditor.id)}),[fe.QUERY_EDITOR_TOGGLE_LEFT_BAR]:()=>({...t,...be(t,{hideLeftBar:r.hideLeftBar},r.queryEditor.id)}),[fe.SET_DATABASES](){const e={};return r.databases.forEach((t=>{e[t.id]={...t,extra_json:JSON.parse(t.extra||"")}})),{...t,databases:e}},[fe.REFRESH_QUERIES](){let e={...t.queries},n=!1,{queriesLastUpdate:o}=t;return Object.entries(r.alteredQueries).forEach((r=>{let[a,i]=r;if(!t.queries.hasOwnProperty(a)||t.queries[a].state!==me.Tb.STOPPED&&t.queries[a].state!==me.Tb.FAILED){var s;const r=(0,ge.Z)(i.changed_on),l=Date.parse(r);l>o&&(o=l);const c=null==(s=t.queries[a])?void 0:s.state,d=i.state;e[a]={...t.queries[a],...i,...i.startDttm&&{startDttm:Number(i.startDttm)},...i.endDttm&&{endDttm:Number(i.endDttm)},state:d===me.Tb.SUCCESS&&[me.Tb.FETCHING,me.Tb.SUCCESS,me.Tb.RUNNING].includes(c)?c:d},n=!0}})),n||(e=t.queries),{...t,queries:e,queriesLastUpdate:o}},[fe.CLEAR_INACTIVE_QUERIES](){const{queries:e}=t,n=Object.fromEntries(Object.entries(e).filter((e=>{let[,t]=e;return!(["running","pending"].includes(t.state)&&Date.now()-t.startDttm>r.interval&&0===t.progress)})).map((e=>{var t;let[r,n]=e;return[r,{...n,state:n.resultsKey&&null!=(t=n.results)&&t.status?n.results.status:n.state}]})));return{...t,queries:n}},[fe.SET_USER_OFFLINE]:()=>({...t,offline:r.offline}),[fe.CREATE_DATASOURCE_STARTED]:()=>({...t,isDatasourceLoading:!0,errorMessage:null}),[fe.CREATE_DATASOURCE_SUCCESS]:()=>({...t,isDatasourceLoading:!1,errorMessage:null,datasource:r.datasource}),[fe.CREATE_DATASOURCE_FAILED]:()=>({...t,isDatasourceLoading:!1,errorMessage:r.err}),[fe.SET_EDITOR_TAB_LAST_UPDATE]:()=>({...t,editorTabLastUpdatedAt:r.timestamp})};return r.type in n?n[r.type]():t},localStorageUsageInKilobytes:Ee(0),messageToasts:function(e,t){switch(void 0===e&&(e=[]),t.type){case i.h:{const{payload:r}=t,n=e.slice();return r.noDuplicate&&n.find((e=>e.text===r.text))?e:[r,...e]}case i.K7:{const{payload:{id:r}}=t;return[...e].filter((e=>e.id!==r))}default:return e}},common:Ee(Te.common),user:function(e,t){return void 0===e&&(e=Te.user||{}),t.type===Se?t.user:e},impressionId:Ee(P().generate()),charts:s.Z,datasources:(e,t)=>t.type===b.Rn.SET_DATASOURCES?function(e,t){return t.type===b.Rn.SET_DATASOURCES?{...e,..._()(t.datasources,"uid")}:t.type===b.Rn.SET_DATASOURCE?{...e,[t.key]:t.datasource}:e||{}}(e,t):function(e,t){return t.type===te.AG?{...e,[(0,ee.T)(t.datasource)]:t.datasource}:t.type===G._?{...t.data.datasources}:e||{}}(e,t),dashboardInfo:function(e,t){switch(void 0===e&&(e={}),t.type){case p.$A:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case h.$:return{...e,...t.data.dashboardInfo};case p.nH:return{...e,filterBarOrientation:t.filterBarOrientation};case p.Fl:return{...e,crossFiltersEnabled:t.crossFiltersEnabled};default:return e}},dashboardFilters:g.ZP,dataMask:l.Z,nativeFilters:f.Z,dashboardState:function(e,t){void 0===e&&(e={});const r={[h.$]:()=>({...e,...t.data.dashboardState}),[m.Be]:()=>({...e,css:t.css}),[m.BD](){const r=new Set(e.sliceIds);return r.add(t.slice.slice_id),{...e,sliceIds:Array.from(r)}},[m.Vd](){const{sliceId:r}=t,n=new Set(e.sliceIds);return n.delete(r),{...e,sliceIds:Array.from(n)}},[m.Z9]:()=>({...e,isStarred:t.isStarred}),[m.H9]:()=>({...e,isPublished:t.isPublished}),[m.$f]:()=>({...e,editMode:t.editMode}),[m.n1](){const{maxUndoHistoryExceeded:r=!0}=t.payload;return{...e,maxUndoHistoryExceeded:r}},[m.oJ]:()=>({...e}),[m.J$]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[m.ek](){const r={...e.expandedSlices},{sliceId:n}=t;return r[n]?delete r[n]:r[n]=!0,{...e,expandedSlices:r}},[m.P0]:()=>({...e,hasUnsavedChanges:!0}),[m.hD]:()=>({...e,dashboardIsSaving:!0}),[m.qJ]:()=>({...e,dashboardIsSaving:!1}),[m.Ii]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,lastModifiedTime:t.lastModifiedTime}),[m.ee](){const{hasUnsavedChanges:r}=t.payload;return{...e,hasUnsavedChanges:r}},[m.yV]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[m.ec]:()=>({...e,isRefreshing:!0}),[m.bs]:()=>({...e,isFiltersRefreshing:!0}),[m.sm]:()=>({...e,isFiltersRefreshing:!1}),[m.k5]:()=>({...e,isRefreshing:!1}),[m.RU]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[m.om](){const r=new Set(e.activeTabs);return r.delete(t.prevTabId),r.add(t.tabId),{...e,activeTabs:Array.from(r)}},[m.nV]:()=>({...e,activeTabs:t.activeTabs}),[m.w9]:()=>({...e,overwriteConfirmMetadata:t.overwriteConfirmMetadata}),[m.mq]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[m.Iw]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[m.r$]:()=>({...e,fullSizeChartId:t.chartId}),[m.FF]:()=>({...e,datasetsStatus:t.status})};return t.type in r?r[t.type]():e},dashboardLayout:M,sliceEntities:y.Z,reports:function(e,t){void 0===e&&(e={});const r={[u.jt](){var r,n,o;const{report:a,resourceId:i,creationMethod:s,filterField:l}=t,c=null==(r=a.result)?void 0:r.find((e=>e[l]===i));if(c)return{...e,[s]:{...e[s],[i]:c}};if(null!=(n=e)&&null!=(o=n[s])&&o[i]){const t={...e};return delete t[s][i],t}return{...e}},[u.J8](){const{result:r,id:n}=t.json,o={...r,id:n},a=o.dashboard||o.chart;return{...e,[o.creation_method]:{...e[o.creation_method],[a]:o}}},[u.Dr](){const r={...t.json.result,id:t.json.id},n=r.dashboard||r.chart;return{...e,[r.creation_method]:{...e[r.creation_method],[n]:r}}},[u._M](){const{report:r}=t,n=r.dashboard||r.chart;return{...e,[r.creation_method]:{...d()(e[r.creation_method],n)}}}};return t.type in r?r[t.type]():e},saveModal:function(e,t){void 0===e&&(e={});const r={[Q.SET_SAVE_CHART_MODAL_VISIBILITY]:()=>({...e,isVisible:t.isVisible}),[Q.FETCH_DASHBOARDS_SUCCEEDED]:()=>({...e,dashboards:t.choices}),[Q.FETCH_DASHBOARDS_FAILED]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[Q.SAVE_SLICE_FAILED]:()=>({...e,saveModalAlert:"Failed to save slice"}),[Q.SAVE_SLICE_SUCCESS]:t=>({...e,data:t}),[G._]:()=>({...t.data.saveModal})};return t.type in r?r[t.type]():e},explore:function(e,t){void 0===e&&(e={});const r={[W.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[J.TOGGLE_FAVE_STAR]:()=>({...e,isStarred:t.isStarred}),[J.POST_DATASOURCE_STARTED]:()=>({...e,isDatasourceMetaLoading:!0}),[J.UPDATE_FORM_DATA_BY_DATASOURCE](){const r={...e.form_data},{prevDatasource:n,newDatasource:o}=t,a={...e.controls},i=[];n.id===o.id&&n.type===o.type||(r.datasource=o.uid),Object.entries(a).forEach((e=>{let[t,n]=e;("column_name"===n.valueKey||"savedMetrics"in n||"columns"in n||"options"in n&&!Array.isArray(n.options))&&(r[t]=(0,X.YY)(o,n,n.value),(0,Y.Z)(r[t]).length>0&&r[t]!==a[t].default&&i.push(t))}));const s={...e,controls:a,datasource:t.newDatasource};return{...s,form_data:r,controls:(0,K.R3)(s,r),controlsTransferred:i}},[J.FETCH_DATASOURCES_STARTED]:()=>({...e,isDatasourcesLoading:!0}),[J.SET_FIELD_VALUE](){const{controlName:r,value:n,validationErrors:o}=t;let a={...e.form_data,[r]:n};const i=e.form_data.metrics,s=e.form_data.column_config,l=a.viz_type;"metrics"===r&&i&&s&&(n.forEach(((e,t)=>{var r,n;!i.some((t=>(null==t?void 0:t.label)===(null==e?void 0:e.label)))&&(null==e?void 0:e.label)!==(null==(r=i[t])?void 0:r.label)&&s[null==(n=i[t])?void 0:n.label]&&(s[e.label]=s[i[t].label],delete s[i[t].label])})),a.column_config=s);const c=e.controls[t.controlName]||(0,X.Bx)(t.controlName,l)||null,d={...(0,X.vP)(c,e,t.value)},u={...e.controls.column_config,...s&&{value:s}},p={...e,controls:{...e.controls,...c&&{[r]:d},..."metrics"===r&&{column_config:u}}},h={};Array.isArray(d.rerender)&&d.rerender.forEach((e=>{h[e]={...(0,X.vP)(p.controls[e],p,p.controls[e].value)}}));const m=d.validationErrors||[];(o||[]).forEach((e=>{m.includes(e)||m.push(e)}));const g=m&&m.length>0,f="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value;let v=e.controls;if(f){const r=new X.os(e.form_data).transform(t.value,e);a=r.formData,v=r.controlsState}return{...e,form_data:a,triggerRender:d.renderTrigger&&!g,controls:{...v,...c&&{[t.controlName]:{...d,validationErrors:m}},...h}}},[J.SET_EXPLORE_CONTROLS]:()=>({...e,controls:(0,K.R3)(e,t.formData)}),[J.SET_FORM_DATA]:()=>({...e,form_data:t.formData}),[J.UPDATE_CHART_TITLE]:()=>({...e,sliceName:t.sliceName}),[J.SET_SAVE_ACTION]:()=>({...e,saveAction:t.saveAction}),[J.CREATE_NEW_SLICE]:()=>({...e,slice:t.slice,controls:(0,K.R3)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[J.SLICE_UPDATED](){var r;return{...e,slice:{...e.slice,...t.slice,owners:t.slice.owners?t.slice.owners.map((e=>e.value)):null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName,metadata:{...e.metadata,owners:t.slice.owners?t.slice.owners.map((e=>e.label)):null}}},[J.SET_FORCE_QUERY]:()=>({...e,force:t.force}),[G._]:()=>({...t.data.explore})};return t.type in r?r[t.type]():e}};function Ze(e){let{disableDebugger:t=!1,initialState:r=(0,ye.Z)(Te),rootReducers:o=Re,...i}=void 0===e?{}:e;return(0,n.xC)({preloadedState:r,reducer:{[a.h.reducerPath]:a.h.reducer,...o},middleware:Ce,devTools:!1,enhancers:[pe],...i})}const Ae=Ze()},69233:(e,t,r)=>{var n={"./alert.svg":[26230,6230],"./alert_solid.svg":[2886,2886],"./alert_solid_small.svg":[14002,4002],"./area-chart-tile.svg":[65573,5573],"./ballot.svg":[70287,287],"./bar-chart-tile.svg":[91084,1084],"./big-number-chart-tile.svg":[58310,8310],"./binoculars.svg":[81684,1684],"./bolt.svg":[6450,6450],"./bolt_small.svg":[40894,894],"./bolt_small_run.svg":[5094,5094],"./calendar.svg":[48829,8829],"./cancel-x.svg":[65394,5394],"./cancel.svg":[19332,9364],"./cancel_solid.svg":[30869,869],"./card_view.svg":[91277,1277],"./cards.svg":[76145,6145],"./cards_locked.svg":[49490,9490],"./caret_down.svg":[40149,149],"./caret_left.svg":[91363,1363],"./caret_right.svg":[56746,6746],"./caret_up.svg":[38754,8754],"./category.svg":[75362,5362],"./certified.svg":[7914,7914],"./check.svg":[69814,9814],"./checkbox-half.svg":[72109,2109],"./checkbox-off.svg":[51923,9131],"./checkbox-on.svg":[72426,2426],"./circle.svg":[31603,1603],"./circle_check.svg":[91503,1503],"./circle_check_solid.svg":[82078,2078],"./clock.svg":[33211,3211],"./close.svg":[48082,8082],"./code.svg":[28295,8295],"./cog.svg":[93533,3533],"./collapse.svg":[29414,9414],"./color_palette.svg":[81997,5934],"./components.svg":[27618,7618],"./copy.svg":[7335,7335],"./cross-filter-badge.svg":[60642,642],"./current-rendered-tile.svg":[11626,1626],"./cursor_target.svg":[42679,2679],"./database.svg":[57056,7056],"./dataset_physical.svg":[14255,4255],"./dataset_virtual.svg":[5336,1016],"./dataset_virtual_greyscale.svg":[80389,389],"./default_db_image.svg":[59286,9286],"./download.svg":[77239,7239],"./drag.svg":[33709,3709],"./edit.svg":[673,673],"./edit_alt.svg":[84749,4749],"./email.svg":[3702,3702],"./error.svg":[16525,6525],"./error_solid.svg":[48277,8277],"./error_solid_small.svg":[68162,8162],"./error_solid_small_red.svg":[83702,8700],"./exclamation.svg":[24602,4602],"./expand.svg":[65481,5481],"./eye.svg":[13456,3456],"./eye_slash.svg":[95305,5305],"./favorite-selected.svg":[62913,2913],"./favorite-unselected.svg":[97914,9452],"./favorite_small_selected.svg":[66146,6146],"./field_abc.svg":[78942,8942],"./field_boolean.svg":[14804,4804],"./field_date.svg":[22417,2417],"./field_derived.svg":[23045,3045],"./field_num.svg":[27461,7461],"./field_struct.svg":[28325,8325],"./file.svg":[84376,4376],"./filter.svg":[85205,5205],"./filter_small.svg":[48225,8225],"./folder.svg":[83431,3431],"./full.svg":[9542,9542],"./function_x.svg":[83339,3339],"./gear.svg":[15634,5634],"./grid.svg":[89480,9480],"./image.svg":[8417,8417],"./import.svg":[47508,7508],"./info-solid.svg":[89558,9558],"./info.svg":[73489,3489],"./info_solid_small.svg":[7822,7822],"./join.svg":[72405,2405],"./keyboard.svg":[45310,5310],"./layers.svg":[51705,1705],"./lightbulb.svg":[46712,6712],"./line-chart-tile.svg":[83423,3423],"./link.svg":[54641,4641],"./list.svg":[91019,1019],"./list_view.svg":[48074,8074],"./location.svg":[55840,5840],"./lock_locked.svg":[9174,9174],"./lock_unlocked.svg":[25280,5280],"./map.svg":[48058,8058],"./message.svg":[25922,5922],"./minus.svg":[35117,5117],"./minus_solid.svg":[67539,7539],"./more_horiz.svg":[82968,3246],"./more_vert.svg":[51441,1441],"./move.svg":[34801,4801],"./nav_charts.svg":[98430,8430],"./nav_dashboard.svg":[36239,6239],"./nav_data.svg":[66730,6730],"./nav_explore.svg":[59360,9360],"./nav_home.svg":[58960,8960],"./nav_lab.svg":[43613,3613],"./note.svg":[60971,971],"./offline.svg":[70650,650],"./paperclip.svg":[44837,4837],"./pie-chart-tile.svg":[19804,9804],"./placeholder.svg":[27850,7850],"./plus.svg":[34616,4616],"./plus_large.svg":[67820,7820],"./plus_small.svg":[74585,4585],"./plus_solid.svg":[83070,3070],"./queued.svg":[62905,2905],"./redo.svg":[13043,3043],"./refresh.svg":[84,84],"./running.svg":[15350,5350],"./save.svg":[90511,511],"./search.svg":[52652,2652],"./server.svg":[26878,6878],"./share.svg":[25869,5869],"./slack.svg":[51044,1044],"./sort.svg":[16945,6945],"./sort_asc.svg":[88012,8012],"./sort_desc.svg":[88426,8426],"./sql.svg":[17248,7248],"./table-chart-tile.svg":[85499,5499],"./table.svg":[99684,9684],"./tag.svg":[92237,2237],"./tags.svg":[51378,1378],"./transparent.svg":[54858,4858],"./trash.svg":[15694,2663],"./triangle_change.svg":[47635,7635],"./triangle_down.svg":[97589,6384],"./triangle_up.svg":[33478,3478],"./undo.svg":[62202,2202],"./up-level.svg":[15029,5029],"./user.svg":[72837,2837],"./warning.svg":[92707,2707],"./warning_solid.svg":[85725,5725],"./x-large.svg":[55521,5521],"./x-small.svg":[20057,57]};function o(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return r.e(t[1]).then((()=>r(o)))}o.keys=()=>Object.keys(n),o.id=69233,e.exports=o},89419:(e,t,r)=>{"use strict";e.exports=r.p+"loading.cff8a5da..gif"}}]);
//# sourceMappingURL=9848.dc741ca15ee87487e152.entry.js.map